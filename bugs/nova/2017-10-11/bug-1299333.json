{
    "status": "Fix Released", 
    "last_updated": "2014-10-16 08:40:44.686224+00:00", 
    "description": "$ nova list\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n| ID                                   | Name | Status | Task State | Power State | Networks          |\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n| 543d9625-2523-4a7f-af47-50c8e6b44981 | vm1  | ACTIVE | -          | Running     | private=10.0.0.23 |\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n\n$ nova shelve vm1\n$ nova shelve-offload vm1\n$ nova list\n+--------------------------------------+------+-------------------+------------+-------------+-------------------+\n| ID                                   | Name | Status            | Task State | Power State | Networks          |\n+--------------------------------------+------+-------------------+------------+-------------+-------------------+\n| 543d9625-2523-4a7f-af47-50c8e6b44981 | vm1  | SHELVED_OFFLOADED | -          | Shutdown    | private=10.0.0.23 |\n+--------------------------------------+------+-------------------+------------+-------------+-------------------+\n\n\n$ nova interface-detach vm1 bbabdfa5-7c47-4a67-b8ff-f36249fae8f1\nERROR (ClientException): The server has either erred or is incapable of performing the requested operation. (HTTP 500) (Request-ID: req-ec251c02-4adb-4c60-8e67-a998a1700ec4)\n\n\nGot exception from nova-api:\n\n2014-03-29 12:06:07.377 ERROR nova.api.openstack [req-ec251c02-4adb-4c60-8e67-a998a1700ec4 admin admin] Caught error: Unable to find host for Instance 543d9625-2523-4a7f-af47-50c8e6b44981\n2014-03-29 12:06:07.377 TRACE nova.api.openstack Traceback (most recent call last):\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 125, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return req.get_response(self.application)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1296, in send\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     application, catch_exc_info=False)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1260, in call_application \n2014-03-29 12:06:07.377 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return resp(environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 582, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return self.app(env, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return resp(environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return resp(environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return resp(environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 917, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     content_type, body, accept)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 983, in _process_stack\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 1070, in dispatch\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return method(req=request, **action_args)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/contrib/attach_interfaces.py\", line 146, in delete\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     instance, port_id=port_id)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 201, in wrapped\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return func(self, context, target, *args, **kwargs)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 2870, in detach_interface\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     port_id=port_id)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/rpcapi.py\", line 399, in detach_interface\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     cctxt = self.client.prepare(server=_compute_host(None, instance),\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/rpcapi.py\", line 61, in _compute_host\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     'Instance %s') % instance['uuid'])\n2014-03-29 12:06:07.377 TRACE nova.api.openstack NovaException: Unable to find host for Instance 543d9625-2523-4a7f-af47-50c8e6b44981\n2014-03-29 12:06:07.377 TRACE nova.api.openstack", 
    "tags": [
        "api"
    ], 
    "importance": "Low", 
    "heat": 18, 
    "link": "https://bugs.launchpad.net/nova/+bug/1299333", 
    "owner": "https://api.launchpad.net/1.0/~xuhj", 
    "id": 1299333, 
    "index": 6120, 
    "created": "2014-03-29 04:06:48.592013+00:00", 
    "title": "Unable attach/detach interface for shelve offloaded instance", 
    "comments": [
        {
            "content": "$ nova list\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n| ID                                   | Name | Status | Task State | Power State | Networks          |\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n| 543d9625-2523-4a7f-af47-50c8e6b44981 | vm1  | ACTIVE | -          | Running     | private=10.0.0.23 |\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n\n$ nova shelve vm1\n$ nova shelve-offload vm1\n$ nova list\n+--------------------------------------+------+-------------------+------------+-------------+-------------------+\n| ID                                   | Name | Status            | Task State | Power State | Networks          |\n+--------------------------------------+------+-------------------+------------+-------------+-------------------+\n| 543d9625-2523-4a7f-af47-50c8e6b44981 | vm1  | SHELVED_OFFLOADED | -          | Shutdown    | private=10.0.0.23 |\n+--------------------------------------+------+-------------------+------------+-------------+-------------------+\n\n\n$ nova interface-detach vm1 bbabdfa5-7c47-4a67-b8ff-f36249fae8f1\nERROR (ClientException): The server has either erred or is incapable of performing the requested operation. (HTTP 500) (Request-ID: req-ec251c02-4adb-4c60-8e67-a998a1700ec4)\n\n\nGot exception from nova-api:\n\n2014-03-29 12:06:07.377 ERROR nova.api.openstack [req-ec251c02-4adb-4c60-8e67-a998a1700ec4 admin admin] Caught error: Unable to find host for Instance 543d9625-2523-4a7f-af47-50c8e6b44981\n2014-03-29 12:06:07.377 TRACE nova.api.openstack Traceback (most recent call last):\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 125, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return req.get_response(self.application)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1296, in send\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     application, catch_exc_info=False)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1260, in call_application \n2014-03-29 12:06:07.377 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return resp(environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 582, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return self.app(env, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return resp(environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return resp(environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return resp(environ, start_response)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 917, in __call__\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     content_type, body, accept)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 983, in _process_stack\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 1070, in dispatch\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return method(req=request, **action_args)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/contrib/attach_interfaces.py\", line 146, in delete\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     instance, port_id=port_id)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 201, in wrapped\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     return func(self, context, target, *args, **kwargs)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 2870, in detach_interface\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     port_id=port_id)\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/rpcapi.py\", line 399, in detach_interface\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     cctxt = self.client.prepare(server=_compute_host(None, instance),\n2014-03-29 12:06:07.377 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/rpcapi.py\", line 61, in _compute_host\n2014-03-29 12:06:07.377 TRACE nova.api.openstack     'Instance %s') % instance['uuid'])\n2014-03-29 12:06:07.377 TRACE nova.api.openstack NovaException: Unable to find host for Instance 543d9625-2523-4a7f-af47-50c8e6b44981\n2014-03-29 12:06:07.377 TRACE nova.api.openstack", 
            "date_created": "2014-03-29 04:06:48.592013+00:00", 
            "author": "https://api.launchpad.net/1.0/~xuhj"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/87081", 
            "date_created": "2014-04-12 11:38:53.277322+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "It's not a bug that an interface can't be attached/detached from a shelved instance.  The 500 response is a bug.  The error should be caught and an informative user response should be returned.", 
            "date_created": "2014-06-27 17:53:37.016057+00:00", 
            "author": "https://api.launchpad.net/1.0/~alaski"
        }, 
        {
            "content": "Change abandoned by Alex Xu (<email address hidden>) on branch: master\nReview: https://review.openstack.org/87081", 
            "date_created": "2014-06-30 01:53:25.917328+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This is fix by add state check for instance\n\nhttps://review.openstack.org/#/c/87082/", 
            "date_created": "2014-07-01 11:22:55.815495+00:00", 
            "author": "https://api.launchpad.net/1.0/~xuhj"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/87082\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=ac236c2cd73c9d7e05ef9fbd22a4f8f099262082\nSubmitter: Jenkins\nBranch:    master\n\ncommit ac236c2cd73c9d7e05ef9fbd22a4f8f099262082\nAuthor: He Jie Xu <email address hidden>\nDate:   Sat Apr 12 19:30:12 2014 +0800\n\n    Check instance state before attach/detach interface\n    \n    Currently there isn't any instance's status checking before\n    attach/detach interface, It will fail when some status didn't\n    support it. This patch add checking for it.\n    \n    This patch allow attach/detach interface for ACTIVE, PAUSED\n    and STOPPED instance.\n    \n    * ACTIVE: The interface is hotplug to instance.\n    * PAUSED: The interface can be hotpluged after instance unpaused.\n    It's fixed by commit: a868fcedf8e46070cae6aa8e59e61934fa23db1c\n    * STOPPED: In this status, the instance is destroyed. It just update\n    the instance configuration with new interface. When the start\n    instance, the instance will be recreated with new configuration.\n    \n    Change-Id: I3c038056085be1f655758ed8b6a44bcdbf70cdd5\n    Closes-bug: #1299333\n", 
            "date_created": "2014-07-22 08:18:56.304501+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}