{
    "status": "Fix Released", 
    "last_updated": "2016-09-02 01:15:45.560054+00:00", 
    "description": "The nova-api returns 500 error when attaching an interface with the network that doesn't have any subnets.\n\n[How to reproduce]\nstack@devstack-master:~/nova$ openstack server list\n+--------------------------------------+---------+--------+--------------------------------+\n| ID                                   | Name    | Status | Networks                       |\n+--------------------------------------+---------+--------+--------------------------------+\n| 82e55546-3496-499b-82eb-7b819d0a5e8e | server1 | ACTIVE | public=10.0.2.197, 2001:db8::6 |\n+--------------------------------------+---------+--------+--------------------------------+\nstack@devstack-master:~/nova$ openstack network list\n+--------------------------------------+---------+----------------------------------------------------------------------------+\n| ID                                   | Name    | Subnets                                                                    |\n+--------------------------------------+---------+----------------------------------------------------------------------------+\n| 7687f6d3-8ec7-4d47-863b-aab88f95d88b | private | 38025678-a6fc-4318-b8c9-4a4fe4c1acb9, fae11795-7253-4d58-a890-d9b1c74054e1 |\n| 0f3c1a14-3c7c-4c8c-ae0e-ce7e38d01fde | public  | 6fd1d52b-9762-4178-8424-07fe21473334, e921f73c-8606-4436-92f8-22eb5e518491 |\n| 00ad2c69-2796-4c01-b578-e48842854274 | net1    |                                                                            |\n+--------------------------------------+---------+----------------------------------------------------------------------------+\nstack@devstack-master:~/nova$ nova interface-attach --net-id 00ad2c69-2796-4c01-b578-e48842854274 server1\nERROR (ClientException): Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'SecurityGroupCannotBeApplied_Remote'> (HTTP 500) (Request-ID: req-8a3d18c2-ef33-4174-beab-e45057071353)\n\n[log]\nnova-comupte.log\n\n2016-05-23 18:41:54.285 ERROR oslo_messaging.rpc.server [req-8a3d18c2-ef33-4174-beab-e45057071353 admin admin] Exception during handling message\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server Traceback (most recent call last):\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/server.py\", line 133, in _process_incoming\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     res = self.dispatcher.dispatch(message)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 153, in dispatch\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     return self._do_dispatch(endpoint, method, ctxt, args)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     result = func(ctxt, **new_args)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception.py\", line 110, in wrapped\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     payload)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 221, in __exit__\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     self.force_reraise()\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 197, in force_reraise\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception.py\", line 89, in wrapped\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     return f(self, context, *args, **kw)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 210, in decorated_function\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     kwargs['instance'], e, sys.exc_info())\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 221, in __exit__\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     self.force_reraise()\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 197, in force_reraise\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 198, in decorated_function\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 4864, in attach_interface\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     bind_host_id=bind_host_id)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 845, in allocate_port_for_instance\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     bind_host_id=bind_host_id)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 600, in allocate_for_instance\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     raise exception.SecurityGroupCannotBeApplied()\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server SecurityGroupCannotBeApplied: Network requires port_security_enabled and subnet associated in order to apply security groups.\n\n[Environment]\nOS: Ubuntu 14.04 LTS(64bit)\nnova: master (commit 2505c5d8b1d9c075e20275ee903657640cc97c92)\nwith neutron", 
    "tags": [
        "api"
    ], 
    "importance": "Medium", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1584676", 
    "owner": "https://api.launchpad.net/1.0/~natsume-takashi", 
    "id": 1584676, 
    "index": 4537, 
    "created": "2016-05-23 09:43:12.895024+00:00", 
    "title": "500 Error when attaching an interface with the network that doesn't have any subnets", 
    "comments": [
        {
            "content": "The nova-api returns 500 error when attaching an interface with the network that doesn't have any subnets.\n\n[How to reproduce]\nstack@devstack-master:~/nova$ openstack server list\n+--------------------------------------+---------+--------+--------------------------------+\n| ID                                   | Name    | Status | Networks                       |\n+--------------------------------------+---------+--------+--------------------------------+\n| 82e55546-3496-499b-82eb-7b819d0a5e8e | server1 | ACTIVE | public=10.0.2.197, 2001:db8::6 |\n+--------------------------------------+---------+--------+--------------------------------+\nstack@devstack-master:~/nova$ openstack network list\n+--------------------------------------+---------+----------------------------------------------------------------------------+\n| ID                                   | Name    | Subnets                                                                    |\n+--------------------------------------+---------+----------------------------------------------------------------------------+\n| 7687f6d3-8ec7-4d47-863b-aab88f95d88b | private | 38025678-a6fc-4318-b8c9-4a4fe4c1acb9, fae11795-7253-4d58-a890-d9b1c74054e1 |\n| 0f3c1a14-3c7c-4c8c-ae0e-ce7e38d01fde | public  | 6fd1d52b-9762-4178-8424-07fe21473334, e921f73c-8606-4436-92f8-22eb5e518491 |\n| 00ad2c69-2796-4c01-b578-e48842854274 | net1    |                                                                            |\n+--------------------------------------+---------+----------------------------------------------------------------------------+\nstack@devstack-master:~/nova$ nova interface-attach --net-id 00ad2c69-2796-4c01-b578-e48842854274 server1\nERROR (ClientException): Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'SecurityGroupCannotBeApplied_Remote'> (HTTP 500) (Request-ID: req-8a3d18c2-ef33-4174-beab-e45057071353)\n\n[log]\nnova-comupte.log\n\n2016-05-23 18:41:54.285 ERROR oslo_messaging.rpc.server [req-8a3d18c2-ef33-4174-beab-e45057071353 admin admin] Exception during handling message\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server Traceback (most recent call last):\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/server.py\", line 133, in _process_incoming\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     res = self.dispatcher.dispatch(message)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 153, in dispatch\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     return self._do_dispatch(endpoint, method, ctxt, args)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     result = func(ctxt, **new_args)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception.py\", line 110, in wrapped\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     payload)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 221, in __exit__\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     self.force_reraise()\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 197, in force_reraise\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception.py\", line 89, in wrapped\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     return f(self, context, *args, **kw)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 210, in decorated_function\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     kwargs['instance'], e, sys.exc_info())\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 221, in __exit__\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     self.force_reraise()\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 197, in force_reraise\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 198, in decorated_function\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 4864, in attach_interface\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     bind_host_id=bind_host_id)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 845, in allocate_port_for_instance\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     bind_host_id=bind_host_id)\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 600, in allocate_for_instance\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server     raise exception.SecurityGroupCannotBeApplied()\n2016-05-23 18:41:54.285 TRACE oslo_messaging.rpc.server SecurityGroupCannotBeApplied: Network requires port_security_enabled and subnet associated in order to apply security groups.\n\n[Environment]\nOS: Ubuntu 14.04 LTS(64bit)\nnova: master (commit 2505c5d8b1d9c075e20275ee903657640cc97c92)\nwith neutron", 
            "date_created": "2016-05-23 09:43:12.895024+00:00", 
            "author": "https://api.launchpad.net/1.0/~natsume-takashi"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/323332", 
            "date_created": "2016-05-31 12:25:42.421223+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/323332\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=dba6713e83967be513b5b2bfc39408f15c0d0fe6\nSubmitter: Jenkins\nBranch:    master\n\ncommit dba6713e83967be513b5b2bfc39408f15c0d0fe6\nAuthor: Takashi NATSUME <email address hidden>\nDate:   Tue May 31 21:08:35 2016 +0900\n\n    Return 400 when SecurityGroupCannotBeApplied is raised\n    \n    Return 400 when SecurityGroupCannotBeApplied is raised\n    in attaching an interface to a VM instance.\n    \n    Change-Id: I6cc0e2b43b82dc3b16a581b1f8ec75b35995934e\n    Closes-Bug: #1584676\n", 
            "date_created": "2016-07-26 13:55:09.182602+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.0.0b3 development milestone.", 
            "date_created": "2016-09-02 01:15:44.659427+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}