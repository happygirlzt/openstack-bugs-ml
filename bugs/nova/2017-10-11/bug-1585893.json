{
    "status": "Fix Released", 
    "last_updated": "2016-10-19 07:50:58.357802+00:00", 
    "description": "Description\n===========\nAfter setup the nova development environment with devstack in aarch64 machine ,use the glance upload the image ,then use nova to launch the instance.Launching failed with the error \"libvirtError: unsupported configuration: IDE controllers are unsupported for this QEMU binary or machine type\".\n \nSteps to reproduce\n==================\n1.Using devstack to deploy openstack. Using default local.conf.\n\n2.Upload the aarch64 image with glance.\n$ source ~/devstack/openrc admin admin\n$ glance image-create --name image-arm64.img --disk-format qcow2 --container-format bare --visibility public --file images/image-arm64-wily.qcow2 --progress\n$ glance image-create --name image-arm64.vmlinuz --disk-format aki --container-format aki --visibility public --file images/image-arm64-wily.vmlinuz --progress\n$ glance image-create --name image-arm64.initrd --disk-format ari --container-format ari --visibility public --file images/image-arm64-wily.initrd --progress\n$ IMAGE_UUID=$(glance image-list | grep image-arm64.img | awk '{ print $2 }')\n$ IMAGE_KERNEL_UUID=$(glance image-list | grep image-arm64.vmlinuz | awk '{ print $2 }')\n$ IMAGE_INITRD_UUID=$(glance image-list | grep image-arm64.initrd | awk '{ print $2 }')\n$ glance image-update --kernel-id ${IMAGE_KERNEL_UUID} --ramdisk-id ${IMAGE_INITRD_UUID} ${IMAGE_UUID}\n\n3.nova add keypair\n$ nova keypair-add default --pub-key ~/.ssh/id_rsa.pub\n\n4.Launch the instance:\n$ image=$(nova image-list | egrep \"image-arm64.img\"'[^-]' | awk '{ print $2 }')\n$ nova boot --flavor m1.medium --image ${image} --key-name default test-arm64\n\n5.screen -x and select the n-cpu session to see the output.\nThen will got the error.\n\nExpected result\n===============\nAfter spawningn the instance, use :\n$ nova list\nWe can see the instance is active.\n\nActual result\n=============\nGot the error: \nlibvirtError: unsupported configuration: IDE controllers are unsupported for this QEMU binary or machine type\n\nWe can see the detailed information\uff1a\n ERROR nova.compute.manager [req-75325207-6c1b-481d-b188-a66c0a64eb89 admin admin] [instance: 188aa5bc-173c-46ec-b872-6bacb512911e] Instance failed to spawn\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e] Traceback (most recent call last):\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2041, in _build_resources\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     yield resources\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1887, in _build_and_run_instance\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     block_device_info=block_device_info)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2569, in spawn\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     block_device_info=block_device_info)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 4713, in _create_domain_and_network\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     xml, pause=pause, power_on=power_on)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 4644, in _create_domain\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     guest.launch(pause=pause)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/virt/libvirt/guest.py\", line 142, in launch\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     self._encoded_xml, errors='ignore')\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 221, in __exit__\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     self.force_reraise()\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 197, in force_reraise\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     six.reraise(self.type_, self.value, self.tb)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/virt/libvirt/guest.py\", line 137, in launch\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     return self._domain.createWithFlags(flags)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 186, in doit\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 144, in proxy_call\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     rv = execute(f, *args, **kwargs)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 125, in execute\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     six.reraise(c, e, tb)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 83, in tworker\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     rv = meth(*args, **kwargs)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/libvirt.py\", line 1065, in createWithFlags\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e] libvirtError: unsupported configuration: IDE controllers are unsupported for this QEMU binary or machine type\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]\n INFO nova.compute.manager [req-75325207-6c1b-481d-b188-a66c0a64eb89 admin admin] [instance: 188aa5bc-173c-46ec-b872-6bacb512911e] Terminating instance\n\nEnvironment\n===========\n1. Exact version of OpenStack you are running. See the following\n  list for all releases: http://docs.openstack.org/releases/\n   Nova development, commit code: 9a05d38f48ef0f630c5e49e332075b273cee38b9\n   \n\n2. Which hypervisor did you use?\n    Libvirt+KVM\n    $ kvm --version\n    QEMU emulator version 2.5.0 (Debian 1:2.5+dfsg-5ubuntu10.1), Copyright (c) 2003-2008 Fabrice Bellard\n    $ libvirtd --version\n    libvirtd (libvirt) 1.3.1\n\n2. Which storage type did you use?\n   In the host file system,all in one physics machine.q\nstack@u202154:/opt/stack/nova$ df -hl\nFilesystem      Size  Used Avail Use% Mounted on\nudev            7.8G     0  7.8G   0% /dev\ntmpfs           1.6G   61M  1.6G   4% /run\n/dev/sda2       917G   41G  830G   5% /\ntmpfs           7.9G     0  7.9G   0% /dev/shm\ntmpfs           5.0M     0  5.0M   0% /run/lock\ntmpfs           7.9G     0  7.9G   0% /sys/fs/cgroup\n/dev/sda1       511M  888K  511M   1% /boot/efi\ncgmfs           100K     0  100K   0% /run/cgmanager/fs\ntmpfs           1.6G     0  1.6G   0% /run/user/1002\ntmpfs           1.6G     0  1.6G   0% /run/user/1000\ntmpfs           1.6G     0  1.6G   0% /run/user/0\n\n3. Which networking type did you use?\n   nova-network\n\n4. Environment information:\n   Architecture : AARCH64\n   OS: Ubuntu 16.04\n\nDetailed log info is in the accessory.\nThe guest xml is also in the log info.", 
    "tags": [
        "aarch64"
    ], 
    "importance": "Low", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1585893", 
    "owner": "https://api.launchpad.net/1.0/~kevin-zhao", 
    "id": 1585893, 
    "index": 745, 
    "created": "2016-05-26 06:31:56.664021+00:00", 
    "title": "Launch instance got libvirtError for qemu unsupported  IDE bus in AARCH64", 
    "comments": [
        {
            "content": "Description\n===========\nAfter setup the nova development environment with devstack in aarch64 machine ,use the glance upload the image ,then use nova to launch the instance.Launching failed with the error \"libvirtError: unsupported configuration: IDE controllers are unsupported for this QEMU binary or machine type\".\n \nSteps to reproduce\n==================\n1.Using devstack to deploy openstack. Using default local.conf.\n\n2.Upload the aarch64 image with glance.\n$ source ~/devstack/openrc admin admin\n$ glance image-create --name image-arm64.img --disk-format qcow2 --container-format bare --visibility public --file images/image-arm64-wily.qcow2 --progress\n$ glance image-create --name image-arm64.vmlinuz --disk-format aki --container-format aki --visibility public --file images/image-arm64-wily.vmlinuz --progress\n$ glance image-create --name image-arm64.initrd --disk-format ari --container-format ari --visibility public --file images/image-arm64-wily.initrd --progress\n$ IMAGE_UUID=$(glance image-list | grep image-arm64.img | awk '{ print $2 }')\n$ IMAGE_KERNEL_UUID=$(glance image-list | grep image-arm64.vmlinuz | awk '{ print $2 }')\n$ IMAGE_INITRD_UUID=$(glance image-list | grep image-arm64.initrd | awk '{ print $2 }')\n$ glance image-update --kernel-id ${IMAGE_KERNEL_UUID} --ramdisk-id ${IMAGE_INITRD_UUID} ${IMAGE_UUID}\n\n3.nova add keypair\n$ nova keypair-add default --pub-key ~/.ssh/id_rsa.pub\n\n4.Launch the instance:\n$ image=$(nova image-list | egrep \"image-arm64.img\"'[^-]' | awk '{ print $2 }')\n$ nova boot --flavor m1.medium --image ${image} --key-name default test-arm64\n\n5.screen -x and select the n-cpu session to see the output.\nThen will got the error.\n\nExpected result\n===============\nAfter spawningn the instance, use :\n$ nova list\nWe can see the instance is active.\n\nActual result\n=============\nGot the error: \nlibvirtError: unsupported configuration: IDE controllers are unsupported for this QEMU binary or machine type\n\nWe can see the detailed information\uff1a\n ERROR nova.compute.manager [req-75325207-6c1b-481d-b188-a66c0a64eb89 admin admin] [instance: 188aa5bc-173c-46ec-b872-6bacb512911e] Instance failed to spawn\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e] Traceback (most recent call last):\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2041, in _build_resources\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     yield resources\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1887, in _build_and_run_instance\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     block_device_info=block_device_info)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2569, in spawn\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     block_device_info=block_device_info)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 4713, in _create_domain_and_network\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     xml, pause=pause, power_on=power_on)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 4644, in _create_domain\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     guest.launch(pause=pause)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/virt/libvirt/guest.py\", line 142, in launch\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     self._encoded_xml, errors='ignore')\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 221, in __exit__\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     self.force_reraise()\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 197, in force_reraise\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     six.reraise(self.type_, self.value, self.tb)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/opt/stack/nova/nova/virt/libvirt/guest.py\", line 137, in launch\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     return self._domain.createWithFlags(flags)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 186, in doit\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 144, in proxy_call\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     rv = execute(f, *args, **kwargs)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 125, in execute\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     six.reraise(c, e, tb)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 83, in tworker\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     rv = meth(*args, **kwargs)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]   File \"/usr/local/lib/python2.7/dist-packages/libvirt.py\", line 1065, in createWithFlags\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e] libvirtError: unsupported configuration: IDE controllers are unsupported for this QEMU binary or machine type\n TRACE nova.compute.manager [instance: 188aa5bc-173c-46ec-b872-6bacb512911e]\n INFO nova.compute.manager [req-75325207-6c1b-481d-b188-a66c0a64eb89 admin admin] [instance: 188aa5bc-173c-46ec-b872-6bacb512911e] Terminating instance\n\nEnvironment\n===========\n1. Exact version of OpenStack you are running. See the following\n  list for all releases: http://docs.openstack.org/releases/\n   Nova development, commit code: 9a05d38f48ef0f630c5e49e332075b273cee38b9\n   \n\n2. Which hypervisor did you use?\n    Libvirt+KVM\n    $ kvm --version\n    QEMU emulator version 2.5.0 (Debian 1:2.5+dfsg-5ubuntu10.1), Copyright (c) 2003-2008 Fabrice Bellard\n    $ libvirtd --version\n    libvirtd (libvirt) 1.3.1\n\n2. Which storage type did you use?\n   In the host file system,all in one physics machine.q\nstack@u202154:/opt/stack/nova$ df -hl\nFilesystem      Size  Used Avail Use% Mounted on\nudev            7.8G     0  7.8G   0% /dev\ntmpfs           1.6G   61M  1.6G   4% /run\n/dev/sda2       917G   41G  830G   5% /\ntmpfs           7.9G     0  7.9G   0% /dev/shm\ntmpfs           5.0M     0  5.0M   0% /run/lock\ntmpfs           7.9G     0  7.9G   0% /sys/fs/cgroup\n/dev/sda1       511M  888K  511M   1% /boot/efi\ncgmfs           100K     0  100K   0% /run/cgmanager/fs\ntmpfs           1.6G     0  1.6G   0% /run/user/1002\ntmpfs           1.6G     0  1.6G   0% /run/user/1000\ntmpfs           1.6G     0  1.6G   0% /run/user/0\n\n3. Which networking type did you use?\n   nova-network\n\n4. Environment information:\n   Architecture : AARCH64\n   OS: Ubuntu 16.04\n\nDetailed log info is in the accessory.\nThe guest xml is also in the log info.", 
            "date_created": "2016-05-26 06:31:56.664021+00:00", 
            "author": "https://api.launchpad.net/1.0/~kevin-zhao"
        }, 
        {
            "content": "", 
            "date_created": "2016-05-26 06:31:56.664021+00:00", 
            "author": "https://api.launchpad.net/1.0/~kevin-zhao"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/323244", 
            "date_created": "2016-05-31 09:22:28.530432+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/323244\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=36998c05d5b3c23a6b35bd0620d8a0f5f7e5d80c\nSubmitter: Jenkins\nBranch:    master\n\ncommit 36998c05d5b3c23a6b35bd0620d8a0f5f7e5d80c\nAuthor: Kevin Zhao <email address hidden>\nDate:   Tue May 31 02:54:40 2016 +0000\n\n    Specify the default cdrom type \"scsi\" for AARCH64.\n    \n    In AARCH64,ide is not the proper type for cdrom device just like\n    in x86_64.So change this to scsi in case of qemu error. Also add\n    a test for this.\n    \n    Close-Bug: #1585893\n    \n    Change-Id: Ia1cfde9f96fa54de0b352a7e6e903898b1eb7476\n    Signed-off-by: Kevin Zhao <email address hidden>\n", 
            "date_created": "2016-06-07 11:47:25.591258+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Since the Mitaka cycle we use the direct release model, which means this should be Fix Released.", 
            "date_created": "2016-06-22 00:36:28.742540+00:00", 
            "author": "https://api.launchpad.net/1.0/~auggy"
        }, 
        {
            "content": "Fix proposed to branch: stable/mitaka\nReview: https://review.openstack.org/387659", 
            "date_created": "2016-10-17 20:03:11.096793+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Dirk Mueller (<email address hidden>) on branch: stable/mitaka\nReview: https://review.openstack.org/387659", 
            "date_created": "2016-10-19 07:50:56.961718+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}