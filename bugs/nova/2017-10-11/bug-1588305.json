{
    "status": "Fix Released", 
    "last_updated": "2016-07-14 13:01:55.331569+00:00", 
    "description": "I set this value in nova.conf\nreserved_huge_pages = node=0,size=2048,count=4\n\n\nnova-compute restart failed.\n\nLog is as follow:\n\n2016-06-02 18:56:04.521 CRITICAL nova [req-e9dd76d9-4a4b-4571-bb88-78d751f74274 None None] TypeError: value_type must be callable\n\n2016-06-02 18:56:04.521 TRACE nova Traceback (most recent call last):\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/bin/nova-compute\", line 10, in <module>\n2016-06-02 18:56:04.521 TRACE nova sys.exit(main())\n2016-06-02 18:56:04.521 TRACE nova File \"/opt/stack/nova/nova/cmd/compute.py\", line 76, in main\n2016-06-02 18:56:04.521 TRACE nova service.wait()\n2016-06-02 18:56:04.521 TRACE nova File \"/opt/stack/nova/nova/service.py\", line 491, in wait\n2016-06-02 18:56:04.521 TRACE nova _launcher.wait()\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_service/service.py\", line 309, in wait\n2016-06-02 18:56:04.521 TRACE nova status, signo = self._wait_for_exit_or_signal()\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_service/service.py\", line 284, in _wait_for_exit_or_signal\n2016-06-02 18:56:04.521 TRACE nova self.conf.log_opt_values(LOG, logging.DEBUG)\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2525, in log_opt_values\n2016-06-02 18:56:04.521 TRACE nova _sanitize(opt, getattr(group_attr, opt_name)))\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2946, in __getattr__\n2016-06-02 18:56:04.521 TRACE nova return self._conf._get(name, self._group)\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2567, in _get\n2016-06-02 18:56:04.521 TRACE nova value = self._do_get(name, group, namespace)\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2604, in _do_get\n2016-06-02 18:56:04.521 TRACE nova return convert(opt._get_from_namespace(namespace, group_name))\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2595, in convert\n2016-06-02 18:56:04.521 TRACE nova self._substitute(value, group, namespace), opt)\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2671, in _convert_value\n2016-06-02 18:56:04.521 TRACE nova return [opt.type(v) for v in value]\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/types.py\", line 478, in __init__\n2016-06-02 18:56:04.521 TRACE nova raise TypeError('value_type must be callable')\n2016-06-02 18:56:04.521 TRACE nova TypeError: value_type must be callable\n2016-06-02 18:56:04.521 TRACE nova", 
    "tags": [], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1588305", 
    "owner": "https://api.launchpad.net/1.0/~sdague", 
    "id": 1588305, 
    "index": 1930, 
    "created": "2016-06-02 11:10:27.367636+00:00", 
    "title": "config reserved_huge_pages, nova-compute start failed", 
    "comments": [
        {
            "content": "I set this value in nova.conf\nreserved_huge_pages = node=0,size=2048,count=4\n\n\nnova-compute restart failed.\n\nLog is as follow:\n\n2016-06-02 18:56:04.521 CRITICAL nova [req-e9dd76d9-4a4b-4571-bb88-78d751f74274 None None] TypeError: value_type must be callable\n\n2016-06-02 18:56:04.521 TRACE nova Traceback (most recent call last):\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/bin/nova-compute\", line 10, in <module>\n2016-06-02 18:56:04.521 TRACE nova sys.exit(main())\n2016-06-02 18:56:04.521 TRACE nova File \"/opt/stack/nova/nova/cmd/compute.py\", line 76, in main\n2016-06-02 18:56:04.521 TRACE nova service.wait()\n2016-06-02 18:56:04.521 TRACE nova File \"/opt/stack/nova/nova/service.py\", line 491, in wait\n2016-06-02 18:56:04.521 TRACE nova _launcher.wait()\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_service/service.py\", line 309, in wait\n2016-06-02 18:56:04.521 TRACE nova status, signo = self._wait_for_exit_or_signal()\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_service/service.py\", line 284, in _wait_for_exit_or_signal\n2016-06-02 18:56:04.521 TRACE nova self.conf.log_opt_values(LOG, logging.DEBUG)\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2525, in log_opt_values\n2016-06-02 18:56:04.521 TRACE nova _sanitize(opt, getattr(group_attr, opt_name)))\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2946, in __getattr__\n2016-06-02 18:56:04.521 TRACE nova return self._conf._get(name, self._group)\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2567, in _get\n2016-06-02 18:56:04.521 TRACE nova value = self._do_get(name, group, namespace)\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2604, in _do_get\n2016-06-02 18:56:04.521 TRACE nova return convert(opt._get_from_namespace(namespace, group_name))\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2595, in convert\n2016-06-02 18:56:04.521 TRACE nova self._substitute(value, group, namespace), opt)\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/cfg.py\", line 2671, in _convert_value\n2016-06-02 18:56:04.521 TRACE nova return [opt.type(v) for v in value]\n2016-06-02 18:56:04.521 TRACE nova File \"/usr/lib/python2.7/site-packages/oslo_config/types.py\", line 478, in __init__\n2016-06-02 18:56:04.521 TRACE nova raise TypeError('value_type must be callable')\n2016-06-02 18:56:04.521 TRACE nova TypeError: value_type must be callable\n2016-06-02 18:56:04.521 TRACE nova", 
            "date_created": "2016-06-02 11:10:27.367636+00:00", 
            "author": "https://api.launchpad.net/1.0/~hanrong"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/324379", 
            "date_created": "2016-06-02 11:25:09.477848+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/324379\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=8093b764a9430a4e1c8cf2d73068f08117fec90e\nSubmitter: Jenkins\nBranch:    master\n\ncommit 8093b764a9430a4e1c8cf2d73068f08117fec90e\nAuthor: zte-hanrong <email address hidden>\nDate:   Thu Jun 2 19:23:46 2016 +0800\n\n    Fix nova-compute start failed when reserved_huge_pages has value.\n    \n    The problem is due to this change:\n    https://review.openstack.org/#/c/292499/20/nova/conf/virt.py\n    \n    The code of item_type=types.Dict is not correct, modfiy by\n    item_type=types.Dict().\n    \n    Modify the usage discription of config of reserved_huge_pages.\n    Usage of oslo_config.types.Dict is key:value pairs separated by\n    commas.\n    \n    Add unit test because this is a complicated option that might not work\n    like people expect.\n    \n    Closes-Bug:#1588305\n    Change-Id: I06490866f24617cf99764ede73a1938c2d7b7b5c\n", 
            "date_created": "2016-06-07 14:38:16.740634+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.0.0b2 development milestone.", 
            "date_created": "2016-07-14 13:01:54.850984+00:00", 
            "author": "https://api.launchpad.net/1.0/~doug-hellmann"
        }
    ]
}