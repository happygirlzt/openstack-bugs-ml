{
    "status": "Fix Released", 
    "last_updated": "2013-04-04 11:17:19.983949+00:00", 
    "description": "something In no-db-compute changes caused extra_specs to be omitted from the instance during rescue leading to a failure when rescue is called:\n\n2013-02-26 11:44:30.139 ERROR nova.openstack.common.rpc.amqp [req-63168d2e-350b-4ee5-be1a-c72f7da3ebf0 demo demo] Exception during message handling\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 393, in _process_data\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 133, in dispatch\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 109, in wrapped\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 88, in wrapped\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 207, in decorated_function\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     pass\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 193, in decorated_function\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 258, in decorated_function\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 235, in decorated_function\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 222, in decorated_function\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1799, in rescue_instance\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     rescue_image_meta, admin_password)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1463, in rescue\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     image_meta, rescue=rescue_images)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2300, in to_xml\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     disk_info, rescue, block_device_info)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2115, in get_guest_config\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     for key, value in instance['extra_specs'].iteritems():\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp KeyError: 'extra_specs'\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp", 
    "tags": [], 
    "importance": "High", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1133572", 
    "owner": "https://api.launchpad.net/1.0/~danms", 
    "id": 1133572, 
    "index": 989, 
    "created": "2013-02-26 19:48:16.431967+00:00", 
    "title": "rescue is broken with no-db-compute", 
    "comments": [
        {
            "content": "something In no-db-compute changes caused extra_specs to be omitted from the instance during rescue leading to a failure when rescue is called:\n\n2013-02-26 11:44:30.139 ERROR nova.openstack.common.rpc.amqp [req-63168d2e-350b-4ee5-be1a-c72f7da3ebf0 demo demo] Exception during message handling\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 393, in _process_data\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 133, in dispatch\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 109, in wrapped\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 88, in wrapped\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 207, in decorated_function\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     pass\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 193, in decorated_function\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 258, in decorated_function\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 235, in decorated_function\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 222, in decorated_function\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1799, in rescue_instance\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     rescue_image_meta, admin_password)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1463, in rescue\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     image_meta, rescue=rescue_images)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2300, in to_xml\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     disk_info, rescue, block_device_info)\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2115, in get_guest_config\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp     for key, value in instance['extra_specs'].iteritems():\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp KeyError: 'extra_specs'\n2013-02-26 11:44:30.139 TRACE nova.openstack.common.rpc.amqp", 
            "date_created": "2013-02-26 19:48:16.431967+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/23114", 
            "date_created": "2013-02-27 20:56:56.525865+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/23114\nCommitted: http://github.com/openstack/nova/commit/6f47035605e471562a3c7de593a272cf1b5a3a86\nSubmitter: Jenkins\nBranch:    master\n\ncommit 6f47035605e471562a3c7de593a272cf1b5a3a86\nAuthor: Dan Smith <email address hidden>\nDate:   Wed Feb 27 14:50:50 2013 -0500\n\n    Add instance_type_get() to virt api\n    \n    ...and remove the use of instance['extra_specs'] from the libvirt and\n    baremetal virt drivers. Also remove the hack in instance_update()\n    which places them there in the first place.\n    \n    Fixes bug 1133572\n    \n    Change-Id: I39e9fabb28b48dc52ec47f58d76b0bf2c6ee0204\n", 
            "date_created": "2013-03-02 00:38:29.720289+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}