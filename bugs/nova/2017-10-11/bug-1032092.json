{
    "status": "Fix Released", 
    "last_updated": "2016-03-26 13:13:45.301237+00:00", 
    "description": "Description:\r\n\r\nWhen Request body is sent as \"Invalid XML\" request, HTTP 500 ERROR is returned instead of Bad Request exception(code :400).\r\n\r\nLOG :\r\n-----------------------\r\n1. Server Creation with invalid XML\r\n\r\nREQ: curl -i http://15.184.83.251:8774/v2/5e8e6e11adf74ee5b9141d4c6c5fad94/servers -X POST -H \"X-Auth-Project-Id: nova_auto_project\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\" -H \"X-Auth-Token: 9d956c15a34e40d0bb877a54de771764\"\r\n\r\nnovaclient.client: DEBUG: REQ BODY: <xml version=\"1.0\" encoding=\"UTF-8\"?> <server xmlns=\"http://15.184.83.251:5000/v2.0\" imageRef=\"5509c976-a040-467b-88a8-6a6566202bb0\" flavorRef=\"1\" name=\"auto_test_server_active\"> </server>\r\n\r\nnovaclient.client: DEBUG: RESP:{'date': 'Thu, 02 Aug 2012 08:11:31 GMT', 'status': '500', 'content-length': '192', 'content-type': 'application/xml; charset=UTF-8', 'x-compute-request-id': 'req-683ad7b0-5363-4fdc-8a68-e47309c0178c'} <computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>\r\n\r\n2. Set Image Metadata with invalid XML\r\n\r\nREQ: curl -i http://15.184.83.251:8774/v2/5e8e6e11adf74ee5b9141d4c6c5fad94/images/bf88d99f-a17f-4515-9a0d-969006939470/metadata/Label PUT -H \"X-Auth-Project-Id: nova_auto_project\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\" -H \"X-Auth-Token: a7a97182bbec44d19d578b997818de88\"\r\n\r\nnovaclient.client: DEBUG: REQ BODY: <?xml version=\"1.0\" encoding=\"UTF-8\"?> <metadata xmlns=\"http://docs.openstack.org/compute/api/v1.1\" key=\"Label\">>Web</meta>\r\n\r\nnovaclient.client: DEBUG: RESP:{'date': 'Thu, 02 Aug 2012 08:37:07 GMT', 'status': '500', 'content-length': '192', 'content-type': 'application/xml; charset=UTF-8', 'x-compute-request-id': 'req-50f195f5-ba68-49f7-9e2a-30fb499ce633'} <computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>\r\n\r\n3. Add Security Group Rule with invalid XML\r\n\r\nREQ: curl -i http://15.184.83.251:8774/v2/5e8e6e11adf74ee5b9141d4c6c5fad94/os-security-group-rules -X POST -H \"X-Auth-Project-Id: nova_auto_project\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\" -H \"X-Auth-Token: f1ff74fac1144ded8e830d1bda7ff8c4\"\r\n\r\nnovaclient.client: DEBUG: REQ BODY: <security_group_rule><ip_protocol>tcp</ip_protocol> <from_port>22</from_port><to_port>23</to_port> <parent_group_id>159</parnt_group_id> </security_group_rule>\r\n\r\nnovaclient.client: DEBUG: RESP:{'date': 'Thu, 02 Aug 2012 08:40:46 GMT', 'status': '500', 'content-length': '192', 'content-type': 'application/xml; charset=UTF-8', 'x-compute-request-id': 'req-bca76a87-c176-4b65-8ec3-28f06afa1412'} <computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>\r\n\r\n4. Create Security Group with invalid XML\r\n\r\nREQ: curl -i http://15.184.83.251:8774/v2/5e8e6e11adf74ee5b9141d4c6c5fad94/os-security-groups -X POST -H \"X-Auth-Project-Id: nova_auto_project\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\" -H \"X-Auth-Token: f1ff74fac1144ded8e830d1bda7ff8c4\"\r\n\r\nnovaclient.client: DEBUG: REQ BODY: <security_group name=\"test_auto_security_group_xml\"> <description>test_auto_security_group_xml<descption></security_group>\r\n\r\nnovaclient.client: DEBUG: RESP:{'date': 'Thu, 02 Aug 2012 08:40:47 GMT', 'status': '500', 'content-length': '192', 'content-type': 'application/xml; charset=UTF-8', 'x-compute-request-id': 'req-319ef63e-f086-4313-b073-1ee2c20052b3'} <computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>\r\n\r\n5. Reboot Server using invalid XML\r\n\r\nREQ: curl -i http://15.184.83.251:8774/v2/5e8e6e11adf74ee5b9141d4c6c5fad94/servers/c999a7fd-8c2a-4dc5-970b-ff13daa1d3e9/action -X POST -H \"X-Auth-Project-Id: nova_auto_project\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\" -H \"X-Auth-Token: 7675bb82ff514780873e5ff296137628\"\r\n\r\nnovaclient.client: DEBUG: REQ BODY: <?xml version=\"1.0\" encoding=\"UTF-8\"?>                          xns=\"http://15.184.83.251:5000/v2.0\" type\"HARD\"/>\r\n\r\nnovaclient.client: DEBUG: RESP:{'date': 'Thu, 02 Aug 2012 08:51:36 GMT', 'status': '500', 'content-length': '192', 'content-type': 'application/xml; charset=UTF-8', 'x-compute-request-id': 'req-f1373577-8f7b-4c00-919e-57b8ff48dbbf'} <computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>\r\n\r\n6. Rebuild Server using invalid XML\r\n\r\nnovaclient.client: DEBUG:\r\nREQ: curl -i http://15.184.83.251:8774/v2/5e8e6e11adf74ee5b9141d4c6c5fad94/servers/b281dd7e-2104-4553-8f8a-7a018cd9a427/action -X POST -H \"X-Auth-Project-Id: nova_auto_project\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\" -H \"X-Auth-Token: 7675bb82ff514780873e5ff296137628\"\r\n\r\nnovaclient.client: DEBUG: REQ BODY: <xml version=\"1.0\" encoding=\"UTF-8\"?>                             <rebuild xmlns=\"http://15.184.83.251:5000/v2.0\" imageRef=\"5509c976-a040-467b-88a8-6a6566202bb0\"/>\r\n\r\nnovaclient.client: DEBUG: RESP:{'date': 'Thu, 02 Aug 2012 08:51:36 GMT', 'status': '500', 'content-length': '192', 'content-type': 'application/xml; charset=UTF-8', 'x-compute-request-id': 'req-365a3796-15c0-4fb9-8467-6d110f0e582a'} <computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1032092", 
    "owner": "https://api.launchpad.net/1.0/~vijaya-erukala", 
    "id": 1032092, 
    "index": 2993, 
    "created": "2012-08-02 08:44:38.060364+00:00", 
    "title": "Invalid XML request is returning 500 ERROR instead of Bad Request 400 exception", 
    "comments": [
        {
            "content": "Description:\n\nWhen Request body is sent as \"Invalid XML\" request, HTTP 500 ERROR is returned nstead of Bad Request exception(code :400).\n\nLOG :\n-----------------------\n1. Server Creation with invalid XML\n\nREQ: curl -i http://15.184.83.251:8774/v2/5e8e6e11adf74ee5b9141d4c6c5fad94/servers -X POST -H \"X-Auth-Project-Id: nova_auto_project\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\" -H \"X-Auth-Token: 9d956c15a34e40d0bb877a54de771764\"\n\nnovaclient.client: DEBUG: REQ BODY: <xml version=\"1.0\" encoding=\"UTF-8\"?>                            <server xmlns=\"http://15.184.83.251:5000/v2.0\" imageRef=\"5509c976-a040-467b-88a8-6a6566202bb0\" flavorRef=\"1\" name=\"auto_test_server_active\">                            </server>\n\nnovaclient.client: DEBUG: RESP:{'date': 'Thu, 02 Aug 2012 08:11:31 GMT', 'status': '500', 'content-length': '192', 'content-type': 'application/xml; charset=UTF-8', 'x-compute-request-id': 'req-683ad7b0-5363-4fdc-8a68-e47309c0178c'} <computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>\n\n2. Set Image Metadata with invalid XML\n\nREQ: curl -i http://15.184.83.251:8774/v2/5e8e6e11adf74ee5b9141d4c6c5fad94/images/bf88d99f-a17f-4515-9a0d-969006939470/metadata/Label PUT -H \"X-Auth-Project-Id: nova_auto_project\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\" -H \"X-Auth-Token: a7a97182bbec44d19d578b997818de88\"\n\nnovaclient.client: DEBUG: REQ BODY: <?xml version=\"1.0\" encoding=\"UTF-8\"?>                            <metadata                            xmlns=\"http://docs.openstack.org/compute/api/v1.1\"                            key=\"Label\">>Web</meta>\n\nnovaclient.client: DEBUG: RESP:{'date': 'Thu, 02 Aug 2012 08:37:07 GMT', 'status': '500', 'content-length': '192', 'content-type': 'application/xml; charset=UTF-8', 'x-compute-request-id': 'req-50f195f5-ba68-49f7-9e2a-30fb499ce633'} <computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>\n\n3. Add Security Group Rule with invalid XML\n\nREQ: curl -i http://15.184.83.251:8774/v2/5e8e6e11adf74ee5b9141d4c6c5fad94/os-security-group-rules -X POST -H \"X-Auth-Project-Id: nova_auto_project\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\" -H \"X-Auth-Token: f1ff74fac1144ded8e830d1bda7ff8c4\"\n\nnovaclient.client: DEBUG: REQ BODY: <security_group_rule><ip_protocol>tcp</ip_protocol>                             <from_port>22</from_port><to_port>23</to_port>                             <parent_group_id>159</parnt_group_id>                             </security_group_rule>\n\nnovaclient.client: DEBUG: RESP:{'date': 'Thu, 02 Aug 2012 08:40:46 GMT', 'status': '500', 'content-length': '192', 'content-type': 'application/xml; charset=UTF-8', 'x-compute-request-id': 'req-bca76a87-c176-4b65-8ec3-28f06afa1412'} <computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>\n\n\n4. Create Security Group with invalid XML\n\nREQ: curl -i http://15.184.83.251:8774/v2/5e8e6e11adf74ee5b9141d4c6c5fad94/os-security-groups -X POST -H \"X-Auth-Project-Id: nova_auto_project\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\" -H \"X-Auth-Token: f1ff74fac1144ded8e830d1bda7ff8c4\"\n\nnovaclient.client: DEBUG: REQ BODY: <security_group name=\"test_auto_security_group_xml\">                        <description>test_auto_security_group_xml<descption></security_group>\n\nnovaclient.client: DEBUG: RESP:{'date': 'Thu, 02 Aug 2012 08:40:47 GMT', 'status': '500', 'content-length': '192', 'content-type': 'application/xml; charset=UTF-8', 'x-compute-request-id': 'req-319ef63e-f086-4313-b073-1ee2c20052b3'} <computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>", 
            "date_created": "2012-08-02 08:44:38.060364+00:00", 
            "author": "https://api.launchpad.net/1.0/~rajalakshmi-ganesan"
        }, 
        {
            "content": "Which version of Nova are you testing this against ?", 
            "date_created": "2012-08-22 13:01:20.763654+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "Hi Carrez,\n\nMy nova version was \"nova==2012.2\".", 
            "date_created": "2012-09-14 13:15:28.258454+00:00", 
            "author": "https://api.launchpad.net/1.0/~rajalakshmi-ganesan"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/13446", 
            "date_created": "2012-09-21 05:34:15.031612+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/13446\nCommitted: http://github.com/openstack/nova/commit/7a70bc33aca8428f38c70c6b85bba29977a41aaf\nSubmitter: Jenkins\nBranch:    master\n\ncommit 7a70bc33aca8428f38c70c6b85bba29977a41aaf\nAuthor: vijaya-erukala <email address hidden>\nDate:   Thu Sep 20 12:08:57 2012 +0530\n\n    Handle invalid xml request to return BadRequest\n    \n    Handled ExpatError,LookupError to return BadRequest\n    if the user inputs the invalid xml\n    \n    fixes bug 1032092\n    \n    Change-Id: I7374532d91e3d7675bc80730031a195f50bb2abc\n", 
            "date_created": "2012-10-16 21:34:12.456942+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "There is a similar bug also in cinder.\nThere is a similar code to the source corrected with nova also in cinder/api/openstack/wsgi.py of cinder. \nWhen Request body is sent as \"Invalid XML\" request, HTTP 500 ERROR is returned instead of Bad Request exception(code :400).\n", 
            "date_created": "2015-08-28 14:16:51.151587+00:00", 
            "author": "https://api.launchpad.net/1.0/~tanino-shingo"
        }, 
        {
            "content": "Unassigning due to no activity.", 
            "date_created": "2016-03-13 20:54:31.709805+00:00", 
            "author": "https://api.launchpad.net/1.0/~sean-mcginnis"
        }, 
        {
            "content": "This issue does not seem exist in cinder. Proper 400 error is shown on terminal for xml bad requests\n\nroot@sheel:/opt/stack/cinder# curl  -H \"X-Auth-Token:7edb9429407d473d91ce310907b64e66\" -H \"User-Agent: python-cinderclient\" -H \"Content-Type: application/xml\" -H \"Accept: application/xml\"   http://10.0.2.15:8776/v2/f270b245cb11498ca4031deb7e141cfa/types/898016e6-038e-4ae7-baad-2f07b4404567/encryption -X POST -d '{\"encryption\": {}}'\n<badRequest code=\"400\" xmlns=\"http://docs.openstack.org/api/openstack-block-storage/2.0/content\"><message>Malformed request body</message></badRequest>\n", 
            "date_created": "2016-03-26 13:13:30.237964+00:00", 
            "author": "https://api.launchpad.net/1.0/~ranasheel2000"
        }
    ]
}