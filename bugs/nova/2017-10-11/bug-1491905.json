{
    "status": "Opinion", 
    "last_updated": "2016-02-25 09:35:16.063787+00:00", 
    "description": "neutronclient in nova uses token_endpoint.Token as auth_plugin, which doesn't have functionality to re-authenticate  in case of 401 error. If keystone uses memcached as backend and it was restarted, token that neutronclient use become invalid, and no re-authentication attempts were made.  \nTrace in nova-api:\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/nova/network/neutronv2/api.py\", line 1519, in _build_network_info_model\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     data = client.list_ports(**search_opts)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 102, in with_params\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     ret = self.function(instance, args, *kwargs)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 534, in list_ports\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     **_params)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 307, in list\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     for r in self._pagination(collection, path, **params):\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 320, in _pagination\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     res = self.get(path, params=params)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 293, in get\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     headers=headers, params=params)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 270, in retry_request\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     headers=headers, params=params)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 211, in do_request\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     self._handle_fault_response(status_code, replybody)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 185, in _handle_fault_response\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     exception_handler_v20(status_code, des_error_body)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 83, in exception_handler_v20\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     message=message)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8] NeutronClientException: Authentication required\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 46, 
    "link": "https://bugs.launchpad.net/nova/+bug/1491905", 
    "owner": "https://api.launchpad.net/1.0/~tdurakov", 
    "id": 1491905, 
    "index": 5742, 
    "created": "2015-09-03 15:23:36.978741+00:00", 
    "title": "neutronclient in nova doesn't issue new token", 
    "comments": [
        {
            "content": "neutronclient in nova uses token_endpoint.Token as auth_plugin, which doesn't have functionality to re-authenticate  in case of 401 error. If keystone uses memcached as backend and it was restarted, token that neutronclient use become invalid, and no re-authentication attempts were made.  \nTrace in nova-api:\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/nova/network/neutronv2/api.py\", line 1519, in _build_network_info_model\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     data = client.list_ports(**search_opts)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 102, in with_params\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     ret = self.function(instance, args, *kwargs)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 534, in list_ports\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     **_params)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 307, in list\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     for r in self._pagination(collection, path, **params):\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 320, in _pagination\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     res = self.get(path, params=params)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 293, in get\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     headers=headers, params=params)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 270, in retry_request\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     headers=headers, params=params)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 211, in do_request\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     self._handle_fault_response(status_code, replybody)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 185, in _handle_fault_response\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     exception_handler_v20(status_code, des_error_body)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]   File \"/usr/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 83, in exception_handler_v20\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]     message=message)\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8] NeutronClientException: Authentication required\n2015-08-30 19:02:24.292 8914 TRACE nova.network.base_api [instance: 94ccc989-4531-43a9-a1bd-d7cf848f04a8]", 
            "date_created": "2015-09-03 15:23:36.978741+00:00", 
            "author": "https://api.launchpad.net/1.0/~tdurakov"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/220207", 
            "date_created": "2015-09-03 15:46:08.221471+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Timofey Durakov (<email address hidden>) on branch: master\nReview: https://review.openstack.org/220207\nReason: not actual", 
            "date_created": "2015-10-01 08:07:26.829339+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "@iwan where is the release?", 
            "date_created": "2015-12-13 12:03:22.074553+00:00", 
            "author": "https://api.launchpad.net/1.0/~luogangyi"
        }, 
        {
            "content": "Not sure the problem is in Nova at all, it should at least be a Neutron bug.", 
            "date_created": "2016-02-19 15:26:47.064740+00:00", 
            "author": "https://api.launchpad.net/1.0/~sylvain-bauza"
        }, 
        {
            "content": "Just had this issue pop up on a CentOS 7 / RDO (kilo release) installation when testing migration of a shut down instance in my setup. Shouldn't this be moved to Neutron instead of being marked as 'Opinion'? Furthermore, might this be a configuration issue?", 
            "date_created": "2016-02-25 09:35:15.336240+00:00", 
            "author": "https://api.launchpad.net/1.0/~2-silvan"
        }
    ]
}