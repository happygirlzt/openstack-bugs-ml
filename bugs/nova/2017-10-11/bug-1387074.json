{
    "status": "Fix Released", 
    "last_updated": "2016-08-09 15:35:38.558869+00:00", 
    "description": "When a vCenter is configured to listen to any port other the default 443. During instance launch the driver fails to make connection to vCenter when performing the glance image copy to the datastore.  \n\n\n2014-10-29 20:03:25.535 ERROR oslo.vmware.api [-] Task: (returnval){\n   value = \"session[565de56e-2576-69ae-ae5f-50daafe6b90f]525ec5a1-a9f7-6c80-3c22-d78fb31ac069\"\n   _type = \"Task\"\n } failed with error: File [datastore1 (1)] 10.1.195.24_base/46e35b38-64f2-4cca-aa53-31407cf9a28e was not found.\n2014-10-29 20:03:25.535 ERROR oslo.vmware.common.loopingcall [-] in fixed duration looping call\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall Traceback (most recent call last):\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall   File \"/usr/local/lib/python2.7/dist-packages/oslo/vmware/common/loopingcall.py\", line 76, in _inner\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall     self.f(*self.args, **self.kw)\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall   File \"/usr/local/lib/python2.7/dist-packages/oslo/vmware/api.py\", line 419, in _poll_task\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall     raise task_ex\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall FileNotFoundException: File [datastore1 (1)] 10.1.195.24_base/46e35b38-64f2-4cca-aa53-31407cf9a28e was not f\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall \n\n\n2014-10-29 19:21:16.448 ERROR nova.compute.manager [-] [instance: c2c69864-331a-4405-b589-4589d01cfd60] Instance failed to spawn\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60] Traceback (most recent call last):\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2244, in _build_resources\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     yield resources\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2114, in _build_and_run_instance\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     block_device_info=block_device_info)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 488, in spawn\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     admin_password, network_info, block_device_info)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 484, in spawn\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     self._fetch_image_if_missing(context, vi)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 421, in _fetch_image_if_missing\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     image_fetch(context, vi, tmp_image_ds_loc)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 293, in _fetch_image_as_file\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     cookies=cookies)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/images.py\", line 240, in fetch_image\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     host, dc_name, ds_name, cookies, file_path, file_size)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/read_write_util.py\", line 131, in __init__\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     conn.endheaders()\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/usr/lib/python2.7/httplib.py\", line 969, in endheaders\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     self._send_output(message_body)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/usr/lib/python2.7/httplib.py\", line 829, in _send_output\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     self.send(msg)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/usr/lib/python2.7/httplib.py\", line 791, in send\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     self.connect()\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/usr/lib/python2.7/httplib.py\", line 1172, in connect\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     self.timeout, self.source_address)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/green/socket.py\", line 60, in create_connection\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     raise error(msg)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60] error: [Errno 111] ECONNREFUSED\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60] \n2014-10-29 19:21:16.449 AUDIT nova.compute.manager [req-622143c1-d783-48bc-80b6-829d5f07121d admin admin] [instance: c2c69864-331a-4405-b589-4589d01cfd60] Terminating instance", 
    "tags": [
        "in-stable-mitaka", 
        "vmware"
    ], 
    "importance": "Medium", 
    "heat": 30, 
    "link": "https://bugs.launchpad.net/nova/+bug/1387074", 
    "owner": "https://api.launchpad.net/1.0/~jjohnsonkoilraj", 
    "id": 1387074, 
    "index": 4094, 
    "created": "2014-10-29 09:29:18.733401+00:00", 
    "title": "VMware: Failed to launch instance if vCenter is configured to listen to any port other than 443", 
    "comments": [
        {
            "content": "When a vCenter is configured to listen to any port other the default 443. During instance launch the driver fails to make connection to vCenter when performing the glance image copy to the datastore.  \n\n\n2014-10-29 20:03:25.535 ERROR oslo.vmware.api [-] Task: (returnval){\n   value = \"session[565de56e-2576-69ae-ae5f-50daafe6b90f]525ec5a1-a9f7-6c80-3c22-d78fb31ac069\"\n   _type = \"Task\"\n } failed with error: File [datastore1 (1)] 10.1.195.24_base/46e35b38-64f2-4cca-aa53-31407cf9a28e was not found.\n2014-10-29 20:03:25.535 ERROR oslo.vmware.common.loopingcall [-] in fixed duration looping call\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall Traceback (most recent call last):\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall   File \"/usr/local/lib/python2.7/dist-packages/oslo/vmware/common/loopingcall.py\", line 76, in _inner\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall     self.f(*self.args, **self.kw)\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall   File \"/usr/local/lib/python2.7/dist-packages/oslo/vmware/api.py\", line 419, in _poll_task\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall     raise task_ex\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall FileNotFoundException: File [datastore1 (1)] 10.1.195.24_base/46e35b38-64f2-4cca-aa53-31407cf9a28e was not f\n2014-10-29 20:03:25.535 TRACE oslo.vmware.common.loopingcall \n\n\n2014-10-29 19:21:16.448 ERROR nova.compute.manager [-] [instance: c2c69864-331a-4405-b589-4589d01cfd60] Instance failed to spawn\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60] Traceback (most recent call last):\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2244, in _build_resources\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     yield resources\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2114, in _build_and_run_instance\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     block_device_info=block_device_info)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 488, in spawn\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     admin_password, network_info, block_device_info)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 484, in spawn\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     self._fetch_image_if_missing(context, vi)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 421, in _fetch_image_if_missing\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     image_fetch(context, vi, tmp_image_ds_loc)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 293, in _fetch_image_as_file\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     cookies=cookies)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/images.py\", line 240, in fetch_image\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     host, dc_name, ds_name, cookies, file_path, file_size)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/opt/stack/nova/nova/virt/vmwareapi/read_write_util.py\", line 131, in __init__\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     conn.endheaders()\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/usr/lib/python2.7/httplib.py\", line 969, in endheaders\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     self._send_output(message_body)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/usr/lib/python2.7/httplib.py\", line 829, in _send_output\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     self.send(msg)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/usr/lib/python2.7/httplib.py\", line 791, in send\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     self.connect()\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/usr/lib/python2.7/httplib.py\", line 1172, in connect\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     self.timeout, self.source_address)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/green/socket.py\", line 60, in create_connection\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60]     raise error(msg)\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60] error: [Errno 111] ECONNREFUSED\n2014-10-29 19:21:16.448 TRACE nova.compute.manager [instance: c2c69864-331a-4405-b589-4589d01cfd60] \n2014-10-29 19:21:16.449 AUDIT nova.compute.manager [req-622143c1-d783-48bc-80b6-829d5f07121d admin admin] [instance: c2c69864-331a-4405-b589-4589d01cfd60] Terminating instance", 
            "date_created": "2014-10-29 09:29:18.733401+00:00", 
            "author": "https://api.launchpad.net/1.0/~jjohnsonkoilraj"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/140732", 
            "date_created": "2014-12-10 15:24:45.739837+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Johnson koil raj (<email address hidden>) on branch: master\nReview: https://review.openstack.org/140732\nReason: Submitting a new patch because of use of oslo.vmware lib for cinder vmdk driver", 
            "date_created": "2015-01-12 07:03:05.778487+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/146384", 
            "date_created": "2015-01-12 07:05:30.532591+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/131777\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=2009eab057d9cb1f1036dbbaed9ab6ff89aa6799\nSubmitter: Jenkins\nBranch:    master\n\ncommit 2009eab057d9cb1f1036dbbaed9ab6ff89aa6799\nAuthor: Johnson koil raj <email address hidden>\nDate:   Wed Oct 29 19:30:54 2014 +0530\n\n    VMware: driver not handling port other than 443\n    \n    During the image download/upload from a vCenter datastore the\n    driver is failing to connect to vCenter if it configured to\n    listen to any port other than default 443.\n    \n    Closes-Bug: #1387074\n    \n    Change-Id: Iebfd90bda2b9a3eb20ca146e4cc9ae8e4cf464f3\n", 
            "date_created": "2015-01-19 09:20:26.362133+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Mike Perez (<email address hidden>) on branch: master\nReview: https://review.openstack.org/146384\nReason: Over a month with no update.", 
            "date_created": "2015-08-16 07:56:25.220044+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/267450", 
            "date_created": "2016-01-14 10:25:59.746777+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/267450\nCommitted: https://git.openstack.org/cgit/openstack/cinder/commit/?id=55b442ce192e93a26d12064645aa95fd3661babb\nSubmitter: Jenkins\nBranch:    master\n\ncommit 55b442ce192e93a26d12064645aa95fd3661babb\nAuthor: Vipin Balachandran <email address hidden>\nDate:   Thu Jan 14 00:05:28 2016 -0800\n\n    VMware: Support for non-default port\n    \n    Currently the VMDK driver fails to connect to vCenter server\n    if vCenter is configured to listen to any port other than the\n    default port 443. This patch fixes it by adding support for a\n    new config option 'vmware_host_port' which specifies the port\n    number to connect to vCenter server.\n    \n    DocImpact\n      Added config option 'vmware_host_port' which specifies the\n      port number to connect to vCenter server.\n    \n    Change-Id: I71846cdc09bc1ff2a7e35d45aa7c639c468f1418\n    Co-Authored-By: Johnson koil raj <email address hidden>\n    Closes-Bug: #1387074\n", 
            "date_created": "2016-04-12 21:00:10.105520+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "@<email address hidden>, could you please cherry pick the fix into kilo branch? Thank you.", 
            "date_created": "2016-04-13 04:06:23.696986+00:00", 
            "author": "https://api.launchpad.net/1.0/~zzjiang"
        }, 
        {
            "content": "Fix proposed to branch: stable/mitaka\nReview: https://review.openstack.org/305601", 
            "date_created": "2016-04-14 03:53:37.561910+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/305601\nCommitted: https://git.openstack.org/cgit/openstack/cinder/commit/?id=83ef56a4187115422bbdb47dc218c243cef13054\nSubmitter: Jenkins\nBranch:    stable/mitaka\n\ncommit 83ef56a4187115422bbdb47dc218c243cef13054\nAuthor: Vipin Balachandran <email address hidden>\nDate:   Thu Jan 14 00:05:28 2016 -0800\n\n    VMware: Support for non-default port\n    \n    Currently the VMDK driver fails to connect to vCenter server\n    if vCenter is configured to listen to any port other than the\n    default port 443. This patch fixes it by adding support for a\n    new config option 'vmware_host_port' which specifies the port\n    number to connect to vCenter server.\n    \n    DocImpact\n      Added config option 'vmware_host_port' which specifies the\n      port number to connect to vCenter server.\n    \n    Change-Id: I71846cdc09bc1ff2a7e35d45aa7c639c468f1418\n    Co-Authored-By: Johnson koil raj <email address hidden>\n    Closes-Bug: #1387074\n    (cherry picked from commit 55b442ce192e93a26d12064645aa95fd3661babb)\n", 
            "date_created": "2016-04-15 17:38:40.447845+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/cinder 9.0.0.0b1 development milestone.", 
            "date_created": "2016-06-01 22:16:39.403388+00:00", 
            "author": "https://api.launchpad.net/1.0/~doug-hellmann"
        }, 
        {
            "content": "This issue was fixed in the openstack/cinder 8.1.0 release.", 
            "date_created": "2016-08-09 15:35:36.086547+00:00", 
            "author": "https://api.launchpad.net/1.0/~doug-hellmann"
        }
    ]
}