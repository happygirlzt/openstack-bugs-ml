{
    "status": "Fix Released", 
    "last_updated": "2012-02-27 10:31:44.962964+00:00", 
    "description": "The 066 migration fails in some cases. I received this traceback while upgrading a development install:\n\n2012-01-17 18:59:30,064 INFO nova [-] Updating 2e8b9130-1485-43e1-a077-98e0d9aca04c\n2012-01-17 18:59:30,068 INFO nova [-] VIFs for Instance 2e8b9130-1485-43e1-a077-98e0d9aca04c:\n [{'network_id': None, 'address': '02:16:3e:46:c7:f0', 'id': 1L, 'uuid': '088b1308-b448-4150-8293-30c1847f1fed'}]\n2012-01-17 18:59:30,073 DEBUG migrate.versioning.util [-] Disposing SQLAlchemy engine Engine(mysql://root:nova@127.0.0.1/nova) from (pid=23324) debug /home/johannes/openstack/nova/trunk/nova/log.py:175\nCommand failed, please check log for more info\n2012-01-17 18:59:30,076 CRITICAL nova [-] list index out of range\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/bin/nova-manage\", line 2382, in <module>\n(nova): TRACE:     main()\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/bin/nova-manage\", line 2370, in main\n(nova): TRACE:     fn(*fn_args, **fn_kwargs)\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/bin/nova-manage\", line 1207, in sync\n(nova): TRACE:     return migration.db_sync(version)\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/nova/db/migration.py\", line 35, in db_sync\n(nova): TRACE:     return IMPL.db_sync(version=version)\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/nova/db/sqlalchemy/migration.py\", line 51, in db_sync\n(nova): TRACE:     return versioning_api.upgrade(FLAGS.sql_connection, repo_path, version)\n(nova): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/migrate/versioning/api.py\", line 186, in upgrade\n(nova): TRACE:     return _migrate(url, repository, version, upgrade=True, err=err, **opts)\n(nova): TRACE:   File \"<string>\", line 2, in _migrate\n(nova): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/migrate/versioning/util/__init__.py\", line 159, in with_engine\n(nova): TRACE:     return f(*a, **kw)\n(nova): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/migrate/versioning/api.py\", line 365, in _migrate\n(nova): TRACE:     schema.runchange(ver, change, changeset.step)\n(nova): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/migrate/versioning/schema.py\", line 84, in runchange\n(nova): TRACE:     change.run(self.engine, step)\n(nova): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/migrate/versioning/script/py.py\", line 145, in run\n(nova): TRACE:     script_func(engine)\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/066_preload_instance_info_cache_table.py\", line 155, in upgrade\n(nova): TRACE:     network = get_network_by_id(vif['network_id'])[0]\n(nova): TRACE: IndexError: list index out of range\n(nova): TRACE:", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/917812", 
    "owner": "https://api.launchpad.net/1.0/~johannes.erdfelt", 
    "id": 917812, 
    "index": 2492, 
    "created": "2012-01-17 19:13:48.056313+00:00", 
    "title": "066 migration get_network_by_id list index out of range", 
    "comments": [
        {
            "content": "The 066 migration fails in some cases. I received this traceback while upgrading a development install:\n\n2012-01-17 18:59:30,064 INFO nova [-] Updating 2e8b9130-1485-43e1-a077-98e0d9aca04c\n2012-01-17 18:59:30,068 INFO nova [-] VIFs for Instance 2e8b9130-1485-43e1-a077-98e0d9aca04c:\n [{'network_id': None, 'address': '02:16:3e:46:c7:f0', 'id': 1L, 'uuid': '088b1308-b448-4150-8293-30c1847f1fed'}]\n2012-01-17 18:59:30,073 DEBUG migrate.versioning.util [-] Disposing SQLAlchemy engine Engine(mysql://root:nova@127.0.0.1/nova) from (pid=23324) debug /home/johannes/openstack/nova/trunk/nova/log.py:175\nCommand failed, please check log for more info\n2012-01-17 18:59:30,076 CRITICAL nova [-] list index out of range\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/bin/nova-manage\", line 2382, in <module>\n(nova): TRACE:     main()\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/bin/nova-manage\", line 2370, in main\n(nova): TRACE:     fn(*fn_args, **fn_kwargs)\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/bin/nova-manage\", line 1207, in sync\n(nova): TRACE:     return migration.db_sync(version)\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/nova/db/migration.py\", line 35, in db_sync\n(nova): TRACE:     return IMPL.db_sync(version=version)\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/nova/db/sqlalchemy/migration.py\", line 51, in db_sync\n(nova): TRACE:     return versioning_api.upgrade(FLAGS.sql_connection, repo_path, version)\n(nova): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/migrate/versioning/api.py\", line 186, in upgrade\n(nova): TRACE:     return _migrate(url, repository, version, upgrade=True, err=err, **opts)\n(nova): TRACE:   File \"<string>\", line 2, in _migrate\n(nova): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/migrate/versioning/util/__init__.py\", line 159, in with_engine\n(nova): TRACE:     return f(*a, **kw)\n(nova): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/migrate/versioning/api.py\", line 365, in _migrate\n(nova): TRACE:     schema.runchange(ver, change, changeset.step)\n(nova): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/migrate/versioning/schema.py\", line 84, in runchange\n(nova): TRACE:     change.run(self.engine, step)\n(nova): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/migrate/versioning/script/py.py\", line 145, in run\n(nova): TRACE:     script_func(engine)\n(nova): TRACE:   File \"/home/johannes/openstack/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/066_preload_instance_info_cache_table.py\", line 155, in upgrade\n(nova): TRACE:     network = get_network_by_id(vif['network_id'])[0]\n(nova): TRACE: IndexError: list index out of range\n(nova): TRACE:", 
            "date_created": "2012-01-17 19:13:48.056313+00:00", 
            "author": "https://api.launchpad.net/1.0/~johannes.erdfelt"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/3111", 
            "date_created": "2012-01-17 19:29:20.432912+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/3111\nCommitted: http://github.com/openstack/nova/commit/7397d8fc1dab0fed2a069af670f37f3002ae1d1d\nSubmitter: Jenkins\nBranch:    master\n\ncommit 7397d8fc1dab0fed2a069af670f37f3002ae1d1d\nAuthor: Johannes Erdfelt <email address hidden>\nDate:   Tue Jan 17 19:28:34 2012 +0000\n\n    Only update if there are networks to update\n    \n    Fixes bug 917812\n    \n    Change-Id: Ibb59e2ae634590fe57e777b720a84580c6ed64cc\n", 
            "date_created": "2012-01-17 23:31:21.640963+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}