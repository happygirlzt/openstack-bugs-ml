{
    "status": "Fix Released", 
    "last_updated": "2014-04-17 09:09:53.490462+00:00", 
    "description": "In some runs, particular stress tests, the GC may run for more than 25 seconds.  The current timeout is after 5*5 seconds and so this needs to be increased.\n\n2013-12-05 10:57:51.024 DEBUG nova.compute.manager [req-24f4e285-4e0d-48f6-8c19-793fd2735488 ListImageFiltersTestJSON-tempest-987533830-user ListImageFiltersTestJSON-tempest-987533830-tenant] [instance: 37b86681-9225-4786-82f2-f4110697fda6] Cleaning up image 6ccd3d8d-1918-4bbc-b448-af7ebb50ce33 from (pid=25289) decorated_function /opt/stack/nova/nova/compute/manager.py:321\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/compute/manager.py\", line 317, in decorated_function\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     *args, **kwargs)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2427, in snapshot_instance\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     task_states.IMAGE_SNAPSHOT)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2458, in _snapshot_instance\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     update_task_state)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/virt/xenapi/driver.py\", line 250, in snapshot\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     self._vmops.snapshot(context, instance, image_id, update_task_state)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 729, in snapshot\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     post_snapshot_callback=update_task_state) as vdi_uuids:\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/usr/lib/python2.7/contextlib.py\", line 17, in __enter__\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     return self.gen.next()\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/virt/xenapi/vm_utils.py\", line 782, in _snapshot_attached_here_impl\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     original_parent_uuid)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/virt/xenapi/vm_utils.py\", line 2044, in _wait_for_vhd_coalesce\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     raise exception.NovaException(msg)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6] NovaException: VHD coalesce attempts exceeded (5), giving up...\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]", 
    "tags": [
        "xenserver"
    ], 
    "importance": "Low", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1258169", 
    "owner": "https://api.launchpad.net/1.0/~bob-ball", 
    "id": 1258169, 
    "index": 5986, 
    "created": "2013-12-05 14:30:10.299250+00:00", 
    "title": "XenAPI: wait_for_vhd_coalesce times out when garbage collector still running", 
    "comments": [
        {
            "content": "In some runs, particular stress tests, the GC may run for more than 25 seconds.  The current timeout is after 5*5 seconds and so this needs to be increased.\n\n2013-12-05 10:57:51.024 DEBUG nova.compute.manager [req-24f4e285-4e0d-48f6-8c19-793fd2735488 ListImageFiltersTestJSON-tempest-987533830-user ListImageFiltersTestJSON-tempest-987533830-tenant] [instance: 37b86681-9225-4786-82f2-f4110697fda6] Cleaning up image 6ccd3d8d-1918-4bbc-b448-af7ebb50ce33 from (pid=25289) decorated_function /opt/stack/nova/nova/compute/manager.py:321\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/compute/manager.py\", line 317, in decorated_function\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     *args, **kwargs)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2427, in snapshot_instance\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     task_states.IMAGE_SNAPSHOT)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2458, in _snapshot_instance\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     update_task_state)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/virt/xenapi/driver.py\", line 250, in snapshot\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     self._vmops.snapshot(context, instance, image_id, update_task_state)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 729, in snapshot\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     post_snapshot_callback=update_task_state) as vdi_uuids:\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/usr/lib/python2.7/contextlib.py\", line 17, in __enter__\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     return self.gen.next()\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/virt/xenapi/vm_utils.py\", line 782, in _snapshot_attached_here_impl\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     original_parent_uuid)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]   File \"/opt/stack/nova/nova/virt/xenapi/vm_utils.py\", line 2044, in _wait_for_vhd_coalesce\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]     raise exception.NovaException(msg)\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6] NovaException: VHD coalesce attempts exceeded (5), giving up...\n2013-12-05 10:57:51.024 TRACE nova.compute.manager [instance: 37b86681-9225-4786-82f2-f4110697fda6]", 
            "date_created": "2013-12-05 14:30:10.299250+00:00", 
            "author": "https://api.launchpad.net/1.0/~bob-ball"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/60253\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=270d4f1d6b100c802a65b31d35e406528aa7fd27\nSubmitter: Jenkins\nBranch:    master\n\ncommit 270d4f1d6b100c802a65b31d35e406528aa7fd27\nAuthor: Bob Ball <email address hidden>\nDate:   Thu Dec 5 14:35:14 2013 +0000\n\n    XenAPI: Monitor the GC when coalescing\n    \n    Add a new host plugin to monitor whether the garbage collector is running.\n    This is then used by the wait_for_vhd_coalesce function to know whether\n    waiting any more is likely to produce the expected results.\n    \n    Increased the number of times we loop waiting for coalesce as the loop\n    now has knowledge that something is still happening.\n    \n    DocImpact\n    Change to parameter default.\n    \n    Change-Id: Idcc0738945bd1aee8cdb52c9cfabd798f85c31db\n    Closes-bug: 1258169\n", 
            "date_created": "2014-02-07 17:46:53.094738+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}