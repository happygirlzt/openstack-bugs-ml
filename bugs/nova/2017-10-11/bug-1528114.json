{
    "status": "Fix Released", 
    "last_updated": "2016-02-03 13:50:04.607781+00:00", 
    "description": "1. I take a snapshot from vmware instance, then the snapshot image(which is link_clone of snapshot) will be saved in glance server.\n2. Start from this snapshot image from glance server. then got the following error\n\n2015-12-15 01:32:05.255 25992 DEBUG oslo_vmware.api [-] Invoking VIM API to read info of task: (returnval){\n   value = \"task-1896\"\n   _type = \"Task\"\n }. _poll_task /usr/lib/python2.7/site-packages/oslo_vmware/api.py:397\n2015-12-15 01:32:05.255 25992 DEBUG oslo_vmware.api [-] Waiting for function _invoke_api to return. func /usr/lib/python2.7/site-packages/oslo_vmware/api.py:121\n\n2015-12-15 01:32:05.285 25992 DEBUG oslo_vmware.exceptions [-] Fault InvalidArgument not matched. get_fault_class /usr/lib/python2.7/site-packages/oslo_vmware/exceptions.py:296\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall [-] in fixed duration looping call\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall Traceback (most recent call last):\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall   File \"/usr/lib/python2.7/site-packages/oslo_vmware/common/loopingcall.py\", line 76, in _inner\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall     self.f(*self.args, **self.kw)\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall   File \"/usr/lib/python2.7/site-packages/oslo_vmware/api.py\", line 428, in _poll_task\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall     raise task_ex\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall VimFaultException: \u6307\u5b9a\u7684\u53c2\u6570\u9519\u8bef\u3002\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall capacity\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall Faults: ['InvalidArgument']\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall\n2015-12-15 01:32:05.286 25992 ERROR nova.virt.vmwareapi.vmops [req-c466c53c-0a9c-45d7-aa78-c8812b4021a2 4b7fde8604c24e919e46b68fdf50b5a5 b0eab665ecd94e86885e03027ab90528 - - -] [instance: bea53465-ac4f-40f4-9937-f99024a8075d] Extending virtual disk failed with error: \u6307\u5b9a\u7684\u53c2\u6570\u9519\u8bef\u3002\ncapacity\n\n3. I track the error, \nnova/virt/vmwareapi/vmops.py\n def spawn()\n    self._use_disk_image_as_linked_clone(vm_ref, vi)\n      self._extend_if_required\n        self._extend_virtual_disk() \n            def _extend_virtual_disk()\n                vmdk_extend_task = self._session._call_method(\n                self._session.vim,\n                \"ExtendVirtualDisk_Task\",\n                service_content.virtualDiskManager,\n                name=name,\n                datacenter=dc_ref,\n                newCapacityKb=requested_size,\n                eagerZero=False)\nmy vimserver is :\n/opt/stack/vmware/wsdl/5.0/vimService.wsdl\nvcenter version is :5.1.0\nopenstack version is : Liberty\n\n4. When I shield _extend_if_required in _use_disk_image_as_linked_clone, then will be successful.", 
    "tags": [
        "vmware"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1528114", 
    "owner": "https://api.launchpad.net/1.0/~rgerganov", 
    "id": 1528114, 
    "index": 5927, 
    "created": "2015-12-21 07:19:43.335791+00:00", 
    "title": "vmware start instance from snapshot error", 
    "comments": [
        {
            "content": "1. I take a snapshot from vmware instance, then the snapshot image(which is link_clone of snapshot) will be saved in glance server.\n2. Start from this snapshot image from glance server. then got the following error\n\n2015-12-15 01:32:05.255 25992 DEBUG oslo_vmware.api [-] Invoking VIM API to read info of task: (returnval){\n   value = \"task-1896\"\n   _type = \"Task\"\n }. _poll_task /usr/lib/python2.7/site-packages/oslo_vmware/api.py:397\n2015-12-15 01:32:05.255 25992 DEBUG oslo_vmware.api [-] Waiting for function _invoke_api to return. func /usr/lib/python2.7/site-packages/oslo_vmware/api.py:121\n\n2015-12-15 01:32:05.285 25992 DEBUG oslo_vmware.exceptions [-] Fault InvalidArgument not matched. get_fault_class /usr/lib/python2.7/site-packages/oslo_vmware/exceptions.py:296\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall [-] in fixed duration looping call\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall Traceback (most recent call last):\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall   File \"/usr/lib/python2.7/site-packages/oslo_vmware/common/loopingcall.py\", line 76, in _inner\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall     self.f(*self.args, **self.kw)\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall   File \"/usr/lib/python2.7/site-packages/oslo_vmware/api.py\", line 428, in _poll_task\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall     raise task_ex\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall VimFaultException: \u6307\u5b9a\u7684\u53c2\u6570\u9519\u8bef\u3002\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall capacity\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall Faults: ['InvalidArgument']\n2015-12-15 01:32:05.285 25992 ERROR oslo_vmware.common.loopingcall\n2015-12-15 01:32:05.286 25992 ERROR nova.virt.vmwareapi.vmops [req-c466c53c-0a9c-45d7-aa78-c8812b4021a2 4b7fde8604c24e919e46b68fdf50b5a5 b0eab665ecd94e86885e03027ab90528 - - -] [instance: bea53465-ac4f-40f4-9937-f99024a8075d] Extending virtual disk failed with error: \u6307\u5b9a\u7684\u53c2\u6570\u9519\u8bef\u3002\ncapacity\n\n3. I track the error, \nnova/virt/vmwareapi/vmops.py\n def spawn()\n    self._use_disk_image_as_linked_clone(vm_ref, vi)\n      self._extend_if_required\n        self._extend_virtual_disk() \n            def _extend_virtual_disk()\n                vmdk_extend_task = self._session._call_method(\n                self._session.vim,\n                \"ExtendVirtualDisk_Task\",\n                service_content.virtualDiskManager,\n                name=name,\n                datacenter=dc_ref,\n                newCapacityKb=requested_size,\n                eagerZero=False)\nmy vimserver is :\n/opt/stack/vmware/wsdl/5.0/vimService.wsdl\nvcenter version is :5.1.0\nopenstack version is : Liberty\n\n4. When I shield _extend_if_required in _use_disk_image_as_linked_clone, then will be successful.", 
            "date_created": "2015-12-21 07:19:43.335791+00:00", 
            "author": "https://api.launchpad.net/1.0/~hawkerous"
        }, 
        {
            "content": "Merged-Fix: https://review.openstack.org/#/c/168024/", 
            "date_created": "2016-02-03 13:49:38.616171+00:00", 
            "author": "https://api.launchpad.net/1.0/~andreykurilin"
        }
    ]
}