{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:35:28.954536+00:00", 
    "description": "running 2013.1 on CentOS 6.4, error only occurred after moving to grizzly (previously running folsom)\nupon starting nova-network:\n\n2013-04-10 11:51:28.993 54896 INFO nova.manager [-] Skipping periodic task _periodic_update_dns because its interval is negative\n2013-04-10 11:51:28.994 54896 INFO nova.network.driver [-] Loading network driver 'nova.network.linux_net'\n2013-04-10 11:51:29.016 54896 AUDIT nova.service [-] Starting network node (version 2013.1-1.el6)\n2013-04-10 11:51:33.176 54896 CRITICAL nova [-] Unexpected error while running command.\nCommand: sudo nova-rootwrap /etc/nova/rootwrap.conf env CONFIG_FILE=[\"/etc/nova/nova.conf\"] NETWORK_ID=1 dnsmasq --strict-order --bind-interfaces --conf-file=/etc/dnsmasq-nova.conf --domain='nova.local' --pid-file=/var/lib/nova/networks/nova-br128.pid --listen-address=10.1.128.12 --except-interface=lo --dhcp-range=set:rbchq0,10.1.128.3,static,255.255.252.0,120s --dhcp-lease-max=1024 --dhcp-hostsfile=/var/lib/nova/networks/nova-br128.conf --dhcp-script=/usr/bin/nova-dhcpbridge --leasefile-ro --no-hosts\nExit code: 1\nStdout: ''\nStderr: '\\ndnsmasq: bad command line options: try --help\\n'\n2013-04-10 11:51:33.176 54896 TRACE nova Traceback (most recent call last):\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/bin/nova-network\", line 54, in <module>\n2013-04-10 11:51:33.176 54896 TRACE nova     service.wait()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/service.py\", line 689, in wait\n2013-04-10 11:51:33.176 54896 TRACE nova     _launcher.wait()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/service.py\", line 209, in wait\n2013-04-10 11:51:33.176 54896 TRACE nova     super(ServiceLauncher, self).wait()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/service.py\", line 179, in wait\n2013-04-10 11:51:33.176 54896 TRACE nova     service.wait()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/eventlet/greenthread.py\", line 166, in wait\n2013-04-10 11:51:33.176 54896 TRACE nova     return self._exit_event.wait()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/eventlet/event.py\", line 116, in wait\n2013-04-10 11:51:33.176 54896 TRACE nova     return hubs.get_hub().switch()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/eventlet/hubs/hub.py\", line 177, in switch\n2013-04-10 11:51:33.176 54896 TRACE nova     return self.greenlet.switch()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/eventlet/greenthread.py\", line 192, in main\n2013-04-10 11:51:33.176 54896 TRACE nova     result = function(*args, **kwargs)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/service.py\", line 147, in run_server\n2013-04-10 11:51:33.176 54896 TRACE nova     server.start()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/service.py\", line 429, in start\n2013-04-10 11:51:33.176 54896 TRACE nova     self.manager.init_host()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/manager.py\", line 1680, in init_host\n2013-04-10 11:51:33.176 54896 TRACE nova     NetworkManager.init_host(self)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/manager.py\", line 345, in init_host\n2013-04-10 11:51:33.176 54896 TRACE nova     self._setup_network_on_host(ctxt, network)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 228, in inner\n2013-04-10 11:51:33.176 54896 TRACE nova     retval = f(*args, **kwargs)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/manager.py\", line 1837, in _setup_network_on_host\n2013-04-10 11:51:33.176 54896 TRACE nova     self.driver.update_dhcp(elevated, dev, network)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/linux_net.py\", line 938, in update_dhcp\n2013-04-10 11:51:33.176 54896 TRACE nova     restart_dhcp(context, dev, network_ref)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 242, in inner\n2013-04-10 11:51:33.176 54896 TRACE nova     retval = f(*args, **kwargs)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/linux_net.py\", line 1049, in restart_dhcp\n2013-04-10 11:51:33.176 54896 TRACE nova     _execute(*cmd, run_as_root=True)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/linux_net.py\", line 1142, in _execute\n2013-04-10 11:51:33.176 54896 TRACE nova     return utils.execute(*cmd, **kwargs)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 239, in execute\n2013-04-10 11:51:33.176 54896 TRACE nova     cmd=' '.join(cmd))\n2013-04-10 11:51:33.176 54896 TRACE nova ProcessExecutionError: Unexpected error while running command.\n2013-04-10 11:51:33.176 54896 TRACE nova Command: sudo nova-rootwrap /etc/nova/rootwrap.conf env CONFIG_FILE=[\"/etc/nova/nova.conf\"] NETWORK_ID=1 dnsmasq --strict-order --bind-interfaces --conf-file=/etc/dnsmasq-nova.conf --domain='nova.local' --pid-file=/var/lib/nova/networks/nova-br128.pid --listen-address=10.1.128.12 --except-interface=lo --dhcp-range=set:rbchq0,10.1.128.3,static,255.255.252.0,120s --dhcp-lease-max=1024 --dhcp-hostsfile=/var/lib/nova/networks/nova-br128.conf --dhcp-script=/usr/bin/nova-dhcpbridge --leasefile-ro --no-hosts\n2013-04-10 11:51:33.176 54896 TRACE nova Exit code: 1\n2013-04-10 11:51:33.176 54896 TRACE nova Stdout: ''\n2013-04-10 11:51:33.176 54896 TRACE nova Stderr: '\\ndnsmasq: bad command line options: try --help\\n'\n2013-04-10 11:51:33.176 54896 TRACE nova\n\nif i attempt to run the dnsmasq command myself it does not complain", 
    "tags": [], 
    "importance": "High", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1167447", 
    "owner": "https://api.launchpad.net/1.0/~p-draigbrady", 
    "id": 1167447, 
    "index": 1052, 
    "created": "2013-04-10 16:57:34.840185+00:00", 
    "title": "dnsmasq fails to start", 
    "comments": [
        {
            "content": "running 2013.1 on CentOS 6.4, error only occurred after moving to grizzly (previously running folsom)\nupon starting nova-network:\n\n2013-04-10 11:51:28.993 54896 INFO nova.manager [-] Skipping periodic task _periodic_update_dns because its interval is negative\n2013-04-10 11:51:28.994 54896 INFO nova.network.driver [-] Loading network driver 'nova.network.linux_net'\n2013-04-10 11:51:29.016 54896 AUDIT nova.service [-] Starting network node (version 2013.1-1.el6)\n2013-04-10 11:51:33.176 54896 CRITICAL nova [-] Unexpected error while running command.\nCommand: sudo nova-rootwrap /etc/nova/rootwrap.conf env CONFIG_FILE=[\"/etc/nova/nova.conf\"] NETWORK_ID=1 dnsmasq --strict-order --bind-interfaces --conf-file=/etc/dnsmasq-nova.conf --domain='nova.local' --pid-file=/var/lib/nova/networks/nova-br128.pid --listen-address=10.1.128.12 --except-interface=lo --dhcp-range=set:rbchq0,10.1.128.3,static,255.255.252.0,120s --dhcp-lease-max=1024 --dhcp-hostsfile=/var/lib/nova/networks/nova-br128.conf --dhcp-script=/usr/bin/nova-dhcpbridge --leasefile-ro --no-hosts\nExit code: 1\nStdout: ''\nStderr: '\\ndnsmasq: bad command line options: try --help\\n'\n2013-04-10 11:51:33.176 54896 TRACE nova Traceback (most recent call last):\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/bin/nova-network\", line 54, in <module>\n2013-04-10 11:51:33.176 54896 TRACE nova     service.wait()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/service.py\", line 689, in wait\n2013-04-10 11:51:33.176 54896 TRACE nova     _launcher.wait()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/service.py\", line 209, in wait\n2013-04-10 11:51:33.176 54896 TRACE nova     super(ServiceLauncher, self).wait()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/service.py\", line 179, in wait\n2013-04-10 11:51:33.176 54896 TRACE nova     service.wait()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/eventlet/greenthread.py\", line 166, in wait\n2013-04-10 11:51:33.176 54896 TRACE nova     return self._exit_event.wait()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/eventlet/event.py\", line 116, in wait\n2013-04-10 11:51:33.176 54896 TRACE nova     return hubs.get_hub().switch()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/eventlet/hubs/hub.py\", line 177, in switch\n2013-04-10 11:51:33.176 54896 TRACE nova     return self.greenlet.switch()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/eventlet/greenthread.py\", line 192, in main\n2013-04-10 11:51:33.176 54896 TRACE nova     result = function(*args, **kwargs)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/service.py\", line 147, in run_server\n2013-04-10 11:51:33.176 54896 TRACE nova     server.start()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/service.py\", line 429, in start\n2013-04-10 11:51:33.176 54896 TRACE nova     self.manager.init_host()\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/manager.py\", line 1680, in init_host\n2013-04-10 11:51:33.176 54896 TRACE nova     NetworkManager.init_host(self)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/manager.py\", line 345, in init_host\n2013-04-10 11:51:33.176 54896 TRACE nova     self._setup_network_on_host(ctxt, network)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 228, in inner\n2013-04-10 11:51:33.176 54896 TRACE nova     retval = f(*args, **kwargs)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/manager.py\", line 1837, in _setup_network_on_host\n2013-04-10 11:51:33.176 54896 TRACE nova     self.driver.update_dhcp(elevated, dev, network)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/linux_net.py\", line 938, in update_dhcp\n2013-04-10 11:51:33.176 54896 TRACE nova     restart_dhcp(context, dev, network_ref)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 242, in inner\n2013-04-10 11:51:33.176 54896 TRACE nova     retval = f(*args, **kwargs)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/linux_net.py\", line 1049, in restart_dhcp\n2013-04-10 11:51:33.176 54896 TRACE nova     _execute(*cmd, run_as_root=True)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/network/linux_net.py\", line 1142, in _execute\n2013-04-10 11:51:33.176 54896 TRACE nova     return utils.execute(*cmd, **kwargs)\n2013-04-10 11:51:33.176 54896 TRACE nova   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 239, in execute\n2013-04-10 11:51:33.176 54896 TRACE nova     cmd=' '.join(cmd))\n2013-04-10 11:51:33.176 54896 TRACE nova ProcessExecutionError: Unexpected error while running command.\n2013-04-10 11:51:33.176 54896 TRACE nova Command: sudo nova-rootwrap /etc/nova/rootwrap.conf env CONFIG_FILE=[\"/etc/nova/nova.conf\"] NETWORK_ID=1 dnsmasq --strict-order --bind-interfaces --conf-file=/etc/dnsmasq-nova.conf --domain='redbrickhealth.local' --pid-file=/var/lib/nova/networks/nova-br128.pid --listen-address=10.1.128.12 --except-interface=lo --dhcp-range=set:rbchq0,10.1.128.3,static,255.255.252.0,120s --dhcp-lease-max=1024 --dhcp-hostsfile=/var/lib/nova/networks/nova-br128.conf --dhcp-script=/usr/bin/nova-dhcpbridge --leasefile-ro --no-hosts\n2013-04-10 11:51:33.176 54896 TRACE nova Exit code: 1\n2013-04-10 11:51:33.176 54896 TRACE nova Stdout: ''\n2013-04-10 11:51:33.176 54896 TRACE nova Stderr: '\\ndnsmasq: bad command line options: try --help\\n'\n2013-04-10 11:51:33.176 54896 TRACE nova \n\n\n\nif i attempt to run the dnsmasq command myself it does not complain", 
            "date_created": "2013-04-10 16:57:34.840185+00:00", 
            "author": "https://api.launchpad.net/1.0/~dmartls1"
        }, 
        {
            "content": "Seems like this might be fixed with https://review.openstack.org/#/c/25733/", 
            "date_created": "2013-04-11 14:39:25.568460+00:00", 
            "author": "https://api.launchpad.net/1.0/~p-draigbrady"
        }, 
        {
            "content": "Fix proposed to branch: stable/grizzly\nReview: https://review.openstack.org/26756", 
            "date_created": "2013-04-11 15:27:33.096514+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/26756\nCommitted: http://github.com/openstack/nova/commit/3861f8c60cc46e9a00b06ca2bb8de91da8a22c6b\nSubmitter: Jenkins\nBranch:    stable/grizzly\n\ncommit 3861f8c60cc46e9a00b06ca2bb8de91da8a22c6b\nAuthor: P\u00e1draig Brady <email address hidden>\nDate:   Fri Mar 29 16:50:24 2013 +0000\n\n    improve handling of an empty dnsmasq --domain\n    \n    Currently all domains passed through the dnsmasq --domain option,\n    are single quoted.  It's not fully understood how dnsmasq handles\n    single quotes in this situation, so it's safer to just avoid the\n    --domain option in this case.\n    \n    Fixes bug: 1161506\n    Fixes bug: 1167447\n    Change-Id: I8ecd996676189f53908abd48fee81132091ee820\n    Cherry-picked: 24b9731af34fbc2fb17c849cb8cdb5c7a10db77d\n", 
            "date_created": "2013-04-12 17:23:12.217324+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}