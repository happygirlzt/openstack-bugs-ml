{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:24:58.619971+00:00", 
    "description": "Looks like https://review.openstack.org/#/c/9510/ introduced a bug during instance spawn on nova-network.\n\nConfigured on a multi-node install using multi_host network config, FlatDHCPManager, auto_assign_floating_ips=True.\n\n\n2012-07-26 21:07:31 DEBUG nova.openstack.common.rpc.amqp [-] unpacked context: {'project_name': None, 'user_id': None, 'roles': [u'admin'], 'timestamp': u'2012-07-27T01:07:23.872859', 'auth_token': '<SANITIZED>', 'remote_address': None, 'quota_class': None, 'is_admin': True, 'service_catalog': None, 'request_id': u'req-7fc46266-e08f-4ab4-a7f4-10e8eb5a5fbd', 'project_id': None, 'user_name': None, 'read_deleted': u'no'} from (pid=8724) _safe_log /usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/common.py:199\n2012-07-26 21:07:31 DEBUG nova.utils [req-7fc46266-e08f-4ab4-a7f4-10e8eb5a5fbd None None] Attempting to grab semaphore \"get_dhcp\" for method \"_get_dhcp_ip\"... from (pid=8724) inner /usr/lib/python2.7/dist-packages/nova/utils.py:661\n2012-07-26 21:07:31 DEBUG nova.utils [req-7fc46266-e08f-4ab4-a7f4-10e8eb5a5fbd None None] Got semaphore \"get_dhcp\" for method \"_get_dhcp_ip\"... from (pid=8724) inner /usr/lib/python2.7/dist-packages/nova/utils.py:665\n2012-07-26 21:07:31 ERROR nova.openstack.common.rpc.amqp [-] Exception during message handling\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 275, in _process_data\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py\", line 145, in dispatch\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 262, in wrapped\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     return func(self, context, *args, **kwargs)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 1028, in get_instance_nw_info\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     rxtx_factor, host)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 1049, in build_network_info_model\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     instance_host)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 1137, in _get_subnets_from_network\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     instance_host)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/utils.py\", line 679, in inner\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     retval = f(*args, **kwargs)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 812, in _get_dhcp_ip\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     host=host)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 440, in fixed_ip_associate_pool\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     instance_uuid, host)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 113, in wrapper\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 1035, in fixed_ip_associate_pool\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     raise exception.InvalidUUID(uuid=instance_uuid)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp InvalidUUID: Expected a uuid but received None.\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp", 
    "tags": [], 
    "importance": "Critical", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1029721", 
    "owner": "https://api.launchpad.net/1.0/~mikal", 
    "id": 1029721, 
    "index": 67, 
    "created": "2012-07-27 01:14:32.426385+00:00", 
    "title": "nova-network: InvalidUUID exception on instance spawn", 
    "comments": [
        {
            "content": "Looks like https://review.openstack.org/#/c/9510/ introduced a bug during instance spawn on nova-network.\n\nConfigured on a multi-node install using multi_host network config, FlatDHCPManager, auto_assign_floating_ips=True.\n\n\n2012-07-26 21:07:31 DEBUG nova.openstack.common.rpc.amqp [-] unpacked context: {'project_name': None, 'user_id': None, 'roles': [u'admin'], 'timestamp': u'2012-07-27T01:07:23.872859', 'auth_token': '<SANITIZED>', 'remote_address': None, 'quota_class': None, 'is_admin': True, 'service_catalog': None, 'request_id': u'req-7fc46266-e08f-4ab4-a7f4-10e8eb5a5fbd', 'project_id': None, 'user_name': None, 'read_deleted': u'no'} from (pid=8724) _safe_log /usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/common.py:199\n2012-07-26 21:07:31 DEBUG nova.utils [req-7fc46266-e08f-4ab4-a7f4-10e8eb5a5fbd None None] Attempting to grab semaphore \"get_dhcp\" for method \"_get_dhcp_ip\"... from (pid=8724) inner /usr/lib/python2.7/dist-packages/nova/utils.py:661\n2012-07-26 21:07:31 DEBUG nova.utils [req-7fc46266-e08f-4ab4-a7f4-10e8eb5a5fbd None None] Got semaphore \"get_dhcp\" for method \"_get_dhcp_ip\"... from (pid=8724) inner /usr/lib/python2.7/dist-packages/nova/utils.py:665\n2012-07-26 21:07:31 ERROR nova.openstack.common.rpc.amqp [-] Exception during message handling\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 275, in _process_data\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py\", line 145, in dispatch\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 262, in wrapped\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     return func(self, context, *args, **kwargs)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 1028, in get_instance_nw_info\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     rxtx_factor, host)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 1049, in build_network_info_model\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     instance_host)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 1137, in _get_subnets_from_network\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     instance_host)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/utils.py\", line 679, in inner\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     retval = f(*args, **kwargs)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 812, in _get_dhcp_ip\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     host=host)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 440, in fixed_ip_associate_pool\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     instance_uuid, host)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 113, in wrapper\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 1035, in fixed_ip_associate_pool\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp     raise exception.InvalidUUID(uuid=instance_uuid)\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp InvalidUUID: Expected a uuid but received None.\n2012-07-26 21:07:31 TRACE nova.openstack.common.rpc.amqp", 
            "date_created": "2012-07-27 01:14:32.426385+00:00", 
            "author": "https://api.launchpad.net/1.0/~gandelman-a"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/10390", 
            "date_created": "2012-07-27 01:25:07.388407+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/10390\nCommitted: http://github.com/openstack/nova/commit/0626def72e8c2271ef72910c1a2f64015ac9c38b\nSubmitter: Jenkins\nBranch:    master\n\ncommit 0626def72e8c2271ef72910c1a2f64015ac9c38b\nAuthor: Michael Still <email address hidden>\nDate:   Fri Jul 27 11:24:06 2012 +1000\n\n    Only enforce valid uuids if a uuid is passed.\n    \n    This fixes bug 1029721 which was causing instance spawn failures.\n    \n    Change-Id: Iab7fdb063874972e0bcd91c51bfd0e5b49e8023c\n", 
            "date_created": "2012-07-27 01:51:49.796540+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}