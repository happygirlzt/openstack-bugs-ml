{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:57:29.816720+00:00", 
    "description": "patch 552693e4ad51291c8bfd28cd1939ed3609f6eeac (https://review.openstack.org/#/c/37933/) which added compute scheduler rpcapi version 2.9 does not provide any backwards compatibility, this should be done using 'self.can_send_version'\n\nThe result of this is, if compute is running grizzly and trunk is running with\n\n[upgrade_levels]\nscheduler=grizzly\n\nin nova.conf\n\nnova-conductor logs:\n1e5a084a4838b5d258532645eacc'} from (pid=861) _safe_log /opt/stack/nova/nova/openstack/common/rpc/common.py:277\n2013-09-03 04:32:36.347 DEBUG qpid.messaging.io.ops [-] SENT[4a35cb0]: SessionCompleted(commands=[0-16]) from (pid=861) write_op /usr/lib/python2.7/site-packages/qpid/messaging/driver.py:671\n2013-09-03 04:32:36.351 ERROR nova.openstack.common.rpc.amqp [req-b596a82a-0be1-4b90-a93a-d05ae7011e0b demo demo] Exception during message handling\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/conductor/manager.py\", line 745, in build_instances   \n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     legacy_bdm_in_spec=legacy_bdm)\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/scheduler/rpcapi.py\", line 112, in run_instance\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     legacy_bdm_in_spec=legacy_bdm_in_spec), version='2.9')\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/proxy.py\", line 169, in cast\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     self._set_version(msg, version)\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/proxy.py\", line 72, in _set_version\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     raise rpc_common.RpcVersionCapError(version_cap=self.version_cap)\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp RpcVersionCapError: Specified RPC version cap, 2.6, is too low\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp", 
    "tags": [], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1220112", 
    "owner": "https://api.launchpad.net/1.0/~ndipanov", 
    "id": 1220112, 
    "index": 1203, 
    "created": "2013-09-03 08:40:15.923396+00:00", 
    "title": "scheduler rpcapi 2.9 is not backwards compatible", 
    "comments": [
        {
            "content": "patch 552693e4ad51291c8bfd28cd1939ed3609f6eeac (https://review.openstack.org/#/c/37933/) which added compute scheduler rpcapi version 2.9 does not provide any backwards compatibility, this should be done using 'self.can_send_version'\n\nThe result of this is, if compute is running grizzly and trunk is running with\n\n[upgrade_levels]\nscheduler=grizzly\n\nin nova.conf\n\nnova-conductor logs:\n1e5a084a4838b5d258532645eacc'} from (pid=861) _safe_log /opt/stack/nova/nova/openstack/common/rpc/common.py:277\n2013-09-03 04:32:36.347 DEBUG qpid.messaging.io.ops [-] SENT[4a35cb0]: SessionCompleted(commands=[0-16]) from (pid=861) write_op /usr/lib/python2.7/site-packages/qpid/messaging/driver.py:671\n2013-09-03 04:32:36.351 ERROR nova.openstack.common.rpc.amqp [req-b596a82a-0be1-4b90-a93a-d05ae7011e0b demo demo] Exception during message handling\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/conductor/manager.py\", line 745, in build_instances   \n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     legacy_bdm_in_spec=legacy_bdm)\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/scheduler/rpcapi.py\", line 112, in run_instance\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     legacy_bdm_in_spec=legacy_bdm_in_spec), version='2.9')\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/proxy.py\", line 169, in cast\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     self._set_version(msg, version)\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/proxy.py\", line 72, in _set_version\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp     raise rpc_common.RpcVersionCapError(version_cap=self.version_cap)\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp RpcVersionCapError: Specified RPC version cap, 2.6, is too low\n2013-09-03 04:32:36.351 TRACE nova.openstack.common.rpc.amqp", 
            "date_created": "2013-09-03 08:40:15.923396+00:00", 
            "author": "https://api.launchpad.net/1.0/~ndipanov"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/44839", 
            "date_created": "2013-09-03 10:07:45.918846+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/44839\nCommitted: http://github.com/openstack/nova/commit/035f05eb531cb8dd805685272d46ecd8cb0ad2b3\nSubmitter: Jenkins\nBranch:    master\n\ncommit 035f05eb531cb8dd805685272d46ecd8cb0ad2b3\nAuthor: Nikola Dipanov <email address hidden>\nDate:   Tue Sep 3 11:08:39 2013 +0200\n\n    Scheduler rpcapi 2.9 is not backwards compatible\n    \n    Patch 552693e4ad51291c8bfd28cd1939ed3609f6eeac which added scheduler\n    rpcapi version 2.9 does not provide any backwards compatibility.\n    \n    This patch adds the check using 'self.can_send_version', and falls\n    back to the latest Grizzly compatible version if it the version is\n    capped.\n    \n    Also takes the opportunity to make the docstring more consistent in the\n    scheduler rpcapi SchedulerAPI class.\n    \n    Closes-bug: #1220112\n    \n    Change-Id: I5a1e08c1066cae00d47def45f7b87846f679cbbe\n", 
            "date_created": "2013-09-03 17:49:55.524090+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}