{
    "status": "Invalid", 
    "last_updated": "2015-08-05 12:24:37.164250+00:00", 
    "description": "When I call neutron v2 API from nova driver, it reported AuthorizationFailure, I've no idea about how this happen and in previous verion, there is no problem:\n\nTraceback (most recent call last):\n\u00a0\u00a0File \"/opt/mydriver/compute/manager.py\", line 2006, in _fix_instance_nw_info\n\u00a0\u00a0\u00a0\u00a0data = self.network_api.list_ports(context, **search_opts)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/nova/network/neutronv2/api.py\", line 724, in list_ports\n\u00a0\u00a0\u00a0\u00a0return get_client(context).list_ports(**search_opts)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 102, in with_params\n\u00a0\u00a0\u00a0\u00a0ret = self.function(instance, *args, **kwargs)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 535, in list_ports\n\u00a0\u00a0\u00a0\u00a0**_params)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 307, in list\n\u00a0\u00a0\u00a0\u00a0for r in self._pagination(collection, path, **params):\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 321, in _pagination\n\u00a0\u00a0\u00a0\u00a0res = self.get(path, params=params)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 293, in get\n\u00a0\u00a0\u00a0\u00a0headers=headers, params=params)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 270, in retry_request\n\u00a0\u00a0\u00a0\u00a0headers=headers, params=params)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 200, in do_request\n\u00a0\u00a0\u00a0\u00a0content_type=self.content_type())\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/neutronclient/client.py\", line 306, in do_request\n\u00a0\u00a0\u00a0\u00a0return self.request(url, method, **kwargs)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/neutronclient/client.py\", line 294, in request\n\u00a0\u00a0\u00a0\u00a0resp = super(SessionClient, self).request(*args, **kwargs)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/keystoneclient/adapter.py\", line 95, in request\n\u00a0\u00a0\u00a0\u00a0return self.session.request(url, method, **kwargs)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/keystoneclient/utils.py\", line 318, in inner\n\u00a0\u00a0\u00a0\u00a0return func(*args, **kwargs)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/keystoneclient/session.py\", line 317, in request\n\u00a0\u00a0\u00a0\u00a0raise exceptions.AuthorizationFailure(msg)\nAuthorizationFailure: No valid authentication is available\n\nI checked the /etc/nova/nova.conf and /etc/neutron/neutron.conf, it shows:\nnova.conf:\n[keystone_authtoken]\nauth_uri = http://myip:5000/v2.0\nidentity_uri = http://myip:35357/\nauth_version = v2.0\nadmin_tenant_name = service\nadmin_user = nova\nadmin_password = W0lCTTp2MV1iY3JhZmducHgtcGJ6Y2hncg==\nsigning_dir = /var/cache/nova/api\nhash_algorithms = md5\ninsecure = true\n\n[neutron]\nurl = http://myip:9696\ninsecure = true\nauth_strategy = keystone\nadmin_tenant_name = service\nadmin_username = neutron\nadmin_password = W0lCTTp2MV1iY3JhZmducHgtYXJnamJleA==\nadmin_auth_url = http://myip:5000/v2.0\ntimeout = 30\nregion_name =\novs_bridge = br-int\nextension_sync_interval = 600\ncafile =\nservice_metadata_proxy = true\nmetadata_proxy_shared_secret = W0lCTTp2MV1hcmhnZWJhX3pyZ25xbmduX2ZycGVyZw==\n\nneutron.conf:\n[keystone_authtoken]\nauth_uri = http://myip:5000/v2.0\nidentity_uri = http://myip:35357/\nauth_version = v2.0\nadmin_tenant_name = service\nadmin_user = neutron\nadmin_password = W0lCTTp2MV1iY3JhZmducHgtYXJnamJleA==\nsigning_dir = /var/lib/neutron/keystone-signing\nhash_algorithms = md5\ninsecure = false", 
    "tags": [
        "network"
    ], 
    "importance": "Undecided", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1461473", 
    "owner": "None", 
    "id": 1461473, 
    "index": 5579, 
    "created": "2015-06-03 09:32:48.246032+00:00", 
    "title": "Unable to call neutron v2 API from nova: AuthorizationFailure: No valid authentication is available", 
    "comments": [
        {
            "content": "When I call neutron v2 API from nova driver, it reported AuthorizationFailure, I've no idea about how this happen and in previous verion, there is no problem:\n\nTraceback (most recent call last):\n  File \"/opt/mydriver/compute/manager.py\", line 2006, in _fix_instance_nw_info\n    data = self.network_api.list_ports(context, **search_opts)\n  File \"/usr/lib/python2.7/site-packages/nova/network/neutronv2/api.py\", line 724, in list_ports\n    return get_client(context).list_ports(**search_opts)\n  File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 102, in with_params\n    ret = self.function(instance, *args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 535, in list_ports\n    **_params)\n  File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 307, in list\n    for r in self._pagination(collection, path, **params):\n  File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 321, in _pagination\n    res = self.get(path, params=params)\n  File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 293, in get\n    headers=headers, params=params)\n  File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 270, in retry_request\n    headers=headers, params=params)\n  File \"/usr/lib/python2.7/site-packages/neutronclient/v2_0/client.py\", line 200, in do_request\n    content_type=self.content_type())\n  File \"/usr/lib/python2.7/site-packages/neutronclient/client.py\", line 306, in do_request\n    return self.request(url, method, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/neutronclient/client.py\", line 294, in request\n    resp = super(SessionClient, self).request(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/keystoneclient/adapter.py\", line 95, in request\n    return self.session.request(url, method, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/keystoneclient/utils.py\", line 318, in inner\n    return func(*args, **kwargs)\n  File \"/usr/lib/python2.7/site-packages/keystoneclient/session.py\", line 317, in request\n    raise exceptions.AuthorizationFailure(msg)\nAuthorizationFailure: No valid authentication is available\n\n\nI checked the /etc/nova/nova.conf and /etc/neutron/neutron.conf, it shows:\nnova.conf:\n[keystone_authtoken]\nauth_uri = http://myip:5000/v2.0\nidentity_uri = http://myip:35357/\nauth_version = v2.0\nadmin_tenant_name = service\nadmin_user = nova\nadmin_password = W0lCTTp2MV1iY3JhZmducHgtcGJ6Y2hncg==\nsigning_dir = /var/cache/nova/api\nhash_algorithms = md5\ninsecure = true\n\n[neutron]\nurl = http://myip:9696\ninsecure = true\nauth_strategy = keystone\nadmin_tenant_name = service\nadmin_username = neutron\nadmin_password = W0lCTTp2MV1iY3JhZmducHgtYXJnamJleA==\nadmin_auth_url = http://myip:5000/v2.0\ntimeout = 30\nregion_name =\novs_bridge = br-int\nextension_sync_interval = 600\ncafile =\nservice_metadata_proxy = true\nmetadata_proxy_shared_secret = W0lCTTp2MV1hcmhnZWJhX3pyZ25xbmduX2ZycGVyZw==\n\n\nneutron.conf:\n[keystone_authtoken]\nauth_uri = http://myip:5000/v2.0\nidentity_uri = http://myip:35357/\nauth_version = v2.0\nadmin_tenant_name = service\nadmin_user = neutron\nadmin_password = W0lCTTp2MV1iY3JhZmducHgtYXJnamJleA==\nsigning_dir = /var/lib/neutron/keystone-signing\nhash_algorithms = md5\ninsecure = false\n\n\nenvironment version:\n~]# rpm -aq | grep nova\npython-novaclient-2.23.0-2.ibm.el7.noarch\nopenstack-nova-novncproxy-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-compute-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-conductor-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-network-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-cells-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-common-2015.1.0.1-201505291730.ibm.el7.127.noarch\npython-nova-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-api-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-console-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-compute-prereqs-2013.1-201503302013.ibm.2.x86_64\nopenstack-nova-scheduler-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-objectstore-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-2015.1.0.1-201505291730.ibm.el7.127.noarch\nopenstack-nova-cert-2015.1.0.1-201505291730.ibm.el7.127.noarch", 
            "date_created": "2015-06-03 09:32:48.246032+00:00", 
            "author": "https://api.launchpad.net/1.0/~caimin"
        }, 
        {
            "content": "any update on this issue?", 
            "date_created": "2015-06-15 08:07:28.669329+00:00", 
            "author": "https://api.launchpad.net/1.0/~caimin"
        }, 
        {
            "content": "from the log, seems it's a wrong configuration lead to issue\n\nsuggest you change it to a question instead of a bug :)", 
            "date_created": "2015-07-03 15:56:06.509004+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }
    ]
}