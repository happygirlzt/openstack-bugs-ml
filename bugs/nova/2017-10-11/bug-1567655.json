{
    "status": "Confirmed", 
    "last_updated": "2017-07-31 11:32:38.256804+00:00", 
    "description": "This is a newton devstack created today running neutron + ovs:\n\n1. create an instance, wait for it to go active\n2. list instances, it's fine\n3. stop all neutron-server processes\n4. list instances - it fails with a 500 trying to process security groups because it can't connect to neutron:\n\nhttp://paste.openstack.org/show/493416/\n\n2016-04-07 20:30:54.272 ERROR nova.api.openstack [req-5d867a48-2097-456f-a2ae-f93c982ac5d0 admin admin] Caught error: Unable to establish connection to http://9.5.124.163:9696/v2.0/ports.json?device_id=cda8a8ac-6eac-434d-bded-a0b34d285f41\n2016-04-07 20:30:54.272 TRACE nova.api.openstack Traceback (most recent call last):\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 134, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return req.get_response(self.application)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1317, in send\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     application, catch_exc_info=False)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1281, in call_application\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return resp(environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py\", line 467, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     response = req.get_response(self._app)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1317, in send\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     application, catch_exc_info=False)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1281, in call_application\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return resp(environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return resp(environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/routes/middleware.py\", line 141, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return resp(environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 672, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     content_type, body, accept)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 756, in _process_stack\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     request, action_args)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 619, in post_process_extensions\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     **action_args)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/security_groups.py\", line 491, in detail\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     self._extend_servers(req, list(resp_obj.obj['servers']))\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/security_groups.py\", line 461, in _extend_servers\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     servers))\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/network/security_group/neutron_driver.py\", line 381, in get_instances_security_groups_bindings\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     ports = self._get_ports_from_server_list(servers, neutron)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/network/security_group/neutron_driver.py\", line 340, in _get_ports_from_server_list\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     ports.extend(neutron.list_ports(**search_opts).get('ports'))\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 618, in list_ports\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     **_params)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 357, in list\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     for r in self._pagination(collection, path, **params):\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 372, in _pagination\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     res = self.get(path, params=params)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 342, in get\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     headers=headers, params=params)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 319, in retry_request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     headers=headers, params=params)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 270, in do_request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     resp, replybody = self.httpclient.do_request(action, method, body=body)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/client.py\", line 306, in do_request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return self.request(url, method, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/client.py\", line 294, in request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     resp = super(SessionClient, self).request(*args, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystoneauth1/adapter.py\", line 98, in request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return self.session.request(url, method, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/positional/__init__.py\", line 94, in inner\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return func(*args, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystoneauth1/session.py\", line 452, in request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     resp = send(**kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystoneauth1/session.py\", line 496, in _send_request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     raise exceptions.ConnectFailure(msg)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack ConnectFailure: Unable to establish connection to http://9.5.124.163:9696/v2.0/ports.json?device_id=cda8a8ac-6eac-434d-bded-a0b34d285f41\n2016-04-07 20:30:54.272 TRACE nova.api.openstack", 
    "tags": [
        "500-error", 
        "api", 
        "network", 
        "neutron", 
        "security-groups"
    ], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1567655", 
    "owner": "None", 
    "id": 1567655, 
    "index": 4506, 
    "created": "2016-04-07 20:34:25.991978+00:00", 
    "title": "500 error when trying to list instances and neutron-server is down", 
    "comments": [
        {
            "content": "This is a newton devstack created today running neutron + ovs:\n\n1. create an instance, wait for it to go active\n2. list instances, it's fine\n3. stop all neutron-server processes\n4. list instances - it fails with a 500 trying to process security groups because it can't connect to neutron:\n\nhttp://paste.openstack.org/show/493416/\n\n2016-04-07 20:30:54.272 ERROR nova.api.openstack [req-5d867a48-2097-456f-a2ae-f93c982ac5d0 admin admin] Caught error: Unable to establish connection to http://9.5.124.163:9696/v2.0/ports.json?device_id=cda8a8ac-6eac-434d-bded-a0b34d285f41\n2016-04-07 20:30:54.272 TRACE nova.api.openstack Traceback (most recent call last):\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 134, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return req.get_response(self.application)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1317, in send\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     application, catch_exc_info=False)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1281, in call_application\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return resp(environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py\", line 467, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     response = req.get_response(self._app)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1317, in send\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     application, catch_exc_info=False)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1281, in call_application\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return resp(environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return resp(environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/routes/middleware.py\", line 141, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return resp(environ, start_response)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 672, in __call__\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     content_type, body, accept)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 756, in _process_stack\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     request, action_args)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 619, in post_process_extensions\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     **action_args)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/security_groups.py\", line 491, in detail\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     self._extend_servers(req, list(resp_obj.obj['servers']))\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/security_groups.py\", line 461, in _extend_servers\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     servers))\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/network/security_group/neutron_driver.py\", line 381, in get_instances_security_groups_bindings\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     ports = self._get_ports_from_server_list(servers, neutron)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/network/security_group/neutron_driver.py\", line 340, in _get_ports_from_server_list\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     ports.extend(neutron.list_ports(**search_opts).get('ports'))\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 618, in list_ports\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     **_params)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 357, in list\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     for r in self._pagination(collection, path, **params):\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 372, in _pagination\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     res = self.get(path, params=params)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 342, in get\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     headers=headers, params=params)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 319, in retry_request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     headers=headers, params=params)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/v2_0/client.py\", line 270, in do_request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     resp, replybody = self.httpclient.do_request(action, method, body=body)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/client.py\", line 306, in do_request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return self.request(url, method, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/opt/stack/python-neutronclient/neutronclient/client.py\", line 294, in request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     resp = super(SessionClient, self).request(*args, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystoneauth1/adapter.py\", line 98, in request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return self.session.request(url, method, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/positional/__init__.py\", line 94, in inner\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     return func(*args, **kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystoneauth1/session.py\", line 452, in request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     resp = send(**kwargs)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystoneauth1/session.py\", line 496, in _send_request\n2016-04-07 20:30:54.272 TRACE nova.api.openstack     raise exceptions.ConnectFailure(msg)\n2016-04-07 20:30:54.272 TRACE nova.api.openstack ConnectFailure: Unable to establish connection to http://9.5.124.163:9696/v2.0/ports.json?device_id=cda8a8ac-6eac-434d-bded-a0b34d285f41\n2016-04-07 20:30:54.272 TRACE nova.api.openstack", 
            "date_created": "2016-04-07 20:34:25.991978+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Solving an inconsistency: This bug report has an assignee and it looks\nlike this will result in a patch. Therefore I switch the status to\n\"In Progress\". \nDear assignee, please provide a patch in the next 2 weeks. If you stop\nworking on this report, please remove yourself as assignee and switch\nthe status back. If you need assistance, reach out on the IRC channel\n#openstack-nova or use the mailing list.", 
            "date_created": "2016-04-18 09:07:32.496415+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "Hi,\n\nPlease let me know on which version of openstack(Kilo/Liberty) this issue has been observed.\n\nAlso, please let me know what is the expected behavior of the 4th step(step4, mentioned in the above bug description).", 
            "date_created": "2016-04-21 11:39:45.417377+00:00", 
            "author": "https://api.launchpad.net/1.0/~sreenivas-pothukanoori"
        }, 
        {
            "content": "Per comment 2, this is newton, as mentioned in the description. Newton devstack created on 2016-04-07, so trunk master code as of that day.\n\nThe expected behavior is that we don't get a 500. Listing instances should more or less be a database operation, the issue is in the case of using neutron as the network service, we call out to neutron to get security group details per instance. Since neutron-server is down, that API call fails, Nova doesn't handle it and we return a 500 response.\n\nDan Smith (dansmith in #openstack-nova on freenode IRC) suggested caching the security groups for neutron, in a new column in the instance_info_caches table in the nova database. That is going to be a more complicated change though (requires a database migration, an rpc version change to the InstanceInfoCache object, etc).\n\nAs a partial fix we can backport, we should gracefully handle the connection error when trying to talk to neutron API and return a more appropriate response code (503 maybe?).", 
            "date_created": "2016-04-21 15:32:52.334744+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "The error handling portion of this is related to bug 1571722.", 
            "date_created": "2016-04-22 14:55:29.130406+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Per comment 4, actually, python-neutronclient doesn't handle the ConnectFailure exception that is coming from keystoneauth, so nova would have to handle that, if we wanted to handle it, which gets kind of ugly.", 
            "date_created": "2016-04-22 17:41:29.808858+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "As currently I am working on one Liberty bug, I dont want to upgrade my openstack setup from Liberty to Newton. Once I upgrade my setup to Newton and if the bug is not assigned to anyone, ill pick and work on this bug.\n\nreleasing this bug from my name. ", 
            "date_created": "2016-04-25 06:49:06.300299+00:00", 
            "author": "https://api.launchpad.net/1.0/~sreenivas-pothukanoori"
        }, 
        {
            "content": "The way I am approaching this is I am using a wrapper in the neutron API to catch the exception coming from keystoneauth and then raising it as a separate exception.\n\nAs Matt said the patch would be similar to https://bugs.launchpad.net/bugs/1571722 .", 
            "date_created": "2016-05-06 05:51:39.614173+00:00", 
            "author": "https://api.launchpad.net/1.0/~parora"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/327706", 
            "date_created": "2016-06-09 14:22:54.459279+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "The current patch does a lot of hand holding around doing the error translation differently. That doesn't really feel like it addresses the real issue, and I'm not sure is worth the complexity to have to explain this to people. Stuff still doesn't work. It just now doesn't work in a different manner that needs to be documented.\n\n-1 on returning a different error. Please lets just fix the crux of the issue and keep security groups cached in some sane way.", 
            "date_created": "2016-09-09 12:40:39.270146+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "From IRC conversation this morning:\n\n(7:55:59 AM) mriedem: prateek: there is a comment in the bug report about adding a new column to the instance_info_caches table for serialized security groups\n(7:56:34 AM) mriedem: we'd basically be serializing and deserializing SecurityGroupList for a given instance.security_groups into that table\n(7:56:54 AM) mriedem: on a GET if it's not there we'd have to pull the security groups from neutron, and then store it in the cache,\n(7:57:02 AM) mriedem: and there is code to 'heal' that cache,\n(7:57:16 AM) mriedem: and there is a 'refresh_cache' decorator in the network API code for updating that whenever we change network resources tied to an instance\n(7:57:22 AM) mriedem: it's definitely not trivial\n(7:57:43 AM) mriedem: especially because the network_api and security_group_api are in different interfaces\n(7:58:15 AM) mriedem: the network api would just have a handle to the secgroup api in order to refresh that cache i suppose\n(7:58:35 AM) mriedem: anyway, it's probably more than a bug, it's probably a bp/spec given the various considerations for getting this right\n\n--\n\nNet is, we probably need a blueprint and a spec for this given the complexity in the change to start caching the security groups for neutron in the instance_info_cache table.", 
            "date_created": "2016-09-09 14:49:53.384005+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "To follow on, I was thinking that there might be a reasonable intermediary solution. I think changing a 500 -> 504 is kind of pointless for the user. They still don't get any useful data.\n\nThat being said... we used to have a similar sub select issue on some part of the detailed server list. And what we did was skip over the rows that were deleted. It's a little more complicated because this is another rest service, however I think that building a standard of returning something like a 206 and just marking out the security_groups as 'UNKNOWN' would be ok here. Because 95% of the information will be accessible, but we can indicate this is not perfect information, but it might be good enough for your use case.", 
            "date_created": "2016-09-09 19:08:57.077645+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "What's puzzling is that this is showing in the gate every now and then. I don't believe there's someone stopping neutron server during the tests.\n\nhttp://logs.openstack.org/77/401377/2/gate/gate-tempest-dsvm-neutron-dvr-ubuntu-xenial/078fa95/logs/screen-n-api.txt.gz?level=TRACE#_2016-11-24_02_21_30_203", 
            "date_created": "2016-11-24 03:50:25.616119+00:00", 
            "author": "https://api.launchpad.net/1.0/~armando-migliaccio"
        }, 
        {
            "content": "I get a file not found when i try to open the above link", 
            "date_created": "2016-11-24 07:49:49.793037+00:00", 
            "author": "https://api.launchpad.net/1.0/~parora"
        }, 
        {
            "content": "Change abandoned by Michael Still (<email address hidden>) on branch: master\nReview: https://review.openstack.org/327706\nReason: This patch has been sitting unchanged for more than 12 weeks. I am therefore going to abandon it to keep the nova review queue sane. Please feel free to restore the change if you're still working on it.", 
            "date_created": "2016-12-11 23:14:54.687566+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "\nThere are no currently open reviews on this bug, changing\nthe status back to the previous state and unassigning. If\nthere are active reviews related to this bug, please include\nlinks in comments.\n", 
            "date_created": "2017-06-23 12:46:58.288287+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }
    ]
}