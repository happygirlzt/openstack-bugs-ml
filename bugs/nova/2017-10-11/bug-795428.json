{
    "status": "Invalid", 
    "last_updated": "2012-06-13 00:59:15.469876+00:00", 
    "description": "After I creat my VG \"nova-volumes\", and create a volume into it via: \n$ euca-create-volume -s 5 -z nova\n\nThe volumes appears  well, and LVM VG has a new logical volume with the same size, I can attach it, use it.\n\nWhen I try to delete it with euca-delete-volume, i've the following status : \nVOLUME\tvol-00000005\t 6\t\tnova\terror_deleting (my_project, nova-cc1, None, None)\t2011-06-10T08:46:33Z\n\nand lvdisplay shows it : \n  --- Logical volume ---\n  LV Name                /dev/nova-volumes/volume-00000005\n  VG Name                nova-volumes\n  LV UUID                ofhGOF-hjTQ-eh2f-gsZZ-ZHQc-XAUC-i1nZp1\n  LV Write Access        read/write\n  LV Status              available\n  # open                 0\n  LV Size                6,00 GiB\n  Current LE             1536\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           251:0\n\n\nIf I try to delete it another time, I've the following error : \n\nroot@nova-cc1:~# euca-delete-volume vol-00000005\nApiError: ApiError: Volume status must be available\n\n\nwhile the nova-manage volume delete doesn't shows any error.\n\nIn order to get rid of the volume, I have to : \n1- Connect to mysql, set the value \"deleted\" to 1\n2- run a lvremove /dev/nova-volumes/volume-00000005", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 18, 
    "link": "https://bugs.launchpad.net/nova/+bug/795428", 
    "owner": "None", 
    "id": 795428, 
    "index": 2166, 
    "created": "2011-06-10 08:57:48.431353+00:00", 
    "title": "Unable to remove a LVM volume (dd not in nova_sudoers)", 
    "comments": [
        {
            "content": "After I creat my VG \"nova-volumes\", and create a volume into it via: \n$ euca-create-volume -s 5 -z nova\n\nThe volumes appears  well, and LVM VG has a new logical volume with the same size, I can attach it, use it.\n\nWhen I try to delete it with euca-delete-volume, i've the following status : \nVOLUME\tvol-00000005\t 6\t\tnova\terror_deleting (my_project, nova-cc1, None, None)\t2011-06-10T08:46:33Z\n\nand lvdisplay shows it : \n  --- Logical volume ---\n  LV Name                /dev/nova-volumes/volume-00000005\n  VG Name                nova-volumes\n  LV UUID                ofhGOF-hjTQ-eh2f-gsZZ-ZHQc-XAUC-i1nZp1\n  LV Write Access        read/write\n  LV Status              available\n  # open                 0\n  LV Size                6,00 GiB\n  Current LE             1536\n  Segments               1\n  Allocation             inherit\n  Read ahead sectors     auto\n  - currently set to     256\n  Block device           251:0\n\n\nIf I try to delete it another time, I've the following error : \n\nroot@nova-cc1:~# euca-delete-volume vol-00000005\nApiError: ApiError: Volume status must be available\n\n\nwhile the nova-manage volume delete doesn't shows any error.\n\nIn order to get rid of the volume, I have to : \n1- Connect to mysql, set the value \"deleted\" to 1\n2- run a lvremove /dev/nova-volumes/volume-00000005", 
            "date_created": "2011-06-10 08:57:48.431353+00:00", 
            "author": "https://api.launchpad.net/1.0/~razique"
        }, 
        {
            "content": "The nova-manage.log : \n2011-06-10 10:47:10,666 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/rpc.py\", line 188, in _receive\n(nova): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/volume/manager.py\", line 144, in delete_volume\n(nova): TRACE:     self.driver.delete_volume(volume_ref)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/volume/driver.py\", line 120, in delete_volume\n(nova): TRACE:     'bs=1M')\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/utils.py\", line 173, in execute\n(nova): TRACE:     cmd=' '.join(cmd))\n(nova): TRACE: ProcessExecutionError: Unexpected error while running command.\n(nova): TRACE: Command: sudo dd if=/dev/zero of=/dev/mapper/nova--volumes-volume--00000005 count=6144 bs=1M\n(nova): TRACE: Exit code: 1\n(nova): TRACE: Stdout: ''\n(nova): TRACE: Stderr: 'sudo: no tty present and no askpass program specified\\n'\n(nova): TRACE: \n2011-06-10 10:49:52,192 INFO nova.volume.driver [-] Skipping remove_export. No iscsi_target is presently exported for volume: 5\n2011-06-10 10:49:52,260 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/rpc.py\", line 188, in _receive\n(nova): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/volume/manager.py\", line 144, in delete_volume\n(nova): TRACE:     self.driver.delete_volume(volume_ref)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/volume/driver.py\", line 120, in delete_volume\n(nova): TRACE:     'bs=1M')\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/utils.py\", line 173, in execute\n(nova): TRACE:     cmd=' '.join(cmd))\n(nova): TRACE: ProcessExecutionError: Unexpected error while running command.\n(nova): TRACE: Command: sudo dd if=/dev/zero of=/dev/mapper/nova--volumes-volume--00000005 count=6144 bs=1M\n(nova): TRACE: Exit code: 1\n(nova): TRACE: Stdout: ''\n(nova): TRACE: Stderr: 'sudo: no tty present and no askpass program specified\\n'\n(nova): TRACE: \n2011-06-10 10:49:58,934 INFO nova.volume.driver [-] Skipping remove_export. No iscsi_target is presently exported for volume: 5\n2011-06-10 10:49:59,003 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/rpc.py\", line 188, in _receive\n(nova): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/volume/manager.py\", line 144, in delete_volume\n(nova): TRACE:     self.driver.delete_volume(volume_ref)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/volume/driver.py\", line 120, in delete_volume\n(nova): TRACE:     'bs=1M')\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/utils.py\", line 173, in execute\n(nova): TRACE:     cmd=' '.join(cmd))\n(nova): TRACE: ProcessExecutionError: Unexpected error while running command.\n(nova): TRACE: Command: sudo dd if=/dev/zero of=/dev/mapper/nova--volumes-volume--00000005 count=6144 bs=1M\n(nova): TRACE: Exit code: 1\n(nova): TRACE: Stdout: ''\n(nova): TRACE: Stderr: 'sudo: no tty present and no askpass program specified\\n'\n(nova): TRACE: \n2011-06-10 11:16:18,928 INFO nova.volume.manager [-] volume volume-00000006: creating\n2011-06-10 11:16:35,864 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/rpc.py\", line 188, in _receive\n(nova): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/volume/manager.py\", line 144, in delete_volume\n(nova): TRACE:     self.driver.delete_volume(volume_ref)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/volume/driver.py\", line 120, in delete_volume\n(nova): TRACE:     'bs=1M')\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/utils.py\", line 173, in execute\n(nova): TRACE:     cmd=' '.join(cmd))\n(nova): TRACE: ProcessExecutionError: Unexpected error while running command.\n(nova): TRACE: Command: sudo dd if=/dev/zero of=/dev/mapper/nova--volumes-volume--00000006 count=6144 bs=1M\n(nova): TRACE: Exit code: 1\n(nova): TRACE: Stdout: ''\n(nova): TRACE: Stderr: 'sudo: no tty present and no askpass program specified\\n'\n(nova): TRACE: \n", 
            "date_created": "2011-06-10 09:17:44.099776+00:00", 
            "author": "https://api.launchpad.net/1.0/~razique"
        }, 
        {
            "content": "The problem is that \"dd\" is not in the nova_sudoers, so nova can't run \"sudo dd\". It's a packaging issue, deferring to Ubuntu packaging team.", 
            "date_created": "2011-06-10 14:27:47.737408+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "as of packaging rev 143 and 2011.3~bzr1108-0ubuntu1\r\n", 
            "date_created": "2011-07-29 14:47:29.833205+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }
    ]
}