{
    "status": "Invalid", 
    "last_updated": "2012-11-15 19:04:48.326064+00:00", 
    "description": "What happens:\n\nI have two regions and one availability zone (AZ) for my Essex cluster. When creating a volume I accidentally used the region name instead of the AZ name. This resulted in a volume being stuck in the \"creating\" state which I cannot delete.\n\nWhat I expect:\n\nI expect two things:\n 1. The volume creation should fail (it currently does)\n 2. The volume to go into an \"error\" state (it does not currently do this)\n\nReasoning:\n\nHaving the volume go into an error state informs the user that there was a problem and does not leave them wondering if they should wait longer in case the command hasn't completed.\n\nSteps to reproduce:\n\n 1. user@laptop:~$ euca-create-volume -s 2 # command requires a zone\n    These required options are missing: zone\n\n 2. user@laptop:~$ euca-create-volume -s 2 -z lcy-2 # accidentally pass a non-existant zone name\n    VOLUME  vol-00000001    2       lcy-2   creating        2012-06-21T13:50:10.074Z\n\n 3. user@laptop:~$ euca-describe-volumes vol-00000001\n    VOLUME  vol-00000001     2      lcy-2   creating        2012-06-21T13:50:10.000Z\n\n 4. The nova-scheduler log file shows the following.\n    2012-06-21 13:58:41 WARNING nova.scheduler.manager [req-63af9b42-502d-4ad4-9ae1-e981d053f9fc a9d62e6e73294368b79d21ea2a2e2d86 df473f958e4f47949282696966e58f49] Failed to schedule_create_volume: No valid host was found. Is the appropriate service running?\n    2012-06-21 13:58:41 ERROR nova.rpc.amqp [req-63af9b42-502d-4ad4-9ae1-e981d053f9fc a9d62e6e73294368b79d21ea2a2e2d86 df473f958e4f47949282696966e58f49] Exception during message handling\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp Traceback (most recent call last):\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 252, in _process_data\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp     rval = node_func(context=ctxt, **node_args)\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/manager.py\", line 97, in _schedule\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp     context, ex, *args, **kwargs)\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp     self.gen.next()\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/manager.py\", line 92, in _schedule\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp     return driver_method(*args, **kwargs)\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/simple.py\", line 144, in schedule_create_volume\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp     raise exception.NoValidHost(reason=msg)\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp NoValidHost: No valid host was found. Is the appropriate service running?\n\nSuccessful volume creation:\n\n 1. user@laptop:~$ euca-describe-availability-zones # find the AZ\n    AVAILABILITYZONE        nova    available\n\n 2. user@laptop:~$ euca-create-volume -s 2 -z nova # create the volume passing in the correct AZ name\n    VOLUME  vol-00000003    2       nova    creating        2012-06-21T14:02:07.842Z\n\n 3. agy@agy-laptop:~$ euca-describe-volumes\n    VOLUME  vol-00000001     2              lcy-2   creating        2012-06-21T13:50:10.000Z\n    VOLUME  vol-00000002     2              lcy-2   creating        2012-06-21T13:58:41.000Z\n    VOLUME  vol-00000003     2              nova    available       2012-06-21T14:02:07.000Z\n\n    Note the two volumes that have failed and will not complete and the correctly created volume.\n\nIdeally, I would like the API server to reject the command and return an informative error message to the user before attempting to create the volume.\n\nOperating System Information (all machines):\n\n$ cat /etc/lsb-release \nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=12.04\nDISTRIB_CODENAME=precise\nDISTRIB_DESCRIPTION=\"Ubuntu 12.04 LTS\"\n\nPackage Information (API/Controller):\n\n$ dpkg-query --show nova-*\nnova-api        2012.1-0ubuntu2.1\nnova-cert       2012.1-0ubuntu2.1\nnova-common     2012.1-0ubuntu2.1\nnova-doc        2012.1-0ubuntu2.1\nnova-network    2012.1-0ubuntu2.1\nnova-objectstore        2012.1-0ubuntu2.1\nnova-scheduler  2012.1-0ubuntu2.1\n\n\nPackage Information (Volume Node):\n\n$ dpkg-query --show nova-*\nnova-common     2012.1-0ubuntu2.3\nnova-volume     2012.1-0ubuntu2.3", 
    "tags": [
        "canonistack", 
        "ec2"
    ], 
    "importance": "High", 
    "heat": 22, 
    "link": "https://bugs.launchpad.net/nova/+bug/1016111", 
    "owner": "https://api.launchpad.net/1.0/~zulcss", 
    "id": 1016111, 
    "index": 714, 
    "created": "2012-06-21 15:34:22.962264+00:00", 
    "title": "Passing an incorrect zone name to euca-create-volume results in a volume stuck in the 'creating' state", 
    "comments": [
        {
            "content": "What happens:\n\nI have two regions and one availability zone (AZ) for my Essex cluster. When creating a volume I accidentally used the region name instead of the AZ name. This resulted in a volume being stuck in the \"creating\" state which I cannot delete.\n\nWhat I expect:\n\nI expect two things:\n 1. The volume creation should fail (it currently does)\n 2. The volume to go into an \"error\" state (it does not currently do this)\n\nReasoning:\n\nHaving the volume go into an error state informs the user that there was a problem and does not leave them wondering if they should wait longer in case the command hasn't completed.\n\nSteps to reproduce:\n\n 1. user@laptop:~$ euca-create-volume -s 2 # command requires a zone\n    These required options are missing: zone\n\n 2. user@laptop:~$ euca-create-volume -s 2 -z lcy-2 # accidentally pass a non-existant zone name\n    VOLUME  vol-00000001    2       lcy-2   creating        2012-06-21T13:50:10.074Z\n\n 3. user@laptop:~$ euca-describe-volumes vol-00000001\n    VOLUME  vol-00000001     2      lcy-2   creating        2012-06-21T13:50:10.000Z\n\n 4. The nova-scheduler log file shows the following.\n    2012-06-21 13:58:41 WARNING nova.scheduler.manager [req-63af9b42-502d-4ad4-9ae1-e981d053f9fc a9d62e6e73294368b79d21ea2a2e2d86 df473f958e4f47949282696966e58f49] Failed to schedule_create_volume: No valid host was found. Is the appropriate service running?\n    2012-06-21 13:58:41 ERROR nova.rpc.amqp [req-63af9b42-502d-4ad4-9ae1-e981d053f9fc a9d62e6e73294368b79d21ea2a2e2d86 df473f958e4f47949282696966e58f49] Exception during message handling\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp Traceback (most recent call last):\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 252, in _process_data\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp     rval = node_func(context=ctxt, **node_args)\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/manager.py\", line 97, in _schedule\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp     context, ex, *args, **kwargs)\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp     self.gen.next()\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/manager.py\", line 92, in _schedule\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp     return driver_method(*args, **kwargs)\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/simple.py\", line 144, in schedule_create_volume\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp     raise exception.NoValidHost(reason=msg)\n    2012-06-21 13:58:41 TRACE nova.rpc.amqp NoValidHost: No valid host was found. Is the appropriate service running?\n\nSuccessful volume creation:\n\n 1. user@laptop:~$ euca-describe-availability-zones # find the AZ\n    AVAILABILITYZONE        nova    available\n\n 2. user@laptop:~$ euca-create-volume -s 2 -z nova # create the volume passing in the correct AZ name\n    VOLUME  vol-00000003    2       nova    creating        2012-06-21T14:02:07.842Z\n\n 3. agy@agy-laptop:~$ euca-describe-volumes\n    VOLUME  vol-00000001     2              lcy-2   creating        2012-06-21T13:50:10.000Z\n    VOLUME  vol-00000002     2              lcy-2   creating        2012-06-21T13:58:41.000Z\n    VOLUME  vol-00000003     2              nova    available       2012-06-21T14:02:07.000Z\n\n    Note the two volumes that have failed and will not complete and the correctly created volume.\n\nIdeally, I would like the API server to reject the command and return an informative error message to the user before attempting to create the volume.\n\nOperating System Information (all machines):\n\n$ cat /etc/lsb-release \nDISTRIB_ID=Ubuntu\nDISTRIB_RELEASE=12.04\nDISTRIB_CODENAME=precise\nDISTRIB_DESCRIPTION=\"Ubuntu 12.04 LTS\"\n\nPackage Information (API/Controller):\n\n$ dpkg-query --show nova-*\nnova-api        2012.1-0ubuntu2.1\nnova-cert       2012.1-0ubuntu2.1\nnova-common     2012.1-0ubuntu2.1\nnova-doc        2012.1-0ubuntu2.1\nnova-network    2012.1-0ubuntu2.1\nnova-objectstore        2012.1-0ubuntu2.1\nnova-scheduler  2012.1-0ubuntu2.1\n\n\nPackage Information (Volume Node):\n\n$ dpkg-query --show nova-*\nnova-common     2012.1-0ubuntu2.3\nnova-volume     2012.1-0ubuntu2.3", 
            "date_created": "2012-06-21 15:34:22.962264+00:00", 
            "author": "https://api.launchpad.net/1.0/~aglenyoung"
        }, 
        {
            "content": "Hi Andrew,\n\nThank you very much for your bug report.\n\nThis is indeed an existing problem in nova, could reproduce easily. Don't know if it's an architectural decision or if it's a bug per se.\n\nHandling over to Chuck Short for further analysis.", 
            "date_created": "2012-06-21 16:00:57.765889+00:00", 
            "author": "https://api.launchpad.net/1.0/~lynxman"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/8875", 
            "date_created": "2012-06-22 20:52:49.706332+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This seems to be fixed in raring since im not able to reproduce this anymore.", 
            "date_created": "2012-11-15 19:04:13.955905+00:00", 
            "author": "https://api.launchpad.net/1.0/~zulcss"
        }, 
        {
            "content": "This seems to be fixed in raring.", 
            "date_created": "2012-11-15 19:04:42.223638+00:00", 
            "author": "https://api.launchpad.net/1.0/~zulcss"
        }
    ]
}