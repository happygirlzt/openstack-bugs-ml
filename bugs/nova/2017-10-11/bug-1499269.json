{
    "status": "Confirmed", 
    "last_updated": "2016-05-16 20:27:52.424578+00:00", 
    "description": "Whenever I try to attach a direct port to an existing instance It fails:\n\n#neutron port-create Management --binding:vnic_type direct\nCreated a new port:\n+-----------------------+-------------------------------------------------------------------------------------+\n| Field                 | Value                                                                               |\n+-----------------------+-------------------------------------------------------------------------------------+\n| admin_state_up        | True                                                                                |\n| allowed_address_pairs |                                                                                     |\n| binding:host_id       |                                                                                     |\n| binding:profile       | {}                                                                                  |\n| binding:vif_details   | {}                                                                                  |\n| binding:vif_type      | unbound                                                                             |\n| binding:vnic_type     | direct                                                                              |\n| device_id             |                                                                                     |\n| device_owner          |                                                                                     |\n| fixed_ips             | {\"subnet_id\": \"6c82ff4c-124e-469a-8444-1446cc5d979f\", \"ip_address\": \"10.92.29.123\"} |\n| id                    | ce455654-4eb5-4b89-b868-b426381951c8                                                |\n| mac_address           | fa:16:3e:6b:15:e8                                                                   |\n| name                  |                                                                                     |\n| network_id            | 5764ca50-1f30-4daa-8c86-a21fed9a679c                                                |\n| security_groups       | 5d2faf7b-2d32-49a8-978e-a91f57ece17d                                                |\n| status                | DOWN                                                                                |\n| tenant_id             | d5ecb0eea96f4996b565fd983a768b11                                                    |\n+-----------------------+-------------------------------------------------------------------------------------+\n\n# nova interface-attach --port-id ce455654-4eb5-4b89-b868-b426381951c8 voicisc4srv1\nERROR (ClientException): Failed to attach interface (HTTP 500) (Request-ID: req-11516bf4-7ab7-414c-a4ee-63e44aaf00a5)\n\nnova-compute.log:\n\n0a14aeb82013e5a1631de80 d5ecb0eea96f4996b565fd983a768b11 - - -] Exception during message handling: Failed to attach network adapter device to 056d455a-314d-4853-839e-70229a56dfcd\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     executor_callback))\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     executor_callback)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 6632, in attach_interface\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     port_id, requested_ip)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 443, in decorated_function\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     payload)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 327, in decorated_function\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     LOG.warning(msg, e, instance_uuid=instance_uuid)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 298, in decorated_function\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 355, in decorated_function\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 343, in decorated_function\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5078, in attach_interface\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     instance_uuid=instance.uuid)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher InterfaceAttachFailed: Failed to attach network adapter device to 056d455a-314d-4853-839e-70229a56dfcd\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher \n2015-09-24 10:41:35.434 43535 ERROR oslo_messaging._drivers.common [req-11516bf4-7ab7-414c-a4ee-63e44aaf00a5 9340dc4e70a14aeb82013e5a1631de80 d5ecb0eea96f4996b565fd983a768b11 - - -] Returning exception Failed to attach network adapter device to 056d455a-314d-4853-839e-70229a56dfcd to caller\n2015-09-24 10:41:35.434 43535 ERROR oslo_messaging._drivers.common [req-11516bf4-7ab7-414c-a4ee-63e44aaf00a5 9340dc4e70a14aeb82013e5a1631de80 d5ecb0eea96f4996b565fd983a768b11 - - -] ['Traceback (most recent call last):\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\\n    executor_callback))\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\\n    executor_callback)\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\\n    result = func(ctxt, **new_args)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 6632, in attach_interface\\n    port_id, requested_ip)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 443, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\\n    payload)\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\\n    return f(self, context, *args, **kw)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 327, in decorated_function\\n    LOG.warning(msg, e, instance_uuid=instance_uuid)\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 298, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 355, in decorated_function\\n    kwargs[\\'instance\\'], e, sys.exc_info())\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 343, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5078, in attach_interface\\n    instance_uuid=instance.uuid)\\n', 'InterfaceAttachFailed: Failed to attach network adapter device to 056d455a-314d-4853-839e-70229a56dfcd\\n']\n2015-09-24 10:41:36.181 43535 DEBUG nova.openstack.common.periodic_task [req-be840a83-9a40-477f-80c1-08126cfa665f - - - - -] Running periodic task ComputeManager._heal_instance_info_cache run_periodic_tasks /usr/lib/python2.7/site-packages/nova/openstack/common/periodic_task.py:219", 
    "tags": [
        "needs-attention", 
        "sriov-pci-pt"
    ], 
    "importance": "Wishlist", 
    "heat": 22, 
    "link": "https://bugs.launchpad.net/nova/+bug/1499269", 
    "owner": "None", 
    "id": 1499269, 
    "index": 1747, 
    "created": "2015-09-24 09:48:41.567898+00:00", 
    "title": "cannot attach direct type port (sr-iov) to existing instance", 
    "comments": [
        {
            "content": "Whenever I try to attach a direct port to an existing instance It fails:\n\n#neutron port-create Management --binding:vnic_type direct\nCreated a new port:\n+-----------------------+-------------------------------------------------------------------------------------+\n| Field                 | Value                                                                               |\n+-----------------------+-------------------------------------------------------------------------------------+\n| admin_state_up        | True                                                                                |\n| allowed_address_pairs |                                                                                     |\n| binding:host_id       |                                                                                     |\n| binding:profile       | {}                                                                                  |\n| binding:vif_details   | {}                                                                                  |\n| binding:vif_type      | unbound                                                                             |\n| binding:vnic_type     | direct                                                                              |\n| device_id             |                                                                                     |\n| device_owner          |                                                                                     |\n| fixed_ips             | {\"subnet_id\": \"6c82ff4c-124e-469a-8444-1446cc5d979f\", \"ip_address\": \"10.92.29.123\"} |\n| id                    | ce455654-4eb5-4b89-b868-b426381951c8                                                |\n| mac_address           | fa:16:3e:6b:15:e8                                                                   |\n| name                  |                                                                                     |\n| network_id            | 5764ca50-1f30-4daa-8c86-a21fed9a679c                                                |\n| security_groups       | 5d2faf7b-2d32-49a8-978e-a91f57ece17d                                                |\n| status                | DOWN                                                                                |\n| tenant_id             | d5ecb0eea96f4996b565fd983a768b11                                                    |\n+-----------------------+-------------------------------------------------------------------------------------+\n\n# nova interface-attach --port-id ce455654-4eb5-4b89-b868-b426381951c8 voicisc4srv1\nERROR (ClientException): Failed to attach interface (HTTP 500) (Request-ID: req-11516bf4-7ab7-414c-a4ee-63e44aaf00a5)\n\nnova-compute.log:\n\n0a14aeb82013e5a1631de80 d5ecb0eea96f4996b565fd983a768b11 - - -] Exception during message handling: Failed to attach network adapter device to 056d455a-314d-4853-839e-70229a56dfcd\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     executor_callback))\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     executor_callback)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 6632, in attach_interface\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     port_id, requested_ip)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 443, in decorated_function\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     payload)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 327, in decorated_function\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     LOG.warning(msg, e, instance_uuid=instance_uuid)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 298, in decorated_function\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 355, in decorated_function\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 343, in decorated_function\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5078, in attach_interface\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher     instance_uuid=instance.uuid)\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher InterfaceAttachFailed: Failed to attach network adapter device to 056d455a-314d-4853-839e-70229a56dfcd\n2015-09-24 10:41:35.434 43535 TRACE oslo_messaging.rpc.dispatcher \n2015-09-24 10:41:35.434 43535 ERROR oslo_messaging._drivers.common [req-11516bf4-7ab7-414c-a4ee-63e44aaf00a5 9340dc4e70a14aeb82013e5a1631de80 d5ecb0eea96f4996b565fd983a768b11 - - -] Returning exception Failed to attach network adapter device to 056d455a-314d-4853-839e-70229a56dfcd to caller\n2015-09-24 10:41:35.434 43535 ERROR oslo_messaging._drivers.common [req-11516bf4-7ab7-414c-a4ee-63e44aaf00a5 9340dc4e70a14aeb82013e5a1631de80 d5ecb0eea96f4996b565fd983a768b11 - - -] ['Traceback (most recent call last):\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\\n    executor_callback))\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\\n    executor_callback)\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\\n    result = func(ctxt, **new_args)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 6632, in attach_interface\\n    port_id, requested_ip)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 443, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\\n    payload)\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\\n    return f(self, context, *args, **kw)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 327, in decorated_function\\n    LOG.warning(msg, e, instance_uuid=instance_uuid)\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 298, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 355, in decorated_function\\n    kwargs[\\'instance\\'], e, sys.exc_info())\\n', '  File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 343, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5078, in attach_interface\\n    instance_uuid=instance.uuid)\\n', 'InterfaceAttachFailed: Failed to attach network adapter device to 056d455a-314d-4853-839e-70229a56dfcd\\n']\n2015-09-24 10:41:36.181 43535 DEBUG nova.openstack.common.periodic_task [req-be840a83-9a40-477f-80c1-08126cfa665f - - - - -] Running periodic task ComputeManager._heal_instance_info_cache run_periodic_tasks /usr/lib/python2.7/site-packages/nova/openstack/common/periodic_task.py:219", 
            "date_created": "2015-09-24 09:48:41.567898+00:00", 
            "author": "https://api.launchpad.net/1.0/~pgsousa"
        }, 
        {
            "content": "This looks like a nova issue and not a neutron one.", 
            "date_created": "2015-11-10 14:22:24.498969+00:00", 
            "author": "https://api.launchpad.net/1.0/~garyk"
        }, 
        {
            "content": "we are working on adding Attach/detach SR-IOV interface  in nova https://review.openstack.org/#/c/139910/.\nas gray said it is not related to neutron\n\n", 
            "date_created": "2015-12-04 11:09:59.173491+00:00", 
            "author": "https://api.launchpad.net/1.0/~moshele"
        }, 
        {
            "content": "lvmxh Can  you please let me know if you are still working on this wishlist \n", 
            "date_created": "2016-05-04 17:36:34.389287+00:00", 
            "author": "https://api.launchpad.net/1.0/~siva-radhakrishnan"
        }, 
        {
            "content": "@lvmxh If you wish to work on this bug, please reassign yourself.", 
            "date_created": "2016-05-16 20:27:51.983239+00:00", 
            "author": "https://api.launchpad.net/1.0/~anusha-unnam"
        }
    ]
}