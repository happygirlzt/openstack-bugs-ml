{
    "status": "Fix Released", 
    "last_updated": "2011-09-22 12:57:25.149157+00:00", 
    "description": "I try to add a fixed IP to instance with this command: 'nova add-fixed-ip 4 2' but I get this error in nova-network logs:\n\n2011-08-30 16:00:27,111 DEBUG nova.rpc [-] {u'_context_roles': [u'Admin'], u'_context_request_id': u'3d96c679-86f8-49c2-b7ba-9d31f0b76ebc', u'_context_read_deleted': False, u'args': {u'instance_id': 4, u'network_id': u'2', u'host': u'p-hs21-16'}, u'_context_auth_token': u'999888777666', u'_context_is_admin': None, u'_context_project_id': u'admin', u'_context_timestamp': u'2011-08-30T14:00:26.869559', u'_context_user_id': u'admin', u'method': u'add_fixed_ip_to_instance', u'_context_remote_address': u'127.0.0.1'} re\u00e7u from (pid=5430) process_data /usr/lib/pymodules/python2.7/nova/rpc/amqp.py:200\n2011-08-30 16:00:27,111 DEBUG nova.rpc [-] Contexte d\u00e9compact\u00e9 : {'user_id': u'admin', 'roles': [u'Admin'], 'timestamp': u'2011-08-30T14:00:26.869559', 'auth_token': u'999888777666', 'msg_id': None, 'remote_address': u'127.0.0.1', 'is_admin': None, 'request_id': u'3d96c679-86f8-49c2-b7ba-9d31f0b76ebc', 'project_id': u'admin', 'read_deleted': False} from (pid=5430) _unpack_context /usr/lib/pymodules/python2.7/nova/rpc/amqp.py:432\n2011-08-30 16:00:27,117 DEBUG nova.network.manager [-] kwargs: {} from (pid=5430) _allocate_fixed_ips /usr/lib/pymodules/python2.7/nova/network/manager.py:131\n2011-08-30 16:00:27,117 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE: File \"/usr/lib/pymodules/python2.7/nova/rpc/amqp.py\", line 230, in _process_data\n(nova): TRACE: rval = node_func(context=ctxt, **node_args)\n(nova): TRACE: File \"/usr/lib/pymodules/python2.7/nova/network/manager.py\", line 570, in add_fixed_ip_to_instance\n(nova): TRACE: self._allocate_fixed_ips(context, instance_id, host, networks)\n(nova): TRACE: File \"/usr/lib/pymodules/python2.7/nova/network/manager.py\", line 132, in _allocate_fixed_ips\n(nova): TRACE: vpn = kwargs.pop('vpn')\n(nova): TRACE: KeyError: 'vpn'\n(nova): TRACE:\n\nI use nova bzr 1508 in VLAN network.", 
    "tags": [], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/837867", 
    "owner": "https://api.launchpad.net/1.0/~tpatil", 
    "id": 837867, 
    "index": 468, 
    "created": "2011-08-31 07:22:26.259189+00:00", 
    "title": "Add fixed IP fails", 
    "comments": [
        {
            "content": "I try to add a fixed IP to instance with this command: 'nova add-fixed-ip 4 2' but I get this error in nova-network logs:\n\n2011-08-30 16:00:27,111 DEBUG nova.rpc [-] {u'_context_roles': [u'Admin'], u'_context_request_id': u'3d96c679-86f8-49c2-b7ba-9d31f0b76ebc', u'_context_read_deleted': False, u'args': {u'instance_id': 4, u'network_id': u'2', u'host': u'p-hs21-16'}, u'_context_auth_token': u'999888777666', u'_context_is_admin': None, u'_context_project_id': u'admin', u'_context_timestamp': u'2011-08-30T14:00:26.869559', u'_context_user_id': u'admin', u'method': u'add_fixed_ip_to_instance', u'_context_remote_address': u'127.0.0.1'} re\u00e7u from (pid=5430) process_data /usr/lib/pymodules/python2.7/nova/rpc/amqp.py:200\n2011-08-30 16:00:27,111 DEBUG nova.rpc [-] Contexte d\u00e9compact\u00e9 : {'user_id': u'admin', 'roles': [u'Admin'], 'timestamp': u'2011-08-30T14:00:26.869559', 'auth_token': u'999888777666', 'msg_id': None, 'remote_address': u'127.0.0.1', 'is_admin': None, 'request_id': u'3d96c679-86f8-49c2-b7ba-9d31f0b76ebc', 'project_id': u'admin', 'read_deleted': False} from (pid=5430) _unpack_context /usr/lib/pymodules/python2.7/nova/rpc/amqp.py:432\n2011-08-30 16:00:27,117 DEBUG nova.network.manager [-] kwargs: {} from (pid=5430) _allocate_fixed_ips /usr/lib/pymodules/python2.7/nova/network/manager.py:131\n2011-08-30 16:00:27,117 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE: File \"/usr/lib/pymodules/python2.7/nova/rpc/amqp.py\", line 230, in _process_data\n(nova): TRACE: rval = node_func(context=ctxt, **node_args)\n(nova): TRACE: File \"/usr/lib/pymodules/python2.7/nova/network/manager.py\", line 570, in add_fixed_ip_to_instance\n(nova): TRACE: self._allocate_fixed_ips(context, instance_id, host, networks)\n(nova): TRACE: File \"/usr/lib/pymodules/python2.7/nova/network/manager.py\", line 132, in _allocate_fixed_ips\n(nova): TRACE: vpn = kwargs.pop('vpn')\n(nova): TRACE: KeyError: 'vpn'\n(nova): TRACE:\n\nI use nova bzr 1508 in VLAN network.", 
            "date_created": "2011-08-31 07:22:26.259189+00:00", 
            "author": "https://api.launchpad.net/1.0/~ethuleau"
        }, 
        {
            "content": "In nova/network/manager.py:\r\n\r\nNetworkManager's add_fixed_ip_to_instance calls _allocate_fixed_ips without vpn or requested_networks parameters.\r\n\r\nFlatManager's _allocate_fixed_ips will fail if throw an exception if requested_networks is not provided\r\n\r\nRPCAllocateFixedIP's _allocate_fixed_ips will throw an exception if vpn or requested_networks is not provided (this bug report)\r\n\r\nEither add_fixed_ip_to_instance needs to be fixed to pass the required parameters, or (more likely) _allocate_fixed_ips needs to be a little more flexible in what they accept.", 
            "date_created": "2011-09-07 10:25:04.607317+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }
    ]
}