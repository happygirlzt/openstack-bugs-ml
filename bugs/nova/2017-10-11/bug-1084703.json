{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:45:43.989140+00:00", 
    "description": "From http://logs.openstack.org/periodic/periodic-tempest-devstack-vm-check-hourly/404/logs/screen-n-api.txt\n\n2012-11-29 19:09:36 DEBUG nova.utils [req-08a4f894-d80e-4718-8699-e194bb0f5639 demo demo] Running cmd (subprocess): openssl enc -d -aes-128-cbc -in /tmp/tmpZ8v3HM/image.encrypted -K 0d8dd9155e185e1b7acb2ac0bc1c3339 -iv 77ef7e43a0abc52b9970eae9bf036058 -out /tmp/tmpZ8v3HM/image.tar.gz execute /opt/stack/nova/nova/utils.py:185\n2012-11-29 19:09:36 DEBUG nova.utils [req-08a4f894-d80e-4718-8699-e194bb0f5639 demo demo] Result was 0 execute /opt/stack/nova/nova/utils.py:209\n2012-11-29 19:09:36 DEBUG nova.api.ec2 [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] action: DeregisterImage __call__ /opt/stack/nova/nova/api/ec2/__init__.py:339\n2012-11-29 19:09:36 DEBUG nova.api.ec2 [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] arg: ImageId                val: ami-00000001 __call__ /opt/stack/nova/nova/api/ec2/__init__.py:341\n2012-11-29 19:09:36 AUDIT nova.api.ec2.cloud [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] De-registering image ami-00000001\n2012-11-29 19:09:37 DEBUG nova.api.ec2.apirequest [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] <?xml version=\"1.0\" ?><DeregisterImageResponse xmlns=\"http://ec2.amazonaws.com/doc/2009-11-30/\"><requestId>req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab</requestId><return>true</return></DeregisterImageResponse> _render_response /opt/stack/nova/nova/api/ec2/apirequest.py:103\n2012-11-29 19:09:37 INFO nova.api.ec2 [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] 0.527777s 127.0.0.1 POST /services/Cloud/ CloudController:DeregisterImage 200 [Boto/2.1.1 (linux2)] application/x-www-form-urlencoded text/xml\n2012-11-29 19:09:37 INFO nova.ec2.wsgi.server [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] 127.0.0.1 \"POST /services/Cloud/ HTTP/1.1\" status: 200 len: 307 time: 0.5290320\n\nNo handlers could be found for logger \"glanceclient.common.http\"\n2012-11-29 19:09:37 ERROR nova.image.s3 [req-08a4f894-d80e-4718-8699-e194bb0f5639 demo demo] Failed to upload testbucket/bundle.img.manifest.xml to /tmp/tmpZ8v3HM\n2012-11-29 19:09:37 29483 TRACE nova.image.s3 Traceback (most recent call last):\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/nova/nova/image/s3.py\", line 347, in delayed_create\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     _update_image_data(context, image_uuid, image_file)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/nova/nova/image/s3.py\", line 291, in _update_image_data\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     purge_props=False)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/nova/nova/image/glance.py\", line 257, in update\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     _reraise_translated_image_exception(image_id)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/nova/nova/image/glance.py\", line 255, in update\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     image_id, **image_meta)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/nova/nova/image/glance.py\", line 142, in call\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     return getattr(client.images, method)(*args, **kwargs)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/python-glanceclient/glanceclient/v1/images.py\", line 253, in update\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     'PUT', url, headers=hdrs, body=image_data)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 219, in raw_request\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     return self._http_request(url, method, **kwargs)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 180, in _http_request\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     raise exc.from_response(resp)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3 ImageNotFound: Image d3b7f3f0-035d-4953-8e91-98869acf1c04 could not be found.\n2012-11-29 19:09:37 29483 TRACE nova.image.s3 \nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/poll.py\", line 97, in wait\n    readers.get(fileno, noop).cb(fileno)\n  File \"/opt/stack/nova/nova/image/s3.py\", line 351, in delayed_create\n    _update_image_state(context, image_uuid, 'failed_upload')\n  File \"/opt/stack/nova/nova/image/s3.py\", line 286, in _update_image_state\n    purge_props=False)\n  File \"/opt/stack/nova/nova/image/glance.py\", line 257, in update\n    _reraise_translated_image_exception(image_id)\n  File \"/opt/stack/nova/nova/image/glance.py\", line 255, in update\n    image_id, **image_meta)\n  File \"/opt/stack/nova/nova/image/glance.py\", line 142, in call\n    return getattr(client.images, method)(*args, **kwargs)\n  File \"/opt/stack/python-glanceclient/glanceclient/v1/images.py\", line 253, in update\n    'PUT', url, headers=hdrs, body=image_data)\n  File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 219, in raw_request\n    return self._http_request(url, method, **kwargs)\n  File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 180, in _http_request\n    raise exc.from_response(resp)\nImageNotFound: Image d3b7f3f0-035d-4953-8e91-98869acf1c04 could not be found.\nRemoving descriptor: 11", 
    "tags": [
        "stacktrace"
    ], 
    "importance": "High", 
    "heat": 16, 
    "link": "https://bugs.launchpad.net/nova/+bug/1084703", 
    "owner": "https://api.launchpad.net/1.0/~cyeoh-0", 
    "id": 1084703, 
    "index": 890, 
    "created": "2012-11-29 20:03:51.434525+00:00", 
    "title": "ImageNotFound ERROR in n-api log after good tempest run", 
    "comments": [
        {
            "content": "From http://logs.openstack.org/periodic/periodic-tempest-devstack-vm-check-hourly/404/logs/screen-n-api.txt\n\n2012-11-29 19:09:36 DEBUG nova.utils [req-08a4f894-d80e-4718-8699-e194bb0f5639 demo demo] Running cmd (subprocess): openssl enc -d -aes-128-cbc -in /tmp/tmpZ8v3HM/image.encrypted -K 0d8dd9155e185e1b7acb2ac0bc1c3339 -iv 77ef7e43a0abc52b9970eae9bf036058 -out /tmp/tmpZ8v3HM/image.tar.gz execute /opt/stack/nova/nova/utils.py:185\n2012-11-29 19:09:36 DEBUG nova.utils [req-08a4f894-d80e-4718-8699-e194bb0f5639 demo demo] Result was 0 execute /opt/stack/nova/nova/utils.py:209\n2012-11-29 19:09:36 DEBUG nova.api.ec2 [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] action: DeregisterImage __call__ /opt/stack/nova/nova/api/ec2/__init__.py:339\n2012-11-29 19:09:36 DEBUG nova.api.ec2 [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] arg: ImageId                val: ami-00000001 __call__ /opt/stack/nova/nova/api/ec2/__init__.py:341\n2012-11-29 19:09:36 AUDIT nova.api.ec2.cloud [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] De-registering image ami-00000001\n2012-11-29 19:09:37 DEBUG nova.api.ec2.apirequest [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] <?xml version=\"1.0\" ?><DeregisterImageResponse xmlns=\"http://ec2.amazonaws.com/doc/2009-11-30/\"><requestId>req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab</requestId><return>true</return></DeregisterImageResponse> _render_response /opt/stack/nova/nova/api/ec2/apirequest.py:103\n2012-11-29 19:09:37 INFO nova.api.ec2 [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] 0.527777s 127.0.0.1 POST /services/Cloud/ CloudController:DeregisterImage 200 [Boto/2.1.1 (linux2)] application/x-www-form-urlencoded text/xml\n2012-11-29 19:09:37 INFO nova.ec2.wsgi.server [req-c6f1a01b-43cb-482c-85e0-0fb0722a58ab demo demo] 127.0.0.1 \"POST /services/Cloud/ HTTP/1.1\" status: 200 len: 307 time: 0.5290320\n\nNo handlers could be found for logger \"glanceclient.common.http\"\n2012-11-29 19:09:37 ERROR nova.image.s3 [req-08a4f894-d80e-4718-8699-e194bb0f5639 demo demo] Failed to upload testbucket/bundle.img.manifest.xml to /tmp/tmpZ8v3HM\n2012-11-29 19:09:37 29483 TRACE nova.image.s3 Traceback (most recent call last):\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/nova/nova/image/s3.py\", line 347, in delayed_create\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     _update_image_data(context, image_uuid, image_file)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/nova/nova/image/s3.py\", line 291, in _update_image_data\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     purge_props=False)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/nova/nova/image/glance.py\", line 257, in update\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     _reraise_translated_image_exception(image_id)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/nova/nova/image/glance.py\", line 255, in update\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     image_id, **image_meta)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/nova/nova/image/glance.py\", line 142, in call\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     return getattr(client.images, method)(*args, **kwargs)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/python-glanceclient/glanceclient/v1/images.py\", line 253, in update\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     'PUT', url, headers=hdrs, body=image_data)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 219, in raw_request\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     return self._http_request(url, method, **kwargs)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3   File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 180, in _http_request\n2012-11-29 19:09:37 29483 TRACE nova.image.s3     raise exc.from_response(resp)\n2012-11-29 19:09:37 29483 TRACE nova.image.s3 ImageNotFound: Image d3b7f3f0-035d-4953-8e91-98869acf1c04 could not be found.\n2012-11-29 19:09:37 29483 TRACE nova.image.s3 \nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/poll.py\", line 97, in wait\n    readers.get(fileno, noop).cb(fileno)\n  File \"/opt/stack/nova/nova/image/s3.py\", line 351, in delayed_create\n    _update_image_state(context, image_uuid, 'failed_upload')\n  File \"/opt/stack/nova/nova/image/s3.py\", line 286, in _update_image_state\n    purge_props=False)\n  File \"/opt/stack/nova/nova/image/glance.py\", line 257, in update\n    _reraise_translated_image_exception(image_id)\n  File \"/opt/stack/nova/nova/image/glance.py\", line 255, in update\n    image_id, **image_meta)\n  File \"/opt/stack/nova/nova/image/glance.py\", line 142, in call\n    return getattr(client.images, method)(*args, **kwargs)\n  File \"/opt/stack/python-glanceclient/glanceclient/v1/images.py\", line 253, in update\n    'PUT', url, headers=hdrs, body=image_data)\n  File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 219, in raw_request\n    return self._http_request(url, method, **kwargs)\n  File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 180, in _http_request\n    raise exc.from_response(resp)\nImageNotFound: Image d3b7f3f0-035d-4953-8e91-98869acf1c04 could not be found.\nRemoving descriptor: 11", 
            "date_created": "2012-11-29 20:03:51.434525+00:00", 
            "author": "https://api.launchpad.net/1.0/~david-kranz"
        }, 
        {
            "content": "In the glance api log i see\n2012-11-29 19:09:37 DEBUG glance.registry.client [cf9eec5d-e4c3-4f1a-8c48-42e28c4a2bc5 115a9bf9618847b696db6bf7dedaaf8b 3b352b57729d497eaac7668e99413b17] Registry request DELETE /images/d3b7f3f0-035d-4953-8e91-98869acf1c04 HTTP 200 request id req-1a68836d-c489-485d-9346-f0897d72ab8c do_request /opt/stack/glance/glance/registry/client.py:95\nDEBUG:glance.registry.client:Registry request DELETE /images/d3b7f3f0-035d-4953-8e91-98869acf1c04 HTTP 200 request id req-1a68836d-c489-485d-9346-f0897d72ab8c\n2012-11-29 19:09:37 INFO glance.registry.client [fc593de0-bc25-4133-bf1e-dba50a357106 115a9bf9618847b696db6bf7dedaaf8b 3b352b57729d497eaac7668e99413b17] Registry client request GET /images/d3b7f3f0-035d-4953-8e91-98869acf1c04 raised NotFound\nINFO:glance.registry.client:Registry client request GET /images/d3b7f3f0-035d-4953-8e91-98869acf1c04 raised NotFound\n\nwhich corresponds to nova api logs's\n\n2012-11-29 19:09:37 29483 TRACE nova.image.s3 ImageNotFound: Image d3b7f3f0-035d-4953-8e91-98869acf1c04 could not be found.\n\nSo we are calling a DELETE and then trying to access d3b7f3f0-035d-4953-8e91-98869acf1c04. So this is a valid case and we are doing the right thing except for the extra logs :)", 
            "date_created": "2012-12-06 22:25:51.624591+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/30088", 
            "date_created": "2013-05-22 11:07:26.527890+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/30088\nCommitted: http://github.com/openstack/nova/commit/47daf90e11d75e04442ab50ac3b3ece2ae79423f\nSubmitter: Jenkins\nBranch:    master\n\ncommit 47daf90e11d75e04442ab50ac3b3ece2ae79423f\nAuthor: Chris Yeoh <email address hidden>\nDate:   Wed May 22 20:36:37 2013 +0930\n\n    _s3_create handles image being deleted\n    \n    Change so _s3_create handles the image it is creating\n    being deleted while it is creating it without logging a stacktrace\n    and instead just logging a simple message explaining what happened.\n    \n    Fixes bug 1084703\n    \n    Change-Id: I9d984dd1cf4f393010493cacd048d20ad5225db8\n", 
            "date_created": "2013-06-05 02:13:26.969720+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}