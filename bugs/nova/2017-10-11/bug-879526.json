{
    "status": "Invalid", 
    "last_updated": "2014-02-11 22:17:44.645286+00:00", 
    "description": "One of my users created an instance which failed to allocate the correct IP address.\n\nDigging a little further I have noticed that two IP addresses were passed to the instance. The first IP in the list was assigned to the instance in the database and dnsmasq's dhcp server allocated the second IP address.\n\nThe instance was created using euca2ools.\n\nMessage on nova-compute (pretty printed):\n\n2011-10-21 12:03:16,040 DEBUG nova.compute.manager [-] instance network_info: |\n[   [   {   u'bridge': u'br100',\n            u'bridge_interface': u'eth0',\n            u'cidr': u'172.16.60.0/24',\n            u'cidr_v6': None,\n            u'id': 1,\n            u'injected': False,\n            u'multi_host': False,\n            u'vlan': None},\n        {   u'broadcast': u'172.16.60.255',\n            u'dhcp_server': u'172.16.60.1',\n            u'dns': [u'8.8.8.8'],\n            u'gateway': u'172.16.60.1',\n            u'ips': [   {   u'enabled': u'1',\n                            u'ip': u'172.16.60.3',\n                            u'netmask': u'255.255.255.0'},\n                        {   u'enabled': u'1',\n                            u'ip': u'172.16.60.34',\n                            u'netmask': u'255.255.255.0'}],\n            u'label': u'nova',\n            u'mac': u'02:16:3e:30:f0:58',\n            u'rxtx_cap': 0,\n            u'should_create_bridge': True,\n            u'should_create_vlan': False,\n            u'vif_uuid': u'44445a69-e155-4927-9f8f-52010cbbb0c4'}]]\n| from (pid=28045) _run_instance /usr/lib/python2.7/dist-packages/nova/compute/manager.py:394\n\n/var/lib/nova/networks/nova-br100.conf:\n\n02:16:3e:30:f0:58,server-2502.novalocal,172.16.60.34\n\n$ euca-describe-instances i-000009c6\nRESERVATION     r-2f81m0s5      user_project   default\nINSTANCE        i-000009c6      ami-00000002    172.16.60.3      172.16.60.3      running user (user_project, ankaa)    0              m1.large 2011-10-20T15:55:36Z    nova    aki-00000001    ami-00000000\n\nmysql> select count(*) from fixed_ips where address = \"172.16.60.3\" or address = \"172.16.60.34\" and instance_id <> NULL;\n+----------+\n| count(*) |\n+----------+\n|        1 |\n+----------+\n1 row in set (0.00 sec)\n\nmysql> select instance_id from fixed_ips where address = \"172.16.60.3\" or address = \"172.16.60.34\" and instance_id <> NULL;\n+-------------+\n| instance_id |\n+-------------+\n|        2502 |\n+-------------+\n1 row in set (0.00 sec)\n\nmysql> select count(*) from fixed_ips where instance_id = 2502;\n+----------+\n| count(*) |\n+----------+\n|        1 |\n+----------+\n1 row in set (0.00 sec)\n\nmysql> select address from fixed_ips where instance_id = 2502;\n+-------------+\n|  address    |\n+-------------+\n| 172.16.60.3 |\n+-------------+\n1 row in set (0.00 sec)\n\n/var/log/syslog:\n\nOct 21 12:35:51 nova dnsmasq-dhcp[31614]: DHCPDISCOVER(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:35:51 nova dnsmasq-dhcp[31614]: DHCPOFFER(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:35:51 nova dnsmasq-dhcp[31614]: DHCPREQUEST(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:35:51 nova dnsmasq-dhcp[31614]: DHCPACK(br100) 172.16.60.34 02:16:3e:30:f0:58 server-2502\nOct 21 12:37:52 nova dnsmasq-dhcp[31614]: DHCPDISCOVER(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:37:52 nova dnsmasq-dhcp[31614]: DHCPOFFER(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:37:52 nova dnsmasq-dhcp[31614]: DHCPREQUEST(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:37:52 nova dnsmasq-dhcp[31614]: DHCPACK(br100) 172.16.60.34 02:16:3e:30:f0:58 server-2502\nOct 21 12:39:34 nova dnsmasq-dhcp[31614]: DHCPRELEASE(br100) 172.16.60.3 02:16:3e:30:f0:58 unknown lease\nOct 21 12:39:35 nova dnsmasq-dhcp[31614]: DHCPRELEASE(br100) 172.16.60.34 02:16:3e:30:f0:58", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/879526", 
    "owner": "https://api.launchpad.net/1.0/~baby-adabala", 
    "id": 879526, 
    "index": 2605, 
    "created": "2011-10-21 16:20:05.816205+00:00", 
    "title": "Instance fails to allocate the correct IP address after receiving two", 
    "comments": [
        {
            "content": "One of my users created an instance which failed to allocate the correct IP address.\n\nDigging a little further I have noticed that two IP addresses were passed to the instance. The first IP in the list was assigned to the instance in the database and dnsmasq's dhcp server allocated the second IP address.\n\nThe instance was created using euca2ools.\n\nMessage on nova-compute (pretty printed):\n\n2011-10-21 12:03:16,040 DEBUG nova.compute.manager [-] instance network_info: |\n[   [   {   u'bridge': u'br100',\n            u'bridge_interface': u'eth0',\n            u'cidr': u'172.16.60.0/24',\n            u'cidr_v6': None,\n            u'id': 1,\n            u'injected': False,\n            u'multi_host': False,\n            u'vlan': None},\n        {   u'broadcast': u'172.16.60.255',\n            u'dhcp_server': u'172.16.60.1',\n            u'dns': [u'8.8.8.8'],\n            u'gateway': u'172.16.60.1',\n            u'ips': [   {   u'enabled': u'1',\n                            u'ip': u'172.16.60.3',\n                            u'netmask': u'255.255.255.0'},\n                        {   u'enabled': u'1',\n                            u'ip': u'172.16.60.34',\n                            u'netmask': u'255.255.255.0'}],\n            u'label': u'nova',\n            u'mac': u'02:16:3e:30:f0:58',\n            u'rxtx_cap': 0,\n            u'should_create_bridge': True,\n            u'should_create_vlan': False,\n            u'vif_uuid': u'44445a69-e155-4927-9f8f-52010cbbb0c4'}]]\n| from (pid=28045) _run_instance /usr/lib/python2.7/dist-packages/nova/compute/manager.py:394\n\n/var/lib/nova/networks/nova-br100.conf:\n\n02:16:3e:30:f0:58,server-2502.novalocal,172.16.60.34\n\n$ euca-describe-instances i-000009c6\nRESERVATION     r-2f81m0s5      user_project   default\nINSTANCE        i-000009c6      ami-00000002    172.16.60.3      172.16.60.3      running user (user_project, ankaa)    0              m1.large 2011-10-20T15:55:36Z    nova    aki-00000001    ami-00000000\n\nmysql> select count(*) from fixed_ips where address = \"172.16.60.3\" or address = \"172.16.60.34\" and instance_id <> NULL;\n+----------+\n| count(*) |\n+----------+\n|        1 |\n+----------+\n1 row in set (0.00 sec)\n\nmysql> select instance_id from fixed_ips where address = \"172.16.60.3\" or address = \"172.16.60.34\" and instance_id <> NULL;\n+-------------+\n| instance_id |\n+-------------+\n|        2502 |\n+-------------+\n1 row in set (0.00 sec)\n\nmysql> select count(*) from fixed_ips where instance_id = 2502;\n+----------+\n| count(*) |\n+----------+\n|        1 |\n+----------+\n1 row in set (0.00 sec)\n\nmysql> select address from fixed_ips where instance_id = 2502;\n+-------------+\n|  address    |\n+-------------+\n| 172.16.60.3 |\n+-------------+\n1 row in set (0.00 sec)\n\n/var/log/syslog:\n\nOct 21 12:35:51 nova dnsmasq-dhcp[31614]: DHCPDISCOVER(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:35:51 nova dnsmasq-dhcp[31614]: DHCPOFFER(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:35:51 nova dnsmasq-dhcp[31614]: DHCPREQUEST(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:35:51 nova dnsmasq-dhcp[31614]: DHCPACK(br100) 172.16.60.34 02:16:3e:30:f0:58 server-2502\nOct 21 12:37:52 nova dnsmasq-dhcp[31614]: DHCPDISCOVER(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:37:52 nova dnsmasq-dhcp[31614]: DHCPOFFER(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:37:52 nova dnsmasq-dhcp[31614]: DHCPREQUEST(br100) 172.16.60.34 02:16:3e:30:f0:58 \nOct 21 12:37:52 nova dnsmasq-dhcp[31614]: DHCPACK(br100) 172.16.60.34 02:16:3e:30:f0:58 server-2502\nOct 21 12:39:34 nova dnsmasq-dhcp[31614]: DHCPRELEASE(br100) 172.16.60.3 02:16:3e:30:f0:58 unknown lease\nOct 21 12:39:35 nova dnsmasq-dhcp[31614]: DHCPRELEASE(br100) 172.16.60.34 02:16:3e:30:f0:58", 
            "date_created": "2011-10-21 16:20:05.816205+00:00", 
            "author": "https://api.launchpad.net/1.0/~aglenyoung"
        }, 
        {
            "content": "Hi,\n This is not reproduced in Essex<2012.1~e4> on Ubuntu 11.10", 
            "date_created": "2012-05-02 08:52:47.577586+00:00", 
            "author": "https://api.launchpad.net/1.0/~baby-adabala"
        }, 
        {
            "content": "Hi,\n\nIs this still a problem in Folsom or Grizzly?", 
            "date_created": "2013-04-08 10:58:16.685726+00:00", 
            "author": "https://api.launchpad.net/1.0/~fifieldt"
        }, 
        {
            "content": "We cannot solve the issue you reported without more information. Could you please provide the requested information ?", 
            "date_created": "2013-05-08 10:31:34.191178+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "Andrew... Have you seen this recently?\n\nThanks,\nMichael", 
            "date_created": "2013-05-22 04:48:59.043216+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }
    ]
}