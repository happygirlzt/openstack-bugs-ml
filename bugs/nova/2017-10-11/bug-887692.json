{
    "status": "Invalid", 
    "last_updated": "2013-03-05 22:19:20.047090+00:00", 
    "description": "These changes were suggested by Aaron Lee during his review:\n\nPatch Set 9: (5 inline comments)\n\nI'm giving this a 0 because all of my comments are about refactorings that would have made it easier for me to read what this patch is doing. The functionality looks good, as far as I can tell, but I think the code needs to be cleaner.\n\n....................................................\nFile nova/network/linux_net.py\nLine 995:         # Don't forward traffic unless we were told to be a gateway\nI would rather see the actions within the conditional more focused on the decision of the conditional.\n\ni.e.\nguard = \"DROP\"\nif gateway\n guard = \"ACCEPT\"\n\nfor direction in ['in', 'out']\n   iptables_manager.ipv4['filter'].add_rule('FORWARD',\n                                    '--$(direction)-interface %(guard)s -j %(bridge)s' % \\\n                                    locals())\n\nThis will make it much easier to fix errors in the generation of those commands.\n\n....................................................\nFile nova/network/quantum/manager.py\nLine 213:                     \"label\": \"quantum-net-%s\" % quantum_net_id}\nI don't think this get network ref logic is a part of allocating for an instance. It would be better stored in it's own method.\n\nLine 234:         LOG.info(\"Using DHCP for network: %s\" % network_ref['label'])\nThis would be much easier to maintain and test in small units if each step was a method, and enable_dhcp just called each individual method. Refactoring like that would also make more granular error handling easier.\n\nLine 449:                 subnet['network_id'], project_id)\nIt appears the real meat of this function is these three calls to the driver, it should be separated from populating the network_ref.\n\nThis data mutating done on this response from get_subnets_by_net_id is very similar to the changes made to this data on both other calls to get_subnets_by_net_id. This is another candidate for refactoring, but may be out of the scope of this commit.\n\nLine 485:     def get_dhcp_hosts_text(self, context, subnet_id, project_id=None):\nThese methods share 10 lines, maybe the collection of information and iteration over that list could be abstracted?\n\nThere are a few others I wanted to do as well.", 
    "tags": [], 
    "importance": "Wishlist", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/887692", 
    "owner": "https://api.launchpad.net/1.0/~bgh", 
    "id": 887692, 
    "index": 1147, 
    "created": "2011-11-08 18:02:30.243382+00:00", 
    "title": "The QuantumManager could use some refactoring", 
    "comments": [
        {
            "content": "These changes were suggested by Aaron Lee during his review:\n\nPatch Set 9: (5 inline comments)\n\nI'm giving this a 0 because all of my comments are about refactorings that would have made it easier for me to read what this patch is doing. The functionality looks good, as far as I can tell, but I think the code needs to be cleaner.\n\n....................................................\nFile nova/network/linux_net.py\nLine 995:         # Don't forward traffic unless we were told to be a gateway\nI would rather see the actions within the conditional more focused on the decision of the conditional.\n\ni.e.\nguard = \"DROP\"\nif gateway\n guard = \"ACCEPT\"\n\nfor direction in ['in', 'out']\n   iptables_manager.ipv4['filter'].add_rule('FORWARD',\n                                    '--$(direction)-interface %(guard)s -j %(bridge)s' % \\\n                                    locals())\n\nThis will make it much easier to fix errors in the generation of those commands.\n\n....................................................\nFile nova/network/quantum/manager.py\nLine 213:                     \"label\": \"quantum-net-%s\" % quantum_net_id}\nI don't think this get network ref logic is a part of allocating for an instance. It would be better stored in it's own method.\n\nLine 234:         LOG.info(\"Using DHCP for network: %s\" % network_ref['label'])\nThis would be much easier to maintain and test in small units if each step was a method, and enable_dhcp just called each individual method. Refactoring like that would also make more granular error handling easier.\n\nLine 449:                 subnet['network_id'], project_id)\nIt appears the real meat of this function is these three calls to the driver, it should be separated from populating the network_ref.\n\nThis data mutating done on this response from get_subnets_by_net_id is very similar to the changes made to this data on both other calls to get_subnets_by_net_id. This is another candidate for refactoring, but may be out of the scope of this commit.\n\nLine 485:     def get_dhcp_hosts_text(self, context, subnet_id, project_id=None):\nThese methods share 10 lines, maybe the collection of information and iteration over that list could be abstracted?\n\nThere are a few others I wanted to do as well.", 
            "date_created": "2011-11-08 18:02:30.243382+00:00", 
            "author": "https://api.launchpad.net/1.0/~bgh"
        }, 
        {
            "content": "The quantum interface isn't implemented as a manager anymore, so this isn't relevant anymore.", 
            "date_created": "2013-03-05 22:19:10.234533+00:00", 
            "author": "https://api.launchpad.net/1.0/~russellb"
        }
    ]
}