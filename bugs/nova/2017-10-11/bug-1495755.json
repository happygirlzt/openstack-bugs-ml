{
    "status": "Invalid", 
    "last_updated": "2015-09-28 23:16:53.608591+00:00", 
    "description": "Test fails sporadically or consistency depending on your setup. I could make pass or fail consistently depending on level at which test was executed. I expect test is depending on something done outside the test that can occur out of order (i.e. db setup / table creation):\n\n(dev)[~/src/rackspace/openstack/nova] ./run_tests.sh -d nova.tests.unit.api.openstack.compute.test_quota_classes.QuotaClassesPolicyEnforcementV21.test_show_policy_failed\nTests running...\nnova/db/sqlalchemy/api.py:156: OsloDBDeprecationWarning: EngineFacade is deprecated; please use oslo.db.sqlalchemy.enginefacade\n  retry_interval=conf_group.retry_interval)\n======================================================================\nERROR: nova.tests.unit.api.openstack.compute.test_quota_classes.QuotaClassesPolicyEnforcementV21.test_show_policy_failed\n----------------------------------------------------------------------\nEmpty attachments:\n  pythonlogging:''\n\nTraceback (most recent call last):\n  File \"nova/tests/unit/api/openstack/compute/test_quota_classes.py\", line 170, in setUp\n    extension_info=ext_info)\n  File \"nova/api/openstack/compute/quota_classes.py\", line 45, in __init__\n    self.supported_quotas = QUOTAS.resources\n  File \"nova/quota.py\", line 1473, in resources\n    self._register_resources_by_flavor(ctxt)\n  File \"nova/quota.py\", line 1183, in _register_resources_by_flavor\n    flavors = db.flavor_get_all(ctxt, inactive=True)\n  File \"nova/db/api.py\", line 1455, in flavor_get_all\n    sort_dir=sort_dir, limit=limit, marker=marker)\n  File \"nova/db/sqlalchemy/api.py\", line 230, in wrapper\n    return f(*args, **kwargs)\n  File \"nova/db/sqlalchemy/api.py\", line 4835, in flavor_get_all\n    inst_types = query.all()\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/orm/query.py\", line 2399, in all\n    return list(self)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/orm/query.py\", line 2516, in __iter__\n    return self._execute_and_instances(context)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/orm/query.py\", line 2531, in _execute_and_instances\n    result = conn.execute(querycontext.statement, self._params)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 914, in execute\n    return meth(self, multiparams, params)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/sql/elements.py\", line 323, in _execute_on_connection\n    return connection._execute_clauseelement(self, multiparams, params)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1010, in _execute_clauseelement\n    compiled_sql, distilled_params\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1146, in _execute_context\n    context)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1337, in _handle_dbapi_exception\n    util.raise_from_cause(newraise, exc_info)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/util/compat.py\", line 199, in raise_from_cause\n    reraise(type(exception), exception, tb=exc_tb)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1139, in _execute_context\n    context)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/default.py\", line 450, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: instance_types [SQL: u'SELECT instance_types.created_at AS instance_types_created_at, instance_types.updated_at AS instance_types_updated_at, instance_types.deleted_at AS instance_types_deleted_at, instance_types.deleted AS instance_types_deleted, instance_types.id AS instance_types_id, instance_types.name AS instance_types_name, instance_types.memory_mb AS instance_types_memory_mb, instance_types.vcpus AS instance_types_vcpus, instance_types.root_gb AS instance_types_root_gb, instance_types.ephemeral_gb AS instance_types_ephemeral_gb, instance_types.flavorid AS instance_types_flavorid, instance_types.swap AS instance_types_swap, instance_types.rxtx_factor AS instance_types_rxtx_factor, instance_types.vcpu_weight AS instance_types_vcpu_weight, instance_types.disabled AS instance_types_disabled, instance_types.is_public AS instance_types_is_public, instance_type_extra_specs_1.created_at AS instance_type_extra_specs_1_created_at, instance_type_extra_specs_1.updated_at AS instance_type_extra_specs_1_updated_at, instance_type_extra_specs_1.deleted_at AS instance_type_extra_specs_1_deleted_at, instance_type_extra_specs_1.deleted AS instance_type_extra_specs_1_deleted, instance_type_extra_specs_1.id AS instance_type_extra_specs_1_id, instance_type_extra_specs_1.\"key\" AS instance_type_extra_specs_1_key, instance_type_extra_specs_1.value AS instance_type_extra_specs_1_value, instance_type_extra_specs_1.instance_type_id AS instance_type_extra_specs_1_instance_type_id \\nFROM instance_types LEFT OUTER JOIN instance_type_extra_specs AS instance_type_extra_specs_1 ON instance_type_extra_specs_1.instance_type_id = instance_types.id AND instance_type_extra_specs_1.deleted = ? ORDER BY instance_types.flavorid ASC, instance_types.id ASC'] [parameters: (0,)]\n\nRan 1 test in 0.784s\nFAILED (failures=1)\n(dev)[~/src/rackspace/openstack/nova] ./run_tests.sh -d nova.tests.unit.api.openstack.compute.test_quota_classes\nTests running...\nnova/context.py:185: DeprecationWarning: Using function/method 'oslo_utils.timeutils.strtime()' is deprecated in version '1.6' and will be removed in a future version: use either datetime.datetime.isoformat() or datetime.datetime.strftime() instead\n  self, 'timestamp') else None,\n\nRan 20 tests in 2.761s\nOK\n(dev)[~/src/rackspace/openstack/nova]", 
    "tags": [
        "quotas", 
        "testing"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1495755", 
    "owner": "None", 
    "id": 1495755, 
    "index": 5762, 
    "created": "2015-09-15 02:21:16.585775+00:00", 
    "title": "test_show_policy_failed fails (depending on another test to create db?)", 
    "comments": [
        {
            "content": "Test fails sporadically or consistency depending on your setup. I could make pass or fail consistently depending on level at which test was executed. I expect test is depending on something done outside the test that can occur out of order (i.e. db setup / table creation):\n\n(dev)[~/src/rackspace/openstack/nova] ./run_tests.sh -d nova.tests.unit.api.openstack.compute.test_quota_classes.QuotaClassesPolicyEnforcementV21.test_show_policy_failed\nTests running...\nnova/db/sqlalchemy/api.py:156: OsloDBDeprecationWarning: EngineFacade is deprecated; please use oslo.db.sqlalchemy.enginefacade\n  retry_interval=conf_group.retry_interval)\n======================================================================\nERROR: nova.tests.unit.api.openstack.compute.test_quota_classes.QuotaClassesPolicyEnforcementV21.test_show_policy_failed\n----------------------------------------------------------------------\nEmpty attachments:\n  pythonlogging:''\n\nTraceback (most recent call last):\n  File \"nova/tests/unit/api/openstack/compute/test_quota_classes.py\", line 170, in setUp\n    extension_info=ext_info)\n  File \"nova/api/openstack/compute/quota_classes.py\", line 45, in __init__\n    self.supported_quotas = QUOTAS.resources\n  File \"nova/quota.py\", line 1473, in resources\n    self._register_resources_by_flavor(ctxt)\n  File \"nova/quota.py\", line 1183, in _register_resources_by_flavor\n    flavors = db.flavor_get_all(ctxt, inactive=True)\n  File \"nova/db/api.py\", line 1455, in flavor_get_all\n    sort_dir=sort_dir, limit=limit, marker=marker)\n  File \"nova/db/sqlalchemy/api.py\", line 230, in wrapper\n    return f(*args, **kwargs)\n  File \"nova/db/sqlalchemy/api.py\", line 4835, in flavor_get_all\n    inst_types = query.all()\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/orm/query.py\", line 2399, in all\n    return list(self)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/orm/query.py\", line 2516, in __iter__\n    return self._execute_and_instances(context)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/orm/query.py\", line 2531, in _execute_and_instances\n    result = conn.execute(querycontext.statement, self._params)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 914, in execute\n    return meth(self, multiparams, params)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/sql/elements.py\", line 323, in _execute_on_connection\n    return connection._execute_clauseelement(self, multiparams, params)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1010, in _execute_clauseelement\n    compiled_sql, distilled_params\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1146, in _execute_context\n    context)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1337, in _handle_dbapi_exception\n    util.raise_from_cause(newraise, exc_info)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/util/compat.py\", line 199, in raise_from_cause\n    reraise(type(exception), exception, tb=exc_tb)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1139, in _execute_context\n    context)\n  File \"/home/jesse/src/rackspace/openstack/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/engine/default.py\", line 450, in do_execute\n    cursor.execute(statement, parameters)\nsqlalchemy.exc.OperationalError: (sqlite3.OperationalError) no such table: instance_types [SQL: u'SELECT instance_types.created_at AS instance_types_created_at, instance_types.updated_at AS instance_types_updated_at, instance_types.deleted_at AS instance_types_deleted_at, instance_types.deleted AS instance_types_deleted, instance_types.id AS instance_types_id, instance_types.name AS instance_types_name, instance_types.memory_mb AS instance_types_memory_mb, instance_types.vcpus AS instance_types_vcpus, instance_types.root_gb AS instance_types_root_gb, instance_types.ephemeral_gb AS instance_types_ephemeral_gb, instance_types.flavorid AS instance_types_flavorid, instance_types.swap AS instance_types_swap, instance_types.rxtx_factor AS instance_types_rxtx_factor, instance_types.vcpu_weight AS instance_types_vcpu_weight, instance_types.disabled AS instance_types_disabled, instance_types.is_public AS instance_types_is_public, instance_type_extra_specs_1.created_at AS instance_type_extra_specs_1_created_at, instance_type_extra_specs_1.updated_at AS instance_type_extra_specs_1_updated_at, instance_type_extra_specs_1.deleted_at AS instance_type_extra_specs_1_deleted_at, instance_type_extra_specs_1.deleted AS instance_type_extra_specs_1_deleted, instance_type_extra_specs_1.id AS instance_type_extra_specs_1_id, instance_type_extra_specs_1.\"key\" AS instance_type_extra_specs_1_key, instance_type_extra_specs_1.value AS instance_type_extra_specs_1_value, instance_type_extra_specs_1.instance_type_id AS instance_type_extra_specs_1_instance_type_id \\nFROM instance_types LEFT OUTER JOIN instance_type_extra_specs AS instance_type_extra_specs_1 ON instance_type_extra_specs_1.instance_type_id = instance_types.id AND instance_type_extra_specs_1.deleted = ? ORDER BY instance_types.flavorid ASC, instance_types.id ASC'] [parameters: (0,)]\n\nRan 1 test in 0.784s\nFAILED (failures=1)\n(dev)[~/src/rackspace/openstack/nova] ./run_tests.sh -d nova.tests.unit.api.openstack.compute.test_quota_classes\nTests running...\nnova/context.py:185: DeprecationWarning: Using function/method 'oslo_utils.timeutils.strtime()' is deprecated in version '1.6' and will be removed in a future version: use either datetime.datetime.isoformat() or datetime.datetime.strftime() instead\n  self, 'timestamp') else None,\n\nRan 20 tests in 2.761s\nOK\n(dev)[~/src/rackspace/openstack/nova]", 
            "date_created": "2015-09-15 02:21:16.585775+00:00", 
            "author": "https://api.launchpad.net/1.0/~jesse-j-cook"
        }, 
        {
            "content": "What level of code?  Git hash?  And does this fail with tox?", 
            "date_created": "2015-09-24 16:21:25.499987+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "class QuotaClassesPolicyEnforcementV21(test.NoDBTestCase): is a NoDBTestCase so it shouldn't be accessing the database at all.\n\nI have no problem running that test on it's own:\n\nhttp://paste.openstack.org/show/473910/\n\nRemember that RAX has out of tree things for quota classes, so maybe you're just hitting failures because of forks in the RAX version of nova's quota classes.", 
            "date_created": "2015-09-24 16:47:25.569806+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Well that's embarrassing. This bug does not effect openstack/master. Apologies.", 
            "date_created": "2015-09-28 23:16:52.232359+00:00", 
            "author": "https://api.launchpad.net/1.0/~jesse-j-cook"
        }
    ]
}