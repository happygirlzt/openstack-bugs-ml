{
    "status": "In Progress", 
    "last_updated": "2017-10-07 19:19:21.753834+00:00", 
    "description": "Attempting to clean out some old constants that have been marked deprecated in os-brick for over a year. Job failures show there are some libvirt volume drivers still using the old constants.\n\nTraceback (most recent call last):\n   File \"/usr/local/bin/nova-compute\", line 10, in <module>\n     sys.exit(main())\n   File \"/opt/stack/new/nova/nova/cmd/compute.py\", line 59, in main\n     topic=compute_rpcapi.RPC_TOPIC)\n   File \"/opt/stack/new/nova/nova/service.py\", line 258, in create\n     periodic_interval_max=periodic_interval_max)\n   File \"/opt/stack/new/nova/nova/service.py\", line 127, in __init__\n     self.manager = manager_class(host=self.host, *args, **kwargs)\n   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 535, in __init__\n     self.driver = driver.load_compute_driver(self.virtapi, compute_driver)\n   File \"/opt/stack/new/nova/nova/virt/driver.py\", line 1609, in load_compute_driver\n     virtapi)\n   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/importutils.py\", line 44, in import_object\n     return import_class(import_str)(*args, **kwargs)\n   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 337, in __init__\n     self.volume_drivers = self._get_volume_drivers()\n   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 395, in _get_volume_drivers\n     driver_registry[driver_type] = driver_class(self._host)\n   File \"/opt/stack/new/nova/nova/virt/libvirt/volume/drbd.py\", line 29, in __init__\n     connector.DRBD, utils.get_root_helper())\n AttributeError: 'module' object has no attribute 'DRBD'\n\n\nThese just need to be updated to point to the new constants.\n\nThis change was done is os-brick 1.6.0. All the way back to Newton, our minimum for os-brick is 1.6.2, so should be safe to remove the old constants and use the new ones.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1721993", 
    "owner": "https://api.launchpad.net/1.0/~sean-mcginnis", 
    "id": 1721993, 
    "index": 7066, 
    "created": "2017-10-07 18:33:39.694219+00:00", 
    "title": "libvirt volume drivers using deprecated os-brick constants", 
    "comments": [
        {
            "content": "Attempting to clean out some old constants that have been marked deprecated in os-brick for over a year. Job failures show there are some libvirt volume drivers still using the old constants.\n\nTraceback (most recent call last):\nOct 05 04:47:09.563746 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova   File \"/usr/local/bin/nova-compute\", line 10, in <module>\nOct 05 04:47:09.563870 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova     sys.exit(main())\nOct 05 04:47:09.564004 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova   File \"/opt/stack/new/nova/nova/cmd/compute.py\", line 59, in main\nOct 05 04:47:09.564117 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova     topic=compute_rpcapi.RPC_TOPIC)\nOct 05 04:47:09.564225 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova   File \"/opt/stack/new/nova/nova/service.py\", line 258, in create\nOct 05 04:47:09.564353 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova     periodic_interval_max=periodic_interval_max)\nOct 05 04:47:09.564461 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova   File \"/opt/stack/new/nova/nova/service.py\", line 127, in __init__\nOct 05 04:47:09.564566 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova     self.manager = manager_class(host=self.host, *args, **kwargs)\nOct 05 04:47:09.564692 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 535, in __init__\nOct 05 04:47:09.564803 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova     self.driver = driver.load_compute_driver(self.virtapi, compute_driver)\nOct 05 04:47:09.564915 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova   File \"/opt/stack/new/nova/nova/virt/driver.py\", line 1609, in load_compute_driver\nOct 05 04:47:09.565039 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova     virtapi)\nOct 05 04:47:09.565143 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/importutils.py\", line 44, in import_object\nOct 05 04:47:09.565246 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova     return import_class(import_str)(*args, **kwargs)\nOct 05 04:47:09.565349 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 337, in __init__\nOct 05 04:47:09.565453 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova     self.volume_drivers = self._get_volume_drivers()\nOct 05 04:47:09.565556 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 395, in _get_volume_drivers\nOct 05 04:47:09.565684 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova     driver_registry[driver_type] = driver_class(self._host)\nOct 05 04:47:09.565822 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova   File \"/opt/stack/new/nova/nova/virt/libvirt/volume/drbd.py\", line 29, in __init__\nOct 05 04:47:09.565929 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova     connector.DRBD, utils.get_root_helper())\nOct 05 04:47:09.566068 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova AttributeError: 'module' object has no attribute 'DRBD'\nOct 05 04:47:09.566192 ubuntu-xenial-rax-ord-11225566 nova-compute[31743]: ERROR nova \nOct 05 04:47:09.719027 ubuntu-xenial-rax-ord-11225566 systemd[1]: <email address hidden>: Main process exited, code=exited, status=1/FAILURE\nOct 05 04:47:09.719269 ubuntu-xenial-rax-ord-11225566 systemd[1]: <email address hidden>: Unit entered failed state.\nOct 05 04:47:09.719303 ubuntu-xenial-rax-ord-11225566 systemd[1]: <email address hidden>: Failed with result 'exit-code'.\n\nThese just need to be updated to point to the new constants.\n\nThis change was done is os-brick 1.6.0. All the way back to Newton, our minimum for os-brick is 1.6.2, so should be safe to remove the old constants and use the new ones.", 
            "date_created": "2017-10-07 18:33:39.694219+00:00", 
            "author": "https://api.launchpad.net/1.0/~sean-mcginnis"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/510311", 
            "date_created": "2017-10-07 18:52:00.776621+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}