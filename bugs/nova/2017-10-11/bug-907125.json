{
    "status": "Invalid", 
    "last_updated": "2012-03-16 10:45:34.205103+00:00", 
    "description": "Test Environment:\n\nNova stable/diablo (d3f32f742c1622f2d8b4b6fc5f42b04ea5da5664) on 2 machines.  Launch 20 VMs (in parallel) at a time take them down and launch another 20.\n\nError:\n\nWhen run  euca-describe-instances during and after the VM launch process  it occasionally says\n\n# euca-describe-instances \nUnknownError: An unknown error has occurred. Please try your request again.\n\n\"Parent instance <FixedIp at 0x5dd6390> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed\"\n\nThis error is similar to Bug #785816 and Bug #815957\n\nStackTrace (from nova-api.log)\n\n2011-12-20 13:07:33,881 ERROR nova.api [69c94d83-24fc-403c-b550-ac528ac80414 nova project_503] Unexpected error raised: Parent instance <FixedIp at 0x5dd6390> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed\n(nova.api): TRACE: Traceback (most recent call last):(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/api/ec2/__init__.py\", line 348, in __call__\n(nova.api): TRACE:     result = api_request.invoke(context)(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/api/ec2/apirequest.py\", line 78, in invoke\n(nova.api): TRACE:     result = method(context, **args)\n(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/api/ec2/cloud.py\", line 1152, in describe_instances\n(nova.api): TRACE:     instance_id=instance_id)(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/api/ec2/cloud.py\", line 1161, in _format_describe_instances\n(nova.api): TRACE:     return {'reservationSet': self._format_instances(context, **kwargs)}\n(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/api/ec2/cloud.py\", line 1266, in _format_instances(nova.api): TRACE:     if fixed['network'] and use_v6:\n(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/db/sqlalchemy/models.py\", line 76, in __getitem__(nova.api): TRACE:     return getattr(self, key)\n(nova.api): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 163, in __get__\n(nova.api): TRACE:     instance_dict(instance))\n(nova.api): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 383, in get\n(nova.api): TRACE:     value = callable_(passive=passive)\n(nova.api): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/strategies.py\", line 595, in __call__\n(nova.api): TRACE:     (mapperutil.state_str(state), self.key)(nova.api): TRACE: DetachedInstanceError: Parent instance <FixedIp at 0x5dd6390> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed(nova.api): TRACE:", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 16, 
    "link": "https://bugs.launchpad.net/nova/+bug/907125", 
    "owner": "None", 
    "id": 907125, 
    "index": 2446, 
    "created": "2011-12-21 00:46:43.769189+00:00", 
    "title": "nova-api throws 'lazy load operation of attribute 'network' cannot proceed'  under stress", 
    "comments": [
        {
            "content": "running euca-describe-instances after launching and destroying a lot of images causes nova-api to throw an error:\n\n\"Parent instance <FixedIp at 0x5dd6390> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed\"\n\nThis error is similar to Bug #785816 and Bug #815957\n\n\n2011-12-20 13:07:33,881 ERROR nova.api [69c94d83-24fc-403c-b550-ac528ac80414 nova project_503] Unexpected error raised: Parent instance <FixedIp at 0x5dd6390> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed\n(nova.api): TRACE: Traceback (most recent call last):(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/api/ec2/__init__.py\", line 348, in __call__\n(nova.api): TRACE:     result = api_request.invoke(context)(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/api/ec2/apirequest.py\", line 78, in invoke\n(nova.api): TRACE:     result = method(context, **args)\n(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/api/ec2/cloud.py\", line 1152, in describe_instances\n(nova.api): TRACE:     instance_id=instance_id)(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/api/ec2/cloud.py\", line 1161, in _format_describe_instances\n(nova.api): TRACE:     return {'reservationSet': self._format_instances(context, **kwargs)}\n(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/api/ec2/cloud.py\", line 1266, in _format_instances(nova.api): TRACE:     if fixed['network'] and use_v6:\n(nova.api): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/nova/db/sqlalchemy/models.py\", line 76, in __getitem__(nova.api): TRACE:     return getattr(self, key)\n(nova.api): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 163, in __get__\n(nova.api): TRACE:     instance_dict(instance))\n(nova.api): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 383, in get\n(nova.api): TRACE:     value = callable_(passive=passive)\n(nova.api): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/strategies.py\", line 595, in __call__\n(nova.api): TRACE:     (mapperutil.state_str(state), self.key)(nova.api): TRACE: DetachedInstanceError: Parent instance <FixedIp at 0x5dd6390> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed(nova.api): TRACE:", 
            "date_created": "2011-12-21 00:46:43.769189+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "Is it Diablo-specific ?", 
            "date_created": "2012-03-15 16:43:45.914529+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "This was seen by a few people in diablo. There is an odd workaround which we could put in to diablo that was discovered by HP:\n\n\ndiff --git a/nova/db/sqlalchemy/models.py b/nova/db/sqlalchemy/models.py\nindex b5f30a1..034e0b4 100644\n--- a/nova/db/sqlalchemy/models.py\n+++ b/nova/db/sqlalchemy/models.py\n@@ -669,7 +669,7 @@ class FixedIp(BASE, NovaBase):\n     id = Column(Integer, primary_key=True)\n     address = Column(String(255))\n     network_id = Column(Integer, ForeignKey('networks.id'), nullable=True)\n-    network = relationship(Network, backref=backref('fixed_ips'))\n+    network = relationship(Network, backref=backref('fixed_ips'), lazy='joined')\n     virtual_interface_id = Column(Integer, ForeignKey('virtual_interfaces.id'),\n                                                                  nullable=True)\n     virtual_interface = relationship(VirtualInterface,\n\nUnfortunately, we could never figure out exactly why this fixes it, as it is very hard to reproduce consistently except under load.  The offending relationship has been removed in essex so it no longer applies.", 
            "date_created": "2012-03-15 17:29:11.884864+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }
    ]
}