{
    "status": "Fix Released", 
    "last_updated": "2010-10-25 19:59:12.954619+00:00", 
    "description": "This is why we *really* need to get Hudson running the nosetests on OpenStack/RS unit tests before merge can happen :(\n\nMain test suite runs fine.  But test fails when running nosetests on openstack API unit tests:\n\n======================================================================\nERROR: test_create_instance (nova.tests.api.openstack.test_servers.ServersTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/home/jpipes/repos/nova/glance-image-service/nova/tests/api/openstack/test_servers.py\", line 126, in test_create_instance\n    res = req.get_response(nova.api.API())\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/request.py\", line 919, in get_response\n    application, catch_exc_info=False)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/request.py\", line 887, in call_application\n    app_iter = application(self.environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/routes/middleware.py\", line 131, in __call__\n    response = self.app(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/routes/middleware.py\", line 131, in __call__\n    response = self.app(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 147, in __call__\n    resp = self.call_func(req, *args, **self.kwargs)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 208, in call_func\n    return self.func(req, *args, **kwargs)\n  File \"/home/jpipes/repos/nova/glance-image-service/nova/wsgi.py\", line 217, in __call__\n    result = method(**arg_dict)\n  File \"/home/jpipes/repos/nova/glance-image-service/nova/api/openstack/servers.py\", line 143, in create\n    inst = self._build_server_instance(req, env)\n  File \"/home/jpipes/repos/nova/glance-image-service/nova/api/openstack/servers.py\", line 257, in _build_server_instance\n    network_topic = self._get_network_topic(None)\n  File \"/home/jpipes/repos/nova/glance-image-service/nova/api/openstack/servers.py\", line 266, in _get_network_topic\n    network_ref = self.network_manager.get_network(context)\nAttributeError: 'Controller' object has no attribute 'network_manager'\n-------------------- >> begin captured logging << --------------------\nroutes.middleware: DEBUG: Initialized with method overriding = True, and path info altering = True\nroutes.middleware: DEBUG: Initialized with method overriding = True, and path info altering = True\nroutes.middleware: DEBUG: Matched POST /v1.0/servers\nroutes.middleware: DEBUG: Route path: '/v1.0/{path_info:.*}', defaults: {'controller': <nova.api.openstack.API object at 0x55597d0>}\nroutes.middleware: DEBUG: Match dict: {'controller': <nova.api.openstack.API object at 0x55597d0>, 'sub_domain': None, 'path_info': 'servers'}\nroutes.middleware: DEBUG: Matched POST /servers\nroutes.middleware: DEBUG: Route path: '/servers', defaults: {'action': u'create', 'controller': <nova.api.openstack.servers.Controller object at 0x5559a10>}\nroutes.middleware: DEBUG: Match dict: {'req': <Request at 0x39def10 POST http://localhost/v1.0/servers>}\n--------------------- >> end captured logging << ---------------------\n\n----------------------------------------------------------------------\nRan 63 tests in 7.053s\n\nFAILED (errors=1)", 
    "tags": [], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/660095", 
    "owner": "https://api.launchpad.net/1.0/~jaypipes", 
    "id": 660095, 
    "index": 306, 
    "created": "2010-10-13 17:59:32.847463+00:00", 
    "title": "OpenStack 'create instance' API call broken after r138", 
    "comments": [
        {
            "content": "This is why we *really* need to get Hudson running the nosetests on OpenStack/RS unit tests before merge can happen :(\n\nMain test suite runs fine.  But test fails when running nosetests on openstack API unit tests:\n\n======================================================================\nERROR: test_create_instance (nova.tests.api.openstack.test_servers.ServersTest)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/home/jpipes/repos/nova/glance-image-service/nova/tests/api/openstack/test_servers.py\", line 126, in test_create_instance\n    res = req.get_response(nova.api.API())\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/request.py\", line 919, in get_response\n    application, catch_exc_info=False)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/request.py\", line 887, in call_application\n    app_iter = application(self.environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/routes/middleware.py\", line 131, in __call__\n    response = self.app(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/routes/middleware.py\", line 131, in __call__\n    response = self.app(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n    return resp(environ, start_response)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 147, in __call__\n    resp = self.call_func(req, *args, **self.kwargs)\n  File \"/home/jpipes/repos/nova/glance-image-service/.nova-venv/lib/python2.6/site-packages/webob/dec.py\", line 208, in call_func\n    return self.func(req, *args, **kwargs)\n  File \"/home/jpipes/repos/nova/glance-image-service/nova/wsgi.py\", line 217, in __call__\n    result = method(**arg_dict)\n  File \"/home/jpipes/repos/nova/glance-image-service/nova/api/openstack/servers.py\", line 143, in create\n    inst = self._build_server_instance(req, env)\n  File \"/home/jpipes/repos/nova/glance-image-service/nova/api/openstack/servers.py\", line 257, in _build_server_instance\n    network_topic = self._get_network_topic(None)\n  File \"/home/jpipes/repos/nova/glance-image-service/nova/api/openstack/servers.py\", line 266, in _get_network_topic\n    network_ref = self.network_manager.get_network(context)\nAttributeError: 'Controller' object has no attribute 'network_manager'\n-------------------- >> begin captured logging << --------------------\nroutes.middleware: DEBUG: Initialized with method overriding = True, and path info altering = True\nroutes.middleware: DEBUG: Initialized with method overriding = True, and path info altering = True\nroutes.middleware: DEBUG: Matched POST /v1.0/servers\nroutes.middleware: DEBUG: Route path: '/v1.0/{path_info:.*}', defaults: {'controller': <nova.api.openstack.API object at 0x55597d0>}\nroutes.middleware: DEBUG: Match dict: {'controller': <nova.api.openstack.API object at 0x55597d0>, 'sub_domain': None, 'path_info': 'servers'}\nroutes.middleware: DEBUG: Matched POST /servers\nroutes.middleware: DEBUG: Route path: '/servers', defaults: {'action': u'create', 'controller': <nova.api.openstack.servers.Controller object at 0x5559a10>}\nroutes.middleware: DEBUG: Match dict: {'req': <Request at 0x39def10 POST http://localhost/v1.0/servers>}\n--------------------- >> end captured logging << ---------------------\n\n----------------------------------------------------------------------\nRan 63 tests in 7.053s\n\nFAILED (errors=1)", 
            "date_created": "2010-10-13 17:59:32.847463+00:00", 
            "author": "https://api.launchpad.net/1.0/~jaypipes"
        }
    ]
}