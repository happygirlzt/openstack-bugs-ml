{
    "status": "Fix Released", 
    "last_updated": "2015-10-15 08:50:55.545542+00:00", 
    "description": "The Ironic nova driver will look at the Ironic node to fetch the amount of CPUs, memory, disk etc... But it doesn't validate any of this properties making it fail horribly if the node is misconfigured. It should be more resilient to failures.\n\nTraceback:\n\nApr 21 11:11:33 nova-compute[32119]: Traceback (most recent call last):\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/eventlet/queue.py\", line 117, in switch\nApr 21 11:11:33 nova-compute[32119]: self.greenlet.switch(value)\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 214, in main\nApr 21 11:11:33 nova-compute[32119]: result = function(*args, **kwargs)\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/openstack/common/service.py\", line 497, in run_service\nApr 21 11:11:33 nova-compute[32119]: service.start()\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/service.py\", line 183, in start\nApr 21 11:11:33 nova-compute[32119]: self.manager.pre_start_hook()\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 1250, in pre_start_hook\nApr 21 11:11:33 nova-compute[32119]: self.update_available_resource(nova.context.get_admin_context())\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 6197, in update_available_resource\nApr 21 11:11:33 nova-compute[32119]: rt.update_available_resource(context)\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/compute/resource_tracker.py\", line 376, in update_available_resource\nApr 21 11:11:33 nova-compute[32119]: resources = self.driver.get_available_resource(self.nodename)\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/virt/ironic/driver.py\", line 535, in get_available_resource\nApr 21 11:11:33 nova-compute[32119]: return self._node_resource(node)\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/virt/ironic/driver.py\", line 228, in _node_resource\nApr 21 11:11:33 nova-compute[32119]: vcpus = int(node.properties.get('cpus', 0))\nApr 21 11:11:33 nova-compute[32119]: ValueError: invalid literal for int() with base 10: 'None'\n\n+------------------------+-------------------------------------------------------------------------+\n| Property               | Value                                                                   |\n+------------------------+-------------------------------------------------------------------------+\n...\n| properties             | {u'memory_mb': u'None', u'cpu_arch': None, u'local_gb': u'None',        |\n|                        | u'cpus': u'None', u'capabilities': u'boot_option:local'}                |\n...", 
    "tags": [
        "ironic"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1447642", 
    "owner": "https://api.launchpad.net/1.0/~lucasagomes", 
    "id": 1447642, 
    "index": 4231, 
    "created": "2015-04-23 14:30:31.556347+00:00", 
    "title": "Ironic: Driver should validate the node's properties", 
    "comments": [
        {
            "content": "The Ironic nova driver will look at the Ironic node to fetch the amount of CPUs, memory, disk etc... But it doesn't validate any of this properties making it fail horribly if the node is misconfigured. It should be more resilient to failures.\n\nTraceback:\n\nApr 21 11:11:33 nova-compute[32119]: Traceback (most recent call last):\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/eventlet/queue.py\", line 117, in switch\nApr 21 11:11:33 nova-compute[32119]: self.greenlet.switch(value)\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 214, in main\nApr 21 11:11:33 nova-compute[32119]: result = function(*args, **kwargs)\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/openstack/common/service.py\", line 497, in run_service\nApr 21 11:11:33 nova-compute[32119]: service.start()\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/service.py\", line 183, in start\nApr 21 11:11:33 nova-compute[32119]: self.manager.pre_start_hook()\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 1250, in pre_start_hook\nApr 21 11:11:33 nova-compute[32119]: self.update_available_resource(nova.context.get_admin_context())\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 6197, in update_available_resource\nApr 21 11:11:33 nova-compute[32119]: rt.update_available_resource(context)\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/compute/resource_tracker.py\", line 376, in update_available_resource\nApr 21 11:11:33 nova-compute[32119]: resources = self.driver.get_available_resource(self.nodename)\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/virt/ironic/driver.py\", line 535, in get_available_resource\nApr 21 11:11:33 nova-compute[32119]: return self._node_resource(node)\nApr 21 11:11:33 nova-compute[32119]: File \"/usr/lib/python2.7/site-packages/nova/virt/ironic/driver.py\", line 228, in _node_resource\nApr 21 11:11:33 nova-compute[32119]: vcpus = int(node.properties.get('cpus', 0))\nApr 21 11:11:33 nova-compute[32119]: ValueError: invalid literal for int() with base 10: 'None'\n\n+------------------------+-------------------------------------------------------------------------+\n| Property               | Value                                                                   |\n+------------------------+-------------------------------------------------------------------------+\n...\n| properties             | {u'memory_mb': u'None', u'cpu_arch': None, u'local_gb': u'None',        |\n|                        | u'cpus': u'None', u'capabilities': u'boot_option:local'}                |\n...", 
            "date_created": "2015-04-23 14:30:31.556347+00:00", 
            "author": "https://api.launchpad.net/1.0/~lucasagomes"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/176890", 
            "date_created": "2015-04-23 16:14:14.808752+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/176890\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=3b7cedb33445624788950146997dafca7e57638b\nSubmitter: Jenkins\nBranch:    master\n\ncommit 3b7cedb33445624788950146997dafca7e57638b\nAuthor: Lucas Alvares Gomes <email address hidden>\nDate:   Thu Apr 23 16:22:09 2015 +0100\n\n    Ironic: Parse and validate Node's properties\n    \n    This patch makes the Ironic driver more resilient to failures when\n    parsing the Node's properties.\n    \n    Closes-Bug: #1447642\n    Change-Id: Id31374a39e850b7ae922558f52e8bc658447c7fd\n", 
            "date_created": "2015-06-09 20:15:31.413537+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}