{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:42:56.706405+00:00", 
    "description": "Consider if network list is empty and  `list all networks' call is performed with OS API. \nnova-api performs an RPC call. Then NoNetworksFound will be raised in nova-network. nova-api will raise RemoteError. Finally, a computeFault will be reported to the end user.\n\nExample.\ncurl -i 'main-node:8774/v1.1/45d2e66674b647c2bee1d1f18ae64e93/os-networks' -H 'x-auth-token: f796ca9341b54bf897c91aa65fe4374a'\nHTTP/1.1 500 Internal Server Error\nContent-Length: 128\nContent-Type: application/json; charset=UTF-8\nX-Compute-Request-Id: req-a45fc407-feda-4f69-b27c-ce042892f28b\nDate: Thu, 12 Jul 2012 08:59:09 GMT\n\n{\"computeFault\": {\"message\": \"The server has either erred or is incapable of performing the requested operation.\", \"code\": 500}}\n\n\n\nnova-network log:\n\n2012-07-12 11:59:09 TRACE nova.rpc.amqp Traceback (most recent call last):\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/rpc/amqp.py\", line 253, in _process_data\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     rval = node_func(context=ctxt, **node_args)\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/network/manager.py\", line 257, in wrapped\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     return func(self, context, *args, **kwargs)\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/network/manager.py\", line 1567, in get_all_networks\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     networks = self.db.network_get_all(context)\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/db/api.py\", line 760, in network_get_all\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     return IMPL.network_get_all(context)\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/db/sqlalchemy/api.py\", line 102, in wrapper\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     return f(*args, **kwargs)\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/db/sqlalchemy/api.py\", line 1943, in network_get_all\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     raise exception.NoNetworksFound()\n2012-07-12 11:59:09 TRACE nova.rpc.amqp NoNetworksFound: No networks defined.\n2012-07-12 11:59:09 TRACE nova.rpc.amqp \n\n\n\nnova-api log:\n\n2012-07-12 11:59:09 TRACE nova.api.openstack Traceback (most recent call last):\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/__init__.py\", line 41, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return req.get_response(self.application)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/request.py\", line 1053, in get_response\n2012-07-12 11:59:09 TRACE nova.api.openstack     application, catch_exc_info=False)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/request.py\", line 1022, in call_application\n2012-07-12 11:59:09 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/keystone/middleware/auth_token.py\", line 176, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return self.app(env, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/routes/middleware.py\", line 131, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 147, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 208, in call_func\n2012-07-12 11:59:09 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 803, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     content_type, body, accept)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 851, in _process_stack\n2012-07-12 11:59:09 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 926, in dispatch\n2012-07-12 11:59:09 TRACE nova.api.openstack     return method(req=request, **action_args)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/compute/contrib/networks.py\", line 89, in index\n2012-07-12 11:59:09 TRACE nova.api.openstack     networks = self.network_api.get_all(context)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/network/api.py\", line 39, in get_all\n2012-07-12 11:59:09 TRACE nova.api.openstack     {'method': 'get_all_networks'})\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/rpc/__init__.py\", line 68, in call\n2012-07-12 11:59:09 TRACE nova.api.openstack     return _get_impl().call(context, topic, msg, timeout)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/rpc/impl_kombu.py\", line 674, in call\n2012-07-12 11:59:09 TRACE nova.api.openstack     return rpc_amqp.call(context, topic, msg, timeout, Connection.pool)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/rpc/amqp.py\", line 343, in call\n2012-07-12 11:59:09 TRACE nova.api.openstack     rv = list(rv)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/rpc/amqp.py\", line 311, in __iter__\n2012-07-12 11:59:09 TRACE nova.api.openstack     raise result\n2012-07-12 11:59:09 TRACE nova.api.openstack RemoteError: Remote error: NoNetworksFound No networks defined.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1023805", 
    "owner": "https://api.launchpad.net/1.0/~aababilov", 
    "id": 1023805, 
    "index": 2937, 
    "created": "2012-07-12 09:15:51.940541+00:00", 
    "title": "OS API: empty network list raises an exception", 
    "comments": [
        {
            "content": "Consider if network list is empty and  `list all networks' call is performed with OS API. \nnova-api performs an RPC call. Then NoNetworksFound will be raised in nova-network. nova-api will raise RemoteError. Finally, a computeFault will be reported to the end user.\n\nExample.\ncurl -i 'main-node:8774/v1.1/45d2e66674b647c2bee1d1f18ae64e93/os-networks' -H 'x-auth-token: f796ca9341b54bf897c91aa65fe4374a'\nHTTP/1.1 500 Internal Server Error\nContent-Length: 128\nContent-Type: application/json; charset=UTF-8\nX-Compute-Request-Id: req-a45fc407-feda-4f69-b27c-ce042892f28b\nDate: Thu, 12 Jul 2012 08:59:09 GMT\n\n{\"computeFault\": {\"message\": \"The server has either erred or is incapable of performing the requested operation.\", \"code\": 500}}\n\n\n\nnova-network log:\n\n2012-07-12 11:59:09 TRACE nova.rpc.amqp Traceback (most recent call last):\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/rpc/amqp.py\", line 253, in _process_data\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     rval = node_func(context=ctxt, **node_args)\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/network/manager.py\", line 257, in wrapped\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     return func(self, context, *args, **kwargs)\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/network/manager.py\", line 1567, in get_all_networks\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     networks = self.db.network_get_all(context)\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/db/api.py\", line 760, in network_get_all\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     return IMPL.network_get_all(context)\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/db/sqlalchemy/api.py\", line 102, in wrapper\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     return f(*args, **kwargs)\n2012-07-12 11:59:09 TRACE nova.rpc.amqp   File \"/usr/lib/python2.6/site-packages/nova/db/sqlalchemy/api.py\", line 1943, in network_get_all\n2012-07-12 11:59:09 TRACE nova.rpc.amqp     raise exception.NoNetworksFound()\n2012-07-12 11:59:09 TRACE nova.rpc.amqp NoNetworksFound: No networks defined.\n2012-07-12 11:59:09 TRACE nova.rpc.amqp \n\n\n\nnova-api log:\n\n2012-07-12 11:59:09 TRACE nova.api.openstack Traceback (most recent call last):\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/__init__.py\", line 41, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return req.get_response(self.application)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/request.py\", line 1053, in get_response\n2012-07-12 11:59:09 TRACE nova.api.openstack     application, catch_exc_info=False)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/request.py\", line 1022, in call_application\n2012-07-12 11:59:09 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/keystone/middleware/auth_token.py\", line 176, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return self.app(env, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/routes/middleware.py\", line 131, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 159, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 147, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 208, in call_func\n2012-07-12 11:59:09 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 803, in __call__\n2012-07-12 11:59:09 TRACE nova.api.openstack     content_type, body, accept)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 851, in _process_stack\n2012-07-12 11:59:09 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 926, in dispatch\n2012-07-12 11:59:09 TRACE nova.api.openstack     return method(req=request, **action_args)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/compute/contrib/networks.py\", line 89, in index\n2012-07-12 11:59:09 TRACE nova.api.openstack     networks = self.network_api.get_all(context)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/network/api.py\", line 39, in get_all\n2012-07-12 11:59:09 TRACE nova.api.openstack     {'method': 'get_all_networks'})\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/rpc/__init__.py\", line 68, in call\n2012-07-12 11:59:09 TRACE nova.api.openstack     return _get_impl().call(context, topic, msg, timeout)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/rpc/impl_kombu.py\", line 674, in call\n2012-07-12 11:59:09 TRACE nova.api.openstack     return rpc_amqp.call(context, topic, msg, timeout, Connection.pool)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/rpc/amqp.py\", line 343, in call\n2012-07-12 11:59:09 TRACE nova.api.openstack     rv = list(rv)\n2012-07-12 11:59:09 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/rpc/amqp.py\", line 311, in __iter__\n2012-07-12 11:59:09 TRACE nova.api.openstack     raise result\n2012-07-12 11:59:09 TRACE nova.api.openstack RemoteError: Remote error: NoNetworksFound No networks defined.", 
            "date_created": "2012-07-12 09:15:51.940541+00:00", 
            "author": "https://api.launchpad.net/1.0/~aababilov"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/9705", 
            "date_created": "2012-07-12 09:34:14.817585+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/9705\nCommitted: http://github.com/openstack/nova/commit/4d27b6e87bde179a8c4ada5bfc2f4cd7904f7b48\nSubmitter: Jenkins\nBranch:    master\n\ncommit 4d27b6e87bde179a8c4ada5bfc2f4cd7904f7b48\nAuthor: Alessio Ababilov <email address hidden>\nDate:   Thu Jul 12 12:31:50 2012 +0300\n\n    network manager returns empty list, not raise an exception\n    \n    Fix bug #1023805\n    \n    Change-Id: I9ddb10db127375ad37a7760b53e44782b392c2e3\n", 
            "date_created": "2012-07-14 00:25:38.211036+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}