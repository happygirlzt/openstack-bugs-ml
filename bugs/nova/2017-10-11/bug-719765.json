{
    "status": "Invalid", 
    "last_updated": "2011-02-23 11:09:35.715389+00:00", 
    "description": "Running trunk of nova, I get this traceback immediately on starting the network worker:\n2011-02-15 21:39:18,111 CRITICAL nova.root [-] f(ile) should be int, str, unicode or file, not <open GreenPipe '<fd:4>', mode 'wb' at 0x248db00>\n(nova.root): TRACE: Traceback (most recent call last):\n(nova.root): TRACE:   File \"bin/nova-network\", line 44, in <module>\n(nova.root): TRACE:     service.serve()\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/service.py\", line 231, in serve\n(nova.root): TRACE:     x.start()\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/service.py\", line 81, in start\n(nova.root): TRACE:     self.manager.init_host()\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/manager.py\", line 470, in init_host\n(nova.root): TRACE:     super(VlanManager, self).init_host()\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/manager.py\", line 124, in init_host\n(nova.root): TRACE:     self.driver.init_host()\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/linux_net.py\", line 118, in init_host\n(nova.root): TRACE:     check_exit_code=False)\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/linux_net.py\", line 383, in _execute\n(nova.root): TRACE:     return utils.execute(cmd, *args, **kwargs)\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/utils.py\", line 133, in execute\n(nova.root): TRACE:     stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)\n(nova.root): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/eventlet-0.9.14-py2.6.egg/eventlet/green/subprocess.py\", line 31, in __init__\n(nova.root): TRACE:     wrapped_pipe = greenio.GreenPipe(pipe, pipe.mode, bufsize)\n(nova.root): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/eventlet-0.9.14-py2.6.egg/eventlet/greenio.py\", line 386, in __init__\n(nova.root): TRACE:     raise TypeError('f(ile) should be int, str, unicode or file, not %r' % f)\n(nova.root): TRACE: TypeError: f(ile) should be int, str, unicode or file, not <open GreenPipe '<fd:4>', mode 'wb' at 0x248db00>\n(nova.root): TRACE: \n\nIt appears to have been introduced in rev 674.\n\nhttp://bazaar.launchpad.net/~hudson-openstack/nova/trunk/revision/674", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/719765", 
    "owner": "None", 
    "id": 719765, 
    "index": 2034, 
    "created": "2011-02-16 03:38:30.218777+00:00", 
    "title": "Network Worker crashes on start with Eventlet Error", 
    "comments": [
        {
            "content": "Running trunk of nova, I get this traceback immediately on starting the network worker:\n2011-02-15 21:39:18,111 CRITICAL nova.root [-] f(ile) should be int, str, unicode or file, not <open GreenPipe '<fd:4>', mode 'wb' at 0x248db00>\n(nova.root): TRACE: Traceback (most recent call last):\n(nova.root): TRACE:   File \"bin/nova-network\", line 44, in <module>\n(nova.root): TRACE:     service.serve()\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/service.py\", line 231, in serve\n(nova.root): TRACE:     x.start()\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/service.py\", line 81, in start\n(nova.root): TRACE:     self.manager.init_host()\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/manager.py\", line 470, in init_host\n(nova.root): TRACE:     super(VlanManager, self).init_host()\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/manager.py\", line 124, in init_host\n(nova.root): TRACE:     self.driver.init_host()\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/linux_net.py\", line 118, in init_host\n(nova.root): TRACE:     check_exit_code=False)\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/linux_net.py\", line 383, in _execute\n(nova.root): TRACE:     return utils.execute(cmd, *args, **kwargs)\n(nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/utils.py\", line 133, in execute\n(nova.root): TRACE:     stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)\n(nova.root): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/eventlet-0.9.14-py2.6.egg/eventlet/green/subprocess.py\", line 31, in __init__\n(nova.root): TRACE:     wrapped_pipe = greenio.GreenPipe(pipe, pipe.mode, bufsize)\n(nova.root): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/eventlet-0.9.14-py2.6.egg/eventlet/greenio.py\", line 386, in __init__\n(nova.root): TRACE:     raise TypeError('f(ile) should be int, str, unicode or file, not %r' % f)\n(nova.root): TRACE: TypeError: f(ile) should be int, str, unicode or file, not <open GreenPipe '<fd:4>', mode 'wb' at 0x248db00>\n(nova.root): TRACE: \n\nIt appears to have been introduced in rev 674.\n\nhttp://bazaar.launchpad.net/~hudson-openstack/nova/trunk/revision/674", 
            "date_created": "2011-02-16 03:38:30.218777+00:00", 
            "author": "https://api.launchpad.net/1.0/~antonym"
        }, 
        {
            "content": "You need the new eventlet package from the ppa\n\nOn Feb 15, 2011, at 7:38 PM, Antony Messerli wrote:\n\n> Public bug reported:\n> \n> Running trunk of nova, I get this traceback immediately on starting the network worker:\n> 2011-02-15 21:39:18,111 CRITICAL nova.root [-] f(ile) should be int, str, unicode or file, not <open GreenPipe '<fd:4>', mode 'wb' at 0x248db00>\n> (nova.root): TRACE: Traceback (most recent call last):\n> (nova.root): TRACE:   File \"bin/nova-network\", line 44, in <module>\n> (nova.root): TRACE:     service.serve()\n> (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/service.py\", line 231, in serve\n> (nova.root): TRACE:     x.start()\n> (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/service.py\", line 81, in start\n> (nova.root): TRACE:     self.manager.init_host()\n> (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/manager.py\", line 470, in init_host\n> (nova.root): TRACE:     super(VlanManager, self).init_host()\n> (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/manager.py\", line 124, in init_host\n> (nova.root): TRACE:     self.driver.init_host()\n> (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/linux_net.py\", line 118, in init_host\n> (nova.root): TRACE:     check_exit_code=False)\n> (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/linux_net.py\", line 383, in _execute\n> (nova.root): TRACE:     return utils.execute(cmd, *args, **kwargs)\n> (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/utils.py\", line 133, in execute\n> (nova.root): TRACE:     stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)\n> (nova.root): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/eventlet-0.9.14-py2.6.egg/eventlet/green/subprocess.py\", line 31, in __init__\n> (nova.root): TRACE:     wrapped_pipe = greenio.GreenPipe(pipe, pipe.mode, bufsize)\n> (nova.root): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/eventlet-0.9.14-py2.6.egg/eventlet/greenio.py\", line 386, in __init__\n> (nova.root): TRACE:     raise TypeError('f(ile) should be int, str, unicode or file, not %r' % f)\n> (nova.root): TRACE: TypeError: f(ile) should be int, str, unicode or file, not <open GreenPipe '<fd:4>', mode 'wb' at 0x248db00>\n> (nova.root): TRACE: \n> \n> It appears to have been introduced in rev 674.\n> \n> http://bazaar.launchpad.net/~hudson-openstack/nova/trunk/revision/674\n> \n> ** Affects: nova\n>     Importance: Undecided\n>         Status: New\n> \n> -- \n> You received this bug notification because you are a member of Nova Bug\n> Team, which is subscribed to OpenStack Compute (nova).\n> https://bugs.launchpad.net/bugs/719765\n> \n> Title:\n>  Network Worker crashes on start with Eventlet Error\n> \n> Status in OpenStack Compute (Nova):\n>  New\n> \n> Bug description:\n>  Running trunk of nova, I get this traceback immediately on starting the network worker:\n>  2011-02-15 21:39:18,111 CRITICAL nova.root [-] f(ile) should be int, str, unicode or file, not <open GreenPipe '<fd:4>', mode 'wb' at 0x248db00>\n>  (nova.root): TRACE: Traceback (most recent call last):\n>  (nova.root): TRACE:   File \"bin/nova-network\", line 44, in <module>\n>  (nova.root): TRACE:     service.serve()\n>  (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/service.py\", line 231, in serve\n>  (nova.root): TRACE:     x.start()\n>  (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/service.py\", line 81, in start\n>  (nova.root): TRACE:     self.manager.init_host()\n>  (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/manager.py\", line 470, in init_host\n>  (nova.root): TRACE:     super(VlanManager, self).init_host()\n>  (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/manager.py\", line 124, in init_host\n>  (nova.root): TRACE:     self.driver.init_host()\n>  (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/linux_net.py\", line 118, in init_host\n>  (nova.root): TRACE:     check_exit_code=False)\n>  (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/network/linux_net.py\", line 383, in _execute\n>  (nova.root): TRACE:     return utils.execute(cmd, *args, **kwargs)\n>  (nova.root): TRACE:   File \"/root/openstack/blah/nova/nova/utils.py\", line 133, in execute\n>  (nova.root): TRACE:     stdout=subprocess.PIPE, stderr=subprocess.PIPE, env=env)\n>  (nova.root): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/eventlet-0.9.14-py2.6.egg/eventlet/green/subprocess.py\", line 31, in __init__\n>  (nova.root): TRACE:     wrapped_pipe = greenio.GreenPipe(pipe, pipe.mode, bufsize)\n>  (nova.root): TRACE:   File \"/usr/local/lib/python2.6/dist-packages/eventlet-0.9.14-py2.6.egg/eventlet/greenio.py\", line 386, in __init__\n>  (nova.root): TRACE:     raise TypeError('f(ile) should be int, str, unicode or file, not %r' % f)\n>  (nova.root): TRACE: TypeError: f(ile) should be int, str, unicode or file, not <open GreenPipe '<fd:4>', mode 'wb' at 0x248db00>\n>  (nova.root): TRACE: \n> \n>  It appears to have been introduced in rev 674.\n> \n>  http://bazaar.launchpad.net/~hudson-openstack/nova/trunk/revision/674\n> \n> \n\n", 
            "date_created": "2011-02-16 04:36:40+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "I had this error as well.  The fix is:\n\nsudo apt-get update\nsudo apt-get install python-eventlet\nsudo service nova-network start\nps -ef | grep nova-network\nnova      3064     1  0 09:32 ?        00:00:00 su -c nova-network --flagfile=/etc/nova/nova.conf nova\nnova      3071  3064 12 09:32 ?        00:00:00 /usr/bin/python /usr/bin/nova-network --flagfile=/etc/nova/nova.conf\nroot      3140  3563  0 09:33 pts/0    00:00:00 grep --color=auto nova-network", 
            "date_created": "2011-02-16 14:34:51.878301+00:00", 
            "author": "https://api.launchpad.net/1.0/~kost-isi"
        }, 
        {
            "content": "for users of other distributions:\n\nyou have to apply this patch to python-eventlet:\n\nDescription: Prevent subprocess module from rewrapping GreenPipes\nAuthor: Soren Hansen <email address hidden>\nForwarded: https://bitbucket.org/which_linden/eventlet/issue/77/subprocess-module-fails-if-os-module-is\nLast-Update: 2011-02-14\n\n\nIndex: python-eventlet-0.9.14/eventlet/green/subprocess.py\n===================================================================\n--- python-eventlet-0.9.14.orig/eventlet/green/subprocess.py    2011-02-14 11:31:39.917609581 +0100\n+++ python-eventlet-0.9.14/eventlet/green/subprocess.py 2011-02-14 11:31:45.767618158 +0100\n@@ -27,7 +27,7 @@\n             # eventlet.processes.Process.run() method.\n             for attr in \"stdin\", \"stdout\", \"stderr\":\n                 pipe = getattr(self, attr)\n-                if pipe is not None:\n+                if pipe is not None and not type(pipe) == greenio.GreenPipe:\n                     wrapped_pipe = greenio.GreenPipe(pipe, pipe.mode, bufsize)\n                     setattr(self, attr, wrapped_pipe)\n         __init__.__doc__ = subprocess_orig.Popen.__init__.__doc__\n", 
            "date_created": "2011-02-20 15:17:02.652845+00:00", 
            "author": "https://api.launchpad.net/1.0/~berendt"
        }
    ]
}