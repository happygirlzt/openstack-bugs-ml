{
    "status": "Fix Released", 
    "last_updated": "2014-04-17 08:50:52.783309+00:00", 
    "description": "Nbd device is still connected after deleting a lxc Container. Operation details are list as following:\n\nubuntu@lxc-gq:~$ nova boot --image 8f30a356-f01c-4c91-b32f-4710a1e79b88 --flavor m1.small --key-name kp-lxc lxc3             \n+-------------------------------------+--------------------------------------+\n| Property                            | Value                                |\n+-------------------------------------+--------------------------------------+\n| OS-EXT-STS:task_state               | scheduling                           |\n| image                               | ubuntu-12.04-amd64-lxc               |\n| OS-EXT-STS:vm_state                 | building                             |\n| OS-EXT-SRV-ATTR:instance_name       | instance-0000003c                    |\n| OS-SRV-USG:launched_at              | None                                 |\n| flavor                              | m1.small                             |\n| id                                  | b52ab8f1-b270-4a01-929b-a3e0d7b17c22 |\n| security_groups                     | [{u'name': u'default'}]              |\n| user_id                             | fad1205006184105a3fc03d57f0230d2     |\n| OS-DCF:diskConfig                   | MANUAL                               |\n| accessIPv4                          |                                      |\n| accessIPv6                          |                                      |\n| progress                            | 0                                    |\n| OS-EXT-STS:power_state              | 0                                    |\n| OS-EXT-AZ:availability_zone         | nova                                 |\n| config_drive                        |                                      |\n| status                              | BUILD                                |\n| updated                             | 2013-07-23T01:44:00Z                 |\n| hostId                              |                                      |\n| OS-EXT-SRV-ATTR:host                | None                                 |\n| OS-SRV-USG:terminated_at            | None                                 |\n| key_name                            | kp-lxc                               |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | None                                 |\n| name                                | lxc3                                 |\n| adminPass                           | GeENhmP6qp93                         |\n| tenant_id                           | 6151530887f2468d8ad3808ca380740c     |\n| created                             | 2013-07-23T01:43:59Z                 |\n| metadata                            | {}                                   |\n+-------------------------------------+--------------------------------------+\n+-------------------------------------+--------------------------------------+\nubuntu@lxc-gq:~$ nova list\n+--------------------------------------+------+--------+------------+-------------+------------------+\n| ID                                   | Name | Status | Task State | Power State | Networks         |\n+--------------------------------------+------+--------+------------+-------------+------------------+\n| b52ab8f1-b270-4a01-929b-a3e0d7b17c22 | lxc3 | BUILD  | spawning   | NOSTATE     | private=10.0.0.2 |\n+--------------------------------------+------+--------+------------+-------------+------------------+\nubuntu@lxc-gq:~$ nova list\n+--------------------------------------+------+--------+------------+-------------+------------------+\n| ID                                   | Name | Status | Task State | Power State | Networks         |\n+--------------------------------------+------+--------+------------+-------------+------------------+\n| b52ab8f1-b270-4a01-929b-a3e0d7b17c22 | lxc3 | ACTIVE | None       | Running     | private=10.0.0.2 |\n+--------------------------------------+------+--------+------------+-------------+------------------+\nubuntu@lxc-gq:~$ ps -ef|grep qemu-nbd\nroot     16595     1  6 01:44 ?        00:00:00 qemu-nbd -c /dev/nbd11 /opt/stack/data/nova/instances/b52ab8f1-b270-4a01-929b-a3e0d7b17c22/disk\nubuntu   19480 16062  0 01:44 pts/0    00:00:00 grep --color=auto qemu-nbd\nubuntu@lxc-gq:~$ nova delete lxc3\nubuntu@lxc-gq:~$ nova list\n+----+------+--------+------------+-------------+----------+\n| ID | Name | Status | Task State | Power State | Networks |\n+----+------+--------+------------+-------------+----------+\n+----+------+--------+------------+-------------+----------+\nubuntu@lxc-gq:~$ ps -ef|grep qemu-nbd\nroot     16595     1  2 01:44 ?        00:00:01 qemu-nbd -c /dev/nbd11 /opt/stack/data/nova/instances/b52ab8f1-b270-4a01-929b-a3e0d7b17c22/disk\nubuntu   19833 16062  0 01:44 pts/0    00:00:00 grep --color=auto qemu-nbd", 
    "tags": [
        "libvirt"
    ], 
    "importance": "Undecided", 
    "heat": 12, 
    "link": "https://bugs.launchpad.net/nova/+bug/1203927", 
    "owner": "https://api.launchpad.net/1.0/~hzguanqiang", 
    "id": 1203927, 
    "index": 3869, 
    "created": "2013-07-23 01:48:13.022352+00:00", 
    "title": "Nbd device is still connected after deleting a lxc Container", 
    "comments": [
        {
            "content": "Nbd device is still connected after deleting a lxc Container. Operation details are list as following:\n\nubuntu@lxc-gq:~$ nova boot --image 8f30a356-f01c-4c91-b32f-4710a1e79b88 --flavor m1.small --key-name kp-lxc lxc3             \n+-------------------------------------+--------------------------------------+\n| Property                            | Value                                |\n+-------------------------------------+--------------------------------------+\n| OS-EXT-STS:task_state               | scheduling                           |\n| image                               | ubuntu-12.04-amd64-lxc               |\n| OS-EXT-STS:vm_state                 | building                             |\n| OS-EXT-SRV-ATTR:instance_name       | instance-0000003c                    |\n| OS-SRV-USG:launched_at              | None                                 |\n| flavor                              | m1.small                             |\n| id                                  | b52ab8f1-b270-4a01-929b-a3e0d7b17c22 |\n| security_groups                     | [{u'name': u'default'}]              |\n| user_id                             | fad1205006184105a3fc03d57f0230d2     |\n| OS-DCF:diskConfig                   | MANUAL                               |\n| accessIPv4                          |                                      |\n| accessIPv6                          |                                      |\n| progress                            | 0                                    |\n| OS-EXT-STS:power_state              | 0                                    |\n| OS-EXT-AZ:availability_zone         | nova                                 |\n| config_drive                        |                                      |\n| status                              | BUILD                                |\n| updated                             | 2013-07-23T01:44:00Z                 |\n| hostId                              |                                      |\n| OS-EXT-SRV-ATTR:host                | None                                 |\n| OS-SRV-USG:terminated_at            | None                                 |\n| key_name                            | kp-lxc                               |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | None                                 |\n| name                                | lxc3                                 |\n| adminPass                           | GeENhmP6qp93                         |\n| tenant_id                           | 6151530887f2468d8ad3808ca380740c     |\n| created                             | 2013-07-23T01:43:59Z                 |\n| metadata                            | {}                                   |\n+-------------------------------------+--------------------------------------+\n+-------------------------------------+--------------------------------------+\nubuntu@lxc-gq:~$ nova list\n+--------------------------------------+------+--------+------------+-------------+------------------+\n| ID                                   | Name | Status | Task State | Power State | Networks         |\n+--------------------------------------+------+--------+------------+-------------+------------------+\n| b52ab8f1-b270-4a01-929b-a3e0d7b17c22 | lxc3 | BUILD  | spawning   | NOSTATE     | private=10.0.0.2 |\n+--------------------------------------+------+--------+------------+-------------+------------------+\nubuntu@lxc-gq:~$ nova list\n+--------------------------------------+------+--------+------------+-------------+------------------+\n| ID                                   | Name | Status | Task State | Power State | Networks         |\n+--------------------------------------+------+--------+------------+-------------+------------------+\n| b52ab8f1-b270-4a01-929b-a3e0d7b17c22 | lxc3 | ACTIVE | None       | Running     | private=10.0.0.2 |\n+--------------------------------------+------+--------+------------+-------------+------------------+\nubuntu@lxc-gq:~$ ps -ef|grep qemu-nbd\nroot     16595     1  6 01:44 ?        00:00:00 qemu-nbd -c /dev/nbd11 /opt/stack/data/nova/instances/b52ab8f1-b270-4a01-929b-a3e0d7b17c22/disk\nubuntu   19480 16062  0 01:44 pts/0    00:00:00 grep --color=auto qemu-nbd\nubuntu@lxc-gq:~$ nova delete lxc3\nubuntu@lxc-gq:~$ nova list\n+----+------+--------+------------+-------------+----------+\n| ID | Name | Status | Task State | Power State | Networks |\n+----+------+--------+------------+-------------+----------+\n+----+------+--------+------------+-------------+----------+\nubuntu@lxc-gq:~$ ps -ef|grep qemu-nbd\nroot     16595     1  2 01:44 ?        00:00:01 qemu-nbd -c /dev/nbd11 /opt/stack/data/nova/instances/b52ab8f1-b270-4a01-929b-a3e0d7b17c22/disk\nubuntu   19833 16062  0 01:44 pts/0    00:00:00 grep --color=auto qemu-nbd", 
            "date_created": "2013-07-23 01:48:13.022352+00:00", 
            "author": "https://api.launchpad.net/1.0/~hzguanqiang"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/41891", 
            "date_created": "2013-08-14 10:57:48.673056+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/41891\nCommitted: http://github.com/openstack/nova/commit/6277f8aa9af4785170c7d750682093992320e785\nSubmitter: Jenkins\nBranch:    master\n\ncommit 6277f8aa9af4785170c7d750682093992320e785\nAuthor: hzguanqiang <email address hidden>\nDate:   Wed Aug 14 18:56:06 2013 +0800\n\n    Fix root disk not be detached after deleting lxc container\n    \n    Add teardown_container action when cleanup lxc instance to make\n    sure root disk be detached and no resource leak.\n    \n    Fixes: bug #1208387\n           bug #1203927\n    \n    Change-Id: I063fd3a9856bba089bcde5cdefd2576e2eb2b0e9\n", 
            "date_created": "2013-10-15 19:44:15.572324+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}