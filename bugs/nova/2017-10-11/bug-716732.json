{
    "status": "Fix Released", 
    "last_updated": "2011-04-15 08:33:39.315978+00:00", 
    "description": "When describing instances the following stack occurs:\n\n2011-02-10 22:04:07,814 ERROR nova.api [OSE5QAE9DVBA9BDUDBPY user user] Unexpected error raised: Parent instance <FixedIp at 0x2ec4510> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed\n(nova.api): TRACE: Traceback (most recent call last):\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/api/ec2/__init__.py\", line 317, in __call__\n(nova.api): TRACE:     result = api_request.invoke(context)\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/api/ec2/apirequest.py\", line 128, in invoke(nova.api): TRACE:     result = method(context, **args)(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/api/ec2/cloud.py\", line 642, in describe_instances(nova.api): TRACE:     return self._format_describe_instances(context, **kwargs)(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/api/ec2/cloud.py\", line 649, in _format_describe_instances\n(nova.api): TRACE:     return {'reservationSet': self._format_instances(context, **kwargs)}\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/api/ec2/cloud.py\", line 690, in _format_instances\n(nova.api): TRACE:     floating_addr = fixed['floating_ips'][0]['address']\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/db/sqlalchemy/models.py\", line 74, in __getitem__\n(nova.api): TRACE:     return getattr(self, key)\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/SQLAlchemy-0.6.6-py2.6.egg/sqlalchemy/orm/attributes.py\", line 168, in __get__\n(nova.api): TRACE:     instance_dict(instance))\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/SQLAlchemy-0.6.6-py2.6.egg/sqlalchemy/orm/attributes.py\", line 388, in get\n(nova.api): TRACE:     value = callable_(passive=passive)\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/SQLAlchemy-0.6.6-py2.6.egg/sqlalchemy/orm/strategies.py\", line 599, in __call__\n(nova.api): TRACE:     (mapperutil.state_str(state), self.key)\n(nova.api): TRACE: DetachedInstanceError: Parent instance <FixedIp at 0x2ec4510> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed\n(nova.api): TRACE: \n2011-02-10 22:04:07,816 ERROR nova.api [OSE5QAE9DVBA9BDUDBPY user user] Environment: {\"HTTP_ACCEPT\": \"*/*\", \"CONTENT_TYPE\": \"application/x-www-form-urlencoded\", \"SCRIPT_NAME\": \"/services/Cloud\", \"REQUEST_METHOD\": \"POST\", \"HTTP_HOST\": \"10.1.170.32:8773\", \"PATH_INFO\": \"\", \"SERVER_PROTOCOL\": \"HTTP/1.0\", \"CONTENT_LENGTH\": \"-1\", \"HTTP_CONNECTION\": \"close\", \"SERVER_NAME\": \"10.1.170.32\", \"REMOTE_ADDR\": \"10.46.200.84\", \"wsgi.url_scheme\": \"http\", \"SERVER_PORT\": \"8773\", \"GATEWAY_INTERFACE\": \"CGI/1.1\"}\n2011-02-10 22:04:07,816 ERROR nova.api [OSE5QAE9DVBA9BDUDBPY user user] Environment: {\"HTTP_ACCEPT\": \"*/*\", \"CONTENT_TYPE\": \"application/x-www-form-urlencoded\", \"SCRIPT_NAME\": \"/services/Cloud\", \"REQUEST_METHOD\": \"POST\", \"HTTP_HOST\": \"10.1.170.32:8773\", \"PATH_INFO\": \"\", \"SERVER_PROTOCOL\": \"HTTP/1.0\", \"CONTENT_LENGTH\": \"-1\", \"HTTP_CONNECTION\": \"close\", \"SERVER_NAME\": \"10.1.170.32\", \"REMOTE_ADDR\": \"10.46.200.84\", \"wsgi.url_scheme\": \"http\", \"SERVER_PORT\": \"8773\", \"GATEWAY_INTERFACE\": \"CGI/1.1\"}\n2011-02-10 22:04:07,817 ERROR nova.api [OSE5QAE9DVBA9BDUDBPY user user] UnknownError: An unknown error has occurred. Please try your request again.\n2011-02-10 22:04:07,817 ERROR nova.api [OSE5QAE9DVBA9BDUDBPY user user] UnknownError: An unknown error has occurred. Please try your request again.\n2011-02-10 22:04:07,817 INFO nova.api [OSE5QAE9DVBA9BDUDBPY user user] 0.220182s 10.46.200.84 POST  None:None 400 [None] application/x-www-form-urlencoded text/xml\n2011-02-10 22:04:07,817 INFO nova.api [OSE5QAE9DVBA9BDUDBPY user user] 0.220182s 10.46.200.84 POST  None:None 400 [None] application/x-www-form-urlencoded text/xml\n\nIt only seems to happen with around 7 or more instances running per project, and happens much more frequently with users who do not have is_admin = 1.\n\nVishy provided the following patch, which appears to fix the issue:\n\nhttp://pastie.org/1550608", 
    "tags": [], 
    "importance": "High", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/716732", 
    "owner": "https://api.launchpad.net/1.0/~vishvananda", 
    "id": 716732, 
    "index": 354, 
    "created": "2011-02-10 22:23:40.148525+00:00", 
    "title": "API returns UnknownError: An unknown error has occurred. Please try your request again. when describing instances", 
    "comments": [
        {
            "content": "When describing instances the following stack occurs:\n\n2011-02-10 22:04:07,814 ERROR nova.api [OSE5QAE9DVBA9BDUDBPY user user] Unexpected error raised: Parent instance <FixedIp at 0x2ec4510> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed\n(nova.api): TRACE: Traceback (most recent call last):\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/api/ec2/__init__.py\", line 317, in __call__\n(nova.api): TRACE:     result = api_request.invoke(context)\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/api/ec2/apirequest.py\", line 128, in invoke(nova.api): TRACE:     result = method(context, **args)(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/api/ec2/cloud.py\", line 642, in describe_instances(nova.api): TRACE:     return self._format_describe_instances(context, **kwargs)(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/api/ec2/cloud.py\", line 649, in _format_describe_instances\n(nova.api): TRACE:     return {'reservationSet': self._format_instances(context, **kwargs)}\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/api/ec2/cloud.py\", line 690, in _format_instances\n(nova.api): TRACE:     floating_addr = fixed['floating_ips'][0]['address']\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/nova-2011.1-py2.6.egg/nova/db/sqlalchemy/models.py\", line 74, in __getitem__\n(nova.api): TRACE:     return getattr(self, key)\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/SQLAlchemy-0.6.6-py2.6.egg/sqlalchemy/orm/attributes.py\", line 168, in __get__\n(nova.api): TRACE:     instance_dict(instance))\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/SQLAlchemy-0.6.6-py2.6.egg/sqlalchemy/orm/attributes.py\", line 388, in get\n(nova.api): TRACE:     value = callable_(passive=passive)\n(nova.api): TRACE:   File \"/usr/lib/python2.6/site-packages/SQLAlchemy-0.6.6-py2.6.egg/sqlalchemy/orm/strategies.py\", line 599, in __call__\n(nova.api): TRACE:     (mapperutil.state_str(state), self.key)\n(nova.api): TRACE: DetachedInstanceError: Parent instance <FixedIp at 0x2ec4510> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed\n(nova.api): TRACE: \n2011-02-10 22:04:07,816 ERROR nova.api [OSE5QAE9DVBA9BDUDBPY user user] Environment: {\"HTTP_ACCEPT\": \"*/*\", \"CONTENT_TYPE\": \"application/x-www-form-urlencoded\", \"SCRIPT_NAME\": \"/services/Cloud\", \"REQUEST_METHOD\": \"POST\", \"HTTP_HOST\": \"10.1.170.32:8773\", \"PATH_INFO\": \"\", \"SERVER_PROTOCOL\": \"HTTP/1.0\", \"CONTENT_LENGTH\": \"-1\", \"HTTP_CONNECTION\": \"close\", \"SERVER_NAME\": \"10.1.170.32\", \"REMOTE_ADDR\": \"10.46.200.84\", \"wsgi.url_scheme\": \"http\", \"SERVER_PORT\": \"8773\", \"GATEWAY_INTERFACE\": \"CGI/1.1\"}\n2011-02-10 22:04:07,816 ERROR nova.api [OSE5QAE9DVBA9BDUDBPY user user] Environment: {\"HTTP_ACCEPT\": \"*/*\", \"CONTENT_TYPE\": \"application/x-www-form-urlencoded\", \"SCRIPT_NAME\": \"/services/Cloud\", \"REQUEST_METHOD\": \"POST\", \"HTTP_HOST\": \"10.1.170.32:8773\", \"PATH_INFO\": \"\", \"SERVER_PROTOCOL\": \"HTTP/1.0\", \"CONTENT_LENGTH\": \"-1\", \"HTTP_CONNECTION\": \"close\", \"SERVER_NAME\": \"10.1.170.32\", \"REMOTE_ADDR\": \"10.46.200.84\", \"wsgi.url_scheme\": \"http\", \"SERVER_PORT\": \"8773\", \"GATEWAY_INTERFACE\": \"CGI/1.1\"}\n2011-02-10 22:04:07,817 ERROR nova.api [OSE5QAE9DVBA9BDUDBPY user user] UnknownError: An unknown error has occurred. Please try your request again.\n2011-02-10 22:04:07,817 ERROR nova.api [OSE5QAE9DVBA9BDUDBPY user user] UnknownError: An unknown error has occurred. Please try your request again.\n2011-02-10 22:04:07,817 INFO nova.api [OSE5QAE9DVBA9BDUDBPY user user] 0.220182s 10.46.200.84 POST  None:None 400 [None] application/x-www-form-urlencoded text/xml\n2011-02-10 22:04:07,817 INFO nova.api [OSE5QAE9DVBA9BDUDBPY user user] 0.220182s 10.46.200.84 POST  None:None 400 [None] application/x-www-form-urlencoded text/xml\n\nIt only seems to happen with around 7 or more instances running per project, and happens much more frequently with users who do not have is_admin = 1.\n\nVishy provided the following patch, which appears to fix the issue:\n\nhttp://pastie.org/1550608", 
            "date_created": "2011-02-10 22:23:40.148525+00:00", 
            "author": "https://api.launchpad.net/1.0/~kbringard"
        }
    ]
}