{
    "status": "Invalid", 
    "last_updated": "2016-06-02 16:54:47.692126+00:00", 
    "description": "Description\n===========\nThe certificate/key defined in the nova.conf seem to have no apparent effect when starting the openstack-nova-novncproxy.  This results in the inability to access the vnc console securely\n\nExpected result\n===============\nVNC console assessable via secure vnc url\n\nActual result\n=============\nVNC Fails to establish connection\n\nEnvironment\n===========\nCentOS Linux release 7.2.1511 (Core)\nLinux 3.10.0-327.18.2.el7.x86_64 #1 SMP Thu May 12 11:03:55 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n\nPackage Versions:\nopenstack-nova-common-2015.1.2-1.el7.noarch\nopenstack-nova-console-2015.1.2-1.el7.noarch\nopenstack-nova-conductor-2015.1.2-1.el7.noarch\nopenstack-nova-scheduler-2015.1.2-1.el7.noarch\nopenstack-nova-api-2015.1.2-1.el7.noarch\nopenstack-nova-novncproxy-2015.1.2-1.el7.noarch\nopenstack-nova-cert-2015.1.2-1.el7.noarch\n\nSteps to reproduce\n==================\n\nController\nnovncproxy_host=0.0.0.0\nnovncproxy_port=6080\nnovncproxy_base_url=https://fqdn:6080/vnc_auto.html\nvnc_enabled=true\ncert=cert.crt\nkey=key.key\nssl_only=true\n\nCompute\nvnc_enabled = True\nvncserver_listen = 0.0.0.0\nvncserver_proxyclient_address = computeIP\nnovncproxy_base_url = https://controller-fqdn:6080/vnc_auto.htm\nssl_only=true\ncert=cert.crt\nkey=key.key\n\nTests functionality and certificate\n===================================\n\ncurl -vvv https://fqdn-controller:6080\n* Rebuilt URL to: https://fqdn-controller:6080/\n*   Trying xxx.xxx.xxx.xxx...\n* Connected to fqdn-controller (xxx.xxx.xxx.xxx) port 6080 (#0)\n* Server aborted the SSL handshake\n* Closing connection 0\ncurl: (35) Server aborted the SSL handshake\n\nopenssl s_client -connect fqdn-controller:6080 -state -debug\nCONNECTED(00000003)\nSSL_connect:before/connect initialization\nwrite to 0x7fde23500600 [0x7fde24004200] (130 bytes => 130 (0x82))\n0000 - 80 80 01 03 01 00 57 00-00 00 20 00 00 39 00 00   ......W... ..9..\n0010 - 38 00 00 35 00 00 16 00-00 13 00 00 0a 07 00 c0   8..5............\n0020 - 00 00 33 00 00 32 00 00-2f 00 00 9a 00 00 99 00   ..3..2../.......\n0030 - 00 96 03 00 80 00 00 05-00 00 04 01 00 80 00 00   ................\n0040 - 15 00 00 12 00 00 09 06-00 40 00 00 14 00 00 11   .........@......\n0050 - 00 00 08 00 00 06 04 00-80 00 00 03 02 00 80 00   ................\n0060 - 00 ff fd 8a ba 76 60 37-10 91 c0 c3 00 3d 40 67   .....v`7.....=@g\n0070 - 74 a3 b4 df 18 9c f8 c3-90 23 bb 2c 1a 88 35 f6   t........#.,..5.\n0080 - d0 cb                                             ..\nSSL_connect:SSLv2/v3 write client hello A\nread from 0x7fde23500600 [0x7fde24009800] (7 bytes => -1 (0xFFFFFFFFFFFFFFFF))\nSSL_connect:error in SSLv2/v3 read server hello A\nwrite:errno=54\n\nnetstat -tupln |grep 6080\ntcp        0      0 0.0.0.0:6080            0.0.0.0:*               LISTEN      20504/python\n\nACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            multiport dports 5900:5999,6080,6081,6082,7940,7937,8773,8774,8775 /* 101 accept all tcp nova */\n\nWorkaround to prove functionality and certificate\n=================================================\n\nWork Around to verify vnc, port and cert valid and functional:\nTest:\nopenstack-service stop openstack-nova-novncproxy\n/usr/bin/python /usr/bin/nova-novncproxy --cert cert.crt\n\nResults:\ncurl -vvv https://fqdn-controller:6080\n* Rebuilt URL to: https://fqdn-controller:6080/\n*   Trying xxx.xxx.xxx.xxx...\n* Connected to fqdn-controller (xxx.xxx.xxx.xxx) port 6080 (#0)\n* TLS 1.2 connection using TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\n* Server certificate: *.MyDogIsOnFire.com\n* Server certificate: MyDogIsOnFire SSL CA02\n* Server certificate: MyDogIsOnFire SSL Policy K1\n* Server certificate: MyDogIsOnFire Root CA K1\n> GET / HTTP/1.1\n> Host: fqdn-controller:6080\n> User-Agent: curl/7.43.0\n> Accept: */*\n>\n< HTTP/1.1 200 OK\n< Server: WebSockify Python/2.7.5\n< Date: Fri, 27 May 2016 03:42:12 GMT\n< Content-type: text/html\n< Content-Length: 9923\n< Last-Modified: Wed, 25 Feb 2015 20:38:54 GMT\n<\n<!DOCTYPE html>\n<html>\n<head>\n\n\u00a0\u00a0\u00a0\u00a0<!--\n\u00a0\u00a0\u00a0\u00a0noVNC example: simple example using default UI\n\u00a0\u00a0\u00a0\u00a0Copyright (C) 2012 Joel Martin\n\u00a0\u00a0\u00a0\u00a0Copyright (C) 2013 Samuel Mannehed for Cendio AB\n\u00a0\u00a0\u00a0\u00a0noVNC is licensed under the MPL 2.0 (see LICENSE.txt)\n\u00a0\u00a0\u00a0\u00a0This file is licensed under the 2-Clause BSD license (see LICENSE.txt).", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1586243", 
    "owner": "None", 
    "id": 1586243, 
    "index": 6240, 
    "created": "2016-05-27 03:50:58.236104+00:00", 
    "title": "Nova does not honor certificate settings for vncproxy", 
    "comments": [
        {
            "content": "Description\n===========\nThe certificate/key defined in the nova.conf seem to have no apparent effect when starting the openstack-nova-novncproxy.  This results in the inability to access the vnc console securly\n\n\nExpected result\n=============== \nVNC console assessable via secure vnc url\n\nActual result\n=============\nVNC Fails to establish connection\n\nEnvironment\n===========\nCentOS Linux release 7.2.1511 (Core)\nLinux 3.10.0-327.18.2.el7.x86_64 #1 SMP Thu May 12 11:03:55 UTC 2016 x86_64 x86_64 x86_64 GNU/Linux\n\nPackage Versions:\nopenstack-nova-common-2015.1.2-1.el7.noarch\nopenstack-nova-console-2015.1.2-1.el7.noarch\nopenstack-nova-conductor-2015.1.2-1.el7.noarch\nopenstack-nova-scheduler-2015.1.2-1.el7.noarch\nopenstack-nova-api-2015.1.2-1.el7.noarch\nopenstack-nova-novncproxy-2015.1.2-1.el7.noarch\nopenstack-nova-cert-2015.1.2-1.el7.noarch\n\nSteps to reproduce\n==================\n\nController\nnovncproxy_host=0.0.0.0\nnovncproxy_port=6080\nnovncproxy_base_url=https://fqdn:6080/vnc_auto.html\nvnc_enabled=true\ncert=cert.crt\nkey=key.key\nssl_only=true\n\n\nCompute\nvnc_enabled = False\nvncserver_listen = 0.0.0.0\nvncserver_proxyclient_address = computeIP\nnovncproxy_base_url = https://controller-fqdn:6080/vnc_auto.htm\nssl_only=true\ncert=cert.crt\nkey=key.key\n\n\nTests functionality and certificate\n===================================\n\ncurl -vvv https://fqdn-controller:6080\n* Rebuilt URL to: https://fqdn-controller:6080/\n*   Trying xxx.xxx.xxx.xxx...\n* Connected to fqdn-controller (xxx.xxx.xxx.xxx) port 6080 (#0)\n* Server aborted the SSL handshake\n* Closing connection 0\ncurl: (35) Server aborted the SSL handshake\n\nopenssl s_client -connect fqdn-controller:6080 -state -debug\nCONNECTED(00000003)\nSSL_connect:before/connect initialization\nwrite to 0x7fde23500600 [0x7fde24004200] (130 bytes => 130 (0x82))\n0000 - 80 80 01 03 01 00 57 00-00 00 20 00 00 39 00 00   ......W... ..9..\n0010 - 38 00 00 35 00 00 16 00-00 13 00 00 0a 07 00 c0   8..5............\n0020 - 00 00 33 00 00 32 00 00-2f 00 00 9a 00 00 99 00   ..3..2../.......\n0030 - 00 96 03 00 80 00 00 05-00 00 04 01 00 80 00 00   ................\n0040 - 15 00 00 12 00 00 09 06-00 40 00 00 14 00 00 11   .........@......\n0050 - 00 00 08 00 00 06 04 00-80 00 00 03 02 00 80 00   ................\n0060 - 00 ff fd 8a ba 76 60 37-10 91 c0 c3 00 3d 40 67   .....v`7.....=@g\n0070 - 74 a3 b4 df 18 9c f8 c3-90 23 bb 2c 1a 88 35 f6   t........#.,..5.\n0080 - d0 cb                                             ..\nSSL_connect:SSLv2/v3 write client hello A\nread from 0x7fde23500600 [0x7fde24009800] (7 bytes => -1 (0xFFFFFFFFFFFFFFFF))\nSSL_connect:error in SSLv2/v3 read server hello A\nwrite:errno=54\n\nnetstat -tupln |grep 6080\ntcp        0      0 0.0.0.0:6080            0.0.0.0:*               LISTEN      20504/python\n\nACCEPT     tcp  --  0.0.0.0/0            0.0.0.0/0            multiport dports 5900:5999,6080,6081,6082,7940,7937,8773,8774,8775 /* 101 accept all tcp nova */\n\n\n\n\n\n\nWorkaround to prove functionality and certificate\n=================================================\n\nWork Around to verify vnc, port and cert valid and functional:\nTest:\nopenstack-service stop openstack-nova-novncproxy\n/usr/bin/python /usr/bin/nova-novncproxy --cert cert.crt\n\nResults:\ncurl -vvv https://fqdn-controller:6080\n* Rebuilt URL to: https://fqdn-controller:6080/\n*   Trying xxx.xxx.xxx.xxx...\n* Connected to fqdn-controller (xxx.xxx.xxx.xxx) port 6080 (#0)\n* TLS 1.2 connection using TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384\n* Server certificate: *.MyDogIsOnFire.com\n* Server certificate: MyDogIsOnFire SSL CA02\n* Server certificate: MyDogIsOnFire SSL Policy K1\n* Server certificate: MyDogIsOnFire Root CA K1\n> GET / HTTP/1.1\n> Host: fqdn-controller:6080\n> User-Agent: curl/7.43.0\n> Accept: */*\n>\n< HTTP/1.1 200 OK\n< Server: WebSockify Python/2.7.5\n< Date: Fri, 27 May 2016 03:42:12 GMT\n< Content-type: text/html\n< Content-Length: 9923\n< Last-Modified: Wed, 25 Feb 2015 20:38:54 GMT\n<\n<!DOCTYPE html>\n<html>\n<head>\n\n    <!--\n    noVNC example: simple example using default UI\n    Copyright (C) 2012 Joel Martin\n    Copyright (C) 2013 Samuel Mannehed for Cendio AB\n    noVNC is licensed under the MPL 2.0 (see LICENSE.txt)\n    This file is licensed under the 2-Clause BSD license (see LICENSE.txt).", 
            "date_created": "2016-05-27 03:50:58.236104+00:00", 
            "author": "https://api.launchpad.net/1.0/~wasmum"
        }, 
        {
            "content": "This bug is reported against kilo, which is no longer supported in any format. If you can reproduce against upstream master, we can reopen and look into it. ", 
            "date_created": "2016-06-02 16:54:47.076804+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }
    ]
}