{
    "status": "Fix Released", 
    "last_updated": "2015-04-30 09:13:27.781318+00:00", 
    "description": "when attaching encrypted volume to the vm, the process is failed because import the encryptor class to raise an exception(Empty module name). But the exception info in the log file is not right. The log is like this:\n\n2014-10-22 21:40:39.089 ERROR nova.virt.libvirt.driver [req-92b203b3-bda6-4013-a946-c3760363b819 admin demo] [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d] Failed to attach volume at mountpoint: /dev/vdb\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d] Traceback (most recent call last):\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1380, in attach_volume\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]     encryption)\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1327, in _get_volume_encryptor\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]     **encryption)\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]   File \"/opt/stack/nova/nova/volume/encryptors/__init__.py\", line 44, in get_volume_encryptor\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]     provider=provider, exception=e)\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]   File \"/usr/lib/python2.7/logging/__init__.py\", line 1449, in error\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]     self.logger.error(msg, *args, **kwargs)\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]   File \"/usr/lib/python2.7/logging/__init__.py\", line 1178, in error\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]     self._log(ERROR, msg, args, **kwargs)\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d] TypeError: _log() got an unexpected keyword argument 'exception'\n\nThis error info is caused by wrong log printing in /opt/stack/nova/nova/volume/encryptors/__init__.py(line 44).", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1384531", 
    "owner": "https://api.launchpad.net/1.0/~wanghao749", 
    "id": 1384531, 
    "index": 5234, 
    "created": "2014-10-23 03:05:52.978978+00:00", 
    "title": "attach encrypted volume failed, exception info is not right", 
    "comments": [
        {
            "content": "when attaching encrypted volume to the vm, the process is failed because import the encryptor class to raise an exception(Empty module name). But the exception info in the log file is not right. The log is like this:\n\n2014-10-22 21:40:39.089 ERROR nova.virt.libvirt.driver [req-92b203b3-bda6-4013-a946-c3760363b819 admin demo] [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d] Failed to attach volume at mountpoint: /dev/vdb\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d] Traceback (most recent call last):\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1380, in attach_volume\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]     encryption)\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1327, in _get_volume_encryptor\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]     **encryption)\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]   File \"/opt/stack/nova/nova/volume/encryptors/__init__.py\", line 44, in get_volume_encryptor\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]     provider=provider, exception=e)\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]   File \"/usr/lib/python2.7/logging/__init__.py\", line 1449, in error\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]     self.logger.error(msg, *args, **kwargs)\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]   File \"/usr/lib/python2.7/logging/__init__.py\", line 1178, in error\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d]     self._log(ERROR, msg, args, **kwargs)\n2014-10-22 21:40:39.089 25617 TRACE nova.virt.libvirt.driver [instance: c2589f3a-3d20-44fc-bb37-88e65cb13b2d] TypeError: _log() got an unexpected keyword argument 'exception'\n\nThis error info is caused by wrong log printing in /opt/stack/nova/nova/volume/encryptors/__init__.py(line 44).", 
            "date_created": "2014-10-23 03:05:52.978978+00:00", 
            "author": "https://api.launchpad.net/1.0/~wanghao749"
        }, 
        {
            "content": "The fix code review: https://review.openstack.org/#/c/130423/", 
            "date_created": "2014-10-23 03:33:49.363248+00:00", 
            "author": "https://api.launchpad.net/1.0/~wanghao749"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/130423\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=6b7a9f71af34b6da884e5515c9c09a605c7d8f3c\nSubmitter: Jenkins\nBranch:    master\n\ncommit 6b7a9f71af34b6da884e5515c9c09a605c7d8f3c\nAuthor: wanghao <email address hidden>\nDate:   Thu Oct 23 11:15:36 2014 +0800\n\n    fix the error log print in encryptor __init__.py\n    \n    when attach an encrypted volume to vm, the error\n    log print is not right in encryptor __init__.py.\n    It will raise wrong exception info.\n    \n    This change will fix the log print using correct\n    format.\n    \n    Change-Id: Ibbe41e64ae6320efa53bdd97cdd5312457e65be7\n    Closes-bug: #1384531\n", 
            "date_created": "2014-10-28 11:45:05.309113+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}