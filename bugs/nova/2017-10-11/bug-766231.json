{
    "status": "Fix Released", 
    "last_updated": "2011-09-22 13:43:04.776398+00:00", 
    "description": "I'm running nova on SLES11SP1. \"run_tests.sh\" fails with a single error:\n\nOperationalError: (OperationalError) cannot commit transaction - SQL statements in progress None None\n\nIt fails in 014_add_instance_type_id_to_instances.py (upgrade method), when migrating the database schema:\n\ndef upgrade(migrate_engine):\n\u00a0\u00a0\u00a0\u00a0# Upgrade operations go here. Don't create your own engine;\n\u00a0\u00a0\u00a0\u00a0# bind migrate_engine to your metadata\n\u00a0\u00a0\u00a0\u00a0meta.bind = migrate_engine\n\n\u00a0\u00a0\u00a0\u00a0instances = Table('instances', meta, autoload=True,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0autoload_with=migrate_engine)\n\n\u00a0\u00a0\u00a0\u00a0instances.create_column(c_instance_type_id)\n\n\u00a0\u00a0\u00a0\u00a0recs = migrate_engine.execute(instance_types.select())\n\u00a0\u00a0\u00a0\u00a0for row in recs:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0type_id = row[0]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0type_name = row[1]\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0migrate_engine.execute(instances.update()\\\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0.where(instances.c.instance_type == type_name)\\\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0.values(instance_type_id=type_id))\n\n\u00a0\u00a0\u00a0\u00a0instances.c.instance_type.drop()\n\nI tracked the problem down to an issue with the version of sqlite3 that ships with SLES11SP1. The installed version is sqlite3 3.6.4. If I install 3.7.6.2 and point Python to the newer version of sqlite3, then the tests pass.\n\nDoes somebody with sqlite and sqlalchemy-migrate experience know if it's possible to implement a workaround in this code so this will work with sqlite3 3.6.4? Or will we need to install a newer version of sqlite3 on SUSE deployments?\n\nTested on nova revision 1003.\n\nFull output follows:\n\n./run_tests.sh -V\nERROR\n\n======================================================================\nERROR: <nose.suite.ContextSuite context=nova.tests>\n----------------------------------------------------------------------\nTraceback (most recent call last):\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/nose/suite.py\", line 208, in run\n\u00a0\u00a0\u00a0\u00a0self.setUp()\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/nose/suite.py\", line 291, in setUp\n\u00a0\u00a0\u00a0\u00a0self.setupContext(ancestor)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/nose/suite.py\", line 314, in setupContext\n\u00a0\u00a0\u00a0\u00a0try_run(context, names)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/nose/util.py\", line 478, in try_run\n\u00a0\u00a0\u00a0\u00a0return func()\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/nova/tests/__init__.py\", line 54, in setup\n\u00a0\u00a0\u00a0\u00a0migration.db_sync()\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/nova/db/migration.py\", line 33, in db_sync\n\u00a0\u00a0\u00a0\u00a0return IMPL.db_sync(version=version)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/nova/db/sqlalchemy/migration.py\", line 43, in db_sync\n\u00a0\u00a0\u00a0\u00a0return versioning_api.upgrade(FLAGS.sql_connection, repo_path, version)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/api.py\", line 186, in upgrade\n\u00a0\u00a0\u00a0\u00a0return _migrate(url, repository, version, upgrade=True, err=err, **opts)\n\u00a0\u00a0File \"<string>\", line 2, in _migrate\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py\", line 159, in with_engine\n\u00a0\u00a0\u00a0\u00a0return f(*a, **kw)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/api.py\", line 365, in _migrate\n\u00a0\u00a0\u00a0\u00a0schema.runchange(ver, change, changeset.step)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/schema.py\", line 84, in runchange\n\u00a0\u00a0\u00a0\u00a0change.run(self.engine, step)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/py.py\", line 145, in run\n\u00a0\u00a0\u00a0\u00a0script_func(engine)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py\", line 63, in upgrade\n\u00a0\u00a0\u00a0\u00a0.values(instance_type_id=type_id))\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1715, in execute\n\u00a0\u00a0\u00a0\u00a0return connection.execute(statement, *multiparams, **params)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1157, in execute\n\u00a0\u00a0\u00a0\u00a0params)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1237, in _execute_clauseelement\n\u00a0\u00a0\u00a0\u00a0return self.__execute_context(context)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1281, in __execute_context\n\u00a0\u00a0\u00a0\u00a0self._commit_impl()\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1081, in _commit_impl\n\u00a0\u00a0\u00a0\u00a0self._handle_dbapi_exception(e, None, None, None, None)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1078, in _commit_impl\n\u00a0\u00a0\u00a0\u00a0self.engine.dialect.do_commit(self.connection)\n\u00a0\u00a0File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/default.py\", line 264, in do_commit\n\u00a0\u00a0\u00a0\u00a0connection.commit()\nOperationalError: (OperationalError) cannot commit transaction - SQL statements in progress None None\n-------------------- >> begin captured logging << --------------------\n2011-04-19 12:09:44,547 DEBUG nova.utils [-] backend <module 'nova.db.sqlalchemy.migration' from '/home/vagrant/nova/trunk/nova/db/sqlalchemy/migration.pyc'> from (pid=11322) __get_backend /home/vagrant/nova/trunk/nova/utils.py:427\n2011-04-19 12:09:44,548 DEBUG migrate.versioning.util [-] Constructing engine from (pid=11322) construct_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:137\n2011-04-19 12:09:44,551 DEBUG migrate.versioning.repository [-] Loading repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:76\n2011-04-19 12:09:44,552 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,552 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,553 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,553 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,553 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,553 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,554 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,554 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,554 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,554 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,554 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,555 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,555 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,555 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,555 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,556 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,556 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,556 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,556 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,556 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,558 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,558 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,558 DEBUG migrate.versioning.repository [-] Repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:82\n2011-04-19 12:09:44,558 DEBUG migrate.versioning.repository [-] Config: {'db_settings': {'__name__': 'db_settings', 'required_dbs': '[]', 'version_table': 'migrate_version', 'repository_id': 'nova'}} from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:83\n2011-04-19 12:09:44,562 DEBUG migrate.versioning.util [-] Disposing SQLAlchemy engine Engine(sqlite:////home/vagrant/nova/trunk/nova/..//tests.sqlite) from (pid=11322) with_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:162\n2011-04-19 12:09:44,564 DEBUG migrate.versioning.util [-] Constructing engine from (pid=11322) construct_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:137\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.repository [-] Loading repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:76\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,566 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,566 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,566 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,567 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,567 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,567 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,567 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,568 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,568 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,568 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,568 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,568 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.repository [-] Repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:82\n2011-04-19 12:09:44,571 DEBUG migrate.versioning.repository [-] Config: {'db_settings': {'__name__': 'db_settings', 'required_dbs': '[]', 'version_table': 'migrate_version', 'repository_id': 'nova'}} from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:83\n2011-04-19 12:09:44,637 DEBUG migrate.versioning.util [-] Disposing SQLAlchemy engine Engine(sqlite:////home/vagrant/nova/trunk/nova/..//tests.sqlite) from (pid=11322) with_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:162\n2011-04-19 12:09:44,638 DEBUG migrate.versioning.util [-] Constructing engine from (pid=11322) construct_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:137\n2011-04-19 12:09:44,638 DEBUG migrate.versioning.repository [-] Loading repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:76\n2011-04-19 12:09:44,639 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,639 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,639 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,639 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,640 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,640 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,640 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,640 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,640 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,641 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,641 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,641 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,643 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,643 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,643 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,643 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,643 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.repository [-] Repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:82\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.repository [-] Config: {'db_settings': {'__name__': 'db_settings', 'required_dbs': '[]', 'version_table': 'migrate_version', 'repository_id': 'nova'}} from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:83\n2011-04-19 12:09:44,647 INFO migrate.versioning.api [-] 0 -> 1...\n2011-04-19 12:09:46,499 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:46,500 INFO migrate.versioning.api [-] 1 -> 2...\n2011-04-19 12:09:48,116 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,116 INFO migrate.versioning.api [-] 2 -> 3...\n2011-04-19 12:09:48,315 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,315 INFO migrate.versioning.api [-] 3 -> 4...\n2011-04-19 12:09:48,532 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,532 INFO migrate.versioning.api [-] 4 -> 5...\n2011-04-19 12:09:48,809 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,810 INFO migrate.versioning.api [-] 5 -> 6...\n2011-04-19 12:09:48,915 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,915 INFO migrate.versioning.api [-] 6 -> 7...\n2011-04-19 12:09:48,960 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,961 INFO migrate.versioning.api [-] 7 -> 8...\n2011-04-19 12:09:49,114 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,114 INFO migrate.versioning.api [-] 8 -> 9...\n2011-04-19 12:09:49,217 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,218 INFO migrate.versioning.api [-] 9 -> 10...\n2011-04-19 12:09:49,282 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,282 INFO migrate.versioning.api [-] 10 -> 11...\n2011-04-19 12:09:49,324 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,325 INFO migrate.versioning.api [-] 11 -> 12...\n2011-04-19 12:09:49,732 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,732 INFO migrate.versioning.api [-] 12 -> 13...\n2011-04-19 12:09:49,825 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,825 INFO migrate.versioning.api [-] 13 -> 14...\n2011-04-19 12:09:49,869 DEBUG migrate.versioning.util [-] Disposing SQLAlchemy engine Engine(sqlite:////home/vagrant/nova/trunk/nova/..//tests.sqlite) from (pid=11322) with_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:162\n--------------------- >> end captured logging << ---------------------\n\n----------------------------------------------------------------------\nRan 0 tests in 5.414s\n\nFAILED (errors=1)", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/766231", 
    "owner": "https://api.launchpad.net/1.0/~dan-prince", 
    "id": 766231, 
    "index": 2123, 
    "created": "2011-04-19 16:23:08.774723+00:00", 
    "title": "Database migration fails when running on sqlite3 3.6.4", 
    "comments": [
        {
            "content": "I'm running nova on SLES11SP1. \"run_tests.sh\" fails with a single error: \n\nOperationalError: (OperationalError) cannot commit transaction - SQL statements in progress None None\n\nIt fails in 014_add_instance_type_id_to_instances.py (upgrade method), when migrating the database schema:\n\ndef upgrade(migrate_engine):\n    # Upgrade operations go here. Don't create your own engine;\n    # bind migrate_engine to your metadata\n    meta.bind = migrate_engine\n\n    instances = Table('instances', meta, autoload=True,\n                      autoload_with=migrate_engine)\n\n    instances.create_column(c_instance_type_id)\n\n    recs = migrate_engine.execute(instance_types.select())\n    for row in recs:\n        type_id = row[0]\n        type_name = row[1]\n        migrate_engine.execute(instances.update()\\\n            .where(instances.c.instance_type == type_name)\\\n            .values(instance_type_id=type_id))\n\n    instances.c.instance_type.drop()\n\n\nI tracked the problem down to an issue with the version of sqlite3 that ships with SLES11SP1. The installed version is sqlite3 3.6.4. If I install 3.7.6.2 and point Python to the newer version of sqlite3, then the tests pass. \n\nDoes somebody with sqlite and sqlalchemy-migrate experience know if if it's possible to implement a workaround in this code so it works with sqlite3 3.6.4? \n\n\nTested on nova revision 1003. \n\nFull output follows:\n\n./run_tests.sh -V\nERROR\n\n======================================================================\nERROR: <nose.suite.ContextSuite context=nova.tests>\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/nose/suite.py\", line 208, in run\n    self.setUp()\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/nose/suite.py\", line 291, in setUp\n    self.setupContext(ancestor)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/nose/suite.py\", line 314, in setupContext\n    try_run(context, names)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/nose/util.py\", line 478, in try_run\n    return func()\n  File \"/home/vagrant/nova/trunk/nova/tests/__init__.py\", line 54, in setup\n    migration.db_sync()\n  File \"/home/vagrant/nova/trunk/nova/db/migration.py\", line 33, in db_sync\n    return IMPL.db_sync(version=version)\n  File \"/home/vagrant/nova/trunk/nova/db/sqlalchemy/migration.py\", line 43, in db_sync\n    return versioning_api.upgrade(FLAGS.sql_connection, repo_path, version)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/api.py\", line 186, in upgrade\n    return _migrate(url, repository, version, upgrade=True, err=err, **opts)\n  File \"<string>\", line 2, in _migrate\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py\", line 159, in with_engine\n    return f(*a, **kw)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/api.py\", line 365, in _migrate\n    schema.runchange(ver, change, changeset.step)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/schema.py\", line 84, in runchange\n    change.run(self.engine, step)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/py.py\", line 145, in run\n    script_func(engine)\n  File \"/home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py\", line 63, in upgrade\n    .values(instance_type_id=type_id))\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1715, in execute\n    return connection.execute(statement, *multiparams, **params)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1157, in execute\n    params)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1237, in _execute_clauseelement\n    return self.__execute_context(context)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1281, in __execute_context\n    self._commit_impl()\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1081, in _commit_impl\n    self._handle_dbapi_exception(e, None, None, None, None)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/base.py\", line 1078, in _commit_impl\n    self.engine.dialect.do_commit(self.connection)\n  File \"/home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/sqlalchemy/engine/default.py\", line 264, in do_commit\n    connection.commit()\nOperationalError: (OperationalError) cannot commit transaction - SQL statements in progress None None\n-------------------- >> begin captured logging << --------------------\n2011-04-19 12:09:44,547 DEBUG nova.utils [-] backend <module 'nova.db.sqlalchemy.migration' from '/home/vagrant/nova/trunk/nova/db/sqlalchemy/migration.pyc'> from (pid=11322) __get_backend /home/vagrant/nova/trunk/nova/utils.py:427\n2011-04-19 12:09:44,548 DEBUG migrate.versioning.util [-] Constructing engine from (pid=11322) construct_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:137\n2011-04-19 12:09:44,551 DEBUG migrate.versioning.repository [-] Loading repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:76\n2011-04-19 12:09:44,552 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,552 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,553 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,553 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,553 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,553 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,554 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,554 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,554 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,554 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,554 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,555 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,555 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,555 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,555 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,556 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,556 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,556 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,556 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,556 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,557 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,558 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,558 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,558 DEBUG migrate.versioning.repository [-] Repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:82\n2011-04-19 12:09:44,558 DEBUG migrate.versioning.repository [-] Config: {'db_settings': {'__name__': 'db_settings', 'required_dbs': '[]', 'version_table': 'migrate_version', 'repository_id': 'nova'}} from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:83\n2011-04-19 12:09:44,562 DEBUG migrate.versioning.util [-] Disposing SQLAlchemy engine Engine(sqlite:////home/vagrant/nova/trunk/nova/..//tests.sqlite) from (pid=11322) with_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:162\n2011-04-19 12:09:44,564 DEBUG migrate.versioning.util [-] Constructing engine from (pid=11322) construct_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:137\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.repository [-] Loading repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:76\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,565 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,566 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,566 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,566 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,567 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,567 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,567 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,567 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,568 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,568 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,568 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,568 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,568 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,569 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,570 DEBUG migrate.versioning.repository [-] Repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:82\n2011-04-19 12:09:44,571 DEBUG migrate.versioning.repository [-] Config: {'db_settings': {'__name__': 'db_settings', 'required_dbs': '[]', 'version_table': 'migrate_version', 'repository_id': 'nova'}} from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:83\n2011-04-19 12:09:44,637 DEBUG migrate.versioning.util [-] Disposing SQLAlchemy engine Engine(sqlite:////home/vagrant/nova/trunk/nova/..//tests.sqlite) from (pid=11322) with_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:162\n2011-04-19 12:09:44,638 DEBUG migrate.versioning.util [-] Constructing engine from (pid=11322) construct_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:137\n2011-04-19 12:09:44,638 DEBUG migrate.versioning.repository [-] Loading repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:76\n2011-04-19 12:09:44,639 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,639 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/001_austin.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,639 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,639 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/002_bexar.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,640 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,640 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/003_add_label_to_networks.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,640 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,640 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/004_add_zone_tables.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,640 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,641 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/005_add_instance_metadata.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,641 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,641 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/006_add_provider_data_to_volumes.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/007_add_ipv6_to_fixed_ips.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/008_add_instance_types.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,642 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/009_add_instance_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,643 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,643 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/010_add_os_type_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,643 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,643 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/011_live_migration.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,643 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/012_add_ipv6_flatmanager.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/013_add_flavors_to_migrations.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.script.base [-] Loading script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py... from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:27\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.script.base [-] Script /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo/versions/014_add_instance_type_id_to_instances.py loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/script/base.py:30\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.repository [-] Repository /home/vagrant/nova/trunk/nova/db/sqlalchemy/migrate_repo loaded successfully from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:82\n2011-04-19 12:09:44,644 DEBUG migrate.versioning.repository [-] Config: {'db_settings': {'__name__': 'db_settings', 'required_dbs': '[]', 'version_table': 'migrate_version', 'repository_id': 'nova'}} from (pid=11322) __init__ /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/repository.py:83\n2011-04-19 12:09:44,647 INFO migrate.versioning.api [-] 0 -> 1... \n2011-04-19 12:09:46,499 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:46,500 INFO migrate.versioning.api [-] 1 -> 2... \n2011-04-19 12:09:48,116 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,116 INFO migrate.versioning.api [-] 2 -> 3... \n2011-04-19 12:09:48,315 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,315 INFO migrate.versioning.api [-] 3 -> 4... \n2011-04-19 12:09:48,532 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,532 INFO migrate.versioning.api [-] 4 -> 5... \n2011-04-19 12:09:48,809 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,810 INFO migrate.versioning.api [-] 5 -> 6... \n2011-04-19 12:09:48,915 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,915 INFO migrate.versioning.api [-] 6 -> 7... \n2011-04-19 12:09:48,960 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:48,961 INFO migrate.versioning.api [-] 7 -> 8... \n2011-04-19 12:09:49,114 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,114 INFO migrate.versioning.api [-] 8 -> 9... \n2011-04-19 12:09:49,217 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,218 INFO migrate.versioning.api [-] 9 -> 10... \n2011-04-19 12:09:49,282 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,282 INFO migrate.versioning.api [-] 10 -> 11... \n2011-04-19 12:09:49,324 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,325 INFO migrate.versioning.api [-] 11 -> 12... \n2011-04-19 12:09:49,732 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,732 INFO migrate.versioning.api [-] 12 -> 13... \n2011-04-19 12:09:49,825 INFO migrate.versioning.api [-] done\n2011-04-19 12:09:49,825 INFO migrate.versioning.api [-] 13 -> 14... \n2011-04-19 12:09:49,869 DEBUG migrate.versioning.util [-] Disposing SQLAlchemy engine Engine(sqlite:////home/vagrant/nova/trunk/nova/..//tests.sqlite) from (pid=11322) with_engine /home/vagrant/nova/trunk/.nova-venv/lib64/python2.6/site-packages/migrate/versioning/util/__init__.py:162\n--------------------- >> end captured logging << ---------------------\n\n----------------------------------------------------------------------\nRan 0 tests in 5.414s\n\nFAILED (errors=1)", 
            "date_created": "2011-04-19 16:23:08.774723+00:00", 
            "author": "https://api.launchpad.net/1.0/~lorinh"
        }, 
        {
            "content": "Hi Loren,\n\nI think I see what was going on here. The migration had an open cursor open on a select to the instance_types table while it was also trying to update instances. I haven't heard about this causing problems with other databases however we should be able to support this specific Sqlite version as well.\n\nWould you mind trying the attached migration patch on SLES 11 SP1 box with Sqlite 3.6.4? It doesn't seem to break anything and should hopefully fix your issue.\n\nThanks,\n\nDan\n\n", 
            "date_created": "2011-04-19 18:53:14.078118+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }, 
        {
            "content": "Hi Dan:\n\nI'll give it a try.\n\nLorin", 
            "date_created": "2011-04-19 19:10:33.828581+00:00", 
            "author": "https://api.launchpad.net/1.0/~lorinh"
        }, 
        {
            "content": "Yup, that fixes the problem! Some of the tests are failing, but I think those are unrelated to this issue. ", 
            "date_created": "2011-04-19 19:24:22.286104+00:00", 
            "author": "https://api.launchpad.net/1.0/~lorinh"
        }
    ]
}