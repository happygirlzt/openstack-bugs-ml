{
    "status": "Fix Released", 
    "last_updated": "2017-07-07 14:36:58.848820+00:00", 
    "description": "This just started failing today:\n\nhttp://logs.openstack.org/18/417118/1/check/gate-nova-python27-db-ubuntu-xenial/0c0c8c1/console.html#_2017-01-05_17_52_16_199447\n\n2017-01-05 17:52:16.199447 | nova.tests.unit.test_cinder.CinderV1TestCase.test_cinderclient_unsupported_v1\n2017-01-05 17:52:16.199481 | -----------------------------------------------------------------------------\n2017-01-05 17:52:16.199488 | \n2017-01-05 17:52:16.199498 | Captured traceback:\n2017-01-05 17:52:16.199510 | ~~~~~~~~~~~~~~~~~~~\n2017-01-05 17:52:16.199525 |     Traceback (most recent call last):\n2017-01-05 17:52:16.199568 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/mock/mock.py\", line 1305, in patched\n2017-01-05 17:52:16.199585 |         return func(*args, **keywargs)\n2017-01-05 17:52:16.199612 |       File \"nova/tests/unit/test_cinder.py\", line 134, in test_cinderclient_unsupported_v1\n2017-01-05 17:52:16.199627 |         cinder.cinderclient, ctxt)\n2017-01-05 17:52:16.199684 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 485, in assertRaises\n2017-01-05 17:52:16.199701 |         self.assertThat(our_callable, matcher)\n2017-01-05 17:52:16.199768 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 496, in assertThat\n2017-01-05 17:52:16.199794 |         mismatch_error = self._matchHelper(matchee, matcher, message, verbose)\n2017-01-05 17:52:16.199839 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 547, in _matchHelper\n2017-01-05 17:52:16.199854 |         mismatch = matcher.match(matchee)\n2017-01-05 17:52:16.199899 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_exception.py\", line 108, in match\n2017-01-05 17:52:16.199919 |         mismatch = self.exception_matcher.match(exc_info)\n2017-01-05 17:52:16.199975 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_higherorder.py\", line 62, in match\n2017-01-05 17:52:16.199992 |         mismatch = matcher.match(matchee)\n2017-01-05 17:52:16.200033 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 475, in match\n2017-01-05 17:52:16.200045 |         reraise(*matchee)\n2017-01-05 17:52:16.200088 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_exception.py\", line 101, in match\n2017-01-05 17:52:16.200100 |         result = matchee()\n2017-01-05 17:52:16.200142 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 1049, in __call__\n2017-01-05 17:52:16.200162 |         return self._callable_object(*self._args, **self._kwargs)\n2017-01-05 17:52:16.200181 |       File \"nova/volume/cinder.py\", line 80, in cinderclient\n2017-01-05 17:52:16.200203 |         url = _SESSION.get_endpoint(auth, **service_parameters)\n2017-01-05 17:52:16.200247 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/keystoneauth1/session.py\", line 808, in get_endpoint\n2017-01-05 17:52:16.200263 |         return auth.get_endpoint(self, **kwargs)\n2017-01-05 17:52:16.200281 |       File \"nova/context.py\", line 61, in get_endpoint\n2017-01-05 17:52:16.200294 |         region_name=region_name)\n2017-01-05 17:52:16.200391 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/positional/__init__.py\", line 101, in inner\n2017-01-05 17:52:16.200420 |         return wrapped(*args, **kwargs)\n2017-01-05 17:52:16.200467 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/keystoneauth1/access/service_catalog.py\", line 190, in url_for\n2017-01-05 17:52:16.200490 |         raise exceptions.EmptyCatalog('The service catalog is empty.')\n2017-01-05 17:52:16.200527 |     keystoneauth1.exceptions.catalog.EmptyCatalog: The service catalog is empty.\n\nIt's a race in a test introduced in https://review.openstack.org/#/c/409904/.\n\nI suspect it's a race in a global mock.", 
    "tags": [
        "testing"
    ], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1654393", 
    "owner": "https://api.launchpad.net/1.0/~mriedem", 
    "id": 1654393, 
    "index": 2018, 
    "created": "2017-01-05 20:56:59.824274+00:00", 
    "title": "'keystoneauth1.exceptions.catalog.EmptyCatalog: The service catalog is empty.' in test_cinderclient_unsupported_v1", 
    "comments": [
        {
            "content": "This just started failing today:\n\nhttp://logs.openstack.org/18/417118/1/check/gate-nova-python27-db-ubuntu-xenial/0c0c8c1/console.html#_2017-01-05_17_52_16_199447\n\n2017-01-05 17:52:16.199447 | nova.tests.unit.test_cinder.CinderV1TestCase.test_cinderclient_unsupported_v1\n2017-01-05 17:52:16.199481 | -----------------------------------------------------------------------------\n2017-01-05 17:52:16.199488 | \n2017-01-05 17:52:16.199498 | Captured traceback:\n2017-01-05 17:52:16.199510 | ~~~~~~~~~~~~~~~~~~~\n2017-01-05 17:52:16.199525 |     Traceback (most recent call last):\n2017-01-05 17:52:16.199568 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/mock/mock.py\", line 1305, in patched\n2017-01-05 17:52:16.199585 |         return func(*args, **keywargs)\n2017-01-05 17:52:16.199612 |       File \"nova/tests/unit/test_cinder.py\", line 134, in test_cinderclient_unsupported_v1\n2017-01-05 17:52:16.199627 |         cinder.cinderclient, ctxt)\n2017-01-05 17:52:16.199684 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 485, in assertRaises\n2017-01-05 17:52:16.199701 |         self.assertThat(our_callable, matcher)\n2017-01-05 17:52:16.199768 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 496, in assertThat\n2017-01-05 17:52:16.199794 |         mismatch_error = self._matchHelper(matchee, matcher, message, verbose)\n2017-01-05 17:52:16.199839 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 547, in _matchHelper\n2017-01-05 17:52:16.199854 |         mismatch = matcher.match(matchee)\n2017-01-05 17:52:16.199899 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_exception.py\", line 108, in match\n2017-01-05 17:52:16.199919 |         mismatch = self.exception_matcher.match(exc_info)\n2017-01-05 17:52:16.199975 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_higherorder.py\", line 62, in match\n2017-01-05 17:52:16.199992 |         mismatch = matcher.match(matchee)\n2017-01-05 17:52:16.200033 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 475, in match\n2017-01-05 17:52:16.200045 |         reraise(*matchee)\n2017-01-05 17:52:16.200088 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_exception.py\", line 101, in match\n2017-01-05 17:52:16.200100 |         result = matchee()\n2017-01-05 17:52:16.200142 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 1049, in __call__\n2017-01-05 17:52:16.200162 |         return self._callable_object(*self._args, **self._kwargs)\n2017-01-05 17:52:16.200181 |       File \"nova/volume/cinder.py\", line 80, in cinderclient\n2017-01-05 17:52:16.200203 |         url = _SESSION.get_endpoint(auth, **service_parameters)\n2017-01-05 17:52:16.200247 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/keystoneauth1/session.py\", line 808, in get_endpoint\n2017-01-05 17:52:16.200263 |         return auth.get_endpoint(self, **kwargs)\n2017-01-05 17:52:16.200281 |       File \"nova/context.py\", line 61, in get_endpoint\n2017-01-05 17:52:16.200294 |         region_name=region_name)\n2017-01-05 17:52:16.200391 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/positional/__init__.py\", line 101, in inner\n2017-01-05 17:52:16.200420 |         return wrapped(*args, **kwargs)\n2017-01-05 17:52:16.200467 |       File \"/home/jenkins/workspace/gate-nova-python27-db-ubuntu-xenial/.tox/py27/local/lib/python2.7/site-packages/keystoneauth1/access/service_catalog.py\", line 190, in url_for\n2017-01-05 17:52:16.200490 |         raise exceptions.EmptyCatalog('The service catalog is empty.')\n2017-01-05 17:52:16.200527 |     keystoneauth1.exceptions.catalog.EmptyCatalog: The service catalog is empty.\n\nIt's a race in a test introduced in https://review.openstack.org/#/c/409904/.\n\nI suspect it's a race in a global mock.", 
            "date_created": "2017-01-05 20:56:59.824274+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/417206", 
            "date_created": "2017-01-05 21:58:35.137544+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "A minimal order to deterministically reproduce this issue is:\n\nnova.tests.unit.compute.test_compute_mgr.ComputeManagerUnitTestCase.test_shutdown_instance_versioned_notifications\nnova.tests.unit.test_cinder.CinderV1TestCase.test_cinderclient_unsupported_v1\n\nI'm currently looking for a root cause in ComputeManagerUnitTestCase.", 
            "date_created": "2017-01-06 14:46:11.924855+00:00", 
            "author": "https://api.launchpad.net/1.0/~mbooth-9"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/417408", 
            "date_created": "2017-01-06 15:06:18.767590+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Matthew Booth (<email address hidden>) on branch: master\nReview: https://review.openstack.org/417408\nReason: We're going with with an alternate approach.", 
            "date_created": "2017-01-06 15:32:55.175693+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 15.0.0.0b3 development milestone.", 
            "date_created": "2017-01-27 00:51:46.569932+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "\nThere are no currently open reviews on this bug, changing\nthe status back to the previous state and unassigning. If\nthere are active reviews related to this bug, please include\nlinks in comments.\n", 
            "date_created": "2017-06-23 12:51:06.876576+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }
    ]
}