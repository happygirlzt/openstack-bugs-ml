{
    "status": "Fix Released", 
    "last_updated": "2014-01-03 14:54:04.454285+00:00", 
    "description": "Using the latest Nova havana release on Fedora 19. I see the following stack trace in Nova's compute.log file after performing a fresh install of Nova/libvirt/qemu and trying to start nova-compute:\n\n2013-08-22 19:01:57.245 9050 ERROR nova.openstack.common.threadgroup [-] internal error Cannot find suitable emulator for x86_64\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/threadgroup.py\", line 117, in wait\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     x.wait()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/threadgroup.py\", line 49, in wait\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 168, in wait\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/event.py\", line 116, in wait\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 187, in switch\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 194, in main\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     result = function(*args, **kwargs)\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/service.py\", line 65, in run_service\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     service.start()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/service.py\", line 154, in start\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     self.manager.init_host()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 756, in init_host\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     self._report_driver_status(context)\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 4318, in _report_driver_status\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     capabilities = self.driver.get_host_stats(refresh=True)\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 3733, in get_host_stats \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return self.host_state.get_host_stats(refresh=refresh) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 374, in host_state \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     self._host_state = HostState(self) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4094, in __init__\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     self.update_status() \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4134, in update_status \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     data[\"hypervisor_version\"] = self.driver.get_hypervisor_version() \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2939, in get_hypervisor_version \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return method() \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 187, in doit \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     result = proxy_call(self._autowrap, f, *args, **kwargs) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 147, in proxy_call \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     rv = execute(f,*args,**kwargs) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 76, in tworker \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     rv = meth(*args,**kwargs) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 3550, in getVersion \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     if ret == -1: raise libvirtError ('virConnectGetVersion() failed', conn=self) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup libvirtError: internal error Cannot find suitable emulator for x86_64 \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup  \n2013-08-22 19:03:25.960 9155 WARNING nova.virt.libvirt.driver [-] URI qemu:///system does not support events\n\n----------------\n\nI've filed a related Bugzilla on the isolated libvirt issue here:\n\n https://bugzilla.redhat.com/show_bug.cgi?id=1000116\n\nThis is using libvirt 1.0.5.5-1.\n\nA couple of things can be done to work around this error.\n\n1) Manually call 'virsh capabilities' and then restart nova-compute.\n\n2) In the Nova libvirt driver if we reverse the order we call getVersion and getCapabilites it also seems to fix it.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1215593", 
    "owner": "https://api.launchpad.net/1.0/~dan-prince", 
    "id": 1215593, 
    "index": 3998, 
    "created": "2013-08-22 19:11:35.886783+00:00", 
    "title": "nova-compute startup failure on Fedora 19 fresh install (no suitable emulator)", 
    "comments": [
        {
            "content": "Using the latest Nova havana release on Fedora 19. I see the following stack trace in Nova's compute.log file after performing a fresh install of Nova/libvirt/qemu and trying to start nova-compute:\n\n2013-08-22 19:01:57.245 9050 ERROR nova.openstack.common.threadgroup [-] internal error Cannot find suitable emulator for x86_64\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/threadgroup.py\", line 117, in wait\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     x.wait()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/threadgroup.py\", line 49, in wait\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 168, in wait\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/event.py\", line 116, in wait\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 187, in switch\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 194, in main\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     result = function(*args, **kwargs)\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/service.py\", line 65, in run_service\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     service.start()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/service.py\", line 154, in start\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     self.manager.init_host()\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 756, in init_host\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     self._report_driver_status(context)\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 4318, in _report_driver_status\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     capabilities = self.driver.get_host_stats(refresh=True)\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 3733, in get_host_stats \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return self.host_state.get_host_stats(refresh=refresh) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 374, in host_state \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     self._host_state = HostState(self) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4094, in __init__\n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     self.update_status() \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4134, in update_status \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     data[\"hypervisor_version\"] = self.driver.get_hypervisor_version() \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2939, in get_hypervisor_version \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     return method() \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 187, in doit \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     result = proxy_call(self._autowrap, f, *args, **kwargs) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 147, in proxy_call \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     rv = execute(f,*args,**kwargs) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 76, in tworker \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     rv = meth(*args,**kwargs) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 3550, in getVersion \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup     if ret == -1: raise libvirtError ('virConnectGetVersion() failed', conn=self) \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup libvirtError: internal error Cannot find suitable emulator for x86_64 \n2013-08-22 19:01:57.245 9050 TRACE nova.openstack.common.threadgroup  \n2013-08-22 19:03:25.960 9155 WARNING nova.virt.libvirt.driver [-] URI qemu:///system does not support events\n\n----------------\n\nI've filed a related Bugzilla on the isolated libvirt issue here:\n\n https://bugzilla.redhat.com/show_bug.cgi?id=1000116\n\nThis is using libvirt 1.0.5.5-1.\n\nA couple of things can be done to work around this error.\n\n1) Manually call 'virsh capabilities' and then restart nova-compute.\n\n2) In the Nova libvirt driver if we reverse the order we call getVersion and getCapabilites it also seems to fix it.", 
            "date_created": "2013-08-22 19:11:35.886783+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }, 
        {
            "content": "This was fixed in baadaa9842ad4ff8b637466affd3c9f2213b55ac.\n\n    Updates the Nova libvirt driver so we make a call to get\n    the driver capabilities. This is clearly a work around\n    but it does allow nova-compute to startup cleanly when\n    performing a clean install of Fedora 19.\n    \n    See notes in: https://bugzilla.redhat.com/show_bug.cgi?id=1000116\n    \n    Fixes LP Bug #1215593.\n    \n    Change-Id: I2c74dc001032e3cc4d7d55a3fa407b96fd0d0e78\n", 
            "date_created": "2014-01-03 14:53:32.549884+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }
    ]
}