{
    "status": "Invalid", 
    "last_updated": "2015-12-22 04:52:49.933600+00:00", 
    "description": "After upgrade to the lastest version of openstack kilo, when i boot new instance from image the instance started failed with error message below.  I see nova do not create RBD volumes of glance image to Ceph VMS pool, this affect to swap and Ephemeral disk too my system worked correctly before. Please check my attach file for detail\n===============\n2015-12-18 22:07:56.590 1620300 DEBUG nova.virt.libvirt.rbd_utils [req-eab9562d-484f-432d-a9d7-0ab32ec99c23 0690b97b2bea47a8aeb4777856f473b2 767b2f8a8b08403884269836420d34f0 - - -] rbd image 352eb808-f7c3-405d-92b4-c29bf07a46f0_disk does not exist __init__ /usr/lib/python2.7/dist-packages/nova/virt/libvirt/rbd_utils.py:60\n2015-12-18 22:07:56.641 1620300 DEBUG nova.virt.libvirt.rbd_utils [req-eab9562d-484f-432d-a9d7-0ab32ec99c23 0690b97b2bea47a8aeb4777856f473b2 767b2f8a8b08403884269836420d34f0 - - -] rbd image 352eb808-f7c3-405d-92b4-c29bf07a46f0_disk does not exist __init__ /usr/lib/python2.7/dist-packages/nova/virt/libvirt/rbd_utils.py:60\n2015-12-18 22:15:12.033 1620300 DEBUG nova.virt.libvirt.rbd_utils [req-c07f3a3b-82de-41b5-9f91-e52a2295b0fa 0690b97b2bea47a8aeb4777856f473b2 767b2f8a8b08403884269836420d34f0 - - -] rbd image 40df5d10-6af1-49ea-bb5f-37a5e6ffa053_disk does not exist __init__ /usr/lib/python2.7/dist-packages/nova/virt/libvirt/rbd_utils.py:60\n2015-12-18 22:15:12.093 1620300 DEBUG nova.virt.libvirt.rbd_utils [req-c07f3a3b-82de-41b5-9f91-e52a2295b0fa 0690b97b2bea47a8aeb4777856f473b2 767b2f8a8b08403884269836420d34f0 - - -] rbd image 40df5d10-6af1-49ea-bb5f-37a5e6ffa053_disk does not exist __init__ /usr/lib/python2.7/dist-packages/nova/virt/libvirt/rbd_utils.py:60\n#########################\n\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]     do_log=False, semaphores=semaphores, delay=delay):\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]   File \"/usr/lib/python2.7/contextlib.py\", line 17, in __ent\ner__\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]     return self.gen.next()\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]   File \"/usr/lib/python2.7/dist-packages/oslo_concurrency/lo\nckutils.py\", line 395, in lock\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]     ext_lock.acquire(delay=delay)\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]   File \"/usr/lib/python2.7/dist-packages/oslo_concurrency/lo\nckutils.py\", line 209, in acquire\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]     do_acquire()\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]   File \"/usr/lib/python2.7/dist-packages/oslo_concurrency/lo\nckutils.py\", line 158, in wrapper\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]     return r.call(func, *args, **kwargs)\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]   File \"/usr/lib/python2.7/dist-packages/retrying.py\", line\n222, in call\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]     if not self.should_reject(attempt):\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]   File \"/usr/lib/python2.7/dist-packages/retrying.py\", line\n206, in should_reject\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]     reject |= self._retry_on_exception(attempt.value[1])\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]   File \"/usr/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 130, in retry_on_exception\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d]     'exception': e,\n2015-12-18 22:27:48.308 1623512 TRACE nova.compute.manager [instance: 3bf19259-4a86-4b9e-b358-15e59470231d] error: Unable to acquire lock on `/var/lib/nova/instances/locks/nova-b1eea0695ff68d78bc25e6a8e3ed77b595fd485a` due to [Errno 37] No locks available", 
    "tags": [
        "ceph", 
        "kilo", 
        "nova"
    ], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1527661", 
    "owner": "None", 
    "id": 1527661, 
    "index": 5925, 
    "created": "2015-12-18 15:42:13.360686+00:00", 
    "title": "Create new instance  boot from rbd image failed (no image created in VMS pools),after upgrade lastest kilo build", 
    "comments": [
        {
            "content": "After upgrade to the lastest version of openstack kilo, when i boot new instance from image the instance started failed with error message below.  I see nova do not create RBD volumes of glance image to Ceph VMS pool, my system worked correctly before. Please check my attach file for detail\n===============\n\n2015-12-18 22:07:56.590 1620300 DEBUG nova.virt.libvirt.rbd_utils [req-eab9562d-484f-432d-a9d7-0ab32ec99c23 0690b97b2bea47a8aeb4777856f473b2 767b2f8a8b0840388426983642$\n2015-12-18 22:07:56.595 1620300 DEBUG oslo_concurrency.lockutils [req-8de71cfa-76fb-4efd-9b47-91c476100e23 2ebfa681e4664c9f9ea5939aa06dea44 8925e61ab1084b6d93e35d22d14$\n2015-12-18 22:07:56.641 1620300 DEBUG nova.virt.libvirt.rbd_utils [req-eab9562d-484f-432d-a9d7-0ab32ec99c23 0690b97b2bea47a8aeb4777856f473b2 767b2f8a8b0840388426983642$\n2015-12-18 22:07:56.647 1620300 DEBUG oslo_concurrency.lockutils [req-eab9562d-484f-432d-a9d7-0ab32ec99c23 0690b97b2bea47a8aeb4777856f473b2 767b2f8a8b08403884269836420$\n2015-12-18 22:07:56.647 1620300 ERROR nova.compute.manager [req-eab9562d-484f-432d-a9d7-0ab32ec99c23 0690b97b2bea47a8aeb4777856f473b2 767b2f8a8b08403884269836420d34f0 $\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0] Traceback (most recent call last):\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/nova/compute/manag$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     yield resources\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/nova/compute/manag$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     block_device_info=block_device_info)\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     admin_pass=admin_password)\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     instance, size, fallback_from_host)\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     size=size)\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/$\n\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     prepare_template(target=base, max_size=size, *args, **k$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/oslo_concurrency/l$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     do_log=False, semaphores=semaphores, delay=delay):\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/contextlib.py\", line 17, in __en$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     return self.gen.next()\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/oslo_concurrency/l$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     ext_lock.acquire(delay=delay)\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/oslo_concurrency/l$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     do_acquire()\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/oslo_concurrency/l$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     return r.call(func, *args, **kwargs)\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/retrying.py\", line$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     if not self.should_reject(attempt):\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/retrying.py\", line$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     reject |= self._retry_on_exception(attempt.value[1])\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]   File \"/usr/lib/python2.7/dist-packages/oslo_concurrency/l$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]     'exception': e,\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0] error: Unable to acquire lock on `/var/lib/nova/instances/l$\n2015-12-18 22:07:56.647 1620300 TRACE nova.compute.manager [instance: 352eb808-f7c3-405d-92b4-c29bf07a46f0]", 
            "date_created": "2015-12-18 15:42:13.360686+00:00", 
            "author": "https://api.launchpad.net/1.0/~prescolt"
        }, 
        {
            "content": "", 
            "date_created": "2015-12-18 15:42:13.360686+00:00", 
            "author": "https://api.launchpad.net/1.0/~prescolt"
        }, 
        {
            "content": "i see request \nINFO nova.virt.libvirt.driver [req-f3af9880-906a-4a28-86b0-b7850dd0bbce 0690b97b2bea47a8aeb4777856f473b2 767b2f8a8b08403884269836420d34f0 - - -] [instance: 69e1ddcb-f4f6-4900-b9dd-80fdaa86d58a] Creating image\n but no image available ", 
            "date_created": "2015-12-18 16:07:46.377703+00:00", 
            "author": "https://api.launchpad.net/1.0/~prescolt"
        }, 
        {
            "content": "nova do not exec command like this below in rootwrap\nrbd import --pool dev /var/lib/nova/instances/_base/fa39bfedbadb92bcf9b129cfd2c5411c98454bf7 b2332490-6319-409d-bff2-71d3004b9175_disk --image-format=2 --id dev --conf /etc/ceph/ceph.conf", 
            "date_created": "2015-12-19 01:58:16.154841+00:00", 
            "author": "https://api.launchpad.net/1.0/~prescolt"
        }, 
        {
            "content": "edit, I find problem cause by  NFS file system  can not lock file,  reboot NFS service have no luck, I must reboot NFS server\nNow it worked correctly.\nThis problem cause by update NFS service", 
            "date_created": "2015-12-22 04:52:49.302540+00:00", 
            "author": "https://api.launchpad.net/1.0/~prescolt"
        }
    ]
}