{
    "status": "Fix Released", 
    "last_updated": "2017-03-30 08:24:58.593730+00:00", 
    "description": "XenServer with dirver XenAPI, it always fails to create image from volume.\n\nTempest test: tempest.scenario.test_volume_boot_pattern.TestVolumeBootPatternV2.test_create_ebs_image_and_check_boot\n\n2016-08-24 08:13:24.636 27347 DEBUG nova.compute.api [req-fd7afac4-a2ee-41cb-b785-02766806db26 tempest-TestVolumeBootPatternV2-1645487335 tempest-TestVolumeBootPatternV2-1645487335] [instance: 5d5a8b10-655c-457e-8ad9-edbfb6ecd278] Creating snapshot from volume 9953359c-327a-41bf-abec-f3c3da416390. snapshot_volume_backed /opt/stack/new/nova/nova/compute/api.py:2445^M\n2016-08-24 08:13:25.964 27347 INFO os_vif [req-fd7afac4-a2ee-41cb-b785-02766806db26 tempest-TestVolumeBootPatternV2-1645487335 tempest-TestVolumeBootPatternV2-1645487335] Loaded VIF plugin class '<class 'vif_plug_ovs.ovs.OvsPlugin'>' with name 'ovs'^M\n2016-08-24 08:13:25.965 27347 INFO os_vif [req-fd7afac4-a2ee-41cb-b785-02766806db26 tempest-TestVolumeBootPatternV2-1645487335 tempest-TestVolumeBootPatternV2-1645487335] Loaded VIF plugin class '<class 'vif_plug_linux_bridge.linux_bridge.LinuxBridgePlugin'>' with name 'linux_bridge'^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions [req-fd7afac4-a2ee-41cb-b785-02766806db26 tempest-TestVolumeBootPatternV2-1645487335 tempest-TestVolumeBootPatternV2-1645487335] Unexpected exception in API method^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions Traceback (most recent call last):^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/openstack/extensions.py\", line 338, in wrapped^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/openstack/common.py\", line 372, in inner^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/validation/__init__.py\", line 73, in wrapper^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/validation/__init__.py\", line 73, in wrapper^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/openstack/compute/servers.py\", line 1072, in _action_create_image^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     metadata)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/compute/api.py\", line 146, in inner^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return f(self, context, instance, *args, **kw)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/compute/api.py\", line 2463, in snapshot_volume_backed^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return self.image_api.create(context, image_meta)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/image/api.py\", line 106, in create^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return session.create(context, image_info, data=data)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/image/glance.py\", line 626, in create^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     data, force_activate)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/image/glance.py\", line 658, in _create_v2^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     context, 2, 'create', **sent_service_image_meta)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/image/glance.py\", line 174, in call^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     result = getattr(client.images, method)(*args, **kwargs)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/usr/local/lib/python2.7/dist-packages/glanceclient/v2/images.py\", line 233, in create^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     raise TypeError(encodeutils.exception_to_unicode(e))^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions TypeError: Unable to set 'disk_format' to 'qcow2'. Reason: 'qcow2' is not one of [None, u'ami', u'ari', u'aki', u'vhd', u'raw', u'iso']^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions ^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions Failed validating u'enum' in schema[u'properties'][u'disk_format']:^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     {u'description': u'Format of the disk',^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions      u'enum': [None, u'ami', u'ari', u'aki', u'vhd', u'raw', u'iso'],^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions      u'type': [u'null', u'string']}^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions ^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions On instance[u'disk_format']:^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     'qcow2'^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions ^M\n\n\n\nPer my analysis, it should be bug due to it hardcode the disk format as qcow2. \nSee: https://github.com/openstack/nova/blob/master/nova/compute/api.py#L2471\nAt here, it cleans the disk_format and container_format\n\nThen:\n\nhttps://github.com/openstack/nova/blob/master//nova/image/glance.py#L651\nIt will hardcode the disk_format as qcow2 which is not supported by XenAPI.\n\nnova/nova/image/glance.py\n    def _create_v2(self, context, sent_service_image_meta, data=None,\n                   force_activate=False):\n        # Glance v1 allows image activation without setting disk and\n        # container formats, v2 doesn't. It leads to the dirtiest workaround\n        # where we have to hardcode this parameters.\n        if force_activate:\n            data = ''\n            if 'disk_format' not in sent_service_image_meta:\n                sent_service_image_meta['disk_format'] = 'qcow2'\n            if 'container_format' not in sent_service_image_meta:\n                sent_service_image_meta['container_format'] = 'bare'", 
    "tags": [
        "newton-rc-potential", 
        "xenserver"
    ], 
    "importance": "High", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1616938", 
    "owner": "https://api.launchpad.net/1.0/~mriedem", 
    "id": 1616938, 
    "index": 1980, 
    "created": "2016-08-25 14:02:03.651744+00:00", 
    "title": "XenAPI: failed to create image from volume backed instance with glance v2", 
    "comments": [
        {
            "content": "XenServer with dirver XenAPI, it always fails to create image from volume.\n\nTempest test: tempest.scenario.test_volume_boot_pattern.TestVolumeBootPatternV2.test_create_ebs_image_and_check_boot\n\n2016-08-24 08:13:24.636 27347 DEBUG nova.compute.api [req-fd7afac4-a2ee-41cb-b785-02766806db26 tempest-TestVolumeBootPatternV2-1645487335 tempest-TestVolumeBootPatternV2-1645487335] [instance: 5d5a8b10-655c-457e-8ad9-edbfb6ecd278] Creating snapshot from volume 9953359c-327a-41bf-abec-f3c3da416390. snapshot_volume_backed /opt/stack/new/nova/nova/compute/api.py:2445^M\n2016-08-24 08:13:25.964 27347 INFO os_vif [req-fd7afac4-a2ee-41cb-b785-02766806db26 tempest-TestVolumeBootPatternV2-1645487335 tempest-TestVolumeBootPatternV2-1645487335] Loaded VIF plugin class '<class 'vif_plug_ovs.ovs.OvsPlugin'>' with name 'ovs'^M\n2016-08-24 08:13:25.965 27347 INFO os_vif [req-fd7afac4-a2ee-41cb-b785-02766806db26 tempest-TestVolumeBootPatternV2-1645487335 tempest-TestVolumeBootPatternV2-1645487335] Loaded VIF plugin class '<class 'vif_plug_linux_bridge.linux_bridge.LinuxBridgePlugin'>' with name 'linux_bridge'^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions [req-fd7afac4-a2ee-41cb-b785-02766806db26 tempest-TestVolumeBootPatternV2-1645487335 tempest-TestVolumeBootPatternV2-1645487335] Unexpected exception in API method^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions Traceback (most recent call last):^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/openstack/extensions.py\", line 338, in wrapped^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/openstack/common.py\", line 372, in inner^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/validation/__init__.py\", line 73, in wrapper^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/validation/__init__.py\", line 73, in wrapper^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/openstack/compute/servers.py\", line 1072, in _action_create_image^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     metadata)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/compute/api.py\", line 146, in inner^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return f(self, context, instance, *args, **kw)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/compute/api.py\", line 2463, in snapshot_volume_backed^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return self.image_api.create(context, image_meta)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/image/api.py\", line 106, in create^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     return session.create(context, image_info, data=data)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/image/glance.py\", line 626, in create^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     data, force_activate)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/image/glance.py\", line 658, in _create_v2^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     context, 2, 'create', **sent_service_image_meta)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/image/glance.py\", line 174, in call^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     result = getattr(client.images, method)(*args, **kwargs)^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions   File \"/usr/local/lib/python2.7/dist-packages/glanceclient/v2/images.py\", line 233, in create^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     raise TypeError(encodeutils.exception_to_unicode(e))^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions TypeError: Unable to set 'disk_format' to 'qcow2'. Reason: 'qcow2' is not one of [None, u'ami', u'ari', u'aki', u'vhd', u'raw', u'iso']^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions ^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions Failed validating u'enum' in schema[u'properties'][u'disk_format']:^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     {u'description': u'Format of the disk',^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions      u'enum': [None, u'ami', u'ari', u'aki', u'vhd', u'raw', u'iso'],^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions      u'type': [u'null', u'string']}^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions ^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions On instance[u'disk_format']:^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions     'qcow2'^M\n2016-08-24 08:13:26.049 27347 ERROR nova.api.openstack.extensions ^M\n\n\n\nPer my analysis, it should be bug due to it hardcode the disk format as qcow2. \nSee: https://github.com/openstack/nova/blob/master/nova/compute/api.py#L2471\nAt here, it cleans the disk_format and container_format\n\nThen:\n\nhttps://github.com/openstack/nova/blob/master//nova/image/glance.py#L651\nIt will hardcode the disk_format as qcow2 which is not supported by XenAPI.\n\nnova/nova/image/glance.py\n    def _create_v2(self, context, sent_service_image_meta, data=None,\n                   force_activate=False):\n        # Glance v1 allows image activation without setting disk and\n        # container formats, v2 doesn't. It leads to the dirtiest workaround\n        # where we have to hardcode this parameters.\n        if force_activate:\n            data = ''\n            if 'disk_format' not in sent_service_image_meta:\n                sent_service_image_meta['disk_format'] = 'qcow2'\n            if 'container_format' not in sent_service_image_meta:\n                sent_service_image_meta['container_format'] = 'bare'", 
            "date_created": "2016-08-25 14:02:03.651744+00:00", 
            "author": "https://api.launchpad.net/1.0/~wjh-fresh"
        }, 
        {
            "content": "When create image from instance which is not volume backed, it depends on hypervisor's driver to correct the disk_format (and container_format) at uploading data to image. so there is no problem;\nBut for volume backed instance, creating image will take a volume snapshot in volume back-end. In this case, the image is simply a bucket of properties without any image data.\n     https://github.com/openstack/nova/blob/master/nova/compute/api.py#L2545\nThere is no image data to be uploaded, so there is no chance for hypervisor to correct disk_format. If the hypervisor driver(e.g. XenAPI) doesn't support the default hardcoded disk_format - qcow2, it will cause failures at image creating and booting instance from that image.\nOn the other side, as the real data is in the volume snapshot. There is no need to process data basing on the image's format. So I think a reasonable solution is to use a common disk_format supported by all hypervisors - e.g. 'raw'.", 
            "date_created": "2016-09-07 15:09:29.101788+00:00", 
            "author": "https://api.launchpad.net/1.0/~wjh-fresh"
        }, 
        {
            "content": "So basically we have a regression in newton for the xenserver backend it sounds like because the glance v2 code was added in newton and that's what's hardcoding the format to qcow2, and glance v1 usage is deprecated now. So you can't use glance v2 + xen and take snapshots of volume-backed instances.", 
            "date_created": "2016-09-24 01:11:01.343544+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "What is the glance image backend that you're using here? It's not that the xen api virt driver is failing, glance is rejecting the image create request - but what's the image backend in this case?", 
            "date_created": "2016-09-24 01:14:19.825404+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "I wonder if an alternative in nova's glance v2 image service when creating the image is to check the CONF.snapshot_image_format (which is currently only a libvirt option), and if not set then default to qcow2. That seems pretty hacky though.\n\nI don't really understand how xenapi works with glance though given the xen plugins code for uploading vhds here:\n\nhttps://github.com/openstack/nova/blob/master/plugins/xenserver/xenapi/etc/xapi.d/plugins/glance.py#L612", 
            "date_created": "2016-09-24 01:29:49.666831+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "I think the xen driver needs a code to check the container and disk formats supported at that glance installation.\n\nA check using the schema call will do the trick\n\nhttps://github.com/openstack/glance/blob/7c7dd626896d732d75c6b802a33b9462aee885fd/glance/api/v2/images.py#L980\n\nhttps://github.com/openstack/glance/blob/7c7dd626896d732d75c6b802a33b9462aee885fd/glance/api/v2/images.py#L837\n\nhttps://github.com/openstack/glance/blob/7c7dd626896d732d75c6b802a33b9462aee885fd/glance/api/v2/images.py#L887-L895", 
            "date_created": "2016-09-24 11:12:00.870834+00:00", 
            "author": "https://api.launchpad.net/1.0/~nikhil-komawar"
        }, 
        {
            "content": "This issue seems to be happening much before the code block reaches the xen driver at the (nova.image.glance), so the schema check needs to be added here too https://github.com/openstack/nova/blob/65b72f2d9d829fa6e0f8ed7bea2fb2831d9ebb8b/nova/image/glance.py#L651 (this schema validation is new in v2, so a v2 issue here)\n\nbesides above:\n\nIt's not a glance issue (as per current description) so I marked it incomplete but if more issues are found we can discuss.\n\nFrom the current looks of it, the assumptions during v1->v2 port was that xen was being sparsely deployed and they went with what made sense to pass the gate tests.\n\nSo, I think the first thing reporter needs to do is add a test in the gate to indicate this use case. (This will avoid regressions)\n\nThen to solve this we can add that check which fetches the schema from glance-api, checks if the format attempted to upload is correct and logs appropriate message if failed. (at the xen plugin, we can't reuse the code that will be added as prescribed above)\n\nAlso, I checked the nova xen driver and looks like it is supported for vhd only for both v1 and v2\n\nhttps://github.com/openstack/nova/blob/15a159b3fcedc1b360367641a41413966c854a9a/plugins/xenserver/xenapi/etc/xapi.d/plugins/glance.py#L251\n\nhttps://github.com/openstack/nova/blob/15a159b3fcedc1b360367641a41413966c854a9a/plugins/xenserver/xenapi/etc/xapi.d/plugins/glance.py#L316", 
            "date_created": "2016-09-24 11:27:52.315868+00:00", 
            "author": "https://api.launchpad.net/1.0/~nikhil-komawar"
        }, 
        {
            "content": "Thanks for the investigation Nikhil. I agree it looks like the nova.image.glance v2 API code will need to get the schema first and then pick an appropriate disk_format and container_format values.", 
            "date_created": "2016-09-24 12:57:19.746315+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "The good news is we have a gate test that triggers this:\n\ntempest.scenario.test_volume_boot_pattern.TestVolumeBootPatternV2.test_create_ebs_image_and_check_boot\n\nIt's just that the xenserver CI has to probably skip that test because of this bug.", 
            "date_created": "2016-09-24 12:58:35.163044+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Change abandoned by Jianghua Wang (<email address hidden>) on branch: master\nReview: https://review.openstack.org/366825\nReason: this bug will be fixed by https://review.openstack.org/#/c/375875", 
            "date_created": "2016-09-25 07:02:02.395444+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "My proposed fix is here: https://review.openstack.org/#/c/375875/\n\nI hadn't seen https://review.openstack.org/366825 because it wasn't linked into this bug report and the status was still New.", 
            "date_created": "2016-09-25 16:00:59.688869+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/375875\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=2fe5daeb5fcd2750b0eb083fc5c8bfd3fdb992e2\nSubmitter: Jenkins\nBranch:    master\n\ncommit 2fe5daeb5fcd2750b0eb083fc5c8bfd3fdb992e2\nAuthor: Matt Riedemann <email address hidden>\nDate:   Sat Sep 24 11:24:40 2016 -0400\n\n    Determine disk_format for volume-backed snapshot from schema\n    \n    Xen deployments don't support qcow2 images which is what the\n    glance v2 API code in nova defaults to, so basically you can't\n    create a snapshot of a volume-backed instance with glance v2 and\n    Xen right now.\n    \n    This change uses the glance v2 image schema to determine the\n    disk_format to use based on some rules:\n    \n    1. Look for a preferred disk_format using an ordered list.\n    2. If we still can't figure it out, just use the first\n       supported disk_format available.\n    \n    Change-Id: Ifaa150fda393e2b49114e30dd5e30e5bf52b4ed1\n    Closes-Bug: #1616938\n", 
            "date_created": "2016-09-26 18:18:23.344567+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "stable/newton: https://review.openstack.org/#/c/376999/", 
            "date_created": "2016-09-26 21:03:39.847448+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/376999\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=7c4a5b1ee729a4e9bb6add2a6b6423f9bbd1c0d0\nSubmitter: Jenkins\nBranch:    stable/newton\n\ncommit 7c4a5b1ee729a4e9bb6add2a6b6423f9bbd1c0d0\nAuthor: Matt Riedemann <email address hidden>\nDate:   Sat Sep 24 11:24:40 2016 -0400\n\n    Determine disk_format for volume-backed snapshot from schema\n    \n    Xen deployments don't support qcow2 images which is what the\n    glance v2 API code in nova defaults to, so basically you can't\n    create a snapshot of a volume-backed instance with glance v2 and\n    Xen right now.\n    \n    This change uses the glance v2 image schema to determine the\n    disk_format to use based on some rules:\n    \n    1. Look for a preferred disk_format using an ordered list.\n    2. If we still can't figure it out, just use the first\n       supported disk_format available.\n    \n    Change-Id: Ifaa150fda393e2b49114e30dd5e30e5bf52b4ed1\n    Closes-Bug: #1616938\n    (cherry picked from commit 2fe5daeb5fcd2750b0eb083fc5c8bfd3fdb992e2)\n", 
            "date_created": "2016-09-27 16:48:24.050182+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.0.0rc2 release candidate.", 
            "date_created": "2016-09-29 21:21:57.440220+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 15.0.0.0b1 development milestone.", 
            "date_created": "2016-11-17 13:13:37.137704+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}