{
    "status": "Invalid", 
    "last_updated": "2013-02-28 17:18:43.757696+00:00", 
    "description": "Running into a problem when trying to open a noVNC console session. Screen hangs on \"Starting VNC handshake\", and eventually times out with a 1006 error.\n\nI'm running the latest from the Grizzly Ubuntu Testing PPA.\n\nnova-consoleauth.log shows:\n2013-02-07 15:48:34.705 AUDIT nova.consoleauth.manager [req-d7094194-b6c4-4784-b265-a401dbffd32e None None] Checking Token: 93d09852-3b0b-4999-a9ca-79c75ab1ed83, True)\n2013-02-07 15:48:34.709 ERROR nova.openstack.common.rpc.amqp [req-d7094194-b6c4-4784-b265-a401dbffd32e None None] Exception during message handling\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 282, in _process_data\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     ctxt.reply(rval, None, connection_pool=self.connection_pool)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 191, in reply\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     ending, log_failure)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 171, in msg_reply\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     conn.direct_send(msg_id, rpc_common.serialize_msg(msg))\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 692, in direct_send\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.publisher_send(DirectPublisher, msg_id, msg)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 668, in publisher_send\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.ensure(_error_callback, _publish)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 554, in ensure\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     return method(*args, **kwargs)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 665, in _publish\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     publisher = cls(self.conf, self.channel, topic, **kwargs)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 323, in __init__\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     type='direct', **options)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 295, in __init__\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.reconnect(channel)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 303, in reconnect\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     routing_key=self.routing_key)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/messaging.py\", line 83, in __init__\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.revive(self._channel)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/messaging.py\", line 213, in revive\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.declare()\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/messaging.py\", line 100, in declare\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.exchange.declare()\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/entity.py\", line 159, in declare\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     passive=passive)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/channel.py\", line 600, in exchange_declare\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     (40, 11),  # Channel.exchange_declare_ok\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py\", line 70, in wait\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     return self.dispatch_method(method_sig, args, content)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py\", line 87, in dispatch_method\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     return amqp_method(self, args)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/channel.py\", line 221, in _close\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     raise ChannelError(reply_code, reply_text, (class_id, method_id))\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp ChannelError: 406: (PRECONDITION_FAILED - cannot redeclare exchange '49e38540308447d1b64841b9e8a31e5a' in vhost '/' with different type, durable, internal or autodelete value, (40, 10), None)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp \n2013-02-07 15:48:34.714 ERROR nova.openstack.common.rpc.common [req-d7094194-b6c4-4784-b265-a401dbffd32e None None] Returning exception 406: (PRECONDITION_FAILED - cannot redeclare exchange '49e38540308447d1b64841b9e8a31e5a' in vhost '/' with different type, durable, internal or autodelete value, (40, 10), None) to caller\n\n\nThis was working fine until a day or two ago.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1118686", 
    "owner": "None", 
    "id": 1118686, 
    "index": 3390, 
    "created": "2013-02-07 19:50:43.687807+00:00", 
    "title": "nova-consoleauth issue with rabbitmq when trying to view console", 
    "comments": [
        {
            "content": "Running into a problem when trying to open a noVNC console session. Screen hangs on \"Starting VNC handshake\", and eventually times out with a 1006 error.\n\nI'm running the latest from the Grizzly Ubuntu Testing PPA.\n\nnova-consoleauth.log shows:\n2013-02-07 15:48:34.705 AUDIT nova.consoleauth.manager [req-d7094194-b6c4-4784-b265-a401dbffd32e None None] Checking Token: 93d09852-3b0b-4999-a9ca-79c75ab1ed83, True)\n2013-02-07 15:48:34.709 ERROR nova.openstack.common.rpc.amqp [req-d7094194-b6c4-4784-b265-a401dbffd32e None None] Exception during message handling\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 282, in _process_data\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     ctxt.reply(rval, None, connection_pool=self.connection_pool)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 191, in reply\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     ending, log_failure)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 171, in msg_reply\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     conn.direct_send(msg_id, rpc_common.serialize_msg(msg))\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 692, in direct_send\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.publisher_send(DirectPublisher, msg_id, msg)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 668, in publisher_send\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.ensure(_error_callback, _publish)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 554, in ensure\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     return method(*args, **kwargs)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 665, in _publish\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     publisher = cls(self.conf, self.channel, topic, **kwargs)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 323, in __init__\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     type='direct', **options)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 295, in __init__\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.reconnect(channel)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/impl_kombu.py\", line 303, in reconnect\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     routing_key=self.routing_key)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/messaging.py\", line 83, in __init__\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.revive(self._channel)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/messaging.py\", line 213, in revive\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.declare()\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/messaging.py\", line 100, in declare\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     self.exchange.declare()\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/entity.py\", line 159, in declare\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     passive=passive)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/channel.py\", line 600, in exchange_declare\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     (40, 11),  # Channel.exchange_declare_ok\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py\", line 70, in wait\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     return self.dispatch_method(method_sig, args, content)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py\", line 87, in dispatch_method\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     return amqp_method(self, args)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/channel.py\", line 221, in _close\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp     raise ChannelError(reply_code, reply_text, (class_id, method_id))\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp ChannelError: 406: (PRECONDITION_FAILED - cannot redeclare exchange '49e38540308447d1b64841b9e8a31e5a' in vhost '/' with different type, durable, internal or autodelete value, (40, 10), None)\n2013-02-07 15:48:34.709 7496 TRACE nova.openstack.common.rpc.amqp \n2013-02-07 15:48:34.714 ERROR nova.openstack.common.rpc.common [req-d7094194-b6c4-4784-b265-a401dbffd32e None None] Returning exception 406: (PRECONDITION_FAILED - cannot redeclare exchange '49e38540308447d1b64841b9e8a31e5a' in vhost '/' with different type, durable, internal or autodelete value, (40, 10), None) to caller\n\n\nThis was working fine until a day or two ago.", 
            "date_created": "2013-02-07 19:50:43.687807+00:00", 
            "author": "https://api.launchpad.net/1.0/~jacobgodin"
        }, 
        {
            "content": "Here's what an example exchange looks like in Rabbit:\n\n# rabbitmqctl list_exchanges | grep df2d38da2f454724920c2810bd0cf663\ndf2d38da2f454724920c2810bd0cf663\tdirect", 
            "date_created": "2013-02-08 15:39:01.128169+00:00", 
            "author": "https://api.launchpad.net/1.0/~jacobgodin"
        }, 
        {
            "content": "rabbitmq.log\n\nconnection <0.14457.55>, channel 1 - error:\n{amqp_error,precondition_failed,\n            \"cannot redeclare exchange 'bbd487ff5d6b4ab3903e348254c577b6' in vhost '/' with different type, durable, internal or autodelete value\",\n            'exchange.declare'}\n", 
            "date_created": "2013-02-08 17:28:51.038167+00:00", 
            "author": "https://api.launchpad.net/1.0/~jacobgodin"
        }, 
        {
            "content": "Are you still seeing this? I suspect a packaging bug here. Perhaps an old version of consoleauth is getting run or it has incorrect settings? ", 
            "date_created": "2013-02-26 23:12:35.996749+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "Nope, seems to be working fine now. Have a new install since this was submitted.", 
            "date_created": "2013-02-28 17:18:10.125940+00:00", 
            "author": "https://api.launchpad.net/1.0/~jacobgodin"
        }
    ]
}