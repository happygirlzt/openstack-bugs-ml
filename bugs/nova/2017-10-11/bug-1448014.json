{
    "status": "Fix Released", 
    "last_updated": "2016-09-15 07:44:56.022111+00:00", 
    "description": "Using nova 1:2014.1.4-0ubuntu2 (Icehouse) on Ubuntu 14.04.2 LTS\n\nAfter associating a floating IP address to an instance in Build/Spawning state, 'nova list' and 'nova show' need - per default - a lot of time (up to 40 minutes) to display that floating IP.\n\nSteps to reproduce:\n\n* Launching instance via Horizon\n* Associate a floating IP address while instance is in Build/Spawning state via Horizon\n\nExpected result:\n\n* 'nova list' and 'nova show' should print the floating IP consistently\n* the floating IP should be part of the related row in nova.instance_info_caches database table consistently\n\nActual result:\n\n* while in Build/Spawning state 'nova list' and 'nova show' displays the floating IP address\n* while in Build/Spawning state the floating IP is part of the related row in nova.instance_info_caches\n\n* when the instance is switching to Active/Running state, the floating IP disappears in 'nova list', 'nova show' and the nova.instance_info_caches entry\n\n* a little later (related to heal_instance_info_cache_interval (see below)) the floating IP reappears\n\nSide note 1: This issue does not occur, if the floating IP is associated after launching (in Active/Running state).\nSide note 2: In Horizon, the floating IP is listed all the time.\nSide note 3: The floating IP is working (ping, ssh), even if not displayed.\n\nOutput of 'select * from nova.instance_info_cache':\n\nInstance in Build/Spawning:\n*************************** 38. row ***************************\n\u00a0\u00a0\u00a0created_at: 2015-04-24 09:06:23\n\u00a0\u00a0\u00a0updated_at: 2015-04-24 09:06:43\n\u00a0\u00a0\u00a0deleted_at: NULL\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0id: 1671\n\u00a0network_info: [{\"ovs_interfaceid\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"network\": {\"bridge\": \"br-int\", \"subnets\": [{\"ips\": [{\"meta\": {}, \"version\": 4, \"type\": \"fixed\", \"floating_ips\": [{\"meta\": {}, \"version\": 4, \"type\": \"floating\", \"address\": \"10.0.0.5\"}], \"address\": \"192.168.178.212\"}], \"version\": 4, \"meta\": {\"dhcp_server\": \"192.168.178.3\"}, \"dns\": [], \"routes\": [], \"cidr\": \"192.168.178.0/24\", \"gateway\": {\"meta\": {}, \"version\": 4, \"type\": \"gateway\", \"address\": \"192.168.178.1\"}}], \"meta\": {\"injected\": false, \"tenant_id\": \"ee8d0dd2202243389179ba2eb5a29e8c\"}, \"id\": \"276de287-a929-4263-aad5-3b30d6dcc8c9\", \"label\": \"neues-netz\"}, \"devname\": \"tapb2c284ea-ef\", \"qbh_params\": null, \"meta\": {}, \"details\": {\"port_filter\": true, \"ovs_hybrid_plug\": true}, \"address\": \"fa:16:3e:8a:32:19\", \"active\": false, \"type\": \"ovs\", \"id\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"qbg_params\": null}]\ninstance_uuid: f0d22419-1cac-47ce-9063-eee37fad97b9\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0deleted: 0\n\nInstance switches to Active/Running (\"floating_ips\" becomes empty):\n*************************** 38. row ***************************\n\u00a0\u00a0\u00a0created_at: 2015-04-24 09:06:23\n\u00a0\u00a0\u00a0updated_at: 2015-04-24 09:07:04\n\u00a0\u00a0\u00a0deleted_at: NULL\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0id: 1671\n\u00a0network_info: [{\"ovs_interfaceid\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"network\": {\"bridge\": \"br-int\", \"subnets\": [{\"ips\": [{\"meta\": {}, \"version\": 4, \"type\": \"fixed\", \"floating_ips\": [], \"address\": \"192.168.178.212\"}], \"version\": 4, \"meta\": {\"dhcp_server\": \"192.168.178.3\"}, \"dns\": [], \"routes\": [], \"cidr\": \"192.168.178.0/24\", \"gateway\": {\"meta\": {}, \"version\": 4, \"type\": \"gateway\", \"address\": \"192.168.178.1\"}}], \"meta\": {\"injected\": false, \"tenant_id\": \"ee8d0dd2202243389179ba2eb5a29e8c\"}, \"id\": \"276de287-a929-4263-aad5-3b30d6dcc8c9\", \"label\": \"neues-netz\"}, \"devname\": \"tapb2c284ea-ef\", \"qbh_params\": null, \"meta\": {}, \"details\": {\"port_filter\": true, \"ovs_hybrid_plug\": true}, \"address\": \"fa:16:3e:8a:32:19\", \"active\": false, \"type\": \"ovs\", \"id\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"qbg_params\": null}]\ninstance_uuid: f0d22419-1cac-47ce-9063-eee37fad97b9\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0deleted: 0\n\nAfter ~ 40 minutes:\n*************************** 38. row ***************************\n\u00a0\u00a0created_at: 2015-04-24 09:06:23\n\u00a0\u00a0\u00a0updated_at: 2015-04-24 09:45:35\n\u00a0\u00a0\u00a0deleted_at: NULL\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0id: 1671\n\u00a0network_info: [{\"ovs_interfaceid\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"network\": {\"bridge\": \"br-int\", \"subnets\": [{\"ips\": [{\"meta\": {}, \"version\": 4, \"type\": \"fixed\", \"floating_ips\": [{\"meta\": {}, \"version\": 4, \"type\": \"floating\", \"address\": \"10.0.0.5\"}], \"address\": \"192.168.178.212\"}], \"version\": 4, \"meta\": {\"dhcp_server\": \"192.168.178.3\"}, \"dns\": [], \"routes\": [], \"cidr\": \"192.168.178.0/24\", \"gateway\": {\"meta\": {}, \"version\": 4, \"type\": \"gateway\", \"address\": \"192.168.178.1\"}}], \"meta\": {\"injected\": false, \"tenant_id\": \"ee8d0dd2202243389179ba2eb5a29e8c\"}, \"id\": \"276de287-a929-4263-aad5-3b30d6dcc8c9\", \"label\": \"neues-netz\"}, \"devname\": \"tapb2c284ea-ef\", \"qbh_params\": null, \"meta\": {}, \"details\": {\"port_filter\": true, \"ovs_hybrid_plug\": true}, \"address\": \"fa:16:3e:8a:32:19\", \"active\": true, \"type\": \"ovs\", \"id\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"qbg_params\": null}]\ninstance_uuid: f0d22419-1cac-47ce-9063-eee37fad97b9\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0deleted: 0\n\nThe related part in nova-compute.log\n\n2015-04-24 11:07:04.544 14860 INFO nova.virt.libvirt.driver [-] [instance: f0d22419-1cac-47ce-9063-eee37fad97b9] Instance spawned successfully.\n[...]\n2015-04-24 11:45:36.012 14860 DEBUG nova.compute.manager [-] [instance: f0d22419-1cac-47ce-9063-eee37fad97b9] Updated the network info_cache for instance _heal_instance_info_cache /usr/lib/python2.7/dist-packages/nova/compute/manager.py:4897\n\nCurrent workaround:\n\nSetting 'heal_instance_info_cache_interval=1' in nova-compute.conf reduces the delay from 40 minutes to 2 minutes, but I guess setting that setting to '1' might be a problem in production.\n\nMaybe it could be possible to fire up the 'instance _heal_instance_info_cache' directly after an instance switches to Active/Running state.", 
    "tags": [
        "low-hanging-fruit", 
        "network"
    ], 
    "importance": "Low", 
    "heat": 20, 
    "link": "https://bugs.launchpad.net/nova/+bug/1448014", 
    "owner": "https://api.launchpad.net/1.0/~coolrajatsharma03", 
    "id": 1448014, 
    "index": 437, 
    "created": "2015-04-24 09:57:06.172042+00:00", 
    "title": "Delayed display of floating IPs", 
    "comments": [
        {
            "content": "Using nova 1:2014.1.4-0ubuntu2 (Icehouse) on Ubuntu 14.04.2 LTS\n\nAfter associating a floating IP address to an instance in Build/Spawning state, 'nova list' and 'nova show' need - per default - a lot of time (up to 40 minutes) to display that floating IP.\n\nSteps to reproduce:\n\n* Launching instance via Horizon\n* Associate a floating IP address while instance is in Build/Spawning state via Horizon\n\nExpected result:\n\n* 'nova list' and 'nova show' should print the floating IP consistently\n* the floating IP should be part of the related row in nova.instance_info_caches database table consistently\n\nActual result:\n\n* while in Build/Spawning state 'nova list' and 'nova show' displays the floating IP address\n* while in Build/Spawning state the floating IP is part of the related row in nova.instance_info_caches\n\n* when the instance is switching to Active/Running state, the floating IP disappears in 'nova list', 'nova show' and the nova.instance_info_caches entry\n\n* a little later (related to heal_instance_info_cache_interval (see below)) the floating IP reappears\n\nSide note 1: This issue does not occur, if the floating IP is associated after launching (in Active/Running state).\nSide note 2: In Horizon, the floating IP is listed all the time.\nSide note 3: The floating IP is working (ping, ssh), even if not displayed.\n\nOutput of 'select * from nova.instance_info_cache':\n\nInstance in Build/Spawning:\n*************************** 38. row ***************************\n   created_at: 2015-04-24 09:06:23\n   updated_at: 2015-04-24 09:06:43\n   deleted_at: NULL\n           id: 1671\n network_info: [{\"ovs_interfaceid\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"network\": {\"bridge\": \"br-int\", \"subnets\": [{\"ips\": [{\"meta\": {}, \"version\": 4, \"type\": \"fixed\", \"floating_ips\": [{\"meta\": {}, \"version\": 4, \"type\": \"floating\", \"address\": \"10.0.0.5\"}], \"address\": \"192.168.178.212\"}], \"version\": 4, \"meta\": {\"dhcp_server\": \"192.168.178.3\"}, \"dns\": [], \"routes\": [], \"cidr\": \"192.168.178.0/24\", \"gateway\": {\"meta\": {}, \"version\": 4, \"type\": \"gateway\", \"address\": \"192.168.178.1\"}}], \"meta\": {\"injected\": false, \"tenant_id\": \"ee8d0dd2202243389179ba2eb5a29e8c\"}, \"id\": \"276de287-a929-4263-aad5-3b30d6dcc8c9\", \"label\": \"neues-netz\"}, \"devname\": \"tapb2c284ea-ef\", \"qbh_params\": null, \"meta\": {}, \"details\": {\"port_filter\": true, \"ovs_hybrid_plug\": true}, \"address\": \"fa:16:3e:8a:32:19\", \"active\": false, \"type\": \"ovs\", \"id\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"qbg_params\": null}]\ninstance_uuid: f0d22419-1cac-47ce-9063-eee37fad97b9\n      deleted: 0\n\nInstance switches to Active/Running (\"floating_ips\" becomes empty):\n*************************** 38. row ***************************\n   created_at: 2015-04-24 09:06:23\n   updated_at: 2015-04-24 09:07:04\n   deleted_at: NULL\n           id: 1671\n network_info: [{\"ovs_interfaceid\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"network\": {\"bridge\": \"br-int\", \"subnets\": [{\"ips\": [{\"meta\": {}, \"version\": 4, \"type\": \"fixed\", \"floating_ips\": [], \"address\": \"192.168.178.212\"}], \"version\": 4, \"meta\": {\"dhcp_server\": \"192.168.178.3\"}, \"dns\": [], \"routes\": [], \"cidr\": \"192.168.178.0/24\", \"gateway\": {\"meta\": {}, \"version\": 4, \"type\": \"gateway\", \"address\": \"192.168.178.1\"}}], \"meta\": {\"injected\": false, \"tenant_id\": \"ee8d0dd2202243389179ba2eb5a29e8c\"}, \"id\": \"276de287-a929-4263-aad5-3b30d6dcc8c9\", \"label\": \"neues-netz\"}, \"devname\": \"tapb2c284ea-ef\", \"qbh_params\": null, \"meta\": {}, \"details\": {\"port_filter\": true, \"ovs_hybrid_plug\": true}, \"address\": \"fa:16:3e:8a:32:19\", \"active\": false, \"type\": \"ovs\", \"id\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"qbg_params\": null}]\ninstance_uuid: f0d22419-1cac-47ce-9063-eee37fad97b9\n      deleted: 0\n\nAfter ~ 40 minutes:\n*************************** 38. row ***************************\n  created_at: 2015-04-24 09:06:23\n   updated_at: 2015-04-24 09:45:35\n   deleted_at: NULL\n           id: 1671\n network_info: [{\"ovs_interfaceid\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"network\": {\"bridge\": \"br-int\", \"subnets\": [{\"ips\": [{\"meta\": {}, \"version\": 4, \"type\": \"fixed\", \"floating_ips\": [{\"meta\": {}, \"version\": 4, \"type\": \"floating\", \"address\": \"10.0.0.5\"}], \"address\": \"192.168.178.212\"}], \"version\": 4, \"meta\": {\"dhcp_server\": \"192.168.178.3\"}, \"dns\": [], \"routes\": [], \"cidr\": \"192.168.178.0/24\", \"gateway\": {\"meta\": {}, \"version\": 4, \"type\": \"gateway\", \"address\": \"192.168.178.1\"}}], \"meta\": {\"injected\": false, \"tenant_id\": \"ee8d0dd2202243389179ba2eb5a29e8c\"}, \"id\": \"276de287-a929-4263-aad5-3b30d6dcc8c9\", \"label\": \"neues-netz\"}, \"devname\": \"tapb2c284ea-ef\", \"qbh_params\": null, \"meta\": {}, \"details\": {\"port_filter\": true, \"ovs_hybrid_plug\": true}, \"address\": \"fa:16:3e:8a:32:19\", \"active\": true, \"type\": \"ovs\", \"id\": \"b2c284ea-ef23-42e1-9522-b263f24db588\", \"qbg_params\": null}]\ninstance_uuid: f0d22419-1cac-47ce-9063-eee37fad97b9\n      deleted: 0\n\nThe related part in nova-compute.log\n\n2015-04-24 11:07:04.544 14860 INFO nova.virt.libvirt.driver [-] [instance: f0d22419-1cac-47ce-9063-eee37fad97b9] Instance spawned successfully.\n[...]\n2015-04-24 11:45:36.012 14860 DEBUG nova.compute.manager [-] [instance: f0d22419-1cac-47ce-9063-eee37fad97b9] Updated the network info_cache for instance _heal_instance_info_cache /usr/lib/python2.7/dist-packages/nova/compute/manager.py:4897\n\n\nCurrent workaround:\n\nSetting 'heal_instance_info_cache_interval=1' in nova-compute.conf reduces the delay from 40 minutes to 2 minutes, but I guess setting that setting to '1' might be a problem in production.\n\nMaybe it could be possible to fire up the 'instance _heal_instance_info_cache' directly after an instance switches to Active/Running state.", 
            "date_created": "2015-04-24 09:57:06.172042+00:00", 
            "author": "https://api.launchpad.net/1.0/~haukebruno"
        }, 
        {
            "content": "Bug not reproducible on \"master\" branch", 
            "date_created": "2015-05-17 22:56:09.869162+00:00", 
            "author": "https://api.launchpad.net/1.0/~nilla"
        }, 
        {
            "content": "Could you provide information about flavor you have used? ", 
            "date_created": "2016-02-16 14:56:32.465460+00:00", 
            "author": "https://api.launchpad.net/1.0/~gstepanov"
        }, 
        {
            "content": "This issue is independet from the flavor, it happened to all instances/flavors/images.", 
            "date_created": "2016-02-23 02:34:19.698204+00:00", 
            "author": "https://api.launchpad.net/1.0/~haukebruno"
        }, 
        {
            "content": "Fix Released? is there a link to the fix?", 
            "date_created": "2016-09-15 07:44:54.996720+00:00", 
            "author": "https://api.launchpad.net/1.0/~darragh-oreilly"
        }
    ]
}