{
    "status": "Confirmed", 
    "last_updated": "2017-06-27 15:51:54.082048+00:00", 
    "description": "Description\n==========\nBoot an instance with FreeBSD image using OpenStack Liberty stable release\n\nSteps\n=====\nI downloaded a FreeBSD image from it's offical website and upload this image via glance.\nI tried to boot an instance with this image, but it will always fail at auto config disk, see xenapi/vm_utils.py: _auto_configure_disk()\n\nExpect:\n======\nBoot instance successfully\n\nActual:\n======\nFailed to boot instance\n\nLogs\n====\n\n2016-04-20 05:04:10.043 ERROR nova.utils [req-7f9d8900-a3c4-4e9e-93dc-cd71d7263895 demo demo] [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] Failed to spawn, rolling back\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] Traceback (most recent call last):\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 570, in _spawn\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] attach_devices_step(undo_mgr, vm_ref, vdis, disk_image_type)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 129, in inner\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] rv = f(*args, **kwargs)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 503, in attach_devices_step\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] attach_disks(undo_mgr, vm_ref, vdis, disk_image_type)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 450, in attach_disks\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] admin_password, injected_files)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 748, in _attach_disks\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] flavor.root_gb)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vm_utils.py\", line 926, in try_auto_configure_disk\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] _auto_configure_disk(session, vdi_ref, new_gb)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vm_utils.py\", line 904, in _auto_configure_disk\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] partitions = _get_partitions(dev)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vm_utils.py\", line 2197, in _get_partitions\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] num, start, end, size, fstype, name, flags = line.split(':')\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] ValueError: need more than 1 value to unpack\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055]\n\nWith some additional debug loggs added, you can see:\n2016-04-20 05:04:09.322 DEBUG nova.virt.xenapi.vm_utils [req-7f9d8900-a3c4-4e9e-93dc-cd71d7263895 demo demo]\nError: The backup GPT table is corrupt, but the primary appears OK, so that will be used.\nWarning: Not all of the space available to /dev/xvdb appears to be used, you can fix the GPT to use all of the space (an extra 18874001 blocks) or continue with the current setting? \nBYT;\n/dev/xvdb:62914560s:xvd:512:512:gpt:Xen Virtual Block Device;\n1:3s:170s:168s::bootfs:;\n2:171s:2097322s:2097152s::swapfs:;\n3:2097323s:44040362s:41943040s:freebsd-ufs:rootfs:;\n\nThis is because XenAPI driver doesn't support GPT partition tables currently", 
    "tags": [
        "openstack-version.liberty", 
        "xenserver"
    ], 
    "importance": "Medium", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1574531", 
    "owner": "None", 
    "id": 1574531, 
    "index": 4520, 
    "created": "2016-04-25 09:23:28.869320+00:00", 
    "title": "XenAPI does not support GPT partition table", 
    "comments": [
        {
            "content": "Description\n==========\nBoot an instance with FreeBSD image using OpenStack Liberty stable release\n\nSteps\n=====\nI downloaded a FreeBSD image from it's offical website and upload this image via glance.\nI tried to boot an instance with this image, but it will always fail at auto config disk, see xenapi/vm_utils.py: _auto_configure_disk()\n\nExpect:\n======\nBoot instance successfully\n\nActual:\n======\nFailed to boot instance\n\nLogs\n====\n\n2016-04-20 05:04:10.043 ERROR nova.utils [req-7f9d8900-a3c4-4e9e-93dc-cd71d7263895 demo demo] [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] Failed to spawn, rolling back\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] Traceback (most recent call last):\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 570, in _spawn\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] attach_devices_step(undo_mgr, vm_ref, vdis, disk_image_type)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 129, in inner\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] rv = f(*args, **kwargs)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 503, in attach_devices_step\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] attach_disks(undo_mgr, vm_ref, vdis, disk_image_type)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 450, in attach_disks\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] admin_password, injected_files)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vmops.py\", line 748, in _attach_disks\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] flavor.root_gb)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vm_utils.py\", line 926, in try_auto_configure_disk\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] _auto_configure_disk(session, vdi_ref, new_gb)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vm_utils.py\", line 904, in _auto_configure_disk\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] partitions = _get_partitions(dev)\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] File \"/opt/stack/nova/nova/virt/xenapi/vm_utils.py\", line 2197, in _get_partitions\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] num, start, end, size, fstype, name, flags = line.split(':')\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055] ValueError: need more than 1 value to unpack\n2016-04-20 05:04:10.043 TRACE nova.utils [instance: d970c4d0-c112-4b6e-b559-9f38e91c1055]\n\nWith some additional debug loggs added, you can see:\n2016-04-20 05:04:09.322 DEBUG nova.virt.xenapi.vm_utils [req-7f9d8900-a3c4-4e9e-93dc-cd71d7263895 demo demo]\nError: The backup GPT table is corrupt, but the primary appears OK, so that will be used.\nWarning: Not all of the space available to /dev/xvdb appears to be used, you can fix the GPT to use all of the space (an extra 18874001 blocks) or continue with the current setting? \nBYT;\n/dev/xvdb:62914560s:xvd:512:512:gpt:Xen Virtual Block Device;\n1:3s:170s:168s::bootfs:;\n2:171s:2097322s:2097152s::swapfs:;\n3:2097323s:44040362s:41943040s:freebsd-ufs:rootfs:;\n\nThis is because XenAPI driver doesn't support GPT partition tables currently", 
            "date_created": "2016-04-25 09:23:28.869320+00:00", 
            "author": "https://api.launchpad.net/1.0/~huan-xie"
        }, 
        {
            "content": "Automatically discovered version liberty in description. If this is incorrect, please update the description to include 'nova version: ...'", 
            "date_created": "2017-06-27 15:51:53.473231+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }
    ]
}