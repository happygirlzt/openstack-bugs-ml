{
    "status": "Invalid", 
    "last_updated": "2012-06-08 14:33:57.006902+00:00", 
    "description": "Essex-4\nUbuntu 12.04 Beta1\nAMD_64\n\nThe command below is listed as method for exporting auth from Nova to import to Keystone (http://keystone.openstack.org/configuration.html).\n\n```\n$ nova-manage export auth\n2012-03-05 20:11:09 DEBUG nova.utils [req-d8cdcac3-2107-402f-83ec-f0758af4a54c None None] backend <module 'nova.db.sqlalchemy.api' from '/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.pyc'> from (pid=11739) __get_backend /usr/lib/python2.7/dist-packages/nova/utils.py:609\nCommand failed, please check log for more info\n2012-03-05 20:11:09 CRITICAL nova [-] (ProgrammingError) (1146, \"Table 'nova.projects' doesn't exist\") 'SELECT projects.created_at AS projects_created_at, projects.updated_at AS projects_updated_at, projects.deleted_at AS projects_deleted_at, projects.deleted AS projects_deleted, projects.id AS projects_id, projects.name AS projects_name, projects.description AS projects_description, projects.project_manager AS projects_project_manager, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, users_1.deleted AS users_1_deleted, users_1.id AS users_1_id, users_1.name AS users_1_name, users_1.access_key AS users_1_access_key, users_1.secret_key AS users_1_secret_key, users_1.is_admin AS users_1_is_admin \\nFROM projects LEFT OUTER JOIN user_project_association AS user_project_association_1 ON projects.id = user_project_association_1.project_id LEFT OUTER JOIN users AS users_1 ON users_1.id = user_project_association_1.user_id \\nWHERE projects.deleted = %s' (0,)\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/bin/nova-manage\", line 2392, in <module>\n(nova): TRACE:     main()\n(nova): TRACE:   File \"/usr/bin/nova-manage\", line 2379, in main\n(nova): TRACE:     fn(*fn_args, **fn_kwargs)\n(nova): TRACE:   File \"/usr/bin/nova-manage\", line 2191, in auth\n(nova): TRACE:     print json.dumps(self._get_auth_data())\n(nova): TRACE:   File \"/usr/bin/nova-manage\", line 2220, in _get_auth_data\n(nova): TRACE:     for project in am.get_projects():\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/auth/manager.py\", line 557, in get_projects\n(nova): TRACE:     project_list = drv.get_projects(User.safe_id(user))\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/auth/dbdriver.py\", line 69, in get_projects\n(nova): TRACE:     result = db.project_get_all(context.get_admin_context())\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 1323, in project_get_all\n(nova): TRACE:     return IMPL.project_get_all(context)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 3158, in project_get_all\n(nova): TRACE:     options(joinedload_all('members')).\\\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 1947, in all\n(nova): TRACE:     return list(self)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2057, in __iter__\n(nova): TRACE:     return self._execute_and_instances(context)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2072, in _execute_and_instances\n(nova): TRACE:     result = conn.execute(querycontext.statement, self._params)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 1405, in execute\n(nova): TRACE:     params)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 1538, in _execute_clauseelement\n(nova): TRACE:     compiled_sql, distilled_params\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 1646, in _execute_context\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_context\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/default.py\", line 330, in do_execute\n(nova): TRACE:     cursor.execute(statement, parameters)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/MySQLdb/cursors.py\", line 174, in execute\n(nova): TRACE:     self.errorhandler(self, exc, value)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/MySQLdb/connections.py\", line 36, in defaulterrorhandler\n(nova): TRACE:     raise errorclass, errorvalue\n(nova): TRACE: ProgrammingError: (ProgrammingError) (1146, \"Table 'nova.projects' doesn't exist\") 'SELECT projects.created_at AS projects_created_at, projects.updated_at AS projects_updated_at, projects.deleted_at AS projects_deleted_at, projects.deleted AS projects_deleted, projects.id AS projects_id, projects.name AS projects_name, projects.description AS projects_description, projects.project_manager AS projects_project_manager, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, users_1.deleted AS users_1_deleted, users_1.id AS users_1_id, users_1.name AS users_1_name, users_1.access_key AS users_1_access_key, users_1.secret_key AS users_1_secret_key, users_1.is_admin AS users_1_is_admin \\nFROM projects LEFT OUTER JOIN user_project_association AS user_project_association_1 ON projects.id = user_project_association_1.project_id LEFT OUTER JOIN users AS users_1 ON users_1.id = user_project_association_1.user_id \\nWHERE projects.deleted = %s' (0,)\n(nova): TRACE:\n```\n\n{{{\nmysql> show tables;\n+-------------------------------------+\n| Tables_in_nova                      |\n+-------------------------------------+\n| agent_builds                        |\n| aggregate_hosts                     |\n| aggregate_metadata                  |\n| aggregates                          |\n| auth_tokens                         |\n| block_device_mapping                |\n| bw_usage_cache                      |\n| cells                               |\n| certificates                        |\n| compute_nodes                       |\n| console_pools                       |\n| consoles                            |\n| dns_domains                         |\n| fixed_ips                           |\n| floating_ips                        |\n| instance_actions                    |\n| instance_faults                     |\n| instance_info_caches                |\n| instance_metadata                   |\n| instance_type_extra_specs           |\n| instance_types                      |\n| instances                           |\n| iscsi_targets                       |\n| key_pairs                           |\n| migrate_version                     |\n| migrations                          |\n| networks                            |\n| projects                            |\n| provider_fw_rules                   |\n| quotas                              |\n| s3_images                           |\n| security_group_instance_association |\n| security_group_rules                |\n| security_groups                     |\n| services                            |\n| sm_backend_config                   |\n| sm_flavors                          |\n| sm_volume                           |\n| snapshots                           |\n| user_project_association            |\n| user_project_role_association       |\n| user_role_association               |\n| users                               |\n| virtual_interfaces                  |\n| virtual_storage_arrays              |\n| volume_metadata                     |\n| volume_type_extra_specs             |\n| volume_types                        |\n| volumes                             |\n+-------------------------------------+\n49 rows in set (0.00 sec)\n}}}", 
    "tags": [
        "canonistack"
    ], 
    "importance": "Undecided", 
    "heat": 20, 
    "link": "https://bugs.launchpad.net/nova/+bug/947648", 
    "owner": "None", 
    "id": 947648, 
    "index": 2658, 
    "created": "2012-03-06 01:19:03.103998+00:00", 
    "title": "SQL error on 'nova-manage export auth'", 
    "comments": [
        {
            "content": "Essex-4 \nUbuntu 12.04 Beta1\nAMD_64\n<pre>\n nova-manage export auth \n2012-03-05 20:11:09 DEBUG nova.utils [req-d8cdcac3-2107-402f-83ec-f0758af4a54c None None] backend <module 'nova.db.sqlalchemy.api' from '/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.pyc'> from (pid=11739) __get_backend /usr/lib/python2.7/dist-packages/nova/utils.py:609\nCommand failed, please check log for more info\n2012-03-05 20:11:09 CRITICAL nova [-] (ProgrammingError) (1146, \"Table 'nova.projects' doesn't exist\") 'SELECT projects.created_at AS projects_created_at, projects.updated_at AS projects_updated_at, projects.deleted_at AS projects_deleted_at, projects.deleted AS projects_deleted, projects.id AS projects_id, projects.name AS projects_name, projects.description AS projects_description, projects.project_manager AS projects_project_manager, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, users_1.deleted AS users_1_deleted, users_1.id AS users_1_id, users_1.name AS users_1_name, users_1.access_key AS users_1_access_key, users_1.secret_key AS users_1_secret_key, users_1.is_admin AS users_1_is_admin \\nFROM projects LEFT OUTER JOIN user_project_association AS user_project_association_1 ON projects.id = user_project_association_1.project_id LEFT OUTER JOIN users AS users_1 ON users_1.id = user_project_association_1.user_id \\nWHERE projects.deleted = %s' (0,)\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/bin/nova-manage\", line 2392, in <module>\n(nova): TRACE:     main()\n(nova): TRACE:   File \"/usr/bin/nova-manage\", line 2379, in main\n(nova): TRACE:     fn(*fn_args, **fn_kwargs)\n(nova): TRACE:   File \"/usr/bin/nova-manage\", line 2191, in auth\n(nova): TRACE:     print json.dumps(self._get_auth_data())\n(nova): TRACE:   File \"/usr/bin/nova-manage\", line 2220, in _get_auth_data\n(nova): TRACE:     for project in am.get_projects():\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/auth/manager.py\", line 557, in get_projects\n(nova): TRACE:     project_list = drv.get_projects(User.safe_id(user))\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/auth/dbdriver.py\", line 69, in get_projects\n(nova): TRACE:     result = db.project_get_all(context.get_admin_context())\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 1323, in project_get_all\n(nova): TRACE:     return IMPL.project_get_all(context)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 3158, in project_get_all\n(nova): TRACE:     options(joinedload_all('members')).\\\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 1947, in all\n(nova): TRACE:     return list(self)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2057, in __iter__\n(nova): TRACE:     return self._execute_and_instances(context)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2072, in _execute_and_instances\n(nova): TRACE:     result = conn.execute(querycontext.statement, self._params)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 1405, in execute\n(nova): TRACE:     params)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 1538, in _execute_clauseelement\n(nova): TRACE:     compiled_sql, distilled_params\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 1646, in _execute_context\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 1639, in _execute_context\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/default.py\", line 330, in do_execute\n(nova): TRACE:     cursor.execute(statement, parameters)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/MySQLdb/cursors.py\", line 174, in execute\n(nova): TRACE:     self.errorhandler(self, exc, value)\n(nova): TRACE:   File \"/usr/lib/python2.7/dist-packages/MySQLdb/connections.py\", line 36, in defaulterrorhandler\n(nova): TRACE:     raise errorclass, errorvalue\n(nova): TRACE: ProgrammingError: (ProgrammingError) (1146, \"Table 'nova.projects' doesn't exist\") 'SELECT projects.created_at AS projects_created_at, projects.updated_at AS projects_updated_at, projects.deleted_at AS projects_deleted_at, projects.deleted AS projects_deleted, projects.id AS projects_id, projects.name AS projects_name, projects.description AS projects_description, projects.project_manager AS projects_project_manager, users_1.created_at AS users_1_created_at, users_1.updated_at AS users_1_updated_at, users_1.deleted_at AS users_1_deleted_at, users_1.deleted AS users_1_deleted, users_1.id AS users_1_id, users_1.name AS users_1_name, users_1.access_key AS users_1_access_key, users_1.secret_key AS users_1_secret_key, users_1.is_admin AS users_1_is_admin \\nFROM projects LEFT OUTER JOIN user_project_association AS user_project_association_1 ON projects.id = user_project_association_1.project_id LEFT OUTER JOIN users AS users_1 ON users_1.id = user_project_association_1.user_id \\nWHERE projects.deleted = %s' (0,)\n(nova): TRACE:\n</pre>", 
            "date_created": "2012-03-06 01:19:03.103998+00:00", 
            "author": "https://api.launchpad.net/1.0/~aimonb"
        }, 
        {
            "content": "Appears this is actually a corrupt table in DB, not an issue with sqlalchemy... I will close this and reopen if I find out otherwise. ", 
            "date_created": "2012-03-06 01:51:26.003108+00:00", 
            "author": "https://api.launchpad.net/1.0/~aimonb"
        }, 
        {
            "content": "How did you solve the problem for you? I ran into this and dropped the DB. After recreating the DB and populating it with \"nova-manage db sync\" everything worked fine, but after a reboot the table was again corrupted.", 
            "date_created": "2012-04-20 09:17:16.647084+00:00", 
            "author": "https://api.launchpad.net/1.0/~mx-chilly"
        }, 
        {
            "content": "This may be related to https://bugs.launchpad.net/nova/+bug/993663", 
            "date_created": "2012-06-08 14:33:56.262731+00:00", 
            "author": "https://api.launchpad.net/1.0/~aglenyoung"
        }
    ]
}