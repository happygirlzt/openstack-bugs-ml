{
    "status": "Fix Released", 
    "last_updated": "2014-04-17 08:52:25.596193+00:00", 
    "description": "The agent API has some parameters, but they are not validated.\nEach parameter is stored to the table \"agent_builds\", and each column is defined as varchar(255).\n\nmysql> desc agent_builds;\n    +--------------+--------------+------+-----+---------+----------------+\n    | Field        | Type         | Null | Key | Default | Extra          |\n    +--------------+--------------+------+-----+---------+----------------+\n    | created_at   | datetime     | YES  |     | NULL    |                |\n    | updated_at   | datetime     | YES  |     | NULL    |                |\n    | deleted_at   | datetime     | YES  |     | NULL    |                |\n    | id           | int(11)      | NO   | PRI | NULL    | auto_increment |\n    | hypervisor   | varchar(255) | YES  | MUL | NULL    |                |\n    | os           | varchar(255) | YES  |     | NULL    |                |\n    | architecture | varchar(255) | YES  |     | NULL    |                |\n    | version      | varchar(255) | YES  |     | NULL    |                |\n    | url          | varchar(255) | YES  |     | NULL    |                |\n    | md5hash      | varchar(255) | YES  |     | NULL    |                |\n    | deleted      | int(11)      | YES  |     | NULL    |                |\n    +--------------+--------------+------+-----+---------+----------------+\n\nDue to this fact, if specifying very long characters as a parameter, the stored data is truncated like the following:\n\n$ nova agent-create os arch 1 url hash 0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789\n[..]\n$\n$ $ nova agent-list\n+----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----+--------------+---------+---------+-----+\n| Agent_id | Hypervisor                                                                                                                                                                                                                                                      | OS | Architecture | Version | Md5hash | Url |\n+----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----+--------------+---------+---------+-----+\n| 1        | 012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234 | os | arch         | 1       | hash    | url |\n+----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----+--------------+---------+---------+-----+\n$\n\nso the parameters should be validated before storing to DB.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1240458", 
    "owner": "https://api.launchpad.net/1.0/~oomichi", 
    "id": 1240458, 
    "index": 4193, 
    "created": "2013-10-16 10:32:49.606798+00:00", 
    "title": "should validate the parameters of agent API", 
    "comments": [
        {
            "content": "The agent API has some parameters, but they are not validated.\nEach parameter is stored to the table \"agent_builds\", and each column is defined as varchar(255).\n\nmysql> desc agent_builds;\n    +--------------+--------------+------+-----+---------+----------------+\n    | Field        | Type         | Null | Key | Default | Extra          |\n    +--------------+--------------+------+-----+---------+----------------+\n    | created_at   | datetime     | YES  |     | NULL    |                |\n    | updated_at   | datetime     | YES  |     | NULL    |                |\n    | deleted_at   | datetime     | YES  |     | NULL    |                |\n    | id           | int(11)      | NO   | PRI | NULL    | auto_increment |\n    | hypervisor   | varchar(255) | YES  | MUL | NULL    |                |\n    | os           | varchar(255) | YES  |     | NULL    |                |\n    | architecture | varchar(255) | YES  |     | NULL    |                |\n    | version      | varchar(255) | YES  |     | NULL    |                |\n    | url          | varchar(255) | YES  |     | NULL    |                |\n    | md5hash      | varchar(255) | YES  |     | NULL    |                |\n    | deleted      | int(11)      | YES  |     | NULL    |                |\n    +--------------+--------------+------+-----+---------+----------------+\n\nDue to this fact, if specifying very long characters as a parameter, the stored data is truncated like the following:\n\n$ nova agent-create os arch 1 url hash 0123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789\n[..]\n$\n$ $ nova agent-list\n+----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----+--------------+---------+---------+-----+\n| Agent_id | Hypervisor                                                                                                                                                                                                                                                      | OS | Architecture | Version | Md5hash | Url |\n+----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----+--------------+---------+---------+-----+\n| 1        | 012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234567890123456789012345678901234 | os | arch         | 1       | hash    | url |\n+----------+-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+----+--------------+---------+---------+-----+\n$\n\nso the parameters should be validated before storing to DB.", 
            "date_created": "2013-10-16 10:32:49.606798+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/52054", 
            "date_created": "2013-10-16 10:36:13.224968+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/52054\nCommitted: http://github.com/openstack/nova/commit/de7321d53fb4a2c01e5fbccbec1954c00ef363d6\nSubmitter: Jenkins\nBranch:    master\n\ncommit de7321d53fb4a2c01e5fbccbec1954c00ef363d6\nAuthor: Ken'ichi Ohmichi <email address hidden>\nDate:   Wed Oct 16 19:29:22 2013 +0900\n\n    Validate parameters of agent API\n    \n    The agent API has some parameters, but they are not validated.\n    Each parameter is stored to the table \"agent_builds\", and each column\n    is defined as varchar(255).\n    \n    mysql> desc agent_builds;\n    +--------------+--------------+------+-----+---------+----------------+\n    | Field        | Type         | Null | Key | Default | Extra          |\n    +--------------+--------------+------+-----+---------+----------------+\n    | created_at   | datetime     | YES  |     | NULL    |                |\n    | updated_at   | datetime     | YES  |     | NULL    |                |\n    | deleted_at   | datetime     | YES  |     | NULL    |                |\n    | id           | int(11)      | NO   | PRI | NULL    | auto_increment |\n    | hypervisor   | varchar(255) | YES  | MUL | NULL    |                |\n    | os           | varchar(255) | YES  |     | NULL    |                |\n    | architecture | varchar(255) | YES  |     | NULL    |                |\n    | version      | varchar(255) | YES  |     | NULL    |                |\n    | url          | varchar(255) | YES  |     | NULL    |                |\n    | md5hash      | varchar(255) | YES  |     | NULL    |                |\n    | deleted      | int(11)      | YES  |     | NULL    |                |\n    +--------------+--------------+------+-----+---------+----------------+\n    \n    This patch adds the validation with the type and the length.\n    \n    Closes-Bug: 1240458\n    \n    Change-Id: Id06235ebde62f7b96c55b0bd2be5d941bfd2e999\n", 
            "date_created": "2013-10-23 00:04:12.578797+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}