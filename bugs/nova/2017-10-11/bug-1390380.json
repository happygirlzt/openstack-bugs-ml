{
    "status": "Invalid", 
    "last_updated": "2015-02-09 01:32:56.135778+00:00", 
    "description": "when creating a new instance given the instance as a Chinese name.\nnova compute failed to create with error message\n\n2014-11-07 16:49:58.105 TRACE nova.compute.manager [instance: 57557a92-9331-4608-a3bf-324c2dd7f2ec]     % domain.XMLDesc(0)\n2014-11-07 16:49:58.105 TRACE nova.compute.manager [instance: 57557a92-9331-4608-a3bf-324c2dd7f2ec] UnicodeDecodeError: 'ascii' codec can't decode byte 0xe6 in position 251: ordinal not in range(128)\n\nwe need to restrict it from nova-api layer or, we need to handle this in libvirt driver\n\ndomain xml is below:\n\n2014-11-07 16:49:58.104 ERROR nova.virt.libvirt.driver [-] Error defining a domain with XML: <domain type=\"kvm\">\n  <uuid>57557a92-9331-4608-a3bf-324c2dd7f2ec</uuid>\n  <name>instance-000002a1</name>\n  <memory>65536</memory>\n  <vcpu cpuset=\"0-5,12-17\">1</vcpu>\n  <metadata>\n    <nova:instance xmlns:nova=\"http://openstack.org/xmlns/libvirt/nova/1.0\">\n      <nova:package version=\"2014.2\"/>\n      <nova:name>&#27979;&#35797;</nova:name> <<<<<<<<----------------------- '\u6d4b\u8bd5'\n      <nova:creationTime>2014-11-07 08:49:56</nova:creationTime>\n      <nova:flavor name=\"m1.nano\">\n        <nova:memory>64</nova:memory>\n        <nova:disk>0</nova:disk>\n        <nova:swap>0</nova:swap>\n        <nova:ephemeral>0</nova:ephemeral>\n        <nova:vcpus>1</nova:vcpus>\n      </nova:flavor>\n      <nova:owner>\n        <nova:user uuid=\"fba8a67b69004320b2ace0b35aeebb18\">admin</nova:user>\n        <nova:project uuid=\"d7beb7f28e0b4f41901215000339361d\">admin</nova:project>\n      </nova:owner>\n      <nova:root type=\"image\" uuid=\"44c37b90-0ec3-460a-bdf2-bd8bb98c9fdf\"/>\n    </nova:instance>\n  </metadata>\n  <sysinfo type=\"smbios\">\n    <system>\n      <entry name=\"manufacturer\">OpenStack Foundation</entry>\n      <entry name=\"product\">OpenStack Nova</entry>\n      <entry name=\"version\">2014.2</entry>\n      <entry name=\"serial\">24cbc683-3b5c-4b3a-be40-5661739c9352</entry>\n      <entry name=\"uuid\">57557a92-9331-4608-a3bf-324c2dd7f2ec</entry>\n    </system>\n  </sysinfo>", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1390380", 
    "owner": "https://api.launchpad.net/1.0/~taget-9", 
    "id": 1390380, 
    "index": 5263, 
    "created": "2014-11-07 09:23:03.813888+00:00", 
    "title": "'ascii' codec can't decode when create a instance", 
    "comments": [
        {
            "content": "when creating a new instance given the instance as a Chinese name.\nnova compute failed to create with error message\n\n2014-11-07 16:49:58.105 TRACE nova.compute.manager [instance: 57557a92-9331-4608-a3bf-324c2dd7f2ec]     % domain.XMLDesc(0)\n2014-11-07 16:49:58.105 TRACE nova.compute.manager [instance: 57557a92-9331-4608-a3bf-324c2dd7f2ec] UnicodeDecodeError: 'ascii' codec can't decode byte 0xe6 in position 251: ordinal not in range(128)\n\nwe need to restrict it from nova-api layer or, we need to handle this in libvirt driver\n\ndomain xml is below:\n\n2014-11-07 16:49:58.104 ERROR nova.virt.libvirt.driver [-] Error defining a domain with XML: <domain type=\"kvm\">\n  <uuid>57557a92-9331-4608-a3bf-324c2dd7f2ec</uuid>\n  <name>instance-000002a1</name>\n  <memory>65536</memory>\n  <vcpu cpuset=\"0-5,12-17\">1</vcpu>\n  <metadata>\n    <nova:instance xmlns:nova=\"http://openstack.org/xmlns/libvirt/nova/1.0\">\n      <nova:package version=\"2014.2\"/>\n      <nova:name>&#27979;&#35797;</nova:name> <<<<<<<<----------------------- '\u6d4b\u8bd5'\n      <nova:creationTime>2014-11-07 08:49:56</nova:creationTime>\n      <nova:flavor name=\"m1.nano\">\n        <nova:memory>64</nova:memory>\n        <nova:disk>0</nova:disk>\n        <nova:swap>0</nova:swap>\n        <nova:ephemeral>0</nova:ephemeral>\n        <nova:vcpus>1</nova:vcpus>\n      </nova:flavor>\n      <nova:owner>\n        <nova:user uuid=\"fba8a67b69004320b2ace0b35aeebb18\">admin</nova:user>\n        <nova:project uuid=\"d7beb7f28e0b4f41901215000339361d\">admin</nova:project>\n      </nova:owner>\n      <nova:root type=\"image\" uuid=\"44c37b90-0ec3-460a-bdf2-bd8bb98c9fdf\"/>\n    </nova:instance>\n  </metadata>\n  <sysinfo type=\"smbios\">\n    <system>\n      <entry name=\"manufacturer\">OpenStack Foundation</entry>\n      <entry name=\"product\">OpenStack Nova</entry>\n      <entry name=\"version\">2014.2</entry>\n      <entry name=\"serial\">24cbc683-3b5c-4b3a-be40-5661739c9352</entry>\n      <entry name=\"uuid\">57557a92-9331-4608-a3bf-324c2dd7f2ec</entry>\n    </system>\n  </sysinfo>", 
            "date_created": "2014-11-07 09:23:03.813888+00:00", 
            "author": "https://api.launchpad.net/1.0/~taget-9"
        }, 
        {
            "content": "After some investigation\nI find that the exception happened here.\n\ndomain.XMLDesc(0) is a str, it contains :\n\n <nova:name>\\xe6\\xb5\\x8b\\xe8\\xaf\\x95</nova:name>\\n \n\nbut _LE can not handle this , even I try to decode this domain.XMLDesc(0)  to utf8\n\n                err = _LE('Error enabling hairpin mode with XML: %s') \\\n                          % domain.XMLDesc(0)\n\n2014-11-11 17:20:17.063 TRACE nova.compute.manager [instance: cd714cf2-e4ce-4563-a103-9deaf76a4e25]     six.reraise(self.type_, self.value, self.tb)\n2014-11-11 17:20:17.063 TRACE nova.compute.manager [instance: cd714cf2-e4ce-4563-a103-9deaf76a4e25]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 4342, in _create_domain\n2014-11-11 17:20:17.063 TRACE nova.compute.manager [instance: cd714cf2-e4ce-4563-a103-9deaf76a4e25]     err = _LE(err_msg)\n2014-11-11 17:20:17.063 TRACE nova.compute.manager [instance: cd714cf2-e4ce-4563-a103-9deaf76a4e25]   File \"/usr/lib/python2.7/site-packages/oslo/i18n/_factory.py\", line 81, in f\n2014-11-11 17:20:17.063 TRACE nova.compute.manager [instance: cd714cf2-e4ce-4563-a103-9deaf76a4e25]     return m(msg)\n2014-11-11 17:20:17.063 TRACE nova.compute.manager [instance: cd714cf2-e4ce-4563-a103-9deaf76a4e25]   File \"/usr/lib64/python2.7/gettext.py\", line 220, in ugettext\n2014-11-11 17:20:17.063 TRACE nova.compute.manager [instance: cd714cf2-e4ce-4563-a103-9deaf76a4e25]     return unicode(message)\n2014-11-11 17:20:17.063 TRACE nova.compute.manager [instance: cd714cf2-e4ce-4563-a103-9deaf76a4e25] UnicodeDecodeError: 'ascii' codec can't decode byte 0xe6 in position 289: ordinal not in range(128)\n\n\n", 
            "date_created": "2014-11-11 09:39:45.931205+00:00", 
            "author": "https://api.launchpad.net/1.0/~taget-9"
        }, 
        {
            "content": "a fix found \ncommit 60c90f73261efb8c73ecc02152307c81265cab13\nAuthor: Rick Harris <email address hidden>\nDate:   Tue Jun 24 14:03:17 2014 -0500\n\n    libvirt+lxc: Unmount guest FS from host on error\n    \n    If an error occurs during `_create_domain`, we need to ensure that the guest's\n    FS is unmounted from the host in all cases.\n    \n    This is necessary because, if we leave the FS mounted to the host, the\n    `lvremove` triggered by `delete` won't work because the filesystem will\n    'still be in use'.\n    \n    The solution is to wrap the code in a `try/finally` to ensure the cleanup\n    routines (which unmount) are always called.\n    \n    Change-Id: If863cf813dddc1e4554fb87b945c68b75b25f9a2\n    Closes-Bug: 1333827\n", 
            "date_created": "2014-11-11 10:15:15.296821+00:00", 
            "author": "https://api.launchpad.net/1.0/~taget-9"
        }, 
        {
            "content": "Is the i18n aspect actually fixed? Looks like the fix referenced only ensures that cleanup really happens...", 
            "date_created": "2015-02-09 01:32:55.289385+00:00", 
            "author": "https://api.launchpad.net/1.0/~lifeless"
        }
    ]
}