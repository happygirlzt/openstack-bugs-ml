{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:27:39.327278+00:00", 
    "description": "Description of problem:\n\nnova root-password fails and does not return error\n\n[root@camel-nova ~]# nova root-password 47007d89-6d71-4cbf-98cb-add14145fda2\nNew password: \nAgain: \n[root@camel-nova ~]# echo $?\n0\n\ncompute.log:\n\n2012-07-10 15:51:47 DEBUG nova.rpc.amqp [-] received {u'_context_roles': [u'admin'], u'_context_request_id': u'req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d', u'_context_read_deleted\n': u'no', u'args': {u'instance_uuid': u'47007d89-6d71-4cbf-98cb-add14145fda2', u'new_pass': '<SANITIZED>'}, u'_context_auth_token': '<SANITIZED>', u'_context_is_admin': True, u'\n_context_project_id': u'3f1e394b238d4f26b742e9685a9a1a57', u'_context_timestamp': u'2012-07-10T12:51:47.350078', u'_context_user_id': u'29af43364ced4611bf6e093a04d4c144', u'meth\nod': u'set_admin_password', u'_context_remote_address': u'1.1.1.2'} from (pid=16497) _safe_log /usr/lib/python2.6/site-packages/nova/rpc/common.py:160\n2012-07-10 15:51:47 DEBUG nova.rpc.amqp [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] unpacked context: {'user_id'\n: u'29af43364ced4611bf6e093a04d4c144', 'roles': [u'admin'], 'timestamp': '2012-07-10T12:51:47.350078', 'auth_token': '<SANITIZED>', 'remote_address': u'10.35.97.20', 'is_admin':\n True, 'request_id': u'req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d', 'project_id': u'3f1e394b238d4f26b742e9685a9a1a57', 'read_deleted': u'no'} from (pid=16497) _safe_log /usr/lib/p\nython2.6/site-packages/nova/rpc/common.py:160\n2012-07-10 15:51:47 INFO nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] check_instance_lock: d\necorating: |<function set_admin_password at 0x20f38c0>|\n2012-07-10 15:51:47 INFO nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] check_instance_lock: a\nrguments: |<nova.compute.manager.ComputeManager object at 0x1f67190>| |<nova.rpc.amqp.RpcContext object at 0x40c9910>| |47007d89-6d71-4cbf-98cb-add14145fda2|\n2012-07-10 15:51:47 DEBUG nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] instance 47007d89-6d7\n1-4cbf-98cb-add14145fda2: getting locked state from (pid=16497) get_lock /usr/lib/python2.6/site-packages/nova/compute/manager.py:1609\n2012-07-10 15:51:47 INFO nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] check_instance_lock: l\nocked: |False|\n2012-07-10 15:51:47 INFO nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] check_instance_lock: a\ndmin: |True|\n2012-07-10 15:51:47 INFO nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] check_instance_lock: e\nxecuting: |<function set_admin_password at 0x20f38c0>|\n2012-07-10 15:51:47 DEBUG nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] [instance: 47007d89-6\nd71-4cbf-98cb-add14145fda2] Checking state from (pid=16497) _get_power_state /usr/lib/python2.6/site-packages/nova/compute/manager.py:272\n2012-07-10 15:51:48 WARNING nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] set_admin_password \nis not implemented by this driver.\n\napi.log:\n2012-07-10 15:51:47 INFO nova.api.openstack.wsgi [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] POST http://camel-nova:8774/v1.1/3f1e394b238d4f26b742e9685a9a1a57/servers/47007d89-6d71-4cbf-98cb-add14145fda2/action\n2012-07-10 15:51:47 DEBUG nova.rpc.amqp [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] Making asynchronous cast on compute.camel-vdsa.. from (pid=5531) cast /usr/lib/python2.6/site-packages/nova/rpc/amqp.py:351\n2012-07-10 15:51:47 INFO nova.api.openstack.wsgi [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] http://camel-novacom:8774/v1.1/3f1e394b238d4f26b742e9685a9a1a57/servers/47007d89-6d71-4cbf-98cb-add14145fda2/action returned with HTTP 202\n\nconsider changing the message exchange pattern from cast to call", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1022961", 
    "owner": "https://api.launchpad.net/1.0/~eglynn", 
    "id": 1022961, 
    "index": 2964, 
    "created": "2012-07-10 12:58:55.989217+00:00", 
    "title": "[novaclient] root-password fails and does not return error", 
    "comments": [
        {
            "content": "Description of problem:\n\nnova root-password fails and does not return error\n\n[root@camel-nova ~]# nova root-password 47007d89-6d71-4cbf-98cb-add14145fda2\nNew password: \nAgain: \n[root@camel-nova ~]# echo $?\n0\n\ncompute.log:\n\n2012-07-10 15:51:47 DEBUG nova.rpc.amqp [-] received {u'_context_roles': [u'admin'], u'_context_request_id': u'req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d', u'_context_read_deleted\n': u'no', u'args': {u'instance_uuid': u'47007d89-6d71-4cbf-98cb-add14145fda2', u'new_pass': '<SANITIZED>'}, u'_context_auth_token': '<SANITIZED>', u'_context_is_admin': True, u'\n_context_project_id': u'3f1e394b238d4f26b742e9685a9a1a57', u'_context_timestamp': u'2012-07-10T12:51:47.350078', u'_context_user_id': u'29af43364ced4611bf6e093a04d4c144', u'meth\nod': u'set_admin_password', u'_context_remote_address': u'1.1.1.2'} from (pid=16497) _safe_log /usr/lib/python2.6/site-packages/nova/rpc/common.py:160\n2012-07-10 15:51:47 DEBUG nova.rpc.amqp [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] unpacked context: {'user_id'\n: u'29af43364ced4611bf6e093a04d4c144', 'roles': [u'admin'], 'timestamp': '2012-07-10T12:51:47.350078', 'auth_token': '<SANITIZED>', 'remote_address': u'10.35.97.20', 'is_admin':\n True, 'request_id': u'req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d', 'project_id': u'3f1e394b238d4f26b742e9685a9a1a57', 'read_deleted': u'no'} from (pid=16497) _safe_log /usr/lib/p\nython2.6/site-packages/nova/rpc/common.py:160\n2012-07-10 15:51:47 INFO nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] check_instance_lock: d\necorating: |<function set_admin_password at 0x20f38c0>|\n2012-07-10 15:51:47 INFO nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] check_instance_lock: a\nrguments: |<nova.compute.manager.ComputeManager object at 0x1f67190>| |<nova.rpc.amqp.RpcContext object at 0x40c9910>| |47007d89-6d71-4cbf-98cb-add14145fda2|\n2012-07-10 15:51:47 DEBUG nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] instance 47007d89-6d7\n1-4cbf-98cb-add14145fda2: getting locked state from (pid=16497) get_lock /usr/lib/python2.6/site-packages/nova/compute/manager.py:1609\n2012-07-10 15:51:47 INFO nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] check_instance_lock: l\nocked: |False|\n2012-07-10 15:51:47 INFO nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] check_instance_lock: a\ndmin: |True|\n2012-07-10 15:51:47 INFO nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] check_instance_lock: e\nxecuting: |<function set_admin_password at 0x20f38c0>|\n2012-07-10 15:51:47 DEBUG nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] [instance: 47007d89-6\nd71-4cbf-98cb-add14145fda2] Checking state from (pid=16497) _get_power_state /usr/lib/python2.6/site-packages/nova/compute/manager.py:272\n2012-07-10 15:51:48 WARNING nova.compute.manager [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] set_admin_password \nis not implemented by this driver.\n\napi.log:\n2012-07-10 15:51:47 INFO nova.api.openstack.wsgi [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] POST http://camel-nova:8774/v1.1/3f1e394b238d4f26b742e9685a9a1a57/servers/47007d89-6d71-4cbf-98cb-add14145fda2/action\n2012-07-10 15:51:47 DEBUG nova.rpc.amqp [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] Making asynchronous cast on compute.camel-vdsa.. from (pid=5531) cast /usr/lib/python2.6/site-packages/nova/rpc/amqp.py:351\n2012-07-10 15:51:47 INFO nova.api.openstack.wsgi [req-a9d3ee4a-5b67-4eef-aa07-3a2fd704239d 29af43364ced4611bf6e093a04d4c144 3f1e394b238d4f26b742e9685a9a1a57] http://camel-novacom:8774/v1.1/3f1e394b238d4f26b742e9685a9a1a57/servers/47007d89-6d71-4cbf-98cb-add14145fda2/action returned with HTTP 202\n\nconsider changing the message exchange pattern from cast to call", 
            "date_created": "2012-07-10 12:58:55.989217+00:00", 
            "author": "https://api.launchpad.net/1.0/~davidnaori3"
        }, 
        {
            "content": "This is due to nova.compute.api.set_admin_password() making a oneway RPC cast to effect the attempted password change on the compute node, but then returning a 202 Accepted status immediately.\n\nAs such, it's a symptom of a wider problem that impacts on many asynchronous nova APIs, in that there is no concept of a task identifier that can be later queried for progress or a definite outcome.\n\nThis has been discussed previously on the upstream ML:\n\n   https://lists.launchpad.net/openstack/msg13774.html\n\nbut is obviously out-of-scope for a fix on stable/essex.\n\nHowever, it would not be considered an RPC backward-compat breaking change to alter the message exchange pattern from oneway to request-response for this individual message type. So that approach would be possible to get into stable/essex.", 
            "date_created": "2012-07-10 19:34:35.594246+00:00", 
            "author": "https://api.launchpad.net/1.0/~eglynn"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/10130", 
            "date_created": "2012-07-23 13:55:56.666099+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/essex\nReview: https://review.openstack.org/10135", 
            "date_created": "2012-07-23 15:36:36.622092+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Requires this tempest change: https://review.openstack.org/#/c/10216/", 
            "date_created": "2012-07-24 19:30:08.487455+00:00", 
            "author": "https://api.launchpad.net/1.0/~markmc"
        }, 
        {
            "content": "Tempest change has landed:\n\n  https://github.com/openstack/tempest/commit/f97d5fdc ", 
            "date_created": "2012-08-01 13:18:05.687644+00:00", 
            "author": "https://api.launchpad.net/1.0/~eglynn"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/10130\nCommitted: http://github.com/openstack/nova/commit/3ab808b23d17900cc859b75895ac1c7a8f2d7bb9\nSubmitter: Jenkins\nBranch:    master\n\ncommit 3ab808b23d17900cc859b75895ac1c7a8f2d7bb9\nAuthor: Eoghan Glynn <email address hidden>\nDate:   Mon Jul 23 12:25:43 2012 +0000\n\n    Setting root passwd no longer fails silently.\n    \n    Fixes LP 1022961\n    \n    Previously an attempt to set the root password would fail silently if\n    for example the driver did not support this action.\n    \n    To avoid the user being misled that the password change had succeeded,\n    we now report any failure by changing the MEP for set_admin_password\n    RPC from cast to call.\n    \n    Change-Id: I1fd7b925e9226d30892f3a7cc4ddb938ff678a55\n", 
            "date_created": "2012-08-01 15:01:01.899991+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}