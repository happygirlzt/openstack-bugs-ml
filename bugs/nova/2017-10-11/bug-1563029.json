{
    "status": "Invalid", 
    "last_updated": "2016-11-12 16:00:10.986785+00:00", 
    "description": "This is a Kolla installation of openstack. The docker images build well and some services work great; e.g cinder, glance and neutron. \n\nNova seems to have a problem that is prevent provisioning instances. The manila-api logs below says:\n\n\"Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'oslo_messaging.exceptions.MessagingTimeout'> __call__ /usr/lib/python2.7/site-packages/nova/api/openstack/wsgi.py:1070\"\n\n\n\n1. The GIT commit level is:\n\nlsorrillo@ptest:~/git/kolla$ git log -1\ncommit 90321d0497f14bda370908610cfc44296a940523\nMerge: 328a7e8 a789346\nAuthor: Jenkins <email address hidden>\nDate:   Sun Mar 27 23:42:47 2016 +0000\n\n\u00a0\u00a0\u00a0\u00a0Merge \"Fix gate to use world writeable docker socket\"\nlsorrillo@ptest:~/git/kolla$\n\nRPM version:\n\nlsorrillo@ptest:~$\nlsorrillo@ptest:~$ docker exec -ti nova_api bash\nbash-4.2$\nbash-4.2$\nbash-4.2$\nbash-4.2$ rpm -qa | grep nova\npython-novaclient-3.3.1-0.20160303082753.d63800d.el7.centos.noarch\nopenstack-nova-common-13.0.0.0b4-0.20160304162843.c5a45a2.el7.centos.noarch\npython-nova-13.0.0.0b4-0.20160304162843.c5a45a2.el7.centos.noarch\nopenstack-nova-api-13.0.0.0b4-0.20160304162843.c5a45a2.el7.centos.noarch\nbash-4.2$\n\n2.\n\nThe following error is seen in the nova-api.log:\n\n2016-03-28 19:53:40.086 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connecting to AMQP server on 192.168.0.121:5672 __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:535\n2016-03-28 19:53:40.132 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connected to AMQP server on 192.168.0.121:5672 via [amqp] client __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:562\n2016-03-28 19:53:40.148 29 DEBUG oslo.messaging._drivers.pool [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Pool creating new connection create /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/pool.py:109\n2016-03-28 19:53:40.151 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connecting to AMQP server on 192.168.0.121:5672 __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:535\n2016-03-28 19:53:40.205 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connected to AMQP server on 192.168.0.121:5672 via [amqp] client __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:562\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Unexpected exception in API method\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/extensions.py\", line 478, in wrapped\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/compute/servers.py\", line 630, in create\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     **create_kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/hooks.py\", line 154, in inner\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     rv = f(*args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1556, in create\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     check_server_group_quota=check_server_group_quota)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1139, in _create_instance\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     reservation_id, max_count)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 834, in _validate_and_build_base_options\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     requested_networks, max_count)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 448, in _check_requested_networks\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     max_count)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/api.py\", line 49, in wrapped\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(self, context, *args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/api.py\", line 399, in validate_networks\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     requested_networks)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/rpcapi.py\", line 212, in validate_networks\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return self.client.call(ctxt, 'validate_networks', networks=networks)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 413, in call\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return self.prepare().call(ctxt, method, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 158, in call\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     retry=self.retry)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     timeout=timeout, retry=retry)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 470, in send\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     retry=retry)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 459, in _send\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     result = self._waiter.wait(msg_id, timeout)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 342, in wait\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     message = self.waiters.get(msg_id, timeout=timeout)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 244, in get\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     'to message ID %s' % msg_id)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions MessagingTimeout: Timed out waiting for a reply to message ID 73fdd3b38da34bf7a19b08a086fb26f8\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions\n2016-03-28 19:54:40.229 29 INFO nova.api.openstack.wsgi [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'oslo_messaging.exceptions.MessagingTimeout'>\n2016-03-28 19:54:40.231 29 DEBUG nova.api.openstack.wsgi [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'oslo_messaging.exceptions.MessagingTimeout'> __call__ /usr/lib/python2.7/site-packages/nova/api/openstack/wsgi.py:1070\n2016-03-28 19:54:40.237 29 INFO nova.osapi_compute.wsgi.server [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Traceback (most recent call last):\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/eventlet/wsgi.py\", line 483, in handle_one_response\n\u00a0\u00a0\u00a0\u00a0write(b''.join(towrite))\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/eventlet/wsgi.py\", line 426, in write\n\u00a0\u00a0\u00a0\u00a0_writelines(towrite)\n\u00a0\u00a0File \"/usr/lib64/python2.7/socket.py\", line 334, in writelines\n\u00a0\u00a0\u00a0\u00a0self.flush()\n\u00a0\u00a0File \"/usr/lib64/python2.7/socket.py\", line 303, in flush\n\u00a0\u00a0\u00a0\u00a0self._sock.sendall(view[write_offset:write_offset+buffer_size])\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/eventlet/greenio/base.py\", line 377, in sendall\n\u00a0\u00a0\u00a0\u00a0tail = self.send(data, flags)\n\u00a0\u00a0File \"/usr/lib/python2.7/site-packages/eventlet/greenio/base.py\", line 359, in send\n\u00a0\u00a0\u00a0\u00a0total_sent += fd.send(data[total_sent:], flags)\nerror: [Errno 104] Connection reset by peer\n\n2016-03-28 19:54:40.238 29 INFO nova.osapi_compute.wsgi.server [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] 10.10.10.254,192.168.0.121 \"POST /v2/9e4b40d958e741599adc497b0a9d955a/servers HTTP/1.1\" status: 500 len: 0 time: 60.8730421\n\n3.  git clone https://git.openstack.org/openstack/kolla\ngit checkout -b ltshome\n\nand make the following changes:\n\nlsorrillo@ptest:~/git/kolla$ git status\n# On branch ltshome\n# Changes not staged for commit:\n#   (use \"git add <file>...\" to update what will be committed)\n#   (use \"git checkout -- <file>...\" to discard changes in working directory)\n#\n#\tmodified:   ansible/group_vars/all.yml\n#\tmodified:   etc/kolla/globals.yml\n#\tmodified:   etc/kolla/passwords.yml\n#\n# Untracked files:\n#   (use \"git add <file>...\" to include in what will be committed)\n#\n#\tetc/kolla/passwords.yml.orig\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\nlsorrillo@ptest:~/git/kolla$\n\nHere are diffs of the modified files above:\n\nlsorrillo@ptest:~/git/kolla$ git diff  ansible/group_vars/all.yml\ndiff --git a/ansible/group_vars/all.yml b/ansible/group_vars/all.yml\nindex a0ab95a..6ec956e 100644\n--- a/ansible/group_vars/all.yml\n+++ b/ansible/group_vars/all.yml\n@@ -176,7 +176,7 @@ enable_rabbitmq: \"yes\"\n\u00a0# Additional optional OpenStack services are specified here\n\u00a0enable_ceph: \"no\"\n\u00a0enable_ceph_rgw: \"no\"\n-enable_cinder: \"no\"\n+enable_cinder: \"yes\"\n\u00a0enable_heat: \"yes\"\n\u00a0enable_horizon: \"yes\"\n\u00a0enable_swift: \"no\"\n@@ -184,9 +184,9 @@ enable_murano: \"no\"\n\u00a0enable_ironic: \"no\"\n\u00a0enable_magnum: \"no\"\n\u00a0enable_mistral: \"no\"\n-enable_central_logging: \"no\"\n+enable_central_logging: \"yes\"\n\u00a0enable_mongodb: \"no\"\n-enable_manila: \"no\"\n+enable_manila: \"yes\"\n\n\u00a0ironic_keystone_user: \"ironic\"\n\u00a0neutron_keystone_user: \"neutron\"\nlsorrillo@ptest:~/git/kolla$\n\nlsorrillo@ptest:~/git/kolla$ git diff etc/kolla/globals.yml\ndiff --git a/etc/kolla/globals.yml b/etc/kolla/globals.yml\nindex ec26126..2afea72 100644\n--- a/etc/kolla/globals.yml\n+++ b/etc/kolla/globals.yml\n@@ -55,14 +55,14 @@ kolla_internal_vip_address: \"10.10.10.254\"\n\u00a0# This interface is what all your api services will be bound to by default.\n\u00a0# Additionally, all vxlan/tunnel and storage network traffic will go over this\n\u00a0# interface by default. This interface must contain an IPv4 address.\n-network_interface: \"eth0\"\n+network_interface: \"enp2s0f1\"\n\n\u00a0# These can be adjusted for even more customization. The default is the same as\n\u00a0# the 'network_interface'. These interfaces must container an IPv4 address.\n-#kolla_external_vip_interface: \"{{ network_interface }}\"\n-#api_interface: \"{{ network_interface }}\"\n-#storage_interface: \"{{ network_interface }}\"\n-#tunnel_interface: \"{{ network_interface }}\"\n+kolla_external_vip_interface: \"{{ network_interface }}\"\n+api_interface: \"{{ network_interface }}\"\n+storage_interface: \"{{ network_interface }}\"\n+tunnel_interface: \"{{ network_interface }}\"\n\n\u00a0# This is the raw interface given to neutron as its external network port. Even\n\u00a0# though an IP address can exist on this interface, it will be unusable in most\n@@ -80,7 +80,7 @@ neutron_external_interface: \"eth1\"\n\u00a0# To provide encryption and authentication on the kolla_external_vip_interface,\n\u00a0# TLS can be enabled.  When TLS is enabled, certificates must be provided to\n\u00a0# allow clients to perform authentication.\n-#kolla_enable_tls_external: \"no\"\n+kolla_enable_tls_external: \"no\"\n\u00a0#kolla_external_fqdn_cert: \"{{ node_config_directory }}/certificates/haproxy.pem\"\n\n@@ -89,13 +89,13 @@ neutron_external_interface: \"eth1\"\n\u00a0####################\n\u00a0# Use these options to set the various log levels across all OpenStack projects\n\u00a0# Valid options are [ True, False ]\n-#openstack_logging_debug: \"False\"\n+openstack_logging_debug: \"True\"\n\n\u00a0# Valid options are [ novnc, spice ]\n\u00a0#nova_console: \"novnc\"\n\n\u00a0# OpenStack services can be enabled or disabled with these options\n-#enable_cinder: \"no\"\n+enable_cinder: \"yes\"\n\u00a0#enable_heat: \"yes\"\n\u00a0#enable_magnum: \"no\"\n\u00a0#enable_swift: \"no\"\n@@ -118,7 +118,7 @@ neutron_external_interface: \"eth1\"\n\u00a0#######################################\n\u00a0# Manila - Shared File Systems Options\n\u00a0#######################################\n-#manila_enable_dhss: \"yes\"\n+manila_enable_dhss: \"yes\"\n\n\u00a0#######################################\nlsorrillo@ptest:~/git/kolla$\n\ngit diff etc/kolla/passwords.yml\nxxx\nxxx", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 16, 
    "link": "https://bugs.launchpad.net/nova/+bug/1563029", 
    "owner": "None", 
    "id": 1563029, 
    "index": 6123, 
    "created": "2016-03-28 20:11:51.136763+00:00", 
    "title": "Nova instance fail to launch: 'Unexpected API Error.'", 
    "comments": [
        {
            "content": "This is need in a KOlla installation of openstack.\n\n1. \nThe commit level is:\n\nlsorrillo@ptest:~/git/kolla$ git log -1\ncommit 90321d0497f14bda370908610cfc44296a940523\nMerge: 328a7e8 a789346\nAuthor: Jenkins <email address hidden>\nDate:   Sun Mar 27 23:42:47 2016 +0000\n\n    Merge \"Fix gate to use world writeable docker socket\"\nlsorrillo@ptest:~/git/kolla$ \n\nlsorrillo@ptest:~$ \nlsorrillo@ptest:~$ docker exec -ti nova_api bash\nbash-4.2$ \nbash-4.2$ \nbash-4.2$ \nbash-4.2$ rpm -qa | grep nova\npython-novaclient-3.3.1-0.20160303082753.d63800d.el7.centos.noarch\nopenstack-nova-common-13.0.0.0b4-0.20160304162843.c5a45a2.el7.centos.noarch\npython-nova-13.0.0.0b4-0.20160304162843.c5a45a2.el7.centos.noarch\nopenstack-nova-api-13.0.0.0b4-0.20160304162843.c5a45a2.el7.centos.noarch\nbash-4.2$ \n\n2. \n\nThe following error is seen in the nova-api.log:\n\n2016-03-28 19:53:40.086 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connecting to AMQP server on 192.168.0.121:5672 __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:535\n2016-03-28 19:53:40.132 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connected to AMQP server on 192.168.0.121:5672 via [amqp] client __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:562\n2016-03-28 19:53:40.148 29 DEBUG oslo.messaging._drivers.pool [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Pool creating new connection create /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/pool.py:109\n2016-03-28 19:53:40.151 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connecting to AMQP server on 192.168.0.121:5672 __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:535\n2016-03-28 19:53:40.205 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connected to AMQP server on 192.168.0.121:5672 via [amqp] client __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:562\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Unexpected exception in API method\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/extensions.py\", line 478, in wrapped\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/compute/servers.py\", line 630, in create\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     **create_kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/hooks.py\", line 154, in inner\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     rv = f(*args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1556, in create\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     check_server_group_quota=check_server_group_quota)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1139, in _create_instance\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     reservation_id, max_count)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 834, in _validate_and_build_base_options\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     requested_networks, max_count)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 448, in _check_requested_networks\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     max_count)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/api.py\", line 49, in wrapped\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(self, context, *args, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/api.py\", line 399, in validate_networks\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     requested_networks)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/rpcapi.py\", line 212, in validate_networks\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return self.client.call(ctxt, 'validate_networks', networks=networks)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 413, in call\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return self.prepare().call(ctxt, method, **kwargs)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 158, in call\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     retry=self.retry)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     timeout=timeout, retry=retry)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 470, in send\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     retry=retry)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 459, in _send\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     result = self._waiter.wait(msg_id, timeout)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 342, in wait\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     message = self.waiters.get(msg_id, timeout=timeout)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 244, in get\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     'to message ID %s' % msg_id)\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions MessagingTimeout: Timed out waiting for a reply to message ID 73fdd3b38da34bf7a19b08a086fb26f8\n2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions \n2016-03-28 19:54:40.229 29 INFO nova.api.openstack.wsgi [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'oslo_messaging.exceptions.MessagingTimeout'>\n2016-03-28 19:54:40.231 29 DEBUG nova.api.openstack.wsgi [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'oslo_messaging.exceptions.MessagingTimeout'> __call__ /usr/lib/python2.7/site-packages/nova/api/openstack/wsgi.py:1070\n2016-03-28 19:54:40.237 29 INFO nova.osapi_compute.wsgi.server [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Traceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/eventlet/wsgi.py\", line 483, in handle_one_response\n    write(b''.join(towrite))\n  File \"/usr/lib/python2.7/site-packages/eventlet/wsgi.py\", line 426, in write\n    _writelines(towrite)\n  File \"/usr/lib64/python2.7/socket.py\", line 334, in writelines\n    self.flush()\n  File \"/usr/lib64/python2.7/socket.py\", line 303, in flush\n    self._sock.sendall(view[write_offset:write_offset+buffer_size])\n  File \"/usr/lib/python2.7/site-packages/eventlet/greenio/base.py\", line 377, in sendall\n    tail = self.send(data, flags)\n  File \"/usr/lib/python2.7/site-packages/eventlet/greenio/base.py\", line 359, in send\n    total_sent += fd.send(data[total_sent:], flags)\nerror: [Errno 104] Connection reset by peer\n\n2016-03-28 19:54:40.238 29 INFO nova.osapi_compute.wsgi.server [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] 10.10.10.254,192.168.0.121 \"POST /v2/9e4b40d958e741599adc497b0a9d955a/servers HTTP/1.1\" status: 500 len: 0 time: 60.8730421\n\n3.  git clone https://git.openstack.org/openstack/kolla\ngit checkout -b ltshome \n\nand make the following changes:\n\nlsorrillo@ptest:~/git/kolla$ git status\n# On branch ltshome\n# Changes not staged for commit:\n#   (use \"git add <file>...\" to update what will be committed)\n#   (use \"git checkout -- <file>...\" to discard changes in working directory)\n#\n#\tmodified:   ansible/group_vars/all.yml\n#\tmodified:   etc/kolla/globals.yml\n#\tmodified:   etc/kolla/passwords.yml\n#\n# Untracked files:\n#   (use \"git add <file>...\" to include in what will be committed)\n#\n#\tetc/kolla/passwords.yml.orig\nno changes added to commit (use \"git add\" and/or \"git commit -a\")\nlsorrillo@ptest:~/git/kolla$ \n\n\nlsorrillo@ptest:~/git/kolla$ git diff  ansible/group_vars/all.yml\ndiff --git a/ansible/group_vars/all.yml b/ansible/group_vars/all.yml\nindex a0ab95a..6ec956e 100644\n--- a/ansible/group_vars/all.yml\n+++ b/ansible/group_vars/all.yml\n@@ -176,7 +176,7 @@ enable_rabbitmq: \"yes\"\n # Additional optional OpenStack services are specified here\n enable_ceph: \"no\"\n enable_ceph_rgw: \"no\"\n-enable_cinder: \"no\"\n+enable_cinder: \"yes\"\n enable_heat: \"yes\"\n enable_horizon: \"yes\"\n enable_swift: \"no\"\n@@ -184,9 +184,9 @@ enable_murano: \"no\"\n enable_ironic: \"no\"\n enable_magnum: \"no\"\n enable_mistral: \"no\"\n-enable_central_logging: \"no\"\n+enable_central_logging: \"yes\"\n enable_mongodb: \"no\"\n-enable_manila: \"no\"\n+enable_manila: \"yes\"\n \n ironic_keystone_user: \"ironic\"\n neutron_keystone_user: \"neutron\"\nlsorrillo@ptest:~/git/kolla$ \n\nlsorrillo@ptest:~/git/kolla$ git diff etc/kolla/globals.yml\ndiff --git a/etc/kolla/globals.yml b/etc/kolla/globals.yml\nindex ec26126..2afea72 100644\n--- a/etc/kolla/globals.yml\n+++ b/etc/kolla/globals.yml\n@@ -55,14 +55,14 @@ kolla_internal_vip_address: \"10.10.10.254\"\n # This interface is what all your api services will be bound to by default.\n # Additionally, all vxlan/tunnel and storage network traffic will go over this\n # interface by default. This interface must contain an IPv4 address.\n-network_interface: \"eth0\"\n+network_interface: \"enp2s0f1\"\n \n # These can be adjusted for even more customization. The default is the same as\n # the 'network_interface'. These interfaces must container an IPv4 address.\n-#kolla_external_vip_interface: \"{{ network_interface }}\"\n-#api_interface: \"{{ network_interface }}\"\n-#storage_interface: \"{{ network_interface }}\"\n-#tunnel_interface: \"{{ network_interface }}\"\n+kolla_external_vip_interface: \"{{ network_interface }}\"\n+api_interface: \"{{ network_interface }}\"\n+storage_interface: \"{{ network_interface }}\"\n+tunnel_interface: \"{{ network_interface }}\"\n \n # This is the raw interface given to neutron as its external network port. Even\n # though an IP address can exist on this interface, it will be unusable in most\n@@ -80,7 +80,7 @@ neutron_external_interface: \"eth1\"\n # To provide encryption and authentication on the kolla_external_vip_interface,\n # TLS can be enabled.  When TLS is enabled, certificates must be provided to\n # allow clients to perform authentication.\n-#kolla_enable_tls_external: \"no\"\n+kolla_enable_tls_external: \"no\"\n #kolla_external_fqdn_cert: \"{{ node_config_directory }}/certificates/haproxy.pem\"\n \n \n@@ -89,13 +89,13 @@ neutron_external_interface: \"eth1\"\n ####################\n # Use these options to set the various log levels across all OpenStack projects\n # Valid options are [ True, False ]\n-#openstack_logging_debug: \"False\"\n+openstack_logging_debug: \"True\"\n \n # Valid options are [ novnc, spice ]\n #nova_console: \"novnc\"\n \n # OpenStack services can be enabled or disabled with these options\n-#enable_cinder: \"no\"\n+enable_cinder: \"yes\"\n #enable_heat: \"yes\"\n #enable_magnum: \"no\"\n #enable_swift: \"no\"\n@@ -118,7 +118,7 @@ neutron_external_interface: \"eth1\"\n #######################################\n # Manila - Shared File Systems Options\n #######################################\n-#manila_enable_dhss: \"yes\"\n+manila_enable_dhss: \"yes\"\n \n \n #######################################\nlsorrillo@ptest:~/git/kolla$ \n\ngit diff etc/kolla/passwords.yml\nxxx\nxxx", 
            "date_created": "2016-03-28 20:11:51.136763+00:00", 
            "author": "https://api.launchpad.net/1.0/~lsorrillo"
        }, 
        {
            "content": "I moved this over to Kolla since this looks specific to that project and I'm not working in that repo, so I can't reproduce this. If this turns out to be a Nova specific issue, please update the bug with Nova-specific reproduction steps and we'll take a look at it.", 
            "date_created": "2016-03-29 01:32:57.396239+00:00", 
            "author": "https://api.launchpad.net/1.0/~auggy"
        }, 
        {
            "content": "Did you follow https://github.com/openstack/kolla/blob/master/doc/manila-guide.rst and setup Manila correctly ?\n\nCan you also post the nova compute and nova scheduler logs ?\n\n$ docker exec heka cat /var/log/kolla/nova/nova-compute.log\n\n$ docker exec heka cat /var/log/kolla/nova/nova-scheduler.log", 
            "date_created": "2016-03-29 02:38:22.801531+00:00", 
            "author": "https://api.launchpad.net/1.0/~vhosakot"
        }, 
        {
            "content": "Yes I did. That document was my guide.\n\nI have attached a compressed archive of both nova-compute.log and nova-schedular.log\n\n\n\n", 
            "date_created": "2016-03-29 03:47:19.121825+00:00", 
            "author": "https://api.launchpad.net/1.0/~lsorrillo"
        }, 
        {
            "content": "The nova issue here is the conductor retries of 3 is too small for medium scale (64 node) clusters.  While I realize its configurable, my expectation is OpenStack services work out of the box at 100 node scale under overload conditions.", 
            "date_created": "2016-04-03 01:30:13.998530+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdake"
        }, 
        {
            "content": "nm comment #4, i was thinking of a different bug.", 
            "date_created": "2016-04-03 01:31:24.936392+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdake"
        }, 
        {
            "content": "I have seen bugs like this before.  The exception happens in the API (nova-api.log) and is not properly reported to the client.  Please attach nova-api.log logs.\n\nThe bugs I've seen involve flavor lookups failing (we just fixed a problem related to the nova-api db not migrating the flavors properly which is in the review queue as a 1 liner).  I have seen a similar exception where the image id could not be found from glance, resulting in an API exception error.  Finally I have seen an error where the networks could not be allocated.\n\nI fixed the first two problems by building centos source instead of centos binary.  I think in this case the client locked up during a nova boot operation waiting on flavor access or image access.  I'd really look for that 1 liner that fixes the flavor migration into the nova-api database.\n\nAlso are you using centos or ubuntu and binary or source?\n\nThanks\n-steve", 
            "date_created": "2016-04-04 01:01:31.723115+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdake"
        }, 
        {
            "content": "Hi,\n\nI am using centos binary.\n\nAttached is a compressed (gzip -9) copy of nova-api.log", 
            "date_created": "2016-04-04 01:55:55.998800+00:00", 
            "author": "https://api.launchpad.net/1.0/~lsorrillo"
        }, 
        {
            "content": "Are there any errors in your neutron-server.log?\nI just fixed a bug with similar symptoms, but my fix should only be needed when you have set an external VIP that is not reachable from your internal network interface.\n", 
            "date_created": "2016-04-07 06:52:32.676714+00:00", 
            "author": "https://api.launchpad.net/1.0/~dave-mccowan"
        }, 
        {
            "content": "I will add the neutron log later today.\n\nCheers.\n\n\n\n> Date: Thu, 7 Apr 2016 06:52:32 +0000\n> From: <email address hidden>\n> To: <email address hidden>\n> Subject: [Bug 1563029] Re: Nova instance fail to launch: \"Unexpected API Error.\"\n> \n> Are there any errors in your neutron-server.log?\n> I just fixed a bug with similar symptoms, but my fix should only be needed when you have set an external VIP that is not reachable from your internal network interface.\n> \n> -- \n> You received this bug notification because you are subscribed to the bug\n> report.\n> https://bugs.launchpad.net/bugs/1563029\n> \n> Title:\n>   Nova instance fail to launch: \"Unexpected API Error.\"\n> \n> Status in kolla:\n>   Confirmed\n> Status in kolla mitaka series:\n>   Confirmed\n> Status in OpenStack Compute (nova):\n>   Incomplete\n> \n> Bug description:\n>   This is a Kolla installation of openstack. The docker images build\n>   well and some services work great; e.g cinder, glance and neutron.\n> \n>   Nova seems to have a problem that is prevent provisioning instances.\n>   The manila-api logs below says:\n> \n>   \"Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n>   <class 'oslo_messaging.exceptions.MessagingTimeout'> __call__ /usr/lib/python2.7/site-packages/nova/api/openstack/wsgi.py:1070\"\n> \n> \n>   1. The GIT commit level is:\n> \n>   lsorrillo@ptest:~/git/kolla$ git log -1\n>   commit 90321d0497f14bda370908610cfc44296a940523\n>   Merge: 328a7e8 a789346\n>   Author: Jenkins <email address hidden>\n>   Date:   Sun Mar 27 23:42:47 2016 +0000\n> \n>       Merge \"Fix gate to use world writeable docker socket\"\n>   lsorrillo@ptest:~/git/kolla$\n> \n>   RPM version:\n> \n>   lsorrillo@ptest:~$\n>   lsorrillo@ptest:~$ docker exec -ti nova_api bash\n>   bash-4.2$\n>   bash-4.2$\n>   bash-4.2$\n>   bash-4.2$ rpm -qa | grep nova\n>   python-novaclient-3.3.1-0.20160303082753.d63800d.el7.centos.noarch\n>   openstack-nova-common-13.0.0.0b4-0.20160304162843.c5a45a2.el7.centos.noarch\n>   python-nova-13.0.0.0b4-0.20160304162843.c5a45a2.el7.centos.noarch\n>   openstack-nova-api-13.0.0.0b4-0.20160304162843.c5a45a2.el7.centos.noarch\n>   bash-4.2$\n> \n>   2.\n> \n>   The following error is seen in the nova-api.log:\n> \n>   2016-03-28 19:53:40.086 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connecting to AMQP server on 192.168.0.121:5672 __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:535\n>   2016-03-28 19:53:40.132 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connected to AMQP server on 192.168.0.121:5672 via [amqp] client __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:562\n>   2016-03-28 19:53:40.148 29 DEBUG oslo.messaging._drivers.pool [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Pool creating new connection create /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/pool.py:109\n>   2016-03-28 19:53:40.151 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connecting to AMQP server on 192.168.0.121:5672 __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:535\n>   2016-03-28 19:53:40.205 29 DEBUG oslo.messaging._drivers.impl_rabbit [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Connected to AMQP server on 192.168.0.121:5672 via [amqp] client __init__ /usr/lib/python2.7/site-packages/oslo_messaging/_drivers/impl_rabbit.py:562\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Unexpected exception in API method\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/extensions.py\", line 478, in wrapped\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/compute/servers.py\", line 630, in create\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     **create_kwargs)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/hooks.py\", line 154, in inner\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     rv = f(*args, **kwargs)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1556, in create\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     check_server_group_quota=check_server_group_quota)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1139, in _create_instance\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     reservation_id, max_count)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 834, in _validate_and_build_base_options\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     requested_networks, max_count)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 448, in _check_requested_networks\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     max_count)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/api.py\", line 49, in wrapped\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return func(self, context, *args, **kwargs)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/api.py\", line 399, in validate_networks\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     requested_networks)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/rpcapi.py\", line 212, in validate_networks\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return self.client.call(ctxt, 'validate_networks', networks=networks)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 413, in call\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     return self.prepare().call(ctxt, method, **kwargs)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 158, in call\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     retry=self.retry)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     timeout=timeout, retry=retry)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 470, in send\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     retry=retry)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 459, in _send\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     result = self._waiter.wait(msg_id, timeout)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 342, in wait\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     message = self.waiters.get(msg_id, timeout=timeout)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 244, in get\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions     'to message ID %s' % msg_id)\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions MessagingTimeout: Timed out waiting for a reply to message ID 73fdd3b38da34bf7a19b08a086fb26f8\n>   2016-03-28 19:54:40.216 29 ERROR nova.api.openstack.extensions\n>   2016-03-28 19:54:40.229 29 INFO nova.api.openstack.wsgi [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n>   <class 'oslo_messaging.exceptions.MessagingTimeout'>\n>   2016-03-28 19:54:40.231 29 DEBUG nova.api.openstack.wsgi [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n>   <class 'oslo_messaging.exceptions.MessagingTimeout'> __call__ /usr/lib/python2.7/site-packages/nova/api/openstack/wsgi.py:1070\n>   2016-03-28 19:54:40.237 29 INFO nova.osapi_compute.wsgi.server [req-88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84 9e4b40d958e741599adc497b0a9d955a - - -] Traceback (most recent call last):\n>     File \"/usr/lib/python2.7/site-packages/eventlet/wsgi.py\", line 483, in handle_one_response\n>       write(b''.join(towrite))\n>     File \"/usr/lib/python2.7/site-packages/eventlet/wsgi.py\", line 426, in write\n>       _writelines(towrite)\n>     File \"/usr/lib64/python2.7/socket.py\", line 334, in writelines\n>       self.flush()\n>     File \"/usr/lib64/python2.7/socket.py\", line 303, in flush\n>       self._sock.sendall(view[write_offset:write_offset+buffer_size])\n>     File \"/usr/lib/python2.7/site-packages/eventlet/greenio/base.py\", line 377, in sendall\n>       tail = self.send(data, flags)\n>     File \"/usr/lib/python2.7/site-packages/eventlet/greenio/base.py\", line 359, in send\n>       total_sent += fd.send(data[total_sent:], flags)\n>   error: [Errno 104] Connection reset by peer\n> \n>   2016-03-28 19:54:40.238 29 INFO nova.osapi_compute.wsgi.server [req-\n>   88ffb6f7-1b1f-4332-b066-5b0b41827988 5bd4af0c54a14a789661d868a9fb1d84\n>   9e4b40d958e741599adc497b0a9d955a - - -] 10.10.10.254,192.168.0.121\n>   \"POST /v2/9e4b40d958e741599adc497b0a9d955a/servers HTTP/1.1\" status:\n>   500 len: 0 time: 60.8730421\n> \n>   3.  git clone https://git.openstack.org/openstack/kolla\n>   git checkout -b ltshome\n> \n>   and make the following changes:\n> \n>   lsorrillo@ptest:~/git/kolla$ git status\n>   # On branch ltshome\n>   # Changes not staged for commit:\n>   #   (use \"git add <file>...\" to update what will be committed)\n>   #   (use \"git checkout -- <file>...\" to discard changes in working directory)\n>   #\n>   #\tmodified:   ansible/group_vars/all.yml\n>   #\tmodified:   etc/kolla/globals.yml\n>   #\tmodified:   etc/kolla/passwords.yml\n>   #\n>   # Untracked files:\n>   #   (use \"git add <file>...\" to include in what will be committed)\n>   #\n>   #\tetc/kolla/passwords.yml.orig\n>   no changes added to commit (use \"git add\" and/or \"git commit -a\")\n>   lsorrillo@ptest:~/git/kolla$\n> \n>   Here are diffs of the modified files above:\n> \n>   lsorrillo@ptest:~/git/kolla$ git diff  ansible/group_vars/all.yml\n>   diff --git a/ansible/group_vars/all.yml b/ansible/group_vars/all.yml\n>   index a0ab95a..6ec956e 100644\n>   --- a/ansible/group_vars/all.yml\n>   +++ b/ansible/group_vars/all.yml\n>   @@ -176,7 +176,7 @@ enable_rabbitmq: \"yes\"\n>    # Additional optional OpenStack services are specified here\n>    enable_ceph: \"no\"\n>    enable_ceph_rgw: \"no\"\n>   -enable_cinder: \"no\"\n>   +enable_cinder: \"yes\"\n>    enable_heat: \"yes\"\n>    enable_horizon: \"yes\"\n>    enable_swift: \"no\"\n>   @@ -184,9 +184,9 @@ enable_murano: \"no\"\n>    enable_ironic: \"no\"\n>    enable_magnum: \"no\"\n>    enable_mistral: \"no\"\n>   -enable_central_logging: \"no\"\n>   +enable_central_logging: \"yes\"\n>    enable_mongodb: \"no\"\n>   -enable_manila: \"no\"\n>   +enable_manila: \"yes\"\n> \n>    ironic_keystone_user: \"ironic\"\n>    neutron_keystone_user: \"neutron\"\n>   lsorrillo@ptest:~/git/kolla$\n> \n>   lsorrillo@ptest:~/git/kolla$ git diff etc/kolla/globals.yml\n>   diff --git a/etc/kolla/globals.yml b/etc/kolla/globals.yml\n>   index ec26126..2afea72 100644\n>   --- a/etc/kolla/globals.yml\n>   +++ b/etc/kolla/globals.yml\n>   @@ -55,14 +55,14 @@ kolla_internal_vip_address: \"10.10.10.254\"\n>    # This interface is what all your api services will be bound to by default.\n>    # Additionally, all vxlan/tunnel and storage network traffic will go over this\n>    # interface by default. This interface must contain an IPv4 address.\n>   -network_interface: \"eth0\"\n>   +network_interface: \"enp2s0f1\"\n> \n>    # These can be adjusted for even more customization. The default is the same as\n>    # the 'network_interface'. These interfaces must container an IPv4 address.\n>   -#kolla_external_vip_interface: \"{{ network_interface }}\"\n>   -#api_interface: \"{{ network_interface }}\"\n>   -#storage_interface: \"{{ network_interface }}\"\n>   -#tunnel_interface: \"{{ network_interface }}\"\n>   +kolla_external_vip_interface: \"{{ network_interface }}\"\n>   +api_interface: \"{{ network_interface }}\"\n>   +storage_interface: \"{{ network_interface }}\"\n>   +tunnel_interface: \"{{ network_interface }}\"\n> \n>    # This is the raw interface given to neutron as its external network port. Even\n>    # though an IP address can exist on this interface, it will be unusable in most\n>   @@ -80,7 +80,7 @@ neutron_external_interface: \"eth1\"\n>    # To provide encryption and authentication on the kolla_external_vip_interface,\n>    # TLS can be enabled.  When TLS is enabled, certificates must be provided to\n>    # allow clients to perform authentication.\n>   -#kolla_enable_tls_external: \"no\"\n>   +kolla_enable_tls_external: \"no\"\n>    #kolla_external_fqdn_cert: \"{{ node_config_directory }}/certificates/haproxy.pem\"\n> \n>   @@ -89,13 +89,13 @@ neutron_external_interface: \"eth1\"\n>    ####################\n>    # Use these options to set the various log levels across all OpenStack projects\n>    # Valid options are [ True, False ]\n>   -#openstack_logging_debug: \"False\"\n>   +openstack_logging_debug: \"True\"\n> \n>    # Valid options are [ novnc, spice ]\n>    #nova_console: \"novnc\"\n> \n>    # OpenStack services can be enabled or disabled with these options\n>   -#enable_cinder: \"no\"\n>   +enable_cinder: \"yes\"\n>    #enable_heat: \"yes\"\n>    #enable_magnum: \"no\"\n>    #enable_swift: \"no\"\n>   @@ -118,7 +118,7 @@ neutron_external_interface: \"eth1\"\n>    #######################################\n>    # Manila - Shared File Systems Options\n>    #######################################\n>   -#manila_enable_dhss: \"yes\"\n>   +manila_enable_dhss: \"yes\"\n> \n>    #######################################\n>   lsorrillo@ptest:~/git/kolla$\n> \n>   git diff etc/kolla/passwords.yml\n>   xxx\n>   xxx\n> \n> To manage notifications about this bug go to:\n> https://bugs.launchpad.net/kolla/+bug/1563029/+subscriptions\n \t\t \t   \t\t  ", 
            "date_created": "2016-04-08 18:12:34+00:00", 
            "author": "https://api.launchpad.net/1.0/~lsorrillo"
        }, 
        {
            "content": "Which path is the most tested/used by developers.: the ubuntu/source, centos/source or binary tracks?", 
            "date_created": "2016-04-09 00:19:13.105106+00:00", 
            "author": "https://api.launchpad.net/1.0/~lsorrillo"
        }, 
        {
            "content": "I have added the neutron log for this incident.", 
            "date_created": "2016-04-09 03:03:26.334756+00:00", 
            "author": "https://api.launchpad.net/1.0/~lsorrillo"
        }, 
        {
            "content": "Could you please collect and attach rabbitmq logs? \n\ndocker logs rabbitmq\n\nI noticed a similar error generated by nova when rabbitmq server was not behaving properly. ", 
            "date_created": "2016-04-10 19:45:12.648444+00:00", 
            "author": "https://api.launchpad.net/1.0/~sbezverk"
        }, 
        {
            "content": "Lawrence\n\nRe comment #10, centos-source and ubuntu-source are most tested.  We are waiting on rdo for centos-binary to be ready prior to 4/15.", 
            "date_created": "2016-04-11 20:28:38.221661+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdake"
        }, 
        {
            "content": "Marking this bug as invalid for Nova. If this turns out to be a Nova specific issue, please file a new bug with Nova specific information (including reproduction steps) and reference this one.", 
            "date_created": "2016-06-15 21:28:24.565771+00:00", 
            "author": "https://api.launchpad.net/1.0/~auggy"
        }, 
        {
            "content": "It has been 5 months, we can not reproduce this bug.", 
            "date_created": "2016-09-19 11:11:17.630882+00:00", 
            "author": "https://api.launchpad.net/1.0/~zhubingbing"
        }
    ]
}