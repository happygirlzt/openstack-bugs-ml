{
    "status": "Fix Released", 
    "last_updated": "2015-09-09 07:30:29.793313+00:00", 
    "description": "running with --num-instances=16 I saw a couple of instances go into ERROR State, on the hypervisor side, i saw the following issue: \n\n2015-02-04 09:03:02.840 5077 ERROR nova.compute.manager [-] [instance: e277cf66-167f-4e81-a141-8dec12290015] Instance failed to spawn\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015] Traceback (most recent call last):\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2243, in _build_resources\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     yield resources\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2113, in _build_and_run_instance\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     block_device_info=block_device_info)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2622, in spawn\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     block_device_info, disk_info=disk_info)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4508, in _create_domain_and_network\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     power_on=power_on)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4432, in _create_domain\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     LOG.error(err)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 82, in __exit__\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     six.reraise(self.type_, self.value, self.tb)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4423, in _create_domain\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     domain.createWithFlags(launch_flags)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 183, in doit\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 141, in proxy_call\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     rv = execute(f, *args, **kwargs)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 122, in execute\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     six.reraise(c, e, tb)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 80, in tworker\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     rv = meth(*args, **kwargs)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 993, in createWithFlags\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015] libvirtError: error from service: CreateMachine: Did not receive a reply. Possible causes include: the remote application did not send a reply, the message bus security policy blocked the reply, the reply timeout expired, or the network connection was broken.\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]\n2015-02-04 09:03:02.843 5077 AUDIT nova.compute.manager [req-663bcedd-8f56-4a84-81b1-4e7321a5f30e None] [instance: e277cf66-167f-4e81-a141-8dec12290015] Terminating instance", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1418155", 
    "owner": "https://api.launchpad.net/1.0/~danms", 
    "id": 1418155, 
    "index": 4142, 
    "created": "2015-02-04 18:13:54.195449+00:00", 
    "title": "nova will try to create unlimited instances concurrently and timeout when resources are depleted", 
    "comments": [
        {
            "content": "running with --num-instances=16 I saw a couple of instances go into ERROR State, on the hypervisor side, i saw the following issue: \n\n2015-02-04 09:03:02.840 5077 ERROR nova.compute.manager [-] [instance: e277cf66-167f-4e81-a141-8dec12290015] Instance failed to spawn\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015] Traceback (most recent call last):\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2243, in _build_resources\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     yield resources\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2113, in _build_and_run_instance\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     block_device_info=block_device_info)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2622, in spawn\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     block_device_info, disk_info=disk_info)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4508, in _create_domain_and_network\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     power_on=power_on)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4432, in _create_domain\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     LOG.error(err)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 82, in __exit__\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     six.reraise(self.type_, self.value, self.tb)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4423, in _create_domain\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     domain.createWithFlags(launch_flags)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 183, in doit\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 141, in proxy_call\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     rv = execute(f, *args, **kwargs)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 122, in execute\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     six.reraise(c, e, tb)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 80, in tworker\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     rv = meth(*args, **kwargs)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 993, in createWithFlags\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015] libvirtError: error from service: CreateMachine: Did not receive a reply. Possible causes include: the remote application did not send a reply, the message bus security policy blocked the reply, the reply timeout expired, or the network connection was broken.\n2015-02-04 09:03:02.840 5077 TRACE nova.compute.manager [instance: e277cf66-167f-4e81-a141-8dec12290015]\n2015-02-04 09:03:02.843 5077 AUDIT nova.compute.manager [req-663bcedd-8f56-4a84-81b1-4e7321a5f30e None] [instance: e277cf66-167f-4e81-a141-8dec12290015] Terminating instance", 
            "date_created": "2015-02-04 18:13:54.195449+00:00", 
            "author": "https://api.launchpad.net/1.0/~jtaleric"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/153004\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=5a542e770648469b0fbb638f6ba53f95424252ec\nSubmitter: Jenkins\nBranch:    master\n\ncommit 5a542e770648469b0fbb638f6ba53f95424252ec\nAuthor: Dan Smith <email address hidden>\nDate:   Wed Feb 4 10:10:25 2015 -0800\n\n    Add max_concurrent_builds limit configuration\n    \n    Right now, nova-compute will attempt to build an infinite number of\n    instances, if asked to do so. This won't work on any machine, regardless\n    of the resources, if the number of instances is too large.\n    \n    We could default this to zero to retain the current behavior, but\n    the current behavior is really not sane in any case, so I think we\n    should default to something. Ten instances for a single compute node\n    seems like as reasonable default. If you can do more than ten at a\n    time, you're definitely not running a cloud based on default config.\n    \n    DocImpact: Adds a new configuration variable\n    \n    Closes-Bug: #1418155\n    \n    Change-Id: I412d2849fd16430e6926fc983c031babb7ad04d0\n", 
            "date_created": "2015-02-05 16:27:52.903925+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "I had experienced similar issue running centos7 as a hypervisor. I had found out that the real cause of the issue a bug in systemd-machined DBUS message handling.  Bug is filed here: https://bugs.centos.org/view.php?id=8564.\n", 
            "date_created": "2015-04-27 08:47:17.106026+00:00", 
            "author": "https://api.launchpad.net/1.0/~solganik"
        }, 
        {
            "content": "Fix proposed to branch: stable/juno\nReview: https://review.openstack.org/219637", 
            "date_created": "2015-09-02 10:50:40.323215+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Radomir Dopieralski (<email address hidden>) on branch: stable/juno\nReview: https://review.openstack.org/219637\nReason: Sorry everyone, this wasn't supposed to go to this branch.", 
            "date_created": "2015-09-09 07:30:29.157787+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}