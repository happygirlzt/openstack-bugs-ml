{
    "status": "Expired", 
    "last_updated": "2015-08-16 04:17:44.083437+00:00", 
    "description": "n-cpu times out while waiting for neutron.\n\n\nLogstash\n========\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiIgbWVzc2FnZTogXCJUaW1lb3V0IHdhaXRpbmcgZm9yIHZpZiBwbHVnZ2luZyBjYWxsYmFjayBmb3IgaW5zdGFuY2VcIiBBTkQgdGFnczpcInNjcmVlbi1uLWNwdS50eHRcIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQwODEyMjI1NjY2NiwibW9kZSI6IiIsImFuYWx5emVfZmllbGQiOiIifQ==\n\nmessage: \"Timeout waiting for vif plugging callback for instance\" AND tags:\"screen-n-cpu.txt\"\n\n\nLogs\n++++\nhttp://logs.openstack.org/09/108909/4/gate/check-tempest-dsvm-neutron-full/628138b/logs/screen-n-cpu.txt.gz#_2014-08-13_21_14_53_453\n\n2014-08-13 21:14:53.453 WARNING nova.virt.libvirt.driver [req-0974eac5-f261-472e-a2c3-f96514e4131c ServerActionsTestXML-650848250 ServerActionsTestXML-1011304525] Timeout waiting for vif plugging callback for instance 794ceb8c-a08b-4b02-bdcb-4ad5632f7744\n\n2014-08-13 21:14:55.408 ERROR nova.compute.manager [req-0974eac5-f261-472e-a2c3-f96514e4131c ServerActionsTestXML-650848250 ServerActionsTestXML-1011304525] [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744] Setting instance vm_state to ERROR\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744] Traceback (most recent call last):\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3714, in finish_resize\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     disk_info, image)\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3682, in _finish_resize\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     old_instance_type, sys_meta)\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3677, in _finish_resize\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     block_device_info, power_on)\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 5302, in finish_migration\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     block_device_info, power_on)\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 3792, in _create_domain_and_network\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     raise exception.VirtualInterfaceCreateException()\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744] VirtualInterfaceCreateException: Virtual Interface creation failed\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744] \n\n2014-08-13 21:14:56.138 ERROR oslo.messaging.rpc.dispatcher [req-0974eac5-f261-472e-a2c3-f96514e4131c ServerActionsTestXML-650848250 ServerActionsTestXML-1011304525] Exception during message handling: Virtual Interface creation failed\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 134, in _dispatch_and_reply\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     incoming.message))\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 177, in _dispatch\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 123, in _do_dispatch\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/exception.py\", line 88, in wrapped\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     payload)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/exception.py\", line 71, in wrapped\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 292, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     pass\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 278, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 342, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 266, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     migration.instance_uuid, exc_info=True)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 253, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 320, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 308, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3726, in finish_resize\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     self._set_instance_error_state(context, instance)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3714, in finish_resize\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     disk_info, image)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3682, in _finish_resize\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     old_instance_type, sys_meta)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3677, in _finish_resize\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     block_device_info, power_on)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 5302, in finish_migration\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     block_device_info, power_on)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 3792, in _create_domain_and_network\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     raise exception.VirtualInterfaceCreateException()\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher VirtualInterfaceCreateException: Virtual Interface creation failed\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher", 
    "tags": [
        "network"
    ], 
    "importance": "Undecided", 
    "heat": 26, 
    "link": "https://bugs.launchpad.net/nova/+bug/1357476", 
    "owner": "None", 
    "id": 1357476, 
    "index": 5081, 
    "created": "2014-08-15 17:22:08.610052+00:00", 
    "title": "Timeout waiting for vif plugging callback for instance", 
    "comments": [
        {
            "content": "n-cpu times out while waiting for neutron.\n\n\nLogstash\n========\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiIgbWVzc2FnZTogXCJUaW1lb3V0IHdhaXRpbmcgZm9yIHZpZiBwbHVnZ2luZyBjYWxsYmFjayBmb3IgaW5zdGFuY2VcIiBBTkQgdGFnczpcInNjcmVlbi1uLWNwdS50eHRcIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQwODEyMjI1NjY2NiwibW9kZSI6IiIsImFuYWx5emVfZmllbGQiOiIifQ==\n\nmessage: \"Timeout waiting for vif plugging callback for instance\" AND tags:\"screen-n-cpu.txt\"\n\n\nLogs\n++++\nhttp://logs.openstack.org/09/108909/4/gate/check-tempest-dsvm-neutron-full/628138b/logs/screen-n-cpu.txt.gz#_2014-08-13_21_14_53_453\n\n2014-08-13 21:14:53.453 WARNING nova.virt.libvirt.driver [req-0974eac5-f261-472e-a2c3-f96514e4131c ServerActionsTestXML-650848250 ServerActionsTestXML-1011304525] Timeout waiting for vif plugging callback for instance 794ceb8c-a08b-4b02-bdcb-4ad5632f7744\n\n2014-08-13 21:14:55.408 ERROR nova.compute.manager [req-0974eac5-f261-472e-a2c3-f96514e4131c ServerActionsTestXML-650848250 ServerActionsTestXML-1011304525] [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744] Setting instance vm_state to ERROR\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744] Traceback (most recent call last):\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3714, in finish_resize\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     disk_info, image)\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3682, in _finish_resize\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     old_instance_type, sys_meta)\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3677, in _finish_resize\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     block_device_info, power_on)\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 5302, in finish_migration\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     block_device_info, power_on)\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 3792, in _create_domain_and_network\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744]     raise exception.VirtualInterfaceCreateException()\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744] VirtualInterfaceCreateException: Virtual Interface creation failed\n2014-08-13 21:14:55.408 29002 TRACE nova.compute.manager [instance: 794ceb8c-a08b-4b02-bdcb-4ad5632f7744] \n\n2014-08-13 21:14:56.138 ERROR oslo.messaging.rpc.dispatcher [req-0974eac5-f261-472e-a2c3-f96514e4131c ServerActionsTestXML-650848250 ServerActionsTestXML-1011304525] Exception during message handling: Virtual Interface creation failed\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 134, in _dispatch_and_reply\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     incoming.message))\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 177, in _dispatch\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 123, in _do_dispatch\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/exception.py\", line 88, in wrapped\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     payload)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/exception.py\", line 71, in wrapped\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 292, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     pass\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 278, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 342, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 266, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     migration.instance_uuid, exc_info=True)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 253, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 320, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 308, in decorated_function\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3726, in finish_resize\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     self._set_instance_error_state(context, instance)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3714, in finish_resize\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     disk_info, image)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3682, in _finish_resize\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     old_instance_type, sys_meta)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 3677, in _finish_resize\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     block_device_info, power_on)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 5302, in finish_migration\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     block_device_info, power_on)\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 3792, in _create_domain_and_network\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher     raise exception.VirtualInterfaceCreateException()\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher VirtualInterfaceCreateException: Virtual Interface creation failed\n2014-08-13 21:14:56.138 29002 TRACE oslo.messaging.rpc.dispatcher", 
            "date_created": "2014-08-15 17:22:08.610052+00:00", 
            "author": "https://api.launchpad.net/1.0/~afazekas"
        }, 
        {
            "content": "have you set up:\nnotify_nova_on_port_data_changes = True\nnotify_nova_on_port_status_changes = True\n\nin neutron.conf?", 
            "date_created": "2014-08-17 03:47:27.535088+00:00", 
            "author": "https://api.launchpad.net/1.0/~gongysh"
        }, 
        {
            "content": "Marking as incomplete until gongysh's question is answered", 
            "date_created": "2014-08-18 03:52:06.489749+00:00", 
            "author": "https://api.launchpad.net/1.0/~enikanorov"
        }, 
        {
            "content": "It is the default and the configured value.\n\nnotify_nova_on_port_data_changes = True\nnotify_nova_on_port_status_changes = True\n\nhttp://logs.openstack.org/09/108909/4/gate/check-tempest-dsvm-neutron-full/628138b/logs/etc/neutron/neutron.conf.txt.gz", 
            "date_created": "2014-08-18 09:14:26.404970+00:00", 
            "author": "https://api.launchpad.net/1.0/~afazekas"
        }, 
        {
            "content": "We are already aware of this race in the neutron full job.\nWe did not see this bug and reported a different one: bug 1357599\n\nI will dig a bit more into it before declaring it a dupe... it won't be the first time a failure shows multiple root causes.", 
            "date_created": "2014-08-18 09:39:44.840346+00:00", 
            "author": "https://api.launchpad.net/1.0/~salvatore-orlando"
        }, 
        {
            "content": "one possible reason is that applying iptables time took lots of time due to lots of VMs on compute nodes, if so, this patch should can help, see https://review.openstack.org/#/c/115719/\nso it looks maybe this is a duplicate issue with https://bugs.launchpad.net/neutron/+bug/1352826", 
            "date_created": "2014-09-03 03:24:39.115898+00:00", 
            "author": "https://api.launchpad.net/1.0/~zhhuabj"
        }, 
        {
            "content": "marked as critical because 40 hits in elastic-recheck in 24 hours", 
            "date_created": "2014-09-11 21:50:26.236120+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/120842\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=9e856922e33b2e7d1c51098454ac85591a90df4f\nSubmitter: Jenkins\nBranch:    master\n\ncommit 9e856922e33b2e7d1c51098454ac85591a90df4f\nAuthor: Dan Smith <email address hidden>\nDate:   Thu Sep 11 10:10:58 2014 -0700\n\n    Improve logging of external events on the compute node\n    \n    We don't log every event we receive on the compute node, which could\n    allow some to slip through and look like they were never received. This\n    patch makes sure to debug log each one so we at least know that it made\n    it from API to compute.\n    \n    Change-Id: I817248ea8167be21c55fecad3a39cb45b027596c\n    Related-bug: #1357476\n", 
            "date_created": "2014-09-13 13:41:10.131019+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Unless someone is actively working on this, we need to untarget it from rc1.", 
            "date_created": "2014-09-25 11:27:03.976439+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }, 
        {
            "content": "0 hits in 7 days:\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiIgbWVzc2FnZTogXCJUaW1lb3V0IHdhaXRpbmcgZm9yIHZpZiBwbHVnZ2luZyBjYWxsYmFjayBmb3IgaW5zdGFuY2VcIiBBTkQgdGFnczpcInNjcmVlbi1uLWNwdS50eHRcIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQwODEyMjI1NjY2NiwibW9kZSI6IiIsImFuYWx5emVfZmllbGQiOiIifQ==\n\nWe should probably untarget from rc1.", 
            "date_created": "2014-09-25 21:09:25.987627+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "I'm hitting this on my devstack all-in-one node using neutron. I've done some debugging and looks like a timing issue whereupon nova is \"missing\" the notification regarding the vif plug completion... Here's some notes on the flow.\n\n------\n\nFLOW (durung boot instance):\n- nova.compute.manager.ComputeManager._allocate_network() which returns an async wrapper instance of: network_model.NetworkInfoAsyncWrapper\n\n- shortly thereafter neutron finishes plugging the network info and will send AMQP notification.. e.g.:\n2014-09-29 08:43:48.130 DEBUG neutron.context [req-881fbe63-8722-4ce0-a068-5c3880db8294 None None] Arguments dropped when creating context\n: {u'project_name': None, u'tenant': None} from (pid=5674) __init__ /opt/stack/neutron/neutron/context.py:83\n2014-09-29 08:43:48.650 DEBUG neutron.notifiers.nova [-] Sending events: [{'status': 'completed', 'tag': u'7ffbe55f-f1bd-4742-8ed9-9b238c456555', 'name': 'network-vif-plugged', 'server_uuid': u'd9574d53-12b3-4a4c-b308-3dd522dffdee'}] from (pid=5674) send_events /opt/stack/neutron/neutron/notifiers/nova.py:220\n2014-09-29 08:43:48.827 DEBUG urllib3.connectionpool [-] \"POST /v2/5c2ed97c153f4e02988214fe2a25e753/os-server-external-events HTTP/1.1\" 200 183 from (pid=5674) _make_request /usr/lib/python2.7/dist-packages/urllib3/connectionpool.py:415\n2014-09-29 08:43:48.828 INFO neutron.notifiers.nova [-] Nova event response: {u'status': u'completed', u'tag': u'7ffbe55f-f1bd-4742-8ed9-9b238c456555', u'name': u'network-vif-plugged', u'server_uuid': u'd9574d53-12b3-4a4c-b308-3dd522dffdee', u'code': 200}\n\n- nova.compute.manager.ComputeManager calls driver.spawn() ... note the neutron vif completed notification is already done at this point.\nhere's a sample of network_info which is passed into the driver.spawn()... notice its not active:\n[VIF({\"profile\": {}, \"ovs_interfaceid\": \"491f5df8-277d-4163-917f-2eba8b25ff36\", \"network\": Network({\"bridge\": \"br-int\", \"subnets\": [Subnet({\"ips\": [FixedIP({\"meta\": {}, \"version\": 4, \"type\": \"fixed\", \"floating_ips\": [], \"address\": \"10.0.0.2\"})], \"version\": 4, \"meta\": {\"dhcp_server\": \"10.0.0.3\"}, \"dns\": [], \"routes\": [], \"cidr\": \"10.0.0.0/24\", \"gateway\": IP({\"meta\": {}, \"version\": 4, \"type\": \"gateway\", \"address\": \"10.0.0.1\"})})], \"meta\": {\"injected\": False, \"tenant_id\": \"15045704e84f4fb9be69a4aabc10905d\"}, \"id\": \"92aabdcd-4a9d-45ba-96d0-cd6b9c314434\", \"label\": \"private\"}), \"devname\": \"tap491f5df8-27\", \"vnic_type\": \"normal\", \"qbh_params\": None, \"meta\": {}, \"details\": {\"port_filter\": True, \"ovs_hybrid_plug\": True}, \"address\": \"fa:16:3e:92:e4:f7\", \"active\": False, \"type\": \"ovs\", \"id\": \"491f5df8-277d-4163-917f-2eba8b25ff36\", \"qbg_params\": None})]\n\n- spawn() calls _create_domain_and_network()\n\n- _create_domain_and_network() calls _get_neutron_events()\n\n- _get_neutron_events() returns indicating the driver needs to wait for the network-vif-plugged notification. however as mentioned\nabove this has already been sent so we timeout.\n------\n\nI'm looking into a fix even though this one is assigned to Oleg as it's blocking me.... Note in my scenario I'm passing in a preallocated neutron port on the nova boot call.", 
            "date_created": "2014-09-29 19:06:08.011294+00:00", 
            "author": "https://api.launchpad.net/1.0/~boden"
        }, 
        {
            "content": "btw -- I am aware this issue can be worked around via  CONF.vif_plugging_is_fatal", 
            "date_created": "2014-09-29 19:26:22.947940+00:00", 
            "author": "https://api.launchpad.net/1.0/~boden"
        }, 
        {
            "content": "here's 1 fix that works, but didn't have time to do more than a simpel verify w/it..\n\n\nin the libvirt.driver.LibvirtDriver._create_domain_and_network() change the following snip from:\n\n        if (self._conn_supports_start_paused and\n            utils.is_neutron() and not\n            vifs_already_plugged and power_on and timeout):\n            events = self._get_neutron_events(network_info)\n        else:\n            events = []\n\n\nto:\n\n        if (self._conn_supports_start_paused and\n            utils.is_neutron() and not\n            vifs_already_plugged and power_on and timeout\n            and not instance.system_metadata['network_allocated']):\n            events = self._get_neutron_events(network_info)\n        else:\n            events = []\n\n\nThis works because the async network allocation callback populates the instance.system_metadata['network_allocated'] value.\n\n\n", 
            "date_created": "2014-09-29 20:15:59.555640+00:00", 
            "author": "https://api.launchpad.net/1.0/~boden"
        }, 
        {
            "content": "Note #12 above is just a \"hint\" as I have to run for the day... If we used system_metadata as in the approach above it obviously lacks additional synchronization with neutron event waiting and async callback update of the metadata itself.", 
            "date_created": "2014-09-29 20:28:35.936043+00:00", 
            "author": "https://api.launchpad.net/1.0/~boden"
        }, 
        {
            "content": "@boden, can you please describe how are you reproducing the issue on devstack?\nI am able to reproduce by launching 50-60 instances at the same time, but this may be another issue however.\n\nRegarding your fix: indeed, async network allocation callback sets the instance.system_metadata['network_allocated'] to True but this happens right after Neutron creates port and sends the result to Nova. VIF plugging is another async operation however. So with your fix Nova just doesn't wait for vif plugging event from neutron which is identical to setting vif_plugging_is_fatal = False.", 
            "date_created": "2014-09-30 12:54:41.974687+00:00", 
            "author": "https://api.launchpad.net/1.0/~obondarev"
        }, 
        {
            "content": "@Oleg -- I'm using the master stream with a devstack all-in-one configuration (neutron networking); the error occurs with every server boot.", 
            "date_created": "2014-09-30 13:03:13.643180+00:00", 
            "author": "https://api.launchpad.net/1.0/~boden"
        }, 
        {
            "content": "As it turns out, my devstack setup accidentally had nova cells enabled which as a result was using some of the cells_api integration (e.g. ComputeRPCAPIRedirect for the compute rpcapi). Once I disabled cells I'm no longer hitting the error discussed in this bug.", 
            "date_created": "2014-09-30 16:10:58.911661+00:00", 
            "author": "https://api.launchpad.net/1.0/~boden"
        }, 
        {
            "content": "is this really critical in neutron? no hits in logstash last 7 days [1]\n\nI think the underlying fix in nova @ [2] squashed this one. the Latest repro from Boden R turned out to be a false positive.\n\n\n\n[1] http://logstash.openstack.org/#eyJzZWFyY2giOiIgbWVzc2FnZTogXCJUaW1lb3V0IHdhaXRpbmcgZm9yIHZpZiBwbHVnZ2luZyBjYWxsYmFjayBmb3IgaW5zdGFuY2VcIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQxMzM2ODgwNTg3OSwibW9kZSI6IiIsImFuYWx5emVfZmllbGQiOiIifQ==\n\n[2] https://review.openstack.org/#/c/116354/", 
            "date_created": "2014-10-15 10:29:52.384789+00:00", 
            "author": "https://api.launchpad.net/1.0/~marios-b"
        }, 
        {
            "content": "This might be fixed, no hits in 10 days.", 
            "date_created": "2014-10-15 21:29:15.461651+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Since we haven't seen this in 10 days, closing the bug. If this is seen again feel free to re-open.", 
            "date_created": "2014-10-16 18:01:19.334124+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "", 
            "date_created": "2015-06-09 15:47:07.689529+00:00", 
            "author": "https://api.launchpad.net/1.0/~jbanerje"
        }, 
        {
            "content": "I have hit this bug repeatedly on creating new instance on a compute-node on which already 4 instances exist.\r\nResource-wiseless than 10% of the hypervisor has been used by the existing instances.\r\nAny new instance creation is failing at the same place as per the log trace.  I have attached the log for my instance named 'AGAIN'\r\n\r\nBelow is the log snippet:\r\n=======================\r\n\r\n2015-06-09 08:03:47.153 19692 WARNING nova.virt.libvirt.driver [-] Timeout waiting for vif plugging callback for instance b8c3a1dc-8780-4495-8a7e-3f03f14c8475\r\n2015-06-09 08:03:47.363 19692 DEBUG nova.virt.libvirt.vif [-] vif_type=ovs instance=Instance(access_ip_v4=None,access_ip_v6=None,architecture=None,auto_disk_config=False,availability_zone=None,cell_name=None,cleaned=True,config_drive='',created_at=2015-06-09T14:58:40Z,default_ephemeral_device=None,default_swap_device=None,deleted=False,deleted_at=None,disable_terminate=False,display_description='AGAIN',display_name='AGAIN',ephemeral_gb=0,ephemeral_key_uuid=None,fault=<?>,host='f3-compute-2.noiro.lab',hostname='again',id=77,image_ref='82cd7cee-ade0-43b2-94ac-b7cb8c0c941b',info_cache=InstanceInfoCache,instance_type_id=1,kernel_id='',key_data=None,key_name=None,launch_index=0,launched_at=None,launched_on='f3-compute-2.noiro.lab',locked=False,locked_by=None,memory_mb=4096,metadata={},node='f3-compute-2.noiro.lab',numa_topology=None,os_type=None,pci_devices=PciDeviceList,power_state=0,progress=0,project_id='26acdadf476e49e78172ef6f0595f9a1',ramdisk_id='',reservation_id='r-51nqu02g',root_device_name='/dev/vda',root_gb=40,scheduled_at=None,security_groups=SecurityGroupList,shutdown_terminate=False,system_metadata={image_base_image_ref='82cd7cee-ade0-43b2-94ac-b7cb8c0c941b',image_container_format='bare',image_disk_format='qcow2',image_min_disk='40',image_min_ram='0',instance_type_ephemeral_gb='0',instance_type_flavorid='3',instance_type_id='1',instance_type_memory_mb='4096',instance_type_name='m1.medium',instance_type_root_gb='40',instance_type_rxtx_factor='1.0',instance_type_swap='0',instance_type_vcpu_weight=None,instance_type_vcpus='2',network_allocated='True'},task_state='spawning',terminated_at=None,updated_at=2015-06-09T14:58:44Z,user_data=None,user_id='3fd8184442334332be33cdfe5b57b1ae',uuid=b8c3a1dc-8780-4495-8a7e-3f03f14c8475,vcpus=2,vm_mode=None,vm_state='building') vif=VIF({'profile': {}, 'ovs_interfaceid': u'8d51f6bd-6a8b-43a0-9d86-b8384225eab5', 'network': Network({'bridge': 'br-int', 'subnets': [Subnet({'ips': [FixedIP({'meta': {}, 'version': 4, 'type': 'fixed', 'floating_ips': [], 'address': u'5.5.5.7'})], 'version': 4, 'meta': {'dhcp_server': u'5.5.5.3'}, 'dns': [], 'routes': [Route({'interface': None, 'cidr': u'5.5.5.0/24', 'meta': {}, 'gateway': IP({'meta': {}, 'version': 4, 'type': 'gateway', 'address': u'5.5.5.1'})})], 'cidr': u'5.5.5.0/28', 'gateway': IP({'meta': {}, 'version': 4, 'type': 'gateway', 'address': u'5.5.5.1'})})], 'meta': {'injected': False, 'tenant_id': u'26acdadf476e49e78172ef6f0595f9a1'}, 'id': u'4659e62b-f4fd-43ac-b18a-5ef30fac028e', 'label': u'l2p_demo_same_ptg_l2p_l3p_bd'}), 'devname': u'tap8d51f6bd-6a', 'vnic_type': u'normal', 'qbh_params': None, 'meta': {}, 'details': {u'port_filter': False, u'ovs_hybrid_plug': False}, 'address': u'fa:16:3e:61:6a:e8', 'active': False, 'type': u'ovs', 'id': u'8d51f6bd-6a8b-43a0-9d86-b8384225eab5', 'qbg_params': None}) unplug /usr/lib/python2.7/site-packages/nova/virt/libvirt/vif.py:688\r\n2015-06-09 08:03:47.366 19692 DEBUG nova.virt.driver [-] Emitting event <LifecycleEvent: 1433862227.36, b8c3a1dc-8780-4495-8a7e-3f03f14c8475 => Stopped> emit_event /usr/lib/python2.7/site-packages/nova/virt/driver.py:1299\r\n2015-06-09 08:03:47.366 19692 INFO nova.compute.manager [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] VM Stopped (Lifecycle Event)\r\n2015-06-09 08:03:47.401 19692 DEBUG nova.compute.manager [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Synchronizing instance power state after lifecycle event \"Stopped\"; current vm_state: building, current task_state: spawning, current DB power_state: 0, VM power_state: 4 handle_lifecycle_event /usr/lib/python2.7/site-packages/nova/compute/manager.py:1150\r\n2015-06-09 08:03:47.405 19692 DEBUG nova.objects.instance [-] Lazy-loading `system_metadata' on Instance uuid b8c3a1dc-8780-4495-8a7e-3f03f14c8475 obj_load_attr /usr/lib/python2.7/site-packages/nova/objects/instance.py:579\r\n2015-06-09 08:03:47.438 19692 INFO nova.compute.manager [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] During sync_power_state the instance has a pending task (spawning). Skip.\r\n2015-06-09 08:03:47.444 19692 DEBUG nova.openstack.common.processutils [-] Running cmd (subprocess): mv /var/lib/nova/instances/b8c3a1dc-8780-4495-8a7e-3f03f14c8475 /var/lib/nova/instances/b8c3a1dc-8780-4495-8a7e-3f03f14c8475_del execute /usr/lib/python2.7/site-packages/nova/openstack/common/processutils.py:161\r\n2015-06-09 08:03:47.453 19692 DEBUG nova.openstack.common.processutils [-] Result was 0 execute /usr/lib/python2.7/site-packages/nova/openstack/common/processutils.py:195\r\n2015-06-09 08:03:47.454 19692 INFO nova.virt.libvirt.driver [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Deleting instance files /var/lib/nova/instances/b8c3a1dc-8780-4495-8a7e-3f03f14c8475_del\r\n2015-06-09 08:03:47.454 19692 INFO nova.virt.libvirt.driver [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Deletion of /var/lib/nova/instances/b8c3a1dc-8780-4495-8a7e-3f03f14c8475_del complete\r\n2015-06-09 08:03:47.495 19692 ERROR nova.compute.manager [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Instance failed to spawn\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Traceback (most recent call last):\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2288, in _build_resources\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]     yield resources\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2158, in _build_and_run_instance\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]     block_device_info=block_device_info)\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2635, in spawn\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]     block_device_info, disk_info=disk_info)\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4579, in _create_domain_and_network\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]     raise exception.VirtualInterfaceCreateException()\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] VirtualInterfaceCreateException: Virtual Interface creation failed\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]\r\n2015-06-09 08:03:47.496 19692 AUDIT nova.compute.manager [req-db08580d-efec-4377-baa5-e98e5868c055 None] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Terminating instance\r\n", 
            "date_created": "2015-06-09 15:51:19.596988+00:00", 
            "author": "https://api.launchpad.net/1.0/~jbanerje"
        }, 
        {
            "content": "I have hit this bug repeatedly on creating new instance on a compute-node on which already 4 instances exist.\r\nResource-wiseless than 10% of the hypervisor has been used by the existing instances.\r\nAny new instance creation is failing at the same place as per the log trace.  I have attached the log for my instance named 'AGAIN'\r\n\r\nBelow is the log snippet:\r\n=======================\r\n\r\n2015-06-09 08:03:47.153 19692 WARNING nova.virt.libvirt.driver [-] Timeout waiting for vif plugging callback for instance b8c3a1dc-8780-4495-8a7e-3f03f14c8475\r\n2015-06-09 08:03:47.363 19692 DEBUG nova.virt.libvirt.vif [-] vif_type=ovs instance=Instance(access_ip_v4=None,access_ip_v6=None,architecture=None,auto_disk_config=False,availability_zone=None,cell_name=None,cleaned=True,config_drive='',created_at=2015-06-09T14:58:40Z,default_ephemeral_device=None,default_swap_device=None,deleted=False,deleted_at=None,disable_terminate=False,display_description='AGAIN',display_name='AGAIN',ephemeral_gb=0,ephemeral_key_uuid=None,fault=<?>,host='f3-compute-2.noiro.lab',hostname='again',id=77,image_ref='82cd7cee-ade0-43b2-94ac-b7cb8c0c941b',info_cache=InstanceInfoCache,instance_type_id=1,kernel_id='',key_data=None,key_name=None,launch_index=0,launched_at=None,launched_on='f3-compute-2.noiro.lab',locked=False,locked_by=None,memory_mb=4096,metadata={},node='f3-compute-2.noiro.lab',numa_topology=None,os_type=None,pci_devices=PciDeviceList,power_state=0,progress=0,project_id='26acdadf476e49e78172ef6f0595f9a1',ramdisk_id='',reservation_id='r-51nqu02g',root_device_name='/dev/vda',root_gb=40,scheduled_at=None,security_groups=SecurityGroupList,shutdown_terminate=False,system_metadata={image_base_image_ref='82cd7cee-ade0-43b2-94ac-b7cb8c0c941b',image_container_format='bare',image_disk_format='qcow2',image_min_disk='40',image_min_ram='0',instance_type_ephemeral_gb='0',instance_type_flavorid='3',instance_type_id='1',instance_type_memory_mb='4096',instance_type_name='m1.medium',instance_type_root_gb='40',instance_type_rxtx_factor='1.0',instance_type_swap='0',instance_type_vcpu_weight=None,instance_type_vcpus='2',network_allocated='True'},task_state='spawning',terminated_at=None,updated_at=2015-06-09T14:58:44Z,user_data=None,user_id='3fd8184442334332be33cdfe5b57b1ae',uuid=b8c3a1dc-8780-4495-8a7e-3f03f14c8475,vcpus=2,vm_mode=None,vm_state='building') vif=VIF({'profile': {}, 'ovs_interfaceid': u'8d51f6bd-6a8b-43a0-9d86-b8384225eab5', 'network': Network({'bridge': 'br-int', 'subnets': [Subnet({'ips': [FixedIP({'meta': {}, 'version': 4, 'type': 'fixed', 'floating_ips': [], 'address': u'5.5.5.7'})], 'version': 4, 'meta': {'dhcp_server': u'5.5.5.3'}, 'dns': [], 'routes': [Route({'interface': None, 'cidr': u'5.5.5.0/24', 'meta': {}, 'gateway': IP({'meta': {}, 'version': 4, 'type': 'gateway', 'address': u'5.5.5.1'})})], 'cidr': u'5.5.5.0/28', 'gateway': IP({'meta': {}, 'version': 4, 'type': 'gateway', 'address': u'5.5.5.1'})})], 'meta': {'injected': False, 'tenant_id': u'26acdadf476e49e78172ef6f0595f9a1'}, 'id': u'4659e62b-f4fd-43ac-b18a-5ef30fac028e', 'label': u'l2p_demo_same_ptg_l2p_l3p_bd'}), 'devname': u'tap8d51f6bd-6a', 'vnic_type': u'normal', 'qbh_params': None, 'meta': {}, 'details': {u'port_filter': False, u'ovs_hybrid_plug': False}, 'address': u'fa:16:3e:61:6a:e8', 'active': False, 'type': u'ovs', 'id': u'8d51f6bd-6a8b-43a0-9d86-b8384225eab5', 'qbg_params': None}) unplug /usr/lib/python2.7/site-packages/nova/virt/libvirt/vif.py:688\r\n2015-06-09 08:03:47.366 19692 DEBUG nova.virt.driver [-] Emitting event <LifecycleEvent: 1433862227.36, b8c3a1dc-8780-4495-8a7e-3f03f14c8475 => Stopped> emit_event /usr/lib/python2.7/site-packages/nova/virt/driver.py:1299\r\n2015-06-09 08:03:47.366 19692 INFO nova.compute.manager [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] VM Stopped (Lifecycle Event)\r\n2015-06-09 08:03:47.401 19692 DEBUG nova.compute.manager [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Synchronizing instance power state after lifecycle event \"Stopped\"; current vm_state: building, current task_state: spawning, current DB power_state: 0, VM power_state: 4 handle_lifecycle_event /usr/lib/python2.7/site-packages/nova/compute/manager.py:1150\r\n2015-06-09 08:03:47.405 19692 DEBUG nova.objects.instance [-] Lazy-loading `system_metadata' on Instance uuid b8c3a1dc-8780-4495-8a7e-3f03f14c8475 obj_load_attr /usr/lib/python2.7/site-packages/nova/objects/instance.py:579\r\n2015-06-09 08:03:47.438 19692 INFO nova.compute.manager [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] During sync_power_state the instance has a pending task (spawning). Skip.\r\n2015-06-09 08:03:47.444 19692 DEBUG nova.openstack.common.processutils [-] Running cmd (subprocess): mv /var/lib/nova/instances/b8c3a1dc-8780-4495-8a7e-3f03f14c8475 /var/lib/nova/instances/b8c3a1dc-8780-4495-8a7e-3f03f14c8475_del execute /usr/lib/python2.7/site-packages/nova/openstack/common/processutils.py:161\r\n2015-06-09 08:03:47.453 19692 DEBUG nova.openstack.common.processutils [-] Result was 0 execute /usr/lib/python2.7/site-packages/nova/openstack/common/processutils.py:195\r\n2015-06-09 08:03:47.454 19692 INFO nova.virt.libvirt.driver [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Deleting instance files /var/lib/nova/instances/b8c3a1dc-8780-4495-8a7e-3f03f14c8475_del\r\n2015-06-09 08:03:47.454 19692 INFO nova.virt.libvirt.driver [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Deletion of /var/lib/nova/instances/b8c3a1dc-8780-4495-8a7e-3f03f14c8475_del complete\r\n2015-06-09 08:03:47.495 19692 ERROR nova.compute.manager [-] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Instance failed to spawn\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Traceback (most recent call last):\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2288, in _build_resources\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]     yield resources\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2158, in _build_and_run_instance\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]     block_device_info=block_device_info)\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2635, in spawn\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]     block_device_info, disk_info=disk_info)\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4579, in _create_domain_and_network\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]     raise exception.VirtualInterfaceCreateException()\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] VirtualInterfaceCreateException: Virtual Interface creation failed\r\n2015-06-09 08:03:47.495 19692 TRACE nova.compute.manager [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475]\r\n2015-06-09 08:03:47.496 19692 AUDIT nova.compute.manager [req-db08580d-efec-4377-baa5-e98e5868c055 None] [instance: b8c3a1dc-8780-4495-8a7e-3f03f14c8475] Terminating instance\r\n", 
            "date_created": "2015-06-09 15:51:26.549637+00:00", 
            "author": "https://api.launchpad.net/1.0/~jbanerje"
        }, 
        {
            "content": "Forgot to mention that this bug prevails in Stable-Juno", 
            "date_created": "2015-06-10 16:23:11.809888+00:00", 
            "author": "https://api.launchpad.net/1.0/~jbanerje"
        }, 
        {
            "content": "Does this happen in master? originally this was filed for logs we saw in CI jobs.", 
            "date_created": "2015-06-14 01:23:52.543404+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "Yes.. this juno off the Master", 
            "date_created": "2015-06-15 14:56:07.274908+00:00", 
            "author": "https://api.launchpad.net/1.0/~jbanerje"
        }, 
        {
            "content": "May I know why the bug state is in Incomplete?\n\nI have provided all the necessary logs which I have captured in invoking two different VMs and two different time instances.\n\nPlease provide the analysis of the logs if they have been already triaged.", 
            "date_created": "2015-06-16 17:00:36.991321+00:00", 
            "author": "https://api.launchpad.net/1.0/~jbanerje"
        }, 
        {
            "content": "[Expired for OpenStack Compute (nova) because there has been no activity for 60 days.]", 
            "date_created": "2015-08-16 04:17:35.414920+00:00", 
            "author": "https://api.launchpad.net/1.0/~janitor"
        }
    ]
}