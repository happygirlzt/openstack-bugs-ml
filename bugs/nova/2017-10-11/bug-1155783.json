{
    "status": "Fix Released", 
    "last_updated": "2013-04-04 11:16:16.340693+00:00", 
    "description": "Using the latest Grizzly code (f5a2890 or later).\n\n\nI see the following in compute.log when trying to boot an instance:\n\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     block_device_info=block_device_info)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 518, in get_vdis_for_instance\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     context, session, instance, name_label, image, image_type)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 974, in _create_image\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     image_id, image_type)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 919, in _create_cached_image\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     image_id, image_type)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 994, in _fetch_image\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     vdis = _fetch_vhd_image(context, session, instance, image_id)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 1109, in _fetch_vhd_image\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     callback=callback)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 1034, in _fetch_using_dom0_plugin_with_retry\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     raise exception.CouldNotFetchImage(image_id=image_id)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096] CouldNotFetchImage: Could not fetch image 24c88443-07f2-4665-95c7-5717773c7def\n\n---\n\nThe issue seems to be caused by commit f5a2890 where we changed our routine to automatically extract OVS images. This seems like a really bad idea because it has *no* compatibility existing images Xenserver uses might have.", 
    "tags": [], 
    "importance": "Critical", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1155783", 
    "owner": "https://api.launchpad.net/1.0/~dan-prince", 
    "id": 1155783, 
    "index": 121, 
    "created": "2013-03-15 20:57:34.424291+00:00", 
    "title": "XenServer fails to fetch images", 
    "comments": [
        {
            "content": "Using the latest Grizzly code (f5a2890 or later).\n\n\nI see the following in compute.log when trying to boot an instance:\n\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     block_device_info=block_device_info)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 518, in get_vdis_for_instance\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     context, session, instance, name_label, image, image_type)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 974, in _create_image\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     image_id, image_type)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 919, in _create_cached_image\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     image_id, image_type)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 994, in _fetch_image\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     vdis = _fetch_vhd_image(context, session, instance, image_id)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 1109, in _fetch_vhd_image\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     callback=callback)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vm_utils.py\", line 1034, in _fetch_using_dom0_plugin_with_retry\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096]     raise exception.CouldNotFetchImage(image_id=image_id)\n2013-03-15 20:48:08.670 3203 TRACE nova.utils [instance: 0b039bcf-0d67-41d4-91d3-5624369dc096] CouldNotFetchImage: Could not fetch image 24c88443-07f2-4665-95c7-5717773c7def\n\n---\n\nThe issue seems to be caused by commit f5a2890 where we changed our routine to automatically extract OVS images. This seems like a really bad idea because it has *no* compatibility existing images Xenserver uses might have.", 
            "date_created": "2013-03-15 20:57:34.424291+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/24558", 
            "date_created": "2013-03-15 21:01:24.539017+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/24558\nCommitted: http://github.com/openstack/nova/commit/7f1b1b69d70a6c7ee37b0f8c907473ddf5c08cac\nSubmitter: Jenkins\nBranch:    master\n\ncommit 7f1b1b69d70a6c7ee37b0f8c907473ddf5c08cac\nAuthor: Dan Prince <email address hidden>\nDate:   Fri Mar 15 16:57:47 2013 -0400\n\n    Revert 1154253 causes XenServer image compat issue\n    \n    In 1154253 we:\n    \n      Drop gzip flag from tar command for OVF archives\n    \n    While support more OVF file formats is a worthy goal the approach\n    in 1154253 is going to cause serious issues for existing\n    Nova XenServer users who are already zipping their OVS images.\n    \n    I would also point out that our utils.py xenserver plugins still\n    zips tarballs we create (see create_tarball) so the new code\n    causes internal inconsistencies as well.\n    \n    This should fix SmokeStack.\n    \n    Fixes LP Bug #1155783.\n    \n    Change-Id: Iff6db314c0dec6df2e48d98db2a547f6624b9d9a\n", 
            "date_created": "2013-03-15 22:18:36.106130+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}