{
    "status": "Fix Released", 
    "last_updated": "2017-04-14 09:22:35.545580+00:00", 
    "description": "When an image[0] has the property \"hw_vif_model\" set to \"lan9118\" instances can't be launched[1] even though the underlying hypervisor qemu allows this[2] nic for the ARM emulation, by way of architecture=armv7l and hw_machine_type=vexpress-a9a. I tried this on a devstack environment[3].\n\n[0]\nstack@devstack:~$ dd if=/dev/zero bs=1M count=1 of=image\n1+0 records in\n1+0 records out\n1048576 bytes (1.0 MB) copied, 0.00500358 s, 210 MB/s\nstack@devstack:~$ \nstack@devstack:~$ openstack image create --file image --property hypervisor_type=qemu --property architecture=armv7l --property hw_machine_type=vexpress-a9 --property hw_vif_model=lan9118 image\n+------------------+--------------------------------------------------------------------------------+\n| Field            | Value                                                                          |\n+------------------+--------------------------------------------------------------------------------+\n| checksum         | b6d81b360a5672d80c27430f39153e2c                                               |\n| container_format | bare                                                                           |\n| created_at       | 2016-10-31T15:24:42Z                                                           |\n| disk_format      | raw                                                                            |\n| file             | /v2/images/93b8f2c1-cc35-44bf-ad1e-7893f7df796b/file                           |\n| id               | 93b8f2c1-cc35-44bf-ad1e-7893f7df796b                                           |\n| min_disk         | 0                                                                              |\n| min_ram          | 0                                                                              |\n| name             | image                                                                          |\n| owner            | 4eaaec76652e4f72b3b176108246f7c4                                               |\n| properties       | architecture='armv7l', hw_machine_type='vexpress-a9', hw_vif_model='lan9118',  |\n|                  | hypervisor_type='qemu'                                                         |\n| protected        | False                                                                          |\n| schema           | /v2/schemas/image                                                              |\n| size             | 1048576                                                                        |\n| status           | active                                                                         |\n| tags             |                                                                                |\n| updated_at       | 2016-10-31T15:24:42Z                                                           |\n| virtual_size     | None                                                                           |\n| visibility       | private                                                                        |\n+------------------+--------------------------------------------------------------------------------+\nstack@devstack:~$ \n\n[1]\nstack@devstack:~$ openstack server create --image image --flavor m1.tiny --nic net-id=private tomInvalid image metadata. Error: Field value lan9118 is invalid (HTTP 400) (Request-ID: req-64e6e05d-d267-4f0d-b0ea-0bffdf152d29)\nstack@devstack:~$ \n\n[2]\nstack@devstack:~$ qemu-system-arm -machine vexpress-a15 -net nic,model=help 2>&1 | grep NIC\nqemu: Supported NIC models: lan9118\nstack@devstack:~$ \n\n[3]\nstack@devstack:~/nova$ git log -1\ncommit 951a2f4219e854ba8183aaf52d2098b147472364\nMerge: 1bd4d7f 03f8f5a\nAuthor: Jenkins <email address hidden>\nDate:   Fri Oct 28 12:37:01 2016 +0000\n\n    Merge \"Clarify what changed with scheduler_host_manager.\"\nstack@devstack:~/nova$", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1638059", 
    "owner": "https://api.launchpad.net/1.0/~thomasdstewart", 
    "id": 1638059, 
    "index": 6508, 
    "created": "2016-10-31 16:25:54.524647+00:00", 
    "title": "Can't launch qemu instance with lan9118 nic type", 
    "comments": [
        {
            "content": "When an image[0] has the property \"hw_vif_model\" set to \"lan9118\" instances can't be launched[1] even though the underlying hypervisor qemu allows this[2] nic for the ARM emulation, by way of architecture=armv7l and hw_machine_type=vexpress-a9a. I tried this on a devstack environment[3].\n\n[0]\nstack@devstack:~$ dd if=/dev/zero bs=1M count=1 of=image\n1+0 records in\n1+0 records out\n1048576 bytes (1.0 MB) copied, 0.00500358 s, 210 MB/s\nstack@devstack:~$ \nstack@devstack:~$ openstack image create --file image --property hypervisor_type=qemu --property architecture=armv7l --property hw_machine_type=vexpress-a9 --property hw_vif_model=lan9118 image\n+------------------+--------------------------------------------------------------------------------+\n| Field            | Value                                                                          |\n+------------------+--------------------------------------------------------------------------------+\n| checksum         | b6d81b360a5672d80c27430f39153e2c                                               |\n| container_format | bare                                                                           |\n| created_at       | 2016-10-31T15:24:42Z                                                           |\n| disk_format      | raw                                                                            |\n| file             | /v2/images/93b8f2c1-cc35-44bf-ad1e-7893f7df796b/file                           |\n| id               | 93b8f2c1-cc35-44bf-ad1e-7893f7df796b                                           |\n| min_disk         | 0                                                                              |\n| min_ram          | 0                                                                              |\n| name             | image                                                                          |\n| owner            | 4eaaec76652e4f72b3b176108246f7c4                                               |\n| properties       | architecture='armv7l', hw_machine_type='vexpress-a9', hw_vif_model='lan9118',  |\n|                  | hypervisor_type='qemu'                                                         |\n| protected        | False                                                                          |\n| schema           | /v2/schemas/image                                                              |\n| size             | 1048576                                                                        |\n| status           | active                                                                         |\n| tags             |                                                                                |\n| updated_at       | 2016-10-31T15:24:42Z                                                           |\n| virtual_size     | None                                                                           |\n| visibility       | private                                                                        |\n+------------------+--------------------------------------------------------------------------------+\nstack@devstack:~$ \n\n[1]\nstack@devstack:~$ openstack server create --image image --flavor m1.tiny --nic net-id=private tomInvalid image metadata. Error: Field value lan9118 is invalid (HTTP 400) (Request-ID: req-64e6e05d-d267-4f0d-b0ea-0bffdf152d29)\nstack@devstack:~$ \n\n[2]\nstack@devstack:~$ qemu-system-arm -machine vexpress-a15 -net nic,model=help 2>&1 | grep NIC\nqemu: Supported NIC models: lan9118\nstack@devstack:~$ \n\n[3]\nstack@devstack:~/nova$ git log -1\ncommit 951a2f4219e854ba8183aaf52d2098b147472364\nMerge: 1bd4d7f 03f8f5a\nAuthor: Jenkins <email address hidden>\nDate:   Fri Oct 28 12:37:01 2016 +0000\n\n    Merge \"Clarify what changed with scheduler_host_manager.\"\nstack@devstack:~/nova$", 
            "date_created": "2016-10-31 16:25:54.524647+00:00", 
            "author": "https://api.launchpad.net/1.0/~thomasdstewart"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/393489", 
            "date_created": "2016-11-03 21:31:49.351995+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/393489\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=af8d93fa9da749033575fe8c3ac58cfac134c355\nSubmitter: Jenkins\nBranch:    master\n\ncommit af8d93fa9da749033575fe8c3ac58cfac134c355\nAuthor: Thomas Stewart <email address hidden>\nDate:   Thu Nov 3 21:08:04 2016 +0000\n\n    Add lan9118 as valid nic for hw_vif_model property for qemu\n    \n    DocImpact\n    This introduces an additional VNI so the hw_vif_model doc needs updating\n    to reflect this at:\n    https://docs.openstack.org/cli-reference/glance-property-keys.html\n    \n    Change-Id: Ifc1636bff53cf74f889e1f4b632fa62c52d07b8e\n    Closes-Bug: 1638059\n    Signed-off-by: Thomas Stewart <email address hidden>\n", 
            "date_created": "2017-03-23 12:37:17.394549+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 16.0.0.0b1 development milestone.", 
            "date_created": "2017-04-14 09:22:35.064527+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}