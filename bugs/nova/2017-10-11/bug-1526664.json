{
    "status": "Fix Released", 
    "last_updated": "2017-02-03 19:08:39.125620+00:00", 
    "description": "[Summary]\nwrong error message showing in \"nova show inst\" if boot an instance with invalid v4-fixed-ip\n\n[Topo]\ndevstack all-in-one node\n\n[Description and expect result]\nshould return an error message says that \"invalid v4-fixed-ip\"\n\n[Reproduceable or not]\nreproduceable \n\n[Recreate Steps]\n1) create a network/subnet, and boot an instance with invalid v4-fixed-ip:\nroot@45-59:/opt/stack/devstack# neutron net-list | grep net2\n| 2de63c95-f645-492c-9197-5d4d5244a8ba | net2    | 47eb5e03-c16a-4303-923c-21a061f2909e 1.0.0.0/24          |\nroot@45-59:/opt/stack/devstack# \n\nroot@45-59:/opt/stack/devstack# nova  boot  --flavor 1 --image  cirros-0.3.4-x86_64-uec  --availability-zone nova --nic net-id=2de63c95-f645-492c-9197-\n\n5d4d5244a8ba,v6-fixed-ip=1.0.0.255  inst \n\n(note: 1.0.0.255 is broadcast ip for the network, should be invalid.)\n\n2) wrong error message showing in \"nova show inst\":\nroot@45-59:/opt/stack/devstack# nova show inst\n+--------------------------------------\n\n+------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n-------------------------------+\n| Property                             | Value                                                                                                                \n\n                                                                     |\n+--------------------------------------\n\n+------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n-------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                                                                                               \n\n                                                                     |\n| OS-EXT-AZ:availability_zone          | nova                                                                                                                 \n\n                                                                     |\n| OS-EXT-SRV-ATTR:host                 | -                                                                                                                    \n\n                                                                     |\n| OS-EXT-SRV-ATTR:hostname             | inst                                                                                                                 \n\n                                                                     |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | -                                                                                                                    \n\n                                                                     |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000015                                                                                                    \n\n                                                                     |\n| OS-EXT-SRV-ATTR:kernel_id            | 0975d828-5725-4044-9477-046b0aa437f4                                                                                 \n\n                                                                     |\n| OS-EXT-SRV-ATTR:launch_index         | 0                                                                                                                    \n\n                                                                     |\n| OS-EXT-SRV-ATTR:ramdisk_id           | dea382c7-c36e-443f-8f9a-a0a6cef56337                                                                                 \n\n                                                                     |\n| OS-EXT-SRV-ATTR:reservation_id       | r-fwx0mk0q                                                                                                           \n\n                                                                     |\n| OS-EXT-SRV-ATTR:root_device_name     | /dev/vda                                                                                                             \n\n                                                                     |\n| OS-EXT-SRV-ATTR:user_data            | -                                                                                                                    \n\n                                                                     |\n| OS-EXT-STS:power_state               | 0                                                                                                                    \n\n                                                                     |\n| OS-EXT-STS:task_state                | -                                                                                                                    \n\n                                                                     |\n| OS-EXT-STS:vm_state                  | error                                                                                                                \n\n                                                                     |\n| OS-SRV-USG:launched_at               | -                                                                                                                    \n\n                                                                     |\n| OS-SRV-USG:terminated_at             | -                                                                                                                    \n\n                                                                     |\n| accessIPv4                           |                                                                                                                      \n\n                                                                     |\n| accessIPv6                           |                                                                                                                      \n\n                                                                     |\n| config_drive                         |                                                                                                                      \n\n                                                                     |\n| created                              | 2015-12-16T16:10:16Z                                                                                                 \n\n                                                                     |\n| fault                                | {\"message\": \"No valid host was found. There are not enough hosts available.\", \"code\": 500, \"details\": \"  File \n\n\\\"/opt/stack/nova/nova/conductor/manager.py\\\", line 359, in build_instances |            >>>>ISSUE, wrong error message\n|                                      |     request_spec, filter_properties)                                                                                 \n\n                                                                     |\n|                                      |   File \\\"/opt/stack/nova/nova/scheduler/utils.py\\\", line 343, in wrapped                                             \n\n                                                                     |\n|                                      |     return func(*args, **kwargs)                                                                                     \n\n                                                                     |\n|                                      |   File \\\"/opt/stack/nova/nova/scheduler/client/__init__.py\\\", line 52, in select_destinations                        \n\n                                                                     |\n|                                      |     context, request_spec, filter_properties)                                                                        \n\n                                                                     |\n|                                      |   File \\\"/opt/stack/nova/nova/scheduler/client/__init__.py\\\", line 37, in __run_method                               \n\n                                                                     |\n|                                      |     return getattr(self.instance, __name)(*args, **kwargs)                                                           \n\n                                                                     |\n|                                      |   File \\\"/opt/stack/nova/nova/scheduler/client/query.py\\\", line 34, in select_destinations                           \n\n                                                                     |\n|                                      |     context, request_spec, filter_properties)                                                                        \n\n                                                                     |\n|                                      |   File \\\"/opt/stack/nova/nova/scheduler/rpcapi.py\\\", line 122, in select_destinations                                \n\n                                                                     |\n|                                      |     request_spec=request_spec, filter_properties=filter_properties)                                                  \n\n                                                                     |\n|                                      |   File \\\"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/client.py\\\", line 158, in call                    \n\n                                                                     |\n|                                      |     retry=self.retry)                                                                                                \n\n                                                                     |\n|                                      |   File \\\"/usr/local/lib/python2.7/dist-packages/oslo_messaging/transport.py\\\", line 90, in _send                     \n\n                                                                     |\n|                                      |     timeout=timeout, retry=retry)                                                                                    \n\n                                                                     |\n|                                      |   File \\\"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\\\", line 464, in send           \n\n                                                                     |\n|                                      |     retry=retry)                                                                                                     \n\n                                                                     |\n|                                      |   File \\\"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\\\", line 455, in _send          \n\n                                                                     |\n|                                      |     raise result                                                                                                     \n\n                                                                     |\n|                                      | \", \"created\": \"2015-12-16T16:10:19Z\"}                                                                                \n\n                                                                     |\n| flavor                               | m1.tiny (1)                                                                                                          \n\n                                                                     |\n| hostId                               |                                                                                                                      \n\n                                                                     |\n| id                                   | 45e251bf-391e-4238-bbe9-254aeb37346e                                                                                 \n\n                                                                     |\n| image                                | cirros-0.3.4-x86_64-uec (8883fa03-0cf2-45a7-bcaf-ff5df9e11016)                                                       \n\n                                                                     |\n| key_name                             | -                                                                                                                    \n\n                                                                     |\n| metadata                             | {}                                                                                                                   \n\n                                                                     |\n| name                                 | inst                                                                                                                 \n\n                                                                     |\n| os-extended-volumes:volumes_attached | []                                                                                                                   \n\n                                                                     |\n| status                               | ERROR                                                                                                                \n\n                                                                     |\n| tenant_id                            | 6c15aacc1cfe4a9fac35a0c7f8c3e912                                                                                     \n\n                                                                     |\n| updated                              | 2015-12-16T16:10:18Z                                                                                                 \n\n                                                                     |\n| user_id                              | f701a3a4e9ad4a869e886c84e4dc327e                                                                                     \n\n                                                                     |\n+--------------------------------------\n\n+------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n-------------------------------+\nroot@45-59:/opt/stack/devstack# \n\nISSUE:   the error message says \"No valid host was found. There are not enough hosts available.\" , but actually the root cause of the error is invalid v4-fixed-ip. \n\n[Configration]\nreproduceable bug, no need\n\n[logs]\nreproduceable bug, no need\n\n[Root cause anlyze or debug inf]\nreproduceable bug\n\n[Attachment]\nNone", 
    "tags": [
        "compute"
    ], 
    "importance": "Low", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1526664", 
    "owner": "https://api.launchpad.net/1.0/~siva-radhakrishnan", 
    "id": 1526664, 
    "index": 641, 
    "created": "2015-12-16 08:23:45.585344+00:00", 
    "title": "wrong error message showing in 'nova show inst' if boot an instance with invalid v4-fixed-ip", 
    "comments": [
        {
            "content": "[Summary]\nwrong error message showing in \"nova show inst\" if boot an instance with invalid v4-fixed-ip\n\n[Topo]\ndevstack all-in-one node\n\n[Description and expect result]\nshould return an error message says that \"invalid v4-fixed-ip\"\n\n[Reproduceable or not]\nreproduceable \n\n[Recreate Steps]\n1) create a network/subnet, and boot an instance with invalid v4-fixed-ip:\nroot@45-59:/opt/stack/devstack# neutron net-list | grep net2\n| 2de63c95-f645-492c-9197-5d4d5244a8ba | net2    | 47eb5e03-c16a-4303-923c-21a061f2909e 1.0.0.0/24          |\nroot@45-59:/opt/stack/devstack# \n\nroot@45-59:/opt/stack/devstack# nova  boot  --flavor 1 --image  cirros-0.3.4-x86_64-uec  --availability-zone nova --nic net-id=2de63c95-f645-492c-9197-\n\n5d4d5244a8ba,v6-fixed-ip=1.0.0.255  inst \n\n(note: 1.0.0.255 is broadcast ip for the network, should be invalid.)\n\n2) wrong error message showing in \"nova show inst\":\nroot@45-59:/opt/stack/devstack# nova show inst\n+--------------------------------------\n\n+------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n-------------------------------+\n| Property                             | Value                                                                                                                \n\n                                                                     |\n+--------------------------------------\n\n+------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n-------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                                                                                               \n\n                                                                     |\n| OS-EXT-AZ:availability_zone          | nova                                                                                                                 \n\n                                                                     |\n| OS-EXT-SRV-ATTR:host                 | -                                                                                                                    \n\n                                                                     |\n| OS-EXT-SRV-ATTR:hostname             | inst                                                                                                                 \n\n                                                                     |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | -                                                                                                                    \n\n                                                                     |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000015                                                                                                    \n\n                                                                     |\n| OS-EXT-SRV-ATTR:kernel_id            | 0975d828-5725-4044-9477-046b0aa437f4                                                                                 \n\n                                                                     |\n| OS-EXT-SRV-ATTR:launch_index         | 0                                                                                                                    \n\n                                                                     |\n| OS-EXT-SRV-ATTR:ramdisk_id           | dea382c7-c36e-443f-8f9a-a0a6cef56337                                                                                 \n\n                                                                     |\n| OS-EXT-SRV-ATTR:reservation_id       | r-fwx0mk0q                                                                                                           \n\n                                                                     |\n| OS-EXT-SRV-ATTR:root_device_name     | /dev/vda                                                                                                             \n\n                                                                     |\n| OS-EXT-SRV-ATTR:user_data            | -                                                                                                                    \n\n                                                                     |\n| OS-EXT-STS:power_state               | 0                                                                                                                    \n\n                                                                     |\n| OS-EXT-STS:task_state                | -                                                                                                                    \n\n                                                                     |\n| OS-EXT-STS:vm_state                  | error                                                                                                                \n\n                                                                     |\n| OS-SRV-USG:launched_at               | -                                                                                                                    \n\n                                                                     |\n| OS-SRV-USG:terminated_at             | -                                                                                                                    \n\n                                                                     |\n| accessIPv4                           |                                                                                                                      \n\n                                                                     |\n| accessIPv6                           |                                                                                                                      \n\n                                                                     |\n| config_drive                         |                                                                                                                      \n\n                                                                     |\n| created                              | 2015-12-16T16:10:16Z                                                                                                 \n\n                                                                     |\n| fault                                | {\"message\": \"No valid host was found. There are not enough hosts available.\", \"code\": 500, \"details\": \"  File \n\n\\\"/opt/stack/nova/nova/conductor/manager.py\\\", line 359, in build_instances |            >>>>ISSUE, wrong error message\n|                                      |     request_spec, filter_properties)                                                                                 \n\n                                                                     |\n|                                      |   File \\\"/opt/stack/nova/nova/scheduler/utils.py\\\", line 343, in wrapped                                             \n\n                                                                     |\n|                                      |     return func(*args, **kwargs)                                                                                     \n\n                                                                     |\n|                                      |   File \\\"/opt/stack/nova/nova/scheduler/client/__init__.py\\\", line 52, in select_destinations                        \n\n                                                                     |\n|                                      |     context, request_spec, filter_properties)                                                                        \n\n                                                                     |\n|                                      |   File \\\"/opt/stack/nova/nova/scheduler/client/__init__.py\\\", line 37, in __run_method                               \n\n                                                                     |\n|                                      |     return getattr(self.instance, __name)(*args, **kwargs)                                                           \n\n                                                                     |\n|                                      |   File \\\"/opt/stack/nova/nova/scheduler/client/query.py\\\", line 34, in select_destinations                           \n\n                                                                     |\n|                                      |     context, request_spec, filter_properties)                                                                        \n\n                                                                     |\n|                                      |   File \\\"/opt/stack/nova/nova/scheduler/rpcapi.py\\\", line 122, in select_destinations                                \n\n                                                                     |\n|                                      |     request_spec=request_spec, filter_properties=filter_properties)                                                  \n\n                                                                     |\n|                                      |   File \\\"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/client.py\\\", line 158, in call                    \n\n                                                                     |\n|                                      |     retry=self.retry)                                                                                                \n\n                                                                     |\n|                                      |   File \\\"/usr/local/lib/python2.7/dist-packages/oslo_messaging/transport.py\\\", line 90, in _send                     \n\n                                                                     |\n|                                      |     timeout=timeout, retry=retry)                                                                                    \n\n                                                                     |\n|                                      |   File \\\"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\\\", line 464, in send           \n\n                                                                     |\n|                                      |     retry=retry)                                                                                                     \n\n                                                                     |\n|                                      |   File \\\"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\\\", line 455, in _send          \n\n                                                                     |\n|                                      |     raise result                                                                                                     \n\n                                                                     |\n|                                      | \", \"created\": \"2015-12-16T16:10:19Z\"}                                                                                \n\n                                                                     |\n| flavor                               | m1.tiny (1)                                                                                                          \n\n                                                                     |\n| hostId                               |                                                                                                                      \n\n                                                                     |\n| id                                   | 45e251bf-391e-4238-bbe9-254aeb37346e                                                                                 \n\n                                                                     |\n| image                                | cirros-0.3.4-x86_64-uec (8883fa03-0cf2-45a7-bcaf-ff5df9e11016)                                                       \n\n                                                                     |\n| key_name                             | -                                                                                                                    \n\n                                                                     |\n| metadata                             | {}                                                                                                                   \n\n                                                                     |\n| name                                 | inst                                                                                                                 \n\n                                                                     |\n| os-extended-volumes:volumes_attached | []                                                                                                                   \n\n                                                                     |\n| status                               | ERROR                                                                                                                \n\n                                                                     |\n| tenant_id                            | 6c15aacc1cfe4a9fac35a0c7f8c3e912                                                                                     \n\n                                                                     |\n| updated                              | 2015-12-16T16:10:18Z                                                                                                 \n\n                                                                     |\n| user_id                              | f701a3a4e9ad4a869e886c84e4dc327e                                                                                     \n\n                                                                     |\n+--------------------------------------\n\n+------------------------------------------------------------------------------------------------------------------------------------------------------------\n\n-------------------------------+\nroot@45-59:/opt/stack/devstack# \n\nISSUE:   the error message says \"No valid host was found. There are not enough hosts available.\" , but actually the root cause of the error is invalid v4-fixed-ip. \n\n[Configration]\nreproduceable bug, no need\n\n[logs]\nreproduceable bug, no need\n\n[Root cause anlyze or debug inf]\nreproduceable bug\n\n[Attachment]\nNone", 
            "date_created": "2015-12-16 08:23:45.585344+00:00", 
            "author": "https://api.launchpad.net/1.0/~hgangwx"
        }, 
        {
            "content": "there's a traceback in nova-compute and a corresponding error message in nova-conductor:\n\n2015-12-16 14:12:07.973 ERROR nova.scheduler.utils [req-d2022d89-1760-4bf9-8cca-770459af973a admin admin] [instance: a279e136-b1ba-430c-acb7-baf8150bbfc8] Error from last host: stack (node stack): [u'Traceback (most recent call last):\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 1902, in _do_build_and_run_instance\\n    filter_properties)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 2066, in _build_and_run_instance\\n    instance_uuid=instance.uuid, reason=six.text_type(e))\\n', u'RescheduledException: Build of instance a279e136-b1ba-430c-acb7-baf8150bbfc8 was re-scheduled: Invalid input received: Fixed IP 10.0.0.0 is not a valid ip address for network 507726a3-784f-44bf-924d-a5cf4288c1de.\\n']\n\nThis is the real reason of boot failure, I think we should print this in the falt section in VM info", 
            "date_created": "2015-12-16 11:14:23.194801+00:00", 
            "author": "https://api.launchpad.net/1.0/~bochi-michael"
        }, 
        {
            "content": "No activity for more than 60 days, taking off current assignee.", 
            "date_created": "2016-04-18 18:00:37.402478+00:00", 
            "author": "https://api.launchpad.net/1.0/~sarafraj-singh"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/397941", 
            "date_created": "2016-11-15 20:43:20.928754+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/397941\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=0a7f3cebec400e2b5fdcea365e451a007a6d0a6f\nSubmitter: Jenkins\nBranch:    master\n\ncommit 0a7f3cebec400e2b5fdcea365e451a007a6d0a6f\nAuthor: Sivasathurappan Radhakrishnan <email address hidden>\nDate:   Tue Nov 15 20:32:35 2016 +0000\n\n    Raise InvalidInput exception\n    \n    If invalid input like v4-fixed-ip is given while creating instance,\n    it raises rescheduled exception as it is not handled. This patch\n    raises invalid input exception and aborts the build of instance.\n    \n    Change-Id: I7c4af81ddbb94dde42e889cdb559b59438cf0231\n    Closes-bug:1526664\n", 
            "date_created": "2017-01-28 02:17:31.556870+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 15.0.0.0rc1 release candidate.", 
            "date_created": "2017-02-03 19:08:38.431926+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}