{
    "status": "Invalid", 
    "last_updated": "2016-11-09 02:02:12.803039+00:00", 
    "description": "When creating a keypair, we get the following tracelog in nova api log:\n\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions [req-4aeca8b7-2616-4eea-a092-c18c669ba91b 57b7e0d93f354d789392d8f06561f85f 2a12f4e0d4e54a18a7102087eb7def77 - - -] Unexpected exception in API method\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/api/openstack/extensions.py\", line 478, in wrapped\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/api/openstack/compute/keypairs.py\", line 111, in create\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return self._create(req, body)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/api/openstack/compute/keypairs.py\", line 132, in _create\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     context, user_id, name, key_type)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/exception.py\", line 110, in wrapped\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     payload)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 221, in __exit__\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     self.force_reraise()\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 197, in force_reraise\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/exception.py\", line 89, in wrapped\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return f(self, context, *args, **kw)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/compute/api.py\", line 4009, in create_key_pair\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     user_id, key_type)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/compute/api.py\", line 4031, in _generate_key_pair\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return crypto.generate_key_pair()\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/crypto.py\", line 185, in generate_key_pair\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     key = generate_key(bits)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/crypto.py\", line 177, in generate_key\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     key = paramiko.RSAKey(vals=(rsa.e, rsa.n))\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions TypeError: __init__() got an unexpected keyword argument 'vals'\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions \n2016-11-03 14:47:35.485 649 INFO nova.api.openstack.wsgi [req-4aeca8b7-2616-4eea-a092-c18c669ba91b 57b7e0d93f354d789392d8f06561f85f 2a12f4e0d4e54a18a7102087eb7def77 - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'>\n2016-11-03 14:47:35.485 649 DEBUG nova.api.openstack.wsgi [req-4aeca8b7-2616-4eea-a092-c18c669ba91b 57b7e0d93f354d789392d8f06561f85f 2a12f4e0d4e54a18a7102087eb7def77 - - -] Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n\nImport works fine.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1639057", 
    "owner": "None", 
    "id": 1639057, 
    "index": 6513, 
    "created": "2016-11-03 21:50:33.744216+00:00", 
    "title": "Nova API Error when creating key pair on stable/mitaka", 
    "comments": [
        {
            "content": "When creating a keypair, we get the following tracelog in nova api log:\n\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions [req-4aeca8b7-2616-4eea-a092-c18c669ba91b 57b7e0d93f354d789392d8f06561f85f 2a12f4e0d4e54a18a7102087eb7def77 - - -] Unexpected exception in API method\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/api/openstack/extensions.py\", line 478, in wrapped\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/api/openstack/compute/keypairs.py\", line 111, in create\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return self._create(req, body)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/api/openstack/compute/keypairs.py\", line 132, in _create\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     context, user_id, name, key_type)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/exception.py\", line 110, in wrapped\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     payload)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 221, in __exit__\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     self.force_reraise()\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 197, in force_reraise\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/exception.py\", line 89, in wrapped\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return f(self, context, *args, **kw)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/compute/api.py\", line 4009, in create_key_pair\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     user_id, key_type)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/compute/api.py\", line 4031, in _generate_key_pair\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     return crypto.generate_key_pair()\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/crypto.py\", line 185, in generate_key_pair\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     key = generate_key(bits)\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions   File \"/opt/mhos/openstack/nova/local/lib/python2.7/site-packages/nova/crypto.py\", line 177, in generate_key\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions     key = paramiko.RSAKey(vals=(rsa.e, rsa.n))\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions TypeError: __init__() got an unexpected keyword argument 'vals'\n2016-11-03 14:47:35.484 649 ERROR nova.api.openstack.extensions \n2016-11-03 14:47:35.485 649 INFO nova.api.openstack.wsgi [req-4aeca8b7-2616-4eea-a092-c18c669ba91b 57b7e0d93f354d789392d8f06561f85f 2a12f4e0d4e54a18a7102087eb7def77 - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'>\n2016-11-03 14:47:35.485 649 DEBUG nova.api.openstack.wsgi [req-4aeca8b7-2616-4eea-a092-c18c669ba91b 57b7e0d93f354d789392d8f06561f85f 2a12f4e0d4e54a18a7102087eb7def77 - - -] Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n\nImport works fine.", 
            "date_created": "2016-11-03 21:50:33.744216+00:00", 
            "author": "https://api.launchpad.net/1.0/~jjahns"
        }, 
        {
            "content": "What version of paramiko do you have? stable/mitaka requires paramiko>=1.16.0 and is tested against that version.\n\nAnd the vals keyword is in there:\n\nhttps://github.com/paramiko/paramiko/blob/v1.16.0/paramiko/rsakey.py#L45", 
            "date_created": "2016-11-04 22:23:42.816271+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "(nova) root@osctrl01:/opt/mhos/openstack/nova# pip list | grep paramiko\nparamiko (2.0.0)\n", 
            "date_created": "2016-11-05 00:32:21.052165+00:00", 
            "author": "https://api.launchpad.net/1.0/~jjahns"
        }, 
        {
            "content": "Looking at 2.0 vals was removed.\n\nThis appears to be an issue still because if we are selecting >-1.16.0 and 2.0 gets selected vals is missing from the line.\n\nhttps://github.com/paramiko/paramiko/blob/2.0/paramiko/rsakey.py#L39\n\nWe need to remove the invalid state.", 
            "date_created": "2016-11-05 00:33:59.591017+00:00", 
            "author": "https://api.launchpad.net/1.0/~jjahns"
        }, 
        {
            "content": "The upper-constraint for paramiko in stable/mitaka is 1.16.0:\n\nhttps://github.com/openstack/requirements/blob/stable/mitaka/upper-constraints.txt#L235\n\n2.0.0 was never tested in the upstream CI system and won't work, as you've noticed. Deployments should be using upper-constraints if they aren't going to be installing services in venvs or containers. So this isn't something that we're going to fix in nova on stable/mitaka.", 
            "date_created": "2016-11-09 02:02:03.972942+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }
    ]
}