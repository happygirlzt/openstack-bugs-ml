{
    "status": "Invalid", 
    "last_updated": "2013-09-23 22:48:10.829519+00:00", 
    "description": "This has been happening in the hourly tempest runs. Here are some recent examples:\n\nhttps://jenkins.openstack.org/job/periodic-tempest-devstack-vm-check-hourly/77/console\n03:44:06 ERROR: Specify a keypair while creating a server\n03:44:06 ----------------------------------------------------------------------\n03:44:06 Traceback (most recent call last):\n03:44:06   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 86, in test_create_specify_keypair\n03:44:06     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n03:44:06   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n03:44:06     raise exceptions.BuildErrorException(server_id=server_id)\n03:44:06 BuildErrorException: Server 809a992b-9e34-4e14-9ead-3b536355ff71 failed to build and is in ERROR status\n03:44:06 \n\n\n\nhttps://jenkins.openstack.org/job/periodic-tempest-devstack-vm-check-hourly/78/console\n04:43:26 ERROR: Delete a server while it's VM state is Building\n04:43:26 ----------------------------------------------------------------------\n04:43:26 Traceback (most recent call last):\n04:43:26   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 148, in test_delete_server_while_in_building_state\n04:43:26     self.client.wait_for_server_status(server['id'], 'BUILD')\n04:43:26   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n04:43:26     raise exceptions.BuildErrorException(server_id=server_id)\n04:43:26 BuildErrorException: Server 8b152f72-4f69-406f-a45a-a40490013bae failed to build and is in ERROR status\n04:43:26 \n04:43:26 ======================================================================\n04:43:26 ERROR: The server's access addresses should reflect the provided values\n04:43:26 ----------------------------------------------------------------------\n04:43:26 Traceback (most recent call last):\n04:43:26   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 125, in test_update_access_server_address\n04:43:26     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n04:43:26   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n04:43:26     raise exceptions.BuildErrorException(server_id=server_id)\n04:43:26 BuildErrorException: Server b708f30f-69d3-463d-98df-099b68acc308 failed to build and is in ERROR status\n04:43:26 \n04:43:26 ======================================================================\n04:43:26 ERROR: The server name should be changed to the the provided value\n04:43:26 ----------------------------------------------------------------------\n04:43:26 Traceback (most recent call last):\n04:43:26   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 100, in test_update_server_name\n04:43:26     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n04:43:26   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n04:43:26     raise exceptions.BuildErrorException(server_id=server_id)\n04:43:26 BuildErrorException: Server 60d60b56-6d87-48ef-aed3-2a57c30b014f failed to build and is in ERROR status\n04:4\n\n\n\n\nhttps://jenkins.openstack.org/job/periodic-tempest-devstack-vm-check-hourly/85/console\n11:43:18 ERROR: Specify a keypair while creating a server\n11:43:18 ----------------------------------------------------------------------\n11:43:18 Traceback (most recent call last):\n11:43:18   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 86, in test_create_specify_keypair\n11:43:18     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n11:43:18   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n11:43:18     raise exceptions.BuildErrorException(server_id=server_id)\n11:43:18 BuildErrorException: Server 646858c1-109c-42bf-921f-d58281686ea7 failed to build and is in ERROR status\n11:43:18 \n11:43:18 ======================================================================\n11:43:18 ERROR: Creating a server with a name that already exists is allowed\n11:43:18 ----------------------------------------------------------------------\n11:43:18 Traceback (most recent call last):\n11:43:18   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 68, in test_create_with_existing_server_name\n11:43:18     for server_id in (id1, id2):\n11:43:18 UnboundLocalError: local variable 'id1' referenced before assignment\n11:43:18 \n11:43:18 ======================================================================\n11:43:18 ERROR: Delete a server while it's VM state is Building\n11:43:18 ----------------------------------------------------------------------\n11:43:18 Traceback (most recent call last):\n11:43:18   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 148, in test_delete_server_while_in_building_state\n11:43:18     self.client.wait_for_server_status(server['id'], 'BUILD')\n11:43:18   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n11:43:18     raise exceptions.BuildErrorException(server_id=server_id)\n11:43:18 BuildErrorException: Server d3bc54f7-8914-4156-abba-600bc54d2550 failed to build and is in ERROR status\n11:43:18 \n11:43:18 ======================================================================\n11:43:18 ERROR: The server's access addresses should reflect the provided values\n11:43:18 ----------------------------------------------------------------------\n11:43:18 Traceback (most recent call last):\n11:43:18   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 125, in test_update_access_server_address\n11:43:18     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n11:43:18   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n11:43:18     raise exceptions.BuildErrorException(server_id=server_id)\n11:43:18 BuildErrorException: Server 245309e8-1645-4331-a9d0-d0ed9e8028bb failed to build and is in ERROR status\n11:43:18 \n11:43:18 ======================================================================\n11:43:18 ERROR: The server name should be changed to the the provided value\n11:43:18 ----------------------------------------------------------------------\n11:43:18 Traceback (most recent call last):\n11:43:18   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 100, in test_update_server_name\n11:43:18     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n11:43:18   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n11:43:18     raise exceptions.BuildErrorException(server_id=server_id)\n11:43:18 BuildErrorException: Server 4db93eed-365e-4721-9f5b-09c10b745c3f failed to build and is in ERROR status", 
    "tags": [], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1079687", 
    "owner": "https://api.launchpad.net/1.0/~sdague", 
    "id": 1079687, 
    "index": 884, 
    "created": "2012-11-16 13:59:52.250415+00:00", 
    "title": "Flaky failures of instances to reach BUILD and ACTIVE states", 
    "comments": [
        {
            "content": "This has been happening in the hourly tempest runs. Here are some recent examples:\n\nhttps://jenkins.openstack.org/job/periodic-tempest-devstack-vm-check-hourly/77/console\n03:44:06 ERROR: Specify a keypair while creating a server\n03:44:06 ----------------------------------------------------------------------\n03:44:06 Traceback (most recent call last):\n03:44:06   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 86, in test_create_specify_keypair\n03:44:06     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n03:44:06   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n03:44:06     raise exceptions.BuildErrorException(server_id=server_id)\n03:44:06 BuildErrorException: Server 809a992b-9e34-4e14-9ead-3b536355ff71 failed to build and is in ERROR status\n03:44:06 \n\n\n\nhttps://jenkins.openstack.org/job/periodic-tempest-devstack-vm-check-hourly/78/console\n04:43:26 ERROR: Delete a server while it's VM state is Building\n04:43:26 ----------------------------------------------------------------------\n04:43:26 Traceback (most recent call last):\n04:43:26   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 148, in test_delete_server_while_in_building_state\n04:43:26     self.client.wait_for_server_status(server['id'], 'BUILD')\n04:43:26   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n04:43:26     raise exceptions.BuildErrorException(server_id=server_id)\n04:43:26 BuildErrorException: Server 8b152f72-4f69-406f-a45a-a40490013bae failed to build and is in ERROR status\n04:43:26 \n04:43:26 ======================================================================\n04:43:26 ERROR: The server's access addresses should reflect the provided values\n04:43:26 ----------------------------------------------------------------------\n04:43:26 Traceback (most recent call last):\n04:43:26   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 125, in test_update_access_server_address\n04:43:26     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n04:43:26   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n04:43:26     raise exceptions.BuildErrorException(server_id=server_id)\n04:43:26 BuildErrorException: Server b708f30f-69d3-463d-98df-099b68acc308 failed to build and is in ERROR status\n04:43:26 \n04:43:26 ======================================================================\n04:43:26 ERROR: The server name should be changed to the the provided value\n04:43:26 ----------------------------------------------------------------------\n04:43:26 Traceback (most recent call last):\n04:43:26   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 100, in test_update_server_name\n04:43:26     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n04:43:26   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n04:43:26     raise exceptions.BuildErrorException(server_id=server_id)\n04:43:26 BuildErrorException: Server 60d60b56-6d87-48ef-aed3-2a57c30b014f failed to build and is in ERROR status\n04:4\n\n\n\n\nhttps://jenkins.openstack.org/job/periodic-tempest-devstack-vm-check-hourly/85/console\n11:43:18 ERROR: Specify a keypair while creating a server\n11:43:18 ----------------------------------------------------------------------\n11:43:18 Traceback (most recent call last):\n11:43:18   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 86, in test_create_specify_keypair\n11:43:18     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n11:43:18   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n11:43:18     raise exceptions.BuildErrorException(server_id=server_id)\n11:43:18 BuildErrorException: Server 646858c1-109c-42bf-921f-d58281686ea7 failed to build and is in ERROR status\n11:43:18 \n11:43:18 ======================================================================\n11:43:18 ERROR: Creating a server with a name that already exists is allowed\n11:43:18 ----------------------------------------------------------------------\n11:43:18 Traceback (most recent call last):\n11:43:18   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 68, in test_create_with_existing_server_name\n11:43:18     for server_id in (id1, id2):\n11:43:18 UnboundLocalError: local variable 'id1' referenced before assignment\n11:43:18 \n11:43:18 ======================================================================\n11:43:18 ERROR: Delete a server while it's VM state is Building\n11:43:18 ----------------------------------------------------------------------\n11:43:18 Traceback (most recent call last):\n11:43:18   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 148, in test_delete_server_while_in_building_state\n11:43:18     self.client.wait_for_server_status(server['id'], 'BUILD')\n11:43:18   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n11:43:18     raise exceptions.BuildErrorException(server_id=server_id)\n11:43:18 BuildErrorException: Server d3bc54f7-8914-4156-abba-600bc54d2550 failed to build and is in ERROR status\n11:43:18 \n11:43:18 ======================================================================\n11:43:18 ERROR: The server's access addresses should reflect the provided values\n11:43:18 ----------------------------------------------------------------------\n11:43:18 Traceback (most recent call last):\n11:43:18   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 125, in test_update_access_server_address\n11:43:18     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n11:43:18   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n11:43:18     raise exceptions.BuildErrorException(server_id=server_id)\n11:43:18 BuildErrorException: Server 245309e8-1645-4331-a9d0-d0ed9e8028bb failed to build and is in ERROR status\n11:43:18 \n11:43:18 ======================================================================\n11:43:18 ERROR: The server name should be changed to the the provided value\n11:43:18 ----------------------------------------------------------------------\n11:43:18 Traceback (most recent call last):\n11:43:18   File \"/opt/stack/tempest/tempest/tests/compute/servers/test_servers.py\", line 100, in test_update_server_name\n11:43:18     self.client.wait_for_server_status(server['id'], 'ACTIVE')\n11:43:18   File \"/opt/stack/tempest/tempest/services/compute/xml/servers_client.py\", line 195, in wait_for_server_status\n11:43:18     raise exceptions.BuildErrorException(server_id=server_id)\n11:43:18 BuildErrorException: Server 4db93eed-365e-4721-9f5b-09c10b745c3f failed to build and is in ERROR status", 
            "date_created": "2012-11-16 13:59:52.250415+00:00", 
            "author": "https://api.launchpad.net/1.0/~david-kranz"
        }, 
        {
            "content": "Anyway to get the server side logs when this problem occurs?", 
            "date_created": "2012-11-16 14:50:14.026749+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "Yes. Go to http://logs.openstack.org/periodic/periodic-tempest-devstack-vm-check-hourly/ and append the build number.\nFor the first one: http://logs.openstack.org/periodic/periodic-tempest-devstack-vm-check-hourly/77/logs/\n\nRemember that a lot of the ERRORs will be red herrings. See https://bugs.launchpad.net/nova/+bug/1079210", 
            "date_created": "2012-11-16 15:06:44.035369+00:00", 
            "author": "https://api.launchpad.net/1.0/~david-kranz"
        }, 
        {
            "content": "looks like all the logs get truncated just before we get the ERROR back, for \n\nExample in 96 the ERROR happens at 22:43:03 (https://jenkins.openstack.org/job/periodic-tempest-devstack-vm-check-hourly/96/consoleFull) \n\nThe last entry in n-api.txt is 22:41:39 and n-cpu stops at 22:42:44\n\nIs some kind of timeout killing all the process(es)? Even the kern_log.txt stops at 22:42:43\n\n\n\n\n\n", 
            "date_created": "2012-11-17 00:56:54.064943+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "This  happened three or four times today.", 
            "date_created": "2012-11-18 04:12:17.055393+00:00", 
            "author": "https://api.launchpad.net/1.0/~david-kranz"
        }, 
        {
            "content": "I did an analysis of the last 200+ hourly runs.  40 of them failed and almost all of the errors are from /tempest/tests/compute/servers/test_servers.py. In these failures the instance reaches ERROR state quickly. This is not a timeout issue. There is also an intermittent failure in exercises where an instance fails to create in the 60 seconds allowed. Here is an example: \n\nhttp://logs.openstack.org/16591/1/gate/gate-tempest-devstack-vm/19391/console.html", 
            "date_created": "2012-11-21 14:45:49.143640+00:00", 
            "author": "https://api.launchpad.net/1.0/~david-kranz"
        }, 
        {
            "content": "David,\n\nThat 16591 seems to be rpc timeout related\n\nhttp://logs.openstack.org/16591/1/gate/gate-tempest-devstack-vm/19391/logs/screen-n-cpu.txt.gz\n\n-- dims\n\n2012-11-20 23:16:14 21855 DEBUG nova.manager [-] Running periodic task ComputeManager._poll_rebooting_instances periodic_tasks /opt/stack/nova/nova/manager.py:171\n2012-11-20 23:16:14 21855 DEBUG nova.manager [-] Skipping ComputeManager._cleanup_running_deleted_instances, 28 ticks left until next run periodic_tasks /opt/stack/nova/nova/manager.py:166\n2012-11-20 23:16:14 21855 DEBUG nova.manager [-] Running periodic task ComputeManager._check_instance_build_time periodic_tasks /opt/stack/nova/nova/manager.py:171\n2012-11-20 23:16:14 21855 DEBUG nova.manager [-] Running periodic task ComputeManager._heal_instance_info_cache periodic_tasks /opt/stack/nova/nova/manager.py:171\n2012-11-20 23:16:14 21855 DEBUG nova.openstack.common.rpc.amqp [-] Making asynchronous call on network ... multicall /opt/stack/nova/nova/openstack/common/rpc/amqp.py:352\n2012-11-20 23:16:14 21855 DEBUG nova.openstack.common.rpc.amqp [-] MSG_ID is e0b7dcdbf50f4ef99c907163773d8281 multicall /opt/stack/nova/nova/openstack/common/rpc/amqp.py:355\n2012-11-20 23:16:39 21855 ERROR nova.openstack.common.rpc.common [-] Timed out waiting for RPC response: timed out\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common Traceback (most recent call last):\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common   File \"/opt/stack/nova/nova/openstack/common/rpc/impl_kombu.py\", line 552, in ensure\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common     return method(*args, **kwargs)\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common   File \"/opt/stack/nova/nova/openstack/common/rpc/impl_kombu.py\", line 630, in _consume\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common     return self.connection.drain_events(timeout=timeout)\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common   File \"/usr/local/lib/python2.7/dist-packages/kombu/connection.py\", line 110, in drain_events\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common     return self.transport.drain_events(self.connection, **kwargs)\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common   File \"/usr/local/lib/python2.7/dist-packages/kombu/transport/pyamqplib.py\", line 200, in drain_events\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common     return connection.drain_events(**kwargs)\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common   File \"/usr/local/lib/python2.7/dist-packages/kombu/transport/pyamqplib.py\", line 50, in drain_events\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common     return self.wait_multi(self.channels.values(), timeout=timeout)\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common   File \"/usr/local/lib/python2.7/dist-packages/kombu/transport/pyamqplib.py\", line 56, in wait_multi\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common     chanmap.keys(), allowed_methods, timeout=timeout)\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common   File \"/usr/local/lib/python2.7/dist-packages/kombu/transport/pyamqplib.py\", line 104, in _wait_multiple\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common     channel, method_sig, args, content = self.read_timeout(timeout)\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common   File \"/usr/local/lib/python2.7/dist-packages/kombu/transport/pyamqplib.py\", line 86, in read_timeout\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common     return self.method_reader.read_method()\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common   File \"/usr/local/lib/python2.7/dist-packages/amqplib/client_0_8/method_framing.py\", line 215, in read_method\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common     raise m\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common timeout: timed out\n2012-11-20 23:16:39 21855 TRACE nova.openstack.common.rpc.common \n2012-11-20 23:16:39 ERROR nova.compute.manager [req-6a569cb6-8802-45f3-bf8d-f446845bfdd1 demo demo] [instance: 99e14d05-f48b-4e87-94ce-5e54cada913a] Error: ['Traceback (most recent call last):\\n', '  File \"/opt/stack/nova/nova/compute/manager.py\", line 593, in _run_instance\\n    requested_networks)\\n', '  File \"/opt/stack/nova/nova/compute/manager.py\", line 821, in _allocate_network\\n    requested_networks=requested_networks)\\n', '  File \"/opt/stack/nova/nova/network/api.py\", line 43, in wrapper\\n    res = f(self, context, *args, **kwargs)\\n', '  File \"/opt/stack/nova/nova/network/api.py\", line 200, in allocate_for_instance\\n    nw_info = self.network_rpcapi.allocate_for_instance(context, **args)\\n', '  File \"/opt/stack/nova/nova/network/rpcapi.py\", line 144, in allocate_for_instance\\n    vpn=vpn, requested_networks=requested_networks))\\n', '  File \"/opt/stack/nova/nova/openstack/common/rpc/proxy.py\", line 80, in call\\n    return rpc.call(context, self._get_topic(topic), msg, timeout)\\n', '  File \"/opt/stack/nova/nova/openstack/common/rpc/__init__.py\", line 108, in call\\n    return _get_impl().call(cfg.CONF, context, topic, msg, timeout)\\n', '  File \"/opt/stack/nova/nova/openstack/common/rpc/impl_kombu.py\", line 754, in call\\n    rpc_amqp.get_connection_pool(conf, Connection))\\n', '  File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 369, in call\\n    rv = list(rv)\\n', '  File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 330, in __iter__\\n    self.done()\\n', '  File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\\n    self.gen.next()\\n', '  File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 327, in __iter__\\n    self._iterator.next()\\n', '  File \"/opt/stack/nova/nova/openstack/common/rpc/impl_kombu.py\", line 635, in iterconsume\\n    yield self.ensure(_error_callback, _consume)\\n', '  File \"/opt/stack/nova/nova/openstack/common/rpc/impl_kombu.py\", line 555, in ensure\\n    error_callback(e)\\n', '  File \"/opt/stack/nova/nova/openstack/common/rpc/impl_kombu.py\", line 616, in _error_callback\\n    raise rpc_common.Timeout()\\n', 'Timeout: Timeout while waiting on RPC response.\\n']\n2012-11-20 23:16:40 DEBUG nova.openstack.common.lockutils [req-6a569cb6-8802-45f3-bf8d-f446845bfdd1 demo demo] Got semaphore \"compute_resources\" for method \"update_usage\"... inner /opt/stack/nova/nova/openstack/common/lockutils.py:185\n2012-11-20 23:16:40 DEBUG nova.openstack.common.lockutils [req-6a569cb6-8802-45f3-bf8d-f446845bfdd1 demo demo] Got semaphore \"compute_resources\" for method \"update_usage\"... inner /opt/stack/nova/nova/openstack/common/lockutils.py:185\n2012-11-20 23:16:40 21855 ERROR nova.openstack.common.rpc.amqp [-] Exception during message handling\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 276, in _process_data\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 145, in dispatch\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 115, in wrapped\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 90, in wrapped\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kw)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 191, in decorated_function\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     pass\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 177, in decorated_function\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 218, in decorated_function\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     kwargs['instance']['uuid'], e, sys.exc_info())\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 206, in decorated_function\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 949, in run_instance\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     do_run_instance()\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/lockutils.py\", line 228, in inner\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     retval = f(*args, **kwargs)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 948, in do_run_instance\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     admin_password, is_first_time, instance)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 624, in _run_instance\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self._set_instance_error_state(context, instance['uuid'])\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 612, in _run_instance\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     is_first_time, request_spec, filter_properties)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 643, in _reschedule_or_reraise\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self._deallocate_network(context, instance)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 883, in _deallocate_network\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self.network_api.deallocate_for_instance(context, instance)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/api.py\", line 211, in deallocate_for_instance\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self.network_rpcapi.deallocate_for_instance(context, **args)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/rpcapi.py\", line 148, in deallocate_for_instance\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     instance_id=instance_id, project_id=project_id, host=host))\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/proxy.py\", line 80, in call\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     return rpc.call(context, self._get_topic(topic), msg, timeout)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/__init__.py\", line 108, in call\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     return _get_impl().call(cfg.CONF, context, topic, msg, timeout)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/impl_kombu.py\", line 754, in call\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     rpc_amqp.get_connection_pool(conf, Connection))\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 369, in call\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     rv = list(rv)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 330, in __iter__\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self.done()\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 327, in __iter__\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     self._iterator.next()\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/impl_kombu.py\", line 635, in iterconsume\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     yield self.ensure(_error_callback, _consume)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/impl_kombu.py\", line 555, in ensure\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     error_callback(e)\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/impl_kombu.py\", line 616, in _error_callback\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp     raise rpc_common.Timeout()\n2012-11-20 23:16:40 21855 TRACE nova.openstack.common.rpc.amqp Timeout: Timeout while waiting on RPC response.", 
            "date_created": "2012-11-23 21:04:35.716085+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "When I said this was not a timeout issue, I meant that from the tempest perspective the test is not failing because it took too long to get to the expected state. The instance goes to the ERROR state quickly. It is of course possible that the bad behavior is caused by some internal timeout.  This bug continues to block many attempts to check code into tempest. I hope this issue can be fixed soon so we can add more tests to the project gate that will hopefully prevent this kind of bug slipping in again.", 
            "date_created": "2012-11-26 15:14:09.910393+00:00", 
            "author": "https://api.launchpad.net/1.0/~david-kranz"
        }, 
        {
            "content": "David,\n\nOnly thing i can think of is some sort of problem with rabbitmq. We don't seem to capture logs related to queueing do we? Where could we make the change to capture that log?\n\nthanks,\ndims", 
            "date_created": "2012-11-26 18:10:08.083265+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "This bug is standing in the way of applying most of the full tempest gate to nova. Another nova bug slipped through the partial gate yesterday. I see that this ticket is not even assigned or marked as important. This behavior seems like a pretty serious regression and hope it can be resolved soon.", 
            "date_created": "2012-12-06 13:54:51.191062+00:00", 
            "author": "https://api.launchpad.net/1.0/~david-kranz"
        }, 
        {
            "content": "As of 9am on 12/8, this is happening on every run of periodic-tempest-devstack-vm-check-hourly.", 
            "date_created": "2012-12-10 13:52:25.154846+00:00", 
            "author": "https://api.launchpad.net/1.0/~david-kranz"
        }, 
        {
            "content": "This is a possible fix for this - https://review.openstack.org/#/c/18098/, turns out we were being very sloppy with cleaning up servers, with the net result being that we were occationally overrunning the memory of the CI systems when deletes didn't process fast enough, thus causing vms to not start which we assumed would.", 
            "date_created": "2012-12-14 11:57:10.935963+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/18098\nCommitted: http://github.com/openstack/tempest/commit/dd523b1f3f56e083a338c630e0eace90aa625615\nSubmitter: Jenkins\nBranch:    master\n\ncommit dd523b1f3f56e083a338c630e0eace90aa625615\nAuthor: Sean Dague <email address hidden>\nDate:   Thu Dec 13 17:31:22 2012 -0500\n\n    ensure servers are deleted between tests\n    \n    Possible fix for bug #1079687\n    \n    When running tests we create a lot of servers, and do delete\n    calls at the end of tests. However delete is an async action,\n    so the previous servers will often be hanging around after our\n    tests. In memory constrained environments like the OpenStack CI\n    system if deletes happen too slowly we hit the memory limits,\n    nova scheduler can no longer schedule VMs, and the tests get flakey.\n    \n    This *may* fix the periodic fails we've seen on tempest in nova.\n    \n    Pair programmed with Matt Treinish <email address hidden>\n    \n    Change-Id: I1f93ac26064c68bf529e2efa1bf0c35e1f4e7d2c\n", 
            "date_created": "2012-12-14 18:41:06.428851+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This is solved in the general case in tempest.", 
            "date_created": "2013-02-19 13:08:17.721100+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }
    ]
}