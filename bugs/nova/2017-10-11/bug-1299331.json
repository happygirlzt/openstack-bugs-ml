{
    "status": "Fix Released", 
    "last_updated": "2014-10-16 08:42:33.823228+00:00", 
    "description": "$ nova boot --flavor 1 --image 76ae1239-0973-44cf-9051-0e1bc8f41cdd --nic net-id=a15cfbed-86d8-4660-9593-46447cb9464e vm1\n\n$ nova list\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n| ID                                   | Name | Status | Task State | Power State | Networks          |\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n| f7e2877d-c7f5-4493-89d4-c68e9839a7ff | vm1  | ACTIVE | -          | Running     | private=10.0.0.22 |\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n\n$ brctl show\nbridge name\tbridge id\t\tSTP enabled\tinterfaces\nbr-eth0\t\t0000.fe989d8bd148\tno\t\t\nbr-ex\t\t0000.8a1d06d8854e\tno\t\t\nbr-ex2\t\t0000.4a98bdebe544\tno\t\t\nbr-int\t\t0000.229ad5053a41\tno\t\t\nbr-tun\t\t0000.2e58a2f0e047\tno\t\t\ndocker0\t\t8000.000000000000\tno\t\t\nlxcbr0\t\t8000.000000000000\tno\t\t\nqbr0ad6a86e-d9\t\t8000.9e5491dd719a\tno\t\tqvb0ad6a86e-d9\n\t\t\t\t\t\t\ttap0ad6a86e-d9\n\n\n$ neutron port-list\n+--------------------------------------+------+-------------------+------------------------------------------------------------------------------------+\n| id                                   | name | mac_address       | fixed_ips                                                                          |\n+--------------------------------------+------+-------------------+------------------------------------------------------------------------------------+\n| 0ad6a86e-d967-424e-9bf5-e6821cc0cd0d |      | fa:16:3e:3a:3e:5a | {\"subnet_id\": \"94575a05-796f-4ff5-b892-3c3b8231b303\", \"ip_address\": \"10.0.0.22\"}   |\n| 1e6bed8d-aece-4d3e-abcc-3ad7957d6d72 |      | fa:16:3e:9e:dc:83 | {\"subnet_id\": \"e5dbc790-c26f-45b7-b2c7-574f12ad8b41\", \"ip_address\": \"172.24.4.12\"} |\n| 5f522a9a-2856-4a95-8bd8-c354c00abf0f |      | fa:16:3e:01:47:43 | {\"subnet_id\": \"94575a05-796f-4ff5-b892-3c3b8231b303\", \"ip_address\": \"10.0.0.1\"}    |\n| 6226f6d3-3814-469c-bf50-8c99dfec481e |      | fa:16:3e:46:0e:35 | {\"subnet_id\": \"94575a05-796f-4ff5-b892-3c3b8231b303\", \"ip_address\": \"10.0.0.2\"}    |\n| a3f2ab1c-a634-446d-8885-d7d8e5978fa1 |      | fa:16:3e:cf:02:d6 | {\"subnet_id\": \"94575a05-796f-4ff5-b892-3c3b8231b303\", \"ip_address\": \"10.0.0.20\"}   |\n| c10390a9-6f84-44f5-8a17-91cb330a9e12 |      | fa:16:3e:41:7c:34 | {\"subnet_id\": \"e5dbc790-c26f-45b7-b2c7-574f12ad8b41\", \"ip_address\": \"172.24.4.15\"} |\n| c814425c-be1a-4c06-a54b-1788c7c6fb31 |      | fa:16:3e:f5:fc:d3 | {\"subnet_id\": \"e5dbc790-c26f-45b7-b2c7-574f12ad8b41\", \"ip_address\": \"172.24.4.2\"}  |\n| ebd874b7-43e6-4d18-b0ed-f86bb349d8b9 |      | fa:16:3e:e6:b5:09 | {\"subnet_id\": \"e5dbc790-c26f-45b7-b2c7-574f12ad8b41\", \"ip_address\": \"172.24.4.19\"} |\n+--------------------------------------+------+-------------------+------------------------------------------------------------------------------------+\n\n\n$ nova pause vm1\n\n$ nova interface-detach vm1 0ad6a86e-d967-424e-9bf5-e6821cc0cd0d\n\n$ nova list\n+--------------------------------------+------+--------+------------+-------------+----------+\n| ID                                   | Name | Status | Task State | Power State | Networks |\n+--------------------------------------+------+--------+------------+-------------+----------+\n| f7e2877d-c7f5-4493-89d4-c68e9839a7ff | vm1  | PAUSED | -          | Paused      |          |\n+--------------------------------------+------+--------+------------+-------------+----------+\n\n$ brctl show\nbridge name\tbridge id\t\tSTP enabled\tinterfaces\nbr-eth0\t\t0000.fe989d8bd148\tno\t\t\nbr-ex\t\t0000.8a1d06d8854e\tno\t\t\nbr-ex2\t\t0000.4a98bdebe544\tno\t\t\nbr-int\t\t0000.229ad5053a41\tno\t\t\nbr-tun\t\t0000.2e58a2f0e047\tno\t\t\ndocker0\t\t8000.000000000000\tno\t\t\nlxcbr0\t\t8000.000000000000\tno\t\t\n\n\nBut tap still alive\n\n$ ifconfig|grep tap0ad6a86e-d9\ntap0ad6a86e-d9 Link encap:Ethernet  HWaddr fe:16:3e:3a:3e:5a\n\nAnd login into instance, exec 'ifconfig', it will found the interface still attach to the instance", 
    "tags": [
        "in-stable-icehouse", 
        "libvirt"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1299331", 
    "owner": "https://api.launchpad.net/1.0/~xuhj", 
    "id": 1299331, 
    "index": 4700, 
    "created": "2014-03-29 04:03:10.513933+00:00", 
    "title": "There isn't effect when attach/detach interface for paused instance", 
    "comments": [
        {
            "content": "$ nova boot --flavor 1 --image 76ae1239-0973-44cf-9051-0e1bc8f41cdd --nic net-id=a15cfbed-86d8-4660-9593-46447cb9464e vm1\n\n$ nova list\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n| ID                                   | Name | Status | Task State | Power State | Networks          |\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n| f7e2877d-c7f5-4493-89d4-c68e9839a7ff | vm1  | ACTIVE | -          | Running     | private=10.0.0.22 |\n+--------------------------------------+------+--------+------------+-------------+-------------------+\n\n$ brctl show\nbridge name\tbridge id\t\tSTP enabled\tinterfaces\nbr-eth0\t\t0000.fe989d8bd148\tno\t\t\nbr-ex\t\t0000.8a1d06d8854e\tno\t\t\nbr-ex2\t\t0000.4a98bdebe544\tno\t\t\nbr-int\t\t0000.229ad5053a41\tno\t\t\nbr-tun\t\t0000.2e58a2f0e047\tno\t\t\ndocker0\t\t8000.000000000000\tno\t\t\nlxcbr0\t\t8000.000000000000\tno\t\t\nqbr0ad6a86e-d9\t\t8000.9e5491dd719a\tno\t\tqvb0ad6a86e-d9\n\t\t\t\t\t\t\ttap0ad6a86e-d9\n\n\n$ neutron port-list\n+--------------------------------------+------+-------------------+------------------------------------------------------------------------------------+\n| id                                   | name | mac_address       | fixed_ips                                                                          |\n+--------------------------------------+------+-------------------+------------------------------------------------------------------------------------+\n| 0ad6a86e-d967-424e-9bf5-e6821cc0cd0d |      | fa:16:3e:3a:3e:5a | {\"subnet_id\": \"94575a05-796f-4ff5-b892-3c3b8231b303\", \"ip_address\": \"10.0.0.22\"}   |\n| 1e6bed8d-aece-4d3e-abcc-3ad7957d6d72 |      | fa:16:3e:9e:dc:83 | {\"subnet_id\": \"e5dbc790-c26f-45b7-b2c7-574f12ad8b41\", \"ip_address\": \"172.24.4.12\"} |\n| 5f522a9a-2856-4a95-8bd8-c354c00abf0f |      | fa:16:3e:01:47:43 | {\"subnet_id\": \"94575a05-796f-4ff5-b892-3c3b8231b303\", \"ip_address\": \"10.0.0.1\"}    |\n| 6226f6d3-3814-469c-bf50-8c99dfec481e |      | fa:16:3e:46:0e:35 | {\"subnet_id\": \"94575a05-796f-4ff5-b892-3c3b8231b303\", \"ip_address\": \"10.0.0.2\"}    |\n| a3f2ab1c-a634-446d-8885-d7d8e5978fa1 |      | fa:16:3e:cf:02:d6 | {\"subnet_id\": \"94575a05-796f-4ff5-b892-3c3b8231b303\", \"ip_address\": \"10.0.0.20\"}   |\n| c10390a9-6f84-44f5-8a17-91cb330a9e12 |      | fa:16:3e:41:7c:34 | {\"subnet_id\": \"e5dbc790-c26f-45b7-b2c7-574f12ad8b41\", \"ip_address\": \"172.24.4.15\"} |\n| c814425c-be1a-4c06-a54b-1788c7c6fb31 |      | fa:16:3e:f5:fc:d3 | {\"subnet_id\": \"e5dbc790-c26f-45b7-b2c7-574f12ad8b41\", \"ip_address\": \"172.24.4.2\"}  |\n| ebd874b7-43e6-4d18-b0ed-f86bb349d8b9 |      | fa:16:3e:e6:b5:09 | {\"subnet_id\": \"e5dbc790-c26f-45b7-b2c7-574f12ad8b41\", \"ip_address\": \"172.24.4.19\"} |\n+--------------------------------------+------+-------------------+------------------------------------------------------------------------------------+\n\n\n$ nova pause vm1\n\n$ nova interface-detach vm1 0ad6a86e-d967-424e-9bf5-e6821cc0cd0d\n\n$ nova list\n+--------------------------------------+------+--------+------------+-------------+----------+\n| ID                                   | Name | Status | Task State | Power State | Networks |\n+--------------------------------------+------+--------+------------+-------------+----------+\n| f7e2877d-c7f5-4493-89d4-c68e9839a7ff | vm1  | PAUSED | -          | Paused      |          |\n+--------------------------------------+------+--------+------------+-------------+----------+\n\n$ brctl show\nbridge name\tbridge id\t\tSTP enabled\tinterfaces\nbr-eth0\t\t0000.fe989d8bd148\tno\t\t\nbr-ex\t\t0000.8a1d06d8854e\tno\t\t\nbr-ex2\t\t0000.4a98bdebe544\tno\t\t\nbr-int\t\t0000.229ad5053a41\tno\t\t\nbr-tun\t\t0000.2e58a2f0e047\tno\t\t\ndocker0\t\t8000.000000000000\tno\t\t\nlxcbr0\t\t8000.000000000000\tno\t\t\n\n\nBut tap still alive\n\n$ ifconfig|grep tap0ad6a86e-d9\ntap0ad6a86e-d9 Link encap:Ethernet  HWaddr fe:16:3e:3a:3e:5a\n\nAnd login into instance, exec 'ifconfig', it will found the interface still attach to the instance", 
            "date_created": "2014-03-29 04:03:10.513933+00:00", 
            "author": "https://api.launchpad.net/1.0/~xuhj"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/83959", 
            "date_created": "2014-03-29 08:08:17.936702+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/83959\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=a868fcedf8e46070cae6aa8e59e61934fa23db1c\nSubmitter: Jenkins\nBranch:    master\n\ncommit a868fcedf8e46070cae6aa8e59e61934fa23db1c\nAuthor: He Jie Xu <email address hidden>\nDate:   Sat Mar 29 15:35:47 2014 +0800\n\n    Attach/detach interface to paused instance with affect live flag\n    \n    Currently attach/detach interface to paused instance is only with\n    VIR_DOMAIN_AFFECT_CONFIG flags. After instance unpause, there isn't\n    any effect on the instance, unless restart the instance. So add\n    flag VIR_DOMAIN_AFFECT_LIVE when attach/detach interface.\n    \n    Change-Id: Iedfc7f6fc06e72d8e3eecebede1274582c8043fd\n    Closes-Bug: #1299331\n", 
            "date_created": "2014-06-19 14:44:10.543426+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/icehouse\nReview: https://review.openstack.org/101828", 
            "date_created": "2014-06-23 08:44:31.726744+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/93190\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=ead9cfca93c9b5ca55e3ba269213c98d5e6e1d38\nSubmitter: Jenkins\nBranch:    master\n\ncommit ead9cfca93c9b5ca55e3ba269213c98d5e6e1d38\nAuthor: Thang Pham <email address hidden>\nDate:   Sat May 10 01:41:31 2014 -0400\n\n    libvirt: Use VIR_DOMAIN_AFFECT_LIVE for paused instances\n    \n    When a volume is attached to a paused instance, it does not\n    appear in the instance's block devices list (i.e. lsblk)\n    after the instance has resumed. A similar situation\n    happens when detaching a volume from a paused instance; the\n    block device continues to exists in the block devices list,\n    where it should not.  It was found that the volume is only\n    persisted in the domain's config settings and not its active\n    settings, since only the VIR_DOMAIN_AFFECT_CONFIG flag was used\n    on attach and detach volume.  In order to affect the active\n    settings, the VIR_DOMAIN_AFFECT_LIVE flag has to be added when\n    attaching and detaching volumes.\n    \n    Change-Id: I9c90a410a7ecb91f5a4de28acee21fe7da49242c\n    Closes-Bug: #1242366\n    Related-Bug: #1299331\n", 
            "date_created": "2014-06-25 00:14:09.826789+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Related fix proposed to branch: stable/icehouse\nReview: https://review.openstack.org/102456", 
            "date_created": "2014-06-25 07:47:22.952925+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/101828\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=0e1580e5ebfc6a7d612235a444ce9843a44479fb\nSubmitter: Jenkins\nBranch:    stable/icehouse\n\ncommit 0e1580e5ebfc6a7d612235a444ce9843a44479fb\nAuthor: He Jie Xu <email address hidden>\nDate:   Sat Mar 29 15:35:47 2014 +0800\n\n    Attach/detach interface to paused instance with affect live flag\n    \n    Currently attach/detach interface to paused instance is only with\n    VIR_DOMAIN_AFFECT_CONFIG flags. After instance unpause, there isn't\n    any effect on the instance, unless restart the instance. So add\n    flag VIR_DOMAIN_AFFECT_LIVE when attach/detach interface.\n    \n    Conflicts:\n    \tnova/tests/virt/libvirt/test_libvirt.py\n    \n    Change-Id: Iedfc7f6fc06e72d8e3eecebede1274582c8043fd\n    Closes-Bug: #1299331\n    (cherry picked from commit a868fcedf8e46070cae6aa8e59e61934fa23db1c)\n", 
            "date_created": "2014-07-31 18:53:49.509501+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/102456\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=520aa4c0829da9ba4b2beb8f90995f4bdec9b1f2\nSubmitter: Jenkins\nBranch:    stable/icehouse\n\ncommit 520aa4c0829da9ba4b2beb8f90995f4bdec9b1f2\nAuthor: Thang Pham <email address hidden>\nDate:   Sat May 10 01:41:31 2014 -0400\n\n    libvirt: Use VIR_DOMAIN_AFFECT_LIVE for paused instances\n    \n    When a volume is attached to a paused instance, it does not\n    appear in the instance's block devices list (i.e. lsblk)\n    after the instance has resumed. A similar situation\n    happens when detaching a volume from a paused instance; the\n    block device continues to exists in the block devices list,\n    where it should not.  It was found that the volume is only\n    persisted in the domain's config settings and not its active\n    settings, since only the VIR_DOMAIN_AFFECT_CONFIG flag was used\n    on attach and detach volume.  In order to affect the active\n    settings, the VIR_DOMAIN_AFFECT_LIVE flag has to be added when\n    attaching and detaching volumes.\n    \n    This change adjusts little about the unit test:\n    add two imports.\n    \n    Change-Id: I9c90a410a7ecb91f5a4de28acee21fe7da49242c\n    Closes-Bug: #1242366\n    Related-Bug: #1299331\n    (cherry picked from commit ead9cfca93c9b5ca55e3ba269213c98d5e6e1d38)\n", 
            "date_created": "2014-09-26 14:30:26.529287+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}