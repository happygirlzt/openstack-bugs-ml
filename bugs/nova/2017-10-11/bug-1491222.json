{
    "status": "Fix Released", 
    "last_updated": "2017-06-16 12:18:09.947447+00:00", 
    "description": "1. code base\n\n$ git log -1\ncommit e041f3ee625b2737a1788304916589e3cc74db3d\nMerge: c310255 bef481b\nAuthor: Jenkins <email address hidden>\nDate:   Tue Sep 1 21:53:31 2015 +0000\n\n\u00a0\u00a0\u00a0\u00a0Merge \"Fix three typos on nova/pci directory\"\n\n2. nova-api.log file:\n\n2015-09-01 18:03:32.490 DEBUG nova.db.sqlalchemy.api [req-b506dbaa-7157-4001-a79d-af1c9d642aa4 admin admin] Request is over project quota for resource \"instances\". Project limit: -1, delta: 1, current total project usage: 0 _calculate_overquota /opt/stack/nova/nova/db/sqlalchemy/api.py:3497\n........\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 427, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     min_count, allowed)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 427, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     min_count, allowed)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 427, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     min_count, allowed)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 427, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     min_count, allowed)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 427, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     min_count, allowed)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 401, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     cores=req_cores, ram=req_ram)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/oslo_versionedobjects/base.py\", line 213, in wrapper\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return fn(self, *args, **kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/objects/quotas.py\", line 92, in reserve\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     **deltas)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/quota.py\", line 1343, in reserve\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     user_id=user_id)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/quota.py\", line 569, in reserve\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     project_quotas=project_quotas)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/quota.py\", line 406, in _get_quotas\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     project_quotas=project_quotas)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/quota.py\", line 246, in get_user_quotas\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     user_id)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/db/api.py\", line 1032, in quota_get_all_by_project_and_user\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return IMPL.quota_get_all_by_project_and_user(context, project_id, user_id)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/db/sqlalchemy/api.py\", line 216, in wrapper\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return f(*args, **kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/db/sqlalchemy/api.py\", line 3128, in quota_get_all_by_project_and_user\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     filter_by(user_id=user_id).\\\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2320, in all\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return list(self)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2438, in __iter__\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return self._execute_and_instances(context)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2453, in _execute_and_instances\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     result = conn.execute(querycontext.statement, self._params)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 729, in execute\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, multiparams, params)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/elements.py\", line 322, in _execute_on_connection\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return connection._execute_clauseelement(self, multiparams, params)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 819, in _execute_clauseelement\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     inline=len(distilled_params) > 1)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"<string>\", line 1, in <lambda>\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/elements.py\", line 493, in compile\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return self._compiler(dialect, bind=bind, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/elements.py\", line 499, in _compiler\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return dialect.statement_compiler(dialect, self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 395, in __init__\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     Compiled.__init__(self, dialect, statement, **kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 199, in __init__\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     self.string = self.process(self.statement, **compile_kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 222, in process\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return obj._compiler_dispatch(self, **kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.py\", line 80, in _compiler_dispatch\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 1544, in visit_select\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     t = select._whereclause._compiler_dispatch(self, **kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.py\", line 92, in _compiler_dispatch\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 662, in visit_clauselist\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     for c in clauselist.clauses)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 659, in <genexpr>\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     s for s in\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 662, in <genexpr>\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     for c in clauselist.clauses)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.py\", line 92, in _compiler_dispatch\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 662, in visit_clauselist\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     for c in clauselist.clauses)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 659, in <genexpr>\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     s for s in\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 662, in <genexpr>\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     for c in clauselist.clauses)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.py\", line 92, in _compiler_dispatch\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 847, in visit_binary\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return self._generate_generic_binary(binary, opstring, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 864, in _generate_generic_binary\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     binary.right._compiler_dispatch(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.py\", line 92, in _compiler_dispatch\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 993, in visit_bindparam\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     name = self._truncate_bindparam(bindparam)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 1049, in _truncate_bindparam\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     bind_name = self._truncated_identifier(\"bindparam\", bind_name)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 1060, in _truncated_identifier\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     anonname = name.apply_map(self.anon_map)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/elements.py\", line 3331, in apply_map\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return self % map_\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/util/_collections.py\", line 680, in __missing__\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     self[key] = val = self.creator(key)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 1079, in _process_anon\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return derived + \"_\" + str(anonymous_counter)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack RuntimeError: maximum recursion depth exceeded while getting the str of an object\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack\n2015-09-01 18:05:34.310 INFO nova.api.openstack [req-82c1beaa-d618-4ceb-8941-105df8720ad1 admin admin] http://localhost:8774/v2/4ffccaf0c84a44a29799b7bacab52334/servers returned with HTTP 500\n\n3. Reproduce steps:\n\n#Step 1: set project quota to unlimited\n$ nova quota-update --instances -1 $tenant\n\n#Step 2: set user quota to 1 (current usage 0)\n$ nova quota-update --user $tenantUser --instances 1 $tenant\n\n#Step 3: boot instance\n$ nova boot --image cirros-0.3.2-x86_64-disk --nic net-id=84140e3f-f20d-4ec5-9eac-d455dba7c569 --flavor m1.tiny chenrui_vm\nERROR (ClientException): The server has either erred or is incapable of performing the requested operation. (HTTP 500) (Request-ID: req-82c1beaa-d618-4ceb-8941-105df8720ad1)\n\nExpected result:\n* booting instance success\n\nActual result:\n* booting instance failed", 
    "tags": [
        "liberty-backport-potential"
    ], 
    "importance": "Medium", 
    "heat": 18, 
    "link": "https://bugs.launchpad.net/nova/+bug/1491222", 
    "owner": "https://api.launchpad.net/1.0/~kiwik-chenrui", 
    "id": 1491222, 
    "index": 4339, 
    "created": "2015-09-02 03:29:57.534969+00:00", 
    "title": "Booting instance cause infinite recursion in the case of enough user quota and unlimited project quota", 
    "comments": [
        {
            "content": "1. code base \n\n$ git log -1\ncommit e041f3ee625b2737a1788304916589e3cc74db3d\nMerge: c310255 bef481b\nAuthor: Jenkins <email address hidden>\nDate:   Tue Sep 1 21:53:31 2015 +0000\n\n    Merge \"Fix three typos on nova/pci directory\"\n\n2. nova-api.log file:\n\n2015-09-01 18:03:32.490 DEBUG nova.db.sqlalchemy.api [req-b506dbaa-7157-4001-a79d-af1c9d642aa4 admin admin] Request is over project quota for resource \"instances\". Project limit: -1, delta: 1, current total project usage: 0 _calculate_overquota /opt/stack/nova/nova/db/sqlalchemy/api.py:3497\n........\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 427, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     min_count, allowed)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 427, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     min_count, allowed)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 427, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     min_count, allowed)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 427, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     min_count, allowed)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 427, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     min_count, allowed)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 401, in _check_num_instances_quota\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     cores=req_cores, ram=req_ram)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/oslo_versionedobjects/base.py\", line 213, in wrapper\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return fn(self, *args, **kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/objects/quotas.py\", line 92, in reserve\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     **deltas)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/quota.py\", line 1343, in reserve\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     user_id=user_id)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/quota.py\", line 569, in reserve\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     project_quotas=project_quotas)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/quota.py\", line 406, in _get_quotas\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     project_quotas=project_quotas)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/quota.py\", line 246, in get_user_quotas\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     user_id)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/db/api.py\", line 1032, in quota_get_all_by_project_and_user\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return IMPL.quota_get_all_by_project_and_user(context, project_id, user_id)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/db/sqlalchemy/api.py\", line 216, in wrapper\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return f(*args, **kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/opt/stack/nova/nova/db/sqlalchemy/api.py\", line 3128, in quota_get_all_by_project_and_user\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     filter_by(user_id=user_id).\\\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2320, in all\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return list(self)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2438, in __iter__\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return self._execute_and_instances(context)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2453, in _execute_and_instances\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     result = conn.execute(querycontext.statement, self._params)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 729, in execute\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, multiparams, params)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/elements.py\", line 322, in _execute_on_connection\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return connection._execute_clauseelement(self, multiparams, params)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 819, in _execute_clauseelement\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     inline=len(distilled_params) > 1)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"<string>\", line 1, in <lambda>\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/elements.py\", line 493, in compile\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return self._compiler(dialect, bind=bind, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/elements.py\", line 499, in _compiler\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return dialect.statement_compiler(dialect, self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 395, in __init__\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     Compiled.__init__(self, dialect, statement, **kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 199, in __init__\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     self.string = self.process(self.statement, **compile_kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 222, in process\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return obj._compiler_dispatch(self, **kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.py\", line 80, in _compiler_dispatch\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 1544, in visit_select\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     t = select._whereclause._compiler_dispatch(self, **kwargs)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.py\", line 92, in _compiler_dispatch\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 662, in visit_clauselist\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     for c in clauselist.clauses)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 659, in <genexpr>\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     s for s in\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 662, in <genexpr>\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     for c in clauselist.clauses)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.py\", line 92, in _compiler_dispatch\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 662, in visit_clauselist\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     for c in clauselist.clauses)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 659, in <genexpr>\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     s for s in\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 662, in <genexpr>\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     for c in clauselist.clauses)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.py\", line 92, in _compiler_dispatch\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 847, in visit_binary\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return self._generate_generic_binary(binary, opstring, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 864, in _generate_generic_binary\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     binary.right._compiler_dispatch(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/visitors.py\", line 92, in _compiler_dispatch\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return meth(self, **kw)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 993, in visit_bindparam\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     name = self._truncate_bindparam(bindparam)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 1049, in _truncate_bindparam\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     bind_name = self._truncated_identifier(\"bindparam\", bind_name)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 1060, in _truncated_identifier\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     anonname = name.apply_map(self.anon_map)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/elements.py\", line 3331, in apply_map\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return self % map_\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/util/_collections.py\", line 680, in __missing__\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     self[key] = val = self.creator(key)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/sqlalchemy/sql/compiler.py\", line 1079, in _process_anon\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack     return derived + \"_\" + str(anonymous_counter)\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack RuntimeError: maximum recursion depth exceeded while getting the str of an object\n2015-09-01 18:05:34.260 5619 ERROR nova.api.openstack\n2015-09-01 18:05:34.310 INFO nova.api.openstack [req-82c1beaa-d618-4ceb-8941-105df8720ad1 admin admin] http://10.250.10.29:8774/v2/4ffccaf0c84a44a29799b7bacab52334/servers returned with HTTP 500\n\n3. Reproduce steps:\n\n#Step 1: set project quota to unlimited\n$ nova quota-update --instances -1 $tenant\n\n#Step 2: set user quota to 1 (current usage 0)\n$ nova quota-update --user $tenantUser --instances 1 $tenant\n\n#Step 3: boot instance\n$ nova boot --image cirros-0.3.2-x86_64-disk --nic net-id=84140e3f-f20d-4ec5-9eac-d455dba7c569 --flavor m1.tiny chenrui_vm\nERROR (ClientException): The server has either erred or is incapable of performing the requested operation. (HTTP 500) (Request-ID: req-82c1beaa-d618-4ceb-8941-105df8720ad1)\n\nExpected result:\n* booting instance success\n\nActual result:\n* booting instance failed", 
            "date_created": "2015-09-02 03:29:57.534969+00:00", 
            "author": "https://api.launchpad.net/1.0/~kiwik-chenrui"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/219596", 
            "date_created": "2015-09-02 08:30:36.862610+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/219596\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=b630d1471b9f7efc0949fcd8042e86641a997762\nSubmitter: Jenkins\nBranch:    master\n\ncommit b630d1471b9f7efc0949fcd8042e86641a997762\nAuthor: Rui Chen <email address hidden>\nDate:   Wed Sep 2 16:07:11 2015 +0800\n\n    Fix booting fail when unlimited project quota\n    \n    If we launch a instance in the case of unlimited project quota\n    and limited user quota, API would return internal error 500.\n    The code logic wouldn't check the case of unlimited project quota\n    in _calculate_overquota() and OverQuota exception was raised,\n    it cause infinite recursion in _check_num_instances_quota()\n    \n    Change-Id: I7831266b6269ea5d9a3aaa32041158293a1d601e\n    Closes-Bug: #1491222\n", 
            "date_created": "2015-11-19 14:52:45.500488+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 13.0.0.0b1 development milestone.", 
            "date_created": "2015-12-02 16:17:27.929239+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "Fix proposed to branch: stable/liberty\nReview: https://review.openstack.org/329231", 
            "date_created": "2016-06-14 00:18:03.965308+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/329231\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=9ab10b8c99f18d4546a7bf8dcefed37121414f2a\nSubmitter: Jenkins\nBranch:    stable/liberty\n\ncommit 9ab10b8c99f18d4546a7bf8dcefed37121414f2a\nAuthor: Rui Chen <email address hidden>\nDate:   Wed Sep 2 16:07:11 2015 +0800\n\n    Fix booting fail when unlimited project quota\n    \n    If we launch a instance in the case of unlimited project quota\n    and limited user quota, API would return internal error 500.\n    The code logic wouldn't check the case of unlimited project quota\n    in _calculate_overquota() and OverQuota exception was raised,\n    it cause infinite recursion in _check_num_instances_quota()\n    \n    Change-Id: I7831266b6269ea5d9a3aaa32041158293a1d601e\n    Closes-Bug: #1491222\n    (cherry picked from commit b630d1471b9f7efc0949fcd8042e86641a997762)\n", 
            "date_created": "2016-09-09 16:56:19.288980+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 12.0.5 release.", 
            "date_created": "2016-09-29 21:42:40.072347+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 12.0.5 release.", 
            "date_created": "2016-11-10 01:11:08.425337+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}