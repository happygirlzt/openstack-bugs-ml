{
    "status": "Invalid", 
    "last_updated": "2016-06-02 19:03:28.821791+00:00", 
    "description": "Postgres as Database + latest stable Kilo; When doing live migrate with attached volume (rally test  boot_server_attach_created_volume_and_live_migrate):\n\n----8<----\n\n\nERROR oslo_db.sqlalchemy.exc_filters [req-76f003ad-8b12-4e85-902a-a52581fd5611 c2190adfee124fefb139254ce3df27dc 0b707847d6254b5b9e956e40ae16deca - - -] DBAPIError exception wrapped from (ProgrammingError) can't adapt type 'Instance' 'SELECT block_device_mapping.created_at AS block_device_mapping_created_at, block_device_mapping.updated_at AS block_device_mapping_updated_at, block_device_mapping.deleted_at AS block_device_mapping_deleted_at, block_device_mapping.deleted AS block_device_mapping_deleted, block_device_mapping.id AS block_device_mapping_id, block_device_mapping.instance_uuid AS block_device_mapping_instance_uuid, block_device_mapping.source_type AS block_device_mapping_source_type, block_device_mapping.destination_type AS block_device_mapping_destination_type, block_device_mapping.guest_format AS block_device_mapping_guest_format, block_device_mapping.device_type AS block_device_mapping_device_type, block_device_mapping.disk_bus AS block_device_mapping_disk_bus, block_device_mapping.boot_index AS block_device_mapping_boot_index, block_device_mapping.device_name AS block_device_mapping_device_name, block_device_mapping.delete_on_termination AS block_device_mapping_delete_on_termination, block_device_mapping.snapshot_id AS block_device_mapping_snapshot_id, block_device_mapping.volume_id AS block_device_mapping_volume_id, block_device_mapping.volume_size AS block_device_mapping_volume_size, block_device_mapping.image_id AS block_device_mapping_image_id, block_device_mapping.no_device AS block_device_mapping_no_device, block_device_mapping.connection_info AS block_device_mapping_connection_info \\nFROM block_device_mapping \\nWHERE block_device_mapping.deleted = %(deleted_1)s AND block_device_mapping.volume_id = %(volume_id_1)s \\n LIMIT %(param_1)s' {'param_1': 1, 'volume_id_1': \n[...]\n\n\nTRACE oslo_db.sqlalchemy.exc_filters Traceback (most recent call last):\nTRACE oslo_db.sqlalchemy.exc_filters   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1063, in _execute_context\nTRACE oslo_db.sqlalchemy.exc_filters     context)\nTRACE oslo_db.sqlalchemy.exc_filters   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/default.py\", line 442, in do_execute\nTRACE oslo_db.sqlalchemy.exc_filters     cursor.execute(statement, parameters)\nTRACE oslo_db.sqlalchemy.exc_filters ProgrammingError: can't adapt type 'Instance'\n\n\n---->8----\n\nIn nova-compute.log you find the corresponding error:\n\n-----8<----\n\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b] Traceback (most recent call last):\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 5714, in _live_migration\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     dom, finish_event)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 5651, in _live_migration_monitor\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     migrate_data)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     payload)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     six.reraise(self.type_, self.value, self.tb)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     return f(self, context, *args, **kw)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 361, in decorated_function\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     kwargs['instance'], e, sys.exc_info())\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     six.reraise(self.type_, self.value, self.tb)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 349, in decorated_function\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     return function(self, context, *args, **kwargs)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5564, in _rollback_live_migration\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     context, instance, bdm.volume_id, dest)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/compute/rpcapi.py\", line 715, in remove_volume_connection\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     instance=instance, volume_id=volume_id)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 156, in call\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     retry=self.retry)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     timeout=timeout, retry=retry)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 350, in send\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     retry=retry)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 341, in _send\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     raise result\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b] RemoteError: Remote error: RemoteError Remote error: DBError (ProgrammingError) can't adapt type 'Instance' 'SELECT block_device_mapping.created_at AS block_device_mapping_created_at, block_device_mapping.updated_at AS block_device_mapping_updated_at, block_device_mapping.deleted_at AS block_device_mapping_deleted_at, block_device_mapping.deleted AS block_device_mapping_deleted, block_device_mapping.id AS block_device_mapping_id, block_device_mapping.instance_uuid AS block_device_mapping_instance_uuid, block_device_mapping.source_type AS block_device_mapping_source_type, block_device_mapping.destination_type AS block_device_mapping_destination_type, block_device_mapping.guest_format AS block_device_mapping_guest_format, block_device_mapping.device_type AS block_device_mapping_device_type, block_device_mapping.disk_bus AS block_device_mapping_disk_bus, block_device_mapping.boot_index AS block_device_mapping_boot_index, block_device_mapping.device_name AS block_device_mapping_device_name, block_device_mapping.delete_on_termination AS block_device_mapping_delete_on_termination, block_device_mapping.snapshot_id AS block_device_mapping_snapshot_id, block_device_mapping.volume_id AS block_device_mapping_volume_id, block_device_mapping.volume_size AS block_device_mapping_volume_size, block_device_mapping.image_id AS block_device_mapping_image_id, block_device_mapping.no_device AS block_device_mapping_no_device, block_device_mapping.connection_info AS block_device_mapping_connection_info \\nFROM block_device_mapping \\nWHERE block_device_mapping.deleted = %(deleted_1)s AND block_device_mapping.volume_id = %(volume_id_1)s \\n LIMIT %(param_1)s' {'param_1': 1, 'volume_id_1': \n\n------->8------", 
    "tags": [
        "api", 
        "db"
    ], 
    "importance": "Low", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1516671", 
    "owner": "None", 
    "id": 1516671, 
    "index": 627, 
    "created": "2015-11-16 15:36:59.289097+00:00", 
    "title": "LiveMigration DBError: ProgrammingError: can't adapt type 'Instance'", 
    "comments": [
        {
            "content": "Postgres as Database + latest stable Kilo; When doing live migrate with attached volume (rally test  boot_server_attach_created_volume_and_live_migrate):\n\n----8<----\n\n\nERROR oslo_db.sqlalchemy.exc_filters [req-76f003ad-8b12-4e85-902a-a52581fd5611 c2190adfee124fefb139254ce3df27dc 0b707847d6254b5b9e956e40ae16deca - - -] DBAPIError exception wrapped from (ProgrammingError) can't adapt type 'Instance' 'SELECT block_device_mapping.created_at AS block_device_mapping_created_at, block_device_mapping.updated_at AS block_device_mapping_updated_at, block_device_mapping.deleted_at AS block_device_mapping_deleted_at, block_device_mapping.deleted AS block_device_mapping_deleted, block_device_mapping.id AS block_device_mapping_id, block_device_mapping.instance_uuid AS block_device_mapping_instance_uuid, block_device_mapping.source_type AS block_device_mapping_source_type, block_device_mapping.destination_type AS block_device_mapping_destination_type, block_device_mapping.guest_format AS block_device_mapping_guest_format, block_device_mapping.device_type AS block_device_mapping_device_type, block_device_mapping.disk_bus AS block_device_mapping_disk_bus, block_device_mapping.boot_index AS block_device_mapping_boot_index, block_device_mapping.device_name AS block_device_mapping_device_name, block_device_mapping.delete_on_termination AS block_device_mapping_delete_on_termination, block_device_mapping.snapshot_id AS block_device_mapping_snapshot_id, block_device_mapping.volume_id AS block_device_mapping_volume_id, block_device_mapping.volume_size AS block_device_mapping_volume_size, block_device_mapping.image_id AS block_device_mapping_image_id, block_device_mapping.no_device AS block_device_mapping_no_device, block_device_mapping.connection_info AS block_device_mapping_connection_info \\nFROM block_device_mapping \\nWHERE block_device_mapping.deleted = %(deleted_1)s AND block_device_mapping.volume_id = %(volume_id_1)s \\n LIMIT %(param_1)s' {'param_1': 1, 'volume_id_1': \n[...]\n\n\nTRACE oslo_db.sqlalchemy.exc_filters Traceback (most recent call last):\nTRACE oslo_db.sqlalchemy.exc_filters   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1063, in _execute_context\nTRACE oslo_db.sqlalchemy.exc_filters     context)\nTRACE oslo_db.sqlalchemy.exc_filters   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/default.py\", line 442, in do_execute\nTRACE oslo_db.sqlalchemy.exc_filters     cursor.execute(statement, parameters)\nTRACE oslo_db.sqlalchemy.exc_filters ProgrammingError: can't adapt type 'Instance'\n\n\n---->8----\n\nIn nova-compute.log you find the corresponding error:\n\n-----8<----\n\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b] Traceback (most recent call last):\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 5714, in _live_migration\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     dom, finish_event)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 5651, in _live_migration_monitor\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     migrate_data)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     payload)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     six.reraise(self.type_, self.value, self.tb)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     return f(self, context, *args, **kw)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 361, in decorated_function\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     kwargs['instance'], e, sys.exc_info())\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     six.reraise(self.type_, self.value, self.tb)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 349, in decorated_function\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     return function(self, context, *args, **kwargs)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5564, in _rollback_live_migration\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     context, instance, bdm.volume_id, dest)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/nova/compute/rpcapi.py\", line 715, in remove_volume_connection\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     instance=instance, volume_id=volume_id)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 156, in call\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     retry=self.retry)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     timeout=timeout, retry=retry)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 350, in send\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     retry=retry)\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 341, in _send\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b]     raise result\nTRACE nova.virt.libvirt.driver [instance: 70d591fe-cdd8-46c2-bc7c-35ef733c2e1b] RemoteError: Remote error: RemoteError Remote error: DBError (ProgrammingError) can't adapt type 'Instance' 'SELECT block_device_mapping.created_at AS block_device_mapping_created_at, block_device_mapping.updated_at AS block_device_mapping_updated_at, block_device_mapping.deleted_at AS block_device_mapping_deleted_at, block_device_mapping.deleted AS block_device_mapping_deleted, block_device_mapping.id AS block_device_mapping_id, block_device_mapping.instance_uuid AS block_device_mapping_instance_uuid, block_device_mapping.source_type AS block_device_mapping_source_type, block_device_mapping.destination_type AS block_device_mapping_destination_type, block_device_mapping.guest_format AS block_device_mapping_guest_format, block_device_mapping.device_type AS block_device_mapping_device_type, block_device_mapping.disk_bus AS block_device_mapping_disk_bus, block_device_mapping.boot_index AS block_device_mapping_boot_index, block_device_mapping.device_name AS block_device_mapping_device_name, block_device_mapping.delete_on_termination AS block_device_mapping_delete_on_termination, block_device_mapping.snapshot_id AS block_device_mapping_snapshot_id, block_device_mapping.volume_id AS block_device_mapping_volume_id, block_device_mapping.volume_size AS block_device_mapping_volume_size, block_device_mapping.image_id AS block_device_mapping_image_id, block_device_mapping.no_device AS block_device_mapping_no_device, block_device_mapping.connection_info AS block_device_mapping_connection_info \\nFROM block_device_mapping \\nWHERE block_device_mapping.deleted = %(deleted_1)s AND block_device_mapping.volume_id = %(volume_id_1)s \\n LIMIT %(param_1)s' {'param_1': 1, 'volume_id_1': \n\n------->8------", 
            "date_created": "2015-11-16 15:36:59.289097+00:00", 
            "author": "https://api.launchpad.net/1.0/~tom-patzig"
        }, 
        {
            "content": "What does \"can't adapt type 'Instance'\" mean in postgres?", 
            "date_created": "2015-12-02 18:03:29.691030+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "http://stackoverflow.com/questions/2149515/how-to-fix-cant-adapt-error-when-saving-binary-data-using-python-psycopg2\n\nhttp://stackoverflow.com/questions/4042783/cant-adapt-type-error-on-a-foreign-key-attribute-with-sqlalchemy-postgresql\n\nWhat version of sqlalchemy are you running?  What versions of postgresql/psycopg2?", 
            "date_created": "2015-12-02 18:05:08.526960+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "The following versions are used:\n\npython-SQLAlchemy-0.9.9-1.2\npython-oslo.db-1.7.1-1.2\npython-nova-2015.1.3~a0~dev1-9.1\npython-psycopg2-2.6-7.1\npostgresql93-9.3.6-5.2\n", 
            "date_created": "2015-12-02 18:57:20.954168+00:00", 
            "author": "https://api.launchpad.net/1.0/~tom-patzig"
        }, 
        {
            "content": "For what it's worth, I just hit what seems to be the same error message, but it turned out to be due to a bug in some instrumentation I had added in qemu.  qemu was failing to start, resulting in a log of type:\n\nDBError (ProgrammingError) can't adapt type 'Instance'\n\nas per the above description.", 
            "date_created": "2016-01-25 17:32:27.257187+00:00", 
            "author": "https://api.launchpad.net/1.0/~cbf123"
        }, 
        {
            "content": "The requested information from comment #2 got provided in comment #3,\nso I switch it back to \"New\".", 
            "date_created": "2016-03-14 16:15:13.895998+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "We really need the nova-api or nova-conductor logs here for the root failure here.", 
            "date_created": "2016-04-18 13:30:24.415133+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "This bug lacks the necessary information to effectively reproduce and fix it, therefore it has been closed. Feel free to reopen the bug by providing the requested information and set the bug status back to ''New''.", 
            "date_created": "2016-06-02 19:03:16.052142+00:00", 
            "author": "https://api.launchpad.net/1.0/~pushkar-umaranikar"
        }
    ]
}