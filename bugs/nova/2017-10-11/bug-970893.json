{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 12:04:03.597788+00:00", 
    "description": "nova-network log has error on RHEL6.x where it tries to execute dhcp_release command and fails. Do we have any setting which has to be disabled which should have been done during installation? I think this works on Ubuntu so is there any replacement for this command on RHEL6?\n\n2012-03-30 08:56:16 ERROR nova.rpc.amqp [req-5a94ee87-fc3b-4d1b-a27c-e66991003f3a 6fc59f8248214624aec0d82556abe66f df42460ef5f74eb9bf5f12dedd6d08c1] Exception during message handling\n(nova.rpc.amqp): TRACE: Traceback (most recent call last):\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/rpc/amqp.py\", line 252, in _process_data\n(nova.rpc.amqp): TRACE: rval = node_func(context=ctxt, **node_args)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 258, in wrapped\n(nova.rpc.amqp): TRACE: return func(self, context, *args, **kwargs)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 372, in deallocate_for_instance\n(nova.rpc.amqp): TRACE: super(FloatingIP, self).deallocate_for_instance(context, **kwargs)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 258, in wrapped\n(nova.rpc.amqp): TRACE: return func(self, context, *args, **kwargs)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 927, in deallocate_for_instance\n(nova.rpc.amqp): TRACE: **kwargs)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 248, in deallocate_fixed_ip\n(nova.rpc.amqp): TRACE: address)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 1218, in deallocate_fixed_ip\n(nova.rpc.amqp): TRACE: self.driver.release_dhcp(dev, address, vif['address'])\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/linux_net.py\", line 634, in release_dhcp\n(nova.rpc.amqp): TRACE: utils.execute('dhcp_release', dev, address, mac_address, run_as_root=True)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/utils.py\", line 242, in execute\n(nova.rpc.amqp): TRACE: cmd=' '.join(cmd))\n(nova.rpc.amqp): TRACE: ProcessExecutionError: Unexpected error while running command.\n(nova.rpc.amqp): TRACE: Command: sudo dhcp_release br100 10.0.0.2 fa:16:3e:76:b8:89\n(nova.rpc.amqp): TRACE: Exit code: 1\n(nova.rpc.amqp): TRACE: Stdout: ''\n(nova.rpc.amqp): TRACE: Stderr: 'sudo: dhcp_release: command not found\\n'\n(nova.rpc.amqp): TRACE:", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 22, 
    "link": "https://bugs.launchpad.net/nova/+bug/970893", 
    "owner": "https://api.launchpad.net/1.0/~jogo", 
    "id": 970893, 
    "index": 2742, 
    "created": "2012-04-01 15:46:31.718204+00:00", 
    "title": "nova: dhcp_release command not found on RHEL6", 
    "comments": [
        {
            "content": "nova-network log has error on RHEL6.x where it tries to execute dhcp_release command and fails. Do we have any setting which has to be disabled which should have been done during installation? I think this works on Ubuntu so is there any replacement for this command on RHEL6?\n\n2012-03-30 08:56:16 ERROR nova.rpc.amqp [req-5a94ee87-fc3b-4d1b-a27c-e66991003f3a 6fc59f8248214624aec0d82556abe66f df42460ef5f74eb9bf5f12dedd6d08c1] Exception during message handling\n(nova.rpc.amqp): TRACE: Traceback (most recent call last):\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/rpc/amqp.py\", line 252, in _process_data\n(nova.rpc.amqp): TRACE: rval = node_func(context=ctxt, **node_args)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 258, in wrapped\n(nova.rpc.amqp): TRACE: return func(self, context, *args, **kwargs)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 372, in deallocate_for_instance\n(nova.rpc.amqp): TRACE: super(FloatingIP, self).deallocate_for_instance(context, **kwargs)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 258, in wrapped\n(nova.rpc.amqp): TRACE: return func(self, context, *args, **kwargs)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 927, in deallocate_for_instance\n(nova.rpc.amqp): TRACE: **kwargs)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 248, in deallocate_fixed_ip\n(nova.rpc.amqp): TRACE: address)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 1218, in deallocate_fixed_ip\n(nova.rpc.amqp): TRACE: self.driver.release_dhcp(dev, address, vif['address'])\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/network/linux_net.py\", line 634, in release_dhcp\n(nova.rpc.amqp): TRACE: utils.execute('dhcp_release', dev, address, mac_address, run_as_root=True)\n(nova.rpc.amqp): TRACE: File \"/home/mymachine/openstack/nova/app/nova/utils.py\", line 242, in execute\n(nova.rpc.amqp): TRACE: cmd=' '.join(cmd))\n(nova.rpc.amqp): TRACE: ProcessExecutionError: Unexpected error while running command.\n(nova.rpc.amqp): TRACE: Command: sudo dhcp_release br100 10.0.0.2 fa:16:3e:76:b8:89\n(nova.rpc.amqp): TRACE: Exit code: 1\n(nova.rpc.amqp): TRACE: Stdout: ''\n(nova.rpc.amqp): TRACE: Stderr: 'sudo: dhcp_release: command not found\\n'\n(nova.rpc.amqp): TRACE:", 
            "date_created": "2012-04-01 15:46:31.718204+00:00", 
            "author": "https://api.launchpad.net/1.0/~sumit-sngpt"
        }, 
        {
            "content": "please see https://bugs.launchpad.net/nova/+bug/953712", 
            "date_created": "2012-04-02 00:00:29.214436+00:00", 
            "author": "https://api.launchpad.net/1.0/~gongysh"
        }, 
        {
            "content": "Thanks for the link.\n\nThis looks like incorporated in Fedora latest release but not yet in RHEL6.x(https://bugzilla.redhat.com/show_bug.cgi?id=788485). At this point of time since its missing on RHEL, is it possible to disable \"force_dhcp_release\" option from Nova? I mean what would be the side affect, if any? Just curious.\n\n\nThanks!", 
            "date_created": "2012-04-02 07:09:09.732937+00:00", 
            "author": "https://api.launchpad.net/1.0/~sumit-sngpt"
        }, 
        {
            "content": "force_dhcp_release=false\r\n\r\n----------------------------------------------------------------------------------------------------------------------------------------\r\nYong Sheng Gong(\u9f9a\u6c38\u751f)\r\nAdvisory Software Engineer\r\nCloud Development and Cloud Solution Integration\r\nChina Systems & Technology Lab\r\nMobile: 15810992504\r\nSkype: gong_ys2004\r\nEmail:<email address hidden>\r\nAddress: Ring Building, No. 28, ZhongGuanCun Software Park, No.8 Dong Bei\r\nWang West Road, Haidian District Beijing P.R.China 100193\r\n\u5730\u5740: \u5317\u4eac\u5e02\u6d77\u6dc0\u533a\u4e1c\u5317\u65fa\u897f\u8def8\u53f7\u4e2d\u5173\u6751\u8f6f\u4ef6\u56ed28\u53f7\u697c\u73af\u5b87\u5927\u53a6 \u90ae\u653f\u7f16\u7801\uff1a100193\r\n\r\n\r\n\r\nFrom:\tSumit Sengupta <email address hidden>\r\nTo:\tYong Sheng Gong/China/IBM@IBMCN\r\nDate:\t04/02/2012 03:16 PM\r\nSubject:\t[Bug 970893] Re: nova: dhcp_release command not found on RHEL6\r\nSent by:\t<email address hidden>\r\n\r\n\r\n\r\nThanks for the link.\r\n\r\nThis looks like incorporated in Fedora latest release but not yet in\r\nRHEL6.x(https://bugzilla.redhat.com/show_bug.cgi?id=788485). At this\r\npoint of time since its missing on RHEL, is it possible to disable\r\n\"force_dhcp_release\" option from Nova? I mean what would be the side\r\naffect, if any? Just curious.\r\n\r\n\r\nThanks!\r\n\r\n** Bug watch added: Red Hat Bugzilla #788485\r\n   https://bugzilla.redhat.com/show_bug.cgi?id=788485\r\n\r\n--\r\nYou received this bug notification because you are subscribed to the bug\r\nreport.\r\nhttps://bugs.launchpad.net/bugs/970893\r\n\r\nTitle:\r\n  nova: dhcp_release command not found on RHEL6\r\n\r\nStatus in OpenStack Compute (Nova):\r\n  New\r\n\r\nBug description:\r\n  nova-network log has error on RHEL6.x where it tries to execute\r\n  dhcp_release command and fails. Do we have any setting which has to be\r\n  disabled which should have been done during installation? I think this\r\n  works on Ubuntu so is there any replacement for this command on RHEL6?\r\n\r\n  2012-03-30 08:56:16 ERROR nova.rpc.amqp\r\n[req-5a94ee87-fc3b-4d1b-a27c-e66991003f3a 6fc59f8248214624aec0d82556abe66f\r\ndf42460ef5f74eb9bf5f12dedd6d08c1] Exception during message handling\r\n  (nova.rpc.amqp): TRACE: Traceback (most recent call last):\r\n  (nova.rpc.amqp): TRACE: File\r\n\"/home/mymachine/openstack/nova/app/nova/rpc/amqp.py\", line 252, in\r\n_process_data\r\n  (nova.rpc.amqp): TRACE: rval = node_func(context=ctxt, **node_args)\r\n  (nova.rpc.amqp): TRACE: File\r\n\"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 258, in\r\nwrapped\r\n  (nova.rpc.amqp): TRACE: return func(self, context, *args, **kwargs)\r\n  (nova.rpc.amqp): TRACE: File\r\n\"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 372, in\r\ndeallocate_for_instance\r\n  (nova.rpc.amqp): TRACE: super(FloatingIP, self).deallocate_for_instance\r\n(context, **kwargs)\r\n  (nova.rpc.amqp): TRACE: File\r\n\"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 258, in\r\nwrapped\r\n  (nova.rpc.amqp): TRACE: return func(self, context, *args, **kwargs)\r\n  (nova.rpc.amqp): TRACE: File\r\n\"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 927, in\r\ndeallocate_for_instance\r\n  (nova.rpc.amqp): TRACE: **kwargs)\r\n  (nova.rpc.amqp): TRACE: File\r\n\"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 248, in\r\ndeallocate_fixed_ip\r\n  (nova.rpc.amqp): TRACE: address)\r\n  (nova.rpc.amqp): TRACE: File\r\n\"/home/mymachine/openstack/nova/app/nova/network/manager.py\", line 1218, in\r\ndeallocate_fixed_ip\r\n  (nova.rpc.amqp): TRACE: self.driver.release_dhcp(dev, address, vif\r\n['address'])\r\n  (nova.rpc.amqp): TRACE: File\r\n\"/home/mymachine/openstack/nova/app/nova/network/linux_net.py\", line 634,\r\nin release_dhcp\r\n  (nova.rpc.amqp): TRACE: utils.execute('dhcp_release', dev, address,\r\nmac_address, run_as_root=True)\r\n  (nova.rpc.amqp): TRACE: File\r\n\"/home/mymachine/openstack/nova/app/nova/utils.py\", line 242, in execute\r\n  (nova.rpc.amqp): TRACE: cmd=' '.join(cmd))\r\n  (nova.rpc.amqp): TRACE: ProcessExecutionError: Unexpected error while\r\nrunning command.\r\n  (nova.rpc.amqp): TRACE: Command: sudo dhcp_release br100 10.0.0.2\r\nfa:16:3e:76:b8:89\r\n  (nova.rpc.amqp): TRACE: Exit code: 1\r\n  (nova.rpc.amqp): TRACE: Stdout: ''\r\n  (nova.rpc.amqp): TRACE: Stderr: 'sudo: dhcp_release: command not found\\n'\r\n  (nova.rpc.amqp): TRACE:\r\n\r\nTo manage notifications about this bug go to:\r\nhttps://bugs.launchpad.net/nova/+bug/970893/+subscriptions\r\n\r\n", 
            "date_created": "2012-04-02 09:53:50+00:00", 
            "author": "https://api.launchpad.net/1.0/~gongysh"
        }, 
        {
            "content": "Since the command dhcp_release not yet available for RHEL so currently running nova with flag \"force_dhcp_release=false\" but not sure how it affect when I use multi-hosts system.", 
            "date_created": "2012-04-03 13:06:34.900422+00:00", 
            "author": "https://api.launchpad.net/1.0/~sumit-sngpt"
        }, 
        {
            "content": "If force_dhcp_release is False, your ips will return to thepool after timeout after fixed_ip_disassocate_timeout seconds:\n\n# fixed_ip_disassociate_timeout=600\n\ncurrently set to 10 minutes.  As long as you have a largish pool of fixed ips and you aren't launching and terminating too rapidly you should be fine.", 
            "date_created": "2012-04-03 18:02:58+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "I marked this as \"Invalid\", but just because it's not a problem in nova.  If you'd like to follow up on this becoming available in RHEL or EPEL, the Fedora Cloud SIG mailing list would be a good place to ask   https://lists.fedoraproject.org/mailman/listinfo/cloud", 
            "date_created": "2012-04-21 09:08:19.020745+00:00", 
            "author": "https://api.launchpad.net/1.0/~russellb"
        }, 
        {
            "content": "My BoolOpt to the force_dhcp_release is True,\nOn the RHEL6.3, I just install a tool named dnsmasq-utils\n[root@controler nova]# rpm -ql dnsmasq-utils\n/usr/bin/dhcp_lease_time\n/usr/bin/dhcp_release\n/usr/share/man/man1/dhcp_lease_time.1.gz\n/usr/share/man/man1/dhcp_release.1.gz\n\nNow the Command \"dhcp_release\" present . May be this can help you!", 
            "date_created": "2013-03-19 02:12:35.291216+00:00", 
            "author": "https://api.launchpad.net/1.0/~lixuecheng8903"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/36660", 
            "date_created": "2013-07-11 13:33:58.518698+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/36660\nCommitted: http://github.com/openstack/nova/commit/8c5d132f2f1e8bebd8f167b46d5155134bd6a78c\nSubmitter: Jenkins\nBranch:    master\n\ncommit 8c5d132f2f1e8bebd8f167b46d5155134bd6a78c\nAuthor: Joe Gordon <email address hidden>\nDate:   Thu Jul 11 10:31:51 2013 +0100\n\n    Change force_dhcp_release default to True\n    \n    Historically it was was false because it requires the dnsmasq binary\n    'dhcp_release' which was not present in all distros.\n    \n    Related to bug 970893\n    \n    DocImpact\n    \n    Change-Id: I4975d85a66fb930d6a56900dd569cec2a1874439\n", 
            "date_created": "2013-07-24 20:35:53.804945+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}