{
    "status": "Invalid", 
    "last_updated": "2017-06-16 17:00:37.531445+00:00", 
    "description": "Seeing the following traceback from nova-compute when trying to launch instances in tripleo-ci for stable/liberty (using the ironic driver):\n\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79] Traceback (most recent call last):\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2155, in _build_resources\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     yield resources\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2009, in _build_and_run_instance\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     block_device_info=block_device_info)\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/virt/ironic/driver.py\", line 802, in spawn\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     files=injected_files)\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/virt/ironic/driver.py\", line 716, in _generate_configdrive\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     \"error: %s\"), e, instance=instance)\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 195, in __exit__\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     six.reraise(self.type_, self.value, self.tb)\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/virt/ironic/driver.py\", line 711, in _generate_configdrive\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     with configdrive.ConfigDriveBuilder(instance_md=i_meta) as cdb:\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/virt/configdrive.py\", line 72, in __init__\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     self.add_instance_metadata(instance_md)\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/virt/configdrive.py\", line 93, in add_instance_metadata\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     for (path, data) in instance_md.metadata_for_config_drive():\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/api/metadata/base.py\", line 465, in metadata_for_config_drive\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     yield (filepath, jsonutils.dump_as_bytes(data['meta-data']))\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79] AttributeError: 'module' object has no attribute 'dump_as_bytes'\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]\n2016-01-07 13:32:27.693 19349 INFO nova.compute.manager [req-6b73f4c5-c031-496e-b2f0-a5380d3ca7ba 285d1c33eca8410e9ed03bbe3de03d15 9448d5b54ff84bd6a8a04b1083eb920f - - -] [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79] Termi\n\n\nI believe it's caused by this commit:\nhttps://review.openstack.org/#/c/246792/\n\nwhich I've submitted a revert for:\nhttps://review.openstack.org/#/c/264793/\n\nThe failed tripleo-ci job:\nhttp://logs.openstack.org/46/254946/4/check-tripleo/gate-tripleo-ci-f22-nonha/1363b32/\n\nfrom this patch:\nhttps://review.openstack.org/#/c/254946/\n\nThe version of oslo.serialization in use on the job is python2-oslo-serialization-1.9.1-dev3.el7.centos.noarch, tripleo-ci uses delorean which is building rpm's based on the latest from stable/liberty", 
    "tags": [
        "in-stable-liberty"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1531881", 
    "owner": "None", 
    "id": 1531881, 
    "index": 5948, 
    "created": "2016-01-07 14:46:22.108309+00:00", 
    "title": "AttributeError: 'module' object has no attribute 'dump_as_bytes'", 
    "comments": [
        {
            "content": "Seeing the following traceback from nova-compute when trying to launch instances in tripleo-ci for stable/liberty (using the ironic driver):\n\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79] Traceback (most recent call last):\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2155, in _build_resources\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     yield resources\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2009, in _build_and_run_instance\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     block_device_info=block_device_info)\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/virt/ironic/driver.py\", line 802, in spawn\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     files=injected_files)\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/virt/ironic/driver.py\", line 716, in _generate_configdrive\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     \"error: %s\"), e, instance=instance)\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 195, in __exit__\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     six.reraise(self.type_, self.value, self.tb)\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/virt/ironic/driver.py\", line 711, in _generate_configdrive\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     with configdrive.ConfigDriveBuilder(instance_md=i_meta) as cdb:\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/virt/configdrive.py\", line 72, in __init__\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     self.add_instance_metadata(instance_md)\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/virt/configdrive.py\", line 93, in add_instance_metadata\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     for (path, data) in instance_md.metadata_for_config_drive():\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]   File \"/usr/lib/python2.7/site-packages/nova/api/metadata/base.py\", line 465, in metadata_for_config_drive\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]     yield (filepath, jsonutils.dump_as_bytes(data['meta-data']))\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79] AttributeError: 'module' object has no attribute 'dump_as_bytes'\n2016-01-07 13:32:27.691 19349 ERROR nova.compute.manager [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79]\n2016-01-07 13:32:27.693 19349 INFO nova.compute.manager [req-6b73f4c5-c031-496e-b2f0-a5380d3ca7ba 285d1c33eca8410e9ed03bbe3de03d15 9448d5b54ff84bd6a8a04b1083eb920f - - -] [instance: 5a7c299b-f6b6-48d8-a20e-36e72c7bed79] Termi\n\n\nI believe it's caused by this commit:\nhttps://review.openstack.org/#/c/246792/\n\nwhich I've submitted a revert for:\nhttps://review.openstack.org/#/c/264793/\n\nThe failed tripleo-ci job:\nhttp://logs.openstack.org/46/254946/4/check-tripleo/gate-tripleo-ci-f22-nonha/1363b32/\n\nfrom this patch:\nhttps://review.openstack.org/#/c/254946/\n\nThe version of oslo.serialization in use on the job is python2-oslo-serialization-1.9.1-dev3.el7.centos.noarch, tripleo-ci uses delorean which is building rpm's based on the latest from stable/liberty", 
            "date_created": "2016-01-07 14:46:22.108309+00:00", 
            "author": "https://api.launchpad.net/1.0/~james-slagle"
        }, 
        {
            "content": "Revert is approved for nova: https://review.openstack.org/#/c/264793/", 
            "date_created": "2016-01-07 15:47:22.197302+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/264793\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=cf75bf233fb444d363a004845789e9deb965d27d\nSubmitter: Jenkins\nBranch:    stable/liberty\n\ncommit cf75bf233fb444d363a004845789e9deb965d27d\nAuthor: James Slagle <email address hidden>\nDate:   Thu Jan 7 09:27:26 2016 -0500\n\n    Revert \"Fixes Python 3 str issue in ConfigDrive creation\"\n    \n    This reverts commit 0134d88b750c304fa893ed4778806e56ec410857.\n    \n    The commit was breaking tripleo-ci on stable/liberty with this error:\n    AttributeError: 'module' object has no attribute 'dump_as_bytes'\n    \n    The root cause is that jsonutils.py from the stable/liberty version of\n    oslo.serialization does not have a dump_as_bytes method.\n    \n    Partial-Bug: #1531881\n    Change-Id: I6a0c90fc319dc3d7fc4ed3347495758cbd7d0cc2\n", 
            "date_created": "2016-01-11 05:58:37.667243+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Looks like the revert landed, so I'm marking this fixed for tripleo.", 
            "date_created": "2016-02-19 20:07:47.399950+00:00", 
            "author": "https://api.launchpad.net/1.0/~bnemec"
        }
    ]
}