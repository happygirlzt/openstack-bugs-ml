{
    "status": "Fix Released", 
    "last_updated": "2010-10-25 20:19:54.821003+00:00", 
    "description": "Clean trunk at r164, this morning I get:\n\n===============================================================================\n[ERROR]: nova.tests.api_unittest.ApiEc2TestCase.test_describe_instances\n\nTraceback (most recent call last):\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 222, in run\n    d = self._maybeInlineCallbacks(testMethod)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 182, in _maybeInlineCallbacks\n    g = f()\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 182, in test_describe_instances\n    self.assertEqual(self.ec2.get_all_instances(), [])\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/ec2/connection.py\", line 376, in get_all_instances\n    return self.get_list('DescribeInstances', params, [('item', Reservation)])\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 621, in get_list\n    response = self.make_request(action, params, path, verb)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 608, in make_request\n    headers=headers)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 477, in make_request\n    return self._mexe(method, path, data, headers, host, sender)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 406, in _mexe\n    connection.request(method, path, data, headers)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 129, in request\n    host=self.host)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 46, in boto_to_tornado\n    headers = httpserver.HTTPHeaders()\nexceptions.AttributeError: 'module' object has no attribute 'HTTPHeaders'\n===============================================================================\n[ERROR]: nova.tests.api_unittest.ApiEc2TestCase.test_get_all_key_pairs\n\nTraceback (most recent call last):\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 222, in run\n    d = self._maybeInlineCallbacks(testMethod)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 182, in _maybeInlineCallbacks\n    g = f()\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 196, in test_get_all_key_pairs\n    rv = self.ec2.get_all_key_pairs()\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/ec2/connection.py\", line 1242, in get_all_key_pairs\n    return self.get_list('DescribeKeyPairs', params, [('item', KeyPair)])\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 621, in get_list\n    response = self.make_request(action, params, path, verb)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 608, in make_request\n    headers=headers)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 477, in make_request\n    return self._mexe(method, path, data, headers, host, sender)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 406, in _mexe\n    connection.request(method, path, data, headers)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 129, in request\n    host=self.host)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 46, in boto_to_tornado\n    headers = httpserver.HTTPHeaders()\nexceptions.AttributeError: 'module' object has no attribute 'HTTPHeaders'\n\nIs this a twisted versioning issue?", 
    "tags": [], 
    "importance": "Low", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/610140", 
    "owner": "https://api.launchpad.net/1.0/~jaypipes", 
    "id": 610140, 
    "index": 4923, 
    "created": "2010-07-26 16:38:16.657530+00:00", 
    "title": "r164 - ApiEc2TestCase failures - HTTPHeaders", 
    "comments": [
        {
            "content": "Clean trunk at r164, this morning I get:\n\n===============================================================================\n[ERROR]: nova.tests.api_unittest.ApiEc2TestCase.test_describe_instances\n\nTraceback (most recent call last):\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 222, in run\n    d = self._maybeInlineCallbacks(testMethod)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 182, in _maybeInlineCallbacks\n    g = f()\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 182, in test_describe_instances\n    self.assertEqual(self.ec2.get_all_instances(), [])\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/ec2/connection.py\", line 376, in get_all_instances\n    return self.get_list('DescribeInstances', params, [('item', Reservation)])\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 621, in get_list\n    response = self.make_request(action, params, path, verb)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 608, in make_request\n    headers=headers)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 477, in make_request\n    return self._mexe(method, path, data, headers, host, sender)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 406, in _mexe\n    connection.request(method, path, data, headers)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 129, in request\n    host=self.host)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 46, in boto_to_tornado\n    headers = httpserver.HTTPHeaders()\nexceptions.AttributeError: 'module' object has no attribute 'HTTPHeaders'\n===============================================================================\n[ERROR]: nova.tests.api_unittest.ApiEc2TestCase.test_get_all_key_pairs\n\nTraceback (most recent call last):\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 222, in run\n    d = self._maybeInlineCallbacks(testMethod)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 182, in _maybeInlineCallbacks\n    g = f()\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 196, in test_get_all_key_pairs\n    rv = self.ec2.get_all_key_pairs()\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/ec2/connection.py\", line 1242, in get_all_key_pairs\n    return self.get_list('DescribeKeyPairs', params, [('item', KeyPair)])\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 621, in get_list\n    response = self.make_request(action, params, path, verb)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 608, in make_request\n    headers=headers)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 477, in make_request\n    return self._mexe(method, path, data, headers, host, sender)\n  File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 406, in _mexe\n    connection.request(method, path, data, headers)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 129, in request\n    host=self.host)\n  File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 46, in boto_to_tornado\n    headers = httpserver.HTTPHeaders()\nexceptions.AttributeError: 'module' object has no attribute 'HTTPHeaders'\n\nIs this a twisted versioning issue?", 
            "date_created": "2010-07-26 16:38:16.657530+00:00", 
            "author": "https://api.launchpad.net/1.0/~jaypipes"
        }, 
        {
            "content": "On 07/26/2010 06:38 PM, Jay Pipes wrote:\n> Public bug reported:\n> \n> Clean trunk at r164, this morning I get:\n> \n> ===============================================================================\n> [ERROR]: nova.tests.api_unittest.ApiEc2TestCase.test_describe_instances\n> \n> Traceback (most recent call last):\n>   File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 222, in run\n>     d = self._maybeInlineCallbacks(testMethod)\n>   File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 182, in _maybeInlineCallbacks\n>     g = f()\n>   File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 182, in test_describe_instances\n>     self.assertEqual(self.ec2.get_all_instances(), [])\n>   File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/ec2/connection.py\", line 376, in get_all_instances\n>     return self.get_list('DescribeInstances', params, [('item', Reservation)])\n>   File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 621, in get_list\n>     response = self.make_request(action, params, path, verb)\n>   File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 608, in make_request\n>     headers=headers)\n>   File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 477, in make_request\n>     return self._mexe(method, path, data, headers, host, sender)\n>   File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 406, in _mexe\n>     connection.request(method, path, data, headers)\n>   File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 129, in request\n>     host=self.host)\n>   File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 46, in boto_to_tornado\n>     headers = httpserver.HTTPHeaders()\n> exceptions.AttributeError: 'module' object has no attribute 'HTTPHeaders'\n> ===============================================================================\n> [ERROR]: nova.tests.api_unittest.ApiEc2TestCase.test_get_all_key_pairs\n> \n> Traceback (most recent call last):\n>   File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 222, in run\n>     d = self._maybeInlineCallbacks(testMethod)\n>   File \"/home/jpipes/repos/nova/data-store-driver/nova/test.py\", line 182, in _maybeInlineCallbacks\n>     g = f()\n>   File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 196, in test_get_all_key_pairs\n>     rv = self.ec2.get_all_key_pairs()\n>   File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/ec2/connection.py\", line 1242, in get_all_key_pairs\n>     return self.get_list('DescribeKeyPairs', params, [('item', KeyPair)])\n>   File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 621, in get_list\n>     response = self.make_request(action, params, path, verb)\n>   File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 608, in make_request\n>     headers=headers)\n>   File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 477, in make_request\n>     return self._mexe(method, path, data, headers, host, sender)\n>   File \"/home/jpipes/virtenvs/nova/data-store-driver/lib/python2.6/site-packages/boto-2.0b1-py2.6.egg/boto/connection.py\", line 406, in _mexe\n>     connection.request(method, path, data, headers)\n>   File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 129, in request\n>     host=self.host)\n>   File \"/home/jpipes/repos/nova/data-store-driver/nova/tests/api_unittest.py\", line 46, in boto_to_tornado\n>     headers = httpserver.HTTPHeaders()\n> exceptions.AttributeError: 'module' object has no attribute 'HTTPHeaders'\n> \n> Is this a twisted versioning issue?\n> \n> ** Affects: nova\n>      Importance: Undecided\n>          Status: New\n> \n\nThis is a tornado versioning issue, the following patch fixes it:\nhttp://pastebin.ubuntu.com/469186/\n\nBest regards\n\n-- \nMuharem Hrnjadovic <email address hidden>\nPublic key id   : B2BBFCFC\nKey fingerprint : A5A3 CC67 2B87 D641 103F  5602 219F 6B60 B2BB FCFC\n\n", 
            "date_created": "2010-07-26 16:55:15+00:00", 
            "author": "https://api.launchpad.net/1.0/~al-maisan"
        }, 
        {
            "content": "Thanks!  Does that patch fix for all versions of Tornado and not just old versions?", 
            "date_created": "2010-07-26 17:07:36.504021+00:00", 
            "author": "https://api.launchpad.net/1.0/~jaypipes"
        }, 
        {
            "content": "fix that supports both versions:\n\n=== modified file 'nova/tests/api_unittest.py'\n--- nova/tests/api_unittest.py  2010-07-15 23:13:48 +0000\n+++ nova/tests/api_unittest.py  2010-07-27 01:45:18 +0000\n@@ -43,7 +43,13 @@\n \n     connection should be a FakeTornadoHttpConnection instance\n     \"\"\"\n-    headers = httpserver.HTTPHeaders()\n+    # fix to support all versions of tornado\n+    try:\n+        headers = httpserver.HTTPHeaders()\n+    except AttributeError:\n+        from tornado import httputil\n+        headers = httputil.HTTPHeaders()\n+\n     for k, v in headers.iteritems():\n         headers[k] = v", 
            "date_created": "2010-07-27 01:47:28.010673+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }
    ]
}