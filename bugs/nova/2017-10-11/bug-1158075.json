{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:44:22.929398+00:00", 
    "description": "When creating a network which is already existing, we got\nan internal error which can't show the reason of the error.\n\n$ nova network-list\n+----+---------+----------------+\n| ID | Label   | Cidr           |\n+----+---------+----------------+\n| 1  | private | 10.0.0.0/24    |\n| 5  | net1    | 192.168.0.0/24 |\n+----+---------+----------------+\n$ nova network-create --fixed-range-v4 192.168.0.0/24 net2\nERROR: The server has either erred or is incapable of performing the requested operation.\n(HTTP 500) (Request-ID: req-24d9b71b-d7a6-4604-8b7d-244a73ac1794)\n\nAnd the error message in logfile is as follows:\n\n2013-03-21 09:55:52.533 ERROR nova.openstack.common.rpc.amqp [req-24d9b71b-d7a6-4604-8b7d-\n244a73ac1794 admin demo] Exception during message handling\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call l\nast):\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/\nopenstack/common/rpc/amqp.py\", line 430, in _process_data\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatc\nh(ctxt, version, method, **args)\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/\nopenstack/common/rpc/dispatcher.py\", line 133, in dispatch\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 1056, in create_networks\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp     return self._do_create_networks(context, **kwargs)\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 1116, in _do_create_networks\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp     raise ValueError(_('cidr already in use'))\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp ValueError: cidr already in use\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp\n2013-03-21 09:55:52.533 ERROR nova.openstack.common.rpc.common [req-24d9b71b-d7a6-4604-8b7d-244a73ac1794 admin demo] Returning exception cidr already in use to caller\n2013-03-21 09:55:52.534 ERROR nova.openstack.common.rpc.common [req-24d9b71b-d7a6-4604-8b7d-244a73ac1794 admin demo] ['Traceback (most recent call last):\\n', \n' File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 430, in _process_data\\n   \n rval = self.proxy.dispatch(ctxt, version, method, **args)\\n', \n '  File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 133, in dispatch\\n    \n return getattr(proxyobj, method)(ctxt, **kwargs)\\n', \n ' File \"/opt/stack/nova/nova/network/manager.py\", line 1056, in create_networks\\n \n   return self._do_create_networks(context, **kwargs)\\n', \n 'File \"/opt/stack/nova/nova/network/manager.py\",line 1116, in _do_create_networks\\n  \n  raise ValueError(_(\\'cidr already in use\\'))\\n','ValueError: cidr already in use\\n']", 
    "tags": [], 
    "importance": "Low", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1158075", 
    "owner": "https://api.launchpad.net/1.0/~xu-haiwei", 
    "id": 1158075, 
    "index": 5713, 
    "created": "2013-03-21 01:29:53.793102+00:00", 
    "title": "network-create returns an internal error when network conflicts", 
    "comments": [
        {
            "content": "When creating a network which is already existing, we got\nan internal error which can't show the reason of the error.\n\n$ nova network-list\n+----+---------+----------------+\n| ID | Label   | Cidr           |\n+----+---------+----------------+\n| 1  | private | 10.0.0.0/24    |\n| 5  | net1    | 192.168.0.0/24 |\n+----+---------+----------------+\n$ nova network-create --fixed-range-v4 192.168.0.0/24 net2\nERROR: The server has either erred or is incapable of performing the requested operation.\n(HTTP 500) (Request-ID: req-24d9b71b-d7a6-4604-8b7d-244a73ac1794)\n\nAnd the error message in logfile is as follows:\n\n2013-03-21 09:55:52.533 ERROR nova.openstack.common.rpc.amqp [req-24d9b71b-d7a6-4604-8b7d-\n244a73ac1794 admin demo] Exception during message handling\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call l\nast):\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/\nopenstack/common/rpc/amqp.py\", line 430, in _process_data\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatc\nh(ctxt, version, method, **args)\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/\nopenstack/common/rpc/dispatcher.py\", line 133, in dispatch\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 1056, in create_networks\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp     return self._do_create_networks(context, **kwargs)\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 1116, in _do_create_networks\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp     raise ValueError(_('cidr already in use'))\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp ValueError: cidr already in use\n2013-03-21 09:55:52.533 TRACE nova.openstack.common.rpc.amqp\n2013-03-21 09:55:52.533 ERROR nova.openstack.common.rpc.common [req-24d9b71b-d7a6-4604-8b7d-244a73ac1794 admin demo] Returning exception cidr already in use to caller\n2013-03-21 09:55:52.534 ERROR nova.openstack.common.rpc.common [req-24d9b71b-d7a6-4604-8b7d-244a73ac1794 admin demo] ['Traceback (most recent call last):\\n', \n' File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 430, in _process_data\\n   \n rval = self.proxy.dispatch(ctxt, version, method, **args)\\n', \n '  File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 133, in dispatch\\n    \n return getattr(proxyobj, method)(ctxt, **kwargs)\\n', \n ' File \"/opt/stack/nova/nova/network/manager.py\", line 1056, in create_networks\\n \n   return self._do_create_networks(context, **kwargs)\\n', \n 'File \"/opt/stack/nova/nova/network/manager.py\",line 1116, in _do_create_networks\\n  \n  raise ValueError(_(\\'cidr already in use\\'))\\n','ValueError: cidr already in use\\n']", 
            "date_created": "2013-03-21 01:29:53.793102+00:00", 
            "author": "https://api.launchpad.net/1.0/~xu-haiwei"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/25116", 
            "date_created": "2013-03-22 08:59:34.112765+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/25116\nCommitted: http://github.com/openstack/nova/commit/8a80c4c0968a9deceaa6d99629c6d7f7889769e5\nSubmitter: Jenkins\nBranch:    master\n\ncommit 8a80c4c0968a9deceaa6d99629c6d7f7889769e5\nAuthor: Haiwei Xu <email address hidden>\nDate:   Mon Apr 1 16:48:56 2013 +0900\n\n    Return proper error message when network conflicts\n    \n    Fixes bug 1158075\n    When creating a network which is already existing, we got\n    an internal server error which can't show the error reason.\n    This patch returns conflict error(HTTP 409) instead of\n    internal server error(HTTP 500), so that users can know\n    the error reason from the error message.\n    \n    Change-Id: I9e39a7152e37756b34b1c8d77de057012743f0f7\n", 
            "date_created": "2013-04-01 19:51:06.673917+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/grizzly\nReview: https://review.openstack.org/30884", 
            "date_created": "2013-05-29 13:58:19.779062+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/30884\nCommitted: http://github.com/openstack/nova/commit/26ae09c6b49c202d65df401b1f6353329d006c63\nSubmitter: Jenkins\nBranch:    stable/grizzly\n\ncommit 26ae09c6b49c202d65df401b1f6353329d006c63\nAuthor: Haiwei Xu <email address hidden>\nDate:   Mon Apr 1 16:48:56 2013 +0900\n\n    Return proper error message when network conflicts\n    \n    Fixes bug 1158075\n    When creating a network which is already existing, we got\n    an internal server error which can't show the error reason.\n    This patch returns conflict error(HTTP 409) instead of\n    internal server error(HTTP 500), so that users can know\n    the error reason from the error message.\n    \n    Change-Id: I9e39a7152e37756b34b1c8d77de057012743f0f7\n    (cherry picked from commit 8a80c4c0968a9deceaa6d99629c6d7f7889769e5)\n", 
            "date_created": "2013-07-23 18:30:56.536340+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}