{
    "status": "Fix Released", 
    "last_updated": "2014-08-15 22:26:02.180579+00:00", 
    "description": "Version: Havana w/ Ubuntu Repos. with Ceph for RBD.\n\n\nWhen creating Launching a instance with \"Boot from image (Creates a new volume)\" this creates the instance fine and all is well however if you shutdown the instance I can't turn it back on again.\n\n\nI get the following error in the nova-compute.log when trying to power on an shutdown instance.\n\n#######################################################################################\n2013-10-29 00:48:33.859 2746 WARNING nova.compute.utils [req-89bbd72f-2280-4fac-802a-1211ec774980 27106b78ceac4e389558566857a7875f 464099f86eb94d049ed1f7b0f0144275] [instance: cc370f6d-4be0-4cd3-9f20-bf86f5ad7c09] Can't access image $\n2013-10-29 00:48:34.040 2746 WARNING nova.virt.libvirt.vif [req-89bbd72f-2280-4fac-802a-1211ec774980 27106b78ceac4e389558566857a7875f 464099f86eb94d049ed1f7b0f0144275] Deprecated: The LibvirtHybridOVSBridgeDriver VIF driver is now de$\n2013-10-29 00:48:34.578 2746 ERROR nova.openstack.common.rpc.amqp [req-89bbd72f-2280-4fac-802a-1211ec774980 27106b78ceac4e389558566857a7875f 464099f86eb94d049ed1f7b0f0144275] Exception during message handling\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 353, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 90, in wrapped\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 73, in wrapped\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 243, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     pass\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 229, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 294, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 271, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 258, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1832, in start_instance\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     self._power_on(context, instance)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1819, in _power_on\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 1948, in power_on\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     self._hard_reboot(context, instance, network_info, block_device_info)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 1903, in _hard_reboot\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 4318, in get_instance_disk_info\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     dk_size = int(os.path.getsize(path))\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/genericpath.py\", line 49, in getsize\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     return os.stat(filename).st_size\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp OSError: [Errno 2] No such file or directory: '/var/lib/nova/instances/cc370f6d-4be0-4cd3-9f20-bf86f5ad7c09/disk'\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp\n#######################################################################################\n\n\nOn Closer inspection It seems the libvirt.xml file for the instance gets all screwed up.\n\nThis is the libvirt.xml file for this instance before shutdown.\n\n#######################################################################################\n<domain type=\"kvm\">\n  <uuid>dc9749cd-0002-41c9-ac55-5f691637146a</uuid>\n  <name>instance-00000004</name>\n  <memory>524288</memory>\n  <vcpu>1</vcpu>\n  <sysinfo type=\"smbios\">\n    <system>\n      <entry name=\"manufacturer\">OpenStack Foundation</entry>\n      <entry name=\"product\">OpenStack Nova</entry>\n      <entry name=\"version\">2013.2</entry>\n      <entry name=\"serial\">4c4c4544-0053-3210-8032-b6c04f5a5931</entry>\n      <entry name=\"uuid\">dc9749cd-0002-41c9-ac55-5f691637146a</entry>\n    </system>\n  </sysinfo>\n  <os>\n    <type>hvm</type>\n    <boot dev=\"hd\"/>\n    <smbios mode=\"sysinfo\"/>\n  </os>\n  <features>\n    <acpi/>\n    <apic/>\n  </features>\n  <clock offset=\"utc\">\n    <timer name=\"pit\" tickpolicy=\"delay\"/>\n    <timer name=\"rtc\" tickpolicy=\"catchup\"/>\n  </clock>\n  <cpu mode=\"host-model\" match=\"exact\"/>\n  <devices>\n    <disk type=\"network\" device=\"disk\">\n      <driver name=\"qemu\" type=\"raw\" cache=\"none\"/>\n      <source protocol=\"rbd\" name=\"volumes/volume-5abadeb8-49e9-4628-a54d-d742d6f2e012\">\n        <host name=\"10.100.96.10\" port=\"6789\"/>\n        <host name=\"10.100.96.11\" port=\"6789\"/>\n        <host name=\"10.100.96.12\" port=\"6789\"/>\n      </source>\n      <auth username=\"volumes\">\n        <secret type=\"ceph\" uuid=\"13a673af-ff80-3036-8310-4c72f566673d\"/>\n      </auth>\n      <target bus=\"virtio\" dev=\"vda\"/>\n      <serial>5abadeb8-49e9-4628-a54d-d742d6f2e012</serial>\n    </disk>\n    <interface type=\"bridge\">\n      <mac address=\"fa:16:3e:45:17:d4\"/>\n      <model type=\"virtio\"/>\n      <source bridge=\"qbr125aa659-01\"/>\n      <target dev=\"tap125aa659-01\"/>\n    </interface>\n    <serial type=\"file\">\n      <source path=\"/var/lib/nova/instances/dc9749cd-0002-41c9-ac55-5f691637146a/console.log\"/>\n    </serial>\n    <serial type=\"pty\"/>\n    <input type=\"tablet\" bus=\"usb\"/>\n    <graphics type=\"vnc\" autoport=\"yes\" keymap=\"en-us\" listen=\"10.100.32.10\"/>\n  </devices>\n</domain>\n#######################################################################################\n\nAll looks fine here i can see the ceph mons etc.\n\nNext i'll shutdown the instance and as expected the file stays the same now this is the file if i try to power the instance back on again.\n\nyou'll notice all of the details regarding the disk have changed and now it thinks its a qcow2 disk located on the local hard drive... how does this happen?\n\n#######################################################################################\n\n<domain type=\"kvm\">\n  <uuid>dc9749cd-0002-41c9-ac55-5f691637146a</uuid>\n  <name>instance-00000004</name>\n  <memory>524288</memory>\n  <vcpu>1</vcpu>\n  <sysinfo type=\"smbios\">\n    <system>\n      <entry name=\"manufacturer\">OpenStack Foundation</entry>\n      <entry name=\"product\">OpenStack Nova</entry>\n      <entry name=\"version\">2013.2</entry>\n      <entry name=\"serial\">4c4c4544-0053-3210-8032-b6c04f5a5931</entry>\n      <entry name=\"uuid\">dc9749cd-0002-41c9-ac55-5f691637146a</entry>\n    </system>\n  </sysinfo>\n  <os>\n    <type>hvm</type>\n    <boot dev=\"hd\"/>\n    <smbios mode=\"sysinfo\"/>\n  </os>\n  <features>\n    <acpi/>\n    <apic/>\n  </features>\n  <clock offset=\"utc\">\n    <timer name=\"pit\" tickpolicy=\"delay\"/>\n    <timer name=\"rtc\" tickpolicy=\"catchup\"/>\n  </clock>\n  <cpu mode=\"host-model\" match=\"exact\"/>\n  <devices>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/dc9749cd-0002-41c9-ac55-5f691637146a/disk\"/>\n      <target bus=\"virtio\" dev=\"vda\"/>\n    </disk>\n    <interface type=\"bridge\">\n      <mac address=\"fa:16:3e:45:17:d4\"/>\n      <model type=\"virtio\"/>\n      <source bridge=\"qbr125aa659-01\"/>\n      <target dev=\"tap125aa659-01\"/>\n    </interface>\n    <serial type=\"file\">\n      <source path=\"/var/lib/nova/instances/dc9749cd-0002-41c9-ac55-5f691637146a/console.log\"/>\n    </serial>\n    <serial type=\"pty\"/>\n    <input type=\"tablet\" bus=\"usb\"/>\n    <graphics type=\"vnc\" autoport=\"yes\" keymap=\"en-us\" listen=\"10.100.32.10\"/>\n  </devices>\n</domain>\n\n#######################################################################################", 
    "tags": [
        "havana-backport-potential", 
        "in-stable-havana", 
        "nova-manage", 
        "patch"
    ], 
    "importance": "Undecided", 
    "heat": 60, 
    "link": "https://bugs.launchpad.net/nova/+bug/1245719", 
    "owner": "https://api.launchpad.net/1.0/~thingee", 
    "id": 1245719, 
    "index": 4245, 
    "created": "2013-10-29 01:01:18.725029+00:00", 
    "title": "RBD backed instance can't shutdown and restart", 
    "comments": [
        {
            "content": "Version: Havana w/ Ubuntu Repos. with Ceph for RBD.\n\n\nWhen creating Launching a instance with \"Boot from image (Creates a new volume)\" this creates the instance fine and all is well however if you shutdown the instance I can't turn it back on again.\n\n\nI get the following error in the nova-compute.log when trying to power on an shutdown instance.\n\n#######################################################################################\n2013-10-29 00:48:33.859 2746 WARNING nova.compute.utils [req-89bbd72f-2280-4fac-802a-1211ec774980 27106b78ceac4e389558566857a7875f 464099f86eb94d049ed1f7b0f0144275] [instance: cc370f6d-4be0-4cd3-9f20-bf86f5ad7c09] Can't access image $\n2013-10-29 00:48:34.040 2746 WARNING nova.virt.libvirt.vif [req-89bbd72f-2280-4fac-802a-1211ec774980 27106b78ceac4e389558566857a7875f 464099f86eb94d049ed1f7b0f0144275] Deprecated: The LibvirtHybridOVSBridgeDriver VIF driver is now de$\n2013-10-29 00:48:34.578 2746 ERROR nova.openstack.common.rpc.amqp [req-89bbd72f-2280-4fac-802a-1211ec774980 27106b78ceac4e389558566857a7875f 464099f86eb94d049ed1f7b0f0144275] Exception during message handling\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 353, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 90, in wrapped\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 73, in wrapped\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 243, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     pass\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 229, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 294, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 271, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 258, in decorated_function\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1832, in start_instance\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     self._power_on(context, instance)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1819, in _power_on\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 1948, in power_on\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     self._hard_reboot(context, instance, network_info, block_device_info)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 1903, in _hard_reboot\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 4318, in get_instance_disk_info\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     dk_size = int(os.path.getsize(path))\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/genericpath.py\", line 49, in getsize\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp     return os.stat(filename).st_size\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp OSError: [Errno 2] No such file or directory: '/var/lib/nova/instances/cc370f6d-4be0-4cd3-9f20-bf86f5ad7c09/disk'\n2013-10-29 00:48:34.578 2746 TRACE nova.openstack.common.rpc.amqp\n#######################################################################################\n\n\nOn Closer inspection It seems the libvirt.xml file for the instance gets all screwed up.\n\nThis is the libvirt.xml file for this instance before shutdown.\n\n#######################################################################################\n<domain type=\"kvm\">\n  <uuid>dc9749cd-0002-41c9-ac55-5f691637146a</uuid>\n  <name>instance-00000004</name>\n  <memory>524288</memory>\n  <vcpu>1</vcpu>\n  <sysinfo type=\"smbios\">\n    <system>\n      <entry name=\"manufacturer\">OpenStack Foundation</entry>\n      <entry name=\"product\">OpenStack Nova</entry>\n      <entry name=\"version\">2013.2</entry>\n      <entry name=\"serial\">4c4c4544-0053-3210-8032-b6c04f5a5931</entry>\n      <entry name=\"uuid\">dc9749cd-0002-41c9-ac55-5f691637146a</entry>\n    </system>\n  </sysinfo>\n  <os>\n    <type>hvm</type>\n    <boot dev=\"hd\"/>\n    <smbios mode=\"sysinfo\"/>\n  </os>\n  <features>\n    <acpi/>\n    <apic/>\n  </features>\n  <clock offset=\"utc\">\n    <timer name=\"pit\" tickpolicy=\"delay\"/>\n    <timer name=\"rtc\" tickpolicy=\"catchup\"/>\n  </clock>\n  <cpu mode=\"host-model\" match=\"exact\"/>\n  <devices>\n    <disk type=\"network\" device=\"disk\">\n      <driver name=\"qemu\" type=\"raw\" cache=\"none\"/>\n      <source protocol=\"rbd\" name=\"volumes/volume-5abadeb8-49e9-4628-a54d-d742d6f2e012\">\n        <host name=\"10.100.96.10\" port=\"6789\"/>\n        <host name=\"10.100.96.11\" port=\"6789\"/>\n        <host name=\"10.100.96.12\" port=\"6789\"/>\n      </source>\n      <auth username=\"volumes\">\n        <secret type=\"ceph\" uuid=\"13a673af-ff80-3036-8310-4c72f566673d\"/>\n      </auth>\n      <target bus=\"virtio\" dev=\"vda\"/>\n      <serial>5abadeb8-49e9-4628-a54d-d742d6f2e012</serial>\n    </disk>\n    <interface type=\"bridge\">\n      <mac address=\"fa:16:3e:45:17:d4\"/>\n      <model type=\"virtio\"/>\n      <source bridge=\"qbr125aa659-01\"/>\n      <target dev=\"tap125aa659-01\"/>\n    </interface>\n    <serial type=\"file\">\n      <source path=\"/var/lib/nova/instances/dc9749cd-0002-41c9-ac55-5f691637146a/console.log\"/>\n    </serial>\n    <serial type=\"pty\"/>\n    <input type=\"tablet\" bus=\"usb\"/>\n    <graphics type=\"vnc\" autoport=\"yes\" keymap=\"en-us\" listen=\"10.100.32.10\"/>\n  </devices>\n</domain>\n#######################################################################################\n\nAll looks fine here i can see the ceph mons etc.\n\nNext i'll shutdown the instance and as expected the file stays the same now this is the file if i try to power the instance back on again.\n\nyou'll notice all of the details regarding the disk have changed and now it thinks its a qcow2 disk located on the local hard drive... how does this happen?\n\n#######################################################################################\n\n<domain type=\"kvm\">\n  <uuid>dc9749cd-0002-41c9-ac55-5f691637146a</uuid>\n  <name>instance-00000004</name>\n  <memory>524288</memory>\n  <vcpu>1</vcpu>\n  <sysinfo type=\"smbios\">\n    <system>\n      <entry name=\"manufacturer\">OpenStack Foundation</entry>\n      <entry name=\"product\">OpenStack Nova</entry>\n      <entry name=\"version\">2013.2</entry>\n      <entry name=\"serial\">4c4c4544-0053-3210-8032-b6c04f5a5931</entry>\n      <entry name=\"uuid\">dc9749cd-0002-41c9-ac55-5f691637146a</entry>\n    </system>\n  </sysinfo>\n  <os>\n    <type>hvm</type>\n    <boot dev=\"hd\"/>\n    <smbios mode=\"sysinfo\"/>\n  </os>\n  <features>\n    <acpi/>\n    <apic/>\n  </features>\n  <clock offset=\"utc\">\n    <timer name=\"pit\" tickpolicy=\"delay\"/>\n    <timer name=\"rtc\" tickpolicy=\"catchup\"/>\n  </clock>\n  <cpu mode=\"host-model\" match=\"exact\"/>\n  <devices>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/dc9749cd-0002-41c9-ac55-5f691637146a/disk\"/>\n      <target bus=\"virtio\" dev=\"vda\"/>\n    </disk>\n    <interface type=\"bridge\">\n      <mac address=\"fa:16:3e:45:17:d4\"/>\n      <model type=\"virtio\"/>\n      <source bridge=\"qbr125aa659-01\"/>\n      <target dev=\"tap125aa659-01\"/>\n    </interface>\n    <serial type=\"file\">\n      <source path=\"/var/lib/nova/instances/dc9749cd-0002-41c9-ac55-5f691637146a/console.log\"/>\n    </serial>\n    <serial type=\"pty\"/>\n    <input type=\"tablet\" bus=\"usb\"/>\n    <graphics type=\"vnc\" autoport=\"yes\" keymap=\"en-us\" listen=\"10.100.32.10\"/>\n  </devices>\n</domain>\n\n#######################################################################################", 
            "date_created": "2013-10-29 01:01:18.725029+00:00", 
            "author": "https://api.launchpad.net/1.0/~qgrasso-d"
        }, 
        {
            "content": "I've found if i create the instance via horizon using the \"Launch Instance\" \n\nUsing Instance Boot Source: Boot from image (creates a new volume) \n\nSelecting Image etc,\n\nwhen powered off and back on again the error happens every time.\n\nHowever! \n\nIf I create the volume first and use a \"Boot from Volume\" Option  and selecting the volume i precreated with the image, \nthe Instance it seems it can power off and on without any issues.\n\nSo could be a horizon issue in how its storing the data in sql?\n\n", 
            "date_created": "2013-10-30 04:13:43.245075+00:00", 
            "author": "https://api.launchpad.net/1.0/~qgrasso-d"
        }, 
        {
            "content": "The 'Boot from image (creates a new volume)' code path uses the new block_device_mapping_v2 api. This is most likely a bug in the implementation of this in nova that affects all volumes backends, not just rbd.", 
            "date_created": "2013-11-01 21:51:25.447949+00:00", 
            "author": "https://api.launchpad.net/1.0/~jdurgin"
        }, 
        {
            "content": "Status changed to 'Confirmed' because the bug affects multiple users.", 
            "date_created": "2013-11-07 05:35:19.313270+00:00", 
            "author": "https://api.launchpad.net/1.0/~janitor"
        }, 
        {
            "content": "This seems to be similar to Bug #1248695", 
            "date_created": "2013-11-08 11:47:28.230428+00:00", 
            "author": "https://api.launchpad.net/1.0/~blane"
        }, 
        {
            "content": "I believe this is a problem with the source_type being set to image and the destination_type being set to volume which prevents the DriverVolumeBlockDevice._transform code from firing. A work around is attached that just detects the source_type as image and forces it to volume for the check - a better solution would be to not set it to image in the first place but I haven't tracked where this is done yet.", 
            "date_created": "2013-11-12 17:30:28.048622+00:00", 
            "author": "https://api.launchpad.net/1.0/~blane"
        }, 
        {
            "content": "The attachment \"Work-around rather than fix\" seems to be a patch.  If it isn't, please remove the \"patch\" flag from the attachment, remove the \"patch\" tag, and if you are a member of the ~ubuntu-reviewers, unsubscribe the team.\n\n[This is an automated message performed by a Launchpad user owned by ~brian-murray, for any issues please contact him.]", 
            "date_created": "2013-11-12 20:23:55.184542+00:00", 
            "author": "https://api.launchpad.net/1.0/~crichton"
        }, 
        {
            "content": "I Tried to implement the patch from Blane however doesn't seem to work.\n\nWhen trying to launch a instance it now fails when it try's to map the block device.\n\nAny ideas?", 
            "date_created": "2013-11-14 03:27:46.392362+00:00", 
            "author": "https://api.launchpad.net/1.0/~qgrasso-d"
        }, 
        {
            "content": "Hi Quenten, what version are you installing, and what error do you get?", 
            "date_created": "2013-11-14 08:27:50.481179+00:00", 
            "author": "https://api.launchpad.net/1.0/~blane"
        }, 
        {
            "content": "Hi Blane,\n\nSorry for my late reply, I'm using the ubuntu Havana with the latest from \"updates\" repo.\n\nQ\n", 
            "date_created": "2013-11-19 07:55:48.912186+00:00", 
            "author": "https://api.launchpad.net/1.0/~qgrasso-d"
        }, 
        {
            "content": "I'm also having the same problem. Using RBD for both Cinder and Glance image backend. If I create an instance and select in horizon 'boot from image (create new volume)', soft/hard reboot  fails later.\n\nI get the following error from the compute manager:\n\n2013-11-19 09:56:26.036 ERROR nova.openstack.common.rpc.amqp [req-b5d86ef0-f03d-4708-b94a-e94f30055b18 admin demo] Exception during message handling\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 353, in decorated_function\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 90, in wrapped\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 73, in wrapped\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 243, in decorated_function\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     pass\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 229, in decorated_function\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 294, in decorated_function\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 271, in decorated_function\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 258, in decorated_function\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 2121, in reboot_instance\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     block_device_info = self._get_instance_volume_block_device_info(\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1822, in reboot\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1903, in _hard_reboot\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 4323, in get_instance_disk_info\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     dk_size = int(os.path.getsize(path))\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/genericpath.py\", line 49, in getsize\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp     return os.stat(filename).st_size\n2013-11-19 09:56:26.036 TRACE nova.openstack.common.rpc.amqp OSError: [Errno 2] No such file or directory: '/opt/stack/data/nova/instances/9c20f05d-9bae-4162-9408-1bddaa157dd5/disk'", 
            "date_created": "2013-11-19 10:39:05.287563+00:00", 
            "author": "https://api.launchpad.net/1.0/~thingee"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/57406", 
            "date_created": "2013-11-20 09:41:42.409544+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "I've acked the fix on the master branch - we need this on stable/havana too. I can't seem to propose the bug, but will happily do the backport.", 
            "date_created": "2013-11-20 10:00:35.971174+00:00", 
            "author": "https://api.launchpad.net/1.0/~ndipanov"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/57406\nCommitted: http://github.com/openstack/nova/commit/85d0ace169be513c30b09e13a35fa7d912f5b380\nSubmitter: Jenkins\nBranch:    master\n\ncommit 85d0ace169be513c30b09e13a35fa7d912f5b380\nAuthor: Mike Perez <email address hidden>\nDate:   Wed Nov 20 01:22:38 2013 -0800\n\n    Include image block device maps in info\n    \n    In cases for example soft/hard reboot, we were just getting volume and\n    snapshot block device maps. For block devices with a source type image,\n    Nova would fall back on a local disk location and fail.\n    \n    This change allows us to include block devices with a source of an\n    image, so that we correctly get the right the location of the block\n    device.\n    \n    Closes-Bug: #1245719\n    Change-Id: I1f726293e85183d4b84c05b635a7c606a092992f\n", 
            "date_created": "2013-11-23 17:29:25.709701+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/havana\nReview: https://review.openstack.org/58102", 
            "date_created": "2013-11-23 17:59:53.458835+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/58102\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=dfde60b4bb05c45daedc2eaa98fcd772e647fba5\nSubmitter: Jenkins\nBranch:    stable/havana\n\ncommit dfde60b4bb05c45daedc2eaa98fcd772e647fba5\nAuthor: Mike Perez <email address hidden>\nDate:   Wed Nov 20 01:22:38 2013 -0800\n\n    Include image block device maps in info\n    \n    In cases for example soft/hard reboot, we were just getting volume and\n    snapshot block device maps. For block devices with a source type image,\n    Nova would fall back on a local disk location and fail.\n    \n    This change allows us to include block devices with a source of an\n    image, so that we correctly get the right the location of the block\n    device.\n    \n    Closes-Bug: #1245719\n    Change-Id: I1f726293e85183d4b84c05b635a7c606a092992f\n    (cherry picked from commit 85d0ace169be513c30b09e13a35fa7d912f5b380)\n", 
            "date_created": "2013-12-17 16:37:39.817645+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Related to Horizon, does this bug still exist after nova patch is merged.\nI don't have Ceph environment now and cannot check it.\nHorizon team needs more information about the current status. Mark it \"Incomplete\".", 
            "date_created": "2014-03-23 20:48:16.557975+00:00", 
            "author": "https://api.launchpad.net/1.0/~amotoki"
        }, 
        {
            "content": "Marking the horizon bug as Invalid due to lack of confirmation and low probability that there is a bug in horizon", 
            "date_created": "2014-08-15 22:25:49.438268+00:00", 
            "author": "https://api.launchpad.net/1.0/~gary-w-smith"
        }
    ]
}