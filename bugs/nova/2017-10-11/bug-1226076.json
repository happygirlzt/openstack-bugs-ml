{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 12:11:45.664689+00:00", 
    "description": "2013-09-16 14:03:40.584 | ======================================================================\n2013-09-16 14:03:40.585 | FAIL: tempest.api.compute.servers.test_server_metadata.ServerMetadataTestJSON.test_delete_server_metadata_item[gate]\n2013-09-16 14:03:40.585 | tempest.api.compute.servers.test_server_metadata.ServerMetadataTestJSON.test_delete_server_metadata_item[gate]\n2013-09-16 14:03:40.585 | ----------------------------------------------------------------------\n2013-09-16 14:03:40.585 | _StringException: Empty attachments:\n2013-09-16 14:03:40.585 |   stderr\n2013-09-16 14:03:40.585 |   stdout\n2013-09-16 14:03:40.586 |\n2013-09-16 14:03:40.586 | pythonlogging:'': {{{\n2013-09-16 14:03:40.586 | 2013-09-16 13:51:05,920 Request: PUT http://127.0.0.1:8774/v2/f89374309acf4ae59b87735dffc6f395/servers/d927cfc5-a27d-4fc5-aea6-04407701a8c9/metadata\n2013-09-16 14:03:40.586 | 2013-09-16 13:51:06,137 Response Status: 200\n2013-09-16 14:03:40.586 | 2013-09-16 13:51:06,137 Nova request id: req-17714898-35be-482d-ab15-868ebc4b7e72\n2013-09-16 14:03:40.586 | 2013-09-16 13:51:06,137 Request: DELETE http://127.0.0.1:8774/v2/f89374309acf4ae59b87735dffc6f395/servers/d927cfc5-a27d-4fc5-aea6-04407701a8c9/metadata/key1\n2013-09-16 14:03:40.587 | 2013-09-16 13:51:06,289 Response Status: 500\n2013-09-16 14:03:40.587 | 2013-09-16 13:51:06,290 Nova request id: req-025fd39f-66a5-426e-bfac-fa0d3764d574\n2013-09-16 14:03:40.587 | }}}\n2013-09-16 14:03:40.587 |\n2013-09-16 14:03:40.587 | Traceback (most recent call last):\n2013-09-16 14:03:40.587 |   File \"tempest/api/compute/servers/test_server_metadata.py\", line 141, in test_delete_server_metadata_item\n2013-09-16 14:03:40.587 |     'key1')\n2013-09-16 14:03:40.588 |   File \"tempest/services/compute/json/servers_client.py\", line 267, in delete_server_metadata_item\n2013-09-16 14:03:40.588 |     (str(server_id), key))\n2013-09-16 14:03:40.588 |   File \"tempest/common/rest_client.py\", line 266, in delete\n2013-09-16 14:03:40.588 |     return self.request('DELETE', url, headers)\n2013-09-16 14:03:40.588 |   File \"tempest/common/rest_client.py\", line 394, in request\n2013-09-16 14:03:40.588 |     resp, resp_body)\n2013-09-16 14:03:40.588 |   File \"tempest/common/rest_client.py\", line 480, in _error_checker\n2013-09-16 14:03:40.589 |     raise exceptions.ComputeFault(message)\n2013-09-16 14:03:40.589 | ComputeFault: Got compute fault\n2013-09-16 14:03:40.589 | Details: The server has either erred or is incapable of performing the requested operation.\n\n=======\nConsole\n=======\nhttp://logs.openstack.org/22/46722/2/check/gate-tempest-devstack-vm-full/fd3664e/console.html\n\n===================\nDB deadlock message \n===================\nhttp://logs.openstack.org/22/46722/2/check/gate-tempest-devstack-vm-full/fd3664e/logs/screen-n-api.txt.gz#_2013-09-16_13_51_06_281", 
    "tags": [
        "db", 
        "testing"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1226076", 
    "owner": "https://api.launchpad.net/1.0/~russellb", 
    "id": 1226076, 
    "index": 3588, 
    "created": "2013-09-16 14:43:51.833570+00:00", 
    "title": "HTTP 500 on delete_server_metadata_item (DB deadlock)", 
    "comments": [
        {
            "content": "2013-09-16 14:03:40.584 | ======================================================================\n2013-09-16 14:03:40.585 | FAIL: tempest.api.compute.servers.test_server_metadata.ServerMetadataTestJSON.test_delete_server_metadata_item[gate]\n2013-09-16 14:03:40.585 | tempest.api.compute.servers.test_server_metadata.ServerMetadataTestJSON.test_delete_server_metadata_item[gate]\n2013-09-16 14:03:40.585 | ----------------------------------------------------------------------\n2013-09-16 14:03:40.585 | _StringException: Empty attachments:\n2013-09-16 14:03:40.585 |   stderr\n2013-09-16 14:03:40.585 |   stdout\n2013-09-16 14:03:40.586 | \n2013-09-16 14:03:40.586 | pythonlogging:'': {{{\n2013-09-16 14:03:40.586 | 2013-09-16 13:51:05,920 Request: PUT http://127.0.0.1:8774/v2/f89374309acf4ae59b87735dffc6f395/servers/d927cfc5-a27d-4fc5-aea6-04407701a8c9/metadata\n2013-09-16 14:03:40.586 | 2013-09-16 13:51:06,137 Response Status: 200\n2013-09-16 14:03:40.586 | 2013-09-16 13:51:06,137 Nova request id: req-17714898-35be-482d-ab15-868ebc4b7e72\n2013-09-16 14:03:40.586 | 2013-09-16 13:51:06,137 Request: DELETE http://127.0.0.1:8774/v2/f89374309acf4ae59b87735dffc6f395/servers/d927cfc5-a27d-4fc5-aea6-04407701a8c9/metadata/key1\n2013-09-16 14:03:40.587 | 2013-09-16 13:51:06,289 Response Status: 500\n2013-09-16 14:03:40.587 | 2013-09-16 13:51:06,290 Nova request id: req-025fd39f-66a5-426e-bfac-fa0d3764d574\n2013-09-16 14:03:40.587 | }}}\n2013-09-16 14:03:40.587 | \n2013-09-16 14:03:40.587 | Traceback (most recent call last):\n2013-09-16 14:03:40.587 |   File \"tempest/api/compute/servers/test_server_metadata.py\", line 141, in test_delete_server_metadata_item\n2013-09-16 14:03:40.587 |     'key1')\n2013-09-16 14:03:40.588 |   File \"tempest/services/compute/json/servers_client.py\", line 267, in delete_server_metadata_item\n2013-09-16 14:03:40.588 |     (str(server_id), key))\n2013-09-16 14:03:40.588 |   File \"tempest/common/rest_client.py\", line 266, in delete\n2013-09-16 14:03:40.588 |     return self.request('DELETE', url, headers)\n2013-09-16 14:03:40.588 |   File \"tempest/common/rest_client.py\", line 394, in request\n2013-09-16 14:03:40.588 |     resp, resp_body)\n2013-09-16 14:03:40.588 |   File \"tempest/common/rest_client.py\", line 480, in _error_checker\n2013-09-16 14:03:40.589 |     raise exceptions.ComputeFault(message)\n2013-09-16 14:03:40.589 | ComputeFault: Got compute fault\n2013-09-16 14:03:40.589 | Details: The server has either erred or is incapable of performing the requested operation.\n\nhttp://logs.openstack.org/22/46722/2/check/gate-tempest-devstack-vm-full/fd3664e/console.html\n\nhttp://logs.openstack.org/22/46722/2/check/gate-tempest-devstack-vm-full/fd3664e/logs/screen-n-api.txt.gz#_2013-09-16_13_51_06_281", 
            "date_created": "2013-09-16 14:43:51.833570+00:00", 
            "author": "https://api.launchpad.net/1.0/~afazekas"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/46964", 
            "date_created": "2013-09-17 15:02:30.695738+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/46964\nCommitted: http://github.com/openstack/nova/commit/efe441fbab46813f00d383f1dbec473f645b2ef6\nSubmitter: Jenkins\nBranch:    master\n\ncommit efe441fbab46813f00d383f1dbec473f645b2ef6\nAuthor: Russell Bryant <email address hidden>\nDate:   Tue Sep 17 10:32:28 2013 -0400\n\n    Retry on deadlock in instance_metadata_delete\n    \n    Add the retry_on_deadlock decorator to the instance_metadata_delete\n    function in the sqlalchemy db API.  A tempest test failure shows that it\n    would benefit from it.\n    \n    Change-Id: I39547fbbbabc310b78493df0dc055bc320995770\n    Closes-bug: #1226076\n", 
            "date_created": "2013-09-19 18:10:03.074274+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}