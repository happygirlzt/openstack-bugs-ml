{
    "status": "Confirmed", 
    "last_updated": "2016-07-12 10:51:06.055241+00:00", 
    "description": "CONF.libvirt.images_type is 'rbd' but rbd is not currently functional on this machine.  The result is that the rbd library hangs n-cpu for a five minutes at startup, causing AMQP connections to fail.\n\nCinder recently addressed a similar problem in bug 1401335 by moving rbd library calls into a separate thread via eventlet.tpool.  This also seems to help here.\n\n\n\n2015-05-05 11:03:02.161 DEBUG nova.openstack.common.service [req-a34db69c-4189-48bb-b409-f5c9e7057130 Non\ne None] ******************************************************************************** from (pid=14406)\n log_opt_values /usr/lib/python2.7/site-packages/oslo_config/cfg.py:2197\n2015-05-05 11:03:02.162 INFO nova.service [-] Starting compute node (version 2015.1)\n2015-05-05 11:03:02.164 DEBUG nova.virt.libvirt.host [-] Starting native event thread from (pid=14406) _i\nnit_events /opt/stack/nova/nova/virt/libvirt/host.py:446\n2015-05-05 11:03:02.165 DEBUG nova.virt.libvirt.host [-] Starting green dispatch thread from (pid=14406) \n_init_events /opt/stack/nova/nova/virt/libvirt/host.py:452\n2015-05-05 11:03:02.166 DEBUG nova.virt.libvirt.host [-] Connecting to libvirt: qemu:///system from (pid=\n14406) _get_new_connection /opt/stack/nova/nova/virt/libvirt/host.py:457\n2015-05-05 11:03:02.225 INFO nova.virt.libvirt.driver [-] Connection event '1' reason 'None'\n2015-05-05 11:03:02.278 DEBUG nova.virt.libvirt.host [req-0e133ef3-90f7-4441-909f-9f3be8bda496 None None]\n Registering for lifecycle events <nova.virt.libvirt.host.Host object at 0x61d6e90> from (pid=14406) _get\n_new_connection /opt/stack/nova/nova/virt/libvirt/host.py:475\n2015-05-05 11:03:02.282 DEBUG nova.virt.libvirt.host [req-0e133ef3-90f7-4441-909f-9f3be8bda496 None None]\n Registering for connection events: <nova.virt.libvirt.host.Host object at 0x61d6e90> from (pid=14406) _g\net_new_connection /opt/stack/nova/nova/virt/libvirt/host.py:486\n2015-05-05 11:03:02.292 INFO nova.virt.libvirt.host [req-0e133ef3-90f7-4441-909f-9f3be8bda496 None None] \nLibvirt host capabilities <capabilities>\n\n  <host>\n    <uuid>a7d47f19-9cda-2206-fad2-bdf40da6186b</uuid>\n    <cpu>\n      <arch>x86_64</arch>\n      <model>cpu64-rhel6</model>\n      <vendor>Intel</vendor>\n      <topology sockets='4' cores='1' threads='1'/>\n      <feature name='hypervisor'/>\n    </cpu>\n    <power_management>\n      <suspend_disk/>\n      <suspend_hybrid/>\n    </power_management>\n    <migration_features>\n      <live/>\n      <uri_transports>\n        <uri_transport>tcp</uri_transport>\n      </uri_transports>\n    </migration_features>\n    <topology>\n      <cells num='1'>\n        <cell id='0'>\n          <memory unit='KiB'>6974268</memory>\n          <cpus num='4'>\n            <cpu id='0' socket_id='0' core_id='0' siblings='0'/>\n            <cpu id='1' socket_id='1' core_id='0' siblings='1'/>\n            <cpu id='2' socket_id='2' core_id='0' siblings='2'/>\n            <cpu id='3' socket_id='3' core_id='0' siblings='3'/>\n          </cpus>\n        </cell>\n      </cells>\n    </topology>\n    <secmodel>\n      <model>selinux</model>\n      <doi>0</doi>\n    </secmodel>\n    <secmodel>\n      <model>dac</model>\n      <doi>0</doi>\n    </secmodel>\n  </host>\n\n  <guest>\n    <os_type>hvm</os_type>\n    <arch name='i686'>\n      <wordsize>32</wordsize>\n      <emulator>/usr/bin/qemu-system-i386</emulator>\n      <machine canonical='pc-i440fx-1.6' maxCpus='255'>pc</machine>\n      <machine maxCpus='255'>pc-q35-1.4</machine>\n      <machine maxCpus='255'>pc-q35-1.5</machine>\n      <machine canonical='pc-q35-1.6' maxCpus='255'>q35</machine>\n      <machine maxCpus='1'>isapc</machine>\n      <machine maxCpus='255'>pc-0.10</machine>\n      <machine maxCpus='255'>pc-0.11</machine>\n      <machine maxCpus='255'>pc-0.12</machine>\n      <machine maxCpus='255'>pc-0.13</machine>\n      <machine maxCpus='255'>pc-0.14</machine>\n      <machine maxCpus='255'>pc-0.15</machine>\n      <machine maxCpus='255'>pc-1.0</machine>\n      <machine maxCpus='255'>pc-1.1</machine>\n      <machine maxCpus='255'>pc-1.2</machine>\n      <machine maxCpus='255'>pc-1.3</machine>\n      <machine maxCpus='255'>pc-i440fx-1.4</machine>\n      <machine maxCpus='255'>pc-i440fx-1.5</machine>\n      <machine maxCpus='1'>none</machine>\n      <domain type='qemu'>\n      </domain>\n    </arch>\n    <features>\n      <cpuselection/>\n      <deviceboot/>\n      <acpi default='on' toggle='yes'/>\n      <apic default='on' toggle='no'/>\n      <pae/>\n      <nonpae/>\n    </features>\n  </guest>\n\n  <guest>\n    <os_type>hvm</os_type>\n    <arch name='x86_64'>\n      <wordsize>64</wordsize>\n      <emulator>/usr/bin/qemu-system-x86_64</emulator>\n      <machine canonical='pc-i440fx-1.6' maxCpus='255'>pc</machine>\n      <machine maxCpus='255'>pc-q35-1.4</machine>\n      <machine maxCpus='255'>pc-q35-1.5</machine>\n      <machine canonical='pc-q35-1.6' maxCpus='255'>q35</machine>\n      <machine maxCpus='1'>isapc</machine>\n      <machine maxCpus='255'>pc-0.10</machine>\n      <machine maxCpus='255'>pc-0.11</machine>\n      <machine maxCpus='255'>pc-0.12</machine>\n      <machine maxCpus='255'>pc-0.13</machine>\n      <machine maxCpus='255'>pc-0.14</machine>\n      <machine maxCpus='255'>pc-0.15</machine>\n      <machine maxCpus='255'>pc-1.0</machine>\n      <machine maxCpus='255'>pc-1.1</machine>\n      <machine maxCpus='255'>pc-1.2</machine>\n      <machine maxCpus='255'>pc-1.3</machine>\n      <machine maxCpus='255'>pc-i440fx-1.4</machine>\n      <machine maxCpus='255'>pc-i440fx-1.5</machine>\n      <machine maxCpus='1'>none</machine>\n      <domain type='qemu'>\n      </domain>\n    </arch>\n    <features>\n      <cpuselection/>\n      <deviceboot/>\n      <acpi default='on' toggle='yes'/>\n      <apic default='on' toggle='no'/>\n    </features>\n  </guest>\n\n</capabilities>\n\n2015-05-05 11:03:02.296 DEBUG nova.virt.libvirt.config [req-0e133ef3-90f7-4441-909f-9f3be8bda496 None Non\ne] Generated XML ('<cpu>\\n  <arch>x86_64</arch>\\n  <model>cpu64-rhel6</model>\\n  <vendor>Intel</vendor>\\n\n  <topology sockets=\"4\" cores=\"1\" threads=\"1\"/>\\n  <feature name=\"hypervisor\"/>\\n</cpu>\\n',)  from (pid=1\n4406) to_xml /opt/stack/nova/nova/virt/libvirt/config.py:82\n2015-05-05 11:03:02.560 INFO nova.compute.resource_tracker [req-0e133ef3-90f7-4441-909f-9f3be8bda496 None\n None] Auditing locally available compute resources for node devstacktest\n2015-05-05 11:08:02.606 INFO nova.virt.libvirt.driver [-] Connection event '0' reason 'Connection to libv\nirt lost: 1'\n2015-05-05 11:08:02.612 ERROR oslo_messaging._drivers.impl_qpid [req-fd8a2988-cb21-4e98-81d9-c089b93ce009\n None None] Failed to publish message to topic 'conductor': heartbeat timeout\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid Traceback (most recent call last):\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\noslo_messaging/_drivers/impl_qpid.py\", line 614, in ensure\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     return method()\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\noslo_messaging/_drivers/impl_qpid.py\", line 710, in _publisher_send\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     **kwargs)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\noslo_messaging/_drivers/impl_qpid.py\", line 420, in __init__\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     super(TopicPublisher, self).__init__(\nconf, session, node_name)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\noslo_messaging/_drivers/impl_qpid.py\", line 352, in __init__\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     self.reconnect(session)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\noslo_messaging/_drivers/impl_qpid.py\", line 356, in reconnect\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     self.sender = session.sender(self.add\nress)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"<string>\", line 6, in sender\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\nqpid/messaging/endpoints.py\", line 606, in sender\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     sender._ewait(lambda: sender.linked)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\nqpid/messaging/endpoints.py\", line 814, in _ewait\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     result = self.session._ewait(lambda: \nself.error or predicate(), timeout)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\nqpid/messaging/endpoints.py\", line 580, in _ewait\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     result = self.connection._ewait(lambd\na: self.error or predicate(), timeout)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\nqpid/messaging/endpoints.py\", line 219, in _ewait\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     self.check_error()\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\nqpid/messaging/endpoints.py\", line 212, in check_error\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     raise e\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid HeartbeatTimeout: heartbeat timeout\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid \n2015-05-05 11:08:02.653 ERROR oslo_messaging._drivers.impl_qpid [req-fd8a2988-cb21-4e98-81d9-c089b93ce009\n None None] Unable to connect to AMQP server on {'username': '', 'host': '172.16.0.10:5672', 'password': \n''}: Traceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/qpid/messaging/driver.py\", line 504, in dispatch\n    self.connect()\n  File \"/usr/lib/python2.7/site-packages/qpid/messaging/driver.py\", line 531, in connect\n    self._transport = trans(self.connection, host, port)\n  File \"/usr/lib/python2.7/site-packages/qpid/messaging/transports.py\", line 28, in __init__\n    self.socket = connect(host, port)\n  File \"/usr/lib/python2.7/site-packages/qpid/util.py\", line 66, in connect\n    sock = socket.socket(af, socktype, proto)\n  File \"/usr/lib/python2.7/site-packages/eventlet/greenio.py\", line 130, in __init__\n    notify_opened(fd.fileno())\n  File \"/usr/lib/python2.7/site-packages/eventlet/hubs/__init__.py\", line 189, in notify_opened\n    hub.mark_as_reopened(fd)\n  File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 241, in mark_as_reopened\n    self._obsolete(fileno)\n  File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 206, in _obsolete\n    listener.defang()\n  File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 73, in defang\n    self.mark_as_closed()\nTypeError: <lambda>() takes exactly 1 argument (0 given)\n. Sleeping 1 seconds\n2015-05-05 11:08:02.654 ERROR nova.openstack.common.threadgroup [req-a34db69c-4189-48bb-b409-f5c9e7057130 None None] Expected int or long, got <class 'eventlet.hubs.IOClosed'>\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/openstack/common/threadgroup.py\", line 145, in wait\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     x.wait()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/openstack/common/threadgroup.py\", line 47, in wait\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 175, in wait\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/event.py\", line 121, in wait\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 294, in switch\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 332, in run\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     self.close_one()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 265, in close_one\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     listener.tb(IOClosed(errno.ENOTCONN, \"Operation on closed file\"))\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/green/select.py\", line 59, in on_error\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     original = ds[get_fileno(d)]['error']\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/green/select.py\", line 20, in get_fileno\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     raise TypeError(\"Expected int or long, got %s\" % type(obj))\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup TypeError: Expected int or long, got <class 'eventlet.hubs.IOClosed'>\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup", 
    "tags": [
        "ceph"
    ], 
    "importance": "Wishlist", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1451891", 
    "owner": "None", 
    "id": 1451891, 
    "index": 1695, 
    "created": "2015-05-05 15:36:10.662171+00:00", 
    "title": "rbd failure to initialize during n-cpu startup breaks n-cpu", 
    "comments": [
        {
            "content": "CONF.libvirt.images_type is 'rbd' but rbd is not currently functional on this machine.  The result is that the rbd library hangs n-cpu for a five minutes at startup, causing AMQP connections to fail.\n\nCinder recently addressed a similar problem in bug 1401335 by moving rbd library calls into a separate thread via eventlet.tpool.  This also seems to help here.\n\n\n\n2015-05-05 11:03:02.161 DEBUG nova.openstack.common.service [req-a34db69c-4189-48bb-b409-f5c9e7057130 Non\ne None] ******************************************************************************** from (pid=14406)\n log_opt_values /usr/lib/python2.7/site-packages/oslo_config/cfg.py:2197\n2015-05-05 11:03:02.162 INFO nova.service [-] Starting compute node (version 2015.1)\n2015-05-05 11:03:02.164 DEBUG nova.virt.libvirt.host [-] Starting native event thread from (pid=14406) _i\nnit_events /opt/stack/nova/nova/virt/libvirt/host.py:446\n2015-05-05 11:03:02.165 DEBUG nova.virt.libvirt.host [-] Starting green dispatch thread from (pid=14406) \n_init_events /opt/stack/nova/nova/virt/libvirt/host.py:452\n2015-05-05 11:03:02.166 DEBUG nova.virt.libvirt.host [-] Connecting to libvirt: qemu:///system from (pid=\n14406) _get_new_connection /opt/stack/nova/nova/virt/libvirt/host.py:457\n2015-05-05 11:03:02.225 INFO nova.virt.libvirt.driver [-] Connection event '1' reason 'None'\n2015-05-05 11:03:02.278 DEBUG nova.virt.libvirt.host [req-0e133ef3-90f7-4441-909f-9f3be8bda496 None None]\n Registering for lifecycle events <nova.virt.libvirt.host.Host object at 0x61d6e90> from (pid=14406) _get\n_new_connection /opt/stack/nova/nova/virt/libvirt/host.py:475\n2015-05-05 11:03:02.282 DEBUG nova.virt.libvirt.host [req-0e133ef3-90f7-4441-909f-9f3be8bda496 None None]\n Registering for connection events: <nova.virt.libvirt.host.Host object at 0x61d6e90> from (pid=14406) _g\net_new_connection /opt/stack/nova/nova/virt/libvirt/host.py:486\n2015-05-05 11:03:02.292 INFO nova.virt.libvirt.host [req-0e133ef3-90f7-4441-909f-9f3be8bda496 None None] \nLibvirt host capabilities <capabilities>\n\n  <host>\n    <uuid>a7d47f19-9cda-2206-fad2-bdf40da6186b</uuid>\n    <cpu>\n      <arch>x86_64</arch>\n      <model>cpu64-rhel6</model>\n      <vendor>Intel</vendor>\n      <topology sockets='4' cores='1' threads='1'/>\n      <feature name='hypervisor'/>\n    </cpu>\n    <power_management>\n      <suspend_disk/>\n      <suspend_hybrid/>\n    </power_management>\n    <migration_features>\n      <live/>\n      <uri_transports>\n        <uri_transport>tcp</uri_transport>\n      </uri_transports>\n    </migration_features>\n    <topology>\n      <cells num='1'>\n        <cell id='0'>\n          <memory unit='KiB'>6974268</memory>\n          <cpus num='4'>\n            <cpu id='0' socket_id='0' core_id='0' siblings='0'/>\n            <cpu id='1' socket_id='1' core_id='0' siblings='1'/>\n            <cpu id='2' socket_id='2' core_id='0' siblings='2'/>\n            <cpu id='3' socket_id='3' core_id='0' siblings='3'/>\n          </cpus>\n        </cell>\n      </cells>\n    </topology>\n    <secmodel>\n      <model>selinux</model>\n      <doi>0</doi>\n    </secmodel>\n    <secmodel>\n      <model>dac</model>\n      <doi>0</doi>\n    </secmodel>\n  </host>\n\n  <guest>\n    <os_type>hvm</os_type>\n    <arch name='i686'>\n      <wordsize>32</wordsize>\n      <emulator>/usr/bin/qemu-system-i386</emulator>\n      <machine canonical='pc-i440fx-1.6' maxCpus='255'>pc</machine>\n      <machine maxCpus='255'>pc-q35-1.4</machine>\n      <machine maxCpus='255'>pc-q35-1.5</machine>\n      <machine canonical='pc-q35-1.6' maxCpus='255'>q35</machine>\n      <machine maxCpus='1'>isapc</machine>\n      <machine maxCpus='255'>pc-0.10</machine>\n      <machine maxCpus='255'>pc-0.11</machine>\n      <machine maxCpus='255'>pc-0.12</machine>\n      <machine maxCpus='255'>pc-0.13</machine>\n      <machine maxCpus='255'>pc-0.14</machine>\n      <machine maxCpus='255'>pc-0.15</machine>\n      <machine maxCpus='255'>pc-1.0</machine>\n      <machine maxCpus='255'>pc-1.1</machine>\n      <machine maxCpus='255'>pc-1.2</machine>\n      <machine maxCpus='255'>pc-1.3</machine>\n      <machine maxCpus='255'>pc-i440fx-1.4</machine>\n      <machine maxCpus='255'>pc-i440fx-1.5</machine>\n      <machine maxCpus='1'>none</machine>\n      <domain type='qemu'>\n      </domain>\n    </arch>\n    <features>\n      <cpuselection/>\n      <deviceboot/>\n      <acpi default='on' toggle='yes'/>\n      <apic default='on' toggle='no'/>\n      <pae/>\n      <nonpae/>\n    </features>\n  </guest>\n\n  <guest>\n    <os_type>hvm</os_type>\n    <arch name='x86_64'>\n      <wordsize>64</wordsize>\n      <emulator>/usr/bin/qemu-system-x86_64</emulator>\n      <machine canonical='pc-i440fx-1.6' maxCpus='255'>pc</machine>\n      <machine maxCpus='255'>pc-q35-1.4</machine>\n      <machine maxCpus='255'>pc-q35-1.5</machine>\n      <machine canonical='pc-q35-1.6' maxCpus='255'>q35</machine>\n      <machine maxCpus='1'>isapc</machine>\n      <machine maxCpus='255'>pc-0.10</machine>\n      <machine maxCpus='255'>pc-0.11</machine>\n      <machine maxCpus='255'>pc-0.12</machine>\n      <machine maxCpus='255'>pc-0.13</machine>\n      <machine maxCpus='255'>pc-0.14</machine>\n      <machine maxCpus='255'>pc-0.15</machine>\n      <machine maxCpus='255'>pc-1.0</machine>\n      <machine maxCpus='255'>pc-1.1</machine>\n      <machine maxCpus='255'>pc-1.2</machine>\n      <machine maxCpus='255'>pc-1.3</machine>\n      <machine maxCpus='255'>pc-i440fx-1.4</machine>\n      <machine maxCpus='255'>pc-i440fx-1.5</machine>\n      <machine maxCpus='1'>none</machine>\n      <domain type='qemu'>\n      </domain>\n    </arch>\n    <features>\n      <cpuselection/>\n      <deviceboot/>\n      <acpi default='on' toggle='yes'/>\n      <apic default='on' toggle='no'/>\n    </features>\n  </guest>\n\n</capabilities>\n\n2015-05-05 11:03:02.296 DEBUG nova.virt.libvirt.config [req-0e133ef3-90f7-4441-909f-9f3be8bda496 None Non\ne] Generated XML ('<cpu>\\n  <arch>x86_64</arch>\\n  <model>cpu64-rhel6</model>\\n  <vendor>Intel</vendor>\\n\n  <topology sockets=\"4\" cores=\"1\" threads=\"1\"/>\\n  <feature name=\"hypervisor\"/>\\n</cpu>\\n',)  from (pid=1\n4406) to_xml /opt/stack/nova/nova/virt/libvirt/config.py:82\n2015-05-05 11:03:02.560 INFO nova.compute.resource_tracker [req-0e133ef3-90f7-4441-909f-9f3be8bda496 None\n None] Auditing locally available compute resources for node devstacktest\n2015-05-05 11:08:02.606 INFO nova.virt.libvirt.driver [-] Connection event '0' reason 'Connection to libv\nirt lost: 1'\n2015-05-05 11:08:02.612 ERROR oslo_messaging._drivers.impl_qpid [req-fd8a2988-cb21-4e98-81d9-c089b93ce009\n None None] Failed to publish message to topic 'conductor': heartbeat timeout\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid Traceback (most recent call last):\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\noslo_messaging/_drivers/impl_qpid.py\", line 614, in ensure\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     return method()\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\noslo_messaging/_drivers/impl_qpid.py\", line 710, in _publisher_send\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     **kwargs)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\noslo_messaging/_drivers/impl_qpid.py\", line 420, in __init__\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     super(TopicPublisher, self).__init__(\nconf, session, node_name)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\noslo_messaging/_drivers/impl_qpid.py\", line 352, in __init__\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     self.reconnect(session)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\noslo_messaging/_drivers/impl_qpid.py\", line 356, in reconnect\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     self.sender = session.sender(self.add\nress)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"<string>\", line 6, in sender\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\nqpid/messaging/endpoints.py\", line 606, in sender\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     sender._ewait(lambda: sender.linked)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\nqpid/messaging/endpoints.py\", line 814, in _ewait\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     result = self.session._ewait(lambda: \nself.error or predicate(), timeout)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\nqpid/messaging/endpoints.py\", line 580, in _ewait\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     result = self.connection._ewait(lambd\na: self.error or predicate(), timeout)\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\nqpid/messaging/endpoints.py\", line 219, in _ewait\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     self.check_error()\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid   File \"/usr/lib/python2.7/site-packages/\nqpid/messaging/endpoints.py\", line 212, in check_error\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid     raise e\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid HeartbeatTimeout: heartbeat timeout\n2015-05-05 11:08:02.612 TRACE oslo_messaging._drivers.impl_qpid \n2015-05-05 11:08:02.653 ERROR oslo_messaging._drivers.impl_qpid [req-fd8a2988-cb21-4e98-81d9-c089b93ce009\n None None] Unable to connect to AMQP server on {'username': '', 'host': '172.16.0.10:5672', 'password': \n''}: Traceback (most recent call last):\n  File \"/usr/lib/python2.7/site-packages/qpid/messaging/driver.py\", line 504, in dispatch\n    self.connect()\n  File \"/usr/lib/python2.7/site-packages/qpid/messaging/driver.py\", line 531, in connect\n    self._transport = trans(self.connection, host, port)\n  File \"/usr/lib/python2.7/site-packages/qpid/messaging/transports.py\", line 28, in __init__\n    self.socket = connect(host, port)\n  File \"/usr/lib/python2.7/site-packages/qpid/util.py\", line 66, in connect\n    sock = socket.socket(af, socktype, proto)\n  File \"/usr/lib/python2.7/site-packages/eventlet/greenio.py\", line 130, in __init__\n    notify_opened(fd.fileno())\n  File \"/usr/lib/python2.7/site-packages/eventlet/hubs/__init__.py\", line 189, in notify_opened\n    hub.mark_as_reopened(fd)\n  File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 241, in mark_as_reopened\n    self._obsolete(fileno)\n  File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 206, in _obsolete\n    listener.defang()\n  File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 73, in defang\n    self.mark_as_closed()\nTypeError: <lambda>() takes exactly 1 argument (0 given)\n. Sleeping 1 seconds\n2015-05-05 11:08:02.654 ERROR nova.openstack.common.threadgroup [req-a34db69c-4189-48bb-b409-f5c9e7057130 None None] Expected int or long, got <class 'eventlet.hubs.IOClosed'>\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/openstack/common/threadgroup.py\", line 145, in wait\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     x.wait()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/openstack/common/threadgroup.py\", line 47, in wait\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 175, in wait\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/event.py\", line 121, in wait\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 294, in switch\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 332, in run\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     self.close_one()\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 265, in close_one\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     listener.tb(IOClosed(errno.ENOTCONN, \"Operation on closed file\"))\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/green/select.py\", line 59, in on_error\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     original = ds[get_fileno(d)]['error']\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/green/select.py\", line 20, in get_fileno\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup     raise TypeError(\"Expected int or long, got %s\" % type(obj))\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup TypeError: Expected int or long, got <class 'eventlet.hubs.IOClosed'>\n2015-05-05 11:08:02.654 TRACE nova.openstack.common.threadgroup", 
            "date_created": "2015-05-05 15:36:10.662171+00:00", 
            "author": "https://api.launchpad.net/1.0/~eharney"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/180207", 
            "date_created": "2015-05-05 15:50:09.648559+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/180212", 
            "date_created": "2015-05-05 15:57:50.776115+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/180207\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=8c69469e54b6d39088865f2e84ddc5de238d4627\nSubmitter: Jenkins\nBranch:    master\n\ncommit 8c69469e54b6d39088865f2e84ddc5de238d4627\nAuthor: Eric Harney <email address hidden>\nDate:   Tue May 5 11:29:48 2015 -0400\n\n    Fix missing format arg in compute manager\n    \n    Error message is not printing correctly due\n    to broken format string.\n    \n    Change-Id: Ic153e11e8847418576fde8578f17b842b5fedc46\n    Related-Bug: #1451891\n", 
            "date_created": "2015-05-06 17:48:51.397343+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Michael Still (<email address hidden>) on branch: master\nReview: https://review.openstack.org/180212\nReason: This has been WIP'ed for a long time, so I am going to abandon it. Please de-abandon when this code is ready for review.", 
            "date_created": "2015-08-12 05:33:05.173371+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "So I think this is basically a feature request, to ensure RBD calls don't block the main Nova thread.\n\nThe fact nova is broken while it can't talk to RBD sounds like a good thing, it's a simpler failure.", 
            "date_created": "2016-07-12 10:50:56.021969+00:00", 
            "author": "https://api.launchpad.net/1.0/~johngarbutt"
        }
    ]
}