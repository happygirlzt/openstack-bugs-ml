{
    "status": "Fix Released", 
    "last_updated": "2017-08-28 09:55:05.669729+00:00", 
    "description": "Description\n===========\n\nAt present disconnect_volume is not called when rebase failures are encountered during swap_volume. This results in the new volume remaining connected to the compute host prior to terminate_connection then being called. This can in turn lead to left over devices remaining on the compute host for some volume backends such as LVM/iSCSI.\n\nSteps to reproduce\n==================\n\nDownstream, the easiest way to reproduce this is via https://bugzilla.redhat.com/show_bug.cgi?id=1401755 :\n\n# sudo setenforce 1\n# nova update-volume ${instance_uuid} \\\n                     ${attached_NFS_volume_id} \\\n                     ${unattached_iSCSI_volume_id}\n\nUpstream, I've been unable to get devstack to even work correctly with SELinux in enforcing mode so I've been unable to reproduce the rollback this way.\n\nExpected result\n===============\n\nNew volume disconnected from compute host.\n\nActual result\n=============\n\nNew volume remains connected to compute host.\n\nEnvironment\n===========\n1. Exact version of OpenStack you are running. See the following\n  list for all releases: http://docs.openstack.org/releases/\n\n   N/A\n\n2. Which hypervisor did you use?\n   (For example: Libvirt + KVM, Libvirt + XEN, Hyper-V, PowerKVM, ...)\n   What's the version of that?\n\n   Libvirt + KVM\n\n2. Which storage type did you use?\n   (For example: Ceph, LVM, GPFS, ...)\n   What's the version of that?\n\n   NFS + LVM/iSCSI\n\n3. Which networking type did you use?\n   (For example: nova-network, Neutron with OpenVSwitch, ...)\n\n   N/A\n\nLogs & Configs\n==============\n\nExample Newton trace :\n\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher [req-f31f6110-e880-41e8-be1a-2c41ea7fd9ce 75fbc7a6db34480091d2a53e2e20b695 62e53e5e804e49a9890928a5a4846f60 - - -] Exception during message handling: internal error: unable to execute QEMU command 'drive-mirror': Could not open '/dev/disk/by-id/dm-uuid-mpath-360014053aac4f90daef4d76baa773169': Permission denied\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 138, in _dispatch_and_reply\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     incoming.message))\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 183, in _dispatch\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 127, in _do_dispatch\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 110, in wrapped\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     payload)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self.force_reraise()\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 89, in wrapped\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 359, in decorated_function\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     LOG.warning(msg, e, instance=instance)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self.force_reraise()\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 328, in decorated_function\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 387, in decorated_function\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self.force_reraise()\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 375, in decorated_function\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5033, in swap_volume\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     resize_to)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 4980, in _swap_volume\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self.volume_api.unreserve_volume(context, new_volume_id)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self.force_reraise()\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 4958, in _swap_volume\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     resize_to)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1434, in swap_volume\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self._swap_volume(guest, disk_dev, conf.source_path, resize_to)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1391, in _swap_volume\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     dev.rebase(new_path, copy=True, reuse_ext=True)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/guest.py\", line 546, in rebase\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self._disk, base, self.REBASE_DEFAULT_BANDWIDTH, flags=flags)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 183, in doit\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 141, in proxy_call\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     rv = execute(f, *args, **kwargs)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 122, in execute\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     six.reraise(c, e, tb)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 80, in tworker\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     rv = meth(*args, **kwargs)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 930, in blockRebase\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     if ret == -1: raise libvirtError ('virDomainBlockRebase() failed', dom=self)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher libvirtError: internal error: unable to execute QEMU command 'drive-mirror': Could not open '/dev/disk/by-id/dm-uuid-mpath-360014053aac4f90daef4d76baa773169': Permission denied\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1685185", 
    "owner": "https://api.launchpad.net/1.0/~lyarwood", 
    "id": 1685185, 
    "index": 4802, 
    "created": "2017-04-21 11:07:39.895820+00:00", 
    "title": "disconnect_volume not called when rebase failures are encountered during swap_volume", 
    "comments": [
        {
            "content": "Description\n===========\n\nAt present disconnect_volume is not called when rebase failures are encountered during swap_volume. This results in the new volume remaining connected to the compute host prior to terminate_connection then being called. This can in turn lead to left over devices remaining on the compute host for some volume backends such as LVM/iSCSI.\n\nSteps to reproduce\n==================\n\nDownstream, the easiest way to reproduce this is via https://bugzilla.redhat.com/show_bug.cgi?id=1401755 :\n\n# sudo setenforce 1\n# nova update-volume ${instance_uuid} \\\n                     ${attached_NFS_volume_id} \\\n                     ${unattached_iSCSI_volume_id}\n\nUpstream, I've been unable to get devstack to even work correctly with SELinux in enforcing mode so I've been unable to reproduce the rollback this way.\n\nExpected result\n===============\n\nNew volume disconnected from compute host.\n\nActual result\n=============\n\nNew volume remains connected to compute host.\n\nEnvironment\n===========\n1. Exact version of OpenStack you are running. See the following\n  list for all releases: http://docs.openstack.org/releases/\n\n   N/A\n\n2. Which hypervisor did you use?\n   (For example: Libvirt + KVM, Libvirt + XEN, Hyper-V, PowerKVM, ...)\n   What's the version of that?\n\n   Libvirt + KVM\n\n2. Which storage type did you use?\n   (For example: Ceph, LVM, GPFS, ...)\n   What's the version of that?\n\n   NFS + LVM/iSCSI\n\n3. Which networking type did you use?\n   (For example: nova-network, Neutron with OpenVSwitch, ...)\n\n   N/A\n\nLogs & Configs\n==============\n\nExample Newton trace :\n\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher [req-f31f6110-e880-41e8-be1a-2c41ea7fd9ce 75fbc7a6db34480091d2a53e2e20b695 62e53e5e804e49a9890928a5a4846f60 - - -] Exception during message handling: internal error: unable to execute QEMU command 'drive-mirror': Could not open '/dev/disk/by-id/dm-uuid-mpath-360014053aac4f90daef4d76baa773169': Permission denied\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 138, in _dispatch_and_reply\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     incoming.message))\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 183, in _dispatch\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 127, in _do_dispatch\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 110, in wrapped\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     payload)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self.force_reraise()\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 89, in wrapped\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 359, in decorated_function\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     LOG.warning(msg, e, instance=instance)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self.force_reraise()\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 328, in decorated_function\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 387, in decorated_function\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self.force_reraise()\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 375, in decorated_function\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5033, in swap_volume\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     resize_to)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 4980, in _swap_volume\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self.volume_api.unreserve_volume(context, new_volume_id)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self.force_reraise()\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 4958, in _swap_volume\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     resize_to)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1434, in swap_volume\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self._swap_volume(guest, disk_dev, conf.source_path, resize_to)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1391, in _swap_volume\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     dev.rebase(new_path, copy=True, reuse_ext=True)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/guest.py\", line 546, in rebase\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     self._disk, base, self.REBASE_DEFAULT_BANDWIDTH, flags=flags)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 183, in doit\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 141, in proxy_call\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     rv = execute(f, *args, **kwargs)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 122, in execute\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     six.reraise(c, e, tb)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 80, in tworker\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     rv = meth(*args, **kwargs)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 930, in blockRebase\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher     if ret == -1: raise libvirtError ('virDomainBlockRebase() failed', dom=self)\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher libvirtError: internal error: unable to execute QEMU command 'drive-mirror': Could not open '/dev/disk/by-id/dm-uuid-mpath-360014053aac4f90daef4d76baa773169': Permission denied\n2017-04-12 09:37:53.744 3077 ERROR oslo_messaging.rpc.dispatcher", 
            "date_created": "2017-04-21 11:07:39.895820+00:00", 
            "author": "https://api.launchpad.net/1.0/~lyarwood"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/458807", 
            "date_created": "2017-04-21 11:11:58.153418+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/458807\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=809065485c19fd535db6740bb21b867c41c008fe\nSubmitter: Jenkins\nBranch:    master\n\ncommit 809065485c19fd535db6740bb21b867c41c008fe\nAuthor: Lee Yarwood <email address hidden>\nDate:   Thu Apr 20 19:43:32 2017 +0100\n\n    libvirt: Always disconnect_volume after rebase failures\n    \n    Previously failures when rebasing onto a new volume would leave the\n    volume connected to the compute host. For some volume backends such as\n    iSCSI the subsequent call to terminate_connection would then result in\n    leftover devices remaining on the host.\n    \n    This change simply catches any error associated with the rebase and\n    ensures that disconnect_volume is called for the new volume prior to\n    terminate_connection finally being called.\n    \n    Change-Id: I5997000a0ba6341c4987405cdc0760c3b471bd59\n    Closes-bug: #1685185\n", 
            "date_created": "2017-04-26 11:39:53.080909+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/ocata\nReview: https://review.openstack.org/460296", 
            "date_created": "2017-04-26 20:26:08.233235+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/newton\nReview: https://review.openstack.org/460482", 
            "date_created": "2017-04-27 10:01:09.518978+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/460296\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=fbcf8d673342570a1518dbf8d88f289c2c39cd30\nSubmitter: Jenkins\nBranch:    stable/ocata\n\ncommit fbcf8d673342570a1518dbf8d88f289c2c39cd30\nAuthor: Lee Yarwood <email address hidden>\nDate:   Thu Apr 20 19:43:32 2017 +0100\n\n    libvirt: Always disconnect_volume after rebase failures\n    \n    Previously failures when rebasing onto a new volume would leave the\n    volume connected to the compute host. For some volume backends such as\n    iSCSI the subsequent call to terminate_connection would then result in\n    leftover devices remaining on the host.\n    \n    This change simply catches any error associated with the rebase and\n    ensures that disconnect_volume is called for the new volume prior to\n    terminate_connection finally being called.\n    \n    NOTE(lyarwood): Conflict caused by MIN_LIBVIRT_VERSION being 1.2.1 in\n    stable/ocata making I81c32bbea0f04ca876f2078ef2ae0e1975473584\n    unsuitable. The is_job_complete polling loop removed by that change in\n    master is now moved into the try block of this change ensuring we catch\n    any errors that might be thrown while waiting for the async pivot. The\n    log.exception message also requires translation in Ocata.\n    \n    Conflicts:\n            nova/virt/libvirt/driver.py\n    \n    Change-Id: I5997000a0ba6341c4987405cdc0760c3b471bd59\n    Closes-bug: #1685185\n    (cherry picked from commit 809065485c19fd535db6740bb21b867c41c008fe)\n", 
            "date_created": "2017-06-06 22:13:05.716355+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 16.0.0.0b2 development milestone.", 
            "date_created": "2017-06-08 21:53:01.151848+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 15.0.6 release.", 
            "date_created": "2017-06-19 12:46:04.290624+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/460482\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=8fb411c9b2af9bb5fef3cc272517c54bab821cd4\nSubmitter: Jenkins\nBranch:    stable/newton\n\ncommit 8fb411c9b2af9bb5fef3cc272517c54bab821cd4\nAuthor: Lee Yarwood <email address hidden>\nDate:   Thu Apr 20 19:43:32 2017 +0100\n\n    libvirt: Always disconnect_volume after rebase failures\n    \n    Previously failures when rebasing onto a new volume would leave the\n    volume connected to the compute host. For some volume backends such as\n    iSCSI the subsequent call to terminate_connection would then result in\n    leftover devices remaining on the host.\n    \n    This change simply catches any error associated with the rebase and\n    ensures that disconnect_volume is called for the new volume prior to\n    terminate_connection finally being called.\n    \n    NOTE(lyarwood): Conflict caused by MIN_LIBVIRT_VERSION being 1.2.1 in\n    stable/ocata making I81c32bbea0f04ca876f2078ef2ae0e1975473584\n    unsuitable. The is_job_complete polling loop removed by that change in\n    master is now moved into the try block of this change ensuring we catch\n    any errors that might be thrown while waiting for the async pivot. The\n    log.exception message also requires translation in Ocata.\n    \n    Conflicts:\n            nova/virt/libvirt/driver.py\n    \n    Change-Id: I5997000a0ba6341c4987405cdc0760c3b471bd59\n    Closes-bug: #1685185\n    (cherry picked from commit 809065485c19fd535db6740bb21b867c41c008fe)\n    (cherry picked from commit fbcf8d673342570a1518dbf8d88f289c2c39cd30)\n", 
            "date_created": "2017-08-22 00:08:34.910487+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.8 release.", 
            "date_created": "2017-08-28 09:55:05.280395+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}