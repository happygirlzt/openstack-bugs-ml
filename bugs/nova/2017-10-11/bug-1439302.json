{
    "status": "Fix Released", 
    "last_updated": "2015-11-19 21:50:56.234504+00:00", 
    "description": "Seeing this quite a bit in normal gate runs:\n\nhttp://logs.openstack.org/53/169753/2/check/check-tempest-dsvm-full-ceph/07dcae0/logs/screen-n-cpu.txt.gz?level=TRACE#_2015-04-01_14_34_37_110\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiRml4ZWRJcE5vdEZvdW5kRm9yQWRkcmVzczogRml4ZWQgaXAgbm90IGZvdW5kIGZvciBhZGRyZXNzIE5vbmUuXCIgQU5EIHRhZ3M6XCJzY3JlZW4tbi1jcHUudHh0XCIgQU5EIHRhZ3M6XCJtdWx0aWxpbmVcIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQyNzkwMjQ0NTg4OSwibW9kZSI6IiIsImFuYWx5emVfZmllbGQiOiIifQ==\n\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] FixedIpNotFoundForAddress: Fixed ip not found for address None.\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] Traceback (most recent call last):\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     executor_callback))\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     executor_callback)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     result = func(ctxt, **new_args)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/opt/stack/new/nova/nova/network/floating_ips.py\", line 186, in deallocate_for_instance\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     super(FloatingIP, self).deallocate_for_instance(context, **kwargs)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/opt/stack/new/nova/nova/network/manager.py\", line 558, in deallocate_for_instance\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     instance=instance)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/opt/stack/new/nova/nova/network/manager.py\", line 214, in deallocate_fixed_ip\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     context, address, expected_attrs=['network'])\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/opt/stack/new/nova/nova/objects/base.py\", line 161, in wrapper\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     args, kwargs)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/opt/stack/new/nova/nova/conductor/rpcapi.py\", line 329, in object_class_action\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     objver=objver, args=args, kwargs=kwargs)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/client.py\", line 156, in call\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     retry=self.retry)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/transport.py\", line 90, in _send\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     timeout=timeout, retry=retry)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 350, in send\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     retry=retry)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 341, in _send\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     raise result\n\nIn nova.compute.manager._do_build_and_run_instance we're hitting an UnexpectedDeletingTaskStateError exception:\n\nhttp://logs.openstack.org/53/169753/2/check/check-tempest-dsvm-full-ceph/07dcae0/logs/screen-n-cpu.txt.gz#_2015-04-01_14_34_36_898\n\nThen we start tearing down here:\n\nhttp://logs.openstack.org/53/169753/2/check/check-tempest-dsvm-full-ceph/07dcae0/logs/screen-n-cpu.txt.gz#_2015-04-01_14_34_36_905\n\nAnd for some reason there are no fixed_ips with no address once we try to deallocate in the network manager.", 
    "tags": [
        "compute", 
        "in-stable-juno", 
        "juno-backport-potential", 
        "network"
    ], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1439302", 
    "owner": "https://api.launchpad.net/1.0/~mriedem", 
    "id": 1439302, 
    "index": 1712, 
    "created": "2015-04-01 16:20:58.666650+00:00", 
    "title": "'FixedIpNotFoundForAddress: Fixed ip not found for address None.' traces in gate runs", 
    "comments": [
        {
            "content": "Seeing this quite a bit in normal gate runs:\n\nhttp://logs.openstack.org/53/169753/2/check/check-tempest-dsvm-full-ceph/07dcae0/logs/screen-n-cpu.txt.gz?level=TRACE#_2015-04-01_14_34_37_110\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiRml4ZWRJcE5vdEZvdW5kRm9yQWRkcmVzczogRml4ZWQgaXAgbm90IGZvdW5kIGZvciBhZGRyZXNzIE5vbmUuXCIgQU5EIHRhZ3M6XCJzY3JlZW4tbi1jcHUudHh0XCIgQU5EIHRhZ3M6XCJtdWx0aWxpbmVcIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQyNzkwMjQ0NTg4OSwibW9kZSI6IiIsImFuYWx5emVfZmllbGQiOiIifQ==\n\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] FixedIpNotFoundForAddress: Fixed ip not found for address None.\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] Traceback (most recent call last):\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     executor_callback))\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     executor_callback)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     result = func(ctxt, **new_args)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/opt/stack/new/nova/nova/network/floating_ips.py\", line 186, in deallocate_for_instance\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     super(FloatingIP, self).deallocate_for_instance(context, **kwargs)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/opt/stack/new/nova/nova/network/manager.py\", line 558, in deallocate_for_instance\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     instance=instance)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/opt/stack/new/nova/nova/network/manager.py\", line 214, in deallocate_fixed_ip\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     context, address, expected_attrs=['network'])\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/opt/stack/new/nova/nova/objects/base.py\", line 161, in wrapper\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     args, kwargs)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/opt/stack/new/nova/nova/conductor/rpcapi.py\", line 329, in object_class_action\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     objver=objver, args=args, kwargs=kwargs)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/client.py\", line 156, in call\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     retry=self.retry)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/transport.py\", line 90, in _send\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     timeout=timeout, retry=retry)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 350, in send\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     retry=retry)\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d] \n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 341, in _send\n2015-04-01 14:34:37.110 674 TRACE nova.compute.manager [instance: 2fc5caf4-8ff7-45bc-940f-c13d696a1d9d]     raise result\n\n\nIn nova.compute.manager._build_and_run_instance we're hitting an UnexpectedDeletingTaskStateError exception:\n\nhttp://logs.openstack.org/53/169753/2/check/check-tempest-dsvm-full-ceph/07dcae0/logs/screen-n-cpu.txt.gz#_2015-04-01_14_34_36_898\n\nThen we start tearing down here:\n\nhttp://logs.openstack.org/53/169753/2/check/check-tempest-dsvm-full-ceph/07dcae0/logs/screen-n-cpu.txt.gz#_2015-04-01_14_34_36_905\n\nAnd for some reason there are no fixed_ips with no address once we try to deallocate in the network manager.", 
            "date_created": "2015-04-01 16:20:58.666650+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Also seeing it on InstanceNotFound:\n\nhttp://logs.openstack.org/70/167370/6/check/check-tempest-dsvm-full/9924145/logs/screen-n-cpu.txt.gz#_2015-04-01_15_45_19_884", 
            "date_created": "2015-04-01 16:26:02.069086+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "I'm adding some debug logging in the deallocate_for_instance nova-network flow.  I'm thinking this has to be happening from the requested_networks list of tuples that's passed in, otherwise the network manager would try to get the fixed IPs by the instance UUID from the DB and that would fail since nova.objects.FixedIP.address is a non-nullable field.", 
            "date_created": "2015-04-01 17:06:39.588701+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "This also appears to have started around 3/26 and I'm not seeing it on stable/juno.", 
            "date_created": "2015-04-01 17:07:25.903345+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "I'm not seeing much changing in nova compute manager or nova-network around 3/26.  This is a possibly related change in tempest on 3/26 related to networks:\n\nhttps://github.com/openstack/tempest/commit/9ce97dfa353e3659aa0ec0a7f62ed3a7e54c4bdf", 
            "date_created": "2015-04-01 17:11:16.633840+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "This is the error in the n-net logs:\n\nhttp://logs.openstack.org/70/167370/6/check/check-tempest-dsvm-full/9924145/logs/screen-n-net.txt.gz#_2015-04-01_15_45_20_254", 
            "date_created": "2015-04-01 17:16:29.361748+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "We can see in the server create API that the fixed_ip address is optional:\n\nhttps://github.com/openstack/nova/blob/2015.1.0b3/nova/api/openstack/compute/servers.py#L316\n\nSo with the change in tempest, we're being asked for a specific network now but not a fixed_ip, and when we teardown during build there is no fixed_ip in the request so we trace.", 
            "date_created": "2015-04-01 17:33:08.834646+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Bingo, this is the request to create the instance in tempest:\n\nhttp://logs.openstack.org/70/167370/6/check/check-tempest-dsvm-full/9924145/logs/tempest.txt.gz#_2015-04-01_15_45_17_878\n\nNote the network uuid is specified but the fixed_ip address is not:\n\nBody: {\"server\": {\"imageRef\": \"328dba0f-f13b-47eb-bfce-6e3f6ab07eaa\", \"return_reservation_id\": true, \"flavorRef\": \"42\", \"name\": \"multiple-create-test-971632462\", \"min_count\": 1, \"networks\": [{\"uuid\": \"cf357903-a60c-4b1c-8524-a0aaa4bb2fe7\"}], \"max_count\": 2}}", 
            "date_created": "2015-04-01 17:51:30.557398+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/169868", 
            "date_created": "2015-04-01 18:24:04.494960+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This is also in stable/juno because of this commit:\n\nhttps://github.com/openstack/nova/commit/03d34c975586788dc25249b5e0b962fc0634008c", 
            "date_created": "2015-04-01 18:28:03.929693+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/169868\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=b42abdbced685e642f08b4ad48e9e64252f85f77\nSubmitter: Jenkins\nBranch:    master\n\ncommit b42abdbced685e642f08b4ad48e9e64252f85f77\nAuthor: Matt Riedemann <email address hidden>\nDate:   Wed Apr 1 11:21:50 2015 -0700\n\n    Filter fixed IPs from requested_networks in deallocate_for_instance\n    \n    With nova-network, the fixed IP address is optional on the server create\n    request.\n    \n    Tempest commit 9ce97dfa353e3659aa0ec0a7f62ed3a7e54c4bdf merged on 3/26\n    and we started seeing \"FixedIpNotFoundForAddress: Fixed ip not found for\n    address None.\" in successful gate runs because with the Tempest change\n    the network uuid is passed in (if available) on the boot request but\n    there is no address provided, e.g.:\n    \n    Body: {\"server\": {\"imageRef\": \"328dba0f-f13b-47eb-bfce-6e3f6ab07eaa\",\n    \"return_reservation_id\": true, \"flavorRef\": \"42\", \"name\":\n    \"multiple-create-test-971632462\", \"min_count\": 1, \"networks\": [{\"uuid\":\n    \"cf357903-a60c-4b1c-8524-a0aaa4bb2fe7\"}], \"max_count\": 2}}\n    \n    When deleting an instance before it's completely built, we try to\n    deallocate the network and that failed since deallocate_for_instance\n    wasn't filtering out None addresses from requested_networks.\n    \n    This fixes the problem by simply filtering the list of fixed IPs from\n    requested_networks before trying to deallocate the fixed IPs.\n    \n    Closes-Bug: #1439302\n    \n    Change-Id: I459a98151406a0b125a65b00fa0186eb5df97b1c\n", 
            "date_created": "2015-04-01 22:25:58.885567+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/juno\nReview: https://review.openstack.org/170295", 
            "date_created": "2015-04-02 21:36:42.604531+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/170295\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=141bfd95294ebce8145d8a5719b3f7c9f47b7ce5\nSubmitter: Jenkins\nBranch:    stable/juno\n\ncommit 141bfd95294ebce8145d8a5719b3f7c9f47b7ce5\nAuthor: Matt Riedemann <email address hidden>\nDate:   Wed Apr 1 11:21:50 2015 -0700\n\n    Filter fixed IPs from requested_networks in deallocate_for_instance\n    \n    With nova-network, the fixed IP address is optional on the server create\n    request.\n    \n    Tempest commit 9ce97dfa353e3659aa0ec0a7f62ed3a7e54c4bdf merged on 3/26\n    and we started seeing \"FixedIpNotFoundForAddress: Fixed ip not found for\n    address None.\" in successful gate runs because with the Tempest change\n    the network uuid is passed in (if available) on the boot request but\n    there is no address provided, e.g.:\n    \n    Body: {\"server\": {\"imageRef\": \"328dba0f-f13b-47eb-bfce-6e3f6ab07eaa\",\n    \"return_reservation_id\": true, \"flavorRef\": \"42\", \"name\":\n    \"multiple-create-test-971632462\", \"min_count\": 1, \"networks\": [{\"uuid\":\n    \"cf357903-a60c-4b1c-8524-a0aaa4bb2fe7\"}], \"max_count\": 2}}\n    \n    When deleting an instance before it's completely built, we try to\n    deallocate the network and that failed since deallocate_for_instance\n    wasn't filtering out None addresses from requested_networks.\n    \n    This fixes the problem by simply filtering the list of fixed IPs from\n    requested_networks before trying to deallocate the fixed IPs.\n    \n    Conflicts:\n            nova/tests/unit/network/test_manager.py\n    \n    NOTE(mriedem): The conflict was just on the test module being moved\n    in Kilo.\n    \n    Closes-Bug: #1439302\n    \n    Change-Id: I459a98151406a0b125a65b00fa0186eb5df97b1c\n    (cherry picked from commit b42abdbced685e642f08b4ad48e9e64252f85f77)\n", 
            "date_created": "2015-04-21 01:26:45.469231+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}