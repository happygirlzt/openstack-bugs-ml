{
    "status": "Fix Released", 
    "last_updated": "2012-04-05 10:08:16.501742+00:00", 
    "description": "If I try something like\n\nnova volume-attach de5410d9-c0c8-4489-9948-841feaa4fb55 20 /dev/xvde\n\nThe following traceback shows up:\n\n2012-02-28 14:19:05 AUDIT nova.compute.manager [req-6fe7a27f-08d2-44a7-a5a1-aa4d65a9efe2 0747b73bf9404bfaae6c810837241d8e 12345] [instance: de5410d9-c0c8-448\n9-9948-841feaa4fb55] Attaching volume 20 to /dev/xvde\n2012-02-28 14:19:05 DEBUG nova.rpc.common [-] Making asynchronous call on volume.z2-api1 ... from (pid=10989) multicall /usr/lib/python2.6/dist-packages/nova\n/rpc/amqp.py:318\n2012-02-28 14:19:05 DEBUG nova.rpc.common [-] MSG_ID is ef3894da50e740bf830614b3f4e1000c from (pid=10989) multicall /usr/lib/python2.6/dist-packages/nova/rpc\n/amqp.py:321\n2012-02-28 14:19:05 DEBUG nova.virt.xenapi.volumeops [-] Attach_volume: {u'driver_volume_type': u'iscsi', u'data': {u'target_portal': u'10.190.254.22:3260', \nu'target_iqn': u'iqn.2010-11.com.rackspace:volume-00000014', u'target_discovered': False, u'volume_id': 20}}, instance-00000016, /dev/xvde from (pid=10989) a\nttach_volume /usr/lib/python2.6/dist-packages/nova/virt/xenapi/volumeops.py:123\n2012-02-28 14:19:05 DEBUG nova.virt.xenapi.volumeops [-] {u'driver_volume_type': u'iscsi', u'data': {u'target_portal': u'10.190.254.22:3260', u'target_iqn': \nu'iqn.2010-11.com.rackspace:volume-00000014', u'target_discovered': False, u'volume_id': 20}} from (pid=10989) attach_volume /usr/lib/python2.6/dist-packages\n/nova/virt/xenapi/volumeops.py:140\n2012-02-28 14:19:05 WARNING nova.virt.xenapi.volume_utils [-] Mountpoint cannot be translated: xvde\n2012-02-28 14:19:05 DEBUG nova.virt.xenapi.volume_utils [-] (vol_id,number,host,port,iqn): (20,10.190.254.22,3260,iqn.2010-11.com.rackspace:volume-00000014) \nfrom (pid=10989) parse_volume_info /usr/lib/python2.6/dist-packages/nova/virt/xenapi/volume_utils.py:334\n2012-02-28 14:19:05 ERROR nova.compute.manager [req-6fe7a27f-08d2-44a7-a5a1-aa4d65a9efe2 0747b73bf9404bfaae6c810837241d8e 12345] [instance: de5410d9-c0c8-448\n9-9948-841feaa4fb55] Attach failed /dev/xvde, removing\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/dist-packages/nova/compute/manager.py\", line 1660, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/dist-packages/nova/virt/xenapi_conn.py\", line 371, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/dist-packages/nova/virt/xenapi/volumeops.py\", line 144, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/dist-packages/nova/virt/xenapi/volume_utils.py\", line 340, in parse_volume_info\n(nova.compute.manager): TRACE:     ' %(data)s, %(mountpoint)s') % locals())\n(nova.compute.manager): TRACE: StorageError: Unable to obtain target information {u'target_portal': u'10.190.254.22:3260', u'target_iqn': u'iqn.2010-11.com.r\nackspace:volume-00000014', u'target_discovered': False, u'volume_id': 20}, /dev/xvde\n(nova.compute.manager): TRACE: \n2012-02-28 14:19:05 DEBUG nova.rpc.common [-] Making asynchronous call on volume.z2-api1 ... from (pid=10989) multicall /usr/lib/python2.6/dist-packages/nova\n/rpc/amqp.py:318\n2012-02-28 14:19:05 DEBUG nova.rpc.common [-] MSG_ID is 953b08b88c5842f2bf3e075318344188 from (pid=10989) multicall /usr/lib/python2.6/dist-packages/nova/rpc\n/amqp.py:321\n\nand the volume doesn't get properly attached.\n\nIf I instead run: nova volume-attach de5410d9-c0c8-4489-9948-841feaa4fb55 20 /dev/vde\n\nThe operation completes and mounts as /dev/xvde in the vm", 
    "tags": [], 
    "importance": "Critical", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/942880", 
    "owner": "https://api.launchpad.net/1.0/~bcwaldon", 
    "id": 942880, 
    "index": 51, 
    "created": "2012-02-28 20:43:09.039271+00:00", 
    "title": "Problem specifying device when attaching volumes on XEN", 
    "comments": [
        {
            "content": "If I try something like\n\nnova volume-attach de5410d9-c0c8-4489-9948-841feaa4fb55 20 /dev/xvde\n\nThe following traceback shows up:\n\n2012-02-28 14:19:05 AUDIT nova.compute.manager [req-6fe7a27f-08d2-44a7-a5a1-aa4d65a9efe2 0747b73bf9404bfaae6c810837241d8e 12345] [instance: de5410d9-c0c8-448\n9-9948-841feaa4fb55] Attaching volume 20 to /dev/xvde\n2012-02-28 14:19:05 DEBUG nova.rpc.common [-] Making asynchronous call on volume.z2-api1 ... from (pid=10989) multicall /usr/lib/python2.6/dist-packages/nova\n/rpc/amqp.py:318\n2012-02-28 14:19:05 DEBUG nova.rpc.common [-] MSG_ID is ef3894da50e740bf830614b3f4e1000c from (pid=10989) multicall /usr/lib/python2.6/dist-packages/nova/rpc\n/amqp.py:321\n2012-02-28 14:19:05 DEBUG nova.virt.xenapi.volumeops [-] Attach_volume: {u'driver_volume_type': u'iscsi', u'data': {u'target_portal': u'10.190.254.22:3260', \nu'target_iqn': u'iqn.2010-11.com.rackspace:volume-00000014', u'target_discovered': False, u'volume_id': 20}}, instance-00000016, /dev/xvde from (pid=10989) a\nttach_volume /usr/lib/python2.6/dist-packages/nova/virt/xenapi/volumeops.py:123\n2012-02-28 14:19:05 DEBUG nova.virt.xenapi.volumeops [-] {u'driver_volume_type': u'iscsi', u'data': {u'target_portal': u'10.190.254.22:3260', u'target_iqn': \nu'iqn.2010-11.com.rackspace:volume-00000014', u'target_discovered': False, u'volume_id': 20}} from (pid=10989) attach_volume /usr/lib/python2.6/dist-packages\n/nova/virt/xenapi/volumeops.py:140\n2012-02-28 14:19:05 WARNING nova.virt.xenapi.volume_utils [-] Mountpoint cannot be translated: xvde\n2012-02-28 14:19:05 DEBUG nova.virt.xenapi.volume_utils [-] (vol_id,number,host,port,iqn): (20,10.190.254.22,3260,iqn.2010-11.com.rackspace:volume-00000014) \nfrom (pid=10989) parse_volume_info /usr/lib/python2.6/dist-packages/nova/virt/xenapi/volume_utils.py:334\n2012-02-28 14:19:05 ERROR nova.compute.manager [req-6fe7a27f-08d2-44a7-a5a1-aa4d65a9efe2 0747b73bf9404bfaae6c810837241d8e 12345] [instance: de5410d9-c0c8-448\n9-9948-841feaa4fb55] Attach failed /dev/xvde, removing\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/dist-packages/nova/compute/manager.py\", line 1660, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/dist-packages/nova/virt/xenapi_conn.py\", line 371, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/dist-packages/nova/virt/xenapi/volumeops.py\", line 144, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/dist-packages/nova/virt/xenapi/volume_utils.py\", line 340, in parse_volume_info\n(nova.compute.manager): TRACE:     ' %(data)s, %(mountpoint)s') % locals())\n(nova.compute.manager): TRACE: StorageError: Unable to obtain target information {u'target_portal': u'10.190.254.22:3260', u'target_iqn': u'iqn.2010-11.com.r\nackspace:volume-00000014', u'target_discovered': False, u'volume_id': 20}, /dev/xvde\n(nova.compute.manager): TRACE: \n2012-02-28 14:19:05 DEBUG nova.rpc.common [-] Making asynchronous call on volume.z2-api1 ... from (pid=10989) multicall /usr/lib/python2.6/dist-packages/nova\n/rpc/amqp.py:318\n2012-02-28 14:19:05 DEBUG nova.rpc.common [-] MSG_ID is 953b08b88c5842f2bf3e075318344188 from (pid=10989) multicall /usr/lib/python2.6/dist-packages/nova/rpc\n/amqp.py:321\n\nand the volume doesn't get properly attached.\n\nIf I instead run: nova volume-attach de5410d9-c0c8-4489-9948-841feaa4fb55 20 /dev/vde\n\nThe operation completes and mounts as /dev/xvde in the vm", 
            "date_created": "2012-02-28 20:43:09.039271+00:00", 
            "author": "https://api.launchpad.net/1.0/~cthier"
        }, 
        {
            "content": "looks like the translation doesn't support xv...\n\nnova/virt/xenapi/volume_utils.py\n\n353     @classmethod\n354     def mountpoint_to_number(cls, mountpoint):\n355         \"\"\"Translate a mountpoint like /dev/sdc into a numeric\"\"\"\n356         if mountpoint.startswith('/dev/'):\n357             mountpoint = mountpoint[5:]\n358         if re.match('^[hs]d[a-p]$', mountpoint):\n359             return (ord(mountpoint[2:3]) - ord('a'))\n360         elif re.match('^vd[a-p]$', mountpoint):\n361             return (ord(mountpoint[2:3]) - ord('a'))\n362         elif re.match('^[0-9]+$', mountpoint):\n363             return string.atoi(mountpoint, 10)\n364         else:\n365             LOG.warn(_('Mountpoint cannot be translated: %s'), mountpoint)\n366             return -1", 
            "date_created": "2012-02-28 21:09:44.927592+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "For Vish to reassign", 
            "date_created": "2012-02-28 21:43:05.970537+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/4657", 
            "date_created": "2012-02-29 00:26:31.209718+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/4657\nCommitted: http://github.com/openstack/nova/commit/2fa6e23e9cefb8e45bd5a6cec36b1ac6b7ac65c3\nSubmitter: Jenkins\nBranch:    master\n\ncommit 2fa6e23e9cefb8e45bd5a6cec36b1ac6b7ac65c3\nAuthor: Brian Waldon <email address hidden>\nDate:   Tue Feb 28 16:18:53 2012 -0800\n\n    Allow xvd* to be supplied for volume in xenapi\n    \n    * Fixes bug 942880\n    \n    Change-Id: I7d0817051b837e3ba17f4edd8c47fd2c730c9822\n", 
            "date_created": "2012-02-29 01:05:44.049584+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}