{
    "status": "Opinion", 
    "last_updated": "2017-06-14 12:29:51.833380+00:00", 
    "description": "In REST client implementation is common good practice, when:\n- request causes an synchronous and asynchronous effect , and\n- the synchronous operation has any immediately visible effect ie. immediate subsequent request showing any change,\nwe should emphasize the synchronous behavior in the responses (Status code)  (Or responding in way which does not distinguish the two cases).\n\nHowever if the HTTP method is DELETE, the rule is the opposite! \nIf the resource on the request URL does not deleted the service MUST NOT response with 204.\n\n\"\n   A successful response SHOULD be 200 (OK) if the response includes an\n   entity describing the status, 202 (Accepted) if the action has not\n   yet been enacted, or 204 (No Content) if the action has been enacted\n   but the response does not include an entity.\n\" by RFC2616 section 9.7\n\nIt means if a DELETE request responded with 204 status code, I MUST get 404 in an immediate subsequent request, unless concurrent operation recreated the resource.\n\n\n$ nova --debug delete ab0ebda6-2c21-4258-8934-1005b970fee5 ; nova --debug show ab0ebda6-2c21-4258-8934-1005b970fee5\n\nPart of the output in the received order:\n-----------------------------------------\nREQ: curl -i http://10.34.69.149:8774/v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5 -X DELETE -H \"X-Auth-Project-Id: admin\" -H \"User-Agent: python-novaclient\" -H \"Accept: application/json\" -H \"X-Auth-Token: c35f5783528d4131bf100604b2fabd6c\"\n\nsend: u'DELETE /v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5 HTTP/1.1\\r\\nHost: 10.34.69.149:8774\\r\\nx-auth-project-id: admin\\r\\nx-auth-token: c35f5783528d4131bf100604b2fabd6c\\r\\naccept-encoding: gzip, deflate\\r\\naccept: application/json\\r\\nuser-agent: python-novaclient\\r\\n\\r\\n'\nreply: 'HTTP/1.1 204 No Content\\r\\n'\nheader: Content-Length: 0\nheader: X-Compute-Request-Id: req-53e3503a-8d73-4ffc-ba43-4bd5659a9e22\nheader: Content-Type: application/json\nheader: Date: Sat, 02 Mar 2013 18:26:21 GMT\nRESP:{'date': 'Sat, 02 Mar 2013 18:26:21 GMT', 'status': '204', 'content-length': '0', 'content-type': 'application/json', 'x-compute-request-id': 'req-53e3503a-8d73-4ffc-ba43-4bd5659a9e22'} \n-----------------------------------------------------\nREQ: curl -i http://10.34.69.149:8774/v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5 -X GET -H \"X-Auth-Project-Id: admin\" -H \"User-Agent: python-novaclient\" -H \"Accept: application/json\" -H \"X-Auth-Token: f74d6c7226c14915a26a81b540d43f3b\"\n\nconnect: (10.34.69.149, 8774)\nsend: u'GET /v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5 HTTP/1.1\\r\\nHost: 10.34.69.149:8774\\r\\nx-auth-project-id: admin\\r\\nx-auth-token: f74d6c7226c14915a26a81b540d43f3b\\r\\naccept-encoding: gzip, deflate\\r\\naccept: application/json\\r\\nuser-agent: python-novaclient\\r\\n\\r\\n'\nreply: 'HTTP/1.1 200 OK\\r\\n'\nheader: X-Compute-Request-Id: req-80c97c68-0b44-4650-b027-84a85ee04b86\nheader: Content-Type: application/json\nheader: Content-Length: 1502\nheader: Date: Sat, 02 Mar 2013 18:26:21 GMT\nRESP:{'status': '200', 'content-length': '1502', 'content-location': u'http://10.34.69.149:8774/v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5', 'x-compute-request-id': 'req-80c97c68-0b44-4650-b027-84a85ee04b86', 'date': 'Sat, 02 Mar 2013 18:26:21 GMT', 'content-type': 'application/json'} {\"server\": {\"status\": \"ACTIVE\", \"updated\": \"2013-03-02T18:26:21Z\", \"hostId\": \"31bdffcdffd5b869b87c9be3cdd700e29c4a08286d6d306622b4815a\", \"OS-EXT-SRV-ATTR:host\": \"new32.lithium.rhev.lab.eng.brq.redhat.com\", \"addresses\": {\"novanetwork\": [{\"version\": 4, \"addr\": \"192.168.32.2\"}]}, \"links\": [{\"href\": \"http://10.34.69.149:8774/v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5\", \"rel\": \"self\"}, {\"href\": \"http://10.34.69.149:8774/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5\", \"rel\": \"bookmark\"}], \"key_name\": null, \"image\": {\"id\": \"12e9c131-aaf4-4f73-9659-ed2da9759cd2\", \"links\": [{\"href\": \"http://10.34.69.149:8774/89a38fe6d3194864995ab0872905a65e/images/12e9c131-aaf4-4f73-9659-ed2da9759cd2\", \"rel\": \"bookmark\"}]}, \"OS-EXT-STS:task_state\": \"deleting\", \"OS-EXT-STS:vm_state\": \"active\", \"OS-EXT-SRV-ATTR:instance_name\": \"instance-00000003\", \"OS-EXT-SRV-ATTR:hypervisor_hostname\": \"new32.lithium.rhev.lab.eng.brq.redhat.com\", \"flavor\": {\"id\": \"1\", \"links\": [{\"href\": \"http://10.34.69.149:8774/89a38fe6d3194864995ab0872905a65e/flavors/1\", \"rel\": \"bookmark\"}]}, \"id\": \"ab0ebda6-2c21-4258-8934-1005b970fee5\", \"security_groups\": [{\"name\": \"default\"}], \"user_id\": \"1d2b871844434bbc99845ed11c3f897b\", \"name\": \"test\", \"created\": \"2013-03-02T17:19:44Z\", \"tenant_id\": \"89a38fe6d3194864995ab0872905a65e\", \"OS-DCF:diskConfig\": \"MANUAL\", \"accessIPv4\": \"\", \"accessIPv6\": \"\", \"progress\": 0, \"OS-EXT-STS:power_state\": 1, \"config_drive\": \"\", \"metadata\": {}}}\n---------------------------------------------------", 
    "tags": [
        "api"
    ], 
    "importance": "Low", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1152623", 
    "owner": "https://api.launchpad.net/1.0/~gstepanov", 
    "id": 1152623, 
    "index": 5698, 
    "created": "2013-03-08 14:11:32.646177+00:00", 
    "title": "RFC2616 section 9.7 status code vs. nova server delete", 
    "comments": [
        {
            "content": "In REST client implementation is common good practice, when:\n- request causes an synchronous and asynchronous effect , and\n- the synchronous operation has any immediately visible effect ie. immediate subsequent request showing any change,\nwe should emphasize the synchronous behavior in the responses (Status code)  (Or responding in way which does not distinguish the two cases).\n\nHowever if the HTTP method is DELETE, the rule is the opposite! \nIf the resource on the request URL does not deleted the service MUST NOT response with 204.\n\n\"\n   A successful response SHOULD be 200 (OK) if the response includes an\n   entity describing the status, 202 (Accepted) if the action has not\n   yet been enacted, or 204 (No Content) if the action has been enacted\n   but the response does not include an entity.\n\" by RFC2616 section 9.7\n\nIt means if a DELETE request responded with 204 status code, I MUST get 404 in an immediate subsequent request, unless concurrent operation recreated the resource.\n\n\n$ nova --debug delete ab0ebda6-2c21-4258-8934-1005b970fee5 ; nova --debug show ab0ebda6-2c21-4258-8934-1005b970fee5\n\nPart of the output in the received order:\n-----------------------------------------\nREQ: curl -i http://10.34.69.149:8774/v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5 -X DELETE -H \"X-Auth-Project-Id: admin\" -H \"User-Agent: python-novaclient\" -H \"Accept: application/json\" -H \"X-Auth-Token: c35f5783528d4131bf100604b2fabd6c\"\n\nsend: u'DELETE /v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5 HTTP/1.1\\r\\nHost: 10.34.69.149:8774\\r\\nx-auth-project-id: admin\\r\\nx-auth-token: c35f5783528d4131bf100604b2fabd6c\\r\\naccept-encoding: gzip, deflate\\r\\naccept: application/json\\r\\nuser-agent: python-novaclient\\r\\n\\r\\n'\nreply: 'HTTP/1.1 204 No Content\\r\\n'\nheader: Content-Length: 0\nheader: X-Compute-Request-Id: req-53e3503a-8d73-4ffc-ba43-4bd5659a9e22\nheader: Content-Type: application/json\nheader: Date: Sat, 02 Mar 2013 18:26:21 GMT\nRESP:{'date': 'Sat, 02 Mar 2013 18:26:21 GMT', 'status': '204', 'content-length': '0', 'content-type': 'application/json', 'x-compute-request-id': 'req-53e3503a-8d73-4ffc-ba43-4bd5659a9e22'} \n-----------------------------------------------------\nREQ: curl -i http://10.34.69.149:8774/v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5 -X GET -H \"X-Auth-Project-Id: admin\" -H \"User-Agent: python-novaclient\" -H \"Accept: application/json\" -H \"X-Auth-Token: f74d6c7226c14915a26a81b540d43f3b\"\n\nconnect: (10.34.69.149, 8774)\nsend: u'GET /v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5 HTTP/1.1\\r\\nHost: 10.34.69.149:8774\\r\\nx-auth-project-id: admin\\r\\nx-auth-token: f74d6c7226c14915a26a81b540d43f3b\\r\\naccept-encoding: gzip, deflate\\r\\naccept: application/json\\r\\nuser-agent: python-novaclient\\r\\n\\r\\n'\nreply: 'HTTP/1.1 200 OK\\r\\n'\nheader: X-Compute-Request-Id: req-80c97c68-0b44-4650-b027-84a85ee04b86\nheader: Content-Type: application/json\nheader: Content-Length: 1502\nheader: Date: Sat, 02 Mar 2013 18:26:21 GMT\nRESP:{'status': '200', 'content-length': '1502', 'content-location': u'http://10.34.69.149:8774/v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5', 'x-compute-request-id': 'req-80c97c68-0b44-4650-b027-84a85ee04b86', 'date': 'Sat, 02 Mar 2013 18:26:21 GMT', 'content-type': 'application/json'} {\"server\": {\"status\": \"ACTIVE\", \"updated\": \"2013-03-02T18:26:21Z\", \"hostId\": \"31bdffcdffd5b869b87c9be3cdd700e29c4a08286d6d306622b4815a\", \"OS-EXT-SRV-ATTR:host\": \"new32.lithium.rhev.lab.eng.brq.redhat.com\", \"addresses\": {\"novanetwork\": [{\"version\": 4, \"addr\": \"192.168.32.2\"}]}, \"links\": [{\"href\": \"http://10.34.69.149:8774/v2/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5\", \"rel\": \"self\"}, {\"href\": \"http://10.34.69.149:8774/89a38fe6d3194864995ab0872905a65e/servers/ab0ebda6-2c21-4258-8934-1005b970fee5\", \"rel\": \"bookmark\"}], \"key_name\": null, \"image\": {\"id\": \"12e9c131-aaf4-4f73-9659-ed2da9759cd2\", \"links\": [{\"href\": \"http://10.34.69.149:8774/89a38fe6d3194864995ab0872905a65e/images/12e9c131-aaf4-4f73-9659-ed2da9759cd2\", \"rel\": \"bookmark\"}]}, \"OS-EXT-STS:task_state\": \"deleting\", \"OS-EXT-STS:vm_state\": \"active\", \"OS-EXT-SRV-ATTR:instance_name\": \"instance-00000003\", \"OS-EXT-SRV-ATTR:hypervisor_hostname\": \"new32.lithium.rhev.lab.eng.brq.redhat.com\", \"flavor\": {\"id\": \"1\", \"links\": [{\"href\": \"http://10.34.69.149:8774/89a38fe6d3194864995ab0872905a65e/flavors/1\", \"rel\": \"bookmark\"}]}, \"id\": \"ab0ebda6-2c21-4258-8934-1005b970fee5\", \"security_groups\": [{\"name\": \"default\"}], \"user_id\": \"1d2b871844434bbc99845ed11c3f897b\", \"name\": \"test\", \"created\": \"2013-03-02T17:19:44Z\", \"tenant_id\": \"89a38fe6d3194864995ab0872905a65e\", \"OS-DCF:diskConfig\": \"MANUAL\", \"accessIPv4\": \"\", \"accessIPv6\": \"\", \"progress\": 0, \"OS-EXT-STS:power_state\": 1, \"config_drive\": \"\", \"metadata\": {}}}\n---------------------------------------------------", 
            "date_created": "2013-03-08 14:11:32.646177+00:00", 
            "author": "https://api.launchpad.net/1.0/~afazekas"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/52583", 
            "date_created": "2013-10-18 07:35:30.906991+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Until this is changed in nova, it's not actually appropriate to have a tempest issue", 
            "date_created": "2013-12-12 15:36:44.672562+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "I think this is something we should just push off to fixing when the tasks api comes in. It's a backwards incompatible API change regardless and we might as well fix it properly.\n", 
            "date_created": "2014-07-14 01:53:20.838604+00:00", 
            "author": "https://api.launchpad.net/1.0/~cyeoh-0"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/335564", 
            "date_created": "2016-06-29 15:32:02.877340+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Michael Still (<email address hidden>) on branch: master\nReview: https://review.openstack.org/335564\nReason: This patch has been sitting unchanged for more than 12 weeks. I am therefore going to abandon it to keep the nova review queue sane. Please feel free to restore the change if you're still working on it.", 
            "date_created": "2016-10-25 16:09:40.422541+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "It's fine that people want to change these, we're just not going to track them very effectively as bugs.", 
            "date_created": "2017-06-14 12:29:51.525708+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }
    ]
}