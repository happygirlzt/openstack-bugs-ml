{
    "status": "Fix Released", 
    "last_updated": "2014-05-21 18:17:25.793376+00:00", 
    "description": "When dynamically adding and removing ports from a VM, the changes do not cause the server timestamp to be updated.  This causes the v2/{tenant_id}/servers?changes-since={timestamp} REST API call to return an unchanged timestamp.  Thus, it appears that nothing has changed for VM, despite the fact that the network configuration has changed.\n\nWhen using nova-network changes to the networking configuration using that approach did cause the timestamp to be updated.\n\nAs users are being encouraged to move from nova-network to quantum (BluePrint https://blueprints.launchpad.net/quantum/+spec/nova-to-quantum-upgrade)  this change in functionality could be seen as a regression and could break any utilities that are expecting to see a change in the server time stamp when changes are made to the network.\n\nA similar bug to this one was addressed:  https://bugs.launchpad.net/nova/+bug/1143466\n\nThe issue is easy to recreate:\n\n[root@rhel6havana ~]# nova boot --image cirros --flavor m1.tiny TEST\n+-------------------------------------+--------------------------------------+\n| Property                            | Value                                |\n+-------------------------------------+--------------------------------------+\n| OS-EXT-STS:task_state               | scheduling                           |\n| image                               | cirros                               |\n| OS-EXT-STS:vm_state                 | building                             |\n| OS-EXT-SRV-ATTR:instance_name       | instance-00000003                    |\n| flavor                              | m1.tiny                              |\n| id                                  | e68f3c0c-4ada-44bf-ba60-c577b5c037ad |\n| security_groups                     | [{u'name': u'default'}]              |\n| user_id                             | 612de0a91a4b4fe4960f436a8715e7d6     |\n| OS-DCF:diskConfig                   | MANUAL                               |\n| accessIPv4                          |                                      |\n| accessIPv6                          |                                      |\n| progress                            | 0                                    |\n| OS-EXT-STS:power_state              | 0                                    |\n| OS-EXT-AZ:availability_zone         | nova                                 |\n| config_drive                        |                                      |\n| status                              | BUILD                                |\n| updated                             | 2013-05-23T20:37:44Z                 |\n| hostId                              |                                      |\n| OS-EXT-SRV-ATTR:host                | None                                 |\n| key_name                            | None                                 |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | None                                 |\n| name                                | TEST                                 |\n| adminPass                           | 6qarniy3q7ND                         |\n| tenant_id                           | fa123aafec8346b1a8b8cb6dd8e2dc6e     |\n| created                             | 2013-05-23T20:37:44Z                 |\n| metadata                            | {}                                   |\n+-------------------------------------+--------------------------------------+\n[root@rhel6havana ~]# nova list\n+--------------------------------------+------+--------+--------------------------------------+\n| ID                                   | Name | Status | Networks                             |\n+--------------------------------------+------+--------+--------------------------------------+\n| e68f3c0c-4ada-44bf-ba60-c577b5c037ad | TEST | ACTIVE | network2=10.0.2.2; network1=10.0.1.3 |\n+--------------------------------------+------+--------+--------------------------------------+\n[root@rhel6havana ~]# nova show TEST\n+-------------------------------------+----------------------------------------------------------+\n| Property                            | Value                                                    |\n+-------------------------------------+----------------------------------------------------------+\n| status                              | ACTIVE                                                   |\n| updated                             | 2013-05-23T20:37:50Z                                     |\n| OS-EXT-STS:task_state               | None                                                     |\n| OS-EXT-SRV-ATTR:host                | rhel6havana                                              |\n| key_name                            | None                                                     |\n| image                               | cirros (9af9ba34-8567-4a3b-86d0-965d71c293d4)            |\n| network1 network                    | 10.0.1.3                                                 |\n| hostId                              | 20821ecbc2ad05a661720cafd65fd44c697f1f2fdf29b6c47626cad9 |\n| OS-EXT-STS:vm_state                 | active                                                   |\n| OS-EXT-SRV-ATTR:instance_name       | instance-00000003                                        |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | rhel6havana.novalocal                                    |\n| flavor                              | m1.tiny (1)                                              |\n| id                                  | e68f3c0c-4ada-44bf-ba60-c577b5c037ad                     |\n| security_groups                     | [{u'name': u'default'}]                                  |\n| user_id                             | 612de0a91a4b4fe4960f436a8715e7d6                         |\n| name                                | TEST                                                     |\n| created                             | 2013-05-23T20:37:44Z                                     |\n| tenant_id                           | fa123aafec8346b1a8b8cb6dd8e2dc6e                         |\n| OS-DCF:diskConfig                   | MANUAL                                                   |\n| metadata                            | {}                                                       |\n| accessIPv4                          |                                                          |\n| accessIPv6                          |                                                          |\n| progress                            | 0                                                        |\n| OS-EXT-STS:power_state              | 1                                                        |\n| OS-EXT-AZ:availability_zone         | nova                                                     |\n| network2 network                    | 10.0.2.2                                                 |\n| config_drive                        |                                                          |\n+-------------------------------------+----------------------------------------------------------+\n[root@rhel6havana ~]# quantum port-list\nwhich: no gedit in (/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/home/db2inst1/sqllib/bin:/home/db2inst1/sqllib/adm:/home/db2inst1/sqllib/misc:/root/bin)\nwhich: no kate in (/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/home/db2inst1/sqllib/bin:/home/db2inst1/sqllib/adm:/home/db2inst1/sqllib/misc:/root/bin)\n+--------------------------------------+------+-------------------+---------------------------------------------------------------------------------+\n| id                                   | name | mac_address       | fixed_ips                                                                       |\n+--------------------------------------+------+-------------------+---------------------------------------------------------------------------------+\n| be8374e9-45ce-40df-a278-49f2a303b635 |      | fa:16:3e:27:67:2c | {\"subnet_id\": \"bd42c534-e153-485a-a174-60aa35155b60\", \"ip_address\": \"10.0.1.1\"} |\n| 28fadf80-c508-4601-b726-99f9ef576a9c |      | fa:16:3e:61:fa:d2 | {\"subnet_id\": \"bd42c534-e153-485a-a174-60aa35155b60\", \"ip_address\": \"10.0.1.2\"} |\n| b032614c-094f-4293-96a3-70af4088e559 |      | fa:16:3e:71:85:e1 | {\"subnet_id\": \"a481ff5b-1fe6-4d04-9ddf-bbc645c07924\", \"ip_address\": \"10.0.2.2\"} |\n| 6a1c3803-1b19-4181-ab8e-c5fd0994b3ac |      | fa:16:3e:cb:f4:53 | {\"subnet_id\": \"bd42c534-e153-485a-a174-60aa35155b60\", \"ip_address\": \"10.0.1.3\"} |\n+--------------------------------------+------+-------------------+---------------------------------------------------------------------------------+\n[root@rhel6havana ~]# quantum port-delete b032614c-094f-4293-96a3-70af4088e559\nwhich: no gedit in (/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/home/db2inst1/sqllib/bin:/home/db2inst1/sqllib/adm:/home/db2inst1/sqllib/misc:/root/bin)\nwhich: no kate in (/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/home/db2inst1/sqllib/bin:/home/db2inst1/sqllib/adm:/home/db2inst1/sqllib/misc:/root/bin)\nDeleted port: b032614c-094f-4293-96a3-70af4088e559\n[root@rhel6havana ~]# nova list\n+--------------------------------------+------+--------+-------------------+\n| ID                                   | Name | Status | Networks          |\n+--------------------------------------+------+--------+-------------------+\n| e68f3c0c-4ada-44bf-ba60-c577b5c037ad | TEST | ACTIVE | network1=10.0.1.3 |\n+--------------------------------------+------+--------+-------------------+\n[root@rhel6havana ~]# nova show TEST\n+-------------------------------------+----------------------------------------------------------+\n| Property                            | Value                                                    |\n+-------------------------------------+----------------------------------------------------------+\n| status                              | ACTIVE                                                   |\n| updated                             | 2013-05-23T20:37:50Z                                     |\n| OS-EXT-STS:task_state               | None                                                     |\n| OS-EXT-SRV-ATTR:host                | rhel6havana                                              |\n| key_name                            | None                                                     |\n| image                               | cirros (9af9ba34-8567-4a3b-86d0-965d71c293d4)            |\n| network1 network                    | 10.0.1.3                                                 |\n| hostId                              | 20821ecbc2ad05a661720cafd65fd44c697f1f2fdf29b6c47626cad9 |\n| OS-EXT-STS:vm_state                 | active                                                   |\n| OS-EXT-SRV-ATTR:instance_name       | instance-00000003                                        |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | rhel6havana.novalocal                                    |\n| flavor                              | m1.tiny (1)                                              |\n| id                                  | e68f3c0c-4ada-44bf-ba60-c577b5c037ad                     |\n| security_groups                     | [{u'name': u'default'}]                                  |\n| user_id                             | 612de0a91a4b4fe4960f436a8715e7d6                         |\n| name                                | TEST                                                     |\n| created                             | 2013-05-23T20:37:44Z                                     |\n| tenant_id                           | fa123aafec8346b1a8b8cb6dd8e2dc6e                         |\n| OS-DCF:diskConfig                   | MANUAL                                                   |\n| metadata                            | {}                                                       |\n| accessIPv4                          |                                                          |\n| accessIPv6                          |                                                          |\n| progress                            | 0                                                        |\n| OS-EXT-STS:power_state              | 1                                                        |\n| OS-EXT-AZ:availability_zone         | nova                                                     |\n| config_drive                        |                                                          |\n+-------------------------------------+----------------------------------------------------------+\n[root@rhel6havana ~]#", 
    "tags": [
        "network"
    ], 
    "importance": "Medium", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1183562", 
    "owner": "https://api.launchpad.net/1.0/~arosen", 
    "id": 1183562, 
    "index": 3405, 
    "created": "2013-05-23 20:44:03.507140+00:00", 
    "title": "changes-since timestamp is not updated after making network changes", 
    "comments": [
        {
            "content": "When dynamically adding and removing ports from a VM, the changes do not cause the server timestamp to be updated.  This causes the v2/{tenant_id}/servers?changes-since={timestamp} REST API call to return an unchanged timestamp.  Thus, it appears that nothing has changed for VM, despite the fact that the network configuration has changed.\n\nWhen using nova-network changes to the networking configuration using that approach did cause the timestamp to be updated.\n\nAs users are being encouraged to move from nova-network to quantum (BluePrint https://blueprints.launchpad.net/quantum/+spec/nova-to-quantum-upgrade)  this change in functionality could be seen as a regression and could break any utilities that are expecting to see a change in the server time stamp when changes are made to the network.\n\nA similar bug to this one was addressed:  https://bugs.launchpad.net/nova/+bug/1143466\n\nThe issue is easy to recreate:\n\n[root@rhel6havana ~]# nova boot --image cirros --flavor m1.tiny TEST\n+-------------------------------------+--------------------------------------+\n| Property                            | Value                                |\n+-------------------------------------+--------------------------------------+\n| OS-EXT-STS:task_state               | scheduling                           |\n| image                               | cirros                               |\n| OS-EXT-STS:vm_state                 | building                             |\n| OS-EXT-SRV-ATTR:instance_name       | instance-00000003                    |\n| flavor                              | m1.tiny                              |\n| id                                  | e68f3c0c-4ada-44bf-ba60-c577b5c037ad |\n| security_groups                     | [{u'name': u'default'}]              |\n| user_id                             | 612de0a91a4b4fe4960f436a8715e7d6     |\n| OS-DCF:diskConfig                   | MANUAL                               |\n| accessIPv4                          |                                      |\n| accessIPv6                          |                                      |\n| progress                            | 0                                    |\n| OS-EXT-STS:power_state              | 0                                    |\n| OS-EXT-AZ:availability_zone         | nova                                 |\n| config_drive                        |                                      |\n| status                              | BUILD                                |\n| updated                             | 2013-05-23T20:37:44Z                 |\n| hostId                              |                                      |\n| OS-EXT-SRV-ATTR:host                | None                                 |\n| key_name                            | None                                 |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | None                                 |\n| name                                | TEST                                 |\n| adminPass                           | 6qarniy3q7ND                         |\n| tenant_id                           | fa123aafec8346b1a8b8cb6dd8e2dc6e     |\n| created                             | 2013-05-23T20:37:44Z                 |\n| metadata                            | {}                                   |\n+-------------------------------------+--------------------------------------+\n[root@rhel6havana ~]# nova list\n+--------------------------------------+------+--------+--------------------------------------+\n| ID                                   | Name | Status | Networks                             |\n+--------------------------------------+------+--------+--------------------------------------+\n| e68f3c0c-4ada-44bf-ba60-c577b5c037ad | TEST | ACTIVE | network2=10.0.2.2; network1=10.0.1.3 |\n+--------------------------------------+------+--------+--------------------------------------+\n[root@rhel6havana ~]# nova show TEST\n+-------------------------------------+----------------------------------------------------------+\n| Property                            | Value                                                    |\n+-------------------------------------+----------------------------------------------------------+\n| status                              | ACTIVE                                                   |\n| updated                             | 2013-05-23T20:37:50Z                                     |\n| OS-EXT-STS:task_state               | None                                                     |\n| OS-EXT-SRV-ATTR:host                | rhel6havana                                              |\n| key_name                            | None                                                     |\n| image                               | cirros (9af9ba34-8567-4a3b-86d0-965d71c293d4)            |\n| network1 network                    | 10.0.1.3                                                 |\n| hostId                              | 20821ecbc2ad05a661720cafd65fd44c697f1f2fdf29b6c47626cad9 |\n| OS-EXT-STS:vm_state                 | active                                                   |\n| OS-EXT-SRV-ATTR:instance_name       | instance-00000003                                        |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | rhel6havana.novalocal                                    |\n| flavor                              | m1.tiny (1)                                              |\n| id                                  | e68f3c0c-4ada-44bf-ba60-c577b5c037ad                     |\n| security_groups                     | [{u'name': u'default'}]                                  |\n| user_id                             | 612de0a91a4b4fe4960f436a8715e7d6                         |\n| name                                | TEST                                                     |\n| created                             | 2013-05-23T20:37:44Z                                     |\n| tenant_id                           | fa123aafec8346b1a8b8cb6dd8e2dc6e                         |\n| OS-DCF:diskConfig                   | MANUAL                                                   |\n| metadata                            | {}                                                       |\n| accessIPv4                          |                                                          |\n| accessIPv6                          |                                                          |\n| progress                            | 0                                                        |\n| OS-EXT-STS:power_state              | 1                                                        |\n| OS-EXT-AZ:availability_zone         | nova                                                     |\n| network2 network                    | 10.0.2.2                                                 |\n| config_drive                        |                                                          |\n+-------------------------------------+----------------------------------------------------------+\n[root@rhel6havana ~]# quantum port-list\nwhich: no gedit in (/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/home/db2inst1/sqllib/bin:/home/db2inst1/sqllib/adm:/home/db2inst1/sqllib/misc:/root/bin)\nwhich: no kate in (/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/home/db2inst1/sqllib/bin:/home/db2inst1/sqllib/adm:/home/db2inst1/sqllib/misc:/root/bin)\n+--------------------------------------+------+-------------------+---------------------------------------------------------------------------------+\n| id                                   | name | mac_address       | fixed_ips                                                                       |\n+--------------------------------------+------+-------------------+---------------------------------------------------------------------------------+\n| be8374e9-45ce-40df-a278-49f2a303b635 |      | fa:16:3e:27:67:2c | {\"subnet_id\": \"bd42c534-e153-485a-a174-60aa35155b60\", \"ip_address\": \"10.0.1.1\"} |\n| 28fadf80-c508-4601-b726-99f9ef576a9c |      | fa:16:3e:61:fa:d2 | {\"subnet_id\": \"bd42c534-e153-485a-a174-60aa35155b60\", \"ip_address\": \"10.0.1.2\"} |\n| b032614c-094f-4293-96a3-70af4088e559 |      | fa:16:3e:71:85:e1 | {\"subnet_id\": \"a481ff5b-1fe6-4d04-9ddf-bbc645c07924\", \"ip_address\": \"10.0.2.2\"} |\n| 6a1c3803-1b19-4181-ab8e-c5fd0994b3ac |      | fa:16:3e:cb:f4:53 | {\"subnet_id\": \"bd42c534-e153-485a-a174-60aa35155b60\", \"ip_address\": \"10.0.1.3\"} |\n+--------------------------------------+------+-------------------+---------------------------------------------------------------------------------+\n[root@rhel6havana ~]# quantum port-delete b032614c-094f-4293-96a3-70af4088e559\nwhich: no gedit in (/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/home/db2inst1/sqllib/bin:/home/db2inst1/sqllib/adm:/home/db2inst1/sqllib/misc:/root/bin)\nwhich: no kate in (/usr/lib64/qt-3.3/bin:/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin:/home/db2inst1/sqllib/bin:/home/db2inst1/sqllib/adm:/home/db2inst1/sqllib/misc:/root/bin)\nDeleted port: b032614c-094f-4293-96a3-70af4088e559\n[root@rhel6havana ~]# nova list\n+--------------------------------------+------+--------+-------------------+\n| ID                                   | Name | Status | Networks          |\n+--------------------------------------+------+--------+-------------------+\n| e68f3c0c-4ada-44bf-ba60-c577b5c037ad | TEST | ACTIVE | network1=10.0.1.3 |\n+--------------------------------------+------+--------+-------------------+\n[root@rhel6havana ~]# nova show TEST\n+-------------------------------------+----------------------------------------------------------+\n| Property                            | Value                                                    |\n+-------------------------------------+----------------------------------------------------------+\n| status                              | ACTIVE                                                   |\n| updated                             | 2013-05-23T20:37:50Z                                     |\n| OS-EXT-STS:task_state               | None                                                     |\n| OS-EXT-SRV-ATTR:host                | rhel6havana                                              |\n| key_name                            | None                                                     |\n| image                               | cirros (9af9ba34-8567-4a3b-86d0-965d71c293d4)            |\n| network1 network                    | 10.0.1.3                                                 |\n| hostId                              | 20821ecbc2ad05a661720cafd65fd44c697f1f2fdf29b6c47626cad9 |\n| OS-EXT-STS:vm_state                 | active                                                   |\n| OS-EXT-SRV-ATTR:instance_name       | instance-00000003                                        |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | rhel6havana.novalocal                                    |\n| flavor                              | m1.tiny (1)                                              |\n| id                                  | e68f3c0c-4ada-44bf-ba60-c577b5c037ad                     |\n| security_groups                     | [{u'name': u'default'}]                                  |\n| user_id                             | 612de0a91a4b4fe4960f436a8715e7d6                         |\n| name                                | TEST                                                     |\n| created                             | 2013-05-23T20:37:44Z                                     |\n| tenant_id                           | fa123aafec8346b1a8b8cb6dd8e2dc6e                         |\n| OS-DCF:diskConfig                   | MANUAL                                                   |\n| metadata                            | {}                                                       |\n| accessIPv4                          |                                                          |\n| accessIPv6                          |                                                          |\n| progress                            | 0                                                        |\n| OS-EXT-STS:power_state              | 1                                                        |\n| OS-EXT-AZ:availability_zone         | nova                                                     |\n| config_drive                        |                                                          |\n+-------------------------------------+----------------------------------------------------------+\n[root@rhel6havana ~]#", 
            "date_created": "2013-05-23 20:44:03.507140+00:00", 
            "author": "https://api.launchpad.net/1.0/~jsbryant"
        }, 
        {
            "content": "Hi Jay, \n\nThis bug is not really solvable at the moment as there is no backwards syncing from neutron to nova. That said this patch should solve this this case you reported: https://review.openstack.org/#/c/64769/", 
            "date_created": "2014-02-11 22:11:53.494636+00:00", 
            "author": "https://api.launchpad.net/1.0/~arosen"
        }, 
        {
            "content": "This is now fixed with the addition of nova-neutron events. ", 
            "date_created": "2014-05-21 18:17:09.377351+00:00", 
            "author": "https://api.launchpad.net/1.0/~arosen"
        }
    ]
}