{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:56:26.954630+00:00", 
    "description": "cinder create --image-id ab24ccbd-4c89-4444-b0b2-a06a79c44306 --display-name my-bootable-vol 3\nnova boot --flavor 1 --block_device_mapping vda=0ea63954-0a9a-4df7-b5a9-08afd0981dcc:::0 volume_backed\nnova live-migration volume_backed\n\nresultes in migration failed:\n\n2013-07-10 11:14:06.055 DEBUG nova.api.openstack.wsgi [req-2368adc9-b7b4-4016-82c2-38e815bd0025 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] No Content-Type provided in request get_body /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:791\n2013-07-10 11:14:06.056 DEBUG nova.api.openstack.wsgi [req-2368adc9-b7b4-4016-82c2-38e815bd0025 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Calling method <bound method Controller.detail of <nova.api.openstack.compute.servers.Controller object at 0x1cad290>> _process_stack /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:911\n2013-07-10 11:14:06.057 DEBUG nova.compute.api [req-2368adc9-b7b4-4016-82c2-38e815bd0025 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Searching by: {'deleted': False, 'project_id': u'62663061e1774fd18ec35f46a19a1c92'} get_all /usr/lib/python2.6/site-packages/nova/compute/api.py:1372\n2013-07-10 11:14:06.102 INFO nova.osapi_compute.wsgi.server [req-2368adc9-b7b4-4016-82c2-38e815bd0025 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] 10.34.69.137 \"GET /v2/62663061e1774fd18ec35f46a19a1c92/servers/detail HTTP/1.1\" status: 200 len: 1563 time: 0.2836871\n \n2013-07-10 11:14:06.332 DEBUG nova.api.openstack.wsgi [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Action: 'action', body: {\"os-migrateLive\": {\"disk_over_commit\": false, \"block_migration\": false, \"host\": null}} _process_stack /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:910\n2013-07-10 11:14:06.332 DEBUG nova.api.openstack.wsgi [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Calling method <bound method AdminActionsController._migrate_live of <nova.api.openstack.compute.contrib.admin_actions.AdminActionsController object at 0x22e8850>> _process_stack /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:911\n2013-07-10 11:14:06.390 DEBUG nova.compute.api [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] [instance: 32c0284d-ad8d-4f21-b6aa-8a46f1232e98] Going to try to live migrate instance to another host live_migrate /usr/lib/python2.6/site-packages/nova/compute/api.py:2447\n2013-07-10 11:14:06.500 DEBUG nova.openstack.common.rpc.amqp [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Making synchronous call on scheduler ... multicall /usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py:583\n2013-07-10 11:14:06.501 DEBUG nova.openstack.common.rpc.amqp [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] MSG_ID is c098878314ae435eb57482571ce55115 multicall /usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py:586\n2013-07-10 11:14:06.501 DEBUG nova.openstack.common.rpc.amqp [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] UNIQUE_ID is a68d14e5878e460fb9cb219e5a357180. _add_unique_id /usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py:337\n2013-07-10 11:14:06.511 INFO nova.openstack.common.rpc.impl_qpid [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Connected to AMQP server on 10.34.69.137:5672\n2013-07-10 11:14:06.518 DEBUG nova.openstack.common.rpc.amqp [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Pool creating new connection create /usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py:75\n2013-07-10 11:14:06.522 INFO nova.openstack.common.rpc.impl_qpid [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Connected to AMQP server on 10.34.69.137:5672\n2013-07-10 11:14:06.602 ERROR nova.api.openstack.compute.contrib.admin_actions [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Live migration of instance 32c0284d-ad8d-4f21-b6aa-8a46f1232e98 to another host failed\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions Traceback (most recent call last):\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/compute/contrib/admin_actions.py\", line 284, in _migrate_live\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     disk_over_commit, host)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/compute/api.py\", line 134, in inner\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return f(self, context, instance, *args, **kw)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/compute/api.py\", line 2454, in live_migrate\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     disk_over_commit, instance, host_name)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/rpcapi.py\", line 110, in live_migration\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     dest=dest))\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/proxy.py\", line 80, in call\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return rpc.call(context, self._get_topic(topic), msg, timeout)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/__init__.py\", line 140, in call\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return _get_impl().call(CONF, context, topic, msg, timeout)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/impl_qpid.py\", line 616, in call\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     rpc_amqp.get_connection_pool(conf, Connection))\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py\", line 612, in call\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     rv = list(rv)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py\", line 508, in __iter__\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     raise result\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions AttributeError: 'NoneType' object has no attribute 'get'\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions Traceback (most recent call last):\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py\", line 430, in _process_data\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/dispatcher.py\", line 133, in dispatch\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return getattr(proxyobj, method)(ctxt, **kwargs)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/manager.py\", line 117, in live_migration\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     context, ex, {})\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib64/python2.6/contextlib.py\", line 23, in __exit__\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     self.gen.next()\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/manager.py\", line 96, in live_migration\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     block_migration, disk_over_commit)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/driver.py\", line 196, in schedule_live_migration\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     ignore_hosts)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/driver.py\", line 272, in _live_migration_dest_check\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     filter_properties)[0]\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/filter_scheduler.py\", line 146, in select_hosts\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     request_spec, filter_properties, instance_uuids)]\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/filter_scheduler.py\", line 336, in _schedule\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     filter_properties)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/host_manager.py\", line 342, in get_filtered_hosts\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     hosts, filter_properties)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/filters.py\", line 53, in get_filtered_objects\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return list(objs)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/filters.py\", line 38, in filter_all\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     for obj in filter_obj_list:\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/filters.py\", line 39, in filter_all\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     if self._filter_one(obj, filter_properties):\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/filters/__init__.py\", line 30, in _filter_one\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return self.host_passes(obj, filter_properties)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/filters/image_props_filter.py\", line 78, in host_passes\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     image_props = spec.get('image', {}).get('properties', {})\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions AttributeError: 'NoneType' object has no attribute 'get'\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.613 INFO nova.api.openstack.wsgi [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] HTTP exception thrown: Live migration of instance 32c0284d-ad8d-4f21-b6aa-8a46f1232e98 to another host failed\n2013-07-10 11:14:06.613 DEBUG nova.api.openstack.wsgi [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Returning 400 to user: Live migration of instance 32c0284d-ad8d-4f21-b6aa-8a46f1232e98 to another host failed __call__ /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:1165\n2013-07-10 11:14:06.615 INFO nova.osapi_compute.wsgi.server [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] 10.34.69.137 \"POST /v2/62663061e1774fd18ec35f46a19a1c92/servers/32c0284d-ad8d-4f21-b6aa-8a46f1232e98/action HTTP/1.1\" status: 400 len: 327 time: 0.5004730", 
    "tags": [], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1199811", 
    "owner": "https://api.launchpad.net/1.0/~ndipanov", 
    "id": 1199811, 
    "index": 1154, 
    "created": "2013-07-10 14:15:52.442951+00:00", 
    "title": "nova live-migration of volume-backed VM fails because of image is None", 
    "comments": [
        {
            "content": "cinder create --image-id ab24ccbd-4c89-4444-b0b2-a06a79c44306 --display-name my-bootable-vol 3\nnova boot --flavor 1 --block_device_mapping vda=0ea63954-0a9a-4df7-b5a9-08afd0981dcc:::0 volume_backed\nnova live-migration volume_backed\n\nresultes in migration failed:\n\n2013-07-10 11:14:06.055 DEBUG nova.api.openstack.wsgi [req-2368adc9-b7b4-4016-82c2-38e815bd0025 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] No Content-Type provided in request get_body /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:791\n2013-07-10 11:14:06.056 DEBUG nova.api.openstack.wsgi [req-2368adc9-b7b4-4016-82c2-38e815bd0025 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Calling method <bound method Controller.detail of <nova.api.openstack.compute.servers.Controller object at 0x1cad290>> _process_stack /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:911\n2013-07-10 11:14:06.057 DEBUG nova.compute.api [req-2368adc9-b7b4-4016-82c2-38e815bd0025 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Searching by: {'deleted': False, 'project_id': u'62663061e1774fd18ec35f46a19a1c92'} get_all /usr/lib/python2.6/site-packages/nova/compute/api.py:1372\n2013-07-10 11:14:06.102 INFO nova.osapi_compute.wsgi.server [req-2368adc9-b7b4-4016-82c2-38e815bd0025 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] 10.34.69.137 \"GET /v2/62663061e1774fd18ec35f46a19a1c92/servers/detail HTTP/1.1\" status: 200 len: 1563 time: 0.2836871\n \n2013-07-10 11:14:06.332 DEBUG nova.api.openstack.wsgi [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Action: 'action', body: {\"os-migrateLive\": {\"disk_over_commit\": false, \"block_migration\": false, \"host\": null}} _process_stack /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:910\n2013-07-10 11:14:06.332 DEBUG nova.api.openstack.wsgi [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Calling method <bound method AdminActionsController._migrate_live of <nova.api.openstack.compute.contrib.admin_actions.AdminActionsController object at 0x22e8850>> _process_stack /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:911\n2013-07-10 11:14:06.390 DEBUG nova.compute.api [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] [instance: 32c0284d-ad8d-4f21-b6aa-8a46f1232e98] Going to try to live migrate instance to another host live_migrate /usr/lib/python2.6/site-packages/nova/compute/api.py:2447\n2013-07-10 11:14:06.500 DEBUG nova.openstack.common.rpc.amqp [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Making synchronous call on scheduler ... multicall /usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py:583\n2013-07-10 11:14:06.501 DEBUG nova.openstack.common.rpc.amqp [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] MSG_ID is c098878314ae435eb57482571ce55115 multicall /usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py:586\n2013-07-10 11:14:06.501 DEBUG nova.openstack.common.rpc.amqp [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] UNIQUE_ID is a68d14e5878e460fb9cb219e5a357180. _add_unique_id /usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py:337\n2013-07-10 11:14:06.511 INFO nova.openstack.common.rpc.impl_qpid [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Connected to AMQP server on 10.34.69.137:5672\n2013-07-10 11:14:06.518 DEBUG nova.openstack.common.rpc.amqp [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Pool creating new connection create /usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py:75\n2013-07-10 11:14:06.522 INFO nova.openstack.common.rpc.impl_qpid [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Connected to AMQP server on 10.34.69.137:5672\n2013-07-10 11:14:06.602 ERROR nova.api.openstack.compute.contrib.admin_actions [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Live migration of instance 32c0284d-ad8d-4f21-b6aa-8a46f1232e98 to another host failed\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions Traceback (most recent call last):\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/compute/contrib/admin_actions.py\", line 284, in _migrate_live\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     disk_over_commit, host)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/compute/api.py\", line 134, in inner\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return f(self, context, instance, *args, **kw)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/compute/api.py\", line 2454, in live_migrate\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     disk_over_commit, instance, host_name)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/rpcapi.py\", line 110, in live_migration\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     dest=dest))\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/proxy.py\", line 80, in call\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return rpc.call(context, self._get_topic(topic), msg, timeout)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/__init__.py\", line 140, in call\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return _get_impl().call(CONF, context, topic, msg, timeout)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/impl_qpid.py\", line 616, in call\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     rpc_amqp.get_connection_pool(conf, Connection))\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py\", line 612, in call\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     rv = list(rv)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py\", line 508, in __iter__\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     raise result\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions AttributeError: 'NoneType' object has no attribute 'get'\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions Traceback (most recent call last):\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py\", line 430, in _process_data\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/dispatcher.py\", line 133, in dispatch\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return getattr(proxyobj, method)(ctxt, **kwargs)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/manager.py\", line 117, in live_migration\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     context, ex, {})\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib64/python2.6/contextlib.py\", line 23, in __exit__\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     self.gen.next()\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/manager.py\", line 96, in live_migration\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     block_migration, disk_over_commit)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/driver.py\", line 196, in schedule_live_migration\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     ignore_hosts)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/driver.py\", line 272, in _live_migration_dest_check\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     filter_properties)[0]\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/filter_scheduler.py\", line 146, in select_hosts\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     request_spec, filter_properties, instance_uuids)]\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/filter_scheduler.py\", line 336, in _schedule\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     filter_properties)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/host_manager.py\", line 342, in get_filtered_hosts\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     hosts, filter_properties)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/filters.py\", line 53, in get_filtered_objects\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return list(objs)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/filters.py\", line 38, in filter_all\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     for obj in filter_obj_list:\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/filters.py\", line 39, in filter_all\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     if self._filter_one(obj, filter_properties):\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/filters/__init__.py\", line 30, in _filter_one\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     return self.host_passes(obj, filter_properties)\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions   File \"/usr/lib/python2.6/site-packages/nova/scheduler/filters/image_props_filter.py\", line 78, in host_passes\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions     image_props = spec.get('image', {}).get('properties', {})\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions AttributeError: 'NoneType' object has no attribute 'get'\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.602 4625 TRACE nova.api.openstack.compute.contrib.admin_actions\n2013-07-10 11:14:06.613 INFO nova.api.openstack.wsgi [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] HTTP exception thrown: Live migration of instance 32c0284d-ad8d-4f21-b6aa-8a46f1232e98 to another host failed\n2013-07-10 11:14:06.613 DEBUG nova.api.openstack.wsgi [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] Returning 400 to user: Live migration of instance 32c0284d-ad8d-4f21-b6aa-8a46f1232e98 to another host failed __call__ /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:1165\n2013-07-10 11:14:06.615 INFO nova.osapi_compute.wsgi.server [req-f764fd10-e182-43c6-b308-f4eb9fce2495 584de53b707647ca867b277c6c6d9937 62663061e1774fd18ec35f46a19a1c92] 10.34.69.137 \"POST /v2/62663061e1774fd18ec35f46a19a1c92/servers/32c0284d-ad8d-4f21-b6aa-8a46f1232e98/action HTTP/1.1\" status: 400 len: 327 time: 0.5004730", 
            "date_created": "2013-07-10 14:15:52.442951+00:00", 
            "author": "https://api.launchpad.net/1.0/~jhenner"
        }, 
        {
            "content": "This seems to be caused by the following pathc https://review.openstack.org/#/c/29210/1 (Jaroslav failed to metnion this happens with stable grizzly but will most likely happen with Havana as well)\n\nThe patch defaults the image parameter to None when it should either be {} , or a more robust check should be done inside image_props filter.", 
            "date_created": "2013-07-10 14:29:05.088134+00:00", 
            "author": "https://api.launchpad.net/1.0/~ndipanov"
        }, 
        {
            "content": "Ok so the situation is as follows:\n * The bug was reported against grizzly 2013.1.2 and it should be fixed there\n * Looking at the code in the current master - live migration functionality is being heavily refactored and the code from the patch that introduces the bug (see previous comment) was accidentally dropped in https://review.openstack.org/#/c/29077/27 so in Havana we need to fix the orriginal bug #1170596", 
            "date_created": "2013-07-11 08:12:05.831596+00:00", 
            "author": "https://api.launchpad.net/1.0/~ndipanov"
        }, 
        {
            "content": "Also worth noting is that this happens only if the destination host was not specified and the scheduler needs to pick one so it might lower the bug severity.", 
            "date_created": "2013-07-11 12:48:29.397966+00:00", 
            "author": "https://api.launchpad.net/1.0/~ndipanov"
        }, 
        {
            "content": "Fix proposed to branch: stable/grizzly\nReview: https://review.openstack.org/36654", 
            "date_created": "2013-07-11 13:23:25.646309+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/37289", 
            "date_created": "2013-07-16 16:57:58.284579+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/37289\nCommitted: http://github.com/openstack/nova/commit/4bf1d5b3829ef45cddcaedba912bd816981b0c49\nSubmitter: Jenkins\nBranch:    master\n\ncommit 4bf1d5b3829ef45cddcaedba912bd816981b0c49\nAuthor: Nikola Dipanov <email address hidden>\nDate:   Tue Jul 16 18:59:38 2013 +0200\n\n    Don't pass empty image to filter on live migration\n    \n    If live migration for a volume backed instance without an image supplied\n    is initiated with no destination supplied, glance client show will not\n    be called and the image variable will be set to None.\n    \n    However if passed to filters like that as part of the request_spec\n    dictionary, None value will cause one of the default filters - the\n    ImagePropertiesFilter to throw an exception in it's host_passes method,\n    as it expects an image to be a dictionary.\n    \n    We solve this by leaving out the image entirely before engaging filters,\n    and not attempting to get it if it was not supplied to the instance.\n    \n    This bug was previously fixed (however not fully, as the None image\n    would still cause an exception) in the following patch:\n    Ie683a3ca5d6430c52ead77b41f98fbcb4114ea1e, but  was accidentally dropped\n    in I6de33ada6dc377e20f8df07da92244f2c150b9fe.\n    \n    Fixes bug 1170596 (again)\n    Fixes bug 1199811\n    \n    Change-Id: I0239b6ac5640d075f937f9690eca4ce54f534117\n", 
            "date_created": "2013-07-27 15:56:42.328245+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/36654\nCommitted: http://github.com/openstack/nova/commit/a04b312459f21594ced42302397767ba379f2491\nSubmitter: Jenkins\nBranch:    stable/grizzly\n\ncommit a04b312459f21594ced42302397767ba379f2491\nAuthor: Nikola Dipanov <email address hidden>\nDate:   Thu Jul 11 15:12:58 2013 +0200\n\n    Don't pass empty image to filter on live migration\n    \n    If live migration for a volume backed instance without an image supplied\n    is initiated with no destination supplied, image is set to None.\n    \n    This value will cause one of the default filters - the\n    ImagePropertiesFilter to throw an exception in it's host_passes method,\n    as it expects an image to be a dictionary.\n    \n    We solve this by leaving out the image entirely before engaging filters.\n    \n    This patch is intended for stable/grizzly only, since live migration\n    functionality is being heavily refactored in Havana at the moment and\n    the code from the patch that introduces this bug\n    (Ie683a3ca5d6430c52ead77b41f98fbcb4114ea1e) was\n    accidentally dropped in I6de33ada6dc377e20f8df07da92244f2c150b9fe.\n    \n    Fixes bug: 1199811\n    \n    Change-Id: I8a5f1b176addbe09c8d8b5f1d1136d05af53ce3e\n", 
            "date_created": "2013-07-29 18:23:36.104097+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}