{
    "status": "Invalid", 
    "last_updated": "2015-12-01 09:44:46.200043+00:00", 
    "description": "The user is\u00a0trying\u00a0to\u00a0do\u00a0a\u00a0single\u00a0server\u00a0provision\u00a0using\u00a0a\u00a0basic\u00a0RHEL template,\u00a0but\u00a0the\u00a0flavor\u00a0has\u00a0an\u00a0ephemeral\u00a0disk\u00a0defined.\u00a0Provision the\u00a0same\u00a0flavor\u00a0without\u00a0an\u00a0ephemeral\u00a0disk doesn't have\u00a0problem.\n\nThe\u00a0VMWare server\u00a0is\u00a0ESXi\u00a05.5.0\u00a02143827,\u00a0vCenter\u00a0is\u00a05.5.0.20000\u00a0Build\u00a02063318\n\nError\u00a0from\u00a0vCenter:\nCreate\u00a0virtual\u00a0disk\nA\u00a0specified\u00a0parameter\u00a0was\u00a0not\u00a0correct.\u00a0\u00a0paraVirtualscsi\n\n\nBased on the API:\nhttp://pubs.vmware.com/vsphere-55/index.jsp#com.vmware.wssdk.apiref.doc/vim.VirtualDiskManager.VirtualDiskAdapterType.html\nThere is no paraVirtualscsi Constant, so it is rejected by the API as \"A specified parameter was not correct\".\n\nin nova/virt/vmwareapi/vm_util.py:\ndef get_vmdk_adapter_type(adapter_type):\n\u00a0\u00a0\u00a0\u00a0\"\"\"Return the adapter type to be used in vmdk descriptor.\n\u00a0\u00a0\u00a0\u00a0Adapter type in vmdk descriptor is same for LSI-SAS, LSILogic & ParaVirtual\n\u00a0\u00a0\u00a0\u00a0because Virtual Disk Manager API does not recognize the newer controller\n\u00a0\u00a0\u00a0\u00a0types.\n\u00a0\u00a0\u00a0\u00a0\"\"\"\n\u00a0\u00a0\u00a0\u00a0if adapter_type in [constants.ADAPTER_TYPE_LSILOGICSAS,\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0constants.ADAPTER_TYPE_PARAVIRTUAL]:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0vmdk_adapter_type = constants.DEFAULT_ADAPTER_TYPE\n\u00a0\u00a0\u00a0\u00a0else:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0vmdk_adapter_type = adapter_type\n\u00a0\u00a0\u00a0\u00a0return vmdk_adapter_type\n\nin nova/virt/vmwareapi/constants.py\nDEFAULT_ADAPTER_TYPE = \"lsiLogic\"\n...\nADAPTER_TYPE_BUSLOGIC = \"busLogic\"\nADAPTER_TYPE_IDE = \"ide\"\nADAPTER_TYPE_LSILOGICSAS = \"lsiLogicsas\"\nADAPTER_TYPE_PARAVIRTUAL = \"paraVirtual\"\n\n\nIt appears as though the original authors were well aware that the newer controller types aren't supported by the CreateVirtualDisk_Task and attempted to mitigate the problem by returning the default adapter type instead of the paraVirtualSCSI or LSILogicSAS which they knew would result in an error.\n\nThe problem is that the value of \"adapter_type\" is not what they expected.  \n\nIn this instance adapter_type is being returned as \"paraVirtualscsi\" and this does not match constants.ADAPTER_TYPE_PARAVIRTUAL which is defined in constants.py as: ADAPTER_TYPE_PARAVIRTUAL = \"paraVirtual\"\n\nThe \"scsi\" at the end has been dropped and therefore no match is made and the adapter_type is passed straight through to the vmware API resulting in an error.  \n\nThe intent seems to be that a match would have been made, and that constants.DEFAULT_ADAPTER_TYPE is returned instead which is defined in constants.py as: DEFAULT_ADAPTER_TYPE = \"lsiLogic\"", 
    "tags": [
        "vmware"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1521458", 
    "owner": "None", 
    "id": 1521458, 
    "index": 5867, 
    "created": "2015-12-01 03:25:07.004578+00:00", 
    "title": "ParaVirtualSCSI adapter type string doesn't match the one in the constants.py", 
    "comments": [
        {
            "content": "Based on the API: \nhttp://pubs.vmware.com/vsphere-55/index.jsp#com.vmware.wssdk.apiref.doc/vim.VirtualDiskManager.VirtualDiskAdapterType.html\nThere is no paraVirtualscsi Constant, so it is rejected by the API as \"A specified parameter was not correct\".\n\nin nova/virt/vmwareapi/vm_util.py:\ndef get_vmdk_adapter_type(adapter_type):\n    \"\"\"Return the adapter type to be used in vmdk descriptor.\n    Adapter type in vmdk descriptor is same for LSI-SAS, LSILogic & ParaVirtual\n    because Virtual Disk Manager API does not recognize the newer controller\n    types.\n    \"\"\"\n    if adapter_type in [constants.ADAPTER_TYPE_LSILOGICSAS,\n                        constants.ADAPTER_TYPE_PARAVIRTUAL]:\n        vmdk_adapter_type = constants.DEFAULT_ADAPTER_TYPE\n    else:\n        vmdk_adapter_type = adapter_type\n    return vmdk_adapter_type\n\nin nova/virt/vmwareapi/constants.py\nDEFAULT_ADAPTER_TYPE = \"lsiLogic\"\n...\nADAPTER_TYPE_BUSLOGIC = \"busLogic\"\nADAPTER_TYPE_IDE = \"ide\"\nADAPTER_TYPE_LSILOGICSAS = \"lsiLogicsas\"\nADAPTER_TYPE_PARAVIRTUAL = \"paraVirtual\"\n\nHere we can see, only  \"lsiLogicsas\" and \"paraVirtual\" are filtered out as unsupported adapter types and switched to \"lsiLogic\".\nBut there are still other unsupported adapter types such as paraVirtualscsi and so on.\nSo the filter list seems should be extent or errors will occur if other unsupported adapter types are used.", 
            "date_created": "2015-12-01 03:25:07.004578+00:00", 
            "author": "https://api.launchpad.net/1.0/~zzbj"
        }
    ]
}