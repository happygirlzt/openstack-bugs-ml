{
    "status": "Won't Fix", 
    "last_updated": "2014-12-03 22:39:29.814118+00:00", 
    "description": "OpenStack version: Icehouse\n\nIssue: fail to resize VM\n\nSetup: 3 nodes, namely Controller, Compute and Network; with nova-compute running solely on Compute node.\n\nSteps to reproduce:\n  1. Create an instance using image cirrus 0.3.2.\n  2. Verify instance is running: nova list\n  3. Resize the instance: nova resize cirrus 2 \u2014poll\n  4. Verify the resize: nova list\n  5. Note that the server status is ACTIVE instead of VERIFY_RESIZE.\n  6. Check nova-conductor.log at Controller node and note the error.\n\nSnippet of the nova-conductor.log:\n\n2014-09-12 10:10:22.923 1290 WARNING nova.scheduler.utils [req-c7b0a97d-7c79-477b-ab97-48e55e956bdc 77bdd3f911744f72af7038d40d722439 73a095bf078443c9b340d871deaabcc3] Failed to compute_task_migrate_server: No valid host was found. \nTraceback (most recent call last):\n\n  File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/server.py\", line 139, in inner\n    return func(*args, **kwargs)\n\n  File \"/usr/lib/python2.7/dist-packages/nova/scheduler/manager.py\", line 298, in select_destinations\n    filter_properties)\n\n  File \"/usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py\", line 140, in select_destinations\n    raise exception.NoValidHost(reason='')\n\nNoValidHost: No valid host was found. \n\n2014-09-12 10:10:22.924 1290 WARNING nova.scheduler.utils [req-c7b0a97d-7c79-477b-ab97-48e55e956bdc 77bdd3f911744f72af7038d40d722439 73a095bf078443c9b340d871deaabcc3] [instance: 569de892-5f5a-48f1-ac5e-a88e9d9b4c94] Setting instance to ACTIVE state.\n2014-09-12 10:10:22.973 1290 WARNING nova.conductor.manager [req-c7b0a97d-7c79-477b-ab97-48e55e956bdc 77bdd3f911744f72af7038d40d722439 73a095bf078443c9b340d871deaabcc3] [instance: 569de892-5f5a-48f1-ac5e-a88e9d9b4c94] No valid host found for cold migrate \n\nroot@Controller:/home/guest# nova list\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n| ID                                   | Name   | Status | Task State | Power State | Networks            |\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n| 569de892-5f5a-48f1-ac5e-a88e9d9b4c94 | cirros | ACTIVE | -          | Running     | int-net=172.16.1.67 |\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\nroot@Controller:/home/guest# nova resize cirros 2 --poll\nServer resizing... 100% complete\nFinished\nroot@Controller:/home/guest# nova list\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n| ID                                   | Name   | Status | Task State | Power State | Networks            |\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n| 569de892-5f5a-48f1-ac5e-a88e9d9b4c94 | cirros | ACTIVE | -          | Running     | int-net=172.16.1.67 |\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n\n\nNOTE: I tried setting \"allow_resize_to_same_host=true\u201d and \u201callow_migrate_to_same_host=true\u201d in nova.conf at both the controller and compute node and restart nova services, but still saw the same issue.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1368789", 
    "owner": "None", 
    "id": 1368789, 
    "index": 5155, 
    "created": "2014-09-12 14:18:48.222303+00:00", 
    "title": "Fail to resize VM; No valid host was found", 
    "comments": [
        {
            "content": "OpenStack version: Icehouse\n\nIssue: fail to resize VM\n\nSetup: 3 nodes, namely Controller, Compute and Network; with nova-compute running solely on Compute node.\n\nSteps to reproduce:\n  1. Create an instance using image cirrus 0.3.2.\n  2. Verify instance is running: nova list\n  3. Resize the instance: nova resize cirrus 2 \u2014poll\n  4. Verify the resize: nova list\n  5. Note that the server status is ACTIVE instead of VERIFY_RESIZE.\n  6. Check nova-conductor.log at Controller node and note the error.\n\nSnippet of the nova-conductor.log:\n\n2014-09-12 10:10:22.923 1290 WARNING nova.scheduler.utils [req-c7b0a97d-7c79-477b-ab97-48e55e956bdc 77bdd3f911744f72af7038d40d722439 73a095bf078443c9b340d871deaabcc3] Failed to compute_task_migrate_server: No valid host was found. \nTraceback (most recent call last):\n\n  File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/server.py\", line 139, in inner\n    return func(*args, **kwargs)\n\n  File \"/usr/lib/python2.7/dist-packages/nova/scheduler/manager.py\", line 298, in select_destinations\n    filter_properties)\n\n  File \"/usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py\", line 140, in select_destinations\n    raise exception.NoValidHost(reason='')\n\nNoValidHost: No valid host was found. \n\n2014-09-12 10:10:22.924 1290 WARNING nova.scheduler.utils [req-c7b0a97d-7c79-477b-ab97-48e55e956bdc 77bdd3f911744f72af7038d40d722439 73a095bf078443c9b340d871deaabcc3] [instance: 569de892-5f5a-48f1-ac5e-a88e9d9b4c94] Setting instance to ACTIVE state.\n2014-09-12 10:10:22.973 1290 WARNING nova.conductor.manager [req-c7b0a97d-7c79-477b-ab97-48e55e956bdc 77bdd3f911744f72af7038d40d722439 73a095bf078443c9b340d871deaabcc3] [instance: 569de892-5f5a-48f1-ac5e-a88e9d9b4c94] No valid host found for cold migrate \n\nroot@Controller:/home/guest# nova list\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n| ID                                   | Name   | Status | Task State | Power State | Networks            |\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n| 569de892-5f5a-48f1-ac5e-a88e9d9b4c94 | cirros | ACTIVE | -          | Running     | int-net=172.16.1.67 |\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\nroot@Controller:/home/guest# nova resize cirros 2 --poll\nServer resizing... 100% complete\nFinished\nroot@Controller:/home/guest# nova list\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n| ID                                   | Name   | Status | Task State | Power State | Networks            |\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n| 569de892-5f5a-48f1-ac5e-a88e9d9b4c94 | cirros | ACTIVE | -          | Running     | int-net=172.16.1.67 |\n+--------------------------------------+--------+--------+------------+-------------+---------------------+\n\n\nNOTE: I tried setting \"allow_resize_to_same_host=true\u201d and \u201callow_migrate_to_same_host=true\u201d in nova.conf at both the controller and compute node and restart nova services, but still saw the same issue.", 
            "date_created": "2014-09-12 14:18:48.222303+00:00", 
            "author": "https://api.launchpad.net/1.0/~dannchoi"
        }, 
        {
            "content": "resize is really not supposed to function with only 1 node, that's a testing only configuration. So this is invalid as a multinode case unless there are 2 compute nodes.", 
            "date_created": "2014-09-12 14:35:35.269272+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "However, if you wanted to recreate a tempest test by hand you would still expect this configuration to work, no?", 
            "date_created": "2014-12-03 22:39:28.628112+00:00", 
            "author": "https://api.launchpad.net/1.0/~jbernard"
        }
    ]
}