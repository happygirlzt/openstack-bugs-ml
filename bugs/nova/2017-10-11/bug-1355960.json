{
    "status": "Invalid", 
    "last_updated": "2014-09-04 13:45:22.750355+00:00", 
    "description": "Set up Icehouse high availability cluster using Ubuntu 14.04 and openstack IceHouse. RabbitMQ version = 3.2.4\nCan not get compute node to register with controller.\nAll Nova commands work properly on controller. \nFrom compute node able to telnet to rabbitmq server on port 5672\nAlthough below error indicated AMQP as localhost:5672, my config is actually a clustered rabbitmq server\n\nnova-compute log:\n2014-08-12 12:32:26.659 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2014-08-12 12:32:26.659 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2014-08-12 12:32:27.673 4173 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 23 seconds.\n2014-08-12 12:32:50.691 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2014-08-12 12:32:50.692 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2014-08-12 12:32:51.705 4173 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 25 seconds.\n2014-08-12 12:33:16.725 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2014-08-12 12:33:16.726 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2014-08-12 12:33:17.738 4173 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 27 seconds.\n\ncompute node nova.conf:\n[DEFAULT]\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlogdir=/var/log/nova\nstate_path=/var/lib/nova\nlock_path=/var/lock/nova\nforce_dhcp_release=True\niscsi_helper=tgtadm\nlibvirt_use_virtio_for_bridges=True\nconnection_type=libvirt\nroot_helper=sudo nova-rootwrap /etc/nova/rootwrap.conf\nverbose=True\nec2_private_dns_show_ip=True\napi_paste_config=/etc/nova/api-paste.ini\nvolumes_path=/var/lib/nova/volumes\nenabled_apis=ec2,osapi_compute,metadata\nauth_strategy = keystone\nglance_host = 10.1.0.2\n\n[database]\n# The SQLAlchemy connection string used to connect to the database\nconnection = mysql://nova:password@10.1.0.2/nova\n\n[keystone_authtoken]\nauth_uri = http://10.1.0.2:5000\nauth_host = 10.1.0.2\nauth_port = 35357\nauth_protocol = http\nadmin_tenant_name = service\nadmin_user = nova\nadmin_password = password\n\n[rabbitMQ]\nrpc_backend = rabbit\nrabbit_hosts = 10.1.0.5,10.1.0.6\nrabbit_password = password\n\n[neutron network]\nnetwork_api_class = nova.network.neutronv2.api.API\nneutron_url = http://10.1.0.2:9696\nneutron_auth_strategy = keystone\nneutron_admin_tenant_name = service\nneutron_admin_username = quantum\nneutron_admin_password = password\nneutron_admin_auth_url = http://10.1.0.2:35357/v2.0\nlinuxnet_interface_driver = nova.network.linux_net.LinuxOVSInterfaceDriver\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\nsecurity_group_api = neutron\n\nmy_ip = 10.1.0.22\nvnc_enabled = True\nvncserver_listen = 0.0.0.0\nvncserver_proxyclient_address = 10.1.0.22\nnovncproxy_base_url = http://10.1.0.2:6080/vnc_auto.html", 
    "tags": [
        "nova-compute", 
        "rabbitmq"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1355960", 
    "owner": "None", 
    "id": 1355960, 
    "index": 5072, 
    "created": "2014-08-12 17:50:11.210773+00:00", 
    "title": "nova-compute defaults to localhost:5672 for AMPQ rather than Rabbitmq server", 
    "comments": [
        {
            "content": "Set up Icehouse high availability cluster using Ubuntu 14.04 and openstack IceHouse. RabbitMQ version = 3.2.4\nCan not get compute node to register with controller.\nAll Nova commands work properly on controller. \nFrom compute node able to telnet to rabbitmq server on port 5672\nAlthough below error indicated AMQP as localhost:5672, my config is actually a clustered rabbitmq server\n\nnova-compute log:\n2014-08-12 12:32:26.659 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2014-08-12 12:32:26.659 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2014-08-12 12:32:27.673 4173 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 23 seconds.\n2014-08-12 12:32:50.691 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2014-08-12 12:32:50.692 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2014-08-12 12:32:51.705 4173 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 25 seconds.\n2014-08-12 12:33:16.725 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2014-08-12 12:33:16.726 4173 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2014-08-12 12:33:17.738 4173 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 27 seconds.\n\ncompute node nova.conf:\n[DEFAULT]\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlogdir=/var/log/nova\nstate_path=/var/lib/nova\nlock_path=/var/lock/nova\nforce_dhcp_release=True\niscsi_helper=tgtadm\nlibvirt_use_virtio_for_bridges=True\nconnection_type=libvirt\nroot_helper=sudo nova-rootwrap /etc/nova/rootwrap.conf\nverbose=True\nec2_private_dns_show_ip=True\napi_paste_config=/etc/nova/api-paste.ini\nvolumes_path=/var/lib/nova/volumes\nenabled_apis=ec2,osapi_compute,metadata\nauth_strategy = keystone\nglance_host = 10.1.0.2\n\n[database]\n# The SQLAlchemy connection string used to connect to the database\nconnection = mysql://nova:password@10.1.0.2/nova\n\n[keystone_authtoken]\nauth_uri = http://10.1.0.2:5000\nauth_host = 10.1.0.2\nauth_port = 35357\nauth_protocol = http\nadmin_tenant_name = service\nadmin_user = nova\nadmin_password = password\n\n[rabbitMQ]\nrpc_backend = rabbit\nrabbit_hosts = 10.1.0.5,10.1.0.6\nrabbit_password = password\n\n[neutron network]\nnetwork_api_class = nova.network.neutronv2.api.API\nneutron_url = http://10.1.0.2:9696\nneutron_auth_strategy = keystone\nneutron_admin_tenant_name = service\nneutron_admin_username = quantum\nneutron_admin_password = password\nneutron_admin_auth_url = http://10.1.0.2:35357/v2.0\nlinuxnet_interface_driver = nova.network.linux_net.LinuxOVSInterfaceDriver\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\nsecurity_group_api = neutron\n\nmy_ip = 10.1.0.22\nvnc_enabled = True\nvncserver_listen = 0.0.0.0\nvncserver_proxyclient_address = 10.1.0.22\nnovncproxy_base_url = http://10.1.0.2:6080/vnc_auto.html", 
            "date_created": "2014-08-12 17:50:11.210773+00:00", 
            "author": "https://api.launchpad.net/1.0/~bgyako"
        }, 
        {
            "content": "Can you try changing your nova.conf to have: \n'rpc_backend=nova.openstack.common.rpc.impl_kombu'  (instead of rabbit)", 
            "date_created": "2014-08-13 18:22:33.180233+00:00", 
            "author": "https://api.launchpad.net/1.0/~tkay"
        }, 
        {
            "content": "I updated rpc_backend in nova.conf on compute node, restarted nova-compute service, and same error.\nIt is still looking at localhost", 
            "date_created": "2014-08-13 19:13:24.850499+00:00", 
            "author": "https://api.launchpad.net/1.0/~bgyako"
        }, 
        {
            "content": "I don't remember seeing a [rabbitMQ] section. can you please try the rabbit_hosts under \"[DEFAULT]\" section?", 
            "date_created": "2014-08-13 19:37:14.205782+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "Thank you that worked... I moved the rpc and rabbit info under the default section and it worked.. ", 
            "date_created": "2014-08-13 20:32:06.088698+00:00", 
            "author": "https://api.launchpad.net/1.0/~bgyako"
        }, 
        {
            "content": "Hi all,\n\nI am new to OpenStack. I am deploying openstack ICEHouse with two node set up with legacy networking. I install keystone and glance. And while trying to install nova services in controller I am facing this problems. \n\nProblem 1 :\nprogram specified\\nSorry, try again.\\nsudo: 3 incorrect password attempts\\n'\n2014-09-03 23:28:57.635 18981 TRACE nova Traceback (most recent call last):\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/usr/bin/nova-api\", line 10, in <module>\n2014-09-03 23:28:57.635 18981 TRACE nova     sys.exit(main())\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/cmd/api.py\", line 55, in main\n2014-09-03 23:28:57.635 18981 TRACE nova     server = service.WSGIService(api, use_ssl=should_use_ssl)\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/service.py\", line 331, in __init__\n2014-09-03 23:28:57.635 18981 TRACE nova     self.manager = self._get_manager()\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/service.py\", line 383, in _get_manager\n2014-09-03 23:28:57.635 18981 TRACE nova     return manager_class()\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/api/manager.py\", line 30, in __init__\n2014-09-03 23:28:57.635 18981 TRACE nova     self.network_driver.metadata_accept()\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/network/linux_net.py\", line 666, in metadata_accept\n2014-09-03 23:28:57.635 18981 TRACE nova     iptables_manager.apply()\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/network/linux_net.py\", line 434, in apply\n2014-09-03 23:28:57.635 18981 TRACE nova     self._apply()\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/openstack/common/lockutils.py\", line 325, in inner\n2014-09-03 23:28:57.635 18981 TRACE nova     return f(*args, **kwargs)\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/network/linux_net.py\", line 454, in _apply\n2014-09-03 23:28:57.635 18981 TRACE nova     attempts=5)\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/network/linux_net.py\", line 1236, in _execute\n2014-09-03 23:28:57.635 18981 TRACE nova     return utils.execute(*cmd, **kwargs)\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/utils.py\", line 163, in execute\n2014-09-03 23:28:57.635 18981 TRACE nova     return processutils.execute(*cmd, **kwargs)\n2014-09-03 23:28:57.635 18981 TRACE nova   File \"/opt/stack/nova/nova/openstack/common/processutils.py\", line 200, in execute\n2014-09-03 23:28:57.635 18981 TRACE nova     cmd=' '.join(cmd))\n2014-09-03 23:28:57.635 18981 TRACE nova ProcessExecutionError: Unexpected error while running command.\n2014-09-03 23:28:57.635 18981 TRACE nova Command: sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c\n2014-09-03 23:28:57.635 18981 TRACE nova Exit code: 1\n2014-09-03 23:28:57.635 18981 TRACE nova Stdout: ''\n2014-09-03 23:28:57.635 18981 TRACE nova Stderr: 'sudo: no tty present and no askpass program specified\\nSorry, try again.\\nsudo: no tty present and no askpass program specified\\nSorry, try again.\\nsudo: no tty present and no askpass program specified\\nSorry, try again.\\nsudo: 3 incorrect password attempts\\n'\n\n\nI am seeing this error in nova-api. nova-api starts and goes down immediately after sometime", 
            "date_created": "2014-09-04 06:32:56.653444+00:00", 
            "author": "https://api.launchpad.net/1.0/~velumit"
        }, 
        {
            "content": "Hi velmurugan,\n\nYou really should open new issue, otherwise this might be overlooked.\nIt seems there are a couple of different things going on.\nFirstly, did you set up all the service users (nova, glance, cinder, etc).\nYou are getting a password error, which would make me suspect that you did not complete keystone setup,\nusers, and service points.\n\nBoris", 
            "date_created": "2014-09-04 13:45:21.831406+00:00", 
            "author": "https://api.launchpad.net/1.0/~bgyako"
        }
    ]
}