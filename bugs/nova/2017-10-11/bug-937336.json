{
    "status": "Invalid", 
    "last_updated": "2012-02-21 09:14:06.329067+00:00", 
    "description": "I have nova working with one fixed_ip network\n\nI try to add another network with this command and associate it to the project:\nnova-manage network create --fixed_range_v4=192.168.20.0/24 --project_id=bc955aeac4ff4e0db0bbf10320ec3772 --label=project2 --gateway=192.168.20.1 --dns1=8.8.8.8 --multi_host=T --bridge=br311 --bridge_interface=eth0.311\n\nWhen I delete the network\nnova-manage project scrub  bc955aeac4ff4e0db0bbf10320ec3772\nnova-manage network delete 192.168.20.0/24\n\nAfter that the machines have problems getting their data from nova-api, which renders error 500 and complains about the network I just deleted:\n\n\n\n2012-02-21 00:25:25,268 ERROR nova.api.openstack [req-dd66a3ca-9eb2-4245-b0fe-aa09bd2411f4 5a1ca31069f84cd5af8b0407e99b984d fbd5f9d379dd46c4bc932aa90896f826] Caught error: Remote error: NetworkNotFound Network 3 could not be found.\n[u'Traceback (most recent call last):\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 244, in _process_data\\n    rval = node_func(context=ctxt, **node_args)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 200, in wrapped\\n    return func(self, context, *args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 873, in get_instance_nw_info\\n    network = self._get_network_by_id(context, vif[\\'network_id\\'])\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 1606, in _get_network_by_id\\n    network_id)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 1470, in _get_network_by_id\\n    return self.db.network_get(context, network_id)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 813, in network_get\\n    return IMPL.network_get(context, network_id)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 119, in wrapper\\n    return f(*args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 2025, in network_get\\n    raise exception.NetworkNotFound(network_id=network_id)\\n', u'NetworkNotFound: Network 3 could not be found.\\n'].\n(nova.api.openstack): TRACE: Traceback (most recent call last):\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/__init__.py\", line 41, in __call__\n(nova.api.openstack): TRACE:     return req.get_response(self.application)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1053, in get_response\n(nova.api.openstack): TRACE:     application, catch_exc_info=False)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1022, in call_application\n(nova.api.openstack): TRACE:     app_iter = application(self.environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 345, in __call__\n(nova.api.openstack): TRACE:     return self._forward_request(env, start_response, proxy_headers)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 608, in _forward_request\n(nova.api.openstack): TRACE:     return self.app(env, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/routes/middleware.py\", line 131, in __call__\n(nova.api.openstack): TRACE:     response = self.app(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 147, in __call__\n(nova.api.openstack): TRACE:     resp = self.call_func(req, *args, **self.kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 208, in call_func\n(nova.api.openstack): TRACE:     return self.func(req, *args, **kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 834, in __call__\n(nova.api.openstack): TRACE:     action_result = self.dispatch(meth, request, action_args)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 908, in dispatch\n(nova.api.openstack): TRACE:     return method(req=request, **action_args)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/servers.py\", line 383, in detail\n(nova.api.openstack): TRACE:     servers = self._get_servers(req, is_detail=True)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/servers.py\", line 459, in _get_servers\n(nova.api.openstack): TRACE:     return self._view_builder.detail(req, limited_list)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/views/servers.py\", line 123, in detail\n(nova.api.openstack): TRACE:     return self._list_view(self.show, request, instances)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/views/servers.py\", line 127, in _list_view\n(nova.api.openstack): TRACE:     server_list = [func(request, server)[\"server\"] for server in servers]\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/views/servers.py\", line 61, in wrapped\n(nova.api.openstack): TRACE:     return func(self, request, instance)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/views/servers.py\", line 100, in show\n(nova.api.openstack): TRACE:     \"addresses\": self._get_addresses(request, instance),\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/views/servers.py\", line 154, in _get_addresses\n(nova.api.openstack): TRACE:     networks = common.get_networks_for_instance(context, instance)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/common.py\", line 366, in get_networks_for_instance\n(nova.api.openstack): TRACE:     return get_networks_for_instance_from_nwinfo(context, instance)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/common.py\", line 324, in get_networks_for_instance_from_nwinfo\n(nova.api.openstack): TRACE:     nw_info = network_api.get_instance_nw_info(context, instance)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/network/api.py\", line 198, in get_instance_nw_info\n(nova.api.openstack): TRACE:     'args': args})\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/__init__.py\", line 61, in call\n(nova.api.openstack): TRACE:     return _get_impl().call(context, topic, msg)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/impl_kombu.py\", line 605, in call\n(nova.api.openstack): TRACE:     return rpc_amqp.call(context, topic, msg)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 328, in call\n(nova.api.openstack): TRACE:     rv = list(rv)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 296, in __iter__\n(nova.api.openstack): TRACE:     raise result\n(nova.api.openstack): TRACE: RemoteError: Remote error: NetworkNotFound Network 3 could not be found.\n\nTo make it work again, I need to re-add the network and change its id=3 in the database.\n\nthis happens with this version of nova:\n2012.1~e3-0ubuntu0~ppa1~oneiric1", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/937336", 
    "owner": "None", 
    "id": 937336, 
    "index": 2596, 
    "created": "2012-02-21 00:31:23.009095+00:00", 
    "title": "Nova-api stops working after deleting a network", 
    "comments": [
        {
            "content": "I have nova working with one fixed_ip network\n\nI try to add another network with this command and associate it to the project:\nnova-manage network create --fixed_range_v4=192.168.20.0/24 --project_id=bc955aeac4ff4e0db0bbf10320ec3772 --label=project2 --gateway=192.168.20.1 --dns1=8.8.8.8 --multi_host=T --bridge=br311 --bridge_interface=eth0.311\n\nWhen I delete the network\nnova-manage project scrub  bc955aeac4ff4e0db0bbf10320ec3772\nnova-manage network delete 192.168.20.0/24\n\nAfter that the machines have problems getting their data from nova-api, which renders error 500 and complains about the network I just deleted:\n\n\n\n2012-02-21 00:25:25,268 ERROR nova.api.openstack [req-dd66a3ca-9eb2-4245-b0fe-aa09bd2411f4 5a1ca31069f84cd5af8b0407e99b984d fbd5f9d379dd46c4bc932aa90896f826] Caught error: Remote error: NetworkNotFound Network 3 could not be found.\n[u'Traceback (most recent call last):\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 244, in _process_data\\n    rval = node_func(context=ctxt, **node_args)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 200, in wrapped\\n    return func(self, context, *args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 873, in get_instance_nw_info\\n    network = self._get_network_by_id(context, vif[\\'network_id\\'])\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 1606, in _get_network_by_id\\n    network_id)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 1470, in _get_network_by_id\\n    return self.db.network_get(context, network_id)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 813, in network_get\\n    return IMPL.network_get(context, network_id)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 119, in wrapper\\n    return f(*args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 2025, in network_get\\n    raise exception.NetworkNotFound(network_id=network_id)\\n', u'NetworkNotFound: Network 3 could not be found.\\n'].\n(nova.api.openstack): TRACE: Traceback (most recent call last):\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/__init__.py\", line 41, in __call__\n(nova.api.openstack): TRACE:     return req.get_response(self.application)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1053, in get_response\n(nova.api.openstack): TRACE:     application, catch_exc_info=False)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1022, in call_application\n(nova.api.openstack): TRACE:     app_iter = application(self.environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 345, in __call__\n(nova.api.openstack): TRACE:     return self._forward_request(env, start_response, proxy_headers)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 608, in _forward_request\n(nova.api.openstack): TRACE:     return self.app(env, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/routes/middleware.py\", line 131, in __call__\n(nova.api.openstack): TRACE:     response = self.app(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 147, in __call__\n(nova.api.openstack): TRACE:     resp = self.call_func(req, *args, **self.kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 208, in call_func\n(nova.api.openstack): TRACE:     return self.func(req, *args, **kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 834, in __call__\n(nova.api.openstack): TRACE:     action_result = self.dispatch(meth, request, action_args)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 908, in dispatch\n(nova.api.openstack): TRACE:     return method(req=request, **action_args)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/servers.py\", line 383, in detail\n(nova.api.openstack): TRACE:     servers = self._get_servers(req, is_detail=True)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/servers.py\", line 459, in _get_servers\n(nova.api.openstack): TRACE:     return self._view_builder.detail(req, limited_list)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/views/servers.py\", line 123, in detail\n(nova.api.openstack): TRACE:     return self._list_view(self.show, request, instances)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/views/servers.py\", line 127, in _list_view\n(nova.api.openstack): TRACE:     server_list = [func(request, server)[\"server\"] for server in servers]\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/views/servers.py\", line 61, in wrapped\n(nova.api.openstack): TRACE:     return func(self, request, instance)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/views/servers.py\", line 100, in show\n(nova.api.openstack): TRACE:     \"addresses\": self._get_addresses(request, instance),\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/views/servers.py\", line 154, in _get_addresses\n(nova.api.openstack): TRACE:     networks = common.get_networks_for_instance(context, instance)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/common.py\", line 366, in get_networks_for_instance\n(nova.api.openstack): TRACE:     return get_networks_for_instance_from_nwinfo(context, instance)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/common.py\", line 324, in get_networks_for_instance_from_nwinfo\n(nova.api.openstack): TRACE:     nw_info = network_api.get_instance_nw_info(context, instance)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/network/api.py\", line 198, in get_instance_nw_info\n(nova.api.openstack): TRACE:     'args': args})\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/__init__.py\", line 61, in call\n(nova.api.openstack): TRACE:     return _get_impl().call(context, topic, msg)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/impl_kombu.py\", line 605, in call\n(nova.api.openstack): TRACE:     return rpc_amqp.call(context, topic, msg)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 328, in call\n(nova.api.openstack): TRACE:     rv = list(rv)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 296, in __iter__\n(nova.api.openstack): TRACE:     raise result\n(nova.api.openstack): TRACE: RemoteError: Remote error: NetworkNotFound Network 3 could not be found.\n\nTo make it work again, I need to re-add the network and change its id=3 in the database.\n\nthis happens with this version of nova:\n2012.1~e3-0ubuntu0~ppa1~oneiric1", 
            "date_created": "2012-02-21 00:31:23.009095+00:00", 
            "author": "https://api.launchpad.net/1.0/~linuxdatacenter"
        }
    ]
}