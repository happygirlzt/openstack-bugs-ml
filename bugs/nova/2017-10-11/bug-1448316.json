{
    "status": "Invalid", 
    "last_updated": "2017-09-27 17:10:02.984403+00:00", 
    "description": "http://logs.openstack.org/58/175458/3/check/check-tempest-dsvm-cells/ce91d7e/logs/screen-n-api.txt.gz?level=TRACE#_2015-04-24_15_21_05_563\n\n2015-04-24 15:21:05.563 ERROR nova.api.openstack [req-99d82867-7bd3-4ca7-9102-27bacb4ab6a0 ListServersNegativeTestJSON-1811537006 ListServersNegativeTestJSON-968745101] Caught error: Object action destroy failed because: host changed\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack Traceback (most recent call last):\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/__init__.py\", line 125, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return req.get_response(self.application)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1317, in send\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     application, catch_exc_info=False)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1281, in call_application\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py\", line 639, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return self._call_app(env, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py\", line 559, in _call_app\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return self._app(env, _fake_start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/routes/middleware.py\", line 136, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 756, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     content_type, body, accept)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 821, in _process_stack\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 911, in dispatch\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return method(req=request, **action_args)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/compute/servers.py\", line 834, in delete\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     self._delete(req.environ['nova.context'], req, id)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/compute/servers.py\", line 669, in _delete\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     self.compute_api.delete(context, instance)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/compute/cells_api.py\", line 212, in delete\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     self._handle_cell_delete(context, instance, 'delete')\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/compute/cells_api.py\", line 226, in _handle_cell_delete\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     self._do_delete)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/compute/api.py\", line 1766, in _local_delete\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     instance.destroy()\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/objects/base.py\", line 208, in wrapper\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return fn(self, *args, **kwargs)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/objects/instance.py\", line 646, in destroy\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     reason='host changed')\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack ObjectActionError: Object action destroy failed because: host changed\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack \n\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiX2hhbmRsZV9jZWxsX2RlbGV0ZVwiIEFORCBtZXNzYWdlOlwiT2JqZWN0QWN0aW9uRXJyb3I6IE9iamVjdCBhY3Rpb24gZGVzdHJveSBmYWlsZWQgYmVjYXVzZTogaG9zdCBjaGFuZ2VkXCIgQU5EIHRhZ3M6XCJzY3JlZW4tbi1hcGkudHh0XCIiLCJmaWVsZHMiOltdLCJvZmZzZXQiOjAsInRpbWVmcmFtZSI6IjYwNDgwMCIsImdyYXBobW9kZSI6ImNvdW50IiwidGltZSI6eyJ1c2VyX2ludGVydmFsIjowfSwic3RhbXAiOjE0Mjk5MDk4OTQ5NDl9\n\n21 hits in 7 days.  It's 90% failure when it happens though.\n\nI also noticed this in the compute logs:\n\nhttp://logs.openstack.org/58/175458/3/check/check-tempest-dsvm-cells/ce91d7e/logs/screen-n-cpu.txt.gz?level=TRACE#_2015-04-24_15_16_26_866\n\nA separate query on that shows it happens quite a bit though in normal gate runs:\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiTm8gY29tcHV0ZSBub2RlIHJlY29yZCBmb3IgaG9zdFwiIEFORCB0YWdzOlwic2NyZWVuLW4tY3B1LnR4dFwiIiwiZmllbGRzIjpbXSwib2Zmc2V0IjowLCJ0aW1lZnJhbWUiOiI2MDQ4MDAiLCJncmFwaG1vZGUiOiJjb3VudCIsInRpbWUiOnsidXNlcl9pbnRlcnZhbCI6MH0sInN0YW1wIjoxNDI5OTA4OTUwOTE2LCJtb2RlIjoiIiwiYW5hbHl6ZV9maWVsZCI6IiJ9", 
    "tags": [
        "cells", 
        "unified-objects"
    ], 
    "importance": "Medium", 
    "heat": 14, 
    "link": "https://bugs.launchpad.net/nova/+bug/1448316", 
    "owner": "None", 
    "id": 1448316, 
    "index": 4236, 
    "created": "2015-04-24 21:16:50.444491+00:00", 
    "title": "cells: Object action destroy failed because: host changed", 
    "comments": [
        {
            "content": "http://logs.openstack.org/58/175458/3/check/check-tempest-dsvm-cells/ce91d7e/logs/screen-n-api.txt.gz?level=TRACE#_2015-04-24_15_21_05_563\n\n2015-04-24 15:21:05.563 ERROR nova.api.openstack [req-99d82867-7bd3-4ca7-9102-27bacb4ab6a0 ListServersNegativeTestJSON-1811537006 ListServersNegativeTestJSON-968745101] Caught error: Object action destroy failed because: host changed\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack Traceback (most recent call last):\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/__init__.py\", line 125, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return req.get_response(self.application)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1317, in send\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     application, catch_exc_info=False)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1281, in call_application\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py\", line 639, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return self._call_app(env, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py\", line 559, in _call_app\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return self._app(env, _fake_start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/routes/middleware.py\", line 136, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 756, in __call__\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     content_type, body, accept)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 821, in _process_stack\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 911, in dispatch\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return method(req=request, **action_args)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/compute/servers.py\", line 834, in delete\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     self._delete(req.environ['nova.context'], req, id)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/compute/servers.py\", line 669, in _delete\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     self.compute_api.delete(context, instance)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/compute/cells_api.py\", line 212, in delete\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     self._handle_cell_delete(context, instance, 'delete')\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/compute/cells_api.py\", line 226, in _handle_cell_delete\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     self._do_delete)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/compute/api.py\", line 1766, in _local_delete\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     instance.destroy()\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/objects/base.py\", line 208, in wrapper\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     return fn(self, *args, **kwargs)\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/objects/instance.py\", line 646, in destroy\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack     reason='host changed')\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack ObjectActionError: Object action destroy failed because: host changed\n2015-04-24 15:21:05.563 32393 TRACE nova.api.openstack \n\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiX2hhbmRsZV9jZWxsX2RlbGV0ZVwiIEFORCBtZXNzYWdlOlwiT2JqZWN0QWN0aW9uRXJyb3I6IE9iamVjdCBhY3Rpb24gZGVzdHJveSBmYWlsZWQgYmVjYXVzZTogaG9zdCBjaGFuZ2VkXCIgQU5EIHRhZ3M6XCJzY3JlZW4tbi1hcGkudHh0XCIiLCJmaWVsZHMiOltdLCJvZmZzZXQiOjAsInRpbWVmcmFtZSI6IjYwNDgwMCIsImdyYXBobW9kZSI6ImNvdW50IiwidGltZSI6eyJ1c2VyX2ludGVydmFsIjowfSwic3RhbXAiOjE0Mjk5MDk4OTQ5NDl9\n\n21 hits in 7 days.  It's 90% failure when it happens though.\n\nI also noticed this in the compute logs:\n\nhttp://logs.openstack.org/58/175458/3/check/check-tempest-dsvm-cells/ce91d7e/logs/screen-n-cpu.txt.gz?level=TRACE#_2015-04-24_15_16_26_866\n\nA separate query on that shows it happens quite a bit though in normal gate runs:\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiTm8gY29tcHV0ZSBub2RlIHJlY29yZCBmb3IgaG9zdFwiIEFORCB0YWdzOlwic2NyZWVuLW4tY3B1LnR4dFwiIiwiZmllbGRzIjpbXSwib2Zmc2V0IjowLCJ0aW1lZnJhbWUiOiI2MDQ4MDAiLCJncmFwaG1vZGUiOiJjb3VudCIsInRpbWUiOnsidXNlcl9pbnRlcnZhbCI6MH0sInN0YW1wIjoxNDI5OTA4OTUwOTE2LCJtb2RlIjoiIiwiYW5hbHl6ZV9maWVsZCI6IiJ9", 
            "date_created": "2015-04-24 21:16:50.444491+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "By investigating a separate issue,  we know that the following pattern (ie. calling twice an instance.save() method) can be racy :\nhttps://github.com/openstack/tempest/blob/2b7373dbb1524ff7be4165714678fdd2fac41590/tempest/api/compute/servers/test_list_servers_negative.py#L45-L46\n\nI just wonder how much https://review.openstack.org/#/c/177356/ could help", 
            "date_created": "2015-04-24 22:02:03.962704+00:00", 
            "author": "https://api.launchpad.net/1.0/~sylvain-bauza"
        }, 
        {
            "content": "This is not only showing up with cells jobs:\n\nhttp://goo.gl/qZs8C3\n\nIt looks like it started ramping up hits after 5/16.", 
            "date_created": "2015-05-20 16:35:27.513464+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "This merged on 5/15 and hits the delete path in compute API, and is a bit ugly, so I'm wondering if it introduced a regression:\n\nhttps://review.openstack.org/#/c/145738/\n\n^ also looks like the cause for a spike in bug 1456771.", 
            "date_created": "2015-05-20 16:43:13.468185+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/184554", 
            "date_created": "2015-05-20 17:36:27.417484+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/184554\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=1ba72081715869fe6d0ffba3436fb09ef9499335\nSubmitter: Jenkins\nBranch:    master\n\ncommit 1ba72081715869fe6d0ffba3436fb09ef9499335\nAuthor: Matt Riedemann <email address hidden>\nDate:   Wed May 20 17:36:21 2015 +0000\n\n    Revert \"Detach volume after deleting instance with no host\"\n    \n    This reverts commit d1baa9fe7eb342b63fc85cbb5ef70bb676de6566\n    \n    The change introduced a race on delete where there isn't a host while\n    prepping block devices and we hit a NoneType error in nova-compute.\n    \n    There was also a recheck grind on the original change showing it wasn't\n    safe and needs to be reworked.\n    \n    Change-Id: Id4e405e7579530ed1c1f22ccc972d45b6d185f41\n    Closes-Bug: #1456771\n    Related-Bug: #1448316\n", 
            "date_created": "2015-05-20 21:07:42.724559+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This was either fixed by 1ba72081715869fe6d0ffba3436fb09ef9499335 or is a latent issue in cells v1 which we aren't going to focus on fixing since cells v1 is deprecated and will hopefully be removed in the Rocky release.", 
            "date_created": "2017-09-27 17:10:02.000735+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }
    ]
}