{
    "status": "Invalid", 
    "last_updated": "2014-09-29 01:03:27.227292+00:00", 
    "description": "I got following error.\n\nroot@localhost:~# nova --debug list\nconnect: (keystone.thefreecloud.org, 5000)\nsend: 'POST /v2.0/tokens HTTP/1.1\\r\\nHost: keystone.thefreecloud.org:5000\\r\\nContent-Length: 108\\r\\ncontent-type: application/json\\r\\naccept-encoding: gzip, deflate\\r\\nuser-agent: python-novaclient\\r\\n\\r\\n{\"auth\": {\"tenantName\": \"admin\", \"passwordCredentials\": {\"username\": \"admin\", \"password\": \"XXXXXXXXX\"}}}'\nreply: 'HTTP/1.1 200 OK\\r\\n'\nheader: Content-Type: application/json; charset=UTF-8\nheader: Content-Length: 1148\nheader: Date: Fri, 24 Feb 2012 16:13:00 GMT\nconnect: (nova-api.thefreecloud.org, 8774)\nsend: u'GET /v1.1/1/servers/detail HTTP/1.1\\r\\nHost: nova-api.thefreecloud.org:8774\\r\\nx-auth-project-id: admin\\r\\nx-auth-token: XXXXXXXXXXXXXXXXXX g\\r\\naccept-encoding: gzip, deflate\\r\\nuser-agent: python-novaclient\\r\\n\\r\\n'\nreply: 'HTTP/1.1 500 Internal Server Error\\r\\n'\nheader: Content-Length: 133\nheader: Content-Type: application/json; charset=UTF-8\nheader: Date: Fri, 24 Feb 2012 16:13:00 GMT\nTraceback (most recent call last):\n  File \"/usr/local/bin/nova\", line 9, in <module>\n    load_entry_point('python-novaclient==2012.1', 'console_scripts', 'nova')()\n  File \"/usr/lib/python2.7/dist-packages/novaclient/shell.py\", line 338, in main\n    OpenStackComputeShell().main(sys.argv[1:])\n  File \"/usr/lib/python2.7/dist-packages/novaclient/shell.py\", line 289, in main\n    args.func(self.cs, args)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/v1_1/shell.py\", line 480, in do_list\n    utils.print_list(cs.servers.list(search_opts=search_opts), columns,\n  File \"/usr/lib/python2.7/dist-packages/novaclient/v1_1/servers.py\", line 247, in list\n    return self._list(\"/servers%s%s\" % (detail, query_string), \"servers\")\n  File \"/usr/lib/python2.7/dist-packages/novaclient/base.py\", line 69, in _list\n    resp, body = self.api.client.get(url)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/client.py\", line 130, in get\n    return self._cs_request(url, 'GET', **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/client.py\", line 118, in _cs_request\n    **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/client.py\", line 101, in request\n    raise exceptions.from_response(resp, body)\nnovaclient.exceptions.ClientException: The server has either erred or is incapable of performing the requested operation. (HTTP 500)\n\nI got error \n\n byte 0xe7 in position 8: unexpected end of data\n(nova.api.openstack): TRACE: Traceback (most recent call last):\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 64, in __call__\n(nova.api.openstack): TRACE:     return req.get_response(self.application)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/request.py\", line 1053, in get_response\n(nova.api.openstack): TRACE:     application, catch_exc_info=False)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/request.py\", line 1022, in call_application\n(nova.api.openstack): TRACE:     app_iter = application(self.environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 212, in __call__\n(nova.api.openstack): TRACE:     return self._forward_request(env, start_response, proxy_headers)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 344, in _forward_request\n(nova.api.openstack): TRACE:     return self.app(env, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/routes/middleware.py\", line 131, in __call__\n(nova.api.openstack): TRACE:     response = self.app(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/routes/middleware.py\", line 131, in __call__\n(nova.api.openstack): TRACE:     response = self.app(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 147, in __call__\n(nova.api.openstack): TRACE:     resp = self.call_func(req, *args, **self.kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 208, in call_func\n(nova.api.openstack): TRACE:     return self.func(req, *args, **kwargs)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 508, in __call__\n(nova.api.openstack): TRACE:     action=action)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 428, in serialize\n(nova.api.openstack): TRACE:     self.serialize_body(response, response_data, content_type, action)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 438, in serialize_body\n(nova.api.openstack): TRACE:     response.body = serializer.serialize(data, action)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 283, in serialize\n(nova.api.openstack): TRACE:     return self.dispatch(data, action=action)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 70, in dispatch\n(nova.api.openstack): TRACE:     return action_method(*args, **kwargs)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 293, in default\n(nova.api.openstack): TRACE:     return utils.dumps(data)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/utils.py\", line 604, in dumps\n(nova.api.openstack): TRACE:     return json.dumps(value)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/json/__init__.py\", line 231, in dumps\n(nova.api.openstack): TRACE:     return _default_encoder.encode(obj)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/json/encoder.py\", line 201, in encode\n(nova.api.openstack): TRACE:     chunks = self.iterencode(o, _one_shot=True)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/json/encoder.py\", line 264, in iterencode\n(nova.api.openstack): TRACE:     return _iterencode(o, 0)\n(nova.api.openstack): TRACE: UnicodeDecodeError: 'utf8' codec can't decode byte 0xe7 in position 8: unexpected end of data\n(nova.api.openstack): TRACE:\n\nnova --debug image-list was OK\n\nI could reproduce this error with curl.\ncurl -H \"x-auth-token: XXXXXXXXXXXXXXXXXXXXXXX\" https://nova-api.trystack.org:9774/v1.1/1/servers/detail --insecure\n{\"cloudServersFault\": {\"message\": \"The server has either erred or is incapable of performing the requested operation.\", \"code\": 500}}\n\n\nThen I checked instance name,\nSELECT id,display_name FROM `instances`\n\nThen I found an instance use uft08 char in display name.\nI removed this instance, then nova list command back to normal.\n\nnova-api should check UTF8 char in parameters", 
    "tags": [
        "api"
    ], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/940430", 
    "owner": "None", 
    "id": 940430, 
    "index": 2770, 
    "created": "2012-02-24 16:33:13.299626+00:00", 
    "title": "nova-api should check UTF8 char in parameters", 
    "comments": [
        {
            "content": "I got following error.\n\nroot@localhost:~# nova --debug list\nconnect: (keystone.thefreecloud.org, 5000)\nsend: 'POST /v2.0/tokens HTTP/1.1\\r\\nHost: keystone.thefreecloud.org:5000\\r\\nContent-Length: 108\\r\\ncontent-type: application/json\\r\\naccept-encoding: gzip, deflate\\r\\nuser-agent: python-novaclient\\r\\n\\r\\n{\"auth\": {\"tenantName\": \"admin\", \"passwordCredentials\": {\"username\": \"admin\", \"password\": \"XXXXXXXXX\"}}}'\nreply: 'HTTP/1.1 200 OK\\r\\n'\nheader: Content-Type: application/json; charset=UTF-8\nheader: Content-Length: 1148\nheader: Date: Fri, 24 Feb 2012 16:13:00 GMT\nconnect: (nova-api.thefreecloud.org, 8774)\nsend: u'GET /v1.1/1/servers/detail HTTP/1.1\\r\\nHost: nova-api.thefreecloud.org:8774\\r\\nx-auth-project-id: admin\\r\\nx-auth-token: XXXXXXXXXXXXXXXXXX g\\r\\naccept-encoding: gzip, deflate\\r\\nuser-agent: python-novaclient\\r\\n\\r\\n'\nreply: 'HTTP/1.1 500 Internal Server Error\\r\\n'\nheader: Content-Length: 133\nheader: Content-Type: application/json; charset=UTF-8\nheader: Date: Fri, 24 Feb 2012 16:13:00 GMT\nTraceback (most recent call last):\n  File \"/usr/local/bin/nova\", line 9, in <module>\n    load_entry_point('python-novaclient==2012.1', 'console_scripts', 'nova')()\n  File \"/usr/lib/python2.7/dist-packages/novaclient/shell.py\", line 338, in main\n    OpenStackComputeShell().main(sys.argv[1:])\n  File \"/usr/lib/python2.7/dist-packages/novaclient/shell.py\", line 289, in main\n    args.func(self.cs, args)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/v1_1/shell.py\", line 480, in do_list\n    utils.print_list(cs.servers.list(search_opts=search_opts), columns,\n  File \"/usr/lib/python2.7/dist-packages/novaclient/v1_1/servers.py\", line 247, in list\n    return self._list(\"/servers%s%s\" % (detail, query_string), \"servers\")\n  File \"/usr/lib/python2.7/dist-packages/novaclient/base.py\", line 69, in _list\n    resp, body = self.api.client.get(url)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/client.py\", line 130, in get\n    return self._cs_request(url, 'GET', **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/client.py\", line 118, in _cs_request\n    **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/client.py\", line 101, in request\n    raise exceptions.from_response(resp, body)\nnovaclient.exceptions.ClientException: The server has either erred or is incapable of performing the requested operation. (HTTP 500)\n\nI got error \n\n byte 0xe7 in position 8: unexpected end of data\n(nova.api.openstack): TRACE: Traceback (most recent call last):\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 64, in __call__\n(nova.api.openstack): TRACE:     return req.get_response(self.application)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/request.py\", line 1053, in get_response\n(nova.api.openstack): TRACE:     application, catch_exc_info=False)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/request.py\", line 1022, in call_application\n(nova.api.openstack): TRACE:     app_iter = application(self.environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 212, in __call__\n(nova.api.openstack): TRACE:     return self._forward_request(env, start_response, proxy_headers)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 344, in _forward_request\n(nova.api.openstack): TRACE:     return self.app(env, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/routes/middleware.py\", line 131, in __call__\n(nova.api.openstack): TRACE:     response = self.app(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/routes/middleware.py\", line 131, in __call__\n(nova.api.openstack): TRACE:     response = self.app(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 147, in __call__\n(nova.api.openstack): TRACE:     resp = self.call_func(req, *args, **self.kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.7/webob/dec.py\", line 208, in call_func\n(nova.api.openstack): TRACE:     return self.func(req, *args, **kwargs)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 508, in __call__\n(nova.api.openstack): TRACE:     action=action)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 428, in serialize\n(nova.api.openstack): TRACE:     self.serialize_body(response, response_data, content_type, action)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 438, in serialize_body\n(nova.api.openstack): TRACE:     response.body = serializer.serialize(data, action)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 283, in serialize\n(nova.api.openstack): TRACE:     return self.dispatch(data, action=action)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 70, in dispatch\n(nova.api.openstack): TRACE:     return action_method(*args, **kwargs)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 293, in default\n(nova.api.openstack): TRACE:     return utils.dumps(data)\n(nova.api.openstack): TRACE:   File \"/opt/stack/nova/nova/utils.py\", line 604, in dumps\n(nova.api.openstack): TRACE:     return json.dumps(value)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/json/__init__.py\", line 231, in dumps\n(nova.api.openstack): TRACE:     return _default_encoder.encode(obj)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/json/encoder.py\", line 201, in encode\n(nova.api.openstack): TRACE:     chunks = self.iterencode(o, _one_shot=True)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/json/encoder.py\", line 264, in iterencode\n(nova.api.openstack): TRACE:     return _iterencode(o, 0)\n(nova.api.openstack): TRACE: UnicodeDecodeError: 'utf8' codec can't decode byte 0xe7 in position 8: unexpected end of data\n(nova.api.openstack): TRACE:\n\nnova --debug image-list was OK\n\nI could reproduce this error with curl.\ncurl -H \"x-auth-token: XXXXXXXXXXXXXXXXXXXXXXX\" https://nova-api.trystack.org:9774/v1.1/1/servers/detail --insecure\n{\"cloudServersFault\": {\"message\": \"The server has either erred or is incapable of performing the requested operation.\", \"code\": 500}}\n\n\nThen I checked instance name,\nSELECT id,display_name FROM `instances`\n\nThen I found an instance use uft08 char in display name.\nI removed this instance, then nova list command back to normal.\n\nnova-api should check UTF8 char in parameters", 
            "date_created": "2012-02-24 16:33:13.299626+00:00", 
            "author": "https://api.launchpad.net/1.0/~nati-ueno"
        }, 
        {
            "content": "By utf8 char, I think you mean non ASCII char.\nIn fact utf8 chars are handled by default:\n\n>>> json.dumps(u\"\\xe7\")\n'\"\\\\u00e7\"'\n>>> json.dumps(u\"\\xe7\".encode(\"utf8\"))\n'\"\\\\u00e7\"'\n>>> json.dumps(\"\\xe7\", encoding=\"iso8859-1\")\n'\"\\\\u00e7\"'\n>>> json.dumps(\"\\xe7\")\nUnicodeDecodeError: 'utf8' codec can't decode byte 0xe7 in position 0: unexpected end of data\n\nSo well need to convert this string to utf8 or unicode\nI'll take a look at where best to do this conversion", 
            "date_created": "2012-02-24 17:31:48.541998+00:00", 
            "author": "https://api.launchpad.net/1.0/~p-draigbrady"
        }, 
        {
            "content": "Padraig: if you're not working on this, remove assignee and set back status to 'Confirmed'", 
            "date_created": "2012-06-07 12:01:33.192821+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "Looks like you're not working on that anymore. Please set back to InProgress and reassign to you if you're working on proposing a change for merging.", 
            "date_created": "2012-12-13 14:45:39.416468+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "I think this might be in the API also.\n\nhttps://bugs.launchpad.net/nova/+bug/1160487\n\nIts not as easy to trigger there, but the API itself sends massive queries back and forth when a large number of instances exist under  a given user, basically DOSing the nova-api process...", 
            "date_created": "2013-03-29 00:00:05.220943+00:00", 
            "author": "https://api.launchpad.net/1.0/~harlowja"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/39326", 
            "date_created": "2013-07-30 16:39:28.259837+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "I have seen similar errors before.  I suspect the configuration of your database is the issue.  Check the charset it's using.\n\nAFAIK, UTF8 server names are permissible.\n", 
            "date_created": "2013-08-01 20:07:30.725872+00:00", 
            "author": "https://api.launchpad.net/1.0/~belliott"
        }, 
        {
            "content": "I think that UTF8 server name will be permissible by modify the utils.py. but I was thinking that I must be changing the api after read the bug description. Do you think that permitting the UTF8 type server name is better?", 
            "date_created": "2013-08-02 05:41:50.772684+00:00", 
            "author": "https://api.launchpad.net/1.0/~ehwlstme"
        }, 
        {
            "content": "I think UTF8 server name will be permissible by modify the utils.py. but My opinion is instance will not being created, if instance name is UTF8 type.  Do you think that permitting the UTF8 is better than modyfing API?\r\n\r\nalso, I think this error is not my database configuration problem. My database configuration is UTF8 type.", 
            "date_created": "2013-08-02 07:09:00.649000+00:00", 
            "author": "https://api.launchpad.net/1.0/~ehwlstme"
        }, 
        {
            "content": "If create instance by UTF8 type name, host name of instance is not exist. so I think that not being creation is better way, if the instance name is UTF8 type. Do you think that permitting the UTF8 is better than modyfing API?\r\n\r\nAlso, I think this error is not my database configuration problem. My database configuration is UTF8 type.\r\n", 
            "date_created": "2013-08-02 08:00:43.787532+00:00", 
            "author": "https://api.launchpad.net/1.0/~ehwlstme"
        }, 
        {
            "content": "In my devstack environment, it can be reproduced by booting an instance with name contains utf8 char and then listing instances while the charset of database is utf8.", 
            "date_created": "2013-08-02 08:05:58.696754+00:00", 
            "author": "https://api.launchpad.net/1.0/~gochist"
        }, 
        {
            "content": "If create instance by UTF8 type name, host name of instance is default empty value(not display_name). so I think that not being creation is better way, if the instance name is UTF8 type. Do you think that permitting the UTF8 is better than modyfing API?\r\n\r\nAlso, I think this error is not my database configuration problem. My database configuration is UTF8 type.\r\n", 
            "date_created": "2013-08-02 08:17:10.874588+00:00", 
            "author": "https://api.launchpad.net/1.0/~ehwlstme"
        }, 
        {
            "content": "Okay, not sure why this is occurring then.  I feel that removing support for UTF8 names is the wrong approach, though.", 
            "date_created": "2013-08-06 14:14:04.122854+00:00", 
            "author": "https://api.launchpad.net/1.0/~belliott"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/42054", 
            "date_created": "2013-08-15 04:32:09.704272+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This doesn't appear to be reproducible anymore and we now handle utf8 host names correctly\n", 
            "date_created": "2014-09-29 01:03:09.323825+00:00", 
            "author": "https://api.launchpad.net/1.0/~cyeoh-0"
        }
    ]
}