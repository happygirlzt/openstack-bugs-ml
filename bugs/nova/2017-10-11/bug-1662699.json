{
    "status": "Fix Released", 
    "last_updated": "2017-06-16 17:36:42.208631+00:00", 
    "description": "Description\n===========\n\nThe documentation for block device mapping in http://docs.openstack.org/developer/nova/block_device_mapping.html#block-device-mapping-v2 indicates that to attach a volume to a new instance without booting from that volume a boot_index value of None can be passed. Shade was doing this, and it works against some clouds (at least DreamHosts's iad2 cloud, \"dreamcompute\", which is running either mitaka or newton). It does not work against nova at least as of 9ae5b2306b7a7cc9e77c77292256b13926920ead launched with devstack.\n\nSteps to reproduce\n==================\n\n1. Run devstack.\n2. Download the downpour git repo from https://github.com/dhellmann/downpour\n3. Use the tiny.yml playbook in the demo directory to launch an instance (see the README for some setup instructions).\n\nExpected Result\n===============\n\nOne new instance named downpour-demo-tiny booted ephemeral with a new volume named downpour-demo-tiny attached to it.\n\nActual Result\n=============\n\nError message: Invalid input for field/attribute boot_index. Value: None. None is not of type 'integer'\n\nAdditional Info\n===============\n\nIRC logs from 7 Feb 2017 in #openstack-nova\n\n[Tue 05:29:35 PM]  <mordred>\tmriedem: so - I've got this question about boot from volume\n[Tue 05:30:51 PM]  <mordred>\tmriedem: http://developer.openstack.org/api-ref/compute/?expanded=create-server-detail#create-server says that block_device_mapping_v2.boot_index takes a string and also that None should be used for volumes not used as boot volumes\n[Tue 05:32:00 PM]  <mriedem>\twas just packing up...\n[Tue 05:32:20 PM]  <mordred>\tmriedem: but we just got an error \"Invalid input for field/attribute boot_index. Value: None. None is not of type 'integer\"\n[Tue 05:32:24 PM]  <mriedem>\tmordred: http://docs.openstack.org/developer/nova/block_device_mapping.html might be helpful\n[Tue 05:32:33 PM]  <mordred>\tmriedem: yup. it also says None is valid\n[Tue 05:34:01 PM]  <mriedem>\ti feel like something was just recently changed in the json schema there, is this master?\n[Tue 05:34:17 PM]  <mordred>\tdhellmann: you were doing master devstack?\n[Tue 05:34:30 PM]  <mordred>\tmriedem: I think so yeah?\n[Tue 05:34:43 PM]  <dhellmann>\tmordred : yes, master devstack (from a few hours ago)\n[Tue 05:34:45 PM] mordred\tgoes to look at json schema\n[Tue 05:34:51 PM]  <mriedem> https://github.com/openstack/nova/blob/master/nova/api/openstack/compute/schemas/block_device_mapping.py#L56\n[Tue 05:35:28 PM]  <mordred>\tfantastic\n[Tue 05:36:06 PM]  <mriedem>\twhat's the image and dest type?\n[Tue 05:36:19 PM]  <mriedem>\tsource_type and destination_type i mean\n[Tue 05:37:01 PM]  <mriedem>\tbecause https://github.com/openstack/nova/blob/master/nova/block_device.py#L198\n[Tue 05:37:02 PM]  <dhellmann>\tit's a qcow2 ubuntu image\n[Tue 05:37:16 PM]  <mordred>\tdestination_type would be 'volume'\n[Tue 05:37:22 PM]  <mriedem>\tand source_type is?\n[Tue 05:37:23 PM]  <mriedem>\timage?\n[Tue 05:37:24 PM]  <dhellmann>\tI want to boot it ephemeral  and attach a volume\n[Tue 05:37:47 PM]  <mordred>\tyah- source_type also volume\n[Tue 05:38:01 PM]  <mriedem>\thave you tried omitting boot_index\n[Tue 05:38:02 PM]  <mriedem>\t?\n[Tue 05:38:05 PM]  <mordred>\tyes. that works\n[Tue 05:38:12 PM]  <mordred>\tas does providing -1 or '-1'\n[Tue 05:38:46 PM]  <mordred>\thowever, None worked in the past and is still referneced in the docs ... so maybe there's a bug somewhere, I'm just not sure what to file/write up\n[Tue 05:38:59 PM]  <mordred>\t(we can make shade dtrt by omitting or using -1\n[Tue 05:39:14 PM]  <mriedem>\toomichi: Kevin_Zheng: gmann: alex_xu: do you remember anything recently related to this? ^\n[Tue 05:39:40 PM]  <mriedem>\thttps://review.openstack.org/#/c/410006/\n[Tue 05:40:50 PM]  <mriedem>\tmordred: i wouldn't put a ton of faith in the api-ref docs on this one\n[Tue 05:40:57 PM]  <mordred>\tmriedem: ok\n[Tue 05:41:03 PM]  <mriedem>\ti'd be interested in knowing if it's different on like a liberty install\n[Tue 05:41:29 PM]  <mordred>\tmriedem: None worked against dreamhost - whatever version is running there\n[Tue 05:41:43 PM]  <mriedem>\tmordred: because my guess is the wording in the api-ref was pulled from http://docs.openstack.org/developer/nova/block_device_mapping.html and that's more about the actual object code in nova rather than the API\n[Tue 05:42:05 PM]  <mordred>\tah - k. so it's likely just a docs bug\n[Tue 05:42:06 PM]  <dhellmann>\tdreamhost is either mitaka or newton\n[Tue 05:42:15 PM]  <mriedem>\ti'd file a bug either way so we can investigate\n[Tue 05:42:27 PM]  <dhellmann>\tI can do that\n[Tue 05:42:37 PM]  <mriedem>\tplus, if the api is ok but the docs are wrong, we can use the bug to fix the docs\n[Tue 05:42:50 PM]  <mordred>\tcool.\n[Tue 05:42:52 PM]  <mordred>\tthanks dhellmann !\n[Tue 05:43:10 PM]  <dhellmann>\tthanks, mordred & mriedem \n[Tue 05:45:00 PM]  <mriedem>\talso,\n[Tue 05:45:07 PM]  <mriedem>\ti wonder if you were hitting a nova v2 vs v2.1 endpoint before...\n[Tue 05:45:11 PM]  <mriedem>\tv2 didn't have schema validation\n[Tue 05:45:22 PM]  <mriedem>\tmordred: dhellmann: ^\n[Tue 05:45:39 PM]  <mordred>\toh - it's entirely possible\n[Tue 05:46:06 PM]  <mordred>\tshade is (currently) just piggybacking novaclient which grabs latest microversion aiui\n[Tue 05:46:12 PM]  <mordred>\tI haven't gotten to doing explicit microversion code myself\n[Tue 05:46:29 PM]  <mordred>\t(that'll be next month - expect plenty of questions from me)\n[Tue 05:47:02 PM]  <mriedem>\tthere is where the legacy v2 api bdm v2 stuff happened https://github.com/openstack/nova/blob/liberty-eol/nova/api/openstack/compute/legacy_v2/servers.py#L424\n[Tue 05:47:54 PM]  <mriedem>\twhich only checked boot_index here https://github.com/openstack/nova/blob/liberty-eol/nova/block_device.py#L201\n[Tue 05:48:00 PM]  <mriedem>\tif source_type == 'image' and destination_type == 'local':\n[Tue 05:48:33 PM]  <mriedem>\tand then that dict was probably turned into an object https://github.com/openstack/nova/blob/liberty-eol/nova/objects/block_device.py#L73\n[Tue 05:48:36 PM]  <mriedem>\twhere boot_index can be None\n[Tue 05:49:18 PM]  <mriedem>\tthe compute api did some validation here too https://github.com/openstack/nova/blob/liberty-eol/nova/compute/api.py#L1315\n[Tue 05:49:20 PM]  <mriedem>\ton the object\n[Tue 05:49:22 PM]  <mriedem>\tSO,\n[Tue 05:49:38 PM]  <mriedem>\ti think it just means that the v2.1 API json schema validation regressed from the v2 API validation\n[Tue 05:49:56 PM]  <mriedem>\twould be cool if you guys could confirm that it was working when you were talking to a v2 compute endpoint cloud vs v2.1\n[Tue 05:50:03 PM]  <mriedem>\tbut that'd be my professional opinion\n[Tue 05:50:09 PM]  <mriedem>\tdr debug\n[Tue 05:51:06 PM]  <mriedem>\tdhellmann: i've got to run but just throw ^ into the bug report and i'll check it out later when i'm home", 
    "tags": [
        "api"
    ], 
    "importance": "Medium", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1662699", 
    "owner": "https://api.launchpad.net/1.0/~mriedem", 
    "id": 1662699, 
    "index": 4749, 
    "created": "2017-02-07 22:55:20.795107+00:00", 
    "title": "API documentation and behavior do not match for booting with attached volumes", 
    "comments": [
        {
            "content": "Description\n===========\n\nThe documentation for block device mapping in http://docs.openstack.org/developer/nova/block_device_mapping.html#block-device-mapping-v2 indicates that to attach a volume to a new instance without booting from that volume a boot_index value of None can be passed. Shade was doing this, and it works against some clouds (at least DreamHosts's iad2 cloud, \"dreamcompute\", which is running either mitaka or newton). It does not work against nova at least as of 9ae5b2306b7a7cc9e77c77292256b13926920ead launched with devstack.\n\nSteps to reproduce\n==================\n\n1. Run devstack.\n2. Download the downpour git repo from https://github.com/dhellmann/downpour\n3. Use the tiny.yml playbook in the demo directory to launch an instance (see the README for some setup instructions).\n\nExpected Result\n===============\n\nOne new instance named downpour-demo-tiny booted ephemeral with a new volume named downpour-demo-tiny attached to it.\n\nActual Result\n=============\n\nError message: Invalid input for field/attribute boot_index. Value: None. None is not of type 'integer'\n\nAdditional Info\n===============\n\nIRC logs from 7 Feb 2017 in #openstack-nova\n\n[Tue 05:29:35 PM]  <mordred>\tmriedem: so - I've got this question about boot from volume\n[Tue 05:30:51 PM]  <mordred>\tmriedem: http://developer.openstack.org/api-ref/compute/?expanded=create-server-detail#create-server says that block_device_mapping_v2.boot_index takes a string and also that None should be used for volumes not used as boot volumes\n[Tue 05:32:00 PM]  <mriedem>\twas just packing up...\n[Tue 05:32:20 PM]  <mordred>\tmriedem: but we just got an error \"Invalid input for field/attribute boot_index. Value: None. None is not of type 'integer\"\n[Tue 05:32:24 PM]  <mriedem>\tmordred: http://docs.openstack.org/developer/nova/block_device_mapping.html might be helpful\n[Tue 05:32:33 PM]  <mordred>\tmriedem: yup. it also says None is valid\n[Tue 05:34:01 PM]  <mriedem>\ti feel like something was just recently changed in the json schema there, is this master?\n[Tue 05:34:17 PM]  <mordred>\tdhellmann: you were doing master devstack?\n[Tue 05:34:30 PM]  <mordred>\tmriedem: I think so yeah?\n[Tue 05:34:43 PM]  <dhellmann>\tmordred : yes, master devstack (from a few hours ago)\n[Tue 05:34:45 PM] mordred\tgoes to look at json schema\n[Tue 05:34:51 PM]  <mriedem> https://github.com/openstack/nova/blob/master/nova/api/openstack/compute/schemas/block_device_mapping.py#L56\n[Tue 05:35:28 PM]  <mordred>\tfantastic\n[Tue 05:36:06 PM]  <mriedem>\twhat's the image and dest type?\n[Tue 05:36:19 PM]  <mriedem>\tsource_type and destination_type i mean\n[Tue 05:37:01 PM]  <mriedem>\tbecause https://github.com/openstack/nova/blob/master/nova/block_device.py#L198\n[Tue 05:37:02 PM]  <dhellmann>\tit's a qcow2 ubuntu image\n[Tue 05:37:16 PM]  <mordred>\tdestination_type would be 'volume'\n[Tue 05:37:22 PM]  <mriedem>\tand source_type is?\n[Tue 05:37:23 PM]  <mriedem>\timage?\n[Tue 05:37:24 PM]  <dhellmann>\tI want to boot it ephemeral  and attach a volume\n[Tue 05:37:47 PM]  <mordred>\tyah- source_type also volume\n[Tue 05:38:01 PM]  <mriedem>\thave you tried omitting boot_index\n[Tue 05:38:02 PM]  <mriedem>\t?\n[Tue 05:38:05 PM]  <mordred>\tyes. that works\n[Tue 05:38:12 PM]  <mordred>\tas does providing -1 or '-1'\n[Tue 05:38:46 PM]  <mordred>\thowever, None worked in the past and is still referneced in the docs ... so maybe there's a bug somewhere, I'm just not sure what to file/write up\n[Tue 05:38:59 PM]  <mordred>\t(we can make shade dtrt by omitting or using -1\n[Tue 05:39:14 PM]  <mriedem>\toomichi: Kevin_Zheng: gmann: alex_xu: do you remember anything recently related to this? ^\n[Tue 05:39:40 PM]  <mriedem>\thttps://review.openstack.org/#/c/410006/\n[Tue 05:40:50 PM]  <mriedem>\tmordred: i wouldn't put a ton of faith in the api-ref docs on this one\n[Tue 05:40:57 PM]  <mordred>\tmriedem: ok\n[Tue 05:41:03 PM]  <mriedem>\ti'd be interested in knowing if it's different on like a liberty install\n[Tue 05:41:29 PM]  <mordred>\tmriedem: None worked against dreamhost - whatever version is running there\n[Tue 05:41:43 PM]  <mriedem>\tmordred: because my guess is the wording in the api-ref was pulled from http://docs.openstack.org/developer/nova/block_device_mapping.html and that's more about the actual object code in nova rather than the API\n[Tue 05:42:05 PM]  <mordred>\tah - k. so it's likely just a docs bug\n[Tue 05:42:06 PM]  <dhellmann>\tdreamhost is either mitaka or newton\n[Tue 05:42:15 PM]  <mriedem>\ti'd file a bug either way so we can investigate\n[Tue 05:42:27 PM]  <dhellmann>\tI can do that\n[Tue 05:42:37 PM]  <mriedem>\tplus, if the api is ok but the docs are wrong, we can use the bug to fix the docs\n[Tue 05:42:50 PM]  <mordred>\tcool.\n[Tue 05:42:52 PM]  <mordred>\tthanks dhellmann !\n[Tue 05:43:10 PM]  <dhellmann>\tthanks, mordred & mriedem \n[Tue 05:45:00 PM]  <mriedem>\talso,\n[Tue 05:45:07 PM]  <mriedem>\ti wonder if you were hitting a nova v2 vs v2.1 endpoint before...\n[Tue 05:45:11 PM]  <mriedem>\tv2 didn't have schema validation\n[Tue 05:45:22 PM]  <mriedem>\tmordred: dhellmann: ^\n[Tue 05:45:39 PM]  <mordred>\toh - it's entirely possible\n[Tue 05:46:06 PM]  <mordred>\tshade is (currently) just piggybacking novaclient which grabs latest microversion aiui\n[Tue 05:46:12 PM]  <mordred>\tI haven't gotten to doing explicit microversion code myself\n[Tue 05:46:29 PM]  <mordred>\t(that'll be next month - expect plenty of questions from me)\n[Tue 05:47:02 PM]  <mriedem>\tthere is where the legacy v2 api bdm v2 stuff happened https://github.com/openstack/nova/blob/liberty-eol/nova/api/openstack/compute/legacy_v2/servers.py#L424\n[Tue 05:47:54 PM]  <mriedem>\twhich only checked boot_index here https://github.com/openstack/nova/blob/liberty-eol/nova/block_device.py#L201\n[Tue 05:48:00 PM]  <mriedem>\tif source_type == 'image' and destination_type == 'local':\n[Tue 05:48:33 PM]  <mriedem>\tand then that dict was probably turned into an object https://github.com/openstack/nova/blob/liberty-eol/nova/objects/block_device.py#L73\n[Tue 05:48:36 PM]  <mriedem>\twhere boot_index can be None\n[Tue 05:49:18 PM]  <mriedem>\tthe compute api did some validation here too https://github.com/openstack/nova/blob/liberty-eol/nova/compute/api.py#L1315\n[Tue 05:49:20 PM]  <mriedem>\ton the object\n[Tue 05:49:22 PM]  <mriedem>\tSO,\n[Tue 05:49:38 PM]  <mriedem>\ti think it just means that the v2.1 API json schema validation regressed from the v2 API validation\n[Tue 05:49:56 PM]  <mriedem>\twould be cool if you guys could confirm that it was working when you were talking to a v2 compute endpoint cloud vs v2.1\n[Tue 05:50:03 PM]  <mriedem>\tbut that'd be my professional opinion\n[Tue 05:50:09 PM]  <mriedem>\tdr debug\n[Tue 05:51:06 PM]  <mriedem>\tdhellmann: i've got to run but just throw ^ into the bug report and i'll check it out later when i'm home", 
            "date_created": "2017-02-07 22:55:20.795107+00:00", 
            "author": "https://api.launchpad.net/1.0/~doug-hellmann"
        }, 
        {
            "content": "Changing shade to pass -1, '-1', or to leave the boot_index value out entirely all makes it work. See https://review.openstack.org/430465", 
            "date_created": "2017-02-07 22:56:52.128681+00:00", 
            "author": "https://api.launchpad.net/1.0/~doug-hellmann"
        }, 
        {
            "content": "Fix is here: https://review.openstack.org/#/c/430497/", 
            "date_created": "2017-02-08 21:49:53.497821+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/430497\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=e34f05edb2efc79bfdd8e73cca8fa02ea6ef2d60\nSubmitter: Jenkins\nBranch:    master\n\ncommit e34f05edb2efc79bfdd8e73cca8fa02ea6ef2d60\nAuthor: Matt Riedemann <email address hidden>\nDate:   Tue Feb 7 20:28:13 2017 -0500\n\n    Allow None for block_device_mapping_v2.boot_index\n    \n    The legacy v2 API allowed None for the boot_index [1]. It\n    allowed this implicitly because the API code would convert\n    the block_device_mapping_v2 dict from the request into a\n    BlockDeviceMapping object, which has a boot_index field that\n    is nullable (allows None).\n    \n    The API reference documentation [2] also says:\n    \n    \"To disable a device from booting, set the boot index\n    to a negative value or use the default boot index value,\n    which is None.\"\n    \n    It appears that with the move to v2.1 and request schema\n    validation, the boot_index schema was erroneously set to\n    not allow None for a value, which is not backward compatible\n    with the v2 API behavior.\n    \n    This change fixes the schema to allow boot_index=None again\n    and adds a test to show it working.\n    \n    This should not require a microversion bump since it's fixing\n    a regression in the v2.1 API which worked in the v2 API and\n    is already handled throughout Nova's block device code.\n    \n    Closes-Bug: #1662699\n    \n    [1] https://github.com/openstack/nova/blob/13.0.0/nova/compute/api.py#L1268\n    [2] http://developer.openstack.org/api-ref/compute/#create-server\n    \n    Change-Id: Ice78a0982bcce491f0c9690903ed2c6b6aaab1be\n", 
            "date_created": "2017-02-09 05:45:51.481645+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/ocata\nReview: https://review.openstack.org/431595", 
            "date_created": "2017-02-09 15:20:18.310417+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/newton\nReview: https://review.openstack.org/431610", 
            "date_created": "2017-02-09 15:41:26.278546+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/mitaka\nReview: https://review.openstack.org/431628", 
            "date_created": "2017-02-09 16:12:29.218180+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/431595\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=ff1925ae47245f056690889a6e063ebce1bb7a80\nSubmitter: Jenkins\nBranch:    stable/ocata\n\ncommit ff1925ae47245f056690889a6e063ebce1bb7a80\nAuthor: Matt Riedemann <email address hidden>\nDate:   Tue Feb 7 20:28:13 2017 -0500\n\n    Allow None for block_device_mapping_v2.boot_index\n    \n    The legacy v2 API allowed None for the boot_index [1]. It\n    allowed this implicitly because the API code would convert\n    the block_device_mapping_v2 dict from the request into a\n    BlockDeviceMapping object, which has a boot_index field that\n    is nullable (allows None).\n    \n    The API reference documentation [2] also says:\n    \n    \"To disable a device from booting, set the boot index\n    to a negative value or use the default boot index value,\n    which is None.\"\n    \n    It appears that with the move to v2.1 and request schema\n    validation, the boot_index schema was erroneously set to\n    not allow None for a value, which is not backward compatible\n    with the v2 API behavior.\n    \n    This change fixes the schema to allow boot_index=None again\n    and adds a test to show it working.\n    \n    This should not require a microversion bump since it's fixing\n    a regression in the v2.1 API which worked in the v2 API and\n    is already handled throughout Nova's block device code.\n    \n    Closes-Bug: #1662699\n    \n    [1] https://github.com/openstack/nova/blob/13.0.0/nova/compute/api.py#L1268\n    [2] http://developer.openstack.org/api-ref/compute/#create-server\n    \n    Change-Id: Ice78a0982bcce491f0c9690903ed2c6b6aaab1be\n    (cherry picked from commit e34f05edb2efc79bfdd8e73cca8fa02ea6ef2d60)\n", 
            "date_created": "2017-02-10 14:02:38.881890+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/431610\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=dce8618166d80dc6cf2854920f6275eee73b8d84\nSubmitter: Jenkins\nBranch:    stable/newton\n\ncommit dce8618166d80dc6cf2854920f6275eee73b8d84\nAuthor: Matt Riedemann <email address hidden>\nDate:   Tue Feb 7 20:28:13 2017 -0500\n\n    Allow None for block_device_mapping_v2.boot_index\n    \n    The legacy v2 API allowed None for the boot_index [1]. It\n    allowed this implicitly because the API code would convert\n    the block_device_mapping_v2 dict from the request into a\n    BlockDeviceMapping object, which has a boot_index field that\n    is nullable (allows None).\n    \n    The API reference documentation [2] also says:\n    \n    \"To disable a device from booting, set the boot index\n    to a negative value or use the default boot index value,\n    which is None.\"\n    \n    It appears that with the move to v2.1 and request schema\n    validation, the boot_index schema was erroneously set to\n    not allow None for a value, which is not backward compatible\n    with the v2 API behavior.\n    \n    This change fixes the schema to allow boot_index=None again\n    and adds a test to show it working.\n    \n    This should not require a microversion bump since it's fixing\n    a regression in the v2.1 API which worked in the v2 API and\n    is already handled throughout Nova's block device code.\n    \n    Closes-Bug: #1662699\n    \n    [1] https://github.com/openstack/nova/blob/13.0.0/nova/compute/api.py#L1268\n    [2] http://developer.openstack.org/api-ref/compute/#create-server\n    \n    Change-Id: Ice78a0982bcce491f0c9690903ed2c6b6aaab1be\n    (cherry picked from commit e34f05edb2efc79bfdd8e73cca8fa02ea6ef2d60)\n    (cherry picked from commit ff1925ae47245f056690889a6e063ebce1bb7a80)\n", 
            "date_created": "2017-02-10 14:25:36.614407+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/431628\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=9b3c4736a35b0db6ceff38786fb706a6a312a7ab\nSubmitter: Jenkins\nBranch:    stable/mitaka\n\ncommit 9b3c4736a35b0db6ceff38786fb706a6a312a7ab\nAuthor: Matt Riedemann <email address hidden>\nDate:   Tue Feb 7 20:28:13 2017 -0500\n\n    Allow None for block_device_mapping_v2.boot_index\n    \n    The legacy v2 API allowed None for the boot_index [1]. It\n    allowed this implicitly because the API code would convert\n    the block_device_mapping_v2 dict from the request into a\n    BlockDeviceMapping object, which has a boot_index field that\n    is nullable (allows None).\n    \n    The API reference documentation [2] also says:\n    \n    \"To disable a device from booting, set the boot index\n    to a negative value or use the default boot index value,\n    which is None.\"\n    \n    It appears that with the move to v2.1 and request schema\n    validation, the boot_index schema was erroneously set to\n    not allow None for a value, which is not backward compatible\n    with the v2 API behavior.\n    \n    This change fixes the schema to allow boot_index=None again\n    and adds a test to show it working.\n    \n    This should not require a microversion bump since it's fixing\n    a regression in the v2.1 API which worked in the v2 API and\n    is already handled throughout Nova's block device code.\n    \n    Closes-Bug: #1662699\n    \n    [1] https://github.com/openstack/nova/blob/13.0.0/nova/compute/api.py#L1268\n    [2] http://developer.openstack.org/api-ref/compute/#create-server\n    \n    Change-Id: Ice78a0982bcce491f0c9690903ed2c6b6aaab1be\n    (cherry picked from commit e34f05edb2efc79bfdd8e73cca8fa02ea6ef2d60)\n    (cherry picked from commit ff1925ae47245f056690889a6e063ebce1bb7a80)\n    (cherry picked from commit dce8618166d80dc6cf2854920f6275eee73b8d84)\n", 
            "date_created": "2017-02-10 14:26:08.810656+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 15.0.0.0rc2 release candidate.", 
            "date_created": "2017-02-17 04:58:01.573906+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.4 release.", 
            "date_created": "2017-02-27 20:28:52.328639+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 13.1.3 release.", 
            "date_created": "2017-02-28 16:00:03.636457+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 16.0.0.0b1 development milestone.", 
            "date_created": "2017-04-14 09:24:11.565384+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}