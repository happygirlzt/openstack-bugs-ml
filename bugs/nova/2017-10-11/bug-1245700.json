{
    "status": "Fix Released", 
    "last_updated": "2014-10-17 10:24:00.729858+00:00", 
    "description": "2013-10-28 15:46:38.470 ERROR nova.api.openstack [req-e405f8e2-95a1-4748-8f9f-c642080e16b3 demo demo] Caught error: local variable 'port' referenced before assignment\n2013-10-28 15:46:38.470 TRACE nova.api.openstack Traceback (most recent call last):\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 119, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return req.get_response(self.application)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1296, in send\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     application, catch_exc_info=False)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1260, in call_application\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 571, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return self.app(env, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 939, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     content_type, body, accept)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 998, in _process_stack\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 1079, in dispatch\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return method(req=request, **action_args)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/servers.py\", line 924, in create\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     legacy_bdm=legacy_bdm)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/hooks.py\", line 105, in inner\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     rv = f(*args, **kwargs)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 1218, in create\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     legacy_bdm=legacy_bdm)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 859, in _create_instance\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     block_device_mapping, auto_disk_config, reservation_id)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 673, in _validate_and_build_base_options\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     self._check_requested_networks(context, requested_networks)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 437, in _check_requested_networks\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     self.network_api.validate_networks(context, requested_networks)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 553, in validate_networks\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     if not port:\n2013-10-28 15:46:38.470 TRACE nova.api.openstack UnboundLocalError: local variable 'port' referenced before assignment", 
    "tags": [
        "network"
    ], 
    "importance": "Low", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1245700", 
    "owner": "https://api.launchpad.net/1.0/~arosen", 
    "id": 1245700, 
    "index": 5948, 
    "created": "2013-10-28 22:56:07.869687+00:00", 
    "title": "nova boot via invalid neutron port raises 500", 
    "comments": [
        {
            "content": "2013-10-28 15:46:38.470 ERROR nova.api.openstack [req-e405f8e2-95a1-4748-8f9f-c642080e16b3 demo demo] Caught error: local variable 'port' referenced before assignment\n2013-10-28 15:46:38.470 TRACE nova.api.openstack Traceback (most recent call last):\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 119, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return req.get_response(self.application)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1296, in send\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     application, catch_exc_info=False)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1260, in call_application\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 571, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return self.app(env, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 939, in __call__\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     content_type, body, accept)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 998, in _process_stack\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 1079, in dispatch\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     return method(req=request, **action_args)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/servers.py\", line 924, in create\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     legacy_bdm=legacy_bdm)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/hooks.py\", line 105, in inner\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     rv = f(*args, **kwargs)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 1218, in create\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     legacy_bdm=legacy_bdm)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 859, in _create_instance\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     block_device_mapping, auto_disk_config, reservation_id)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 673, in _validate_and_build_base_options\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     self._check_requested_networks(context, requested_networks)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 437, in _check_requested_networks\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     self.network_api.validate_networks(context, requested_networks)\n2013-10-28 15:46:38.470 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 553, in validate_networks\n2013-10-28 15:46:38.470 TRACE nova.api.openstack     if not port:\n2013-10-28 15:46:38.470 TRACE nova.api.openstack UnboundLocalError: local variable 'port' referenced before assignment", 
            "date_created": "2013-10-28 22:56:07.869687+00:00", 
            "author": "https://api.launchpad.net/1.0/~arosen"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/54211", 
            "date_created": "2013-10-28 23:44:50.389762+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Actually the nova code can be made slightly more robust here. ", 
            "date_created": "2013-10-29 01:12:31.424917+00:00", 
            "author": "https://api.launchpad.net/1.0/~arosen"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/54219\nCommitted: http://github.com/openstack/nova/commit/2392f746d31028dca5fdf6de423f807bfaf69c84\nSubmitter: Jenkins\nBranch:    master\n\ncommit 2392f746d31028dca5fdf6de423f807bfaf69c84\nAuthor: Aaron Rosen <email address hidden>\nDate:   Mon Oct 28 18:05:15 2013 -0700\n\n    Correct exception handling\n    \n    Previously, it was possible for an exception to be hidden and cause other\n    errors for example:\n        UnboundLocalError: local variable 'port' referenced before assignment\n    was previously occuring if e.status_code != 404\n    \n    Fixes bug: 1245700\n    \n    Change-Id: I27e44ffd33a73c88745de8fda8fd7c374435808a\n", 
            "date_created": "2013-11-01 20:16:40.170183+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/54211\nCommitted: http://github.com/openstack/python-neutronclient/commit/feda92ff0b28514b27e8e05713368962366c9fa4\nSubmitter: Jenkins\nBranch:    master\n\ncommit feda92ff0b28514b27e8e05713368962366c9fa4\nAuthor: Aaron Rosen <email address hidden>\nDate:   Mon Oct 28 16:33:27 2013 -0700\n\n    Fix status_code not passed in code\n    \n    The python-neutronclient was refactored to raise NeutronClientException\n    and when that occured the status_code field was dropped. This causes errors\n    on the nova-side to occur as nova checks the status_code to do error handling.\n    \n    Fixes bug: 1245700\n    \n    Change-Id: Ie1fcf3fef0e20c33ce18549bca6a2413a9f98e9f\n", 
            "date_created": "2013-11-02 13:13:11.687362+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}