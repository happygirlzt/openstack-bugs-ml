{
    "status": "Fix Released", 
    "last_updated": "2015-11-19 21:50:13.464897+00:00", 
    "description": "On resize-revert, the original host was waiting for plug events from neutron before restarting the instance. These aren't sent since we don't ever unplug the vifs. Thus, we'll always fail like this:\n\n\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 134, in _dispatch_and_reply\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     incoming.message))\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 177, in _dispatch\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 123, in _do_dispatch\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     payload)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 82, in __exit__\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 298, in decorated_function\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     pass\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 82, in __exit__\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 284, in decorated_function\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 348, in decorated_function\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 326, in decorated_function\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 82, in __exit__\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 314, in decorated_function\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 3573, in finish_revert_resize\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     block_device_info, power_on)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 6095, in finish_revert_migration\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     block_device_info, power_on)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4446, in _create_domain_and_network\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     raise exception.VirtualInterfaceCreateException()\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher VirtualInterfaceCreateException: Virtual Interface creation failed", 
    "tags": [
        "in-stable-juno", 
        "in-stable-kilo", 
        "juno-backport-potential", 
        "kilo-backport-potential", 
        "libvirt", 
        "neutron"
    ], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1450624", 
    "owner": "https://api.launchpad.net/1.0/~danms", 
    "id": 1450624, 
    "index": 1740, 
    "created": "2015-04-30 20:30:29.494959+00:00", 
    "title": "Nova waits for events from neutron on resize-revert that aren't coming", 
    "comments": [
        {
            "content": "On resize-revert, the original host was waiting for plug events from neutron before restarting the instance. These aren't sent since we don't ever unplug the vifs. Thus, we'll always fail like this:\n\n\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 134, in _dispatch_and_reply\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     incoming.message))\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 177, in _dispatch\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 123, in _do_dispatch\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     payload)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 82, in __exit__\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 298, in decorated_function\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     pass\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 82, in __exit__\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 284, in decorated_function\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 348, in decorated_function\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 326, in decorated_function\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 82, in __exit__\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 314, in decorated_function\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/compute/manager.py\", line 3573, in finish_revert_resize\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     block_device_info, power_on)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 6095, in finish_revert_migration\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     block_device_info, power_on)\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher   File \"/opt/bbc/openstack-10.0-bbc40/nova/local/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4446, in _create_domain_and_network\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher     raise exception.VirtualInterfaceCreateException()\n2015-04-30 19:45:42.602 23513 TRACE oslo.messaging.rpc.dispatcher VirtualInterfaceCreateException: Virtual Interface creation failed", 
            "date_created": "2015-04-30 20:30:29.494959+00:00", 
            "author": "https://api.launchpad.net/1.0/~danms"
        }, 
        {
            "content": "https://review.openstack.org/#/c/179228/", 
            "date_created": "2015-04-30 20:31:21.964500+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Fix proposed to branch: stable/kilo\nReview: https://review.openstack.org/179232", 
            "date_created": "2015-04-30 20:32:47.466124+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Bug 1380934 looks related.", 
            "date_created": "2015-04-30 20:33:55.765589+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Fix proposed to branch: stable/juno\nReview: https://review.openstack.org/179234", 
            "date_created": "2015-04-30 20:36:52.227848+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/179228\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=4814e9126ec19a1edfa9c696138c4b3fec71aa0d\nSubmitter: Jenkins\nBranch:    master\n\ncommit 4814e9126ec19a1edfa9c696138c4b3fec71aa0d\nAuthor: Dan Smith <email address hidden>\nDate:   Thu Apr 30 13:23:07 2015 -0700\n\n    Don't wait for an event on a resize-revert\n    \n    Since we never unplugged, the event ain't comin'.\n    \n    Sadly, the test that covers this was pretty wrong on multiple fronts,\n    which this patch fixes up.\n    \n    Closes-Bug: #1450624\n    Change-Id: Id515137747a4b76e9b7057c95f80c8ae74017519\n", 
            "date_created": "2015-05-01 16:18:33.269783+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/179234\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=0f7fd924fdfbdcb8cd3155d385a675d1e19b1c95\nSubmitter: Jenkins\nBranch:    stable/juno\n\ncommit 0f7fd924fdfbdcb8cd3155d385a675d1e19b1c95\nAuthor: Dan Smith <email address hidden>\nDate:   Thu Apr 30 13:23:07 2015 -0700\n\n    Don't wait for an event on a resize-revert\n    \n    Since we never unplugged, the event ain't comin'.\n    \n    Sadly, the test that covers this was pretty wrong on multiple fronts,\n    which this patch fixes up.\n    \n    Conflicts:\n    \tnova/tests/unit/virt/libvirt/test_driver.py\n    \tnova/virt/libvirt/driver.py\n    \n    Closes-Bug: #1450624\n    Change-Id: Id515137747a4b76e9b7057c95f80c8ae74017519\n    (cherry picked from commit 4814e9126ec19a1edfa9c696138c4b3fec71aa0d)\n", 
            "date_created": "2015-05-12 22:30:35.274230+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/179232\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=6463b38c0b1d330000a17b6abb074570b5061b8e\nSubmitter: Jenkins\nBranch:    stable/kilo\n\ncommit 6463b38c0b1d330000a17b6abb074570b5061b8e\nAuthor: Dan Smith <email address hidden>\nDate:   Thu Apr 30 13:23:07 2015 -0700\n\n    Don't wait for an event on a resize-revert\n    \n    Since we never unplugged, the event ain't comin'.\n    \n    Sadly, the test that covers this was pretty wrong on multiple fronts,\n    which this patch fixes up.\n    \n    Closes-Bug: #1450624\n    Change-Id: Id515137747a4b76e9b7057c95f80c8ae74017519\n    (cherry picked from commit 4814e9126ec19a1edfa9c696138c4b3fec71aa0d)\n", 
            "date_created": "2015-06-02 13:39:12.036423+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}