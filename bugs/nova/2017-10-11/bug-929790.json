{
    "status": "Fix Released", 
    "last_updated": "2012-04-05 10:09:16.241671+00:00", 
    "description": "(nova.rpc): TRACE: Traceback (most recent call last):\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/rpc/amqp.py\", line 249, in _process_data\n(nova.rpc): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/exception.py\", line 126, in wrapped\n(nova.rpc): TRACE:     return f(*args, **kw)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 150, in decorated_function\n(nova.rpc): TRACE:     function(self, context, instance_uuid, *args, **kwargs)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 173, in decorated_function\n(nova.rpc): TRACE:     self.add_instance_fault_from_exc(context, instance_uuid, e)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n(nova.rpc): TRACE:     self.gen.next()\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 168, in decorated_function\n(nova.rpc): TRACE:     return function(self, context, instance_uuid, *args, **kwargs)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 1635, in attach_volume\n(nova.rpc): TRACE:     connector)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n(nova.rpc): TRACE:     self.gen.next()\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 1627, in attach_volume\n(nova.rpc): TRACE:     mountpoint)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/exception.py\", line 126, in wrapped\n(nova.rpc): TRACE:     return f(*args, **kw)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 454, in attach_volume\n(nova.rpc): TRACE:     mount_device)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 446, in volume_driver_method\n(nova.rpc): TRACE:     return method(connection_info, *args, **kwargs)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/volume.py\", line 127, in connect_volume\n(nova.rpc): TRACE:     self._run_iscsiadm(iscsi_properties, (\"--login\",))\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/volume.py\", line 96, in _run_iscsiadm\n(nova.rpc): TRACE:     check_exit_code=check_exit_code)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/utils.py\", line 232, in execute\n(nova.rpc): TRACE:     cmd=' '.join(cmd))\n(nova.rpc): TRACE: ProcessExecutionError: Unexpected error while running command.\n(nova.rpc): TRACE: Command: sudo iscsiadm -m node -T iqn.1992-08.com.netapp:sn.101192396 -p 10.61.167.30:3260 --login\n(nova.rpc): TRACE: Exit code: 255\n(nova.rpc): TRACE: Stdout: 'Logging in to [iface: default, target: iqn.1992-08.com.netapp:sn.101192396, portal: 10.61.167.30,3260]\\n'\n(nova.rpc): TRACE: Stderr: 'iscsiadm: Could not login to [iface: default, target: iqn.1992-08.com.netapp:sn.101192396, portal: 10.61.167.30,3260]: \\niscsiadm: initiator reported error (15 - already exists)\\n'\n\nneed to allow multiple logins/logout and pass the lun data in iscsi_properties", 
    "tags": [], 
    "importance": "High", 
    "heat": 14, 
    "link": "https://bugs.launchpad.net/nova/+bug/929790", 
    "owner": "https://api.launchpad.net/1.0/~renukaapte", 
    "id": 929790, 
    "index": 579, 
    "created": "2012-02-09 20:17:40.082462+00:00", 
    "title": "nova-volume multiple lun's on the same target don't work", 
    "comments": [
        {
            "content": "(nova.rpc): TRACE: Traceback (most recent call last):\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/rpc/amqp.py\", line 249, in _process_data\n(nova.rpc): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/exception.py\", line 126, in wrapped\n(nova.rpc): TRACE:     return f(*args, **kw)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 150, in decorated_function\n(nova.rpc): TRACE:     function(self, context, instance_uuid, *args, **kwargs)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 173, in decorated_function\n(nova.rpc): TRACE:     self.add_instance_fault_from_exc(context, instance_uuid, e)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n(nova.rpc): TRACE:     self.gen.next()\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 168, in decorated_function\n(nova.rpc): TRACE:     return function(self, context, instance_uuid, *args, **kwargs)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 1635, in attach_volume\n(nova.rpc): TRACE:     connector)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n(nova.rpc): TRACE:     self.gen.next()\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 1627, in attach_volume\n(nova.rpc): TRACE:     mountpoint)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/exception.py\", line 126, in wrapped\n(nova.rpc): TRACE:     return f(*args, **kw)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 454, in attach_volume\n(nova.rpc): TRACE:     mount_device)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 446, in volume_driver_method\n(nova.rpc): TRACE:     return method(connection_info, *args, **kwargs)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/volume.py\", line 127, in connect_volume\n(nova.rpc): TRACE:     self._run_iscsiadm(iscsi_properties, (\"--login\",))\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/volume.py\", line 96, in _run_iscsiadm\n(nova.rpc): TRACE:     check_exit_code=check_exit_code)\n(nova.rpc): TRACE:   File \"/opt/stack/nova/nova/utils.py\", line 232, in execute\n(nova.rpc): TRACE:     cmd=' '.join(cmd))\n(nova.rpc): TRACE: ProcessExecutionError: Unexpected error while running command.\n(nova.rpc): TRACE: Command: sudo iscsiadm -m node -T iqn.1992-08.com.netapp:sn.101192396 -p 10.61.167.30:3260 --login\n(nova.rpc): TRACE: Exit code: 255\n(nova.rpc): TRACE: Stdout: 'Logging in to [iface: default, target: iqn.1992-08.com.netapp:sn.101192396, portal: 10.61.167.30,3260]\\n'\n(nova.rpc): TRACE: Stderr: 'iscsiadm: Could not login to [iface: default, target: iqn.1992-08.com.netapp:sn.101192396, portal: 10.61.167.30,3260]: \\niscsiadm: initiator reported error (15 - already exists)\\n'\n\nneed to allow multiple logins/logout and pass the lun data in iscsi_properties", 
            "date_created": "2012-02-09 20:17:40.082462+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/3990", 
            "date_created": "2012-02-10 00:45:06.097738+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/3990\nCommitted: http://github.com/openstack/nova/commit/509e5ad9ef6ed38caa69d2c76b1adccedcdd315e\nSubmitter: Jenkins\nBranch:    master\n\ncommit 509e5ad9ef6ed38caa69d2c76b1adccedcdd315e\nAuthor: Vishvananda Ishaya <email address hidden>\nDate:   Thu Feb 9 15:05:21 2012 -0800\n\n    Fixes nova-volume support for multiple luns\n    \n     * stores lun in provider_location if specified\n     * passes lun in iscsi_properties instead of hard coding\n     * adds call to libvirt to list all used block devices\n     * make sure to synchronize connect and disconnect commands\n     * only disconnect from target if no luns are in use\n     * allow double logins to targets\n     * fixes typo in get_volume_connector in xenapi_connection\n     * fixes bug 929790\n    \n    Change-Id: I2466dc750a6fa5e0b07f94314d38873740aa6b29\n", 
            "date_created": "2012-02-17 23:32:20.589282+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}