{
    "status": "Invalid", 
    "last_updated": "2014-10-04 13:38:52.334510+00:00", 
    "description": "Commit a8a5d44c8aca218f00649232c2b8a46aee59b77e change the request_network parameter. It add pci_request_id for each item.\n\nOld code only accept three item: https://github.com/openstack/nova/blob/2014.1/nova/network/neutronv2/api.py#L237\n....\nfor network_id, fixed_ip, port_id in requested_networks:\n....\n\nThe new code change it to 4 items tuple.\nhttps://github.com/openstack/nova/blob/master/nova/objects/network_request.py#L37\n\n\nThen new controller boot instance to old compute node, will get error as below:\n2014-10-04 21:08:17.455 ERROR nova.compute.manager [req-58b84295-ce36-479f-b50e-dfe4f86cc1d9 admin demo] [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4] Insta\nnce failed to spawn\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4] Traceback (most recent call last):\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2014\n, in _build_resources\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     yield resources\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1917\n, in _build_and_run_instance\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     block_device_info=block_device_info)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line \n2246, in spawn\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     admin_pass=admin_password)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line \n2677, in _create_image\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     content=files, extra_md=extra_md, network_info=network_\ninfo)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/api/metadata/base.py\", line 16\n5, in __init__\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     ec2utils.get_ip_info_for_instance_from_nw_info(network_info)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/api/ec2/ec2utils.py\", line 147, in get_ip_info_for_instance_from_nw_info\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     fixed_ips = nw_info.fixed_ips()\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/network/model.py\", line 407, in _sync_wrapper\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     self.wait()\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/network/model.py\", line 439, in wait\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     self[:] = self._gt.wait()\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 168, in wait\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     return self._exit_event.wait()\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 124, in wait\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     current.throw(*self._exc)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 207, in main\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     result = function(*args, **kwargs)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1510, in _allocate_network_async\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     dhcp_options=dhcp_options)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 238, in allocate_for_instance\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     for network_id, fixed_ip, port_id in requested_networks:\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4] ValueError: too many values to unpack", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1377446", 
    "owner": "None", 
    "id": 1377446, 
    "index": 5195, 
    "created": "2014-10-04 13:37:50.282805+00:00", 
    "title": "pci_request_id break the upgrade from icehouse to Juno", 
    "comments": [
        {
            "content": "Commit a8a5d44c8aca218f00649232c2b8a46aee59b77e change the request_network parameter. It add pci_request_id for each item.\n\nOld code only accept three item: https://github.com/openstack/nova/blob/2014.1/nova/network/neutronv2/api.py#L237\n....\nfor network_id, fixed_ip, port_id in requested_networks:\n....\n\nThe new code change it to 4 items tuple.\nhttps://github.com/openstack/nova/blob/master/nova/objects/network_request.py#L37\n\n\nThen new controller boot instance to old compute node, will get error as below:\n2014-10-04 21:08:17.455 ERROR nova.compute.manager [req-58b84295-ce36-479f-b50e-dfe4f86cc1d9 admin demo] [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4] Insta\nnce failed to spawn\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4] Traceback (most recent call last):\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2014\n, in _build_resources\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     yield resources\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1917\n, in _build_and_run_instance\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     block_device_info=block_device_info)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line \n2246, in spawn\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     admin_pass=admin_password)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line \n2677, in _create_image\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     content=files, extra_md=extra_md, network_info=network_\ninfo)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/api/metadata/base.py\", line 16\n5, in __init__\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     ec2utils.get_ip_info_for_instance_from_nw_info(network_info)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/api/ec2/ec2utils.py\", line 147, in get_ip_info_for_instance_from_nw_info\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     fixed_ips = nw_info.fixed_ips()\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/network/model.py\", line 407, in _sync_wrapper\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     self.wait()\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/network/model.py\", line 439, in wait\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     self[:] = self._gt.wait()\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 168, in wait\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     return self._exit_event.wait()\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 124, in wait\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     current.throw(*self._exc)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 207, in main\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     result = function(*args, **kwargs)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1510, in _allocate_network_async\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     dhcp_options=dhcp_options)\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]   File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 238, in allocate_for_instance\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4]     for network_id, fixed_ip, port_id in requested_networks:\n2014-10-04 21:08:17.455 TRACE nova.compute.manager [instance: c643eff5-ffd0-4eea-98a0-bce55108b0a4] ValueError: too many values to unpack", 
            "date_created": "2014-10-04 13:37:50.282805+00:00", 
            "author": "https://api.launchpad.net/1.0/~xuhj"
        }, 
        {
            "content": "duplicate with https://bugs.launchpad.net/nova/+bug/1377447", 
            "date_created": "2014-10-04 13:38:51.550526+00:00", 
            "author": "https://api.launchpad.net/1.0/~xuhj"
        }
    ]
}