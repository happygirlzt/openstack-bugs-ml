{
    "status": "Fix Released", 
    "last_updated": "2013-04-04 11:06:49.027051+00:00", 
    "description": "In function check_size() of nova/virt/libvirt/utils.py\uff0c  when creating lvm image and the free space of volume group is not enough, it will raise RuntimeError exception. The exception information includes message about vg and lv, which can not be parsed by locals().\n\nFollowing is the error log:\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e] Traceback (most recent call last):\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1105, in _spawn\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     block_device_info)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/exception.py\", line 117, in wrapped\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     temp_level, payload)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     self.gen.next()\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/exception.py\", line 92, in wrapped\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     return f(*args, **kw)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 1202, in spawn\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     admin_pass=admin_password)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 1667, in _create_image\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     ephemeral_size=ephemeral_gb)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/imagebackend.py\", line 131, in cache\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     *args, **kwargs)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/imagebackend.py\", line 219, in create_image\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     size, sparse=self.sparse)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/utils.py\", line 131, in create_lvm_image\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     check_size(size)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/utils.py\", line 116, in check_size\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     ' by volume %(lv)s.') % locals())\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e] KeyError: u'vg'\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1088434", 
    "owner": "https://api.launchpad.net/1.0/~hzguanqiang", 
    "id": 1088434, 
    "index": 3255, 
    "created": "2012-12-10 11:08:29.222610+00:00", 
    "title": "KeyError of log message in virt/libvirt/utils.py/create_lvm_image()/check_size()", 
    "comments": [
        {
            "content": "In function check_size() of nova/virt/libvirt/utils.py\uff0c  when creating lvm image and the free space of volume group is not enough, it will raise RuntimeError exception. The exception information includes message about vg and lv, which can not be parsed by locals().\n\nFollowing is the error log:\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e] Traceback (most recent call last):\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1105, in _spawn\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     block_device_info)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/exception.py\", line 117, in wrapped\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     temp_level, payload)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     self.gen.next()\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/exception.py\", line 92, in wrapped\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     return f(*args, **kw)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 1202, in spawn\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     admin_pass=admin_password)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 1667, in _create_image\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     ephemeral_size=ephemeral_gb)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/imagebackend.py\", line 131, in cache\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     *args, **kwargs)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/imagebackend.py\", line 219, in create_image\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     size, sparse=self.sparse)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/utils.py\", line 131, in create_lvm_image\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     check_size(size)\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]   File \"/usr/local/lib/python2.7/dist-packages/nova/virt/libvirt/utils.py\", line 116, in check_size\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]     ' by volume %(lv)s.') % locals())\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e] KeyError: u'vg'\n2012-12-08 20:03:51 TRACE nova.compute.manager [instance: 352e4eb6-8d5c-4170-ab4d-0ee4333bf34e]", 
            "date_created": "2012-12-10 11:08:29.222610+00:00", 
            "author": "https://api.launchpad.net/1.0/~hzguanqiang"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/17821", 
            "date_created": "2012-12-11 03:03:36.169748+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/17821\nCommitted: http://github.com/openstack/nova/commit/c6a30c4bbcdb99e1eb1b6f782c39a1ef18c4ad08\nSubmitter: Jenkins\nBranch:    master\n\ncommit c6a30c4bbcdb99e1eb1b6f782c39a1ef18c4ad08\nAuthor: Qiang Guan <email address hidden>\nDate:   Tue Dec 11 10:55:35 2012 +0800\n\n    Fix KeyError of log message in virt/libvirt/utils.py\n    \n    Add arguments vg and lv for function check_size() so that locals() can get\n    them.\n    \n    Fixes: bug #1088434\n    \n    Change-Id: I6b5609fe1be7e0bf09a45e65eab91427059a89db\n", 
            "date_created": "2012-12-13 00:00:04.205532+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}