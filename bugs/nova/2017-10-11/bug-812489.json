{
    "status": "Fix Released", 
    "last_updated": "2011-09-22 13:25:36.557491+00:00", 
    "description": "Host isn't being set in network record and tosses the first exception which then causes the other since the hosts field hasn't been populated.  If I restart the network worker, it will then apply the network host to the networks table.\n\n2011-07-18 18:52:49,320 ERROR nova [-] in looping call\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/utils.py\", line 458, in _inner\n(nova): TRACE:     self.f(*self.args, **self.kw)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/service.py\", line 266, in periodic_tasks\n(nova): TRACE:     self.manager.periodic_tasks(context.get_admin_context())\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/network/manager.py\", line 327, in periodic_tasks\n(nova): TRACE:     self.set_network_hosts(context)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/network/manager.py\", line 347, in set_network_hosts\n(nova): TRACE:     for network in networks:\n(nova): TRACE: UnboundLocalError: local variable 'networks' referenced before assignment\n(nova): TRACE: \n2011-07-18 18:56:54,395 DEBUG nova.rpc [-] received {u'_msg_id': u'd0e74c04750b4e4b9eacdf40876682f0', u'_context_read_deleted': False, u'_context_request_id': u'VE-KSUQSY8P1SDGTMK7U', u'args': {u'instance_id': 9, u'vpn': False, u'project_id': u'ozone', u'instance_type_id': 2}, u'_context_is_admin': True, u'_context_timestamp': u'2011-07-18T18:56:51Z', u'_context_user': u'ant', u'method': u'allocate_for_instance', u'_context_project': u'ozone', u'_context_remote_address': None} from (pid=25770) process_data /usr/lib/pymodules/python2.6/nova/rpc.py:202\n2011-07-18 18:56:54,395 DEBUG nova.rpc [-] unpacked context: {'timestamp': u'2011-07-18T18:56:51Z', 'msg_id': u'd0e74c04750b4e4b9eacdf40876682f0', 'remote_address': None, 'project': u'ozone', 'is_admin': True, 'user': u'ant', 'request_id': u'VE-KSUQSY8P1SDGTMK7U', 'read_deleted': False} from (pid=25770) _unpack_context /usr/lib/pymodules/python2.6/nova/rpc.py:451\n2011-07-18 18:56:54,396 DEBUG nova.network.manager [VE-KSUQSY8P1SDGTMK7U ant ozone] network allocations for instance 9 from (pid=25770) allocate_for_instance /usr/lib/pymodules/python2.6/nova/network/manager.py:379\n2011-07-18 18:56:54,407 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/rpc.py\", line 232, in _process_data\n(nova): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/network/manager.py\", line 408, in allocate_for_instance\n(nova): TRACE:     return self.get_instance_nw_info(context, instance_id, type_id)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/network/manager.py\", line 438, in get_instance_nw_info\n(nova): TRACE:     fixed_ips = self.db.fixed_ip_get_by_instance(context, instance_id)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/api.py\", line 376, in fixed_ip_get_by_instance\n(nova): TRACE:     return IMPL.fixed_ip_get_by_instance(context, instance_id)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/sqlalchemy/api.py\", line 117, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/sqlalchemy/api.py\", line 798, in fixed_ip_get_by_instance\n(nova): TRACE:     raise exception.FixedIpNotFoundForInstance(instance_id=instance_id)\n(nova): TRACE: FixedIpNotFoundForInstance: Instance 9 has zero fixed ips.\n(nova): TRACE: \n2011-07-18 18:56:54,416 ERROR nova.rpc [-] Returning exception Instance 9 has zero fixed ips. to caller\n\nRev. 1281", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/812489", 
    "owner": "https://api.launchpad.net/1.0/~tr3buchet", 
    "id": 812489, 
    "index": 2200, 
    "created": "2011-07-18 19:09:59.892435+00:00", 
    "title": "Network Host isn't being set without restarting service", 
    "comments": [
        {
            "content": "Host isn't being set in network record and tosses the first exception which then causes the other since the hosts field hasn't been populated.  If I restart the network worker, it will then apply the network host to the networks table.\n\n2011-07-18 18:52:49,320 ERROR nova [-] in looping call\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/utils.py\", line 458, in _inner\n(nova): TRACE:     self.f(*self.args, **self.kw)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/service.py\", line 266, in periodic_tasks\n(nova): TRACE:     self.manager.periodic_tasks(context.get_admin_context())\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/network/manager.py\", line 327, in periodic_tasks\n(nova): TRACE:     self.set_network_hosts(context)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/network/manager.py\", line 347, in set_network_hosts\n(nova): TRACE:     for network in networks:\n(nova): TRACE: UnboundLocalError: local variable 'networks' referenced before assignment\n(nova): TRACE: \n2011-07-18 18:56:54,395 DEBUG nova.rpc [-] received {u'_msg_id': u'd0e74c04750b4e4b9eacdf40876682f0', u'_context_read_deleted': False, u'_context_request_id': u'VE-KSUQSY8P1SDGTMK7U', u'args': {u'instance_id': 9, u'vpn': False, u'project_id': u'ozone', u'instance_type_id': 2}, u'_context_is_admin': True, u'_context_timestamp': u'2011-07-18T18:56:51Z', u'_context_user': u'ant', u'method': u'allocate_for_instance', u'_context_project': u'ozone', u'_context_remote_address': None} from (pid=25770) process_data /usr/lib/pymodules/python2.6/nova/rpc.py:202\n2011-07-18 18:56:54,395 DEBUG nova.rpc [-] unpacked context: {'timestamp': u'2011-07-18T18:56:51Z', 'msg_id': u'd0e74c04750b4e4b9eacdf40876682f0', 'remote_address': None, 'project': u'ozone', 'is_admin': True, 'user': u'ant', 'request_id': u'VE-KSUQSY8P1SDGTMK7U', 'read_deleted': False} from (pid=25770) _unpack_context /usr/lib/pymodules/python2.6/nova/rpc.py:451\n2011-07-18 18:56:54,396 DEBUG nova.network.manager [VE-KSUQSY8P1SDGTMK7U ant ozone] network allocations for instance 9 from (pid=25770) allocate_for_instance /usr/lib/pymodules/python2.6/nova/network/manager.py:379\n2011-07-18 18:56:54,407 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/rpc.py\", line 232, in _process_data\n(nova): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/network/manager.py\", line 408, in allocate_for_instance\n(nova): TRACE:     return self.get_instance_nw_info(context, instance_id, type_id)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/network/manager.py\", line 438, in get_instance_nw_info\n(nova): TRACE:     fixed_ips = self.db.fixed_ip_get_by_instance(context, instance_id)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/api.py\", line 376, in fixed_ip_get_by_instance\n(nova): TRACE:     return IMPL.fixed_ip_get_by_instance(context, instance_id)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/sqlalchemy/api.py\", line 117, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/sqlalchemy/api.py\", line 798, in fixed_ip_get_by_instance\n(nova): TRACE:     raise exception.FixedIpNotFoundForInstance(instance_id=instance_id)\n(nova): TRACE: FixedIpNotFoundForInstance: Instance 9 has zero fixed ips.\n(nova): TRACE: \n2011-07-18 18:56:54,416 ERROR nova.rpc [-] Returning exception Instance 9 has zero fixed ips. to caller\n\nRev. 1281", 
            "date_created": "2011-07-18 19:09:59.892435+00:00", 
            "author": "https://api.launchpad.net/1.0/~antonym"
        }
    ]
}