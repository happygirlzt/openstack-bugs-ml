{
    "status": "Invalid", 
    "last_updated": "2011-11-15 16:34:34.762833+00:00", 
    "description": "ii  nova-ajax-console-proxy           2011.3-0ubuntu6.2                         OpenStack Compute - AJAX console proxy\nii  nova-api                          2011.3-0ubuntu6.2                         OpenStack Compute - API frontend\nii  nova-common                       2011.3-0ubuntu6.2                         OpenStack Compute - common files\nii  nova-compute                      2011.3-0ubuntu6.2                         OpenStack Compute - compute node\nii  nova-compute-lxc                  2011.3-0ubuntu6.2                         OpenStack Compute - compute node (LXC)\nii  nova-network                      2011.3-0ubuntu6.2                         OpenStack Compute - Network manager\nii  nova-objectstore                  2011.3-0ubuntu6.2                         OpenStack Compute - object store\nii  nova-scheduler                    2011.3-0ubuntu6.2                         OpenStack Compute - virtual machine scheduler\nii  nova-vncproxy                     2011.3-0ubuntu6.2                         OpenStack Compute - VNC proxy\nrc  nova-volume                       2011.3-0ubuntu6.2                         OpenStack Compute - storage\nii  python-nova                       2011.3-0ubuntu6.2                         OpenStack Compute Python libraries\nii  python-novaclient                 2.6.4~bzr112-0ubuntu1                     client library for OpenStack Compute API\nii  lxc                               0.7.5-0ubuntu8.1                          Linux containers userspace tools\nii  nova-compute-lxc                  2011.3-0ubuntu6.2                         OpenStack Compute - compute node (LXC)\nii  libvirt-bin                       0.9.2-4ubuntu16                           the programs for the libvirt library\n\n\n\n2011-11-13 22:43:57,702 ERROR nova.exception [-] Uncaught exception\n(nova.exception): TRACE: Traceback (most recent call last):\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 98, in wrapped\n(nova.exception): TRACE:     return f(*args, **kw)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 117, in decorated_function\n(nova.exception): TRACE:     function(self, context, instance_id, *args, **kwargs)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 493, in terminate_instance\n(nova.exception): TRACE:     self._shutdown_instance(context, instance_id, 'Terminating')\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 484, in _shutdown_instance\n(nova.exception): TRACE:     self.driver.destroy(instance, network_info)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 401, in destroy\n(nova.exception): TRACE:     self._cleanup(instance)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 414, in _cleanup\n(nova.exception): TRACE:     shutil.rmtree(target)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/shutil.py\", line 244, in rmtree\n(nova.exception): TRACE:     rmtree(fullname, ignore_errors, onerror)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/shutil.py\", line 244, in rmtree\n(nova.exception): TRACE:     rmtree(fullname, ignore_errors, onerror)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/shutil.py\", line 244, in rmtree\n(nova.exception): TRACE:     rmtree(fullname, ignore_errors, onerror)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/shutil.py\", line 253, in rmtree\n(nova.exception): TRACE:     onerror(os.rmdir, path, sys.exc_info())\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/shutil.py\", line 251, in rmtree\n(nova.exception): TRACE:     os.rmdir(path)\n(nova.exception): TRACE: OSError: [Errno 13] Permission denied: '/var/lib/nova/instances/instance-0000004a/rootfs/dev/pts'\n(nova.exception): TRACE:\n\n\n/etc/nova/nova.conf\n\n--connection_type=libvirt\n--default_image=uec-oneiric-qcow2\n--dhcpbridge=/usr/bin/nova-dhcpbridge\n--dhcpbridge_flagfile=/etc/nova/nova.conf\n--fixed_range=192.168.100.0/22\n--network_size=32\n--vlan_interface=eth1\n--force_dhcp_release=True\n--glance_host=192.168.100.1\n--use_s3=false\n--image_service=nova.image.glance.GlanceImageService\n--iscsi_helper=tgtadm\n--libvirt_type=lxc\n--lock_path=/var/lock/nova\n--logdir=/var/log/nova\n--network_manager=nova.network.manager.VlanManager\n--num_networks=1\n--osapi_extensions_path=/var/lib/nova/extensions/\n--public_interface=eth0\n--sql_connection=postgresql://nova:*******@localhost:5432/nova\n--state_path=/var/lib/nova\n--use_deprecated_auth=false\n--verbose\n--vnc_console_proxy_url=http://192.168.100.1:6080\n--vncproxy_port=8060\n--start_guests_on_host_boot=true\n--dhcp_domain=cloud.koumbit.net", 
    "tags": [
        "lxc"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/890066", 
    "owner": "None", 
    "id": 890066, 
    "index": 2380, 
    "created": "2011-11-14 03:54:56.533073+00:00", 
    "title": "destroy an instance give a permission deny on /dev/pts", 
    "comments": [
        {
            "content": "ii  nova-ajax-console-proxy           2011.3-0ubuntu6.2                         OpenStack Compute - AJAX console proxy\nii  nova-api                          2011.3-0ubuntu6.2                         OpenStack Compute - API frontend\nii  nova-common                       2011.3-0ubuntu6.2                         OpenStack Compute - common files\nii  nova-compute                      2011.3-0ubuntu6.2                         OpenStack Compute - compute node\nii  nova-compute-lxc                  2011.3-0ubuntu6.2                         OpenStack Compute - compute node (LXC)\nii  nova-network                      2011.3-0ubuntu6.2                         OpenStack Compute - Network manager\nii  nova-objectstore                  2011.3-0ubuntu6.2                         OpenStack Compute - object store\nii  nova-scheduler                    2011.3-0ubuntu6.2                         OpenStack Compute - virtual machine scheduler\nii  nova-vncproxy                     2011.3-0ubuntu6.2                         OpenStack Compute - VNC proxy\nrc  nova-volume                       2011.3-0ubuntu6.2                         OpenStack Compute - storage\nii  python-nova                       2011.3-0ubuntu6.2                         OpenStack Compute Python libraries\nii  python-novaclient                 2.6.4~bzr112-0ubuntu1                     client library for OpenStack Compute API\nii  lxc                               0.7.5-0ubuntu8.1                          Linux containers userspace tools\nii  nova-compute-lxc                  2011.3-0ubuntu6.2                         OpenStack Compute - compute node (LXC)\nii  libvirt-bin                       0.9.2-4ubuntu16                           the programs for the libvirt library\n\n\n\n2011-11-13 22:43:57,702 ERROR nova.exception [-] Uncaught exception\n(nova.exception): TRACE: Traceback (most recent call last):\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 98, in wrapped\n(nova.exception): TRACE:     return f(*args, **kw)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 117, in decorated_function\n(nova.exception): TRACE:     function(self, context, instance_id, *args, **kwargs)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 493, in terminate_instance\n(nova.exception): TRACE:     self._shutdown_instance(context, instance_id, 'Terminating')\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 484, in _shutdown_instance\n(nova.exception): TRACE:     self.driver.destroy(instance, network_info)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 401, in destroy\n(nova.exception): TRACE:     self._cleanup(instance)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 414, in _cleanup\n(nova.exception): TRACE:     shutil.rmtree(target)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/shutil.py\", line 244, in rmtree\n(nova.exception): TRACE:     rmtree(fullname, ignore_errors, onerror)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/shutil.py\", line 244, in rmtree\n(nova.exception): TRACE:     rmtree(fullname, ignore_errors, onerror)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/shutil.py\", line 244, in rmtree\n(nova.exception): TRACE:     rmtree(fullname, ignore_errors, onerror)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/shutil.py\", line 253, in rmtree\n(nova.exception): TRACE:     onerror(os.rmdir, path, sys.exc_info())\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/shutil.py\", line 251, in rmtree\n(nova.exception): TRACE:     os.rmdir(path)\n(nova.exception): TRACE: OSError: [Errno 13] Permission denied: '/var/lib/nova/instances/instance-0000004a/rootfs/dev/pts'\n(nova.exception): TRACE:\n\n\n/etc/nova/nova.conf\n\n--connection_type=libvirt\n--default_image=uec-oneiric-qcow2\n--dhcpbridge=/usr/bin/nova-dhcpbridge\n--dhcpbridge_flagfile=/etc/nova/nova.conf\n--fixed_range=192.168.100.0/22\n--network_size=32\n--vlan_interface=eth1\n--force_dhcp_release=True\n--glance_host=192.168.100.1\n--use_s3=false\n--image_service=nova.image.glance.GlanceImageService\n--iscsi_helper=tgtadm\n--libvirt_type=lxc\n--lock_path=/var/lock/nova\n--logdir=/var/log/nova\n--network_manager=nova.network.manager.VlanManager\n--num_networks=1\n--osapi_extensions_path=/var/lib/nova/extensions/\n--public_interface=eth0\n--sql_connection=postgresql://nova:*******@localhost:5432/nova\n--state_path=/var/lib/nova\n--use_deprecated_auth=false\n--verbose\n--vnc_console_proxy_url=http://192.168.100.1:6080\n--vncproxy_port=8060\n--start_guests_on_host_boot=true\n--dhcp_domain=cloud.koumbit.net", 
            "date_created": "2011-11-14 03:54:56.533073+00:00", 
            "author": "https://api.launchpad.net/1.0/~patrick-hetu"
        }, 
        {
            "content": "Sometime, I also have this error, not sure if I need a open a other bug:\n\n2011-11-13 22:59:56,503 WARNING nova.virt.libvirt_conn [-] Error from libvirt during destroy of instance-00000046. Code=1 Error=internal error Some container PIDs refused to die\n2011-11-13 22:59:57,752 ERROR nova.exception [-] Uncaught exception\n(nova.exception): TRACE: Traceback (most recent call last):\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 98, in wrapped\n(nova.exception): TRACE:     return f(*args, **kw)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 565, in reboot\n(nova.exception): TRACE:     self.destroy(instance, network_info, cleanup=False)\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 348, in destroy\n(nova.exception): TRACE:     virt_dom.destroy()\n(nova.exception): TRACE:   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 381, in destroy\n(nova.exception): TRACE:     if ret == -1: raise libvirtError ('virDomainDestroy() failed', dom=self)\n(nova.exception): TRACE: libvirtError: internal error Some container PIDs refused to die\n", 
            "date_created": "2011-11-14 04:03:37.883954+00:00", 
            "author": "https://api.launchpad.net/1.0/~patrick-hetu"
        }, 
        {
            "content": "By \"Sometime\" I mean when I restart nova-compute.", 
            "date_created": "2011-11-14 18:28:53.555284+00:00", 
            "author": "https://api.launchpad.net/1.0/~patrick-hetu"
        }, 
        {
            "content": "To temporarly solved the problem by modifing the file nova/virt/libvirt/connection.py and changed the line 414 from:\n\n  shutil.rmtree(target)\n\nto:\n\n  utils.execute('rm', '-rf', target, run_as_root=True)\n\nin the _cleanup method. I also added the permissions for \"rm\" in the sudoers file.", 
            "date_created": "2011-11-14 21:50:31.649991+00:00", 
            "author": "https://api.launchpad.net/1.0/~patrick-hetu"
        }, 
        {
            "content": "False positive, I got the error \"Device or resource busy\" on the \"rm -fr\"  BUT restarting libvirt-bin makes the directory removable again.", 
            "date_created": "2011-11-15 03:31:20.957325+00:00", 
            "author": "https://api.launchpad.net/1.0/~patrick-hetu"
        }, 
        {
            "content": "So should this bug be closed as an invalid issue ?", 
            "date_created": "2011-11-15 08:48:06.441930+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "Yes Thierry, you can close the bug, I think it's a libvirt-bin issue fixed in newer version.", 
            "date_created": "2011-11-15 15:23:35.350607+00:00", 
            "author": "https://api.launchpad.net/1.0/~patrick-hetu"
        }
    ]
}