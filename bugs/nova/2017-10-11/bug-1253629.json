{
    "status": "Opinion", 
    "last_updated": "2013-12-09 17:35:19.444734+00:00", 
    "description": "stack trace should be printed to log and not command output. \nAs admin a general or specific error would be better and easier to debug than the entire trace mixed in with the command. \n\ni tried booting an instance from a volume while i blocked the connectivity to the nfs server. \nonce the instance failed booting on timeout and changed status to ERROR, I ran nova show <instance UUID>.  \n\nthe print shows stack trace \n\nSteps to Reproduce:\n1. create an nfs server\n2. create a volume \n3. block connectivity to the server using iptables: iptables -A OUTPUT -d >Server>  -j DROP\n4. boot an instance from the volume: nova boot --flavor 2  --block_device_mapping=vda=<volume_uuid>::: <name>\n5. run nova show <instance_UUID>\n\n\nfault                               | {u'message': u'ClientException', u'code': 500, u'details': u'The server has either erred or is incapable of performing the requested ope\nration. (HTTP 500) (Request-ID: req-6cfa3ce9-312b-42f8-a3a2-846d87ae63bb) |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 224, in decorated_function                                      \n                                                                          |\n|                                     |     return function(self, context, *args, **kwargs)                                                                                     \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 1224, in run_instance                                           \n                                                                          |\n|                                     |     do_run_instance()                                                                                                                   \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 242, in inner                                        \n                                                                          |\n|                                     |     retval = f(*args, **kwargs)                                                                                                         \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 1223, in do_run_instance                                        \n                                                                          |\n|                                     |     admin_password, is_first_time, node, instance)                                                                                      \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 879, in _run_instance                                           \n                                                                          |\n|                                     |     self._set_instance_error_state(context, instance[\\'uuid\\'])                                                                         \n                                                                          |\n|                                     |   File \"/usr/lib64/python2.6/contextlib.py\", line 23, in __exit__                                                                       \n                                                                          |\n|                                     |     self.gen.next()                                                                                                                     \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 871, in _run_instance                                           \n                                                                          |\n|                                     |     filter_properties, bdms)                                                                                                            \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 911, in _reschedule_or_reraise                                  \n                                                                          |\n|                                     |     self._log_original_error(exc_info, instance_uuid)                                                                                   \n                                                                          |\n:", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1253629", 
    "owner": "None", 
    "id": 1253629, 
    "index": 4305, 
    "created": "2013-11-21 12:46:20.303024+00:00", 
    "title": "don't print trace in cli command output", 
    "comments": [
        {
            "content": "stack trace should be printed to log and not command output. \nAs admin a general or specific error would be better and easier to debug than the entire trace mixed in with the command. \n\ni tried booting an instance from a volume while i blocked the connectivity to the nfs server. \nonce the instance failed booting on timeout and changed status to ERROR, I ran nova show <instance UUID>.  \n\nthe print shows stack trace \n\nSteps to Reproduce:\n1. create an nfs server\n2. create a volume \n3. block connectivity to the server using iptables: iptables -A OUTPUT -d >Server>  -j DROP\n4. boot an instance from the volume: nova boot --flavor 2  --block_device_mapping=vda=<volume_uuid>::: <name>\n5. run nova show <instance_UUID>\n\n\nfault                               | {u'message': u'ClientException', u'code': 500, u'details': u'The server has either erred or is incapable of performing the requested ope\nration. (HTTP 500) (Request-ID: req-6cfa3ce9-312b-42f8-a3a2-846d87ae63bb) |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 224, in decorated_function                                      \n                                                                          |\n|                                     |     return function(self, context, *args, **kwargs)                                                                                     \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 1224, in run_instance                                           \n                                                                          |\n|                                     |     do_run_instance()                                                                                                                   \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 242, in inner                                        \n                                                                          |\n|                                     |     retval = f(*args, **kwargs)                                                                                                         \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 1223, in do_run_instance                                        \n                                                                          |\n|                                     |     admin_password, is_first_time, node, instance)                                                                                      \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 879, in _run_instance                                           \n                                                                          |\n|                                     |     self._set_instance_error_state(context, instance[\\'uuid\\'])                                                                         \n                                                                          |\n|                                     |   File \"/usr/lib64/python2.6/contextlib.py\", line 23, in __exit__                                                                       \n                                                                          |\n|                                     |     self.gen.next()                                                                                                                     \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 871, in _run_instance                                           \n                                                                          |\n|                                     |     filter_properties, bdms)                                                                                                            \n                                                                          |\n|                                     |   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 911, in _reschedule_or_reraise                                  \n                                                                          |\n|                                     |     self._log_original_error(exc_info, instance_uuid)                                                                                   \n                                                                          |\n:", 
            "date_created": "2013-11-21 12:46:20.303024+00:00", 
            "author": "https://api.launchpad.net/1.0/~dron-3"
        }, 
        {
            "content": "This is a very important feature for trouble shooting, I think we should keep this. This can help end user know what is wrong with the VM and why the VM creation failed.", 
            "date_created": "2013-11-24 14:39:50.954104+00:00", 
            "author": "https://api.launchpad.net/1.0/~jay-lau-513"
        }, 
        {
            "content": "yes. it's very important to print trace but it should be printed to the log and not in the command output :) \n\n1. end user should not be aware that there is an issue in the storage (since they have no way of fixing it any way)\n2. admins will be aware of an issue by monitoring the logs\n3. I am not saying the command output should not print anything, but like any other cli command, if it can't run or have a problem getting the information a general error should be shown and the trace should be printed to the log. \n\n\n ", 
            "date_created": "2013-11-24 20:28:46.809995+00:00", 
            "author": "https://api.launchpad.net/1.0/~dron-3"
        }, 
        {
            "content": "The instance fault information is stored in the database and is tied to the instance when it fails, so as Jay points out it's used for diagnosing problems with the instance.  It's not the CLI that's dumping the stack trace, it's the server code that's storing the stack trace in the InstanceFault table in the database, the nova show API is just show the db record. I don't have a problem with showing the stack trace.", 
            "date_created": "2013-12-08 21:05:20.309659+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Brought this up in #openstack-nova IRC today, here were some thoughts:\n\nhttp://paste.openstack.org/show/54716/", 
            "date_created": "2013-12-09 17:35:18.667695+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }
    ]
}