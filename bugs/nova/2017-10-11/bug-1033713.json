{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:29:19.362044+00:00", 
    "description": "2012-08-06 18:58:32 DEBUG nova.api.ec2 [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] action: DetachVolume from (pid=15071) __call__ /opt/stack/nova/nova/api/ec2/__init__.py:327\naction: DetachVolume\n2012-08-06 18:58:32 DEBUG nova.api.ec2 [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] arg: VolumeId             val: vol-1 from (pid=15071) __call__ /opt/stack/nova/nova/api/ec2/__init__.py:329\narg: VolumeId           val: vol-1\n2012-08-06 18:58:32 DEBUG nova.utils [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] backend <module 'nova.db.sqlalchemy.api' from '/opt/stack/nova/nova/db/sqlalchemy/api.pyc'> from (pid=15071) __get_backend /opt/stack/nova/nova/utils.py:496\nbackend <module 'nova.db.sqlalchemy.api' from '/opt/stack/nova/nova/db/sqlalchemy/api.pyc'>\n2012-08-06 18:58:32 AUDIT nova.api.ec2.cloud [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Detach volume adba91f0-a36f-40e6-bbc7-796448d8fc9a\nDetach volume adba91f0-a36f-40e6-bbc7-796448d8fc9a\n2012-08-06 18:58:32 DEBUG nova.volume.cinder [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Cinderclient connection created using URL: http://192.168.1.103:8776/v1/bc02ec05c5fa4a5bb3020b617f3574e2 from (pid=15071) cinderclient /opt/stack/nova/nova\n/volume/cinder.py:47\nCinderclient connection created using URL: http://192.168.1.103:8776/v1/bc02ec05c5fa4a5bb3020b617f3574e2\n2012-08-06 18:58:32 INFO nova.api.ec2.cloud [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] !!!! {'status': u'available', 'volume_type_id': u'None', 'display_name': None, 'attach_time': '', 'availability_zone': u'cinder', 'created_at': u'2012-08-06\nT23:53:21.000000', 'attach_status': 'detached', 'display_description': None, 'volume_metadata': [], 'snapshot_id': None, 'mountpoint': '', 'id': u'adba91f0-a36f-40e6-bbc7-796448d8fc9a', 'size': 1}\n!!!! {'status': u'available', 'volume_type_id': u'None', 'display_name': None, 'attach_time': '', 'availability_zone': u'cinder', 'created_at': u'2012-08-06T23:53:21.000000', 'attach_status': 'detached', 'display_description': None, 'volume_metadata': [\n], 'snapshot_id': None, 'mountpoint': '', 'id': u'adba91f0-a36f-40e6-bbc7-796448d8fc9a', 'size': 1}\n2012-08-06 18:58:32 DEBUG nova.volume.cinder [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Cinderclient connection created using URL: http://192.168.1.103:8776/v1/bc02ec05c5fa4a5bb3020b617f3574e2 from (pid=15071) cinderclient /opt/stack/nova/nova\n/volume/cinder.py:47\nCinderclient connection created using URL: http://192.168.1.103:8776/v1/bc02ec05c5fa4a5bb3020b617f3574e2\n2012-08-06 18:58:32 ERROR nova.api.ec2 [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Unexpected error raised: 'instance_uuid'\n2012-08-06 18:58:32 TRACE nova.api.ec2 Traceback (most recent call last):\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/__init__.py\", line 474, in __call__\n2012-08-06 18:58:32 TRACE nova.api.ec2     result = api_request.invoke(context)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/apirequest.py\", line 81, in invoke\n2012-08-06 18:58:32 TRACE nova.api.ec2     result = method(context, **args)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/cloud.py\", line 799, in detach_volume\n2012-08-06 18:58:32 TRACE nova.api.ec2     self.compute_api.detach_volume(context,volume_id=volume_id)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/compute/api.py\", line 1642, in detach_volume\n2012-08-06 18:58:32 TRACE nova.api.ec2     instance_uuid = volume['instance_uuid']\n2012-08-06 18:58:32 TRACE nova.api.ec2 KeyError: 'instance_uuid'\nUnexpected error raised: 'instance_uuid'\n2012-08-06 18:58:32 TRACE nova.api.ec2 Traceback (most recent call last):\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/__init__.py\", line 474, in __call__\n2012-08-06 18:58:32 TRACE nova.api.ec2     result = api_request.invoke(context)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/apirequest.py\", line 81, in invoke\n2012-08-06 18:58:32 TRACE nova.api.ec2     result = method(context, **args)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/cloud.py\", line 799, in detach_volume\n2012-08-06 18:58:32 TRACE nova.api.ec2     self.compute_api.detach_volume(context,volume_id=volume_id)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/compute/api.py\", line 1642, in detach_volume\n2012-08-06 18:58:32 TRACE nova.api.ec2     instance_uuid = volume['instance_uuid']\n2012-08-06 18:58:32 TRACE nova.api.ec2 KeyError: 'instance_uuid'\n2012-08-06 18:58:32 TRACE nova.api.ec2 \n2012-08-06 18:58:32 ERROR nova.api.ec2 [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Environment: {\"CONTENT_TYPE\": \"application/x-www-form-urlencoded; charset=UTF-8\", \"SCRIPT_NAME\": \"/services/Cloud\", \"REQUEST_METHOD\": \"POST\", \"HTTP_HOST\": \"192.168.1.103:8773\", \"PATH_INFO\": \"/\", \"SERVER_PROTOCOL\": \"HTTP/1.0\", \"HTTP_USER_AGENT\": \"Boto/2.1.1 (linux2)\", \"SERVER_NAME\": \"192.168.1.103\", \"REMOTE_ADDR\": \"192.168.1.103\", \"wsgi.url_scheme\": \"http\", \"SERVER_PORT\": \"8773\", \"GATEWAY_INTERFACE\": \"CGI/1.1\", \"HTTP_ACCEPT_ENCODING\": \"identity\"}", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1033713", 
    "owner": "https://api.launchpad.net/1.0/~zulcss", 
    "id": 1033713, 
    "index": 3013, 
    "created": "2012-08-07 00:07:37.658541+00:00", 
    "title": "Traceback when detaching volumes when using cinder.", 
    "comments": [
        {
            "content": "2012-08-06 18:58:32 DEBUG nova.api.ec2 [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] action: DetachVolume from (pid=15071) __call__ /opt/stack/nova/nova/api/ec2/__init__.py:327\naction: DetachVolume\n2012-08-06 18:58:32 DEBUG nova.api.ec2 [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] arg: VolumeId             val: vol-1 from (pid=15071) __call__ /opt/stack/nova/nova/api/ec2/__init__.py:329\narg: VolumeId           val: vol-1\n2012-08-06 18:58:32 DEBUG nova.utils [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] backend <module 'nova.db.sqlalchemy.api' from '/opt/stack/nova/nova/db/sqlalchemy/api.pyc'> from (pid=15071) __get_backend /opt/stack/nova/nova/utils.py:496\nbackend <module 'nova.db.sqlalchemy.api' from '/opt/stack/nova/nova/db/sqlalchemy/api.pyc'>\n2012-08-06 18:58:32 AUDIT nova.api.ec2.cloud [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Detach volume adba91f0-a36f-40e6-bbc7-796448d8fc9a\nDetach volume adba91f0-a36f-40e6-bbc7-796448d8fc9a\n2012-08-06 18:58:32 DEBUG nova.volume.cinder [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Cinderclient connection created using URL: http://192.168.1.103:8776/v1/bc02ec05c5fa4a5bb3020b617f3574e2 from (pid=15071) cinderclient /opt/stack/nova/nova\n/volume/cinder.py:47\nCinderclient connection created using URL: http://192.168.1.103:8776/v1/bc02ec05c5fa4a5bb3020b617f3574e2\n2012-08-06 18:58:32 INFO nova.api.ec2.cloud [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] !!!! {'status': u'available', 'volume_type_id': u'None', 'display_name': None, 'attach_time': '', 'availability_zone': u'cinder', 'created_at': u'2012-08-06\nT23:53:21.000000', 'attach_status': 'detached', 'display_description': None, 'volume_metadata': [], 'snapshot_id': None, 'mountpoint': '', 'id': u'adba91f0-a36f-40e6-bbc7-796448d8fc9a', 'size': 1}\n!!!! {'status': u'available', 'volume_type_id': u'None', 'display_name': None, 'attach_time': '', 'availability_zone': u'cinder', 'created_at': u'2012-08-06T23:53:21.000000', 'attach_status': 'detached', 'display_description': None, 'volume_metadata': [\n], 'snapshot_id': None, 'mountpoint': '', 'id': u'adba91f0-a36f-40e6-bbc7-796448d8fc9a', 'size': 1}\n2012-08-06 18:58:32 DEBUG nova.volume.cinder [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Cinderclient connection created using URL: http://192.168.1.103:8776/v1/bc02ec05c5fa4a5bb3020b617f3574e2 from (pid=15071) cinderclient /opt/stack/nova/nova\n/volume/cinder.py:47\nCinderclient connection created using URL: http://192.168.1.103:8776/v1/bc02ec05c5fa4a5bb3020b617f3574e2\n2012-08-06 18:58:32 ERROR nova.api.ec2 [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Unexpected error raised: 'instance_uuid'\n2012-08-06 18:58:32 TRACE nova.api.ec2 Traceback (most recent call last):\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/__init__.py\", line 474, in __call__\n2012-08-06 18:58:32 TRACE nova.api.ec2     result = api_request.invoke(context)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/apirequest.py\", line 81, in invoke\n2012-08-06 18:58:32 TRACE nova.api.ec2     result = method(context, **args)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/cloud.py\", line 799, in detach_volume\n2012-08-06 18:58:32 TRACE nova.api.ec2     self.compute_api.detach_volume(context,volume_id=volume_id)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/compute/api.py\", line 1642, in detach_volume\n2012-08-06 18:58:32 TRACE nova.api.ec2     instance_uuid = volume['instance_uuid']\n2012-08-06 18:58:32 TRACE nova.api.ec2 KeyError: 'instance_uuid'\nUnexpected error raised: 'instance_uuid'\n2012-08-06 18:58:32 TRACE nova.api.ec2 Traceback (most recent call last):\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/__init__.py\", line 474, in __call__\n2012-08-06 18:58:32 TRACE nova.api.ec2     result = api_request.invoke(context)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/apirequest.py\", line 81, in invoke\n2012-08-06 18:58:32 TRACE nova.api.ec2     result = method(context, **args)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/cloud.py\", line 799, in detach_volume\n2012-08-06 18:58:32 TRACE nova.api.ec2     self.compute_api.detach_volume(context,volume_id=volume_id)\n2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/compute/api.py\", line 1642, in detach_volume\n2012-08-06 18:58:32 TRACE nova.api.ec2     instance_uuid = volume['instance_uuid']\n2012-08-06 18:58:32 TRACE nova.api.ec2 KeyError: 'instance_uuid'\n2012-08-06 18:58:32 TRACE nova.api.ec2 \n2012-08-06 18:58:32 ERROR nova.api.ec2 [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Environment: {\"CONTENT_TYPE\": \"application/x-www-form-urlencoded; charset=UTF-8\", \"SCRIPT_NAME\": \"/services/Cloud\", \"REQUEST_METHOD\": \"POST\", \"HTTP_HOST\": \"192.168.1.103:8773\", \"PATH_INFO\": \"/\", \"SERVER_PROTOCOL\": \"HTTP/1.0\", \"HTTP_USER_AGENT\": \"Boto/2.1.1 (linux2)\", \"SERVER_NAME\": \"192.168.1.103\", \"REMOTE_ADDR\": \"192.168.1.103\", \"wsgi.url_scheme\": \"http\", \"SERVER_PORT\": \"8773\", \"GATEWAY_INTERFACE\": \"CGI/1.1\", \"HTTP_ACCEPT_ENCODING\": \"identity\"}", 
            "date_created": "2012-08-07 00:07:37.658541+00:00", 
            "author": "https://api.launchpad.net/1.0/~zulcss"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/10932", 
            "date_created": "2012-08-07 00:29:01.487267+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/10932\nCommitted: http://github.com/openstack/nova/commit/fe264ba158e8dc7f8b249bc6619d7001e7819c5d\nSubmitter: Jenkins\nBranch:    master\n\ncommit fe264ba158e8dc7f8b249bc6619d7001e7819c5d\nAuthor: Chuck Short <email address hidden>\nDate:   Mon Aug 6 19:25:12 2012 -0500\n\n    Fix traceback when detaching volumes via EC2\n    \n    When detaching a volume from an instance it results\n    in the following traceback:\n    \n    Cinderclient connection created using URL: http://192.168.1.103:8776/v1/bc02ec05c5fa4a5bb3020b617f3574e2\n    2012-08-06 18:58:32 ERROR nova.api.ec2 [req-1fd2f017-8a11-481f-b901-ae61d3f55c94 demo demo] Unexpected error raised: 'instance_uuid'\n    2012-08-06 18:58:32 TRACE nova.api.ec2 Traceback (most recent call last):\n    2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/__init__.py\", line 474, in __call__\n    2012-08-06 18:58:32 TRACE nova.api.ec2     result = api_request.invoke(context)\n    2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/apirequest.py\", line 81, in invoke\n    2012-08-06 18:58:32 TRACE nova.api.ec2     result = method(context, **args)\n    2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/api/ec2/cloud.py\", line 799, in detach_volume\n    2012-08-06 18:58:32 TRACE nova.api.ec2     self.compute_api.detach_volume(context,volume_id=volume_id)\n    2012-08-06 18:58:32 TRACE nova.api.ec2   File \"/opt/stack/nova/nova/compute/api.py\", line 1642, in detach_volume\n    2012-08-06 18:58:32 TRACE nova.api.ec2     instance_uuid = volume['instance_uuid']\n    2012-08-06 18:58:32 TRACE nova.api.ec2 KeyError: 'instance_uuid'\n    \n    By the time the volume in the cinder database the instance_uuid is already 'NULL',\n    so get the instance_uuid from the volume before its detached.\n    \n    Fixes LP: #1033713\n    \n    Change-Id: Id5515881b08af9d0832b4b620c03e471fdff0823\n    Signed-off-by: Chuck Short <email address hidden>\n", 
            "date_created": "2012-08-09 16:49:27.087441+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}