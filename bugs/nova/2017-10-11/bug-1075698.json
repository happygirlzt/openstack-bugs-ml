{
    "status": "Invalid", 
    "last_updated": "2012-12-12 16:15:10.783247+00:00", 
    "description": "Nova works just fine:\n\nroot@control01:~# nova list\n+--------------------------------------+------+--------+---------------------------------------+\n|                  ID                  | Name | Status |                Networks               |\n+--------------------------------------+------+--------+---------------------------------------+\n| abbfff1e-893b-47f3-8ec1-a0840fab9be5 | p1   | ACTIVE | novanetwork=10.0.0.2, 192.168.220.98  |\n| e316c810-4112-457d-bbc4-f556c9c0ce72 | p2   | ACTIVE | novanetwork=10.0.0.10, 192.168.220.99 |\n+--------------------------------------+------+--------+---------------------------------------+\n\nI change the nova db password to include a + (plus sign):\n\nroot@control01:~# grep mysql /etc/nova/nova.conf \n--sql_connection=mysql://nova:nova+pass@192.168.220.40/nova\n\nMysql accepts the new password:\n\nroot@control01:~# mysql\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 74975\nServer version: 5.5.23 Source distribution, wsrep_23.6.r3755\n\nCopyright (c) 2000, 2012, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> use nova;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql> GRANT ALL ON nova.* TO 'nova'@'%' IDENTIFIED BY 'nova+pass';\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> quit\n\nroot@control01:~# mysql -h192.168.220.40 -unova -pnova+pass nova\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 77322\nServer version: 5.5.23 Source distribution, wsrep_23.6.r3755\n\nCopyright (c) 2000, 2012, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> quit\n\nI restart nova services on Controller, but scheduler does not start:\n\nroot@control01:~# service nova-api restart\nnova-api stop/waiting\nnova-api start/running, process 30253\nroot@control01:~# service nova-scheduler restart\nnova-scheduler stop/waiting\nnova-scheduler start/running, process 30363\nroot@control01:~# grep mysql /etc/nova/nova.conf ^C\nroot@control01:~# service nova-consoleauth restart\nnova-consoleauth stop/waiting\nnova-consoleauth start/running, process 31833\nroot@control01:~# service novnc restart\n * Restarting OpenStack NoVNC proxy nova-novncproxy                                                                            [ OK ] \nroot@control01:~# service nova-api status\nnova-api start/running, process 30253\nroot@control01:~# service nova-scheduler status\nnova-scheduler stop/waiting\n\nThe scheduler log shows:\n\n2012-11-05 23:38:19 WARNING nova.db.sqlalchemy.session [-] Got mysql server has gone away: (2006, 'MySQL server has gone away')\n2012-11-06 18:41:54 AUDIT nova.service [-] Starting scheduler node (version 2012.1.3-LOCALBRANCH:LOCALREVISION)\n2012-11-06 18:41:54 CRITICAL nova [-] (OperationalError) (1045, \"Access denied for user 'nova'@'swiftproxy01.dmz-pod2.lab' (using password: YES)\") None None\n\nI do the same on a Compute Node:\n\nroot@compute01:~# grep mysql /etc/nova/nova.conf \n--sql_connection=mysql://nova:nova+pass@192.168.220.40/nova\n\nI am unable to restart Compute Node services (api, compute, network and volume):\n\nroot@compute01:~# service nova-compute status\nnova-compute stop/waiting\nroot@compute01:~# service nova-network status\nnova-network stop/waiting\n\nI see the following in the logs:\n\n2012-11-06 18:43:45 AUDIT nova.service [-] Starting compute node (version 2012.1.3-LOCALBRANCH:LOCALREVISION)\n2012-11-06 18:43:45 CRITICAL nova [-] (OperationalError) (1045, \"Access denied for user 'nova'@'swiftproxy01.dmz-pod2.lab' (using password: YES)\") None None\n\nWhen I change the password to a password that does not include a +, everything works again:\n\nroot@compute01:~# nova list\n+--------------------------------------+------+--------+---------------------------------------+\n|                  ID                  | Name | Status |                Networks               |\n+--------------------------------------+------+--------+---------------------------------------+\n| abbfff1e-893b-47f3-8ec1-a0840fab9be5 | p1   | ACTIVE | novanetwork=10.0.0.2, 192.168.220.98  |\n| e316c810-4112-457d-bbc4-f556c9c0ce72 | p2   | ACTIVE | novanetwork=10.0.0.10, 192.168.220.99 |\n+--------------------------------------+------+--------+---------------------------------------+\n\nroot@compute01:~# nova-manage service list\nBinary           Host                                 Zone             Status     State Updated_At\nnova-consoleauth control01                            nova             enabled    :-)   2012-11-06 18:58:23\nnova-scheduler   control01                            nova             enabled    :-)   2012-11-06 18:58:18\nnova-compute     compute01                            nova             enabled    :-)   2012-11-06 18:58:12\nnova-network     compute01                            nova             enabled    :-)   2012-11-06 18:58:18\nnova-volume      compute01                            nova             enabled    :-)   2012-11-06 18:58:21\nnova-consoleauth control02                            nova             enabled    :-)   2012-11-06 18:58:19\nnova-scheduler   control02                            nova             enabled    :-)   2012-11-06 18:58:18\nnova-consoleauth control03                            nova             enabled    :-)   2012-11-06 18:58:18\nnova-scheduler   control03                            nova             enabled    :-)   2012-11-06 18:58:18", 
    "tags": [
        "ops"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1075698", 
    "owner": "None", 
    "id": 1075698, 
    "index": 3190, 
    "created": "2012-11-06 18:58:54.642715+00:00", 
    "title": "Nova does not support + (plus sign) in database password", 
    "comments": [
        {
            "content": "Nova works just fine:\n\nroot@control01:~# nova list\n+--------------------------------------+------+--------+---------------------------------------+\n|                  ID                  | Name | Status |                Networks               |\n+--------------------------------------+------+--------+---------------------------------------+\n| abbfff1e-893b-47f3-8ec1-a0840fab9be5 | p1   | ACTIVE | novanetwork=10.0.0.2, 192.168.220.98  |\n| e316c810-4112-457d-bbc4-f556c9c0ce72 | p2   | ACTIVE | novanetwork=10.0.0.10, 192.168.220.99 |\n+--------------------------------------+------+--------+---------------------------------------+\n\nI change the nova db password to include a + (plus sign):\n\nroot@control01:~# grep mysql /etc/nova/nova.conf \n--sql_connection=mysql://nova:nova+pass@192.168.220.40/nova\n\nMysql accepts the new password:\n\nroot@control01:~# mysql\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 74975\nServer version: 5.5.23 Source distribution, wsrep_23.6.r3755\n\nCopyright (c) 2000, 2012, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> use nova;\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nDatabase changed\nmysql> GRANT ALL ON nova.* TO 'nova'@'%' IDENTIFIED BY 'nova+pass';\nQuery OK, 0 rows affected (0.01 sec)\n\nmysql> quit\n\nroot@control01:~# mysql -h192.168.220.40 -unova -pnova+pass nova\nReading table information for completion of table and column names\nYou can turn off this feature to get a quicker startup with -A\n\nWelcome to the MySQL monitor.  Commands end with ; or \\g.\nYour MySQL connection id is 77322\nServer version: 5.5.23 Source distribution, wsrep_23.6.r3755\n\nCopyright (c) 2000, 2012, Oracle and/or its affiliates. All rights reserved.\n\nOracle is a registered trademark of Oracle Corporation and/or its\naffiliates. Other names may be trademarks of their respective\nowners.\n\nType 'help;' or '\\h' for help. Type '\\c' to clear the current input statement.\n\nmysql> quit\n\nI restart nova services on Controller, but scheduler does not start:\n\nroot@control01:~# service nova-api restart\nnova-api stop/waiting\nnova-api start/running, process 30253\nroot@control01:~# service nova-scheduler restart\nnova-scheduler stop/waiting\nnova-scheduler start/running, process 30363\nroot@control01:~# grep mysql /etc/nova/nova.conf ^C\nroot@control01:~# service nova-consoleauth restart\nnova-consoleauth stop/waiting\nnova-consoleauth start/running, process 31833\nroot@control01:~# service novnc restart\n * Restarting OpenStack NoVNC proxy nova-novncproxy                                                                            [ OK ] \nroot@control01:~# service nova-api status\nnova-api start/running, process 30253\nroot@control01:~# service nova-scheduler status\nnova-scheduler stop/waiting\n\nThe scheduler log shows:\n\n2012-11-05 23:38:19 WARNING nova.db.sqlalchemy.session [-] Got mysql server has gone away: (2006, 'MySQL server has gone away')\n2012-11-06 18:41:54 AUDIT nova.service [-] Starting scheduler node (version 2012.1.3-LOCALBRANCH:LOCALREVISION)\n2012-11-06 18:41:54 CRITICAL nova [-] (OperationalError) (1045, \"Access denied for user 'nova'@'swiftproxy01.dmz-pod2.lab' (using password: YES)\") None None\n\nI do the same on a Compute Node:\n\nroot@compute01:~# grep mysql /etc/nova/nova.conf \n--sql_connection=mysql://nova:nova+pass@192.168.220.40/nova\n\nI am unable to restart Compute Node services (api, compute, network and volume):\n\nroot@compute01:~# service nova-compute status\nnova-compute stop/waiting\nroot@compute01:~# service nova-network status\nnova-network stop/waiting\n\nI see the following in the logs:\n\n2012-11-06 18:43:45 AUDIT nova.service [-] Starting compute node (version 2012.1.3-LOCALBRANCH:LOCALREVISION)\n2012-11-06 18:43:45 CRITICAL nova [-] (OperationalError) (1045, \"Access denied for user 'nova'@'swiftproxy01.dmz-pod2.lab' (using password: YES)\") None None\n\nWhen I change the password to a password that does not include a +, everything works again:\n\nroot@compute01:~# nova list\n+--------------------------------------+------+--------+---------------------------------------+\n|                  ID                  | Name | Status |                Networks               |\n+--------------------------------------+------+--------+---------------------------------------+\n| abbfff1e-893b-47f3-8ec1-a0840fab9be5 | p1   | ACTIVE | novanetwork=10.0.0.2, 192.168.220.98  |\n| e316c810-4112-457d-bbc4-f556c9c0ce72 | p2   | ACTIVE | novanetwork=10.0.0.10, 192.168.220.99 |\n+--------------------------------------+------+--------+---------------------------------------+\n\nroot@compute01:~# nova-manage service list\nBinary           Host                                 Zone             Status     State Updated_At\nnova-consoleauth control01                            nova             enabled    :-)   2012-11-06 18:58:23\nnova-scheduler   control01                            nova             enabled    :-)   2012-11-06 18:58:18\nnova-compute     compute01                            nova             enabled    :-)   2012-11-06 18:58:12\nnova-network     compute01                            nova             enabled    :-)   2012-11-06 18:58:18\nnova-volume      compute01                            nova             enabled    :-)   2012-11-06 18:58:21\nnova-consoleauth control02                            nova             enabled    :-)   2012-11-06 18:58:19\nnova-scheduler   control02                            nova             enabled    :-)   2012-11-06 18:58:18\nnova-consoleauth control03                            nova             enabled    :-)   2012-11-06 18:58:18\nnova-scheduler   control03                            nova             enabled    :-)   2012-11-06 18:58:18", 
            "date_created": "2012-11-06 18:58:54.642715+00:00", 
            "author": "https://api.launchpad.net/1.0/~danehans"
        }, 
        {
            "content": "The db connection string is handed to sqlalchemy, which uses RFC-1738 style URLs, where + is a special character. What happens if you replace the + with %2B ?", 
            "date_created": "2012-11-06 23:33:42.978748+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }, 
        {
            "content": "Thanks for the feedback.  I didn't realize sqlalchemy required url encoding for special characters.  Replacing the + with %2B for Nova and Keystone worked but not for Glance.  Glance required an additional %  \n\nThis inconsistency can definitely cause operational issues.  It appears someone has already filed a bug, but I don't see when or if it will be fixed:\n\nhttps://bugs.launchpad.net/glance/+bug/1043662\n\n", 
            "date_created": "2012-11-09 03:23:13.590601+00:00", 
            "author": "https://api.launchpad.net/1.0/~danehans"
        }
    ]
}