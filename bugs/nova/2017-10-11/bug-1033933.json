{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:44:02.114463+00:00", 
    "description": "Using devstack with on an XCP-XAPI enabled Precise, nova-compute fails to start. I am using xenapi.XenAPIDriver:\n\nstack@DevStackOSDomU:~/nova$ cat /etc/nova/nova.conf  | grep compute_driver\ncompute_driver=xenapi.XenAPIDriver\n\nstack@DevStackOSDomU:~/nova$ cd /opt/stack/nova && sg libvirtd /opt/stack/nova/bin/nova-compute\n...\n2012-08-07 11:12:21 TRACE nova Traceback (most recent call last):\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/bin/nova-compute\", line 46, in <module>\n2012-08-07 11:12:21 TRACE nova     server = service.Service.create(binary='nova-compute')\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/service.py\", line 492, in create\n2012-08-07 11:12:21 TRACE nova     periodic_fuzzy_delay=periodic_fuzzy_delay)\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/service.py\", line 387, in __init__\n2012-08-07 11:12:21 TRACE nova     self.manager = manager_class(host=self.host, *args, **kwargs)\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/compute/manager.py\", line 288, in __init__\n2012-08-07 11:12:21 TRACE nova     importutils.import_object_ns('nova.virt', compute_driver),\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/openstack/common/importutils.py\", line 51, in import_object_ns\n2012-08-07 11:12:21 TRACE nova     return import_class(import_value)(*args, **kwargs)\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/virt/xenapi/driver.py\", line 146, in __init__\n2012-08-07 11:12:21 TRACE nova     self._session = XenAPISession(url, username, password)\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/virt/xenapi/driver.py\", line 595, in __init__\n2012-08-07 11:12:21 TRACE nova     self._get_product_version_and_brand()\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/virt/xenapi/driver.py\", line 644, in _get_product_version_and_brand\n2012-08-07 11:12:21 TRACE nova     software_version['product_version'].split('.'))\n2012-08-07 11:12:21 TRACE nova KeyError: 'product_version'\n2012-08-07 11:12:21 TRACE nova\n\nThe problem is, that the software_version dictionary does not contain the product_version key.\nHere is the dumped software_version reported by xcp-xapi:\n\n{'build_number': '0',\n\u00a0'date': '2012-08-03',\n\u00a0'hostname': 'komainu',\n\u00a0'linux': '3.2.0-27-generic',\n\u00a0'network_backend': 'bridge',\n\u00a0'platform_name': 'XCP_Kronos',\n\u00a0'platform_version': '1.6.0',\n\u00a0'xapi': '1.3',\n\u00a0'xen': '4.1.2',\n\u00a0'xencenter_max': '1.10',\n\u00a0'xencenter_min': '1.10'}\n\nA more generic solution would be to implement bug 1025216.", 
    "tags": [
        "xcp-xapi", 
        "xenserver"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1033933", 
    "owner": "https://api.launchpad.net/1.0/~mate-lakat", 
    "id": 1033933, 
    "index": 2998, 
    "created": "2012-08-07 11:21:37.369880+00:00", 
    "title": "product_version is missing from software_version on xcp-xapi", 
    "comments": [
        {
            "content": "Using devstack with on an XCP-XAPI enabled Precise, nova-compute fails to start. I am using xenapi.XenAPIDriver:\n\nstack@DevStackOSDomU:~/nova$ cat /etc/nova/nova.conf  | grep compute_driver\ncompute_driver=xenapi.XenAPIDriver\n\nstack@DevStackOSDomU:~/nova$ cd /opt/stack/nova && sg libvirtd /opt/stack/nova/bin/nova-compute\n...\n2012-08-07 11:12:21 TRACE nova Traceback (most recent call last):\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/bin/nova-compute\", line 46, in <module>\n2012-08-07 11:12:21 TRACE nova     server = service.Service.create(binary='nova-compute')\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/service.py\", line 492, in create\n2012-08-07 11:12:21 TRACE nova     periodic_fuzzy_delay=periodic_fuzzy_delay)\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/service.py\", line 387, in __init__\n2012-08-07 11:12:21 TRACE nova     self.manager = manager_class(host=self.host, *args, **kwargs)\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/compute/manager.py\", line 288, in __init__\n2012-08-07 11:12:21 TRACE nova     importutils.import_object_ns('nova.virt', compute_driver),\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/openstack/common/importutils.py\", line 51, in import_object_ns\n2012-08-07 11:12:21 TRACE nova     return import_class(import_value)(*args, **kwargs)\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/virt/xenapi/driver.py\", line 146, in __init__\n2012-08-07 11:12:21 TRACE nova     self._session = XenAPISession(url, username, password)\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/virt/xenapi/driver.py\", line 595, in __init__\n2012-08-07 11:12:21 TRACE nova     self._get_product_version_and_brand()\n2012-08-07 11:12:21 TRACE nova   File \"/opt/stack/nova/nova/virt/xenapi/driver.py\", line 644, in _get_product_version_and_brand\n2012-08-07 11:12:21 TRACE nova     software_version['product_version'].split('.'))\n2012-08-07 11:12:21 TRACE nova KeyError: 'product_version'\n2012-08-07 11:12:21 TRACE nova \n\nThe problem is, that the software_version dictionary does not contain the product_version key.\nHere is the dumped software_version reported by xcp-xapi:\n\n{'build_number': '0',\n 'date': '2012-08-03',\n 'hostname': 'komainu',\n 'linux': '3.2.0-27-generic',\n 'network_backend': 'bridge',\n 'platform_name': 'XCP_Kronos',\n 'platform_version': '1.6.0',\n 'xapi': '1.3',\n 'xen': '4.1.2',\n 'xencenter_max': '1.10',\n 'xencenter_min': '1.10'}", 
            "date_created": "2012-08-07 11:21:37.369880+00:00", 
            "author": "https://api.launchpad.net/1.0/~mate-lakat"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/11337", 
            "date_created": "2012-08-14 14:43:15.328565+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/11337\nCommitted: http://github.com/openstack/nova/commit/ff17c6fd898403da58c30672fe0276be75f410e3\nSubmitter: Jenkins\nBranch:    master\n\ncommit ff17c6fd898403da58c30672fe0276be75f410e3\nAuthor: Mate Lakat <email address hidden>\nDate:   Tue Aug 14 14:50:50 2012 +0100\n\n    XCP-XAPI version fix\n    \n    Fixes bug 1033933.\n    \n    On an Kronos installation (Ubuntu + XCP-XAPI), the reported\n    software_version dictionary did not contain both product_version and\n    product_brand. This caused a KeyError. With this fix, the session's\n    product_version and product_brand will default to None in such cases.\n    The resize operation's name in these cases will default to VDI.resize.\n    \n    Change-Id: Ic0db4128a7b27c08c24461562423bcecd1373e58\n", 
            "date_created": "2012-08-24 15:58:42.986921+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}