{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:43:42.504413+00:00", 
    "description": "When trying to resize a volume that was booted without an image specified it fails with cryptic \"resource not found\".\n\nExpected result: it should be possible to resize a volume backed instance.\n\nMore details:\n\n[ndipanov@devstack devstack]$ cinder create --display_name image_vol --image-id $IMAGE 1\n[ndipanov@devstack devstack]$ nova boot --flavor 1 --block-device-mapping vda=$VOLUME:::0 test_volume_boot\n[ndipanov@devstack devstack]$ nova resize 6067a8f0-107d-430c-a67c-f31802b160b8 2\nERROR: The resource could not be found. (HTTP 404) (Request-ID: req-14d859d3-9c07-4d01-b6f4-8974046d5d63)\n\nIn the API logs:\n2013-05-20 17:20:22.981 ERROR nova.api.openstack [req-14d859d3-9c07-4d01-b6f4-8974046d5d63 demo demo] Caught error: Image  could not be found.\n2013-05-20 17:20:22.981 TRACE nova.api.openstack Traceback (most recent call last):\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 83, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return req.get_response(self.application)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/request.py\", line 1296, in send\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     application, catch_exc_info=False)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/request.py\", line 1260, in call_application\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 144, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 456, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return self.app(env, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 144, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 144, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 144, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/routes/middleware.py\", line 131, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 144, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 130, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 195, in call_func\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 899, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     content_type, body, accept)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 953, in _process_stack\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 1032, in dispatch\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return method(req=request, **action_args)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/servers.py\", line 1211, in _action_resize\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return self._resize(req, id, flavor_ref, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/servers.py\", line 1091, in _resize\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     self.compute_api.resize(context, instance, flavor_id, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 169, in wrapped\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return func(self, context, target, *args, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 159, in inner\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return function(self, context, instance, *args, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 140, in inner\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return f(self, context, instance, *args, **kw)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 2023, in resize\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     image = self.image_service.show(context, instance['image_ref'])\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/image/glance.py\", line 239, in show\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     _reraise_translated_image_exception(image_id)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/image/glance.py\", line 237, in show\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     image = self._client.call(context, 1, 'get', image_id)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/image/glance.py\", line 182, in call\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return getattr(client.images, method)(*args, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/python-glanceclient/glanceclient/v1/images.py\", line 104, in get\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     % urllib.quote(image_id))\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 260, in raw_request\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return self._http_request(url, method, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 221, in _http_request\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     raise exc.from_response(resp, body_str)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack ImageNotFound: Image  could not be found.", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 12, 
    "link": "https://bugs.launchpad.net/nova/+bug/1182114", 
    "owner": "https://api.launchpad.net/1.0/~ndipanov", 
    "id": 1182114, 
    "index": 3398, 
    "created": "2013-05-20 15:24:25.303307+00:00", 
    "title": "Cannot resize a volume backed instance booted without an image", 
    "comments": [
        {
            "content": "When trying to resize a volume that was booted without an image specified it fails with cryptic \"resource not found\".\n\nExpected result: it should be possible to resize a volume backed instance.\n\nMore details:\n\n[ndipanov@devstack devstack]$ cinder create --display_name image_vol --image-id $IMAGE 1\n[ndipanov@devstack devstack]$ nova boot --flavor 1 --block-device-mapping vda=$VOLUME:::0 test_volume_boot\n[ndipanov@devstack devstack]$ nova resize 6067a8f0-107d-430c-a67c-f31802b160b8 2\nERROR: The resource could not be found. (HTTP 404) (Request-ID: req-14d859d3-9c07-4d01-b6f4-8974046d5d63)\n\nIn the API logs:\n2013-05-20 17:20:22.981 ERROR nova.api.openstack [req-14d859d3-9c07-4d01-b6f4-8974046d5d63 demo demo] Caught error: Image  could not be found.\n2013-05-20 17:20:22.981 TRACE nova.api.openstack Traceback (most recent call last):\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 83, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return req.get_response(self.application)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/request.py\", line 1296, in send\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     application, catch_exc_info=False)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/request.py\", line 1260, in call_application\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 144, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 456, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return self.app(env, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 144, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 144, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 144, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/routes/middleware.py\", line 131, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 144, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 130, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/usr/lib/python2.7/site-packages/webob/dec.py\", line 195, in call_func\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 899, in __call__\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     content_type, body, accept)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 953, in _process_stack\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 1032, in dispatch\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return method(req=request, **action_args)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/servers.py\", line 1211, in _action_resize\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return self._resize(req, id, flavor_ref, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/servers.py\", line 1091, in _resize\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     self.compute_api.resize(context, instance, flavor_id, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 169, in wrapped\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return func(self, context, target, *args, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 159, in inner\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return function(self, context, instance, *args, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 140, in inner\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return f(self, context, instance, *args, **kw)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 2023, in resize\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     image = self.image_service.show(context, instance['image_ref'])\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/image/glance.py\", line 239, in show\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     _reraise_translated_image_exception(image_id)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/image/glance.py\", line 237, in show\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     image = self._client.call(context, 1, 'get', image_id)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/image/glance.py\", line 182, in call\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return getattr(client.images, method)(*args, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/python-glanceclient/glanceclient/v1/images.py\", line 104, in get\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     % urllib.quote(image_id))\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 260, in raw_request\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     return self._http_request(url, method, **kwargs)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack   File \"/opt/stack/python-glanceclient/glanceclient/common/http.py\", line 221, in _http_request\n2013-05-20 17:20:22.981 TRACE nova.api.openstack     raise exc.from_response(resp, body_str)\n2013-05-20 17:20:22.981 TRACE nova.api.openstack ImageNotFound: Image  could not be found.", 
            "date_created": "2013-05-20 15:24:25.303307+00:00", 
            "author": "https://api.launchpad.net/1.0/~ndipanov"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/29786", 
            "date_created": "2013-05-20 15:37:52.136408+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/29786\nCommitted: http://github.com/openstack/nova/commit/4465b705fc7cb7a150a7f8d6f70ccf6c20ff3284\nSubmitter: Jenkins\nBranch:    master\n\ncommit 4465b705fc7cb7a150a7f8d6f70ccf6c20ff3284\nAuthor: Nikola Dipanov <email address hidden>\nDate:   Mon May 20 17:33:47 2013 +0200\n\n    Fix resize when instance has no image\n    \n    This patch makes it possible to resize an instance that has no image\n    supplied (was booted from volume), by avoiding calling the image service\n    and thus causing an uncaught exception, if there was no image suplied in\n    the first place.\n    \n    Fixes bug: 1182114\n    blueprint: improve-boot-from-volume\n    \n    Change-Id: I67d63a7aef699b555897582c74b04e857db7aafb\n", 
            "date_created": "2013-05-22 07:58:19.320577+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/grizzly\nReview: https://review.openstack.org/30061", 
            "date_created": "2013-05-22 08:31:29.458810+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "https://review.openstack.org/#/c/30061", 
            "date_created": "2013-05-22 10:47:17.689842+00:00", 
            "author": "https://api.launchpad.net/1.0/~p-draigbrady"
        }, 
        {
            "content": "I consistently see this, while trying to reproduce with latest trunk:\n\n- That's the latest devstack commit I have -- 683ef75510389d124421f0019df11f73b6959cd9 .\n- nova commit in /opt/stack -- 4465b705fc7cb7a150a7f8d6f70ccf6c20ff3284 (fixes for this bug)\n- \n\n\n$ cinder create --display-name image_vol-test --image_id 52ff39a7-470c-4cbd-b2c2-83420af2a016 1\n+---------------------+--------------------------------------+\n|       Property      |                Value                 |\n+---------------------+--------------------------------------+\n|     attachments     |                  []                  |\n|  availability_zone  |                 nova                 |\n|       bootable      |                false                 |\n|      created_at     |      2013-05-23T08:29:54.897325      |\n| display_description |                 None                 |\n|     display_name    |            image_vol-test            |\n|          id         | 0894c5fb-8565-4ce1-8c84-3bedbb80f6ad |\n|       image_id      | 52ff39a7-470c-4cbd-b2c2-83420af2a016 |\n|       metadata      |                  {}                  |\n|         size        |                  1                   |\n|     snapshot_id     |                 None                 |\n|     source_volid    |                 None                 |\n|        status       |               creating               |\n|     volume_type     |                 None                 |\n+---------------------+--------------------------------------+\n\n\n$ cinder list\n+--------------------------------------+--------+----------------+------+-------------+----------+-------------+\n|                  ID                  | Status |  Display Name  | Size | Volume Type | Bootable | Attached to |\n+--------------------------------------+--------+----------------+------+-------------+----------+-------------+\n| 0894c5fb-8565-4ce1-8c84-3bedbb80f6ad | error  | image_vol-test |  1   |     None    |  false   |             |\n+--------------------------------------+--------+----------------+------+-------------+----------+-------------+\n\n\nFrom the SCREEN logs:\n========\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver Traceback (most recent call last):\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver   File \"/opt/stack/cinder/cinder/volume/driver.py\", line 88, in _try_execute\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver     self._execute(*command, **kwargs)\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver   File \"/opt/stack/cinder/cinder/utils.py\", line 193, in execute\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver     cmd=' '.join(cmd))\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver ProcessExecutionError: Unexpected error while running command.\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver Command: sudo cinder-rootwrap /etc/cinder/rootwrap.conf lvcreate -L 1G -n volume-0894c5fb-8565-4ce1-8c84-3bedbb80f6ad stack-volumes\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver Exit code: 5\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver Stdout: ''\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver Stderr: '  Logical volume \"volume-0894c5fb-8565-4ce1-8c84-3bedbb80f6ad\" already exists in volume group \"stack-volumes\"\\n'\n2013-05-23 04:29:58.126 TRACE cinder.volume.driver \n2013-05-23 04:29:59.128 DEBUG cinder.utils [req-b9b4269a-008f-4a98-9e4c-cd5a83b31ad5 f55e931102fa473083b5ac048b805a97 988c13aa9fb64d45a8999ccd4425be1f] Running cmd (subprocess): sudo cinder-rootwrap /etc/cinder/rootwrap.conf lvcreate -L 1G -n volume-0894c5fb-8565-4ce1-8c84-3bedbb80f6ad stack-volumes from (pid=12748) execute /opt/stack/cinder/cinder/utils.py:169\n2013-05-23 04:29:59.323 DEBUG cinder.utils [req-b9b4269a-008f-4a98-9e4c-cd5a83b31ad5 f55e931102fa473083b5ac048b805a97 988c13aa9fb64d45a8999ccd4425be1f] Result was 5 from (pid=12748) execute /opt/stack/cinder/cinder/utils.py:186\n2013-05-23 04:29:59.324 ERROR cinder.volume.driver [req-b9b4269a-008f-4a98-9e4c-cd5a83b31ad5 f55e931102fa473083b5ac048b805a97 988c13aa9fb64d45a8999ccd4425be1f] Recovering from a failed execute.  Try number 2\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver Traceback (most recent call last):\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver   File \"/opt/stack/cinder/cinder/volume/driver.py\", line 88, in _try_execute\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver     self._execute(*command, **kwargs)\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver   File \"/opt/stack/cinder/cinder/utils.py\", line 193, in execute\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver     cmd=' '.join(cmd))\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver ProcessExecutionError: Unexpected error while running command.\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver Command: sudo cinder-rootwrap /etc/cinder/rootwrap.conf lvcreate -L 1G -n volume-0894c5fb-8565-4ce1-8c84-3bedbb80f6ad stack-volumes\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver Exit code: 5\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver Stdout: ''\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver Stderr: '  Logical volume \"volume-0894c5fb-8565-4ce1-8c84-3bedbb80f6ad\" already exists in volume group \"stack-volumes\"\\n'\n2013-05-23 04:29:59.324 TRACE cinder.volume.driver \n========", 
            "date_created": "2013-05-23 09:19:10.770329+00:00", 
            "author": "https://api.launchpad.net/1.0/~kashyapc"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/30061\nCommitted: http://github.com/openstack/nova/commit/d4bed185305d65ee9d339f392167535e53a60c3c\nSubmitter: Jenkins\nBranch:    stable/grizzly\n\ncommit d4bed185305d65ee9d339f392167535e53a60c3c\nAuthor: Nikola Dipanov <email address hidden>\nDate:   Mon May 20 17:33:47 2013 +0200\n\n    Fix resize when instance has no image\n    \n    This patch makes it possible to resize an instance that has no image\n    supplied (was booted from volume), by avoiding calling the image service\n    and thus causing an uncaught exception, if there was no image suplied in\n    the first place.\n    \n    Fixes bug: 1182114\n    blueprint: improve-boot-from-volume\n    \n    Change-Id: I67d63a7aef699b555897582c74b04e857db7aafb\n    (cherry picked from commit 4465b705fc7cb7a150a7f8d6f70ccf6c20ff3284)\n", 
            "date_created": "2013-05-26 12:31:12.556319+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Test\n~~~~\n\nTested on devstack\n\n===========\n[kashyap@localhost nova]$ cd /opt/stack/nova\n[kashyap@localhost nova]$ git log | head -2\ncommit e0142d0f63bf64a07db3bd3b840fc2072d2e6ca3\nMerge: 08d6c1d dacb187\n===========\n\n-> Create Cinder volume\n===========\n[kashyap@localhost ~]$ cinder create --display-name image_vol-test1 --image_id 8cd8502b-0b5e-498e-b762-4a086020db8e 10\n+---------------------+--------------------------------------+\n|       Property      |                Value                 |\n+---------------------+--------------------------------------+\n|     attachments     |                  []                  |\n|  availability_zone  |                 nova                 |\n|       bootable      |                false                 |\n|      created_at     |      2012-05-13T22:42:01.809326      |\n| display_description |                 None                 |\n|     display_name    |           image_vol-test1            |\n|          id         | ab3e4cf5-b3c5-4718-8548-af454c8cd6f8 |\n|       image_id      | 8cd8502b-0b5e-498e-b762-4a086020db8e |\n|       metadata      |                  {}                  |\n|         size        |                  10                  |\n|     snapshot_id     |                 None                 |\n|     source_volid    |                 None                 |\n|        status       |               creating               |\n|     volume_type     |                 None                 |\n+---------------------+--------------------------------------+\n===========\n\n-> List the volume created\n===========\n[kashyap@localhost ~]$ cinder list\n+--------------------------------------+-------------+-----------------+------+-------------+----------+-------------+\n|                  ID                  |    Status   |   Display Name  | Size | Volume Type | Bootable | Attached to |\n+--------------------------------------+-------------+-----------------+------+-------------+----------+-------------+\n| ab3e4cf5-b3c5-4718-8548-af454c8cd6f8 | downloading | image_vol-test1 |  10  |     None    |  false   |             |\n+--------------------------------------+-------------+-----------------+------+-------------+----------+-------------+\n[kashyap@localhost ~]$ \n===========\n\n-> List the cinder processes\n===========\n[kashyap@localhost ~]$ ps -ef | grep cinder\nroot       704 23000  0 18:42 pts/17   00:00:00 sudo cinder-rootwrap /etc/cinder/rootwrap.conf qemu-img convert -O raw /tmp/tmpyyG7DZ /dev/mapper/stack--volumes-volume--ab3e4cf5--b3c5--4718--8548--af454c8cd6f8\nroot       705   704  0 18:42 pts/17   00:00:00 /usr/bin/python /usr/bin/cinder-rootwrap /etc/cinder/rootwrap.conf qemu-img convert -O raw /tmp/tmpyyG7DZ /dev/mapper/stack--volumes-volume--ab3e4cf5--b3c5--4718--8548--af454c8cd6f8\nkashyap   1715  1261  0 18:44 pts/0    00:00:00 grep --color=auto cinder\nkashyap  22850 22798  0 17:21 pts/16   00:00:03 python /opt/stack/cinder/bin/cinder-api --config-file /etc/cinder/cinder.conf\nkashyap  22912 22858  1 17:21 pts/17   00:01:08 python /opt/stack/cinder/bin/cinder-volume --config-file /etc/cinder/cinder.conf\nkashyap  23000 22912  0 17:21 pts/17   00:00:16 python /opt/stack/cinder/bin/cinder-volume --config-file /etc/cinder/cinder.conf\nkashyap  23012 22921  0 17:21 pts/18   00:00:09 python /opt/stack/cinder/bin/cinder-scheduler --config-file /etc/cinder/cinder.conf\n[kashyap@localhost ~]$ \n===========\n[kashyap@localhost ~]$ cinder list\n+--------------------------------------+-----------+-----------------+------+-------------+----------+-------------+\n|                  ID                  |   Status  |   Display Name  | Size | Volume Type | Bootable | Attached to |\n+--------------------------------------+-----------+-----------------+------+-------------+----------+-------------+\n| ab3e4cf5-b3c5-4718-8548-af454c8cd6f8 | available | image_vol-test1 |  10  |     None    |   true   |             |\n+--------------------------------------+-----------+-----------------+------+-------------+----------+-------------+\n[kashyap@localhost ~]$ \n===========\n[kashyap@localhost ~]$ sudo lvs\n  LV                                          VG            Attr      LSize  Pool Origin Data%  Move Log Copy%  Convert\n  root                                        fedora        -wi-ao--- 55.57g                                           \n  swap                                        fedora        -wi-ao---  3.94g                                           \n  volume-ab3e4cf5-b3c5-4718-8548-af454c8cd6f8 stack-volumes -wi-ao--- 10.00g                                           \n[kashyap@localhost ~]$ \n===========\n\n-> Add an env. variable for the cinder volume\n===========\n[kashyap@localhost ~]$ VOLUME=ab3e4cf5-b3c5-4718-8548-af454c8cd6f8\n[kashyap@localhost ~]$ echo $VOLUME\nab3e4cf5-b3c5-4718-8548-af454c8cd6f8\n[kashyap@localhost ~]$ \n===========\n\n-> Boot an instance from volume\n===========\n[kashyap@localhost ~]$ nova boot --flavor 1 --block-device-mapping vda=$VOLUME:::0 image_vol-test1\n+-----------------------------+-------------------------------------------------+\n| Property                    | Value                                           |\n+-----------------------------+-------------------------------------------------+\n| status                      | BUILD                                           |\n| updated                     | 2012-05-13T23:03:40Z                            |\n| OS-EXT-STS:task_state       | scheduling                                      |\n| key_name                    | None                                            |\n| image                       | Attempt to boot from volume - no image supplied |\n| hostId                      |                                                 |\n| OS-EXT-STS:vm_state         | building                                        |\n| OS-SRV-USG:launched_at      | None                                            |\n| flavor                      | m1.tiny                                         |\n| id                          | 545136e4-06c0-4773-aa99-28e489e35412            |\n| security_groups             | [{u'name': u'default'}]                         |\n| OS-SRV-USG:terminated_at    | None                                            |\n| user_id                     | 71dcb54e3fc7452ab2d190cd4fd9276b                |\n| name                        | image_vol-test1                                 |\n| adminPass                   | ty9T6NUCZVra                                    |\n| tenant_id                   | dc7b1790cb3c40118a1d361fdea2ab9d                |\n| created                     | 2012-05-13T23:03:39Z                            |\n| OS-DCF:diskConfig           | MANUAL                                          |\n| metadata                    | {}                                              |\n| accessIPv4                  |                                                 |\n| accessIPv6                  |                                                 |\n| progress                    | 0                                               |\n| OS-EXT-STS:power_state      | 0                                               |\n| OS-EXT-AZ:availability_zone | nova                                            |\n| config_drive                |                                                 |\n+-----------------------------+-------------------------------------------------+\n[kashyap@localhost ~]$ \n===========\n\n-> List the nova instance\n===========\n[kashyap@localhost ~]$ nova list\n+--------------------------------------+-----------------+--------+------------+-------------+------------------+\n| ID                                   | Name            | Status | Task State | Power State | Networks         |\n+--------------------------------------+-----------------+--------+------------+-------------+------------------+\n| 545136e4-06c0-4773-aa99-28e489e35412 | image_vol-test1 | ACTIVE | None       | Running     | private=10.0.0.2 |\n+--------------------------------------+-----------------+--------+------------+-------------+------------------+\n[kashyap@localhost ~]$ \n===========\n\n-> Resize the instance to flavor-2\n===========\n[kashyap@localhost nova]$ nova resize --poll 545136e4-06c0-4773-aa99-28e489e35412 2\n\nInstance resizing... 100% complete\nFinished\n[kashyap@localhost nova]$\n===========", 
            "date_created": "2013-06-10 11:10:57.932507+00:00", 
            "author": "https://api.launchpad.net/1.0/~kashyapc"
        }
    ]
}