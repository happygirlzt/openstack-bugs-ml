{
    "status": "Fix Released", 
    "last_updated": "2011-04-15 08:35:08.162056+00:00", 
    "description": "run_instance sometimes fails. \n\ntested: r894, qemu.\n\nIf _poll_instance_state() is called while spawning instance, _poll_instance_state() will update state of spawning instance and the instance will be removed from DB.  This will cause failure of run_instances().\n\nI think that following state changes should not be applied to just spawning instances:\n\n2011-03-28 15:18:18,737 INFO nova.compute.manager [-] Found instance 'instance-00000001' in DB but no VM. Setting state to shutoff.\n2011-03-28 15:18:18,738 INFO nova.compute.manager [-] DB/VM state mismatch. Changing state from '0' to '5'\n\n\n\nHere are nova-compute's log output:\n\n2011-03-28 15:17:33,337 DEBUG nova.utils [-] Running cmd (subprocess): mkdir -p /home/iida/nova/nova/..//instances/instance-00000001/ from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:17:33,375 INFO nova.virt.libvirt_conn [-] instance instance-00000001: Creating image\n2011-03-28 15:17:33,438 DEBUG nova.utils [-] Attempting to grab semaphore \"481bc4e3\" for method \"call_if_not_exists\"... from (pid=14228) inner /home/iida/nova/nova/utils.py:594\n2011-03-28 15:17:33,616 DEBUG nova.utils [-] Running cmd (subprocess): cp /home/iida/nova/nova/..//instances/_base/481bc4e3 /home/iida/nova/nova/..//instances/instance-00000001/kernel from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:17:33,743 DEBUG nova.utils [-] Attempting to grab semaphore \"395a3690\" for method \"call_if_not_exists\"... from (pid=14228) inner /home/iida/nova/nova/utils.py:594\n2011-03-28 15:17:34,087 DEBUG nova.utils [-] Running cmd (subprocess): cp /home/iida/nova/nova/..//instances/_base/395a3690 /home/iida/nova/nova/..//instances/instance-00000001/ramdisk from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:17:34,201 DEBUG nova.utils [-] Attempting to grab semaphore \"6a4902cb_sm\" for method \"call_if_not_exists\"... from (pid=14228) inner /home/iida/nova/nova/utils.py:594\n2011-03-28 15:18:18,200 DEBUG nova.utils [-] Running cmd (subprocess): qemu-img create -f qcow2 -o cluster_size=2M,backing_file=/home/iida/nova/nova/..//instances/_base/6a4902cb_sm /home/iida/nova/nova/..//instances/instance-00000001/disk from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:18,737 INFO nova.compute.manager [-] Found instance 'instance-00000001' in DB but no VM. Setting state to shutoff.\n2011-03-28 15:18:18,738 INFO nova.compute.manager [-] DB/VM state mismatch. Changing state from '0' to '5'\n2011-03-28 15:18:19,167 INFO nova.virt.libvirt_conn [-] instance instance-00000001: injecting key into image 1783169739\n2011-03-28 15:18:19,167 INFO nova.virt.libvirt_conn [-] instance instance-00000001: injecting net into image 1783169739\n2011-03-28 15:18:19,177 DEBUG nova.utils [-] Running cmd (subprocess): sudo qemu-nbd -c /dev/nbd15 /home/iida/nova/nova/..//instances/instance-00000001/disk from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:20,799 DEBUG nova.utils [-] Running cmd (subprocess): sudo tune2fs -c 0 -i 0 /dev/nbd15 from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:21,964 DEBUG nova.utils [-] Running cmd (subprocess): sudo mount /dev/nbd15 /tmp/tmpkRFDUp from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,181 DEBUG nova.utils [-] Running cmd (subprocess): sudo mkdir -p /tmp/tmpkRFDUp/root/.ssh from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,341 DEBUG nova.utils [-] Running cmd (subprocess): sudo chown root /tmp/tmpkRFDUp/root/.ssh from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,490 DEBUG nova.utils [-] Running cmd (subprocess): sudo chmod 700 /tmp/tmpkRFDUp/root/.ssh from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,590 DEBUG nova.utils [-] Running cmd (subprocess): sudo tee -a /tmp/tmpkRFDUp/root/.ssh/authorized_keys from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,689 DEBUG nova.utils [-] Running cmd (subprocess): sudo mkdir -p /tmp/tmpkRFDUp/etc/network from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,790 DEBUG nova.utils [-] Running cmd (subprocess): sudo chown root:root /tmp/tmpkRFDUp/etc/network from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,873 DEBUG nova.utils [-] Running cmd (subprocess): sudo chmod 755 /tmp/tmpkRFDUp/etc/network from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,950 DEBUG nova.utils [-] Running cmd (subprocess): sudo tee /tmp/tmpkRFDUp/etc/network/interfaces from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:23,060 DEBUG nova.utils [-] Running cmd (subprocess): sudo umount /dev/nbd15 from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:24,190 DEBUG nova.utils [-] Running cmd (subprocess): rmdir /tmp/tmpkRFDUp from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:24,258 DEBUG nova.utils [-] Running cmd (subprocess): sudo qemu-nbd -d /dev/nbd15 from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:28,116 DEBUG nova.virt.libvirt_conn [-] instance instance-00000001: is running from (pid=14228) spawn /home/iida/nova/nova/virt/libvirt_conn.py:503\n2011-03-28 15:18:28,243 ERROR nova.compute.manager [AMJJLSBS8AK32S9IE45S admin admin] Instance '1' failed to spawn. Is virtualization enabled in the BIOS?\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/compute/manager.py\", line 244, in run_instance\n(nova.compute.manager): TRACE:     {'launched_at': now})\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 474, in instance_update\n(nova.compute.manager): TRACE:     return IMPL.instance_update(context, instance_id, values)\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova.compute.manager): TRACE:     return f(*args, **kwargs)\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 994, in instance_update\n(nova.compute.manager): TRACE:     instance_ref = instance_get(context, instance_id, session=session)\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova.compute.manager): TRACE:     return f(*args, **kwargs)\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 848, in instance_get\n(nova.compute.manager): TRACE:     instance_id)\n(nova.compute.manager): TRACE: InstanceNotFound: Instance 1 not found\n(nova.compute.manager): TRACE:\n2011-03-28 15:18:28,345 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/home/iida/nova/nova/rpc.py\", line 183, in _receive\n(nova): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova): TRACE:   File \"/home/iida/nova/nova/exception.py\", line 120, in _wrap\n(nova): TRACE:     return f(*args, **kw)\n(nova): TRACE:   File \"/home/iida/nova/nova/compute/manager.py\", line 251, in run_instance\n(nova): TRACE:     power_state.SHUTDOWN)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 465, in instance_set_state\n(nova): TRACE:     return IMPL.instance_set_state(context, instance_id, state, description)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 98, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 987, in instance_set_state\n(nova): TRACE:     'state_description': description})\n(nova): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 474, in instance_update\n(nova): TRACE:     return IMPL.instance_update(context, instance_id, values)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 994, in instance_update\n(nova): TRACE:     instance_ref = instance_get(context, instance_id, session=session)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 848, in instance_get\n(nova): TRACE:     instance_id)\n(nova): TRACE: InstanceNotFound: Instance 1 not found\n(nova): TRACE:\n2011-03-28 15:18:28,613 ERROR nova.virt.libvirt_conn [-] instance instance-00000001: failed to boot\n(nova.virt.libvirt_conn): TRACE: Traceback (most recent call last):\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/virt/libvirt_conn.py\", line 512, in _wait_for_boot\n(nova.virt.libvirt_conn): TRACE:     instance['id'], state)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 465, in instance_set_state\n(nova.virt.libvirt_conn): TRACE:     return IMPL.instance_set_state(context, instance_id, state, description)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 98, in wrapper\n(nova.virt.libvirt_conn): TRACE:     return f(*args, **kwargs)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 987, in instance_set_state\n(nova.virt.libvirt_conn): TRACE:     'state_description': description})\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 474, in instance_update\n(nova.virt.libvirt_conn): TRACE:     return IMPL.instance_update(context, instance_id, values)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova.virt.libvirt_conn): TRACE:     return f(*args, **kwargs)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 994, in instance_update\n(nova.virt.libvirt_conn): TRACE:     instance_ref = instance_get(context, instance_id, session=session)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova.virt.libvirt_conn): TRACE:     return f(*args, **kwargs)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 848, in instance_get\n(nova.virt.libvirt_conn): TRACE:     instance_id)\n(nova.virt.libvirt_conn): TRACE: InstanceNotFound: Instance 1 not found\n(nova.virt.libvirt_conn): TRACE:\n2011-03-28 15:18:28,700 ERROR nova [-] in looping call\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/home/iida/nova/nova/utils.py\", line 465, in _inner\n(nova): TRACE:     self.f(*self.args, **self.kw)\n(nova): TRACE:   File \"/home/iida/nova/nova/virt/libvirt_conn.py\", line 521, in _wait_for_boot\n(nova): TRACE:     power_state.SHUTDOWN)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 465, in instance_set_state\n(nova): TRACE:     return IMPL.instance_set_state(context, instance_id, state, description)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 98, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 987, in instance_set_state\n(nova): TRACE:     'state_description': description})\n(nova): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 474, in instance_update\n(nova): TRACE:     return IMPL.instance_update(context, instance_id, values)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 994, in instance_update\n(nova): TRACE:     instance_ref = instance_get(context, instance_id, session=session)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 848, in instance_get\n(nova): TRACE:     instance_id)\n(nova): TRACE: InstanceNotFound: Instance 1 not found\n(nova): TRACE:", 
    "tags": [
        "regression"
    ], 
    "importance": "High", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/744056", 
    "owner": "https://api.launchpad.net/1.0/~justin-fathomdb", 
    "id": 744056, 
    "index": 384, 
    "created": "2011-03-28 06:41:39.083406+00:00", 
    "title": "RunInstances fail due to state change of _poll_instance_state()", 
    "comments": [
        {
            "content": "run_instance sometimes fails. \n\ntested: r894, qemu.\n\nIf _poll_instance_state() is called while spawning instance, _poll_instance_state() will update state of spawning instance and the instance will be removed from DB.  This will cause failure of run_instances().\n\nI think that following state changes should not be applied to just spawning instances:\n\n2011-03-28 15:18:18,737 INFO nova.compute.manager [-] Found instance 'instance-00000001' in DB but no VM. Setting state to shutoff.\n2011-03-28 15:18:18,738 INFO nova.compute.manager [-] DB/VM state mismatch. Changing state from '0' to '5'\n\n\n\nHere are nova-compute's log output:\n\n2011-03-28 15:17:33,337 DEBUG nova.utils [-] Running cmd (subprocess): mkdir -p /home/iida/nova/nova/..//instances/instance-00000001/ from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:17:33,375 INFO nova.virt.libvirt_conn [-] instance instance-00000001: Creating image\n2011-03-28 15:17:33,438 DEBUG nova.utils [-] Attempting to grab semaphore \"481bc4e3\" for method \"call_if_not_exists\"... from (pid=14228) inner /home/iida/nova/nova/utils.py:594\n2011-03-28 15:17:33,616 DEBUG nova.utils [-] Running cmd (subprocess): cp /home/iida/nova/nova/..//instances/_base/481bc4e3 /home/iida/nova/nova/..//instances/instance-00000001/kernel from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:17:33,743 DEBUG nova.utils [-] Attempting to grab semaphore \"395a3690\" for method \"call_if_not_exists\"... from (pid=14228) inner /home/iida/nova/nova/utils.py:594\n2011-03-28 15:17:34,087 DEBUG nova.utils [-] Running cmd (subprocess): cp /home/iida/nova/nova/..//instances/_base/395a3690 /home/iida/nova/nova/..//instances/instance-00000001/ramdisk from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:17:34,201 DEBUG nova.utils [-] Attempting to grab semaphore \"6a4902cb_sm\" for method \"call_if_not_exists\"... from (pid=14228) inner /home/iida/nova/nova/utils.py:594\n2011-03-28 15:18:18,200 DEBUG nova.utils [-] Running cmd (subprocess): qemu-img create -f qcow2 -o cluster_size=2M,backing_file=/home/iida/nova/nova/..//instances/_base/6a4902cb_sm /home/iida/nova/nova/..//instances/instance-00000001/disk from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:18,737 INFO nova.compute.manager [-] Found instance 'instance-00000001' in DB but no VM. Setting state to shutoff.\n2011-03-28 15:18:18,738 INFO nova.compute.manager [-] DB/VM state mismatch. Changing state from '0' to '5'\n2011-03-28 15:18:19,167 INFO nova.virt.libvirt_conn [-] instance instance-00000001: injecting key into image 1783169739\n2011-03-28 15:18:19,167 INFO nova.virt.libvirt_conn [-] instance instance-00000001: injecting net into image 1783169739\n2011-03-28 15:18:19,177 DEBUG nova.utils [-] Running cmd (subprocess): sudo qemu-nbd -c /dev/nbd15 /home/iida/nova/nova/..//instances/instance-00000001/disk from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:20,799 DEBUG nova.utils [-] Running cmd (subprocess): sudo tune2fs -c 0 -i 0 /dev/nbd15 from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:21,964 DEBUG nova.utils [-] Running cmd (subprocess): sudo mount /dev/nbd15 /tmp/tmpkRFDUp from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,181 DEBUG nova.utils [-] Running cmd (subprocess): sudo mkdir -p /tmp/tmpkRFDUp/root/.ssh from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,341 DEBUG nova.utils [-] Running cmd (subprocess): sudo chown root /tmp/tmpkRFDUp/root/.ssh from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,490 DEBUG nova.utils [-] Running cmd (subprocess): sudo chmod 700 /tmp/tmpkRFDUp/root/.ssh from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,590 DEBUG nova.utils [-] Running cmd (subprocess): sudo tee -a /tmp/tmpkRFDUp/root/.ssh/authorized_keys from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,689 DEBUG nova.utils [-] Running cmd (subprocess): sudo mkdir -p /tmp/tmpkRFDUp/etc/network from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,790 DEBUG nova.utils [-] Running cmd (subprocess): sudo chown root:root /tmp/tmpkRFDUp/etc/network from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,873 DEBUG nova.utils [-] Running cmd (subprocess): sudo chmod 755 /tmp/tmpkRFDUp/etc/network from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:22,950 DEBUG nova.utils [-] Running cmd (subprocess): sudo tee /tmp/tmpkRFDUp/etc/network/interfaces from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:23,060 DEBUG nova.utils [-] Running cmd (subprocess): sudo umount /dev/nbd15 from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:24,190 DEBUG nova.utils [-] Running cmd (subprocess): rmdir /tmp/tmpkRFDUp from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:24,258 DEBUG nova.utils [-] Running cmd (subprocess): sudo qemu-nbd -d /dev/nbd15 from (pid=14228) execute /home/iida/nova/nova/utils.py:150\n2011-03-28 15:18:28,116 DEBUG nova.virt.libvirt_conn [-] instance instance-00000001: is running from (pid=14228) spawn /home/iida/nova/nova/virt/libvirt_conn.py:503\n2011-03-28 15:18:28,243 ERROR nova.compute.manager [AMJJLSBS8AK32S9IE45S admin admin] Instance '1' failed to spawn. Is virtualization enabled in the BIOS?\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/compute/manager.py\", line 244, in run_instance\n(nova.compute.manager): TRACE:     {'launched_at': now})\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 474, in instance_update\n(nova.compute.manager): TRACE:     return IMPL.instance_update(context, instance_id, values)\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova.compute.manager): TRACE:     return f(*args, **kwargs)\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 994, in instance_update\n(nova.compute.manager): TRACE:     instance_ref = instance_get(context, instance_id, session=session)\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova.compute.manager): TRACE:     return f(*args, **kwargs)\n(nova.compute.manager): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 848, in instance_get\n(nova.compute.manager): TRACE:     instance_id)\n(nova.compute.manager): TRACE: InstanceNotFound: Instance 1 not found\n(nova.compute.manager): TRACE:\n2011-03-28 15:18:28,345 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/home/iida/nova/nova/rpc.py\", line 183, in _receive\n(nova): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova): TRACE:   File \"/home/iida/nova/nova/exception.py\", line 120, in _wrap\n(nova): TRACE:     return f(*args, **kw)\n(nova): TRACE:   File \"/home/iida/nova/nova/compute/manager.py\", line 251, in run_instance\n(nova): TRACE:     power_state.SHUTDOWN)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 465, in instance_set_state\n(nova): TRACE:     return IMPL.instance_set_state(context, instance_id, state, description)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 98, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 987, in instance_set_state\n(nova): TRACE:     'state_description': description})\n(nova): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 474, in instance_update\n(nova): TRACE:     return IMPL.instance_update(context, instance_id, values)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 994, in instance_update\n(nova): TRACE:     instance_ref = instance_get(context, instance_id, session=session)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 848, in instance_get\n(nova): TRACE:     instance_id)\n(nova): TRACE: InstanceNotFound: Instance 1 not found\n(nova): TRACE:\n2011-03-28 15:18:28,613 ERROR nova.virt.libvirt_conn [-] instance instance-00000001: failed to boot\n(nova.virt.libvirt_conn): TRACE: Traceback (most recent call last):\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/virt/libvirt_conn.py\", line 512, in _wait_for_boot\n(nova.virt.libvirt_conn): TRACE:     instance['id'], state)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 465, in instance_set_state\n(nova.virt.libvirt_conn): TRACE:     return IMPL.instance_set_state(context, instance_id, state, description)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 98, in wrapper\n(nova.virt.libvirt_conn): TRACE:     return f(*args, **kwargs)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 987, in instance_set_state\n(nova.virt.libvirt_conn): TRACE:     'state_description': description})\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 474, in instance_update\n(nova.virt.libvirt_conn): TRACE:     return IMPL.instance_update(context, instance_id, values)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova.virt.libvirt_conn): TRACE:     return f(*args, **kwargs)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 994, in instance_update\n(nova.virt.libvirt_conn): TRACE:     instance_ref = instance_get(context, instance_id, session=session)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova.virt.libvirt_conn): TRACE:     return f(*args, **kwargs)\n(nova.virt.libvirt_conn): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 848, in instance_get\n(nova.virt.libvirt_conn): TRACE:     instance_id)\n(nova.virt.libvirt_conn): TRACE: InstanceNotFound: Instance 1 not found\n(nova.virt.libvirt_conn): TRACE:\n2011-03-28 15:18:28,700 ERROR nova [-] in looping call\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/home/iida/nova/nova/utils.py\", line 465, in _inner\n(nova): TRACE:     self.f(*self.args, **self.kw)\n(nova): TRACE:   File \"/home/iida/nova/nova/virt/libvirt_conn.py\", line 521, in _wait_for_boot\n(nova): TRACE:     power_state.SHUTDOWN)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 465, in instance_set_state\n(nova): TRACE:     return IMPL.instance_set_state(context, instance_id, state, description)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 98, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 987, in instance_set_state\n(nova): TRACE:     'state_description': description})\n(nova): TRACE:   File \"/home/iida/nova/nova/db/api.py\", line 474, in instance_update\n(nova): TRACE:     return IMPL.instance_update(context, instance_id, values)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 994, in instance_update\n(nova): TRACE:     instance_ref = instance_get(context, instance_id, session=session)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 109, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/home/iida/nova/nova/db/sqlalchemy/api.py\", line 848, in instance_get\n(nova): TRACE:     instance_id)\n(nova): TRACE: InstanceNotFound: Instance 1 not found\n(nova): TRACE:", 
            "date_created": "2011-03-28 06:41:39.083406+00:00", 
            "author": "https://api.launchpad.net/1.0/~iida-koji"
        }, 
        {
            "content": "Thanks for the great bug report.  This sounds like a bug I introduced, so I will work on fixing it.", 
            "date_created": "2011-03-28 07:10:13.583861+00:00", 
            "author": "https://api.launchpad.net/1.0/~justin-fathomdb"
        }
    ]
}