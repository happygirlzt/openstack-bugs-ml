{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:41:39.052873+00:00", 
    "description": "When doing nova list it queries quantum for each vm to get the security groups. It would be better if we could just query quantum once for all the security groups owned by a tenant and then populate the information from that. Also we should take into consideration if quantum goes down we don't want to necessarily bring down the ability to list instances. \n\n>nova list\nGET /v2.0/ports.json?device_id=4110d985-f321-4416-a768-cef820861398 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=c2a3b824-cc30-45fc-9597-ab1020793502 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=9b349717-6ca0-4cf1-8a64-0272121b0f8d HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=d85020d1-1752-47c0-a290-60373de019bd HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=5a9656f0-5a00-4894-b915-0b10c3b993fb HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=c16033bb-7de0-4779-8cdd-60d510f5e78d HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=c1262f17-c90a-43f7-abe5-eefbdfb406af HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=2d66634f-e8ec-44d7-8367-385a31a2bca9 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=d0d3dec7-3f1a-4745-a625-740d06282134 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=9bf7a3c4-274c-43d8-9563-bb072b1c824b HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=0e1d3089-60de-4b3e-a9d5-4ec12dbfa0f9 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=c0cd75cc-b4e3-4572-a436-bc85123d99c8 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=57ede81a-258c-417d-af22-d5e4fd8e93c0 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=e78cfd7d-2bfa-4164-9f76-bb22771d2f14 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=393810a6-796b-42a4-8da9-d6f3b4a90de9 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=f644cd99-958d-41c2-b83f-f491b41e80fe HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=4573aa29-e897-42b2-b8f9-12576a748eda HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=a28347d8-b97a-4274-938c-cd1952381d79 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=76d9b8e4-b971-4256-8de6-35595cf2b7f7 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=2199928e-5d5c-46be-8bf4-74f051b18601 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1161518", 
    "owner": "https://api.launchpad.net/1.0/~arosen", 
    "id": 1161518, 
    "index": 3326, 
    "created": "2013-03-28 17:38:31.806802+00:00", 
    "title": "nova list quantum security group cache ", 
    "comments": [
        {
            "content": "When doing nova list it queries quantum for each vm to get the security groups. It would be better if we could just query quantum once for all the security groups owned by a tenant and then populate the information from that. Also we should take into consideration if quantum goes down we don't want to necessarily bring down the ability to list instances. \n\n>nova list\nGET /v2.0/ports.json?device_id=4110d985-f321-4416-a768-cef820861398 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=c2a3b824-cc30-45fc-9597-ab1020793502 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=9b349717-6ca0-4cf1-8a64-0272121b0f8d HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=d85020d1-1752-47c0-a290-60373de019bd HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=5a9656f0-5a00-4894-b915-0b10c3b993fb HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=c16033bb-7de0-4779-8cdd-60d510f5e78d HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=c1262f17-c90a-43f7-abe5-eefbdfb406af HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=2d66634f-e8ec-44d7-8367-385a31a2bca9 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=d0d3dec7-3f1a-4745-a625-740d06282134 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=9bf7a3c4-274c-43d8-9563-bb072b1c824b HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=0e1d3089-60de-4b3e-a9d5-4ec12dbfa0f9 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=c0cd75cc-b4e3-4572-a436-bc85123d99c8 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=57ede81a-258c-417d-af22-d5e4fd8e93c0 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=e78cfd7d-2bfa-4164-9f76-bb22771d2f14 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=393810a6-796b-42a4-8da9-d6f3b4a90de9 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=f644cd99-958d-41c2-b83f-f491b41e80fe HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=4573aa29-e897-42b2-b8f9-12576a748eda HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=a28347d8-b97a-4274-938c-cd1952381d79 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=76d9b8e4-b971-4256-8de6-35595cf2b7f7 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/ports.json?device_id=2199928e-5d5c-46be-8bf4-74f051b18601 HTTP/1.1 (HTTP/1.1 200 OK)\nGET /v2.0/security-groups.json HTTP/1.1 (HTTP/1.1 200 OK)", 
            "date_created": "2013-03-28 17:38:31.806802+00:00", 
            "author": "https://api.launchpad.net/1.0/~arosen"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/25670", 
            "date_created": "2013-03-28 23:11:15.683211+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/25670\nCommitted: http://github.com/openstack/nova/commit/afeb95dfc924ed7e768d76bc5ae4bd4c55e9dcb3\nSubmitter: Jenkins\nBranch:    master\n\ncommit afeb95dfc924ed7e768d76bc5ae4bd4c55e9dcb3\nAuthor: Aaron Rosen <email address hidden>\nDate:   Fri Mar 29 18:09:28 2013 -0700\n\n    Query quantum once for instance's security groups\n    \n    This patch adds the method get_instance_security_group_bindings()\n    which returns all the instance_id's and security groups for a given\n    tenant. This method is then used to avoid querying quantum for it's\n    security groups when using GET /v2/<project_id>/servers/detail.\n    \n    Fixes bug 1161518\n    \n    Change-Id: Ia28d5573c264f0316ab9fb257ca8e7ae35679883\n", 
            "date_created": "2013-04-01 17:15:32.551623+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/grizzly\nReview: https://review.openstack.org/27393", 
            "date_created": "2013-04-24 00:40:38.773244+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/27393\nCommitted: http://github.com/openstack/nova/commit/e653938ff7bc6b9b3e97e784bb07516576305b3e\nSubmitter: Jenkins\nBranch:    stable/grizzly\n\ncommit e653938ff7bc6b9b3e97e784bb07516576305b3e\nAuthor: Aaron Rosen <email address hidden>\nDate:   Fri Mar 29 18:09:28 2013 -0700\n\n    Query quantum once for instance's security groups\n    \n    This patch adds the method get_instance_security_group_bindings()\n    which returns all the instance_id's and security groups for a given\n    tenant. This method is then used to avoid querying quantum for it's\n    security groups when using GET /v2/<project_id>/servers/detail.\n    \n    Fixes bug 1161518\n    \n    Conflicts:\n    \n        nova/tests/api/openstack/compute/contrib/test_security_groups.py\n    \n    Change-Id: Ia28d5573c264f0316ab9fb257ca8e7ae35679883\n    (cherry picked from commit afeb95dfc924ed7e768d76bc5ae4bd4c55e9dcb3)\n", 
            "date_created": "2013-04-27 14:30:23.435624+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}