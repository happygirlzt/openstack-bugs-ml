{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 12:04:48.411191+00:00", 
    "description": "When operating live migration on hyper-v  from a domain administrator to another domain user it will raise the following exception\uff1a\n\n  2013-05-31 20:22:16.552 5332 INFO nova.virt.hyperv.vmops [req-bb41a7b0-f0c5-4699-b605-0ea43af8e41c 96c8d050f56b4a6bbf428\n542ff7e194f 648a70dd4cf441c2b743aaad6f6772d7] [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb] Spawning new instance\n        1 file(s) copied.\n2013-05-31 20:22:58.734 5332 ERROR nova.virt.hyperv.vmops [req-bb41a7b0-f0c5-4699-b605-0ea43af8e41c 96c8d050f56b4a6bbf42\n8542ff7e194f 648a70dd4cf441c2b743aaad6f6772d7] list index out of range\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops Traceback (most recent call last):\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops   File \"C:\\xh_live_migration\\hyperv-zip\\nova\\nova\\virt\\hyperv\\\nvmops.py\", line 169, in spawn\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops     root_vhd_path)\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops   File \"C:\\xh_live_migration\\hyperv-zip\\nova\\nova\\virt\\hyperv\\\nvmops.py\", line 190, in create_instance\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops     CONF.hyperv.limit_cpu_features)\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops   File \"C:\\xh_live_migration\\hyperv-zip\\nova\\nova\\virt\\hyperv\\\nvmutils.py\", line 155, in create_vm\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops     vs_man_svc = self._conn.Msvm_VirtualSystemManagementServic\ne()[0]\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops IndexError: list index out of range\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops\n2013-05-31 20:22:58.753 5332 INFO nova.virt.hyperv.vmops [req-bb41a7b0-f0c5-4699-b605-0ea43af8e41c 96c8d050f56b4a6bbf428\n542ff7e194f 648a70dd4cf441c2b743aaad6f6772d7] Got request to destroy instance: instance-00000093\n2013-05-31 20:22:58.763 5332 ERROR nova.compute.manager [req-bb41a7b0-f0c5-4699-b605-0ea43af8e41c 96c8d050f56b4a6bbf4285\n42ff7e194f 648a70dd4cf441c2b743aaad6f6772d7] [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb] Instance failed to spawn\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb] Traceback (most\n recent call last):\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]   File \"C:\\xh_l\nive_migration\\hyperv-zip\\nova\\nova\\compute\\manager.py\", line 1165, in _spawn\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]     block_devic\ne_info)\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]   File \"C:\\xh_l\nive_migration\\hyperv-zip\\nova\\nova\\virt\\hyperv\\driver.py\", line 54, in spawn\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]     admin_passw\nord, network_info, block_device_info)\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]   File \"C:\\xh_l\nive_migration\\hyperv-zip\\nova\\nova\\virt\\hyperv\\vmops.py\", line 181, in spawn\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]     raise vmuti\nls.HyperVException(_('Spawn instance failed'))\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb] HyperVException\n: Spawn instance failed\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]\n2013-05-31 20:22:59.154 5332 AUDIT nova.compute.manager [req-bb41a7b0-f0c5-4699-b605-0ea43af8e41c 96c8d050f56b4a6bbf4285\n42ff7e194f 648a70dd4cf441c2b743aaad6f6772d7] [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb] Terminating instance", 
    "tags": [
        "hyper-v"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1195205", 
    "owner": "https://api.launchpad.net/1.0/~xianghui", 
    "id": 1195205, 
    "index": 3798, 
    "created": "2013-06-27 08:53:48.505975+00:00", 
    "title": "Raised nova.virt.hyperv.vmops IndexError on hyper-v when boot with the domain user role", 
    "comments": [
        {
            "content": "When creating a new vm on hyper-v with domain user it will raise the following exception\uff1a\n\n  2013-05-31 20:22:16.552 5332 INFO nova.virt.hyperv.vmops [req-bb41a7b0-f0c5-4699-b605-0ea43af8e41c 96c8d050f56b4a6bbf428\n542ff7e194f 648a70dd4cf441c2b743aaad6f6772d7] [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb] Spawning new instance\n        1 file(s) copied.\n2013-05-31 20:22:58.734 5332 ERROR nova.virt.hyperv.vmops [req-bb41a7b0-f0c5-4699-b605-0ea43af8e41c 96c8d050f56b4a6bbf42\n8542ff7e194f 648a70dd4cf441c2b743aaad6f6772d7] list index out of range\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops Traceback (most recent call last):\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops   File \"C:\\xh_live_migration\\hyperv-zip\\nova\\nova\\virt\\hyperv\\\nvmops.py\", line 169, in spawn\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops     root_vhd_path)\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops   File \"C:\\xh_live_migration\\hyperv-zip\\nova\\nova\\virt\\hyperv\\\nvmops.py\", line 190, in create_instance\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops     CONF.hyperv.limit_cpu_features)\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops   File \"C:\\xh_live_migration\\hyperv-zip\\nova\\nova\\virt\\hyperv\\\nvmutils.py\", line 155, in create_vm\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops     vs_man_svc = self._conn.Msvm_VirtualSystemManagementServic\ne()[0]\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops IndexError: list index out of range\n2013-05-31 20:22:58.734 5332 TRACE nova.virt.hyperv.vmops\n2013-05-31 20:22:58.753 5332 INFO nova.virt.hyperv.vmops [req-bb41a7b0-f0c5-4699-b605-0ea43af8e41c 96c8d050f56b4a6bbf428\n542ff7e194f 648a70dd4cf441c2b743aaad6f6772d7] Got request to destroy instance: instance-00000093\n2013-05-31 20:22:58.763 5332 ERROR nova.compute.manager [req-bb41a7b0-f0c5-4699-b605-0ea43af8e41c 96c8d050f56b4a6bbf4285\n42ff7e194f 648a70dd4cf441c2b743aaad6f6772d7] [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb] Instance failed to spawn\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb] Traceback (most\n recent call last):\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]   File \"C:\\xh_l\nive_migration\\hyperv-zip\\nova\\nova\\compute\\manager.py\", line 1165, in _spawn\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]     block_devic\ne_info)\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]   File \"C:\\xh_l\nive_migration\\hyperv-zip\\nova\\nova\\virt\\hyperv\\driver.py\", line 54, in spawn\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]     admin_passw\nord, network_info, block_device_info)\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]   File \"C:\\xh_l\nive_migration\\hyperv-zip\\nova\\nova\\virt\\hyperv\\vmops.py\", line 181, in spawn\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]     raise vmuti\nls.HyperVException(_('Spawn instance failed'))\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb] HyperVException\n: Spawn instance failed\n2013-05-31 20:22:58.763 5332 TRACE nova.compute.manager [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb]\n2013-05-31 20:22:59.154 5332 AUDIT nova.compute.manager [req-bb41a7b0-f0c5-4699-b605-0ea43af8e41c 96c8d050f56b4a6bbf4285\n42ff7e194f 648a70dd4cf441c2b743aaad6f6772d7] [instance: 53f24f00-af72-4df5-9262-ee0dc72f50cb] Terminating instance", 
            "date_created": "2013-06-27 08:53:48.505975+00:00", 
            "author": "https://api.launchpad.net/1.0/~xianghui"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/34832", 
            "date_created": "2013-06-28 03:16:54.488594+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This bug is caused by having no admin permission to create a vm on hyper-v, which is based on the operation of live-migration, so I am going to give the user an obvious clue to indicate this permission limit by raising an exception, so the user could fix it quickly.", 
            "date_created": "2013-07-09 03:21:32.417061+00:00", 
            "author": "https://api.launchpad.net/1.0/~xianghui"
        }, 
        {
            "content": "Review is still in progress", 
            "date_created": "2013-07-15 08:28:11.207129+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/34832\nCommitted: http://github.com/openstack/nova/commit/38afca3350bd52f3441827b31c9fa6e6e31179e4\nSubmitter: Jenkins\nBranch:    master\n\ncommit 38afca3350bd52f3441827b31c9fa6e6e31179e4\nAuthor: Xiang Hui <email address hidden>\nDate:   Thu Jun 27 19:11:56 2013 -0700\n\n    Add an exception when doesn't have permissions to operate vm on hyper-v\n    \n    This commit adds a wrapper checking method when creating/operating\n    vms on hyper-v, it will raise a HyperVAuthorizationException if the\n    windows account running nova-compute on this Hyper-V host doesn't\n    have the required permissions to create/operate the virtual machine.\n    \n    Fixes bug #1195205\n    \n    Change-Id: I2ef67a686c99dc83fcc3e9f47a71473929b01e9f\n", 
            "date_created": "2013-09-02 11:59:46.009418+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}