{
    "status": "Fix Released", 
    "last_updated": "2015-04-28 17:02:11.444119+00:00", 
    "description": "I'm trying to run unittests and got errors trying to execute tests:\n\n======================================================================\nERROR: nova.tests.test_service.TestWSGIService.test_service_random_port_with_ipv6\n----------------------------------------------------------------------\n_StringException: Empty attachments:\n  pythonlogging:'nova'\n\nTraceback (most recent call last):\n  File \"/root/openstack/nova/app/nova/tests/test_service.py\", line 189, in test_service_random_port_with_ipv6\n    test_service = service.WSGIService(\"test_service\")\n  File \"/root/openstack/nova/app/nova/service.py\", line 608, in __init__\n    max_url_len=max_url_len)\n  File \"/root/openstack/nova/app/nova/wsgi.py\", line 120, in __init__\n    self._socket = eventlet.listen(bind_addr, family, backlog=backlog)\n  File \"/usr/lib/python2.6/site-packages/eventlet/convenience.py\", line 35, in listen\n    sock = socket.socket(family, socket.SOCK_STREAM)\n  File \"/usr/lib/python2.6/site-packages/eventlet/greenio.py\", line 116, in __init__\n    fd = _original_socket(family_or_realsock, *args, **kwargs)\n  File \"/usr/lib64/python2.6/socket.py\", line 184, in __init__\n    _sock = _realsocket(family, type, proto)\nerror: [Errno 97] Address family not supported by protocol\n\n\n======================================================================\nERROR: nova.tests.test_wsgi.TestWSGIServer.test_start_random_port_with_ipv6\n----------------------------------------------------------------------\n_StringException: Empty attachments:\n  pythonlogging:'nova'\n\nTraceback (most recent call last):\n  File \"/root/openstack/nova/app/nova/tests/test_wsgi.py\", line 106, in test_start_random_port_with_ipv6\n    host=\"::1\", port=0)\n  File \"/root/openstack/nova/app/nova/wsgi.py\", line 120, in __init__\n    self._socket = eventlet.listen(bind_addr, family, backlog=backlog)\n  File \"/usr/lib/python2.6/site-packages/eventlet/convenience.py\", line 35, in listen\n    sock = socket.socket(family, socket.SOCK_STREAM)\n  File \"/usr/lib/python2.6/site-packages/eventlet/greenio.py\", line 116, in __init__\n    fd = _original_socket(family_or_realsock, *args, **kwargs)\n  File \"/usr/lib64/python2.6/socket.py\", line 184, in __init__\n    _sock = _realsocket(family, type, proto)\nerror: [Errno 97] Address family not supported by protocol\n\n\n======================================================================\nERROR: nova.tests.test_wsgi.TestWSGIServerWithSSL.test_app_using_ipv6_and_ssl\n----------------------------------------------------------------------\n_StringException: Empty attachments:\n  pythonlogging:'nova'\n\nTraceback (most recent call last):\n  File \"/root/openstack/nova/app/nova/tests/test_wsgi.py\", line 212, in test_app_using_ipv6_and_ssl\n    use_ssl=True)\n  File \"/root/openstack/nova/app/nova/wsgi.py\", line 120, in __init__\n    self._socket = eventlet.listen(bind_addr, family, backlog=backlog)\n  File \"/usr/lib/python2.6/site-packages/eventlet/convenience.py\", line 35, in listen\n    sock = socket.socket(family, socket.SOCK_STREAM)\n  File \"/usr/lib/python2.6/site-packages/eventlet/greenio.py\", line 116, in __init__\n    fd = _original_socket(family_or_realsock, *args, **kwargs)\n  File \"/usr/lib64/python2.6/socket.py\", line 184, in __init__\n    _sock = _realsocket(family, type, proto)\nerror: [Errno 97] Address family not supported by protocol", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 12, 
    "link": "https://bugs.launchpad.net/nova/+bug/1174404", 
    "owner": "https://api.launchpad.net/1.0/~unicell", 
    "id": 1174404, 
    "index": 3610, 
    "created": "2013-04-29 16:29:29.109681+00:00", 
    "title": "Unittests crashes in system has no ipv6 support", 
    "comments": [
        {
            "content": "I'm trying to run unittests and got errors trying to execute tests:\n\n======================================================================\nERROR: nova.tests.test_service.TestWSGIService.test_service_random_port_with_ipv6\n----------------------------------------------------------------------\n_StringException: Empty attachments:\n  pythonlogging:'nova'\n\nTraceback (most recent call last):\n  File \"/root/openstack/nova/app/nova/tests/test_service.py\", line 189, in test_service_random_port_with_ipv6\n    test_service = service.WSGIService(\"test_service\")\n  File \"/root/openstack/nova/app/nova/service.py\", line 608, in __init__\n    max_url_len=max_url_len)\n  File \"/root/openstack/nova/app/nova/wsgi.py\", line 120, in __init__\n    self._socket = eventlet.listen(bind_addr, family, backlog=backlog)\n  File \"/usr/lib/python2.6/site-packages/eventlet/convenience.py\", line 35, in listen\n    sock = socket.socket(family, socket.SOCK_STREAM)\n  File \"/usr/lib/python2.6/site-packages/eventlet/greenio.py\", line 116, in __init__\n    fd = _original_socket(family_or_realsock, *args, **kwargs)\n  File \"/usr/lib64/python2.6/socket.py\", line 184, in __init__\n    _sock = _realsocket(family, type, proto)\nerror: [Errno 97] Address family not supported by protocol\n\n\n======================================================================\nERROR: nova.tests.test_wsgi.TestWSGIServer.test_start_random_port_with_ipv6\n----------------------------------------------------------------------\n_StringException: Empty attachments:\n  pythonlogging:'nova'\n\nTraceback (most recent call last):\n  File \"/root/openstack/nova/app/nova/tests/test_wsgi.py\", line 106, in test_start_random_port_with_ipv6\n    host=\"::1\", port=0)\n  File \"/root/openstack/nova/app/nova/wsgi.py\", line 120, in __init__\n    self._socket = eventlet.listen(bind_addr, family, backlog=backlog)\n  File \"/usr/lib/python2.6/site-packages/eventlet/convenience.py\", line 35, in listen\n    sock = socket.socket(family, socket.SOCK_STREAM)\n  File \"/usr/lib/python2.6/site-packages/eventlet/greenio.py\", line 116, in __init__\n    fd = _original_socket(family_or_realsock, *args, **kwargs)\n  File \"/usr/lib64/python2.6/socket.py\", line 184, in __init__\n    _sock = _realsocket(family, type, proto)\nerror: [Errno 97] Address family not supported by protocol\n\n\n======================================================================\nERROR: nova.tests.test_wsgi.TestWSGIServerWithSSL.test_app_using_ipv6_and_ssl\n----------------------------------------------------------------------\n_StringException: Empty attachments:\n  pythonlogging:'nova'\n\nTraceback (most recent call last):\n  File \"/root/openstack/nova/app/nova/tests/test_wsgi.py\", line 212, in test_app_using_ipv6_and_ssl\n    use_ssl=True)\n  File \"/root/openstack/nova/app/nova/wsgi.py\", line 120, in __init__\n    self._socket = eventlet.listen(bind_addr, family, backlog=backlog)\n  File \"/usr/lib/python2.6/site-packages/eventlet/convenience.py\", line 35, in listen\n    sock = socket.socket(family, socket.SOCK_STREAM)\n  File \"/usr/lib/python2.6/site-packages/eventlet/greenio.py\", line 116, in __init__\n    fd = _original_socket(family_or_realsock, *args, **kwargs)\n  File \"/usr/lib64/python2.6/socket.py\", line 184, in __init__\n    _sock = _realsocket(family, type, proto)\nerror: [Errno 97] Address family not supported by protocol", 
            "date_created": "2013-04-29 16:29:29.109681+00:00", 
            "author": "https://api.launchpad.net/1.0/~vkhomenko"
        }, 
        {
            "content": "Perhaps should skip the test if the system has no IPv6 support. Is there any easy way to test for that?", 
            "date_created": "2013-05-08 01:55:54.415878+00:00", 
            "author": "https://api.launchpad.net/1.0/~cyeoh-0"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/31629", 
            "date_created": "2013-06-04 11:19:57.224095+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "I happen to have one system with the same symptom. It runs a customized kernel without ipv6 support.\n\nGuess it should be easy to reproduce on RHEL based systems without loading 'ipv6' kernel module. It's not easy to reproduce on Ubuntu systems because 'ipv6' has already built-in.", 
            "date_created": "2013-06-04 11:24:30.269779+00:00", 
            "author": "https://api.launchpad.net/1.0/~unicell"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/31629\nCommitted: http://github.com/openstack/nova/commit/a24d3dabc1f4ca506ab6d542e4ec1d87bbdd09b8\nSubmitter: Jenkins\nBranch:    master\n\ncommit a24d3dabc1f4ca506ab6d542e4ec1d87bbdd09b8\nAuthor: Qiu Yu <email address hidden>\nDate:   Thu Jun 6 23:45:41 2013 +0800\n\n    Skip ipv6 tests on system without ipv6 support\n    \n    On system without ipv6 support, CONFIG_IPV6 disabled kernel for\n    instance, WSGI service testcases for ipv6 would fail for \"[Errno 97]\n    Address family not supported by protocol\".\n    \n    Since there is no easy way to detect actual ipv6 support,\n    socket.has_ipv6 not working for this case, simply skip ipv6 tests if\n    errno.EAFNOSUPPORT happens.\n    \n    Fixes: bug 1174404\n    \n    Change-Id: I9fa8653f5ccfbcb8c31c51bfda137cb58388afde\n", 
            "date_created": "2013-06-13 00:35:25.273247+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/131308", 
            "date_created": "2014-10-28 00:03:15.150324+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Armando Migliaccio (<email address hidden>) on branch: master\nReview: https://review.openstack.org/131308\nReason: Thanks for the link Sean.\n\nIf Canonical no longer supports 10.04, I don't think we can reasonably expect Neutron to support 10.04.\n\n@Pritesh: please upgrade your env, if you can. We're going in the direction of making IPv6 support mandatory from Kilo on. So I'm afraid it no longer makes sense to get this change in.", 
            "date_created": "2014-11-06 22:55:33.460268+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}