{
    "status": "Invalid", 
    "last_updated": "2013-12-16 22:39:52.960194+00:00", 
    "description": "Logstash search: http://logstash.openstack.org/#eyJzZWFyY2giOiJmaWxlbmFtZTpjb25zb2xlLmh0bWwgQU5EIG1lc3NhZ2U6XCJhc3NlcnRpb25lcnJvcjogY29uc29sZSBvdXRwdXQgd2FzIGVtcHR5XCIiLCJmaWVsZHMiOltdLCJvZmZzZXQiOjAsInRpbWVmcmFtZSI6IjYwNDgwMCIsImdyYXBobW9kZSI6ImNvdW50IiwidGltZSI6eyJ1c2VyX2ludGVydmFsIjowfSwic3RhbXAiOjEzODQ2NDEwNzIxODl9\n\nAn example failure is http://logs.openstack.org/92/55492/8/check/check-tempest-devstack-vm-full/ef3a4a4/console.html\n\nconsole.html\n===========\n\n2013-11-16 21:54:27.998 | 2013-11-16 21:41:20,775 Request: POST http://127.0.0.1:8774/v2/3f6934d9aabf467aa8bc51397ccfa782/servers/10aace14-23c1-4cec-9bfd-2c873df1fbee/action\n2013-11-16 21:54:27.998 | 2013-11-16 21:41:20,776 Request Headers: {'Content-Type': 'application/json', 'Accept': 'application/json', 'X-Auth-Token': '<Token omitted>'}\n2013-11-16 21:54:27.998 | 2013-11-16 21:41:20,776 Request Body: {\"os-getConsoleOutput\": {\"length\": 10}}\n2013-11-16 21:54:27.998 | 2013-11-16 21:41:21,000 Response Status: 200\n2013-11-16 21:54:27.999 | 2013-11-16 21:41:21,001 Nova request id: req-7a2ee0ab-c977-4957-abb5-1d84191bf30c\n2013-11-16 21:54:27.999 | 2013-11-16 21:41:21,001 Response Headers: {'content-length': '14', 'date': 'Sat, 16 Nov 2013 21:41:20 GMT', 'content-type': 'application/json', 'connection': 'close'}\n2013-11-16 21:54:27.999 | 2013-11-16 21:41:21,001 Response Body: {\"output\": \"\"}\n2013-11-16 21:54:27.999 | }}}\n2013-11-16 21:54:27.999 | \n2013-11-16 21:54:27.999 | Traceback (most recent call last):\n2013-11-16 21:54:27.999 |   File \"tempest/api/compute/servers/test_server_actions.py\", line 281, in test_get_console_output\n2013-11-16 21:54:28.000 |     self.wait_for(get_output)\n2013-11-16 21:54:28.000 |   File \"tempest/api/compute/base.py\", line 133, in wait_for\n2013-11-16 21:54:28.000 |     condition()\n2013-11-16 21:54:28.000 |   File \"tempest/api/compute/servers/test_server_actions.py\", line 278, in get_output\n2013-11-16 21:54:28.000 |     self.assertTrue(output, \"Console output was empty.\")\n2013-11-16 21:54:28.000 |   File \"/usr/lib/python2.7/unittest/case.py\", line 420, in assertTrue\n2013-11-16 21:54:28.000 |     raise self.failureException(msg)\n2013-11-16 21:54:28.001 | AssertionError: Console output was empty.\n\nn-api\n====\n\n2013-11-16 21:41:20.782 DEBUG nova.api.openstack.wsgi [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] Action: 'action', body: {\"os-getConsoleOutput\": {\"length\": 10}} _process_stack /opt/stack/new/nova/nova/api/openstack/wsgi.py:963\n2013-11-16 21:41:20.782 DEBUG nova.api.openstack.wsgi [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] Calling method <bound method ConsoleOutputController.get_console_output of <nova.api.openstack.compute.contrib.console_output.ConsoleOutputController object at 0x3c1f990>> _process_stack /opt/stack/new/nova/nova/api/openstack/wsgi.py:964\n2013-11-16 21:41:20.865 DEBUG nova.openstack.common.rpc.amqp [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] Making synchronous call on compute.devstack-precise-hpcloud-az2-663635 ... multicall /opt/stack/new/nova/nova/openstack/common/rpc/amqp.py:553\n2013-11-16 21:41:20.866 DEBUG nova.openstack.common.rpc.amqp [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] MSG_ID is a93dceabf6a441eb850b5fbb012d661f multicall /opt/stack/new/nova/nova/openstack/common/rpc/amqp.py:556\n2013-11-16 21:41:20.866 DEBUG nova.openstack.common.rpc.amqp [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] UNIQUE_ID is 706ab69dc066440fbe1bd7766b73d953. _add_unique_id /opt/stack/new/nova/nova/openstack/common/rpc/amqp.py:341\n2013-11-16 21:41:20.869 22679 DEBUG amqp [-] Closed channel #1 _do_close /usr/local/lib/python2.7/dist-packages/amqp/channel.py:95\n2013-11-16 21:41:20.869 22679 DEBUG amqp [-] using channel_id: 1 __init__ /usr/local/lib/python2.7/dist-packages/amqp/channel.py:71\n2013-11-16 21:41:20.870 22679 DEBUG amqp [-] Channel open _open_ok /usr/local/lib/python2.7/dist-packages/amqp/channel.py:429\n2013-11-16 21:41:20.999 INFO nova.osapi_compute.wsgi.server [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] 127.0.0.1 \"POST /v2/3f6934d9aabf467aa8bc51397ccfa782/servers/10aace14-23c1-4cec-9bfd-2c873df1fbee/action HTTP/1.1\" status: 200 len: 205 time: 0.2208662\n\nn-cpu\n=====\n\n2013-11-16 21:41:20.878 23086 DEBUG nova.openstack.common.rpc.amqp [-] received {u'_msg_id': u'a93dceabf6a441eb850b5fbb012d661f', u'_context_quota_class': None, u'_context_request_id': u'req-7a2ee0ab-c977-4957-abb5-1d84191bf30c', u'_context_service_catalog': [{u'endpoints_links': [], u'endpoints': [{u'adminURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782', u'region': u'RegionOne', u'publicURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782', u'internalURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782', u'id': u'5725cc234a8346408dfe343aea62d3aa'}], u'type': u'volume', u'name': u'cinder'}], u'_context_auth_token': '<SANITIZED>', u'_context_user_id': u'eae9401ba3794296ae8248748ef8e26e', u'_reply_q': u'reply_546cb0ef381e4ff29c76ee96eba21c22', u'namespace': None, u'_context_is_admin': False, u'version': u'2.0', u'_context_timestamp': u'2013-11-16T21:41:20.781052', u'_context_user': u'eae9401ba3794296ae8248748ef8e26e', u'method': u'get_console_output', u'_context_remote_address': u'127.0.0.1', u'_context_roles': [u'_member_'], u'args': {u'instance': {u'vm_state': u'active', u'availability_zone': None, u'terminated_at': None, u'ephemeral_gb': 0, u'instance_type_id': 6, u'user_data': None, u'cleaned': False, u'vm_mode': None, u'deleted_at': None, u'reservation_id': u'r-dnps4t4l', u'id': 40, u'security_groups': [{u'deleted_at': None, u'user_id': u'eae9401ba3794296ae8248748ef8e26e', u'description': u'default', u'deleted': False, u'created_at': u'2013-11-16T21:37:03.000000', u'updated_at': None, u'project_id': u'3f6934d9aabf467aa8bc51397ccfa782', u'id': 47, u'name': u'default'}], u'disable_terminate': False, u'root_device_name': u'/dev/vda', u'display_name': u'ServerActionsTestJSON-instance-tempest-308881308', u'uuid': u'10aace14-23c1-4cec-9bfd-2c873df1fbee', u'default_swap_device': None, u'info_cache': {u'instance_uuid': u'10aace14-23c1-4cec-9bfd-2c873df1fbee', u'deleted': False, u'created_at': u'2013-11-16T21:37:03.000000', u'updated_at': u'2013-11-16T21:37:08.000000', u'network_info': [{u'ovs_interfaceid': None, u'network': {u'bridge': u'br100', u'label': u'private', u'meta': {u'tenant_id': None, u'should_create_bridge': True, u'bridge_interface': u'eth0'}, u'id': u'44a93331-6869-4e8a-8742-f92bb9cea7b5', u'subnets': [{u'ips': [{u'meta': {}, u'type': u'fixed', u'floating_ips': [], u'version': 4, u'address': u'10.1.0.6'}], u'version': 4, u'meta': {u'dhcp_server': u'10.1.0.1'}, u'dns': [{u'meta': {}, u'type': u'dns', u'version': 4, u'address': u'8.8.4.4'}], u'routes': [], u'cidr': u'10.1.0.0/24', u'gateway': {u'meta': {}, u'type': u'gateway', u'version': 4, u'address': u'10.1.0.1'}}, {u'ips': [], u'version': None, u'meta': {u'dhcp_server': None}, u'dns': [], u'routes': [], u'cidr': None, u'gateway': {u'meta': {}, u'type': u'gateway', u'version': None, u'address': None}}]}, u'devname': None, u'qbh_params': None, u'meta': {}, u'address': u'fa:16:3e:38:6d:dd', u'type': u'bridge', u'id': u'2bd53919-68f4-4fdb-bd51-dfc3238c6cbb', u'qbg_params': None}], u'deleted_at': None}, u'hostname': u'serveractionstestjson-instance-tempest-308881308', u'launched_on': u'devstack-precise-hpcloud-az2-663635', u'display_description': u'ServerActionsTestJSON-instance-tempest-308881308', u'key_data': None, u'deleted': False, u'config_drive': u'', u'power_state': 1, u'default_ephemeral_device': None, u'progress': 0, u'project_id': u'3f6934d9aabf467aa8bc51397ccfa782', u'launched_at': u'2013-11-16T21:37:18.000000', u'scheduled_at': u'2013-11-16T21:37:04.000000', u'node': u'devstack-precise-hpcloud-az2-663635', u'ramdisk_id': u'cd16eea0-986d-443f-a345-3b82c8f4fce6', u'access_ip_v6': None, u'access_ip_v4': None, u'kernel_id': u'b1803c3b-8f66-408b-9105-73568c7181ca', u'key_name': None, u'updated_at': u'2013-11-16T21:38:00.000000', u'host': u'devstack-precise-hpcloud-az2-663635', u'user_id': u'eae9401ba3794296ae8248748ef8e26e', u'system_metadata': {u'image_kernel_id': u'b1803c3b-8f66-408b-9105-73568c7181ca', u'instance_type_memory_mb': u'64', u'instance_type_swap': u'0', u'instance_type_vcpu_weight': None, u'instance_type_root_gb': u'0', u'instance_type_id': u'6', u'image_ramdisk_id': u'cd16eea0-986d-443f-a345-3b82c8f4fce6', u'instance_type_name': u'm1.nano', u'instance_type_ephemeral_gb': u'0', u'instance_type_rxtx_factor': u'1.0', u'image_disk_format': u'ami', u'instance_type_flavorid': u'42', u'image_container_format': u'ami', u'instance_type_vcpus': u'1', u'image_min_ram': u'0', u'image_min_disk': u'0', u'image_base_image_ref': u'11f4317b-d294-4d21-b2c4-2d7198aa32b8'}, u'task_state': None, u'shutdown_terminate': False, u'cell_name': None, u'root_gb': 0, u'locked': False, u'name': u'instance-00000028', u'created_at': u'2013-11-16T21:37:03.000000', u'locked_by': None, u'launch_index': 0, u'memory_mb': 64, u'vcpus': 1, u'image_ref': u'11f4317b-d294-4d21-b2c4-2d7198aa32b8', u'architecture': None, u'auto_disk_config': False, u'os_type': None, u'metadata': {}}, u'tail_length': 10}, u'_unique_id': u'706ab69dc066440fbe1bd7766b73d953', u'_context_project_name': u'ServerActionsTestJSON-tempest-2102529866-tenant', u'_context_read_deleted': u'no', u'_context_tenant': u'3f6934d9aabf467aa8bc51397ccfa782', u'_context_instance_lock_checked': False, u'_context_project_id': u'3f6934d9aabf467aa8bc51397ccfa782', u'_context_user_name': u'ServerActionsTestJSON-tempest-2102529866-user'} _safe_log /opt/stack/new/nova/nova/openstack/common/rpc/common.py:277\n2013-11-16 21:41:20.879 23086 DEBUG nova.openstack.common.rpc.amqp [-] unpacked context: {'tenant': u'3f6934d9aabf467aa8bc51397ccfa782', 'project_name': u'ServerActionsTestJSON-tempest-2102529866-tenant', 'user_id': u'eae9401ba3794296ae8248748ef8e26e', 'roles': [u'_member_'], 'timestamp': u'2013-11-16T21:41:20.781052', 'auth_token': '<SANITIZED>', 'remote_address': u'127.0.0.1', 'quota_class': None, 'is_admin': False, 'user': u'eae9401ba3794296ae8248748ef8e26e', 'service_catalog': [{u'endpoints': [{u'adminURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782', u'region': u'RegionOne', u'id': u'5725cc234a8346408dfe343aea62d3aa', u'internalURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782', u'publicURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782'}], u'endpoints_links': [], u'type': u'volume', u'name': u'cinder'}], 'request_id': u'req-7a2ee0ab-c977-4957-abb5-1d84191bf30c', 'instance_lock_checked': False, 'project_id': u'3f6934d9aabf467aa8bc51397ccfa782', 'user_name': u'ServerActionsTestJSON-tempest-2102529866-user', 'read_deleted': u'no'} _safe_log /opt/stack/new/nova/nova/openstack/common/rpc/common.py:277\n2013-11-16 21:41:20.880 AUDIT nova.compute.manager [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] [instance: 10aace14-23c1-4cec-9bfd-2c873df1fbee] Get console output\n2013-11-16 21:41:20.894 DEBUG nova.openstack.common.processutils [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] Running cmd (subprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf chown 1006 /opt/stack/data/nova/instances/10aace14-23c1-4cec-9bfd-2c873df1fbee/console.log execute /opt/stack/new/nova/nova/openstack/common/processutils.py:147\n2013-11-16 21:41:20.993 DEBUG nova.openstack.common.rpc.amqp [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] UNIQUE_ID is 7abfb6072ea44239ae71367bde0a4485. _add_unique_id /opt/stack/new/nova/nova/openstack/common/rpc/amqp.py:341\n2013-11-16 21:41:20.995 DEBUG nova.openstack.common.rpc.amqp [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] UNIQUE_ID is b463e1d350f441efb159170784f9ba41. _add_unique_id /opt/stack/new/nova/nova/openstack/common/rpc/amqp.py:341\n\nIn other words, nova doesn't log much here, but I think the console log might be genuinely empty?", 
    "tags": [
        "libvirt", 
        "tempest"
    ], 
    "importance": "High", 
    "heat": 108, 
    "link": "https://bugs.launchpad.net/nova/+bug/1251920", 
    "owner": "https://api.launchpad.net/1.0/~lifeless", 
    "id": 1251920, 
    "index": 1316, 
    "created": "2013-11-16 22:41:15.113134+00:00", 
    "title": "Tempest failures due to failure to return console logs from an instance", 
    "comments": [
        {
            "content": "Logstash search: http://logstash.openstack.org/#eyJzZWFyY2giOiJmaWxlbmFtZTpjb25zb2xlLmh0bWwgQU5EIG1lc3NhZ2U6XCJhc3NlcnRpb25lcnJvcjogY29uc29sZSBvdXRwdXQgd2FzIGVtcHR5XCIiLCJmaWVsZHMiOltdLCJvZmZzZXQiOjAsInRpbWVmcmFtZSI6IjYwNDgwMCIsImdyYXBobW9kZSI6ImNvdW50IiwidGltZSI6eyJ1c2VyX2ludGVydmFsIjowfSwic3RhbXAiOjEzODQ2NDEwNzIxODl9\n\nAn example failure is http://logs.openstack.org/92/55492/8/check/check-tempest-devstack-vm-full/ef3a4a4/console.html\n\nconsole.html\n===========\n\n2013-11-16 21:54:27.998 | 2013-11-16 21:41:20,775 Request: POST http://127.0.0.1:8774/v2/3f6934d9aabf467aa8bc51397ccfa782/servers/10aace14-23c1-4cec-9bfd-2c873df1fbee/action\n2013-11-16 21:54:27.998 | 2013-11-16 21:41:20,776 Request Headers: {'Content-Type': 'application/json', 'Accept': 'application/json', 'X-Auth-Token': '<Token omitted>'}\n2013-11-16 21:54:27.998 | 2013-11-16 21:41:20,776 Request Body: {\"os-getConsoleOutput\": {\"length\": 10}}\n2013-11-16 21:54:27.998 | 2013-11-16 21:41:21,000 Response Status: 200\n2013-11-16 21:54:27.999 | 2013-11-16 21:41:21,001 Nova request id: req-7a2ee0ab-c977-4957-abb5-1d84191bf30c\n2013-11-16 21:54:27.999 | 2013-11-16 21:41:21,001 Response Headers: {'content-length': '14', 'date': 'Sat, 16 Nov 2013 21:41:20 GMT', 'content-type': 'application/json', 'connection': 'close'}\n2013-11-16 21:54:27.999 | 2013-11-16 21:41:21,001 Response Body: {\"output\": \"\"}\n2013-11-16 21:54:27.999 | }}}\n2013-11-16 21:54:27.999 | \n2013-11-16 21:54:27.999 | Traceback (most recent call last):\n2013-11-16 21:54:27.999 |   File \"tempest/api/compute/servers/test_server_actions.py\", line 281, in test_get_console_output\n2013-11-16 21:54:28.000 |     self.wait_for(get_output)\n2013-11-16 21:54:28.000 |   File \"tempest/api/compute/base.py\", line 133, in wait_for\n2013-11-16 21:54:28.000 |     condition()\n2013-11-16 21:54:28.000 |   File \"tempest/api/compute/servers/test_server_actions.py\", line 278, in get_output\n2013-11-16 21:54:28.000 |     self.assertTrue(output, \"Console output was empty.\")\n2013-11-16 21:54:28.000 |   File \"/usr/lib/python2.7/unittest/case.py\", line 420, in assertTrue\n2013-11-16 21:54:28.000 |     raise self.failureException(msg)\n2013-11-16 21:54:28.001 | AssertionError: Console output was empty.\n\nn-api\n====\n\n2013-11-16 21:41:20.782 DEBUG nova.api.openstack.wsgi [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] Action: 'action', body: {\"os-getConsoleOutput\": {\"length\": 10}} _process_stack /opt/stack/new/nova/nova/api/openstack/wsgi.py:963\n2013-11-16 21:41:20.782 DEBUG nova.api.openstack.wsgi [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] Calling method <bound method ConsoleOutputController.get_console_output of <nova.api.openstack.compute.contrib.console_output.ConsoleOutputController object at 0x3c1f990>> _process_stack /opt/stack/new/nova/nova/api/openstack/wsgi.py:964\n2013-11-16 21:41:20.865 DEBUG nova.openstack.common.rpc.amqp [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] Making synchronous call on compute.devstack-precise-hpcloud-az2-663635 ... multicall /opt/stack/new/nova/nova/openstack/common/rpc/amqp.py:553\n2013-11-16 21:41:20.866 DEBUG nova.openstack.common.rpc.amqp [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] MSG_ID is a93dceabf6a441eb850b5fbb012d661f multicall /opt/stack/new/nova/nova/openstack/common/rpc/amqp.py:556\n2013-11-16 21:41:20.866 DEBUG nova.openstack.common.rpc.amqp [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] UNIQUE_ID is 706ab69dc066440fbe1bd7766b73d953. _add_unique_id /opt/stack/new/nova/nova/openstack/common/rpc/amqp.py:341\n2013-11-16 21:41:20.869 22679 DEBUG amqp [-] Closed channel #1 _do_close /usr/local/lib/python2.7/dist-packages/amqp/channel.py:95\n2013-11-16 21:41:20.869 22679 DEBUG amqp [-] using channel_id: 1 __init__ /usr/local/lib/python2.7/dist-packages/amqp/channel.py:71\n2013-11-16 21:41:20.870 22679 DEBUG amqp [-] Channel open _open_ok /usr/local/lib/python2.7/dist-packages/amqp/channel.py:429\n2013-11-16 21:41:20.999 INFO nova.osapi_compute.wsgi.server [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] 127.0.0.1 \"POST /v2/3f6934d9aabf467aa8bc51397ccfa782/servers/10aace14-23c1-4cec-9bfd-2c873df1fbee/action HTTP/1.1\" status: 200 len: 205 time: 0.2208662\n\nn-cpu\n=====\n\n2013-11-16 21:41:20.878 23086 DEBUG nova.openstack.common.rpc.amqp [-] received {u'_msg_id': u'a93dceabf6a441eb850b5fbb012d661f', u'_context_quota_class': None, u'_context_request_id': u'req-7a2ee0ab-c977-4957-abb5-1d84191bf30c', u'_context_service_catalog': [{u'endpoints_links': [], u'endpoints': [{u'adminURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782', u'region': u'RegionOne', u'publicURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782', u'internalURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782', u'id': u'5725cc234a8346408dfe343aea62d3aa'}], u'type': u'volume', u'name': u'cinder'}], u'_context_auth_token': '<SANITIZED>', u'_context_user_id': u'eae9401ba3794296ae8248748ef8e26e', u'_reply_q': u'reply_546cb0ef381e4ff29c76ee96eba21c22', u'namespace': None, u'_context_is_admin': False, u'version': u'2.0', u'_context_timestamp': u'2013-11-16T21:41:20.781052', u'_context_user': u'eae9401ba3794296ae8248748ef8e26e', u'method': u'get_console_output', u'_context_remote_address': u'127.0.0.1', u'_context_roles': [u'_member_'], u'args': {u'instance': {u'vm_state': u'active', u'availability_zone': None, u'terminated_at': None, u'ephemeral_gb': 0, u'instance_type_id': 6, u'user_data': None, u'cleaned': False, u'vm_mode': None, u'deleted_at': None, u'reservation_id': u'r-dnps4t4l', u'id': 40, u'security_groups': [{u'deleted_at': None, u'user_id': u'eae9401ba3794296ae8248748ef8e26e', u'description': u'default', u'deleted': False, u'created_at': u'2013-11-16T21:37:03.000000', u'updated_at': None, u'project_id': u'3f6934d9aabf467aa8bc51397ccfa782', u'id': 47, u'name': u'default'}], u'disable_terminate': False, u'root_device_name': u'/dev/vda', u'display_name': u'ServerActionsTestJSON-instance-tempest-308881308', u'uuid': u'10aace14-23c1-4cec-9bfd-2c873df1fbee', u'default_swap_device': None, u'info_cache': {u'instance_uuid': u'10aace14-23c1-4cec-9bfd-2c873df1fbee', u'deleted': False, u'created_at': u'2013-11-16T21:37:03.000000', u'updated_at': u'2013-11-16T21:37:08.000000', u'network_info': [{u'ovs_interfaceid': None, u'network': {u'bridge': u'br100', u'label': u'private', u'meta': {u'tenant_id': None, u'should_create_bridge': True, u'bridge_interface': u'eth0'}, u'id': u'44a93331-6869-4e8a-8742-f92bb9cea7b5', u'subnets': [{u'ips': [{u'meta': {}, u'type': u'fixed', u'floating_ips': [], u'version': 4, u'address': u'10.1.0.6'}], u'version': 4, u'meta': {u'dhcp_server': u'10.1.0.1'}, u'dns': [{u'meta': {}, u'type': u'dns', u'version': 4, u'address': u'8.8.4.4'}], u'routes': [], u'cidr': u'10.1.0.0/24', u'gateway': {u'meta': {}, u'type': u'gateway', u'version': 4, u'address': u'10.1.0.1'}}, {u'ips': [], u'version': None, u'meta': {u'dhcp_server': None}, u'dns': [], u'routes': [], u'cidr': None, u'gateway': {u'meta': {}, u'type': u'gateway', u'version': None, u'address': None}}]}, u'devname': None, u'qbh_params': None, u'meta': {}, u'address': u'fa:16:3e:38:6d:dd', u'type': u'bridge', u'id': u'2bd53919-68f4-4fdb-bd51-dfc3238c6cbb', u'qbg_params': None}], u'deleted_at': None}, u'hostname': u'serveractionstestjson-instance-tempest-308881308', u'launched_on': u'devstack-precise-hpcloud-az2-663635', u'display_description': u'ServerActionsTestJSON-instance-tempest-308881308', u'key_data': None, u'deleted': False, u'config_drive': u'', u'power_state': 1, u'default_ephemeral_device': None, u'progress': 0, u'project_id': u'3f6934d9aabf467aa8bc51397ccfa782', u'launched_at': u'2013-11-16T21:37:18.000000', u'scheduled_at': u'2013-11-16T21:37:04.000000', u'node': u'devstack-precise-hpcloud-az2-663635', u'ramdisk_id': u'cd16eea0-986d-443f-a345-3b82c8f4fce6', u'access_ip_v6': None, u'access_ip_v4': None, u'kernel_id': u'b1803c3b-8f66-408b-9105-73568c7181ca', u'key_name': None, u'updated_at': u'2013-11-16T21:38:00.000000', u'host': u'devstack-precise-hpcloud-az2-663635', u'user_id': u'eae9401ba3794296ae8248748ef8e26e', u'system_metadata': {u'image_kernel_id': u'b1803c3b-8f66-408b-9105-73568c7181ca', u'instance_type_memory_mb': u'64', u'instance_type_swap': u'0', u'instance_type_vcpu_weight': None, u'instance_type_root_gb': u'0', u'instance_type_id': u'6', u'image_ramdisk_id': u'cd16eea0-986d-443f-a345-3b82c8f4fce6', u'instance_type_name': u'm1.nano', u'instance_type_ephemeral_gb': u'0', u'instance_type_rxtx_factor': u'1.0', u'image_disk_format': u'ami', u'instance_type_flavorid': u'42', u'image_container_format': u'ami', u'instance_type_vcpus': u'1', u'image_min_ram': u'0', u'image_min_disk': u'0', u'image_base_image_ref': u'11f4317b-d294-4d21-b2c4-2d7198aa32b8'}, u'task_state': None, u'shutdown_terminate': False, u'cell_name': None, u'root_gb': 0, u'locked': False, u'name': u'instance-00000028', u'created_at': u'2013-11-16T21:37:03.000000', u'locked_by': None, u'launch_index': 0, u'memory_mb': 64, u'vcpus': 1, u'image_ref': u'11f4317b-d294-4d21-b2c4-2d7198aa32b8', u'architecture': None, u'auto_disk_config': False, u'os_type': None, u'metadata': {}}, u'tail_length': 10}, u'_unique_id': u'706ab69dc066440fbe1bd7766b73d953', u'_context_project_name': u'ServerActionsTestJSON-tempest-2102529866-tenant', u'_context_read_deleted': u'no', u'_context_tenant': u'3f6934d9aabf467aa8bc51397ccfa782', u'_context_instance_lock_checked': False, u'_context_project_id': u'3f6934d9aabf467aa8bc51397ccfa782', u'_context_user_name': u'ServerActionsTestJSON-tempest-2102529866-user'} _safe_log /opt/stack/new/nova/nova/openstack/common/rpc/common.py:277\n2013-11-16 21:41:20.879 23086 DEBUG nova.openstack.common.rpc.amqp [-] unpacked context: {'tenant': u'3f6934d9aabf467aa8bc51397ccfa782', 'project_name': u'ServerActionsTestJSON-tempest-2102529866-tenant', 'user_id': u'eae9401ba3794296ae8248748ef8e26e', 'roles': [u'_member_'], 'timestamp': u'2013-11-16T21:41:20.781052', 'auth_token': '<SANITIZED>', 'remote_address': u'127.0.0.1', 'quota_class': None, 'is_admin': False, 'user': u'eae9401ba3794296ae8248748ef8e26e', 'service_catalog': [{u'endpoints': [{u'adminURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782', u'region': u'RegionOne', u'id': u'5725cc234a8346408dfe343aea62d3aa', u'internalURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782', u'publicURL': u'http://127.0.0.1:8776/v1/3f6934d9aabf467aa8bc51397ccfa782'}], u'endpoints_links': [], u'type': u'volume', u'name': u'cinder'}], 'request_id': u'req-7a2ee0ab-c977-4957-abb5-1d84191bf30c', 'instance_lock_checked': False, 'project_id': u'3f6934d9aabf467aa8bc51397ccfa782', 'user_name': u'ServerActionsTestJSON-tempest-2102529866-user', 'read_deleted': u'no'} _safe_log /opt/stack/new/nova/nova/openstack/common/rpc/common.py:277\n2013-11-16 21:41:20.880 AUDIT nova.compute.manager [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] [instance: 10aace14-23c1-4cec-9bfd-2c873df1fbee] Get console output\n2013-11-16 21:41:20.894 DEBUG nova.openstack.common.processutils [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] Running cmd (subprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf chown 1006 /opt/stack/data/nova/instances/10aace14-23c1-4cec-9bfd-2c873df1fbee/console.log execute /opt/stack/new/nova/nova/openstack/common/processutils.py:147\n2013-11-16 21:41:20.993 DEBUG nova.openstack.common.rpc.amqp [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] UNIQUE_ID is 7abfb6072ea44239ae71367bde0a4485. _add_unique_id /opt/stack/new/nova/nova/openstack/common/rpc/amqp.py:341\n2013-11-16 21:41:20.995 DEBUG nova.openstack.common.rpc.amqp [req-7a2ee0ab-c977-4957-abb5-1d84191bf30c ServerActionsTestJSON-tempest-2102529866-user ServerActionsTestJSON-tempest-2102529866-tenant] UNIQUE_ID is b463e1d350f441efb159170784f9ba41. _add_unique_id /opt/stack/new/nova/nova/openstack/common/rpc/amqp.py:341\n\nIn other words, nova doesn't log much here, but I think the console log might be genuinely empty?", 
            "date_created": "2013-11-16 22:41:15.113134+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }, 
        {
            "content": "For the purpose of rechecks I am going to treat incomplete console logs as a special case of this bug. That might be wrong (its hard to tell at the moment), but at least it groups all the console log failures together.", 
            "date_created": "2013-11-16 22:43:21.932183+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }, 
        {
            "content": "Setting importance to high since it is hitting everyone via the gate", 
            "date_created": "2013-11-19 00:12:54.130827+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "Hit it with debug logging here:\n\nhttp://logs.openstack.org/75/57075/1/check/check-tempest-devstack-vm-postgres-full/82ace61/logs/screen-n-cpu.txt.gz\n\nLooks like it's reading 255 bytes from the file console.", 
            "date_created": "2013-11-19 03:40:51.271716+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "So, it looks like the console log isn't growing...\n\nThings I've checked:\n\n - I've downloaded the logs for the last 25 failures, and there's no commonality about what clusters fail, its spread\n - the cirros image we're using hasn't changed recently\n\nNext idea, I'm going to bring up a devstack instance and see if I can get instances to fail without tempest.", 
            "date_created": "2013-11-19 04:31:30.808458+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }, 
        {
            "content": "I just booted 100 instances in devstack, and none of them had this console problem. That's with libvirt 0.9.8-2ubuntu17.15.\n\nYours in frustration,\nMichael", 
            "date_created": "2013-11-19 06:52:41.068185+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }, 
        {
            "content": "So, this morning I took a bunch of time to poke around on a jenkins which had seen this failure. I couldn't see an obvious smoking gun, apart from this log message which implies that the qemu monitor might have crashed:\n\n    2013-11-19 21:52:20.053+0000: 9833: error : qemuMonitorIORead:513 : Unable to read from \n              monitor: Connection reset by peer\n\nAnother thing I've tried is I've run a bunch of stable/havana reviews through check, and none of them have failed so far with 10 runs. That makes me think this isn't something that's changed in libvirt or qemu, although perhaps I am wrong.\n\nI'm now at the point of reading the diff between stable/havana and master for the libvirt driver. The most obvious thing I see there that's changed is that we've started using lifecycle events. I wonder if that exposed a bug in libvirt?", 
            "date_created": "2013-11-20 04:44:19.934763+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }, 
        {
            "content": "I am now trying a test run with https://review.openstack.org/#/c/55866/2 reverted.", 
            "date_created": "2013-11-20 05:08:30.833054+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }, 
        {
            "content": "That didn't work. One out of six test runs with this change reverted failed (which I guess is a lower incidence rate, but not fixed).", 
            "date_created": "2013-11-20 11:42:13.304165+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }, 
        {
            "content": "Handy link to logstash to show when this started showing up: http://bit.ly/1c2lEIr", 
            "date_created": "2013-11-20 16:23:25.638985+00:00", 
            "author": "https://api.launchpad.net/1.0/~russellb"
        }, 
        {
            "content": "Given it started showing up on 11/14, that would make https://review.openstack.org/#/c/55866/ look like a decent candidate but mikal already beat us to trying it as the regression but apparently that's not it.", 
            "date_created": "2013-11-20 17:13:47.118334+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Russell pushed up this test patch to disable lifecycle events: https://review.openstack.org/#/c/57488/", 
            "date_created": "2013-11-20 17:27:59.111149+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "I think gate is unstable since this commit.\nhttps://github.com/openstack/nova/commit/755f6194e29c8e3daf6fd64a59dc2be4c81b1f0d\n\nWe are running tempest in our internal environment, tempest is stable until this commit. I'm yet to revert this patch and verify. If someone want to verify against gate (without merge), go for it.", 
            "date_created": "2013-11-20 18:57:45.942189+00:00", 
            "author": "https://api.launchpad.net/1.0/~bhuvan"
        }, 
        {
            "content": "Bhuvan, Michael Still already tried that but it wasn't the fix.  The proposed fix is this now:\n\nhttps://review.openstack.org/#/c/57509/2", 
            "date_created": "2013-11-20 19:03:26.206732+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Fix proposed to branch: stable/havana\nReview: https://review.openstack.org/57537", 
            "date_created": "2013-11-20 21:56:35.784459+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/57509\nCommitted: http://github.com/openstack/nova/commit/9b44d9d75d3767c6b7d1af4f237da8c1cf16266a\nSubmitter: Jenkins\nBranch:    master\n\ncommit 9b44d9d75d3767c6b7d1af4f237da8c1cf16266a\nAuthor: Robert Collins <email address hidden>\nDate:   Thu Nov 21 07:51:18 2013 +1300\n\n    Sync local from oslo.\n    \n    local has a broken TLS symbol - strong_store - in Nova today, fixed in oslo\n    some time ago in Ib544be1485823f6c619312fdee5a04031f48bbb4\n    \n    Change-Id: If4dd973acc23921dbc2bc69bb76225deb2802dad\n    Closes-Bug: #1251920\n", 
            "date_created": "2013-11-21 01:13:11.971013+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "After merging the above patch, this problem still happens.\nAnother patch(https://review.openstack.org/#/c/57193/) is on the road.", 
            "date_created": "2013-11-21 14:19:19.355013+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "https://review.openstack.org/#/c/57193/ has been merged, which just disables the test that broke everything, we still have yet to address the root cause in nova (or perhaps tempest??)", 
            "date_created": "2013-11-21 21:31:19.663974+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "https://review.openstack.org/#/c/58095/ is trying to fix the cause in tempest.", 
            "date_created": "2013-11-23 15:02:22.498540+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "We can reproduce this problem with the following:\n\n $ nova boot --image cirros-0.3.1-x86_64-uec --flavor m1.nano vm01\n $ nova backup vm01 vm01-backup daily 2\n $ nova console-log vm01\n\nThe result of \"nova console-log\" would be empty.\nIn addition, we can reproduce this with creating an instance snapshot instead of \"nova backup\":\n\n $ nova boot --image cirros-0.3.1-x86_64-uec --flavor m1.nano vm01\n $ nova image-create vm01 vm01-snapshot\n $ nova console-log vm01\n", 
            "date_created": "2013-11-26 09:07:57.728663+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "This problem seems difficult to fix at Nova side.\n\nAt snapshot() in nova/virt/libvirt/driver.py, a qemu process stops before extracting snapshot.\nThen, it creates a qemu process again after extracting snapshot like the following:\n\n virt_dom.managedSave(0)\n snapshot_backend.snapshot_extract(out_path, image_format)\n self._create_domain(domain=virt_dom)\n\nThe console log file is passed as \"-chardev\" option of qemu process.\nEx) -chardev file,id=charserial0,path=/opt/stack/data/nova/instances/6454f845-9a47-4024-bb9e-85a6525466c1/console.log\nAnd \"console-log\" API reads the file, and return it as a response.\nThe manpage of the option is the following:\n\n $ man qemu-system-x86_64\n [..]\n       -chardev file ,id=id ,path=path\n           Log all traffic received from the guest to a file.\n \n           path specifies the path of the file to be opened. This file will be created if it does not already exist, and overwritten if it does. path is required.\n\nThat means the file content will be truncated if the file exists.\nAs the result, we cannot get the console log after an instance snapshot/backup.\n\nWe could avoid this problem if live-snapshot, because of an instance not-stopping.\nHowever, current gate environment could not use live-snapshot, I guess.\n\nSo I don't have a solution at Nova side.\nI guess we can avoid this if putting the console log test at the first in Tempest.\n", 
            "date_created": "2013-11-26 09:29:28.800529+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/58478", 
            "date_created": "2013-11-26 09:51:56.863404+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/58478\nCommitted: http://github.com/openstack/tempest/commit/851a1352b9743167011371469e52b7a52550b1b7\nSubmitter: Jenkins\nBranch:    master\n\ncommit 851a1352b9743167011371469e52b7a52550b1b7\nAuthor: Ken'ichi Ohmichi <email address hidden>\nDate:   Tue Nov 26 18:42:52 2013 +0900\n\n    Add hard reboot for outputting console log\n    \n    If a instance backup, the console log file is truncated and we cannot\n    get any console log through \"console-log\" API.\n    To avoid this problem, this patch adds a hard reboot call for outputting\n    some console log.\n    \n    Related-Bug: #1251920\n    Change-Id: Ic41ee9e12beb3277a1095933c81016336057111f\n", 
            "date_created": "2013-11-26 17:47:59.845596+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Closing this out for Nova since it appears to have been addressed in tempest", 
            "date_created": "2013-12-03 22:57:12.407121+00:00", 
            "author": "https://api.launchpad.net/1.0/~russellb"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/57537\nCommitted: http://github.com/openstack/nova/commit/f4301f0601a6c45fb9bb85360259aea02325ac11\nSubmitter: Jenkins\nBranch:    stable/havana\n\ncommit f4301f0601a6c45fb9bb85360259aea02325ac11\nAuthor: Robert Collins <email address hidden>\nDate:   Thu Nov 21 07:51:18 2013 +1300\n\n    Sync local from oslo.\n    \n    local has a broken TLS symbol - strong_store - in Nova today, fixed in oslo\n    some time ago in Ib544be1485823f6c619312fdee5a04031f48bbb4\n    \n    Change-Id: If4dd973acc23921dbc2bc69bb76225deb2802dad\n    Closes-Bug: #1251920\n    (cherry picked from commit 9b44d9d75d3767c6b7d1af4f237da8c1cf16266a)\n", 
            "date_created": "2013-12-07 04:44:42.276437+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Since this is not hitting on tempest anymore, moving to Fix Released", 
            "date_created": "2013-12-12 13:53:01.857775+00:00", 
            "author": "https://api.launchpad.net/1.0/~adalbas"
        }
    ]
}