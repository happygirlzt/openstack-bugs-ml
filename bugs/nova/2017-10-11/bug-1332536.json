{
    "status": "Invalid", 
    "last_updated": "2014-12-22 06:11:59.425964+00:00", 
    "description": " icehouse\nCeph as a backend for glance and cinder\n\n when evacuate  an instance  from failed host to another. the command fails.\n\n2014-06-20 20:21:36.430 12362 ERROR oslo.messaging.rpc.dispatcher [-] Exception during message handling: error removing image\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     incoming.message))\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 88, in wrapped\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     payload)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 71, in wrapped\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 327, in decorated_function\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     function(self, context, *args, **kwargs)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 303, in decorated_function\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     e, sys.exc_info())\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 290, in decorated_function\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2251, in terminate_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     do_terminate_instance(instance, bdms)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 249, in inner\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     return f(*args, **kwargs)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2249, in do_terminate_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     self._set_instance_error_state(context, instance['uuid'])\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2239, in do_terminate_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     reservations=reservations)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/hooks.py\", line 103, in inner\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     rv = f(*args, **kwargs)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2209, in _delete_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     user_id=user_id)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2179, in _delete_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     self._shutdown_instance(context, db_inst, bdms)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2114, in _shutdown_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     requested_networks)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2104, in _shutdown_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     block_device_info)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 961, in destroy\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     destroy_disks, migrate_data)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1079, in cleanup\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     self._cleanup_rbd(instance)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1086, in _cleanup_rbd\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     driver.cleanup_volumes(instance)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/rbd_utils.py\", line 237, in cleanup_volumes\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     self.rbd.RBD().remove(client.ioctx, volume)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/rbd.py\", line 300, in remove\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     raise make_ex(ret, 'error removing image')\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher ImageBusy: error removing image\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher", 
    "tags": [
        "volumes"
    ], 
    "importance": "Low", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1332536", 
    "owner": "None", 
    "id": 1332536, 
    "index": 19, 
    "created": "2014-06-20 13:25:31.461478+00:00", 
    "title": "ImageBusy: error removing image. when evacuate on ceph backed volume", 
    "comments": [
        {
            "content": " icehouse\nCeph as a backend for glance and cinder\n\n when evacuate  an instance  from failed host to another. the command fails.\n\n2014-06-20 20:21:36.430 12362 ERROR oslo.messaging.rpc.dispatcher [-] Exception during message handling: error removing image\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     incoming.message))\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 88, in wrapped\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     payload)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 71, in wrapped\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 327, in decorated_function\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     function(self, context, *args, **kwargs)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 303, in decorated_function\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     e, sys.exc_info())\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 290, in decorated_function\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2251, in terminate_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     do_terminate_instance(instance, bdms)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 249, in inner\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     return f(*args, **kwargs)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2249, in do_terminate_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     self._set_instance_error_state(context, instance['uuid'])\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2239, in do_terminate_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     reservations=reservations)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/hooks.py\", line 103, in inner\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     rv = f(*args, **kwargs)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2209, in _delete_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     user_id=user_id)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2179, in _delete_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     self._shutdown_instance(context, db_inst, bdms)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2114, in _shutdown_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     requested_networks)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 2104, in _shutdown_instance\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     block_device_info)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 961, in destroy\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     destroy_disks, migrate_data)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1079, in cleanup\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     self._cleanup_rbd(instance)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1086, in _cleanup_rbd\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     driver.cleanup_volumes(instance)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/rbd_utils.py\", line 237, in cleanup_volumes\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     self.rbd.RBD().remove(client.ioctx, volume)\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/rbd.py\", line 300, in remove\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher     raise make_ex(ret, 'error removing image')\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher ImageBusy: error removing image\n2014-06-20 20:21:36.430 12362 TRACE oslo.messaging.rpc.dispatcher", 
            "date_created": "2014-06-20 13:25:31.461478+00:00", 
            "author": "https://api.launchpad.net/1.0/~wing731"
        }, 
        {
            "content": "Please provide a reproduce scenario for this.", 
            "date_created": "2014-09-09 15:18:20.729843+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "I met similar  issue recently,   with share storage ceph backend.    'ImageBusy: error removing image'  just was  another exception  when  clean up  instance on target host  after evacuate failure .   The image is used by the original instance from ceph side,  so ceph think it was used .  In normal  evacuate workflow  we don't need clean up  imag ,so the root cause is  why the evacuate failure .In my test env ,    I hit the bug https://bugs.launchpad.net/neutron/+bug/1357476,", 
            "date_created": "2014-12-22 06:11:42.250940+00:00", 
            "author": "https://api.launchpad.net/1.0/~glongwave"
        }
    ]
}