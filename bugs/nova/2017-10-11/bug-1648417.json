{
    "status": "Invalid", 
    "last_updated": "2016-12-16 06:52:25.246993+00:00", 
    "description": "Description\n===========\nWhen i set 'admin pass' of one server, got 'AttributeError' error.\n\nSteps to reproduce\n==================\n* Upload windows image with qemu-guest-agent\n* Then add metadata 'hw_qemu_guest_agent=yes' to the image\n* Then boot one server A with this image\n* Then use ``nova set-password A`` to change admin pass\n\nExpected result\n===============\nSet admin password successfully.\n\nActual result\n=============\nERROR (Conflict): Failed to set admin password on ba631d0f-bdad-4928-be5e-e52fee05f1e1 because error setting admin password (HTTP 409) (Request-ID: req-52de5986-409e-40d1-ac74-59bed6d3b797)\n\nEnvironment\n===========\n1. nova version\n# rpm -qa | grep nova\nopenstack-nova-api-13.0.0-3.el7.noarch\nopenstack-nova-console-13.0.0-3.el7.noarch\npython-nova-13.0.0-3.el7.noarch\nopenstack-nova-conductor-13.0.0-3.el7.noarch\nopenstack-nova-scheduler-13.0.0-3.el7.noarch\nopenstack-nova-novncproxy-13.0.0-3.el7.noarch\nopenstack-nova-common-13.0.0-3.el7.noarch\npython-novaclient-3.3.1-2.el7.noarch\n\n2. Which hypervisor did you use?\nLibvirt + KVM\n# rpm -qa | grep libvirt\nlibvirt-daemon-1.2.17-13.el7_2.5.x86_64\nlibvirt-client-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-nwfilter-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-qemu-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-secret-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-kvm-1.2.17-13.el7_2.5.x86_64\nlibvirt-devel-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-network-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-nodedev-1.2.17-13.el7_2.5.x86_64\nlibvirt-docs-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-interface-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-storage-1.2.17-13.el7_2.5.x86_64\nlibvirt-python-1.2.18-1.el7.x86_64\n\n# rpm -qa | grep qemu\nlibvirt-daemon-driver-qemu-1.2.17-13.el7_2.5.x86_64\nqemu-kvm-ev-2.3.0-31.el7.16.1.x86_64\nqemu-kvm-common-ev-2.3.0-31.el7.16.1.x86_64\nipxe-roms-qemu-20130517-8.gitc4bce43.el7_2.1.noarch\nqemu-img-ev-2.3.0-31.el7.16.1.x86_64\ncentos-release-qemu-ev-1.0-1.el7.noarch\n\n   (For example: Libvirt + KVM, Libvirt + XEN, Hyper-V, PowerKVM, ...)\n   What's the version of that?\n\nLogs & Configs\n==============\nnova-compute.log\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [req-52de5986-409e-40d1-ac74-59bed6d3b797 455e4c768a414f12927dfed27657c707 bc7b1de930bf428295b69d5627513d9e - - -] [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1] set_admin_password failed\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1] Traceback (most recent call last):\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3301, in set_admin_password\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]     self.driver.set_admin_password(instance, new_pass)\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1815, in set_admin_password\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]     guest.set_user_password(user, new_pass)\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/guest.py\", line 387, in set_user_password\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]     self._domain.setUserPassword(user, new_pass, 0)\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 176, in __getattr__\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]     f = getattr(self._obj, attr_name)\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1] AttributeError: 'virDomain' object has no attribute 'setUserPassword'", 
    "tags": [
        "libvirt"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1648417", 
    "owner": "None", 
    "id": 1648417, 
    "index": 6574, 
    "created": "2016-12-08 10:59:23.472599+00:00", 
    "title": "Failed to set admin pass", 
    "comments": [
        {
            "content": "Description\n===========\nWhen i set 'admin pass' of one server, got 'AttributeError' error.\n\nSteps to reproduce\n==================\n* Upload windows image with qemu-guest-agent\n* Then add metadata 'hw_qemu_guest_agent=yes' to the image\n* Then boot one server A with this image\n* Then use ``nova set-password A`` to change admin pass\n\nExpected result\n===============\nSet admin password successfully.\n\nActual result\n=============\nERROR (Conflict): Failed to set admin password on ba631d0f-bdad-4928-be5e-e52fee05f1e1 because error setting admin password (HTTP 409) (Request-ID: req-52de5986-409e-40d1-ac74-59bed6d3b797)\n\nEnvironment\n===========\n1. nova version\n# rpm -qa | grep nova\nopenstack-nova-api-13.0.0-3.el7.noarch\nopenstack-nova-console-13.0.0-3.el7.noarch\npython-nova-13.0.0-3.el7.noarch\nopenstack-nova-conductor-13.0.0-3.el7.noarch\nopenstack-nova-scheduler-13.0.0-3.el7.noarch\nopenstack-nova-novncproxy-13.0.0-3.el7.noarch\nopenstack-nova-common-13.0.0-3.el7.noarch\npython-novaclient-3.3.1-2.el7.noarch\n\n2. Which hypervisor did you use?\nLibvirt + KVM\n# rpm -qa | grep libvirt\nlibvirt-daemon-1.2.17-13.el7_2.5.x86_64\nlibvirt-client-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-nwfilter-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-qemu-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-secret-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-kvm-1.2.17-13.el7_2.5.x86_64\nlibvirt-devel-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-network-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-nodedev-1.2.17-13.el7_2.5.x86_64\nlibvirt-docs-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-interface-1.2.17-13.el7_2.5.x86_64\nlibvirt-daemon-driver-storage-1.2.17-13.el7_2.5.x86_64\nlibvirt-python-1.2.18-1.el7.x86_64\n\n# rpm -qa | grep qemu\nlibvirt-daemon-driver-qemu-1.2.17-13.el7_2.5.x86_64\nqemu-kvm-ev-2.3.0-31.el7.16.1.x86_64\nqemu-kvm-common-ev-2.3.0-31.el7.16.1.x86_64\nipxe-roms-qemu-20130517-8.gitc4bce43.el7_2.1.noarch\nqemu-img-ev-2.3.0-31.el7.16.1.x86_64\ncentos-release-qemu-ev-1.0-1.el7.noarch\n\n   (For example: Libvirt + KVM, Libvirt + XEN, Hyper-V, PowerKVM, ...)\n   What's the version of that?\n\nLogs & Configs\n==============\nnova-compute.log\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [req-52de5986-409e-40d1-ac74-59bed6d3b797 455e4c768a414f12927dfed27657c707 bc7b1de930bf428295b69d5627513d9e - - -] [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1] set_admin_password failed\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1] Traceback (most recent call last):\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3301, in set_admin_password\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]     self.driver.set_admin_password(instance, new_pass)\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1815, in set_admin_password\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]     guest.set_user_password(user, new_pass)\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/guest.py\", line 387, in set_user_password\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]     self._domain.setUserPassword(user, new_pass, 0)\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 176, in __getattr__\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1]     f = getattr(self._obj, attr_name)\n2016-12-08 18:42:13.146 2500 ERROR nova.compute.manager [instance: ba631d0f-bdad-4928-be5e-e52fee05f1e1] AttributeError: 'virDomain' object has no attribute 'setUserPassword'", 
            "date_created": "2016-12-08 10:59:23.472599+00:00", 
            "author": "https://api.launchpad.net/1.0/~eric-xie"
        }, 
        {
            "content": "Mitaka is in security release only mode. Can this be replicated on master? If so we could consider a fix and a backport, however at this point it looks like there is content missing in actual libvirt upstream interface.", 
            "date_created": "2016-12-08 20:20:44.681114+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "@Sean, thanks for your reply. I will try it in master later.", 
            "date_created": "2016-12-09 00:03:42.322640+00:00", 
            "author": "https://api.launchpad.net/1.0/~eric-xie"
        }, 
        {
            "content": "I checked it on master, and this issue was gone.", 
            "date_created": "2016-12-16 06:52:05.476235+00:00", 
            "author": "https://api.launchpad.net/1.0/~eric-xie"
        }
    ]
}