{
    "status": "Invalid", 
    "last_updated": "2014-06-05 19:30:54.211694+00:00", 
    "description": "aio, cisco, including https://review.openstack.org/#/c/85121/\n\nnova boots timeout with:\n\n2014-04-03 20:21:44.973 1816 WARNING nova.virt.libvirt.driver [req-bff726de-c4bf\n-4a46-a1a1-8793499f3380 f94b73f2d0c54b6e8fe7bc4525db9a32 59839cbf923e46eea50ff71\n85ecae8b7] Timeout waiting for vif plugging callback for instance 74574690-c46a-\n423a-b327-24a141c84137\n2014-04-03 20:21:45.928 1816 ERROR nova.compute.manager [req-bff726de-c4bf-4a46-\na1a1-8793499f3380 f94b73f2d0c54b6e8fe7bc4525db9a32 59839cbf923e46eea50ff7185ecae\n8b7] [instance: 74574690-c46a-423a-b327-24a141c84137] Instance failed to spawn\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137] Traceback (most recent call last):\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]   File \"/usr/lib/python2.7/dist-packages/nova/compute/m\nanager.py\", line 1718, in _spawn\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]     block_device_info)\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libv\nirt/driver.py\", line 2251, in spawn\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]     block_device_info)\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libv\nirt/driver.py\", line 3654, in _create_domain_and_network\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]     raise exception.VirtualInterfaceCreateException()\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137] VirtualInterfaceCreateException: Virtual Interface crea\ntion failed\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]", 
    "tags": [
        "libvirt"
    ], 
    "importance": "Undecided", 
    "heat": 14, 
    "link": "https://bugs.launchpad.net/nova/+bug/1302163", 
    "owner": "None", 
    "id": 1302163, 
    "index": 4714, 
    "created": "2014-04-03 20:30:42.308083+00:00", 
    "title": "nova boot VIF creation fails", 
    "comments": [
        {
            "content": "aio, cisco, including https://review.openstack.org/#/c/85121/\n\nnova boots timeout with:\n\n2014-04-03 20:21:44.973 1816 WARNING nova.virt.libvirt.driver [req-bff726de-c4bf\n-4a46-a1a1-8793499f3380 f94b73f2d0c54b6e8fe7bc4525db9a32 59839cbf923e46eea50ff71\n85ecae8b7] Timeout waiting for vif plugging callback for instance 74574690-c46a-\n423a-b327-24a141c84137\n2014-04-03 20:21:45.928 1816 ERROR nova.compute.manager [req-bff726de-c4bf-4a46-\na1a1-8793499f3380 f94b73f2d0c54b6e8fe7bc4525db9a32 59839cbf923e46eea50ff7185ecae\n8b7] [instance: 74574690-c46a-423a-b327-24a141c84137] Instance failed to spawn\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137] Traceback (most recent call last):\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]   File \"/usr/lib/python2.7/dist-packages/nova/compute/m\nanager.py\", line 1718, in _spawn\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]     block_device_info)\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libv\nirt/driver.py\", line 2251, in spawn\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]     block_device_info)\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libv\nirt/driver.py\", line 3654, in _create_domain_and_network\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]     raise exception.VirtualInterfaceCreateException()\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137] VirtualInterfaceCreateException: Virtual Interface crea\ntion failed\n2014-04-03 20:21:45.928 1816 TRACE nova.compute.manager [instance: 74574690-c46a\n-423a-b327-24a141c84137]", 
            "date_created": "2014-04-03 20:30:42.308083+00:00", 
            "author": "https://api.launchpad.net/1.0/~chris-ricker"
        }, 
        {
            "content": "related OVS log\n\n2014-04-03T20:13:50.878Z|00185|bridge|INFO|bridge br-int: added interface qr-664\n93f72-d3 on port 1\n2014-04-03T20:13:51.010Z|00186|netdev_linux|INFO|ioctl(SIOCGIFHWADDR) on qr-6649\n3f72-d3 device failed: No such device\n2014-04-03T20:13:52.864Z|00187|bridge|INFO|bridge br-ex: added interface qg-d8b8\n6bbc-45 on port 2\n2014-04-03T20:13:52.866Z|00188|netdev_linux|WARN|ioctl(SIOCGIFINDEX) on qr-66493\nf72-d3 device failed: No such device\n2014-04-03T20:13:52.866Z|00189|netdev_linux|WARN|qr-66493f72-d3: removing polici\nng failed: No such device\n2014-04-03T20:13:52.990Z|00190|netdev_linux|INFO|ioctl(SIOCGIFHWADDR) on qg-d8b8\n6bbc-45 device failed: No such device\n2014-04-03T20:13:53.682Z|00191|netdev_linux|WARN|ioctl(SIOCGIFINDEX) on qg-d8b86\nbbc-45 device failed: No such device\n2014-04-03T20:13:58.008Z|00192|ofproto|INFO|br-int: 196 flow_mods in the 59 s st\narting 60 s ago (98 adds, 98 deletes)\n2014-04-03T20:14:57.684Z|00193|ofproto|INFO|br-int: 194 flow_mods in the last 59\n s (97 adds, 97 deletes)\n2014-04-03T20:15:58.057Z|00194|ofproto|INFO|br-int: 194 flow_mods in the 59 s st\narting 60 s ago (97 adds, 97 deletes)\n2014-04-03T20:16:42.918Z|00195|bridge|INFO|bridge br-int: added interface tapa13\n3606f-6f on port 2\n2014-04-03T20:16:42.918Z|00196|netdev_linux|WARN|qg-d8b86bbc-45: removing polici\nng failed: No such device\n2014-04-03T20:16:43.242Z|00197|netdev_linux|INFO|ioctl(SIOCGIFHWADDR) on tapa133\n606f-6f device failed: No such device\n2014-04-03T20:16:43.691Z|00198|netdev_linux|WARN|ioctl(SIOCGIFINDEX) on tapa1336\n06f-6f device failed: No such device\n2014-04-03T20:16:44.275Z|00199|bridge|INFO|bridge br-int: added interface qvo508\n73e63-29 on port 3\n2014-04-03T20:16:44.275Z|00200|netdev_linux|WARN|tapa133606f-6f: removing polici\nng failed: No such device", 
            "date_created": "2014-04-03 20:35:22.753657+00:00", 
            "author": "https://api.launchpad.net/1.0/~chris-ricker"
        }, 
        {
            "content": "nova boot command was\n\nnova boot --flavor 2 --image 811eef9f-0c6e-4283-9139-07d2c95812ab --key_name test --nic net-id=102dabcc-a384-4ccc-bc4c-c9734b9ba2e0 testvm", 
            "date_created": "2014-04-03 20:36:56.133623+00:00", 
            "author": "https://api.launchpad.net/1.0/~chris-ricker"
        }, 
        {
            "content": "i encountered this problem\n| fault                                | {\"message\": \"Virtual Interface creation failed\", \"code\": 500, \"details\": \"  File \\\"/usr/lib/python2.6/site-packages/nova/compute/manager.py\\\", line 302, in decorated_function |\n|                                      |     return function(self, context, *args, **kwargs)                                                                                                                            |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/compute/manager.py\\\", line 2109, in run_instance                                                                                |\n|                                      |     do_run_instance()                                                                                                                                                          |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\\\", line 249, in inner                                                                             |\n|                                      |     return f(*args, **kwargs)                                                                                                                                                  |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/compute/manager.py\\\", line 2108, in do_run_instance                                                                             |\n|                                      |     legacy_bdm_in_spec)                                                                                                                                                        |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/compute/manager.py\\\", line 1214, in _run_instance                                                                               |\n|                                      |     notify(\\\"error\\\", fault=e)  # notify that build failed                                                                                                                     |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\\\", line 68, in __exit__                                                                            |\n|                                      |     six.reraise(self.type_, self.value, self.tb)                                                                                                                               |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/compute/manager.py\\\", line 1198, in _run_instance                                                                               |\n|                                      |     instance, image_meta, legacy_bdm_in_spec)                                                                                                                                  |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/compute/manager.py\\\", line 1342, in _build_instance                                                                             |\n|                                      |     network_info.wait(do_raise=False)                                                                                                                                          |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\\\", line 68, in __exit__                                                                            |\n|                                      |     six.reraise(self.type_, self.value, self.tb)                                                                                                                               |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/compute/manager.py\\\", line 1318, in _build_instance                                                                             |\n|                                      |     set_access_ip=set_access_ip)                                                                                                                                               |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/compute/manager.py\\\", line 405, in decorated_function                                                                           |\n|                                      |     return function(self, context, *args, **kwargs)                                                                                                                            |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/compute/manager.py\\\", line 1757, in _spawn                                                                                      |\n|                                      |     LOG.exception(_('Instance failed to spawn'), instance=instance)                                                                                                            |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\\\", line 68, in __exit__                                                                            |\n|                                      |     six.reraise(self.type_, self.value, self.tb)                                                                                                                               |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/compute/manager.py\\\", line 1743, in _spawn                                                                                      |\n|                                      |     block_device_info)                                                                                                                                                         |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\\\", line 2254, in spawn                                                                                   |\n|                                      |     block_device_info)                                                                                                                                                         |\n|                                      |   File \\\"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\\\", line 3684, in _create_domain_and_network                                                              |\n|                                      |     raise exception.VirtualInterfaceCreateException()                                                                                                                          |\n|                                      | \", \"created\": \"2014-04-07T03:28:48Z\"}                                                                                                                                          |\n", 
            "date_created": "2014-04-07 04:29:10.429128+00:00", 
            "author": "https://api.launchpad.net/1.0/~yuxingw"
        }, 
        {
            "content": "Can you please indicate which version of OpenStack and Open vSwitch you are running.  Additionally, please indicate the operating system on which you are running OpenStack.", 
            "date_created": "2014-04-08 17:28:28.370677+00:00", 
            "author": "https://api.launchpad.net/1.0/~sross-7"
        }, 
        {
            "content": "i'm seeing this on ubuntu 14.04 beta + icehouse", 
            "date_created": "2014-04-09 10:24:11.514596+00:00", 
            "author": "https://api.launchpad.net/1.0/~augustsimonelli"
        }, 
        {
            "content": "This appears to be related to the new VIF plugging behavior in neutron (https://review.openstack.org/#/c/75253/).  The workaround is to add the following to the [DEFAULT] section of nova.conf:\n\nvif_plugging_timeout=10\nvif_plugging_is_fatal=False\n\nI'll note that others in the community have noted previous that this is required for Open Daylight (see Kyle's note at http://www.siliconloons.com/workaround-for-odl-in-neutron/), but it appears it may be necessary for the OVS plugin and possibly ML2 with the OVS driver as well.\n\n", 
            "date_created": "2014-04-11 01:33:09.696893+00:00", 
            "author": "https://api.launchpad.net/1.0/~mvoelker"
        }, 
        {
            "content": "Tracking this down a bit further, I think in my case it's matter of the new notification stuff not being configured quite correctly.  There's a Stackforge patch with some new options in progress here:\n\nhttps://review.openstack.org/#/c/85269\n\nWhich corresponds to this section of neutron.conf:\n\nhttps://github.com/openstack/neutron/blob/master/etc/neutron.conf#L297-L326\n\nAnd we'll have to introduce a couple of new composition layer changes accordingly.  With that all set correctly I think we're ok--meaning this probably isn't a nova bug.  Other folks upgrading from Havana should also have a look and double check that they've configured these new directives correctly.", 
            "date_created": "2014-04-11 03:23:19.888629+00:00", 
            "author": "https://api.launchpad.net/1.0/~mvoelker"
        }, 
        {
            "content": "See also:\n\nhttps://review.openstack.org/#/c/87021/ - add parameters for VIF plugging\nhttps://review.openstack.org/#/c/87650/ - disable VIF plugging in the composition layer", 
            "date_created": "2014-04-17 13:51:00.295116+00:00", 
            "author": "https://api.launchpad.net/1.0/~chris-ricker"
        }, 
        {
            "content": "There's also an alternative to the VIF plugging parameters patch being circulated:\n\nhttps://review.openstack.org/#/c/88410/\n\nThis version (unlike 87021) is aimed at working in deployments with a dedicated network node (E.g. keystone and neutron on different hosts).  We'll be testing and reviewing both and working with the rest of the puppet community to come to consensus.", 
            "date_created": "2014-04-17 19:33:12.414366+00:00", 
            "author": "https://api.launchpad.net/1.0/~mvoelker"
        }, 
        {
            "content": "Preliminary patch here, needs testing and possibly iterating.  \n\nhttps://review.openstack.org/#/c/91153", 
            "date_created": "2014-04-29 20:05:24.041004+00:00", 
            "author": "https://api.launchpad.net/1.0/~mvoelker"
        }, 
        {
            "content": "I have similar error, what to do?\nI'm using ubuntu 12.04 with new ovs version 2.3\nMessage\n    Virtual Interface creation failed\nCode\n    500\nDetails\n    File \"/opt/stack/nova/nova/compute/manager.py\", line 301, in decorated_function return function(self, context, *args, **kwargs) File \"/opt/stack/nova/nova/compute/manager.py\", line 2120, in run_instance do_run_instance() File \"/opt/stack/nova/nova/openstack/common/lockutils.py\", line 249, in inner return f(*args, **kwargs) File \"/opt/stack/nova/nova/compute/manager.py\", line 2119, in do_run_instance legacy_bdm_in_spec) File \"/opt/stack/nova/nova/compute/manager.py\", line 1237, in _run_instance notify(\"error\", fault=e) # notify that build failed File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__ six.reraise(self.type_, self.value, self.tb) File \"/opt/stack/nova/nova/compute/manager.py\", line 1221, in _run_instance instance, image_meta, legacy_bdm_in_spec) File \"/opt/stack/nova/nova/compute/manager.py\", line 1364, in _build_instance network_info.wait(do_raise=False) File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__ six.reraise(self.type_, self.value, self.tb) File \"/opt/stack/nova/nova/compute/manager.py\", line 1341, in _build_instance set_access_ip=set_access_ip) File \"/opt/stack/nova/nova/compute/manager.py\", line 401, in decorated_function return function(self, context, *args, **kwargs) File \"/opt/stack/nova/nova/compute/manager.py\", line 1758, in _spawn LOG.exception(_('Instance failed to spawn'), instance=instance) File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__ six.reraise(self.type_, self.value, self.tb) File \"/opt/stack/nova/nova/compute/manager.py\", line 1755, in _spawn block_device_info) File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2287, in spawn block_device_info) File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3699, in _create_domain_and_network raise exception.VirtualInterfaceCreateException() ", 
            "date_created": "2014-05-21 20:57:34.163235+00:00", 
            "author": "https://api.launchpad.net/1.0/~fekihahmed-mohamed"
        }, 
        {
            "content": "check openvswitch version >= 2.0.0 ", 
            "date_created": "2014-05-28 05:26:44.987227+00:00", 
            "author": "https://api.launchpad.net/1.0/~mingb1989"
        }
    ]
}