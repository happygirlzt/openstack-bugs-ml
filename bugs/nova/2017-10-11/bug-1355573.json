{
    "status": "Won't Fix", 
    "last_updated": "2016-02-23 19:01:12.421231+00:00", 
    "description": "Not sure this is a duplicate, but I've noticed failing tempest volume scenarios as part of grenade tests, ie\n\nhttp://logs.openstack.org/07/112707/1/check/check-grenade-dsvm-partial-ncpu/43dbf72/logs/testr_results.html.gz\n\nTraceback (most recent call last):\n  File \"tempest/test.py\", line 128, in wrapper\n    return f(self, *func_args, **func_kwargs)\n  File \"tempest/scenario/test_volume_boot_pattern.py\", line 163, in test_volume_boot_pattern\n    keypair)\n  File \"tempest/scenario/test_volume_boot_pattern.py\", line 116, in _ssh_to_server\n    private_key=keypair.private_key)\n  File \"tempest/scenario/manager.py\", line 484, in get_remote_client\n    linux_client.validate_authentication()\n  File \"tempest/common/utils/linux/remote_client.py\", line 53, in validate_authentication\n    self.ssh_client.test_connection_auth()\n  File \"tempest/common/ssh.py\", line 150, in test_connection_auth\n    connection = self._get_ssh_connection()\n  File \"tempest/common/ssh.py\", line 87, in _get_ssh_connection\n    password=self.password)\nSSHTimeout: Connection to the 172.24.4.2 via SSH timed out.\nUser: cirros, Password: None\n\nChecking logstash these seem to be happening frequently during grenade jobs, failing both test_snapshot_pattern and test_volume_boot_pattern tests. 141 failures over the last 7 days.\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiU1NIVGltZW91dDogQ29ubmVjdGlvbiB0byB0aGUgMTcyLjI0LjQuMiB2aWEgU1NIIHRpbWVkIG91dC5cIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQwNzgxMzYzNjg1Nn0=", 
    "tags": [
        "testing"
    ], 
    "importance": "Undecided", 
    "heat": 46, 
    "link": "https://bugs.launchpad.net/nova/+bug/1355573", 
    "owner": "None", 
    "id": 1355573, 
    "index": 5065, 
    "created": "2014-08-12 03:25:58.197830+00:00", 
    "title": "tempest volume scenarios periodically fail /w SSHTimeout", 
    "comments": [
        {
            "content": "Not sure this is a duplicate, but I've noticed failing tempest volume scenarios as part of grenade tests, ie\n\nhttp://logs.openstack.org/07/112707/1/check/check-grenade-dsvm-partial-ncpu/43dbf72/logs/testr_results.html.gz\n\nTraceback (most recent call last):\n  File \"tempest/test.py\", line 128, in wrapper\n    return f(self, *func_args, **func_kwargs)\n  File \"tempest/scenario/test_volume_boot_pattern.py\", line 163, in test_volume_boot_pattern\n    keypair)\n  File \"tempest/scenario/test_volume_boot_pattern.py\", line 116, in _ssh_to_server\n    private_key=keypair.private_key)\n  File \"tempest/scenario/manager.py\", line 484, in get_remote_client\n    linux_client.validate_authentication()\n  File \"tempest/common/utils/linux/remote_client.py\", line 53, in validate_authentication\n    self.ssh_client.test_connection_auth()\n  File \"tempest/common/ssh.py\", line 150, in test_connection_auth\n    connection = self._get_ssh_connection()\n  File \"tempest/common/ssh.py\", line 87, in _get_ssh_connection\n    password=self.password)\nSSHTimeout: Connection to the 172.24.4.2 via SSH timed out.\nUser: cirros, Password: None\n\nChecking logstash these seem to be happening frequently during grenade jobs, failing both test_snapshot_pattern and test_volume_boot_pattern tests. 141 failures over the last 7 days.\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiU1NIVGltZW91dDogQ29ubmVjdGlvbiB0byB0aGUgMTcyLjI0LjQuMiB2aWEgU1NIIHRpbWVkIG91dC5cIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQwNzgxMzYzNjg1Nn0=", 
            "date_created": "2014-08-12 03:25:58.197830+00:00", 
            "author": "https://api.launchpad.net/1.0/~gandelman-a"
        }, 
        {
            "content": "Yeah this is a known thing, the ssh timeout failure is generic so it's hard to classify in elastic-recheck:\n\nhttp://logs.openstack.org/71/179971/2/gate/gate-grenade-dsvm/eb2fb74/logs/grenade.sh.txt.gz#_2015-05-20_07_26_25_655\n\nI think we'll need a change to tempest to log a specific error for the test in this case so we can track this bug.", 
            "date_created": "2015-05-21 15:56:19.548691+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Here is a change to tempest to add some more contextual logging around the error:\n\nhttps://review.openstack.org/#/c/184815/", 
            "date_created": "2015-05-21 16:27:07.072037+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "The tempest logging change is merged, here is an updated query with the specific test that's failing:\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiIobWVzc2FnZTpcIlRlc3RWb2x1bWVCb290UGF0dGVybjp0ZXN0X3ZvbHVtZV9ib290X3BhdHRlcm5cIiBPUiBtZXNzYWdlOlwiVGVzdFZvbHVtZUJvb3RQYXR0ZXJuVjI6dGVzdF92b2x1bWVfYm9vdF9wYXR0ZXJuXCIpIEFORCBtZXNzYWdlOlwiSW5pdGlhbGl6aW5nIFNTSCBjb25uZWN0aW9uIHRvXCIgQU5EIG1lc3NhZ2U6XCJ2aWEgU1NIIHRpbWVkIG91dC5cIiBBTkQgdGFnczpcInRlbXBlc3QudHh0XCIiLCJmaWVsZHMiOltdLCJvZmZzZXQiOjAsInRpbWVmcmFtZSI6IjYwNDgwMCIsImdyYXBobW9kZSI6ImNvdW50IiwidGltZSI6eyJ1c2VyX2ludGVydmFsIjowfSwic3RhbXAiOjE0MzIzMDkxMzEzMjYsIm1vZGUiOiIiLCJhbmFseXplX2ZpZWxkIjoiIn0=", 
            "date_created": "2015-05-22 15:39:19.197474+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Added to nova as it's not grenade specific and I saw it in a tempest-dvvm-full job", 
            "date_created": "2016-01-11 06:22:49.138694+00:00", 
            "author": "https://api.launchpad.net/1.0/~o-tony"
        }, 
        {
            "content": "None of the links in this bug are valid any more. If there is a relevant new bug we can do that. ", 
            "date_created": "2016-02-22 16:49:11.041235+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "This report gets  old but  I am writing some debugging info on this now temporary.\n\nThe latest issue is http://logs.openstack.org/72/282872/2/check/gate-tempest-dsvm-postgres-full/db55de4/logs/\n\nThe following tests failed:\n- test_minimum_basic_scenario\n- test_shelve_instance\n- test_shelve_volume_backed_instance\n- test_snapshot_pattern\n- test_volume_boot_pattern\n- test_volume_boot_pattern\n\nAll tests failed like:\n\nTraceback (most recent call last):\n  File \"tempest/test.py\", line 113, in wrapper\n    return f(self, *func_args, **func_kwargs)\n  File \"tempest/scenario/test_shelve_instance.py\", line 98, in test_shelve_instance\n    self._create_server_then_shelve_and_unshelve()\n  File \"tempest/scenario/test_shelve_instance.py\", line 82, in _create_server_then_shelve_and_unshelve\n    private_key=keypair['private_key'])\n  File \"tempest/scenario/manager.py\", line 622, in create_timestamp\n    private_key=private_key)\n  File \"tempest/scenario/manager.py\", line 377, in get_remote_client\n    linux_client.validate_authentication()\n  File \"tempest/common/utils/linux/remote_client.py\", line 51, in validate_authentication\n    self.ssh_client.test_connection_auth()\n  File \"/opt/stack/new/tempest/.tox/full/local/lib/python2.7/site-packages/tempest_lib/common/ssh.py\", line 173, in test_connection_auth\n    connection = self._get_ssh_connection()\n  File \"/opt/stack/new/tempest/.tox/full/local/lib/python2.7/site-packages/tempest_lib/common/ssh.py\", line 88, in _get_ssh_connection\n    password=self.password)\ntempest_lib.exceptions.SSHTimeout: Connection to the 172.24.5.10 via SSH timed out.\nUser: cirros, Password: None\n", 
            "date_created": "2016-02-22 17:03:15.699510+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "picking up tempest.scenario.test_volume_boot_pattern.TestVolumeBootPattern.test_volume_boot_pattern here:\n\ndate: 2016-02-21 16:55:35.858\nserver-id: d8bc1ba6-1b57-41c3-bf8b-8c4981f0c6fd\nip-address: 172.24.5.9\n\nconfirmed the ip-address is allocated to the server:\n2016-02-21 16:52:10,047 18343 INFO     [tempest_lib.common.rest_client] Request (TestVolumeBootPattern:test_volume_boot_pattern): 202 POST http://127.0.0.1:8774/v2.1/b18fde6446224a348fb327cccbc0bc30/servers/d8bc1ba6-1b57-41c3-bf8b-8c4981f0c6fd/action 0.945s\n2016-02-21 16:52:10,048 18343 DEBUG    [tempest_lib.common.rest_client] Request - Headers: {'Accept': 'application/json', 'X-Auth-Token': '<omitted>', 'Content-Type': 'application/json'}\n        Body: {\"addFloatingIp\": {\"address\": \"172.24.5.9\"}}\n\nBefore the timeout, the following message is output several times:\n2016-02-21 16:55:35.857 18343 ERROR tempest_lib.common.ssh Traceback (most recent call last):\n2016-02-21 16:55:35.857 18343 ERROR tempest_lib.common.ssh   File \"/opt/stack/new/tempest/.tox/full/local/lib/python2.7/site-packages/tempest_lib/common/ssh.py\", line 75, in _get_ssh_connection\n2016-02-21 16:55:35.857 18343 ERROR tempest_lib.common.ssh     timeout=self.channel_timeout, pkey=self.pkey)\n2016-02-21 16:55:35.857 18343 ERROR tempest_lib.common.ssh   File \"/opt/stack/new/tempest/.tox/full/local/lib/python2.7/site-packages/paramiko/client.py\", line 325, in connect\n2016-02-21 16:55:35.857 18343 ERROR tempest_lib.common.ssh     t.start_client()\n2016-02-21 16:55:35.857 18343 ERROR tempest_lib.common.ssh   File \"/opt/stack/new/tempest/.tox/full/local/lib/python2.7/site-packages/paramiko/transport.py\", line 492, in start_client\n2016-02-21 16:55:35.857 18343 ERROR tempest_lib.common.ssh     raise e\n2016-02-21 16:55:35.857 18343 ERROR tempest_lib.common.ssh SSHException: Error reading SSH protocol banner\n2016-02-21 16:55:35.857 18343 ERROR tempest_lib.common.ssh \n2016-02-21 16:55:35,858 18343 ERROR    [tempest.scenario.manager] (TestVolumeBootPattern:test_volume_boot_pattern) Initializing SSH connection to 172.24.5.9 failed. Error: Connection to the 172.24.5.9 via SSH timed out.\nUser: cirros, Password: None\n", 
            "date_created": "2016-02-22 17:16:04.619321+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "2016-02-21 16:54:40,286 18343\n\nERROR    [paramiko.transport] Exception: Error reading SSH protocol banner[Errno 104] Connection reset by peer\nERROR    [paramiko.transport] Traceback (most recent call last):\nERROR    [paramiko.transport]   File \"/opt/stack/new/tempest/.tox/full/local/lib/python2.7/site-packages/paramiko/transport.py\", line 1710, in run\nERROR    [paramiko.transport]     self._check_banner()\nERROR    [paramiko.transport]   File \"/opt/stack/new/tempest/.tox/full/local/lib/python2.7/site-packages/paramiko/transport.py\", line 1858, in _check_banner\nERROR    [paramiko.transport]     raise SSHException('Error reading SSH protocol banner' + str(e))\nERROR    [paramiko.transport] SSHException: Error reading SSH protocol banner[Errno 104] Connection reset by peer\nERROR    [paramiko.transport]\nWARNING  [tempest_lib.common.ssh] Failed to establish authenticated ssh connection to cirros@172.24.5.9 (Error reading SSH protocol banner[Errno 104] Connection reset by peer). Number attempts: 16. Retry after 17 seconds.\n\nparamiko/transport.py\n 1844     def _check_banner(self):\n 1845         # this is slow, but we only have to do it once\n 1846         for i in range(100):\n 1847             # give them 15 seconds for the first line, then just 2 seconds\n 1848             # each additional line.  (some sites have very high latency.)\n 1849             if i == 0:\n 1850                 timeout = self.banner_timeout\n 1851             else:\n 1852                 timeout = 2\n 1853             try:\n 1854                 buf = self.packetizer.readline(timeout)\n 1855             except ProxyCommandFailure:\n 1856                 raise\n 1857             except Exception as e:\n 1858                 raise SSHException('Error reading SSH protocol banner' + str(e))\n\nThe original exception is [Errno 104] Connection reset by peer.", 
            "date_created": "2016-02-22 18:56:22.897899+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "screen-c-api.txt.gz when booting from volume:\n\n2016-02-21 16:52:01.832 INFO cinder.api.openstack.wsgi [req-1c9f1cd4-022c-4a8d-9\nb15-2cc092eb9522 tempest-TestVolumeBootPattern-258726986] POST http://127.0.0.1:\n8776/v2/b18fde6446224a348fb327cccbc0bc30/volumes/9bed7b85-4472-44cd-9a5b-375010a\n5363a/action\n2016-02-21 16:52:01.832 DEBUG cinder.api.openstack.wsgi [req-1c9f1cd4-022c-4a8d-9b15-2cc092eb9522 tempest-TestVolumeBootPattern-258726986] Action body: {\"os-attach\": {\"instance_uuid\": \"d8bc1ba6-1b57-41c3-bf8b-8c4981f0c6fd\", \"mountpoint\": \"/dev/vda\", \"mode\": \"rw\"}} get_method /opt/stack/new/cinder/cinder/api/openstack/wsgi.py:1093\n2016-02-21 16:52:01.958 DEBUG object [req-1c9f1cd4-022c-4a8d-9b15-2cc092eb9522 tempest-TestVolumeBootPattern-258726986] Cinder object Volume has no attribute named: type get /opt/stack/new/cinder/cinder/objects/base.py:327\n[..]\n2016-02-21 16:52:03.108 INFO eventlet.wsgi.server [req-1c9f1cd4-022c-4a8d-9b15-2cc092eb9522 tempest-TestVolumeBootPattern-258726986] 127.0.0.1 \"POST /v2/b18fde6446224a348fb327cccbc0bc30/volumes/9bed7b85-4472-44cd-9a5b-375010a5363a/action HTTP/1.1\" status: 202  len: 211 time: 1.2800739", 
            "date_created": "2016-02-23 14:49:29.463808+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "The volume: 9bed7b85-4472-44cd-9a5b-375010a5363a\nThe server: d8bc1ba6-1b57-41c3-bf8b-8c4981f0c6fd\nThe network: 3acd1838-7435-48bb-bc86-2da830b5a1c4\nThe target address: 172.24.5.9 (Floating ip)\n\n16:51:57.655: (nova-api) Received the request of boot from volume.\n16:51:58.615: (nova-api) Succeeded to boot from volume.\n16:52:03.108: (cinder-api) Succeeded to attach the volume to the server.\n16:52:10.050: (nova-api) Succeeded to add the target floating-ip address to the server.\n16:52:13.046: (tempest) First failed to establish authenticated ssh connection.\n16:55:35.858: (tempest) tempest.scenario.test_volume_boot_pattern.TestVolumeBootPattern.test_volume_boot_pattern failed.", 
            "date_created": "2016-02-23 15:17:32.349171+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "The volume: 9bed7b85-4472-44cd-9a5b-375010a5363a\nThe server: d8bc1ba6-1b57-41c3-bf8b-8c4981f0c6fd\nThe network: 3acd1838-7435-48bb-bc86-2da830b5a1c4\nThe fixed-ip: 10.1.0.9\nThe target address: 172.24.5.9 (Floating ip)\n\n16:51:57.655: (nova-api) Received the request of boot from volume.\n16:51:58.615: (nova-api) Succeeded to boot from volume.\n16:52:00.618: (nova-net) Allocated fixed IP to the server.\n16:52:03.108: (cinder-api) Succeeded to attach the volume to the server.\n16:52:10.050: (nova-api) Succeeded to add the target floating-ip address to the server.\n16:52:13.046: (tempest) First failed to establish authenticated ssh connection.\n16:55:35.858: (tempest) tempest.scenario.test_volume_boot_pattern.TestVolumeBootPattern.test_volume_boot_pattern failed.\n\nThe console log contains the following:\n\ncirros-ds 'local' up at 8.49\nno results found for mode=local. up 8.95. searched: nocloud configdrive ec2\nStarting network...\nudhcpc (v1.20.1) started\nSending discover...\nSending select for 10.1.0.9...\nLease of 10.1.0.9 obtained, lease time 86400\ncirros-ds 'net' up at 10.49\nchecking http://169.254.169.254/2009-04-04/instance-id\nfailed 1/20: up 10.82. request failed\nfailed 2/20: up 13.55. request failed\nfailed 3/20: up 15.76. request failed\nfailed 4/20: up 18.08. request failed\nfailed 5/20: up 20.29. request failed\nfailed 6/20: up 22.75. request failed\nfailed 7/20: up 24.95. request failed\nfailed 8/20: up 27.13. request failed\nfailed 9/20: up 29.56. request failed\nfailed 10/20: up 31.78. request failed\nfailed 11/20: up 33.95. request failed\nfailed 12/20: up 36.13. request failed\nfailed 13/20: up 38.52. request failed\nfailed 14/20: up 40.93. request failed\nfailed 15/20: up 43.13. request failed\nfailed 16/20: up 45.41. request failed\nfailed 17/20: up 47.79. request failed\nfailed 18/20: up 49.98. request failed\nfailed 19/20: up 52.17. request failed\nfailed 20/20: up 54.41. request failed\nfailed to read iid from metadata. tried 20\nno results found for mode=net. up 56.82. searched: nocloud configdrive ec2\nfailed to get instance-id of datasource\nStarting dropbear sshd: generating rsa key... generating dsa key... OK\n=== system information ===\nPlatform: OpenStack Foundation OpenStack Nova\n\nThe difference between normal ops and this problem ops is:\n\n---------------------\n$ diff -u normal.txt problem.txt\n--- normal.txt  2016-02-23 09:22:14.920761998 -0800\n+++ problem.txt        2016-02-23 09:22:46.568761998 -0800\n@@ -1,11 +1,35 @@\n-cirros-ds 'local' up at 9.56\n-found datasource (configdrive, local)\n+cirros-ds 'local' up at 8.49\n+no results found for mode=local. up 8.95. searched: nocloud configdrive ec2\n Starting network...\n udhcpc (v1.20.1) started\n Sending discover...\n-Sending select for 10.1.8.4...\n-Lease of 10.1.8.4 obtained, lease time 86400\n+Sending select for 10.1.0.9...\n+Lease of 10.1.0.9 obtained, lease time 86400\n+cirros-ds 'net' up at 10.49\n+checking http://169.254.169.254/2009-04-04/instance-id\n+failed 1/20: up 10.82. request failed\n+failed 2/20: up 13.55. request failed\n+failed 3/20: up 15.76. request failed\n+failed 4/20: up 18.08. request failed\n+failed 5/20: up 20.29. request failed\n+failed 6/20: up 22.75. request failed\n+failed 7/20: up 24.95. request failed\n+failed 8/20: up 27.13. request failed\n+failed 9/20: up 29.56. request failed\n+failed 10/20: up 31.78. request failed\n+failed 11/20: up 33.95. request failed\n+failed 12/20: up 36.13. request failed\n+failed 13/20: up 38.52. request failed\n+failed 14/20: up 40.93. request failed\n+failed 15/20: up 43.13. request failed\n+failed 16/20: up 45.41. request failed\n+failed 17/20: up 47.79. request failed\n+failed 18/20: up 49.98. request failed\n+failed 19/20: up 52.17. request failed\n+failed 20/20: up 54.41. request failed\n+failed to read iid from metadata. tried 20\n+no results found for mode=net. up 56.82. searched: nocloud configdrive ec2\n+failed to get instance-id of datasource\n Starting dropbear sshd: generating rsa key... generating dsa key... OK\n-no userdata for datasource\n === system information ===\n Platform: OpenStack Foundation OpenStack Nova", 
            "date_created": "2016-02-23 19:01:11.685593+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }
    ]
}