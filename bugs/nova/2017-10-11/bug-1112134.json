{
    "status": "Fix Released", 
    "last_updated": "2013-04-04 11:11:32.647500+00:00", 
    "description": "If specifying some binary files as injected_files by \"nova boot --file\",\nthe command fails like the following:\n\n$ ls -lh memo.tar.gz\n-rw-rw-r-- 1 oomichi oomichi 191 Feb  1 13:37 memo.tar.gz\n$\n$ nova --debug boot --flavor 1 --image cirros-0.3.0-x86_64-uec --file /memo.tar.gz=./memo.tar.gz test01\n[..]\n2013-02-01T13:41:51.809733   POST   http://192.168.0.30:8774/v2/95cbfd9b7453468b90c4738abb910113/servers\nRESP: [400] {'date': 'Fri, 01 Feb 2013 04:41:52 GMT', 'content-length': '127', 'content-type': 'application/json; charset=UTF-8', 'x-compute-request-id': 'req-a12aec93-401c-4dbe-9c9e-535220a2b35b'}\nRESP BODY: {\"badRequest\": {\"message\": \"UnicodeError: 'utf8' codec can't decode byte 0x8b in position 1: invalid start byte\", \"code\": 400}}\n\nDEBUG (shell:578) UnicodeError: 'utf8' codec can't decode byte 0x8b in position 1: invalid start byte (HTTP 400) (Request-ID: req-a12aec93-401c-4dbe-9c9e-535220a2b35b)\nTraceback (most recent call last):\n  File \"/opt/stack/python-novaclient/novaclient/shell.py\", line 575, in main\n    OpenStackComputeShell().main(sys.argv[1:])\n  File \"/opt/stack/python-novaclient/novaclient/shell.py\", line 511, in main\n    args.func(self.cs, args)\n  File \"/opt/stack/python-novaclient/novaclient/v1_1/shell.py\", line 279, in do_boot\n    server = cs.servers.create(*boot_args, **boot_kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/v1_1/servers.py\", line 585, in create\n    **boot_kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/v1_1/base.py\", line 162, in _boot\n    return_raw=return_raw, **kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/base.py\", line 145, in _create\n    _resp, body = self.api.client.post(url, body=body)\n  File \"/opt/stack/python-novaclient/novaclient/client.py\", line 241, in post\n    return self._cs_request(url, 'POST', **kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/client.py\", line 225, in _cs_request\n    **kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/client.py\", line 207, in _time_request\n    resp, body = self.request(url, method, **kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/client.py\", line 201, in request\n    raise exceptions.from_response(resp, body, url, method)\nBadRequest: UnicodeError: 'utf8' codec can't decode byte 0x8b in position 1: invalid start byte (HTTP 400) (Request-ID: req-a12aec93-401c-4dbe-9c9e-535220a2b35b)\nERROR: UnicodeError: 'utf8' codec can't decode byte 0x8b in position 1: invalid start byte (HTTP 400) (Request-ID: req-a12aec93-401c-4dbe-9c9e-535220a2b35b)\n$\n\nAppendix:\nThe above example is operated by a small binary file.\nIf you need to specify a big file, the following settings are necessary:\n\n-- nova.conf --\nosapi_max_request_body_size=<bytes>\nquota_injected_file_content_bytes=<bytes>", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1112134", 
    "owner": "https://api.launchpad.net/1.0/~oomichi", 
    "id": 1112134, 
    "index": 3367, 
    "created": "2013-02-01 05:13:36.721075+00:00", 
    "title": "Cannot specify binary files as injected_files by 'nova boot --file'.", 
    "comments": [
        {
            "content": "If specifying some binary files as injected_files by \"nova boot --file\",\nthe command fails like the following:\n\n$ ls -lh memo.tar.gz\n-rw-rw-r-- 1 oomichi oomichi 191 Feb  1 13:37 memo.tar.gz\n$\n$ nova --debug boot --flavor 1 --image cirros-0.3.0-x86_64-uec --file /memo.tar.gz=./memo.tar.gz test01\n[..]\n2013-02-01T13:41:51.809733   POST   http://192.168.0.30:8774/v2/95cbfd9b7453468b90c4738abb910113/servers\nRESP: [400] {'date': 'Fri, 01 Feb 2013 04:41:52 GMT', 'content-length': '127', 'content-type': 'application/json; charset=UTF-8', 'x-compute-request-id': 'req-a12aec93-401c-4dbe-9c9e-535220a2b35b'}\nRESP BODY: {\"badRequest\": {\"message\": \"UnicodeError: 'utf8' codec can't decode byte 0x8b in position 1: invalid start byte\", \"code\": 400}}\n\nDEBUG (shell:578) UnicodeError: 'utf8' codec can't decode byte 0x8b in position 1: invalid start byte (HTTP 400) (Request-ID: req-a12aec93-401c-4dbe-9c9e-535220a2b35b)\nTraceback (most recent call last):\n  File \"/opt/stack/python-novaclient/novaclient/shell.py\", line 575, in main\n    OpenStackComputeShell().main(sys.argv[1:])\n  File \"/opt/stack/python-novaclient/novaclient/shell.py\", line 511, in main\n    args.func(self.cs, args)\n  File \"/opt/stack/python-novaclient/novaclient/v1_1/shell.py\", line 279, in do_boot\n    server = cs.servers.create(*boot_args, **boot_kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/v1_1/servers.py\", line 585, in create\n    **boot_kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/v1_1/base.py\", line 162, in _boot\n    return_raw=return_raw, **kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/base.py\", line 145, in _create\n    _resp, body = self.api.client.post(url, body=body)\n  File \"/opt/stack/python-novaclient/novaclient/client.py\", line 241, in post\n    return self._cs_request(url, 'POST', **kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/client.py\", line 225, in _cs_request\n    **kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/client.py\", line 207, in _time_request\n    resp, body = self.request(url, method, **kwargs)\n  File \"/opt/stack/python-novaclient/novaclient/client.py\", line 201, in request\n    raise exceptions.from_response(resp, body, url, method)\nBadRequest: UnicodeError: 'utf8' codec can't decode byte 0x8b in position 1: invalid start byte (HTTP 400) (Request-ID: req-a12aec93-401c-4dbe-9c9e-535220a2b35b)\nERROR: UnicodeError: 'utf8' codec can't decode byte 0x8b in position 1: invalid start byte (HTTP 400) (Request-ID: req-a12aec93-401c-4dbe-9c9e-535220a2b35b)\n$\n\nAppendix:\nThe above example is operated by a small binary file.\nIf you need to specify a big file, the following settings are necessary:\n\n-- nova.conf --\nosapi_max_request_body_size=<bytes>\nquota_injected_file_content_bytes=<bytes>", 
            "date_created": "2013-02-01 05:13:36.721075+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/20977", 
            "date_created": "2013-02-01 05:33:46.720910+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/20977\nCommitted: http://github.com/openstack/nova/commit/77c30189abe53326d99241a465b702ad7eed6b03\nSubmitter: Jenkins\nBranch:    master\n\ncommit 77c30189abe53326d99241a465b702ad7eed6b03\nAuthor: Ken'ichi Ohmichi <email address hidden>\nDate:   Thu Jan 31 22:05:14 2013 +0900\n\n    Fix inject_files for storing binary file.\n    \n    Now a nova-api server decodes injected_files by base64 after receiving\n    encoded files from nova-client.\n    And the server fails to publish run_instance because utf8 codec can't\n    decode due to binary data.\n    \n    This patch fixes this problem, because the base64 decode is operated when\n    a nova-compute server receives injected_files from a nova-api server.\n    \n    Fixes bug 1112134\n    \n    Change-Id: I664134c74893a970de4464161071692a5b2b5ce7\n", 
            "date_created": "2013-02-07 19:33:34.623687+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}