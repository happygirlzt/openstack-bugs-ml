{
    "status": "Fix Released", 
    "last_updated": "2011-09-22 13:23:30.267886+00:00", 
    "description": "Using nova trunk bzr 1230 with Postgres.\n\nI'm getting the following stack trace in nova-network.log:\n\n2011-06-30 01:32:35,320 DEBUG nova.network.manager [4N9HZUFF8CZQ1-NYSQYN None None] Leasing IP 192.168.0.2 from (pid=15154) lease_fixed_ip /usr/lib/pymodules/python2.6/nova/network/manager.py:228\n2011-06-30 01:32:41,882 ERROR nova [-] in looping call\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/utils.py\", line 466, in _inner\n(nova): TRACE:     self.f(*self.args, **self.kw)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/service.py\", line 266, in periodic_tasks\n(nova): TRACE:     self.manager.periodic_tasks(context.get_admin_context())\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/network/manager.py\", line 156, in periodic_tasks\n(nova): TRACE:     time)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/api.py\", line 365, in fixed_ip_disassociate_all_by_timeout\n(nova): TRACE:     return IMPL.fixed_ip_disassociate_all_by_timeout(context, host, time)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/sqlalchemy/api.py\", line 97, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/sqlalchemy/api.py\", line 722, in fixed_ip_disassociate_all_by_timeout\n(nova): TRACE:     synchronize_session='fetch')\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/orm/query.py\", line 2156, in update\n(nova): TRACE:     params=self._params).fetchall()\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/orm/session.py\", line 735, in execute\n(nova): TRACE:     clause, params or {})\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1157, in execute\n(nova): TRACE:     params)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1237, in _execute_clauseelement\n(nova): TRACE:     return self.__execute_context(context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1268, in __execute_context\n(nova): TRACE:     context.parameters[0], context=context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1367, in _cursor_execute\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1360, in _cursor_execute\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/default.py\", line 288, in do_execute\n(nova): TRACE:     cursor.execute(statement, parameters)\n(nova): TRACE: ProgrammingError: (ProgrammingError) operator does not exist: boolean = integer\n(nova): TRACE: LINE 5: ...ixed_ips.instance_id IS NOT NULL AND fixed_ips.allocated = 0\n(nova): TRACE:                                                                     ^\n(nova): TRACE: HINT:  No operator matches the given name and argument type(s). You might need to add explicit type casts.\n(nova): TRACE:  'SELECT fixed_ips.id AS fixed_ips_id \\nFROM fixed_ips \\nWHERE fixed_ips.network_id IN (SELECT networks.id \\nFROM networks \\nWHERE networks.host = %(host_1)s) AND fixed_ips.updated_at < %(updated_at_1)s AND fixed_ips.instance_id IS NOT NULL AND fixed_ips.allocated = %(allocated_1)s' {'host_1': 'nova1', 'allocated_1': 0, 'updated_at_1': datetime.datetime(2011, 6, 30, 1, 22, 41, 856402)}\n(nova): TRACE: \n\n---\n\nNeed to fix the fixed_ip_disassociate_all_by_timeout in the DB api so that it supports Postgres (casting issues)", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/803716", 
    "owner": "https://api.launchpad.net/1.0/~dan-prince", 
    "id": 803716, 
    "index": 2443, 
    "created": "2011-06-30 02:08:14.263850+00:00", 
    "title": "fixed_ip_disassociate_timeout_pgsql casting errors w/ Postgres", 
    "comments": [
        {
            "content": "Using nova trunk bzr 1230 with Postgres.\n\nI'm getting the following stack trace in nova-network.log:\n\n2011-06-30 01:32:35,320 DEBUG nova.network.manager [4N9HZUFF8CZQ1-NYSQYN None None] Leasing IP 192.168.0.2 from (pid=15154) lease_fixed_ip /usr/lib/pymodules/python2.6/nova/network/manager.py:228\n2011-06-30 01:32:41,882 ERROR nova [-] in looping call\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/utils.py\", line 466, in _inner\n(nova): TRACE:     self.f(*self.args, **self.kw)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/service.py\", line 266, in periodic_tasks\n(nova): TRACE:     self.manager.periodic_tasks(context.get_admin_context())\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/network/manager.py\", line 156, in periodic_tasks\n(nova): TRACE:     time)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/api.py\", line 365, in fixed_ip_disassociate_all_by_timeout\n(nova): TRACE:     return IMPL.fixed_ip_disassociate_all_by_timeout(context, host, time)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/sqlalchemy/api.py\", line 97, in wrapper\n(nova): TRACE:     return f(*args, **kwargs)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/db/sqlalchemy/api.py\", line 722, in fixed_ip_disassociate_all_by_timeout\n(nova): TRACE:     synchronize_session='fetch')\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/orm/query.py\", line 2156, in update\n(nova): TRACE:     params=self._params).fetchall()\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/orm/session.py\", line 735, in execute\n(nova): TRACE:     clause, params or {})\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1157, in execute\n(nova): TRACE:     params)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1237, in _execute_clauseelement\n(nova): TRACE:     return self.__execute_context(context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1268, in __execute_context\n(nova): TRACE:     context.parameters[0], context=context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1367, in _cursor_execute\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1360, in _cursor_execute\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/default.py\", line 288, in do_execute\n(nova): TRACE:     cursor.execute(statement, parameters)\n(nova): TRACE: ProgrammingError: (ProgrammingError) operator does not exist: boolean = integer\n(nova): TRACE: LINE 5: ...ixed_ips.instance_id IS NOT NULL AND fixed_ips.allocated = 0\n(nova): TRACE:                                                                     ^\n(nova): TRACE: HINT:  No operator matches the given name and argument type(s). You might need to add explicit type casts.\n(nova): TRACE:  'SELECT fixed_ips.id AS fixed_ips_id \\nFROM fixed_ips \\nWHERE fixed_ips.network_id IN (SELECT networks.id \\nFROM networks \\nWHERE networks.host = %(host_1)s) AND fixed_ips.updated_at < %(updated_at_1)s AND fixed_ips.instance_id IS NOT NULL AND fixed_ips.allocated = %(allocated_1)s' {'host_1': 'nova1', 'allocated_1': 0, 'updated_at_1': datetime.datetime(2011, 6, 30, 1, 22, 41, 856402)}\n(nova): TRACE: \n\n---\n\nNeed to fix the fixed_ip_disassociate_all_by_timeout in the DB api so that it supports Postgres (casting issues)", 
            "date_created": "2011-06-30 02:08:14.263850+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }
    ]
}