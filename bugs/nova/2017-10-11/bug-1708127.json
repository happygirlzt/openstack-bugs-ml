{
    "status": "Invalid", 
    "last_updated": "2017-08-02 10:18:18.082357+00:00", 
    "description": "Description\n===========\nHopefully this bug was not already raised.\nI'm new to openstack so it could come from a faulty installation.\nI followed the guide https://docs.openstack.org/ocata/install-guide-rdo for an installation of ocata openstack over centos 7.\nDuring the step https://docs.openstack.org/ocata/install-guide-rdo/launch-instance-provider.html\nthe instance creation on the compute seems ok (I can even ping the instance from the qrouter on the controller), but then the command \"openstack server list\" crashes and asked to report the bug.\n\n\nSteps to reproduce\n==================\nA chronological list of steps which will bring off the\nissue you noticed:\n* I installed 2 VMs Centos 7 (CentOS Linux release 7.3.1611 (Core)) over ESXI\n* Then I followed the https://docs.openstack.org/ocata/install-guide-rdo guide (identity, image, compute, networking, dashboard). \n* at the first instance creation I saw one openstack command crashes and asked to report the bug\n\"openstack server creation\" is ok\n\"openstack server list\" crashed\n\"openstack server show xxx\" is ok\n\n[root@controller manuopenstack]# openstack server create --flavor m1.nano --image cirros \\\n>   --nic net-id=90266090-8fa8-429a-903b-1dea2eb84c60 --security-group default \\\n>   --key-name mykey provider-instance\n+-----------------------------+-----------------------------------------------+\n| Field                       | Value                                         |\n+-----------------------------+-----------------------------------------------+\n| OS-DCF:diskConfig           | MANUAL                                        |\n| OS-EXT-AZ:availability_zone |                                               |\n| OS-EXT-STS:power_state      | NOSTATE                                       |\n| OS-EXT-STS:task_state       | scheduling                                    |\n| OS-EXT-STS:vm_state         | building                                      |\n| OS-SRV-USG:launched_at      | None                                          |\n| OS-SRV-USG:terminated_at    | None                                          |\n| accessIPv4                  |                                               |\n| accessIPv6                  |                                               |\n| addresses                   |                                               |\n| adminPass                   | 87nquA2JpyH5                                  |\n| config_drive                |                                               |\n| created                     | 2017-08-02T08:25:15Z                          |\n| flavor                      | m1.nano (0)                                   |\n| hostId                      |                                               |\n| id                          | 5c6b2f56-e0d3-4e22-a2ab-95b08128d921          |\n| image                       | cirros (df2980b7-4d72-45c8-8023-665c2bd1c296) |\n| key_name                    | mykey                                         |\n| name                        | provider-instance                             |\n| progress                    | 0                                             |\n| project_id                  | fed6a774e6024de393e858d26e97a1fa              |\n| properties                  |                                               |\n| security_groups             | name='default'                                |\n| status                      | BUILD                                         |\n| updated                     | 2017-08-02T08:25:15Z                          |\n| user_id                     | 918b69a9e68341b382b1ddf5b697add2              |\n| volumes_attached            |                                               |\n+-----------------------------+-----------------------------------------------+\n[root@controller manuopenstack]# openstack server list\nUnexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'sqlalchemy.exc.ProgrammingError'> (HTTP 500) (Request-ID: req-1e2840dc-84a6-4f76-94df-67fa9a684f69)\n[root@controller manuopenstack]# openstack server list\nUnexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'sqlalchemy.exc.ProgrammingError'> (HTTP 500) (Request-ID: req-b88a9d59-b7c3-4b2c-8250-12698e073c2c)\n[root@controller manuopenstack]# openstack server show 5c6b2f56-e0d3-4e22-a2ab-95b08128d921\n+-----------------------------+----------------------------------------------------------+\n| Field                       | Value                                                    |\n+-----------------------------+----------------------------------------------------------+\n| OS-DCF:diskConfig           | MANUAL                                                   |\n| OS-EXT-AZ:availability_zone | nova                                                     |\n| OS-EXT-STS:power_state      | Running                                                  |\n| OS-EXT-STS:task_state       | None                                                     |\n| OS-EXT-STS:vm_state         | active                                                   |\n| OS-SRV-USG:launched_at      | 2017-08-02T08:25:26.000000                               |\n| OS-SRV-USG:terminated_at    | None                                                     |\n| accessIPv4                  |                                                          |\n| accessIPv6                  |                                                          |\n| addresses                   | provider=1.2.3.55                                        |\n| config_drive                |                                                          |\n| created                     | 2017-08-02T08:25:15Z                                     |\n| flavor                      | m1.nano (0)                                              |\n| hostId                      | 5c9b45f615a14582c799709e763d0fadc46cc26b55f38ef21874e56e |\n| id                          | 5c6b2f56-e0d3-4e22-a2ab-95b08128d921                     |\n| image                       | cirros (df2980b7-4d72-45c8-8023-665c2bd1c296)            |\n| key_name                    | mykey                                                    |\n| name                        | provider-instance                                        |\n| progress                    | 0                                                        |\n| project_id                  | fed6a774e6024de393e858d26e97a1fa                         |\n| properties                  |                                                          |\n| security_groups             | name='default'                                           |\n| status                      | ACTIVE                                                   |\n| updated                     | 2017-08-02T08:25:26Z                                     |\n| user_id                     | 918b69a9e68341b382b1ddf5b697add2                         |\n| volumes_attached            |                                                          |\n+-----------------------------+----------------------------------------------------------+\n\n\nExpected result\n===============\nthe list of the instances should be seen\n\nActual result\n=============\nmessage that it crashed, and to report the bug\n\nEnvironment\n===========\n1. Exact version of OpenStack you are running. See the following\n  list for all releases: http://docs.openstack.org/releases/\n\n[root@controller log]# nova-manage --version\n15.0.4\nYou have new mail in /var/spool/mail/root\n[root@controller log]# keystone-manage --version\n11.0.1\n[root@controller log]# glance-manage --version\nOption \"verbose\" from group \"DEFAULT\" is deprecated for removal.  Its value may be silently ignored in the future.\n14.0.0\n[root@controller log]# neutron-server --version\nGuru meditation now registers SIGUSR1 and SIGUSR2 by default for backward compatibility. SIGUSR1 will no longer be registered in a future release, so please use SIGUSR2 to generate reports.\nOption \"verbose\" from group \"DEFAULT\" is deprecated for removal.  Its value may be silently ignored in the future.\nneutron-server 10.0.1\n\n\n[root@controller manuopenstack]# yum list installed | grep nova\nopenstack-nova-api.noarch              1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-common.noarch           1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-conductor.noarch        1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-console.noarch          1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-novncproxy.noarch       1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-placement-api.noarch    1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-scheduler.noarch        1:15.0.4-1.el7           @openstack-ocata\npython-nova.noarch                     1:15.0.4-1.el7           @openstack-ocata\npython2-novaclient.noarch              1:7.1.1-1.el7            @openstack-ocata\n\n\n\n2. Which hypervisor did you use?\n   (For example: Libvirt + KVM, Libvirt + XEN, Hyper-V, PowerKVM, ...)\n   What's the version of that?\n[root@controller manuopenstack]# virsh version\nCompiled against library: libvirt 2.0.0\nUsing library: libvirt 2.0.0\nUsing API: QEMU 2.0.0\nRunning hypervisor: QEMU 2.6.0\n\n(CentOS VMs over ESXI 5.5): this is for a training.\n\n2. Which storage type did you use?\n   (For example: Ceph, LVM, GPFS, ...)\n   What's the version of that?\n\nJust the local file system as per https://docs.openstack.org/mitaka/install-guide-rdo/glance-install.html\n\n3. Which networking type did you use?\n   (For example: nova-network, Neutron with OpenVSwitch, ...)\n\nNeutron with linuxbridge as per https://docs.openstack.org/mitaka/install-guide-rdo/neutron-controller-install.html\n\n\nLogs & Configs\n==============\nNova API log attached", 
    "tags": [
        "cells"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1708127", 
    "owner": "None", 
    "id": 1708127, 
    "index": 6968, 
    "created": "2017-08-02 09:30:21.565750+00:00", 
    "title": "openstack server list command crashes", 
    "comments": [
        {
            "content": "Description\n===========\nHopefully this bug was not already raised.\nI'm new to openstack so it could come from a faulty installation.\nI followed the guide https://docs.openstack.org/ocata/install-guide-rdo for an installation of ocata openstack over centos 7.\nDuring the step https://docs.openstack.org/ocata/install-guide-rdo/launch-instance-provider.html\nthe instance creation on the compute seems ok (I can even ping the instance from the qrouter on the controller), but then the command \"openstack server list\" crashes and asked to report the bug.\n\n\nSteps to reproduce\n==================\nA chronological list of steps which will bring off the\nissue you noticed:\n* I installed 2 VMs Centos 7 (CentOS Linux release 7.3.1611 (Core)) over ESXI\n* Then I followed the https://docs.openstack.org/ocata/install-guide-rdo guide (identity, image, compute, networking, dashboard). \n* at the first instance creation I saw one openstack command crashes and asked to report the bug\n\"openstack server creation\" is ok\n\"openstack server list\" crashed\n\"openstack server show xxx\" is ok\n\n[root@controller manuopenstack]# openstack server create --flavor m1.nano --image cirros \\\n>   --nic net-id=90266090-8fa8-429a-903b-1dea2eb84c60 --security-group default \\\n>   --key-name mykey provider-instance\n+-----------------------------+-----------------------------------------------+\n| Field                       | Value                                         |\n+-----------------------------+-----------------------------------------------+\n| OS-DCF:diskConfig           | MANUAL                                        |\n| OS-EXT-AZ:availability_zone |                                               |\n| OS-EXT-STS:power_state      | NOSTATE                                       |\n| OS-EXT-STS:task_state       | scheduling                                    |\n| OS-EXT-STS:vm_state         | building                                      |\n| OS-SRV-USG:launched_at      | None                                          |\n| OS-SRV-USG:terminated_at    | None                                          |\n| accessIPv4                  |                                               |\n| accessIPv6                  |                                               |\n| addresses                   |                                               |\n| adminPass                   | 87nquA2JpyH5                                  |\n| config_drive                |                                               |\n| created                     | 2017-08-02T08:25:15Z                          |\n| flavor                      | m1.nano (0)                                   |\n| hostId                      |                                               |\n| id                          | 5c6b2f56-e0d3-4e22-a2ab-95b08128d921          |\n| image                       | cirros (df2980b7-4d72-45c8-8023-665c2bd1c296) |\n| key_name                    | mykey                                         |\n| name                        | provider-instance                             |\n| progress                    | 0                                             |\n| project_id                  | fed6a774e6024de393e858d26e97a1fa              |\n| properties                  |                                               |\n| security_groups             | name='default'                                |\n| status                      | BUILD                                         |\n| updated                     | 2017-08-02T08:25:15Z                          |\n| user_id                     | 918b69a9e68341b382b1ddf5b697add2              |\n| volumes_attached            |                                               |\n+-----------------------------+-----------------------------------------------+\n[root@controller manuopenstack]# openstack server list\nUnexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'sqlalchemy.exc.ProgrammingError'> (HTTP 500) (Request-ID: req-1e2840dc-84a6-4f76-94df-67fa9a684f69)\n[root@controller manuopenstack]# openstack server list\nUnexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'sqlalchemy.exc.ProgrammingError'> (HTTP 500) (Request-ID: req-b88a9d59-b7c3-4b2c-8250-12698e073c2c)\n[root@controller manuopenstack]# openstack server show 5c6b2f56-e0d3-4e22-a2ab-95b08128d921\n+-----------------------------+----------------------------------------------------------+\n| Field                       | Value                                                    |\n+-----------------------------+----------------------------------------------------------+\n| OS-DCF:diskConfig           | MANUAL                                                   |\n| OS-EXT-AZ:availability_zone | nova                                                     |\n| OS-EXT-STS:power_state      | Running                                                  |\n| OS-EXT-STS:task_state       | None                                                     |\n| OS-EXT-STS:vm_state         | active                                                   |\n| OS-SRV-USG:launched_at      | 2017-08-02T08:25:26.000000                               |\n| OS-SRV-USG:terminated_at    | None                                                     |\n| accessIPv4                  |                                                          |\n| accessIPv6                  |                                                          |\n| addresses                   | provider=1.2.3.55                                        |\n| config_drive                |                                                          |\n| created                     | 2017-08-02T08:25:15Z                                     |\n| flavor                      | m1.nano (0)                                              |\n| hostId                      | 5c9b45f615a14582c799709e763d0fadc46cc26b55f38ef21874e56e |\n| id                          | 5c6b2f56-e0d3-4e22-a2ab-95b08128d921                     |\n| image                       | cirros (df2980b7-4d72-45c8-8023-665c2bd1c296)            |\n| key_name                    | mykey                                                    |\n| name                        | provider-instance                                        |\n| progress                    | 0                                                        |\n| project_id                  | fed6a774e6024de393e858d26e97a1fa                         |\n| properties                  |                                                          |\n| security_groups             | name='default'                                           |\n| status                      | ACTIVE                                                   |\n| updated                     | 2017-08-02T08:25:26Z                                     |\n| user_id                     | 918b69a9e68341b382b1ddf5b697add2                         |\n| volumes_attached            |                                                          |\n+-----------------------------+----------------------------------------------------------+\n\n\nExpected result\n===============\nthe list of the instances should be seen\n\nActual result\n=============\nmessage that it crashed, and to report the bug\n\nEnvironment\n===========\n1. Exact version of OpenStack you are running. See the following\n  list for all releases: http://docs.openstack.org/releases/\n\n[root@controller log]# nova-manage --version\n15.0.4\nYou have new mail in /var/spool/mail/root\n[root@controller log]# keystone-manage --version\n11.0.1\n[root@controller log]# glance-manage --version\nOption \"verbose\" from group \"DEFAULT\" is deprecated for removal.  Its value may be silently ignored in the future.\n14.0.0\n[root@controller log]# neutron-server --version\nGuru meditation now registers SIGUSR1 and SIGUSR2 by default for backward compatibility. SIGUSR1 will no longer be registered in a future release, so please use SIGUSR2 to generate reports.\nOption \"verbose\" from group \"DEFAULT\" is deprecated for removal.  Its value may be silently ignored in the future.\nneutron-server 10.0.1\n\n\n[root@controller manuopenstack]# yum list installed | grep nova\nopenstack-nova-api.noarch              1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-common.noarch           1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-conductor.noarch        1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-console.noarch          1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-novncproxy.noarch       1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-placement-api.noarch    1:15.0.4-1.el7           @openstack-ocata\nopenstack-nova-scheduler.noarch        1:15.0.4-1.el7           @openstack-ocata\npython-nova.noarch                     1:15.0.4-1.el7           @openstack-ocata\npython2-novaclient.noarch              1:7.1.1-1.el7            @openstack-ocata\n\n\n\n2. Which hypervisor did you use?\n   (For example: Libvirt + KVM, Libvirt + XEN, Hyper-V, PowerKVM, ...)\n   What's the version of that?\n[root@controller manuopenstack]# virsh version\nCompiled against library: libvirt 2.0.0\nUsing library: libvirt 2.0.0\nUsing API: QEMU 2.0.0\nRunning hypervisor: QEMU 2.6.0\n\n(CentOS VMs over ESXI 5.5): this is for a training.\n\n2. Which storage type did you use?\n   (For example: Ceph, LVM, GPFS, ...)\n   What's the version of that?\n\nJust the local file system as per https://docs.openstack.org/mitaka/install-guide-rdo/glance-install.html\n\n3. Which networking type did you use?\n   (For example: nova-network, Neutron with OpenVSwitch, ...)\n\nNeutron with linuxbridge as per https://docs.openstack.org/mitaka/install-guide-rdo/neutron-controller-install.html\n\n\nLogs & Configs\n==============\nNova API log attached", 
            "date_created": "2017-08-02 09:30:21.565750+00:00", 
            "author": "https://api.launchpad.net/1.0/~manug"
        }, 
        {
            "content": "", 
            "date_created": "2017-08-02 09:35:20.234311+00:00", 
            "author": "https://api.launchpad.net/1.0/~manug"
        }, 
        {
            "content": "The log says :\n\nProgrammingError: (pymysql.err.ProgrammingError) (1146, u\"Table 'nova_cell0.instances' doesn't exist\") \n\nAre you sure you actually followed the instructions accordingly ? https://docs.openstack.org/nova/latest/user/cells.html#fresh-install\n\n", 
            "date_created": "2017-08-02 09:58:09.898630+00:00", 
            "author": "https://api.launchpad.net/1.0/~sylvain-bauza"
        }, 
        {
            "content": "Looks to me you need to both do :\n- nova-manage cell_v2 map_cell0\n- nova-manage db sync\n\nbecause the instances table of the cell0 database is not populated correctly as per the logs.", 
            "date_created": "2017-08-02 10:00:38.531470+00:00", 
            "author": "https://api.launchpad.net/1.0/~sylvain-bauza"
        }, 
        {
            "content": "please ensure your steps. May be you can even check in ask.openstck.org", 
            "date_created": "2017-08-02 10:06:13.299826+00:00", 
            "author": "https://api.launchpad.net/1.0/~praveenn"
        }, 
        {
            "content": "Hello Sylvain and Praveen.\nYou're right it seems I missed some steps!\nAfter the 2 commands:\n- nova-manage cell_v2 map_cell0\n- nova-manage db sync\nthe openstack server list is ok\nThis can be closed.\nSorry for your time and have a good day.", 
            "date_created": "2017-08-02 10:18:17.557306+00:00", 
            "author": "https://api.launchpad.net/1.0/~manug"
        }
    ]
}