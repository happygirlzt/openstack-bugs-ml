{
    "status": "Fix Released", 
    "last_updated": "2014-04-17 15:11:26.951978+00:00", 
    "description": "Using the latest Nova Havana code I'm seeing the following errors from the nova-baremetal-deploy-helper log:\n\n2013-06-14 16:48:11,280.280 6570 INFO nova.virt.baremetal.deploy_helper [req-ba93e66c-c23b-42fb-8141-f56d8f0aa23f None None] start deployment for node 1, params {'swap_mb': 1, 'iqn': 'iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0', 'image_path': u'/var/lib/nova/instances/instance-00000002/disk', 'address': '192.0.2.69', 'pxe_config_path': u'/tftpboot/80c3956b-a696-4fa5-9d36-7b034d44b9b0/config', 'port': '3260', 'lun': '1', 'root_mb': 10240}\n2013-06-14 16:48:15,414.414 6570 ERROR nova.virt.baremetal.deploy_helper [req-ba93e66c-c23b-42fb-8141-f56d8f0aa23f None None] Cmd     : sudo nova-rootwrap /etc/nova/rootwrap.conf sfdisk -uM /dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1\n2013-06-14 16:48:15,415.415 6570 ERROR nova.virt.baremetal.deploy_helper [req-ba93e66c-c23b-42fb-8141-f56d8f0aa23f None None] StdOut  :\nDisk /dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1: 17849 cylinders, 255 heads, 63 sectors/track\nOld situation:\nUnits = mebibytes of 1048576 bytes, blocks of 1024 bytes, counting from 0\n\n   Device Boot Start   End    MiB    #blocks   Id  System\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part1         0+ 10244- 10245-  10490444+  83  Linux\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part2     10244+ 10252-     8-      8032+  82  Linux swap / Solaris\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part3         0      -      0          0    0  Empty\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part4         0      -      0          0    0  Empty\nNew situation:\nUnits = mebibytes of 1048576 bytes, blocks of 1024 bytes, counting from 0\n\n   Device Boot Start   End    MiB    #blocks   Id  System\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part1         0+ 10244- 10245-  10490444+  83  Linux\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part2     10244+ 10252-     8-      8032+  82  Linux swap / Solaris\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part3         0      -      0          0    0  Empty\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part4         0      -      0          0    0  Empty\nSuccessfully wrote the new partition table\n\n\nRe-reading the partition table ...\n\n2013-06-14 16:48:15,416.416 6570 ERROR nova.virt.baremetal.deploy_helper [req-ba93e66c-c23b-42fb-8141-f56d8f0aa23f None None] StdErr  : Checking that no-one is using this disk right now ...\nOK\nWarning: no primary partition is marked bootable (active)\nThis does not matter for LILO, but the DOS MBR will not boot this disk.\nBLKRRPART: Device or resource busy\nThe command to re-read the partition table failed.\nRun partprobe(8), kpartx(8) or reboot your system now,\nbefore using mkfs\nIf you created or changed a DOS partition, /dev/foo7, say, then use dd(1)\nto zero the first 512 bytes:  dd if=/dev/zero of=/dev/foo7 bs=512 count=1\n(See fdisk(8).)\n\n2013-06-14 16:48:16,115.115 6570 ERROR nova.virt.baremetal.deploy_helper [req-ba93e66c-c23b-42fb-8141-f56d8f0aa23f None None] deployment to node 1 failed\n\n---\n\nThis seems to occur about 1/3 of the time on our Dell R910's.", 
    "tags": [
        "baremetal"
    ], 
    "importance": "Undecided", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1191084", 
    "owner": "https://api.launchpad.net/1.0/~dan-prince", 
    "id": 1191084, 
    "index": 3752, 
    "created": "2013-06-14 18:14:05.956060+00:00", 
    "title": "baremetal fdisk failures", 
    "comments": [
        {
            "content": "Using the latest Nova Havana code I'm seeing the following errors from the nova-baremetal-deploy-helper log:\n\n2013-06-14 16:48:11,280.280 6570 INFO nova.virt.baremetal.deploy_helper [req-ba93e66c-c23b-42fb-8141-f56d8f0aa23f None None] start deployment for node 1, params {'swap_mb': 1, 'iqn': 'iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0', 'image_path': u'/var/lib/nova/instances/instance-00000002/disk', 'address': '192.0.2.69', 'pxe_config_path': u'/tftpboot/80c3956b-a696-4fa5-9d36-7b034d44b9b0/config', 'port': '3260', 'lun': '1', 'root_mb': 10240}\n2013-06-14 16:48:15,414.414 6570 ERROR nova.virt.baremetal.deploy_helper [req-ba93e66c-c23b-42fb-8141-f56d8f0aa23f None None] Cmd     : sudo nova-rootwrap /etc/nova/rootwrap.conf sfdisk -uM /dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1\n2013-06-14 16:48:15,415.415 6570 ERROR nova.virt.baremetal.deploy_helper [req-ba93e66c-c23b-42fb-8141-f56d8f0aa23f None None] StdOut  :\nDisk /dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1: 17849 cylinders, 255 heads, 63 sectors/track\nOld situation:\nUnits = mebibytes of 1048576 bytes, blocks of 1024 bytes, counting from 0\n\n   Device Boot Start   End    MiB    #blocks   Id  System\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part1         0+ 10244- 10245-  10490444+  83  Linux\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part2     10244+ 10252-     8-      8032+  82  Linux swap / Solaris\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part3         0      -      0          0    0  Empty\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part4         0      -      0          0    0  Empty\nNew situation:\nUnits = mebibytes of 1048576 bytes, blocks of 1024 bytes, counting from 0\n\n   Device Boot Start   End    MiB    #blocks   Id  System\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part1         0+ 10244- 10245-  10490444+  83  Linux\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part2     10244+ 10252-     8-      8032+  82  Linux swap / Solaris\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part3         0      -      0          0    0  Empty\n/dev/disk/by-path/ip-192.0.2.69:3260-iscsi-iqn-80c3956b-a696-4fa5-9d36-7b034d44b9b0-lun-1-part4         0      -      0          0    0  Empty\nSuccessfully wrote the new partition table\n\n\nRe-reading the partition table ...\n\n2013-06-14 16:48:15,416.416 6570 ERROR nova.virt.baremetal.deploy_helper [req-ba93e66c-c23b-42fb-8141-f56d8f0aa23f None None] StdErr  : Checking that no-one is using this disk right now ...\nOK\nWarning: no primary partition is marked bootable (active)\nThis does not matter for LILO, but the DOS MBR will not boot this disk.\nBLKRRPART: Device or resource busy\nThe command to re-read the partition table failed.\nRun partprobe(8), kpartx(8) or reboot your system now,\nbefore using mkfs\nIf you created or changed a DOS partition, /dev/foo7, say, then use dd(1)\nto zero the first 512 bytes:  dd if=/dev/zero of=/dev/foo7 bs=512 count=1\n(See fdisk(8).)\n\n2013-06-14 16:48:16,115.115 6570 ERROR nova.virt.baremetal.deploy_helper [req-ba93e66c-c23b-42fb-8141-f56d8f0aa23f None None] deployment to node 1 failed\n\n---\n\nThis seems to occur about 1/3 of the time on our Dell R910's.", 
            "date_created": "2013-06-14 18:14:05.956060+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/33472", 
            "date_created": "2013-06-18 16:56:50.757871+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/33472\nCommitted: http://github.com/openstack/nova/commit/703cdd82f773e57daef56128ca103eb810be9644\nSubmitter: Jenkins\nBranch:    master\n\ncommit 703cdd82f773e57daef56128ca103eb810be9644\nAuthor: Dan Prince <email address hidden>\nDate:   Tue Jun 18 12:54:40 2013 -0400\n\n    Retry the sfdisk command up to 3 times.\n    \n    Updates the nova baremetal-deploy-helper so that we retry\n    the fdisk command up to 3 times.\n    \n    Previously the command would sometimes intermittently fail with\n    'Device or resource busy' errors. There doesn't seem to be a good way\n    to check/verify this other than to retry.\n    \n    Fixes LP Bug #1191084.\n    \n    Change-Id: I9c0733432dee5d556d6d2460db42f844e277c8de\n", 
            "date_created": "2013-06-19 21:32:26.080803+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/33818", 
            "date_created": "2013-06-20 13:48:28.324791+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/33818\nCommitted: http://github.com/openstack/ironic/commit/4ca954fbfd5dad912e24623ab6980b97c944368a\nSubmitter: Jenkins\nBranch:    master\n\ncommit 4ca954fbfd5dad912e24623ab6980b97c944368a\nAuthor: Dan Prince <email address hidden>\nDate:   Thu Jun 20 09:47:16 2013 -0400\n\n    Retry the sfdisk command up to 3 times.\n    \n    Updates the nova baremetal-deploy-helper so that we retry\n    the fdisk command up to 3 times.\n    \n    Previously the command would sometimes intermittently fail with\n    'Device or resource busy' errors. There doesn't seem to be a good way\n    to check/verify this other than to retry.\n    \n    Fixes LP Bug #1191084.\n    \n    Change-Id: I18be73cba9c5bf5a4f9cf229dedc4494666c9b35\n", 
            "date_created": "2013-06-20 20:44:41.495614+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}