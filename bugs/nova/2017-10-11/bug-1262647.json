{
    "status": "Invalid", 
    "last_updated": "2015-03-27 06:35:45.929465+00:00", 
    "description": "Environment:\nOpenStack version Havana\nlibvirt_cpu = host-passthrough\nlibvirt0, libvirt-bin 1.1.1-0ubuntu8~cloud2\nqemu-kvm, qemu-utils, qemu-common 1.0+noroms-0ubuntu14.12\nkvm 1:84+dfsg-0ubuntu16+1.0+noroms+0ubuntu14.12\napparmor 2.7.102-0ubuntu3.9\nKernel 3.5.0-44-generic\nlsb-release Ubuntu 12.04.3 LTS\n\nProblem:\n\nI have set libvirt_cpu_mode=host-passthrough in nova.conf in compute node. \nI launched the VM instance and then when I create snapshot of the vm, the vm is left in SHUTOFF state and I cannot start the VM.\nAlso if I suspend the VM, I could not resume it also.\n\nIn nova-compute.log\n2013-12-19 23:33:13.882 6299 ERROR nova.openstack.common.rpc.amqp [req-03e88327-be90-47bd-8a58-505be9e22e31 bfee415e02844c9cb4b6e6a313c2d230 1] Exception during message handling\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 353, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 90, in wrapped\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 73, in wrapped\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 243, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     pass\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 229, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 294, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 271, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 258, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 3311, in resume_instance\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 1962, in resume\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     block_device_info=block_device_info, context=context)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 3210, in _create_domain_and_network\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     domain = self._create_domain(xml, instance=instance, power_on=power_on)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 3153, in _create_domain\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     domain.XMLDesc(0))\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 3148, in _create_domain\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     domain.createWithFlags(launch_flags)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 179, in doit\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 139, in proxy_call\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     rv = execute(f,*args,**kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 77, in tworker\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     rv = meth(*args,**kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 728, in createWithFlags\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp libvirtError: internal error: cannot load AppArmor profile 'libvirt-ba53a370-259f-4f47-b3e5-c76eddf4ec86'\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp\n\n\n\nin libvirtd.log\n2013-12-19 12:08:49.169+0000: 27906: error : virCommandWait:2348 : internal error: Child process (/usr/lib/libvirt/virt-aa-helper -p 0 -r -u libvirt-ba53a370-259f-4f47-b3e5-c76eddf4ec86) unexpected exit status 1: virt-aa-helper: error: could not parse XML\nvirt-aa-helper: error: could not get VM definition\n\n2013-12-19 12:08:49.169+0000: 27906: error : AppArmorGenSecurityLabel:451 : internal error: cannot load AppArmor profile 'libvirt-ba53a370-259f-4f47-b3e5-c76eddf4ec86'\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm resrc=disk reason=start vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 old-disk=\"?\" new-disk=\"/var/lib/nova/instances/ba53a370-259f-4f47-b3e5-c76eddf4ec86/disk\": Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm resrc=disk reason=start vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 old-disk=\"?\" new-disk=\"/var/lib/nova/instances/ba53a370-259f-4f47-b3e5-c76eddf4ec86/disk.local\": Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm resrc=net reason=start vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 old-net=? new-net=fa:16:3e:0d:17:12: Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm resrc=mem reason=start vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 old-mem=0 new-mem=16777216: Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm resrc=vcpu reason=start vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 old-vcpu=0 new-vcpu=4: Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm op=start reason=restored vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 vm-pid=-1: Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : qemuDomainSaveImageStartVM:5452 : failed to restore save state label on /var/lib/libvirt/qemu/save/instance-0000b600.save\n\n\nIf I restart libvirt-bin at this point, the error complains about Non-empty feature list specified without CPU\n\n2013-12-19 12:05:58.786+0000: 27913: info : libvirt version: 1.1.1\n2013-12-19 12:05:58.786+0000: 27913: error : virCPUDefParseXML:367 : XML error: Non-empty feature list specified without CPU model\n2013-12-19 12:05:58.787+0000: 27913: error : virCPUDefParseXML:367 : XML error: Non-empty feature list specified without CPU model\n2013-12-19 12:05:58.788+0000: 27913: error : virCPUDefParseXML:367 : XML error: Non-empty feature list specified without CPU model\n2013-12-19 12:05:58.789+0000: 27913: error : virCPUDefParseXML:367 : XML error: Non-empty feature list specified without CPU model\n2013-12-19 12:05:58.790+0000: 27913: error : virCPUDefParseXML:367 : XML error: Non-empty feature list specified without CPU model\n\nWhen I check xml of save file, the CPU model information are missing.\n\n#virsh save-image-dumpxml instance-0000b600\n\n <cpu mode='host-passthrough'>\n    <feature policy='require' name='perfctr_nb'/>\n    <feature policy='require' name='perfctr_core'/>\n    <feature policy='require' name='topoext'/>\n    <feature policy='require' name='nodeid_msr'/>\n    <feature policy='require' name='lwp'/>\n    <feature policy='require' name='wdt'/>\n    <feature policy='require' name='skinit'/>\n    <feature policy='require' name='ibs'/>\n    <feature policy='require' name='osvw'/>\n    <feature policy='require' name='cr8legacy'/>\n    <feature policy='require' name='extapic'/>\n    <feature policy='require' name='cmp_legacy'/>\n    <feature policy='require' name='fxsr_opt'/>\n    <feature policy='require' name='mmxext'/>\n    <feature policy='require' name='osxsave'/>\n    <feature policy='require' name='monitor'/>\n    <feature policy='require' name='ht'/>\n    <feature policy='require' name='vme'/>\n  </cpu>\n\nxml of the vm\n\n#virsh dumpxml <vm domain> --update-cpu\n\n  <cpu mode='host-passthrough' match='minimum'>\n    <model>Opteron_G4</model>\n    <vendor>AMD</vendor>\n    <feature policy='require' name='perfctr_nb'/>\n    <feature policy='require' name='perfctr_core'/>\n    <feature policy='require' name='topoext'/>\n    <feature policy='require' name='nodeid_msr'/>\n    <feature policy='require' name='lwp'/>\n    <feature policy='require' name='wdt'/>\n    <feature policy='require' name='skinit'/>\n    <feature policy='require' name='ibs'/>\n    <feature policy='require' name='osvw'/>\n    <feature policy='require' name='cr8legacy'/>\n    <feature policy='require' name='extapic'/>\n    <feature policy='require' name='cmp_legacy'/>\n    <feature policy='require' name='fxsr_opt'/>\n    <feature policy='require' name='mmxext'/>\n    <feature policy='require' name='osxsave'/>\n    <feature policy='require' name='monitor'/>\n    <feature policy='require' name='ht'/>\n    <feature policy='require' name='vme'/>\n  </cpu>\n\nI did not have the problem with libvirt 0.9.8 earlier, before upgrade libvirt to 1.1.1\n\n\n\nThanks\nregards,\n\nSwe Aung", 
    "tags": [
        "host-passthrough", 
        "libvirt", 
        "libvirt1x", 
        "resume", 
        "snapshot"
    ], 
    "importance": "Low", 
    "heat": 16, 
    "link": "https://bugs.launchpad.net/nova/+bug/1262647", 
    "owner": "None", 
    "id": 1262647, 
    "index": 6009, 
    "created": "2013-12-19 12:36:43.277406+00:00", 
    "title": "nova snapshot, nova resume not working with libvirt_cpu=host-passthrough and libvirt 1.1.1", 
    "comments": [
        {
            "content": "Environment:\nOpenStack version Havana\nlibvirt_cpu = host-passthrough\nlibvirt0, libvirt-bin 1.1.1-0ubuntu8~cloud2\nqemu-kvm, qemu-utils, qemu-common 1.0+noroms-0ubuntu14.12\nkvm 1:84+dfsg-0ubuntu16+1.0+noroms+0ubuntu14.12\napparmor 2.7.102-0ubuntu3.9\nKernel 3.5.0-44-generic\nlsb-release Ubuntu 12.04.3 LTS\n\nProblem:\n\nI have set libvirt_cpu_mode=host-passthrough in nova.conf in compute node. \nI launched the VM instance and then when I create snapshot of the vm, the vm is left in SHUTOFF state and I cannot start the VM.\nAlso if I suspend the VM, I could not resume it also.\n\nIn nova-compute.log\n2013-12-19 23:33:13.882 6299 ERROR nova.openstack.common.rpc.amqp [req-03e88327-be90-47bd-8a58-505be9e22e31 bfee415e02844c9cb4b6e6a313c2d230 1] Exception during message handling\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 353, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 90, in wrapped\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 73, in wrapped\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 243, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     pass\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 229, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 294, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 271, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 258, in decorated_function\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 3311, in resume_instance\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 1962, in resume\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     block_device_info=block_device_info, context=context)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 3210, in _create_domain_and_network\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     domain = self._create_domain(xml, instance=instance, power_on=power_on)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 3153, in _create_domain\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     domain.XMLDesc(0))\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 3148, in _create_domain\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     domain.createWithFlags(launch_flags)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 179, in doit\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 139, in proxy_call\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     rv = execute(f,*args,**kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 77, in tworker\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     rv = meth(*args,**kwargs)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 728, in createWithFlags\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp libvirtError: internal error: cannot load AppArmor profile 'libvirt-ba53a370-259f-4f47-b3e5-c76eddf4ec86'\n2013-12-19 23:33:13.882 6299 TRACE nova.openstack.common.rpc.amqp\n\n\n\nin libvirtd.log\n2013-12-19 12:08:49.169+0000: 27906: error : virCommandWait:2348 : internal error: Child process (/usr/lib/libvirt/virt-aa-helper -p 0 -r -u libvirt-ba53a370-259f-4f47-b3e5-c76eddf4ec86) unexpected exit status 1: virt-aa-helper: error: could not parse XML\nvirt-aa-helper: error: could not get VM definition\n\n2013-12-19 12:08:49.169+0000: 27906: error : AppArmorGenSecurityLabel:451 : internal error: cannot load AppArmor profile 'libvirt-ba53a370-259f-4f47-b3e5-c76eddf4ec86'\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm resrc=disk reason=start vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 old-disk=\"?\" new-disk=\"/var/lib/nova/instances/ba53a370-259f-4f47-b3e5-c76eddf4ec86/disk\": Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm resrc=disk reason=start vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 old-disk=\"?\" new-disk=\"/var/lib/nova/instances/ba53a370-259f-4f47-b3e5-c76eddf4ec86/disk.local\": Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm resrc=net reason=start vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 old-net=? new-net=fa:16:3e:0d:17:12: Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm resrc=mem reason=start vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 old-mem=0 new-mem=16777216: Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm resrc=vcpu reason=start vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 old-vcpu=0 new-vcpu=4: Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : virAuditSend:135 : Failed to send audit message virt=kvm op=start reason=restored vm=\"instance-0000b600\" uuid=ba53a370-259f-4f47-b3e5-c76eddf4ec86 vm-pid=-1: Operation not permitted\n2013-12-19 12:08:49.170+0000: 27906: warning : qemuDomainSaveImageStartVM:5452 : failed to restore save state label on /var/lib/libvirt/qemu/save/instance-0000b600.save\n\n\nIf I restart libvirt-bin at this point, the error complains about Non-empty feature list specified without CPU\n\n2013-12-19 12:05:58.786+0000: 27913: info : libvirt version: 1.1.1\n2013-12-19 12:05:58.786+0000: 27913: error : virCPUDefParseXML:367 : XML error: Non-empty feature list specified without CPU model\n2013-12-19 12:05:58.787+0000: 27913: error : virCPUDefParseXML:367 : XML error: Non-empty feature list specified without CPU model\n2013-12-19 12:05:58.788+0000: 27913: error : virCPUDefParseXML:367 : XML error: Non-empty feature list specified without CPU model\n2013-12-19 12:05:58.789+0000: 27913: error : virCPUDefParseXML:367 : XML error: Non-empty feature list specified without CPU model\n2013-12-19 12:05:58.790+0000: 27913: error : virCPUDefParseXML:367 : XML error: Non-empty feature list specified without CPU model\n\nWhen I check xml of save file, the CPU model information are missing.\n\n#virsh save-image-dumpxml instance-0000b600\n\n <cpu mode='host-passthrough'>\n    <feature policy='require' name='perfctr_nb'/>\n    <feature policy='require' name='perfctr_core'/>\n    <feature policy='require' name='topoext'/>\n    <feature policy='require' name='nodeid_msr'/>\n    <feature policy='require' name='lwp'/>\n    <feature policy='require' name='wdt'/>\n    <feature policy='require' name='skinit'/>\n    <feature policy='require' name='ibs'/>\n    <feature policy='require' name='osvw'/>\n    <feature policy='require' name='cr8legacy'/>\n    <feature policy='require' name='extapic'/>\n    <feature policy='require' name='cmp_legacy'/>\n    <feature policy='require' name='fxsr_opt'/>\n    <feature policy='require' name='mmxext'/>\n    <feature policy='require' name='osxsave'/>\n    <feature policy='require' name='monitor'/>\n    <feature policy='require' name='ht'/>\n    <feature policy='require' name='vme'/>\n  </cpu>\n\nxml of the vm\n\n#virsh dumpxml <vm domain> --update-cpu\n\n  <cpu mode='host-passthrough' match='minimum'>\n    <model>Opteron_G4</model>\n    <vendor>AMD</vendor>\n    <feature policy='require' name='perfctr_nb'/>\n    <feature policy='require' name='perfctr_core'/>\n    <feature policy='require' name='topoext'/>\n    <feature policy='require' name='nodeid_msr'/>\n    <feature policy='require' name='lwp'/>\n    <feature policy='require' name='wdt'/>\n    <feature policy='require' name='skinit'/>\n    <feature policy='require' name='ibs'/>\n    <feature policy='require' name='osvw'/>\n    <feature policy='require' name='cr8legacy'/>\n    <feature policy='require' name='extapic'/>\n    <feature policy='require' name='cmp_legacy'/>\n    <feature policy='require' name='fxsr_opt'/>\n    <feature policy='require' name='mmxext'/>\n    <feature policy='require' name='osxsave'/>\n    <feature policy='require' name='monitor'/>\n    <feature policy='require' name='ht'/>\n    <feature policy='require' name='vme'/>\n  </cpu>\n\nI did not have the problem with libvirt 0.9.8 earlier, before upgrade libvirt to 1.1.1\n\n\n\nThanks\nregards,\n\nSwe Aung", 
            "date_created": "2013-12-19 12:36:43.277406+00:00", 
            "author": "https://api.launchpad.net/1.0/~sirswa"
        }, 
        {
            "content": "Duplicate bug registered against Ubuntu Libvirt: https://bugs.launchpad.net/ubuntu/+source/libvirt/+bug/1262641\n\nThis is a Libvirt issue but does affect Nova so leaving open on Nova for now to attract attention.", 
            "date_created": "2013-12-19 13:04:11.679793+00:00", 
            "author": "https://api.launchpad.net/1.0/~blair-bethwaite"
        }, 
        {
            "content": "https://bugs.launchpad.net/ubuntu/+source/libvirt/+bug/1262641\n\nthis Libvirt issue has been fixed already", 
            "date_created": "2015-03-27 06:35:10.415571+00:00", 
            "author": "https://api.launchpad.net/1.0/~academicgareth"
        }
    ]
}