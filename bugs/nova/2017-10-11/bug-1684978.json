{
    "status": "Expired", 
    "last_updated": "2017-09-23 04:17:43.270123+00:00", 
    "description": "Description\n===========\nHi, \nNova could not communicate with glance in IPv6 environment.\nI wanted to introduce OpenStack Mitaka to my servers (Ubuntu16.04 LTS) which have only IPv6 address.\n\nSteps to reproduce\n==================\nFirst, I edited hosts file.\n\nKeystone setting is fine.\n\ncontroller# vim /etc/hosts\n-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n#127.0.0.1 controller \u2190 comment out\n...\n2001:200:0:XXXX::a controller  \b\u2190 added (IPv6 only)\n-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n\nNext, go on to  Glance as following.\n\ncontroller# openstack role add --project service --user glance admin\ncontroller# openstack service create --name glance --description \"OpenStack Image service\" image\ncontroller# openstack endpoint create --region RegionOne image public http://controller:9292\ncontroller# openstack endpoint create --region RegionOne image internal http://controller:9292\ncontroller# openstack endpoint create --region RegionOne image admin http://controller:9292\n\ncontroller# vi /etc/glance/glance-api.conf\n\ncontroller# vi /etc/glance/glance-registry.conf\n\n\ncontroller# service glance-registry restart && service glance-api restart\ncontroller# tailf /var/log/glance/glance-api.log           \u2190\ncontroller# tailf /var/log/glance/glance-registry.log   \u2190 both files have no error log\ncontroller# rm /var/lib/glance/glance.sqlite\n\nGet OS image and register it to Glance\ncontroller# wget http://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img\ncontroller# glance image-create --name \"cirros-0.3.4-x86_64\" --file cirros-0.3.4-x86_64-disk.img --disk-format qcow2 --container-format bare  --visibility public --progress\ncontroller# openstack image list\n\nI checked Glance is file\n\nThen, Nova setting...\ncontroller# openstack endpoint create --region RegionOne compute public http://controller:8774/v2.1/%\\(tenant_id\\)s\ncontroller# openstack endpoint create --region RegionOne compute internal http://controller:8774/v2.1/%\\(tenant_id\\)s\ncontroller# openstack endpoint create --region RegionOne compute admin http://controller:8774/v2.1/%\\(tenant_id\\)s\n\ncontroller# vi /etc/nova/nova.conf \n\n\ncontroller# su -s /bin/sh -c \"nova-manage api_db sync\" nova\ncontroller# su -s /bin/sh -c \"nova-manage db sync\" nova\ncontroller# service nova-api restart && service nova-consoleauth restart && service nova-scheduler restart && service nova-conductor restart && service nova-novncproxy restart\n\n\b\u2191no error happened\n\ncontroller# rm /var/lib/nova/nova.sqlite\ncontroller# nova image-list (the log file of nova-api at this command is attached)\n\nExpected result\n===============\ncontroller# nova image-list\n+--------------------------------------+---------------------+--------+--------+\n| ID                                   | Name                | Status | Server |\n+--------------------------------------+---------------------+--------+--------+\n| 12d67808-c7d2-44b4-8bc6-b0ced1878f06 | cirros-0.3.4-x86_64 | ACTIVE |        |\n+--------------------------------------+---------------------+--------+--------+\n\nActual result\n=============\ncontroller # nova image-list\nERROR (ClientException): Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'glanceclient.exc.HTTPInternalServerError'> (HTTP 500) (Request-ID: req-978e02bb-998a-4f34-bcb2-1baf9707aec1)\n\nEnvironment\n===========\ncontroller ~(admin)# dpkg -l | grep nova\nii  nova-api                           2:13.1.3-0ubuntu1                          all          OpenStack Compute - API frontend\nii  nova-common                        2:13.1.3-0ubuntu1                          all          OpenStack Compute - common files\nii  nova-conductor                     2:13.1.3-0ubuntu1                          all          OpenStack Compute - conductor service\nii  nova-consoleauth                   2:13.1.3-0ubuntu1                          all          OpenStack Compute - Console Authenticator\nii  nova-novncproxy                    2:13.1.3-0ubuntu1                          all          OpenStack Compute - NoVNC proxy\nii  nova-scheduler                     2:13.1.3-0ubuntu1                          all          OpenStack Compute - virtual machine scheduler\nii  python-nova                        2:13.1.3-0ubuntu1                          all          OpenStack Compute Python libraries\nii  python-novaclient                  2:3.3.1-2ubuntu1                           all          client library for OpenStack Compute API - Python 2.7\n\ncontroller ~(admin)# dpkg -l | grep glance\nii  glance                             2:12.0.0-0ubuntu2                          all          OpenStack Image Registry and Delivery Service - Daemons\nii  glance-api                         2:12.0.0-0ubuntu2                          all          OpenStack Image Registry and Delivery Service - API\nii  glance-common                      2:12.0.0-0ubuntu2                          all          OpenStack Image Registry and Delivery Service - Common\nii  glance-registry                    2:12.0.0-0ubuntu2                          all          OpenStack Image Registry and Delivery Service - Registry\nii  glance-store-common                0.13.0-3ubuntu0.16.04.1                    all          OpenStack Image Service store library - common files\nii  python-glance                      2:12.0.0-0ubuntu2                          all          OpenStack Image Registry and Delivery Service - Python library\nii  python-glance-store                0.13.0-3ubuntu0.16.04.1                    all          OpenStack Image Service store library - Python 2.7\nii  python-glanceclient                1:2.0.0-2ubuntu0.16.04.1                   all          Client library for Openstack glance server - Python 2.x\n\n\nLogs & Configs\n==============\nextract related part as follows\n\n-=-=-=-=-=  nova.conf =-=-=-=-=-=-\n[DEFAULT]\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlogdir=/var/log/nova\nstate_path=/var/lib/nova\n#lock_path=/var/lock/nova     \u2190 comment out\nforce_dhcp_release=True\nlibvirt_use_virtio_for_bridges=True\nverbose=True\nec2_private_dns_show_ip=True\napi_paste_config=/etc/nova/api-paste.ini\n#enabled_apis=ec2,osapi_compute,metadata   \u2190 comment out\nenabled_apis = osapi_compute,metadata        \u2190 added\nrpc_backend = rabbit\nauth_strategy = keystone\n\nmy_ip = 2001:200:0:XXXX::a                          \u2190 added\n\nuse_neutron = True\n\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\n\n[vnc]\nvncserver_listen = 2001:200:0:XXXX::a\nvncserver_proxyclient_address = 2001:200:0:XXXX::a\n\n[api_database]\nconnection = mysql+pymysql://nova:password@controller/nova_api\n\n[database]\nconnection = mysql+pymysql://nova:password@controller/nova\n\n[oslo_messaging_rabbit]\nrabbit_host = controller\nrabbit_userid = openstack\nrabbit_password = password\n\n[keystone_authtoken]\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = nova\npassword = password \n\n[glance]\napi_servers = http://controller:9292\n\n[oslo_concurrency]\nlock_path = /var/lib/nova/tmp\n-=-=-=-=end of nova.conf -=-=-=-=-=-=-=-=-=-\n\n\n-=-=-=-=-=-=- glance-api.conf =-=-=-=-=-=-=-=-=-\n...\n[database]\n#sqlite_db = /var/lib/glance/glance.sqlite         \u2190 comment out\nconnection = mysql+pymysql://glance:password@controller/glance   \u2190 added\n...\n[glance_store]\n...\nstores = file,http\ndefault_store = file\nfilesystem_store_datadir = /var/lib/glance/images/  \u2190 added\n...\n[keystone_authtoken]\n...\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = glance\npassword = password  \n...\n[paste_deploy]\n...\nflavor = keystone \n-=-=-=-=-= end of glance-api.conf -=-=-=-=-=-=-=-=-=-=-\n\n\n-=-=-=-=-=-=-=- glance-registry.conf =-=-=-=-=-=-=-=-=-=-\n[DEFAULT]\n...\n[database]\n#sqlite_db = /var/lib/glance/glance.sqlite             \u2190 comment out\nconnection = mysql+pymysql://glance:password@controller/glance  \u2190 added\n\n[keystone_authtokey]\n...\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = glance\npassword = password  \n\n...\n[paste_deploy]\nflavor = keystone            \n=-=-=-=-=-=- end of glance-registry.conf =-=-=-=-=-=-=-=-=-=-=-=-", 
    "tags": [
        "needs.logs", 
        "openstack-version.mitaka"
    ], 
    "importance": "Undecided", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1684978", 
    "owner": "None", 
    "id": 1684978, 
    "index": 6807, 
    "created": "2017-04-20 17:41:49.159612+00:00", 
    "title": "Nova could not communicate with Glance in IPv6 environment ", 
    "comments": [
        {
            "content": "Description\n===========\nHi, \nNova could not communicate with glance in IPv6 environment.\nI wanted to introduce OpenStack Mitaka to my servers (Ubuntu16.04 LTS) which have only IPv6 address.\n\nSteps to reproduce\n==================\nFirst, I edited hosts file.\n\nKeystone setting is fine.\n\ncontroller# vim /etc/hosts\n-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n#127.0.0.1 controller \u2190 comment out\n...\n2001:200:0:XXXX::a controller  \b\u2190 added (IPv6 only)\n-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=-=\n\nNext, go on to  Glance as following.\n\ncontroller# openstack role add --project service --user glance admin\ncontroller# openstack service create --name glance --description \"OpenStack Image service\" image\ncontroller# openstack endpoint create --region RegionOne image public http://controller:9292\ncontroller# openstack endpoint create --region RegionOne image internal http://controller:9292\ncontroller# openstack endpoint create --region RegionOne image admin http://controller:9292\n\ncontroller# vi /etc/glance/glance-api.conf\n\ncontroller# vi /etc/glance/glance-registry.conf\n\n\ncontroller# service glance-registry restart && service glance-api restart\ncontroller# tailf /var/log/glance/glance-api.log           \u2190\ncontroller# tailf /var/log/glance/glance-registry.log   \u2190 both files have no error log\ncontroller# rm /var/lib/glance/glance.sqlite\n\nGet OS image and register it to Glance\ncontroller# wget http://download.cirros-cloud.net/0.3.4/cirros-0.3.4-x86_64-disk.img\ncontroller# glance image-create --name \"cirros-0.3.4-x86_64\" --file cirros-0.3.4-x86_64-disk.img --disk-format qcow2 --container-format bare  --visibility public --progress\ncontroller# openstack image list\n\nI checked Glance is file\n\nThen, Nova setting...\ncontroller# openstack endpoint create --region RegionOne compute public http://controller:8774/v2.1/%\\(tenant_id\\)s\ncontroller# openstack endpoint create --region RegionOne compute internal http://controller:8774/v2.1/%\\(tenant_id\\)s\ncontroller# openstack endpoint create --region RegionOne compute admin http://controller:8774/v2.1/%\\(tenant_id\\)s\n\ncontroller# vi /etc/nova/nova.conf \n\n\ncontroller# su -s /bin/sh -c \"nova-manage api_db sync\" nova\ncontroller# su -s /bin/sh -c \"nova-manage db sync\" nova\ncontroller# service nova-api restart && service nova-consoleauth restart && service nova-scheduler restart && service nova-conductor restart && service nova-novncproxy restart\n\n\b\u2191no error happened\n\ncontroller# rm /var/lib/nova/nova.sqlite\ncontroller# nova image-list (the log file of nova-api at this command is attached)\n\nExpected result\n===============\ncontroller# nova image-list\n+--------------------------------------+---------------------+--------+--------+\n| ID                                   | Name                | Status | Server |\n+--------------------------------------+---------------------+--------+--------+\n| 12d67808-c7d2-44b4-8bc6-b0ced1878f06 | cirros-0.3.4-x86_64 | ACTIVE |        |\n+--------------------------------------+---------------------+--------+--------+\n\nActual result\n=============\ncontroller # nova image-list\nERROR (ClientException): Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'glanceclient.exc.HTTPInternalServerError'> (HTTP 500) (Request-ID: req-978e02bb-998a-4f34-bcb2-1baf9707aec1)\n\nEnvironment\n===========\ncontroller ~(admin)# dpkg -l | grep nova\nii  nova-api                           2:13.1.3-0ubuntu1                          all          OpenStack Compute - API frontend\nii  nova-common                        2:13.1.3-0ubuntu1                          all          OpenStack Compute - common files\nii  nova-conductor                     2:13.1.3-0ubuntu1                          all          OpenStack Compute - conductor service\nii  nova-consoleauth                   2:13.1.3-0ubuntu1                          all          OpenStack Compute - Console Authenticator\nii  nova-novncproxy                    2:13.1.3-0ubuntu1                          all          OpenStack Compute - NoVNC proxy\nii  nova-scheduler                     2:13.1.3-0ubuntu1                          all          OpenStack Compute - virtual machine scheduler\nii  python-nova                        2:13.1.3-0ubuntu1                          all          OpenStack Compute Python libraries\nii  python-novaclient                  2:3.3.1-2ubuntu1                           all          client library for OpenStack Compute API - Python 2.7\n\ncontroller ~(admin)# dpkg -l | grep glance\nii  glance                             2:12.0.0-0ubuntu2                          all          OpenStack Image Registry and Delivery Service - Daemons\nii  glance-api                         2:12.0.0-0ubuntu2                          all          OpenStack Image Registry and Delivery Service - API\nii  glance-common                      2:12.0.0-0ubuntu2                          all          OpenStack Image Registry and Delivery Service - Common\nii  glance-registry                    2:12.0.0-0ubuntu2                          all          OpenStack Image Registry and Delivery Service - Registry\nii  glance-store-common                0.13.0-3ubuntu0.16.04.1                    all          OpenStack Image Service store library - common files\nii  python-glance                      2:12.0.0-0ubuntu2                          all          OpenStack Image Registry and Delivery Service - Python library\nii  python-glance-store                0.13.0-3ubuntu0.16.04.1                    all          OpenStack Image Service store library - Python 2.7\nii  python-glanceclient                1:2.0.0-2ubuntu0.16.04.1                   all          Client library for Openstack glance server - Python 2.x\n\n\nLogs & Configs\n==============\nextract related part as follows\n\n-=-=-=-=-=  nova.conf =-=-=-=-=-=-\n[DEFAULT]\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlogdir=/var/log/nova\nstate_path=/var/lib/nova\n#lock_path=/var/lock/nova     \u2190 comment out\nforce_dhcp_release=True\nlibvirt_use_virtio_for_bridges=True\nverbose=True\nec2_private_dns_show_ip=True\napi_paste_config=/etc/nova/api-paste.ini\n#enabled_apis=ec2,osapi_compute,metadata   \u2190 comment out\nenabled_apis = osapi_compute,metadata        \u2190 added\nrpc_backend = rabbit\nauth_strategy = keystone\n\nmy_ip = 2001:200:0:XXXX::a                          \u2190 added\n\nuse_neutron = True\n\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\n\n[vnc]\nvncserver_listen = 2001:200:0:XXXX::a\nvncserver_proxyclient_address = 2001:200:0:XXXX::a\n\n[api_database]\nconnection = mysql+pymysql://nova:password@controller/nova_api\n\n[database]\nconnection = mysql+pymysql://nova:password@controller/nova\n\n[oslo_messaging_rabbit]\nrabbit_host = controller\nrabbit_userid = openstack\nrabbit_password = password\n\n[keystone_authtoken]\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = nova\npassword = password \n\n[glance]\napi_servers = http://controller:9292\n\n[oslo_concurrency]\nlock_path = /var/lib/nova/tmp\n-=-=-=-=end of nova.conf -=-=-=-=-=-=-=-=-=-\n\n\n-=-=-=-=-=-=- glance-api.conf =-=-=-=-=-=-=-=-=-\n...\n[database]\n#sqlite_db = /var/lib/glance/glance.sqlite         \u2190 comment out\nconnection = mysql+pymysql://glance:password@controller/glance   \u2190 added\n...\n[glance_store]\n...\nstores = file,http\ndefault_store = file\nfilesystem_store_datadir = /var/lib/glance/images/  \u2190 added\n...\n[keystone_authtoken]\n...\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = glance\npassword = password  \n...\n[paste_deploy]\n...\nflavor = keystone \n-=-=-=-=-= end of glance-api.conf -=-=-=-=-=-=-=-=-=-=-\n\n\n-=-=-=-=-=-=-=- glance-registry.conf =-=-=-=-=-=-=-=-=-=-\n[DEFAULT]\n...\n[database]\n#sqlite_db = /var/lib/glance/glance.sqlite             \u2190 comment out\nconnection = mysql+pymysql://glance:password@controller/glance  \u2190 added\n\n[keystone_authtokey]\n...\nauth_uri = http://controller:5000\nauth_url = http://controller:35357\nmemcached_servers = controller:11211\nauth_type = password\nproject_domain_name = default\nuser_domain_name = default\nproject_name = service\nusername = glance\npassword = password  \n\n...\n[paste_deploy]\nflavor = keystone            \n=-=-=-=-=-=- end of glance-registry.conf =-=-=-=-=-=-=-=-=-=-=-=-", 
            "date_created": "2017-04-20 17:41:49.159612+00:00", 
            "author": "https://api.launchpad.net/1.0/~negli0"
        }, 
        {
            "content": "", 
            "date_created": "2017-04-20 17:41:49.159612+00:00", 
            "author": "https://api.launchpad.net/1.0/~negli0"
        }, 
        {
            "content": "Automatically discovered version mitaka in description. If this is incorrect, please update the description to include 'nova version: ...'", 
            "date_created": "2017-06-27 15:57:29.370906+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "This needs debug logs for both nova and glance to figure out what's going on, the INFO level logs aren't sufficient", 
            "date_created": "2017-07-24 15:32:51.972965+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "[Expired for OpenStack Compute (nova) because there has been no activity for 60 days.]", 
            "date_created": "2017-09-23 04:17:41.092685+00:00", 
            "author": "https://api.launchpad.net/1.0/~janitor"
        }
    ]
}