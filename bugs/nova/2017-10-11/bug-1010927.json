{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:23:45.960100+00:00", 
    "description": "Whith the following flags set on nova conf:\n\n--start_guests_on_host_boot=true\n--resume_guests_state_on_host_boot=true\n\nWhen a compute node is hard rebooted (or in my case, suffer a power failure), nova-compute is unable to start on the node with the following error:\n\n\n2012-06-09 11:24:16 INFO nova.virt.libvirt.connection [req-9c3628ce-f5c2-4f2c-9217-aed95ae10a42 None None] [instance: bea97c46-fde7-4fe8-8e89-ab8e81d635d5] Instance shutdown successfully. \n2012-06-09 11:24:17 CRITICAL nova [-] Cannot get interface MTU on 'br100': No such device\n2012-06-09 11:24:17 TRACE nova Traceback (most recent call last):\n2012-06-09 11:24:17 TRACE nova   File \"/usr/bin/nova-compute\", line 49, in <module>\n2012-06-09 11:24:17 TRACE nova     service.wait()\n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 413, in wait\n2012-06-09 11:24:17 TRACE nova     _launcher.wait()\n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 131, in wait \n2012-06-09 11:24:17 TRACE nova     service.wait() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 166, in wait \n2012-06-09 11:24:17 TRACE nova     return self._exit_event.wait() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/eventlet/event.py\", line 116, in wait \n2012-06-09 11:24:17 TRACE nova     return hubs.get_hub().switch() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 177, in switch \n2012-06-09 11:24:17 TRACE nova     return self.greenlet.switch() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 192, in main \n2012-06-09 11:24:17 TRACE nova     result = function(*args, **kwargs) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 101, in run_server \n2012-06-09 11:24:17 TRACE nova     server.start() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 162, in start \n2012-06-09 11:24:17 TRACE nova     self.manager.init_host() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 247, in init_host \n2012-06-09 11:24:17 TRACE nova     self.reboot_instance(context, instance['uuid']) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 114, in wrapped \n2012-06-09 11:24:17 TRACE nova     return f(*args, **kw) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 153, in decorated_function \n2012-06-09 11:24:17 TRACE nova     function(self, context, instance_uuid, *args, **kwargs) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 177, in decorated_function \n2012-06-09 11:24:17 TRACE nova     sys.exc_info()) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__ \n2012-06-09 11:24:17 TRACE nova     self.gen.next() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 171, in decorated_function \n2012-06-09 11:24:17 TRACE nova     return function(self, context, instance_uuid, *args, **kwargs) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 898, in reboot_instance \n2012-06-09 11:24:17 TRACE nova     reboot_type) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 114, in wrapped \n2012-06-09 11:24:17 TRACE nova     return f(*args, **kw) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 718, in reboot \n2012-06-09 11:24:17 TRACE nova     if self._soft_reboot(instance): \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 754, in _soft_reboot \n2012-06-09 11:24:17 TRACE nova     dom.create() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 551, in create \n2012-06-09 11:24:17 TRACE nova     if ret == -1: raise libvirtError ('virDomainCreate() failed', dom=self) \n2012-06-09 11:24:17 TRACE nova libvirtError: Cannot get interface MTU on 'br100': No such device \n\n\nIt seems that nova-compute doesn't create the bridge and thus fails to start. Removing both settings from nova conf makes nova-compute start again.", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 30, 
    "link": "https://bugs.launchpad.net/nova/+bug/1010927", 
    "owner": "https://api.launchpad.net/1.0/~dan-prince", 
    "id": 1010927, 
    "index": 2931, 
    "created": "2012-06-09 16:12:06.351758+00:00", 
    "title": "Nova fails to start if --start_guests_on_host_boot=true is set", 
    "comments": [
        {
            "content": "Whith the following flags set on nova conf:\n\n--start_guests_on_host_boot=true\n--resume_guests_state_on_host_boot=true\n\nWhen a compute node is hard rebooted (or in my case, suffer a power failure), nova-compute is unable to start on the node with the following error:\n\n\n2012-06-09 11:24:16 INFO nova.virt.libvirt.connection [req-9c3628ce-f5c2-4f2c-9217-aed95ae10a42 None None] [instance: bea97c46-fde7-4fe8-8e89-ab8e81d635d5] Instance shutdown successfully. \n2012-06-09 11:24:17 CRITICAL nova [-] Cannot get interface MTU on 'br100': No such device\n2012-06-09 11:24:17 TRACE nova Traceback (most recent call last):\n2012-06-09 11:24:17 TRACE nova   File \"/usr/bin/nova-compute\", line 49, in <module>\n2012-06-09 11:24:17 TRACE nova     service.wait()\n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 413, in wait\n2012-06-09 11:24:17 TRACE nova     _launcher.wait()\n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 131, in wait \n2012-06-09 11:24:17 TRACE nova     service.wait() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 166, in wait \n2012-06-09 11:24:17 TRACE nova     return self._exit_event.wait() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/eventlet/event.py\", line 116, in wait \n2012-06-09 11:24:17 TRACE nova     return hubs.get_hub().switch() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 177, in switch \n2012-06-09 11:24:17 TRACE nova     return self.greenlet.switch() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 192, in main \n2012-06-09 11:24:17 TRACE nova     result = function(*args, **kwargs) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 101, in run_server \n2012-06-09 11:24:17 TRACE nova     server.start() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 162, in start \n2012-06-09 11:24:17 TRACE nova     self.manager.init_host() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 247, in init_host \n2012-06-09 11:24:17 TRACE nova     self.reboot_instance(context, instance['uuid']) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 114, in wrapped \n2012-06-09 11:24:17 TRACE nova     return f(*args, **kw) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 153, in decorated_function \n2012-06-09 11:24:17 TRACE nova     function(self, context, instance_uuid, *args, **kwargs) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 177, in decorated_function \n2012-06-09 11:24:17 TRACE nova     sys.exc_info()) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__ \n2012-06-09 11:24:17 TRACE nova     self.gen.next() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 171, in decorated_function \n2012-06-09 11:24:17 TRACE nova     return function(self, context, instance_uuid, *args, **kwargs) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 898, in reboot_instance \n2012-06-09 11:24:17 TRACE nova     reboot_type) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 114, in wrapped \n2012-06-09 11:24:17 TRACE nova     return f(*args, **kw) \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 718, in reboot \n2012-06-09 11:24:17 TRACE nova     if self._soft_reboot(instance): \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 754, in _soft_reboot \n2012-06-09 11:24:17 TRACE nova     dom.create() \n2012-06-09 11:24:17 TRACE nova   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 551, in create \n2012-06-09 11:24:17 TRACE nova     if ret == -1: raise libvirtError ('virDomainCreate() failed', dom=self) \n2012-06-09 11:24:17 TRACE nova libvirtError: Cannot get interface MTU on 'br100': No such device \n\n\nIt seems that nova-compute doesn't create the bridge and thus fails to start. Removing both settings from nova conf makes nova-compute start again.", 
            "date_created": "2012-06-09 16:12:06.351758+00:00", 
            "author": "https://api.launchpad.net/1.0/~adrianmoya"
        }, 
        {
            "content": "This was recently changed in trunk.  I think this is fixed now.", 
            "date_created": "2012-06-10 20:56:01.224082+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "fix is here: https://review.openstack.org/#/c/8035/\n\nIt should probably be backported to essex", 
            "date_created": "2012-06-10 20:57:58.131182+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "stable/essex here: https://review.openstack.org/#/c/8423/\n", 
            "date_created": "2012-06-14 20:11:03.769432+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }
    ]
}