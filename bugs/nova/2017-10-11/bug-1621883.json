{
    "status": "Fix Released", 
    "last_updated": "2016-10-18 17:01:45.452195+00:00", 
    "description": "Saw this in a CI run today:\n\nhttp://logs.openstack.org/07/367307/1/check/gate-tempest-dsvm-neutron-full-ubuntu-xenial/cf54759/logs/screen-n-cpu.txt.gz?level=TRACE#_2016-09-08_12_05_26_139\n\nWe shouldn't stacktrace on a 404 port not found when unbinding ports from an instance (that is probably be deleted).\n\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api [req-aef4186a-7fdb-4e62-a4b1-ec7482db7e5b tempest-AttachInterfacesTestJSON-554004321 tempest-AttachInterfacesTestJSON-554004321] Unable to clear device ID for port '6dff1db9-e6e1-490b-9246-ea479281b3ff'\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api Traceback (most recent call last):\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 434, in _unbind_ports\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     port_client.update_port(port_id, port_req_body)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 94, in wrapper\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     ret = obj(*args, **kwargs)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 754, in update_port\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     return self.put(self.port_path % (port), body=body)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 94, in wrapper\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     ret = obj(*args, **kwargs)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 369, in put\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     headers=headers, params=params)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 94, in wrapper\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     ret = obj(*args, **kwargs)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 337, in retry_request\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     headers=headers, params=params)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 94, in wrapper\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     ret = obj(*args, **kwargs)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 300, in do_request\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     self._handle_fault_response(status_code, replybody, resp)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 94, in wrapper\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     ret = obj(*args, **kwargs)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 275, in _handle_fault_response\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     exception_handler_v20(status_code, error_body)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 91, in exception_handler_v20\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     request_ids=request_ids)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api PortNotFoundClient: Port 6dff1db9-e6e1-490b-9246-ea479281b3ff could not be found.\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api Neutron server returns request_ids: ['req-8350bbd5-d45b-4e59-a8a5-5d232faa45c1']\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api", 
    "tags": [
        "compute", 
        "low-hanging-fruit", 
        "neutron"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1621883", 
    "owner": "https://api.launchpad.net/1.0/~mriedem", 
    "id": 1621883, 
    "index": 4618, 
    "created": "2016-09-09 14:08:23.995206+00:00", 
    "title": "PortNotFoundClient stacktrace in n-cpu when unbinding ports", 
    "comments": [
        {
            "content": "Saw this in a CI run today:\n\nhttp://logs.openstack.org/07/367307/1/check/gate-tempest-dsvm-neutron-full-ubuntu-xenial/cf54759/logs/screen-n-cpu.txt.gz?level=TRACE#_2016-09-08_12_05_26_139\n\nWe shouldn't stacktrace on a 404 port not found when unbinding ports from an instance (that is probably be deleted).\n\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api [req-aef4186a-7fdb-4e62-a4b1-ec7482db7e5b tempest-AttachInterfacesTestJSON-554004321 tempest-AttachInterfacesTestJSON-554004321] Unable to clear device ID for port '6dff1db9-e6e1-490b-9246-ea479281b3ff'\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api Traceback (most recent call last):\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 434, in _unbind_ports\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     port_client.update_port(port_id, port_req_body)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 94, in wrapper\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     ret = obj(*args, **kwargs)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 754, in update_port\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     return self.put(self.port_path % (port), body=body)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 94, in wrapper\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     ret = obj(*args, **kwargs)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 369, in put\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     headers=headers, params=params)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 94, in wrapper\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     ret = obj(*args, **kwargs)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 337, in retry_request\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     headers=headers, params=params)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 94, in wrapper\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     ret = obj(*args, **kwargs)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 300, in do_request\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     self._handle_fault_response(status_code, replybody, resp)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 94, in wrapper\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     ret = obj(*args, **kwargs)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 275, in _handle_fault_response\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     exception_handler_v20(status_code, error_body)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api   File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 91, in exception_handler_v20\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api     request_ids=request_ids)\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api PortNotFoundClient: Port 6dff1db9-e6e1-490b-9246-ea479281b3ff could not be found.\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api Neutron server returns request_ids: ['req-8350bbd5-d45b-4e59-a8a5-5d232faa45c1']\n2016-09-08 12:05:26.139 17305 ERROR nova.network.neutronv2.api", 
            "date_created": "2016-09-09 14:08:23.995206+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "This is happening when deallocating networking for the instance:\n\nhttp://logs.openstack.org/07/367307/1/check/gate-tempest-dsvm-neutron-full-ubuntu-xenial/cf54759/logs/screen-n-cpu.txt.gz?#_2016-09-08_12_05_26_063\n\n2016-09-08 12:05:26.063 17305 DEBUG nova.compute.manager [req-aef4186a-7fdb-4e62-a4b1-ec7482db7e5b tempest-AttachInterfacesTestJSON-554004321 tempest-AttachInterfacesTestJSON-554004321] [instance: 9a5e4439-a899-4e16-a5c4-047f06f6d0b7] Deallocating network for instance _deallocate_network /opt/stack/new/nova/nova/compute/manager.py:1658\n\nhttp://logstash.openstack.org/#dashboard/file/logstash.json?query=message%3A%5C%22_unbind_ports%5C%22%20AND%20message%3A%5C%22PortNotFoundClient%5C%22%20AND%20tags%3A%5C%22screen-n-cpu.txt%5C%22&from=7d", 
            "date_created": "2016-09-09 14:40:27.656811+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/368079", 
            "date_created": "2016-09-09 15:22:41.880493+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/368079\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=6a2691cf6db1d1f4e4f5dd9e758c0d42f235478d\nSubmitter: Jenkins\nBranch:    master\n\ncommit 6a2691cf6db1d1f4e4f5dd9e758c0d42f235478d\nAuthor: Matt Riedemann <email address hidden>\nDate:   Fri Sep 9 11:20:59 2016 -0400\n\n    neutron: don't trace on port not found when unbinding ports\n    \n    There is a race in the gate when deleting an instance and\n    deallocating the network at the same time that preexisting\n    ports attached to the instance are being deleted. So when\n    nova goes to unbind the port it's already gone and we log\n    an exception trace in the n-cpu logs. We shouldn't actually\n    care if the port isn't found when unbinding it from an instance,\n    so this change handles that case and logs it at debug rather\n    than an exception trace.\n    \n    Change-Id: Ia95c626cefcb1e099e11d3bf5a651ad5d5f9406f\n    Closes-Bug: #1621883\n", 
            "date_created": "2016-09-12 15:42:25.458307+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.0.0rc1 release candidate.", 
            "date_created": "2016-09-26 20:14:04.658091+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.0.0rc1 release candidate.", 
            "date_created": "2016-10-18 17:01:43.853331+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}