{
    "status": "Invalid", 
    "last_updated": "2012-10-25 01:33:17.981012+00:00", 
    "description": "Description:\n----------------\nUpdating the server with invalid name should raise the bad request exception. But it is not raising.\n\nExpected result:\n-----------------------\nShould raise the bad request\n\nRefernce link:\n------------------\nhttp://docs.openstack.org/api/openstack-compute/1.1/content/ServerUpdate.html", 
    "tags": [
        "low-hanging-fruit", 
        "servers"
    ], 
    "importance": "Low", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/944034", 
    "owner": "https://api.launchpad.net/1.0/~novas0x2a", 
    "id": 944034, 
    "index": 5359, 
    "created": "2012-03-01 14:37:33.528543+00:00", 
    "title": "Updating the server with invalid name is not raising Bad request", 
    "comments": [
        {
            "content": "Description:\n----------------\nUpdating the server with invalid name should raise the bad request exception. But it is not raising.\n\nExpected result:\n-----------------------\nShould raise the bad request\n\nRefernce link:\n------------------\nhttp://docs.openstack.org/api/openstack-compute/1.1/content/ServerUpdate.html", 
            "date_created": "2012-03-01 14:37:33.528543+00:00", 
            "author": "https://api.launchpad.net/1.0/~rajalakshmi-ganesan"
        }, 
        {
            "content": "submitter: what invalid name do you mean?", 
            "date_created": "2012-03-01 21:43:41.624135+00:00", 
            "author": "https://api.launchpad.net/1.0/~novas0x2a"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/4787", 
            "date_created": "2012-03-02 01:24:53.707708+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/4787\nCommitted: http://github.com/openstack/nova/commit/27013e87f53cccbfd2e203f065e416437ba08987\nSubmitter: Jenkins\nBranch:    master\n\ncommit 27013e87f53cccbfd2e203f065e416437ba08987\nAuthor: Mike Lundy <email address hidden>\nDate:   Fri Mar 2 00:15:04 2012 +0000\n\n    Fail gracefully when the db doesn't speak unicode\n    \n    When sqlalchemy/mysql doesn't contain the charset=utf8 or use_unicode=1\n    parameters (and the default mysql connection charset is not utf8),\n    sqlalchemy will connect to mysql in ascii mode; In ascii mode, it will\n    attempt to reencode all input data to latin-1 regardless of the\n    database/table collation setting. This catches that error and turns it\n    into an invalid parameter.\n    \n    (The error message associated with this is something like\n    UnicodeEncodeError: 'latin-1' codec can't encode character u'\\u2026' in\n    position 30: ordinal not in range(256))\n    \n    This fixes bug 944034 and is related to bug 898808\n    \n    Change-Id: I082b7568ef9e9d2104e13aa58d207535ef201bd3\n", 
            "date_created": "2012-03-02 05:47:05.530504+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "I am still able to update servers name with invalid charcaters such ad \"&!@#$%^&*()+_\"\n\nThus reopening this bug.\n\n\nLOG:-\n------------\n\n\n\n[umamaheshk@HPOpenstackVM16 ~/source/csbu-qa-dev/nova/tests]$nova list\n+--------------------------------------+-----------------------------------+--------+------------------+\n|                  ID                  |                Name               | Status |     Networks     |\n+--------------------------------------+-----------------------------------+--------+------------------+\n| 16716a61-d8ba-4abb-885d-db10eced1562 | update_server_name                | ACTIVE | private=10.0.0.4 |\n| a31aeecd-5237-4e1a-98b1-407164166c3a | test-1                            | ACTIVE | private=10.0.0.5 |\n| d496dc20-ef69-4aa6-97c0-798878b635c8 | update_server_name&12!@#$%^&*()+_ | ACTIVE | private=10.0.0.3 |\n+--------------------------------------+-----------------------------------+--------+------------------+\n[umamaheshk@HPOpenstackVM16 ~/source/csbu-qa-dev/nova/tests]$export NOVACLIENT_DEBUG=1\n[umamaheshk@HPOpenstackVM16 ~/source/csbu-qa-dev/nova/tests]$./apitool.py -j update.json PUT /servers/a31aeecd-5237-4e1a-98b1-407164166c3a\nREQ: curl -i http://10.233.52.237:5000/v2.0/tokens -X POST -H \"Content-Type: application/json\" -H \"User-Agent: python-novaclient\"\n\nREQ BODY: {\"auth\": {\"tenantName\": \"admin\", \"passwordCredentials\": {\"username\": \"admin\", \"password\": \"muralik\"}}}\n\nRESP:{'date': 'Fri, 12 Oct 2012 14:16:10 GMT', 'vary': 'X-Auth-Token', 'content-length': '2462', 'status': '200', 'content-type': 'application/json'} {\"access\": {\"token\": {\"expires\": \"2012-10-13T14:16:10Z\", \"id\": \"0672b716683d4f21a4e46ad8846cc34c\", \"tenant\": {\"enabled\": true, \"description\": null, \"name\": \"admin\", \"id\": \"bea2e6e7c6d4468281b37f0281d90a65\"}}, \"serviceCatalog\": [{\"endpoints\": [{\"adminURL\": \"http://10.233.52.237:8774/v2/bea2e6e7c6d4468281b37f0281d90a65\", \"region\": \"RegionOne\", \"internalURL\": \"http://10.233.52.237:8774/v2/bea2e6e7c6d4468281b37f0281d90a65\", \"id\": \"4d2bd52566f449b681d138970d0551a9\", \"publicURL\": \"http://10.233.52.237:8774/v2/bea2e6e7c6d4468281b37f0281d90a65\"}], \"endpoints_links\": [], \"type\": \"compute\", \"name\": \"nova\"}, {\"endpoints\": [{\"adminURL\": \"http://10.233.52.237:3333\", \"region\": \"RegionOne\", \"internalURL\": \"http://10.233.52.237:3333\", \"id\": \"96a896eefefd435d9eb171f5193f6ffc\", \"publicURL\": \"http://10.233.52.237:3333\"}], \"endpoints_links\": [], \"type\": \"s3\", \"name\": \"s3\"}, {\"endpoints\": [{\"adminURL\": \"http://10.233.52.237:9292\", \"region\": \"RegionOne\", \"internalURL\": \"http://10.233.52.237:9292\", \"id\": \"3744aa8ba7e444d4bc88e92edce85336\", \"publicURL\": \"http://10.233.52.237:9292\"}], \"endpoints_links\": [], \"type\": \"image\", \"name\": \"glance\"}, {\"endpoints\": [{\"adminURL\": \"http://10.233.52.237:8776/v1/bea2e6e7c6d4468281b37f0281d90a65\", \"region\": \"RegionOne\", \"internalURL\": \"http://10.233.52.237:8776/v1/bea2e6e7c6d4468281b37f0281d90a65\", \"id\": \"40062dde5eef4d7091d8d2e034cc3858\", \"publicURL\": \"http://10.233.52.237:8776/v1/bea2e6e7c6d4468281b37f0281d90a65\"}], \"endpoints_links\": [], \"type\": \"volume\", \"name\": \"cinder\"}, {\"endpoints\": [{\"adminURL\": \"http://10.233.52.237:8773/services/Admin\", \"region\": \"RegionOne\", \"internalURL\": \"http://10.233.52.237:8773/services/Cloud\", \"id\": \"78ebfca16cad447aa000a54d915a139d\", \"publicURL\": \"http://10.233.52.237:8773/services/Cloud\"}], \"endpoints_links\": [], \"type\": \"ec2\", \"name\": \"ec2\"}, {\"endpoints\": [{\"adminURL\": \"http://10.233.52.237:35357/v2.0\", \"region\": \"RegionOne\", \"internalURL\": \"http://10.233.52.237:5000/v2.0\", \"id\": \"efec664ee9e746249325823b234e160e\", \"publicURL\": \"http://10.233.52.237:5000/v2.0\"}], \"endpoints_links\": [], \"type\": \"identity\", \"name\": \"keystone\"}], \"user\": {\"username\": \"admin\", \"roles_links\": [], \"id\": \"0161185b70ff4346ad8926f9c55a5b32\", \"roles\": [{\"name\": \"admin\"}, {\"name\": \"KeystoneAdmin\"}, {\"name\": \"KeystoneServiceAdmin\"}], \"name\": \"admin\"}, \"metadata\": {\"is_admin\": 0, \"roles\": [\"d103c99e801e4e8e97ab460197444c03\", \"60fc56ec2fcb48b4ad2b46e449fd4c16\", \"c66fcf4a4c22470186817b695a8aaa07\"]}}}\n\nREQ: curl -i http://10.233.52.237:8774/v2/bea2e6e7c6d4468281b37f0281d90a65//servers/a31aeecd-5237-4e1a-98b1-407164166c3a PUT -H \"X-Auth-Project-Id: admin\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/json\" -H \"X-Auth-Token: 0672b716683d4f21a4e46ad8846cc34c\"\n\nREQ: curl -i http://10.233.52.237:8774/v2/bea2e6e7c6d4468281b37f0281d90a65//servers/a31aeecd-5237-4e1a-98b1-407164166c3a PUT -H \"X-Auth-Project-Id: admin\" -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/json\" -H \"X-Auth-Token: 0672b716683d4f21a4e46ad8846cc34c\"\n\nREQ BODY: {\"server\": {\"name\": \"update_server_name&12!@#$%^&*()+_\"}}\n\nREQ BODY: {\"server\": {\"name\": \"update_server_name&12!@#$%^&*()+_\"}}\n\nRESP:{'date': 'Fri, 12 Oct 2012 14:16:10 GMT', 'status': '200', 'x-compute-request-id': 'req-81ae36ce-ab49-40fd-bca5-b4610fbc9292', 'content-type': 'application/json', 'content-length': '1141'} {\"server\": {\"status\": \"ACTIVE\", \"updated\": \"2012-10-12T14:15:05Z\", \"hostId\": \"1147ece833ec151ffa0e0de6a0bd615e7373391028ce084577510c68\", \"addresses\": {\"private\": [{\"version\": 4, \"addr\": \"10.0.0.5\"}]}, \"links\": [{\"href\": \"http://10.233.52.237:8774/v2/bea2e6e7c6d4468281b37f0281d90a65/servers/a31aeecd-5237-4e1a-98b1-407164166c3a\", \"rel\": \"self\"}, {\"href\": \"http://10.233.52.237:8774/bea2e6e7c6d4468281b37f0281d90a65/servers/a31aeecd-5237-4e1a-98b1-407164166c3a\", \"rel\": \"bookmark\"}], \"image\": {\"id\": \"15ddb4d5-5be1-4a83-b4e5-a54b9d83528b\", \"links\": [{\"href\": \"http://10.233.52.237:8774/bea2e6e7c6d4468281b37f0281d90a65/images/15ddb4d5-5be1-4a83-b4e5-a54b9d83528b\", \"rel\": \"bookmark\"}]}, \"flavor\": {\"id\": \"1\", \"links\": [{\"href\": \"http://10.233.52.237:8774/bea2e6e7c6d4468281b37f0281d90a65/flavors/1\", \"rel\": \"bookmark\"}]}, \"id\": \"a31aeecd-5237-4e1a-98b1-407164166c3a\", \"user_id\": \"0161185b70ff4346ad8926f9c55a5b32\", \"name\": \"update_server_name&12!@#$%^&*()+_\", \"created\": \"2012-10-12T14:14:49Z\", \"tenant_id\": \"bea2e6e7c6d4468281b37f0281d90a65\", \"OS-DCF:diskConfig\": \"MANUAL\", \"accessIPv4\": \"\", \"accessIPv6\": \"\", \"progress\": 0, \"metadata\": {}}}\n\nRESP:{'date': 'Fri, 12 Oct 2012 14:16:10 GMT', 'status': '200', 'x-compute-request-id': 'req-81ae36ce-ab49-40fd-bca5-b4610fbc9292', 'content-type': 'application/json', 'content-length': '1141'} {\"server\": {\"status\": \"ACTIVE\", \"updated\": \"2012-10-12T14:15:05Z\", \"hostId\": \"1147ece833ec151ffa0e0de6a0bd615e7373391028ce084577510c68\", \"addresses\": {\"private\": [{\"version\": 4, \"addr\": \"10.0.0.5\"}]}, \"links\": [{\"href\": \"http://10.233.52.237:8774/v2/bea2e6e7c6d4468281b37f0281d90a65/servers/a31aeecd-5237-4e1a-98b1-407164166c3a\", \"rel\": \"self\"}, {\"href\": \"http://10.233.52.237:8774/bea2e6e7c6d4468281b37f0281d90a65/servers/a31aeecd-5237-4e1a-98b1-407164166c3a\", \"rel\": \"bookmark\"}], \"image\": {\"id\": \"15ddb4d5-5be1-4a83-b4e5-a54b9d83528b\", \"links\": [{\"href\": \"http://10.233.52.237:8774/bea2e6e7c6d4468281b37f0281d90a65/images/15ddb4d5-5be1-4a83-b4e5-a54b9d83528b\", \"rel\": \"bookmark\"}]}, \"flavor\": {\"id\": \"1\", \"links\": [{\"href\": \"http://10.233.52.237:8774/bea2e6e7c6d4468281b37f0281d90a65/flavors/1\", \"rel\": \"bookmark\"}]}, \"id\": \"a31aeecd-5237-4e1a-98b1-407164166c3a\", \"user_id\": \"0161185b70ff4346ad8926f9c55a5b32\", \"name\": \"update_server_name&12!@#$%^&*()+_\", \"created\": \"2012-10-12T14:14:49Z\", \"tenant_id\": \"bea2e6e7c6d4468281b37f0281d90a65\", \"OS-DCF:diskConfig\": \"MANUAL\", \"accessIPv4\": \"\", \"accessIPv6\": \"\", \"progress\": 0, \"metadata\": {}}}\n\n--- START OF RESPONSE ---\n{   u'server': {   u'OS-DCF:diskConfig': u'MANUAL',\n                   u'accessIPv4': '',\n                   u'accessIPv6': '',\n                   u'addresses': {   u'private': [   {   u'addr': u'10.0.0.5',\n                                                         u'version': 4}]},\n                   u'created': u'2012-10-12T14:14:49Z',\n                   u'flavor': {   u'id': u'1',\n                                  u'links': [   {   u'href': u'http://10.233.52.237:8774/bea2e6e7c6d4468281b37f0281d90a65/flavors/1',\n                                                    u'rel': u'bookmark'}]},\n                   u'hostId': u'1147ece833ec151ffa0e0de6a0bd615e7373391028ce084577510c68',\n                   u'id': u'a31aeecd-5237-4e1a-98b1-407164166c3a',\n                   u'image': {   u'id': u'15ddb4d5-5be1-4a83-b4e5-a54b9d83528b',\n                                 u'links': [   {   u'href': u'http://10.233.52.237:8774/bea2e6e7c6d4468281b37f0281d90a65/images/15ddb4d5-5be1-4a83-b4e5-a54b9d83528b',\n                                                   u'rel': u'bookmark'}]},\n                   u'links': [   {   u'href': u'http://10.233.52.237:8774/v2/bea2e6e7c6d4468281b37f0281d90a65/servers/a31aeecd-5237-4e1a-98b1-407164166c3a',\n                                     u'rel': u'self'},\n                                 {   u'href': u'http://10.233.52.237:8774/bea2e6e7c6d4468281b37f0281d90a65/servers/a31aeecd-5237-4e1a-98b1-407164166c3a',\n                                     u'rel': u'bookmark'}],\n                   u'metadata': {   },\n                   u'name': u'update_server_name&12!@#$%^&*()+_',\n                   u'progress': 0,\n                   u'status': u'ACTIVE',\n                   u'tenant_id': u'bea2e6e7c6d4468281b37f0281d90a65',\n                   u'updated': u'2012-10-12T14:15:05Z',\n                   u'user_id': u'0161185b70ff4346ad8926f9c55a5b32'}}\n--- ENF OF RESPONSE ---\n[umamaheshk@HPOpenstackVM16 ~/source/csbu-qa-dev/nova/tests]$", 
            "date_created": "2012-10-12 09:04:48.730125+00:00", 
            "author": "https://api.launchpad.net/1.0/~rajalakshmi-ganesan"
        }, 
        {
            "content": "There's nothing in the doc [1] that says characters in \"&!@#$%^&*()+_\" are invalid. we throw Bad Request only under the following conditions [2]\r\n\r\n[1] http://docs.openstack.org/api/openstack-compute/1.1/content/ServerUpdate.html\r\n[2] validation code \r\n-------------------------------------------------------------------------------------\r\n    def _validate_server_name(self, value):\r\n        if not isinstance(value, basestring):\r\n            msg = _(\"Server name is not a string or unicode\")\r\n            raise exc.HTTPBadRequest(explanation=msg)\r\n\r\n        if not value.strip():\r\n            msg = _(\"Server name is an empty string\")\r\n            raise exc.HTTPBadRequest(explanation=msg)\r\n\r\n        if not len(value) < 256:\r\n            msg = _(\"Server name must be less than 256 characters.\")\r\n            raise exc.HTTPBadRequest(explanation=msg)\r\n-------------------------------------------------------------------------------------\r\n", 
            "date_created": "2012-10-25 01:32:53.542647+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }
    ]
}