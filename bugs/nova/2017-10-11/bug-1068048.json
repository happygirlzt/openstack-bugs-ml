{
    "status": "Invalid", 
    "last_updated": "2013-03-22 09:31:53.692184+00:00", 
    "description": "Migration of an instance between two Folsom Compute nodes more often than not results in failure.\n\nWhen attempting to migrate a VM with block_device_mapping=vda:ceph_volume destination compute node attempts to detach vda\n\nDestination host on failed migration: http://pastebin.com/3GRnZzkL\nSource host on failed migration: http://pastebin.com/dMann0vL\n\nAbout 4 attempts later, after no changes.\nDestination host on successful migration: http://pastebin.com/aSDN4Myn\nSource host on successful migration: http://pastebin.com/PW1LbeW8\n\n\nCommand being run:\n[admin:admin] root@openstack-control:~# nova live-migration 8c5cde28-904c-49ee-ac18-2885e87925b7 openstack-compute1\n\n\nInfo:\n[demo:demo] root@openstack-control:~# nova boot --flavor 1 --image 7c55a705-c642-4223-914a-44e777beb859 --key_name mykey --block_device_mapping vda=923f330d-a084-491d-a32b-b4e38ccc9ca1::10:0 l-vol-vm_1\n[demo:demo] root@openstack-control:~# nova boot --flavor 1 --image 7c55a705-c642-4223-914a-44e777beb859 --key_name mykey --block_device_mapping vda=bb9a9ae7-e3c6-43f6-9aae-2701e1543adc::10:0 l-vol-vm_2\n[demo:demo] root@openstack-control:~# nova boot --flavor 1 --image 7c55a705-c642-4223-914a-44e777beb859 --key_name mykey --block_device_mapping vda=74dcc66f-53fc-43ec-9f79-16e8442d4b5c::10:0 l-vol-vm_3\n\n[demo:demo] root@openstack-control:~# nova list\n+--------------------------------------+------------+-----------+-------------------+\n| ID                                   | Name       | Status    | Networks          |\n+--------------------------------------+------------+-----------+-------------------+\n| 050c406b-3a3b-41b3-85ae-7ab4765f8d6e | l-vol-vm_1 | ACTIVE    | demo-net=10.7.7.7 |\n| 8c5cde28-904c-49ee-ac18-2885e87925b7 | l-vol-vm_2 | ACTIVE    | demo-net=10.7.7.8 |\n| 1fb5935f-8ab0-4464-8eb7-35b355f3c2ad | l-vol-vm_3 | ACTIVE    | demo-net=10.7.7.3 |\n+--------------------------------------+------------+-----------+-------------------+\n\n[demo:demo] root@openstack-control:~# cinder list\n+--------------------------------------+-----------+------------------+------+-------------+--------------------------------------+\n|                  ID                  |   Status  |   Display Name   | Size | Volume Type |             Attached to              |\n+--------------------------------------+-----------+------------------+------+-------------+--------------------------------------+\n| 74dcc66f-53fc-43ec-9f79-16e8442d4b5c |   in-use  |  linux-vm_3-vol  |  10  |     None    | 1fb5935f-8ab0-4464-8eb7-35b355f3c2ad |\n| 923f330d-a084-491d-a32b-b4e38ccc9ca1 |   in-use  |  linux-vm_1-vol  |  10  |     None    | 050c406b-3a3b-41b3-85ae-7ab4765f8d6e |\n| bb9a9ae7-e3c6-43f6-9aae-2701e1543adc |   in-use  |  linux-vm_2-vol  |  10  |     None    | 8c5cde28-904c-49ee-ac18-2885e87925b7 |\n| ccb71b41-efdf-4ae3-8b3e-ccb299a378e5 | available | Linux-Master-Vol |  10  |     None    |                                      |\n+--------------------------------------+-----------+------------------+------+-------------+--------------------------------------+\n\n\nCompute nodes are both running:\nceph-common 0.53-1precise\nlibvirt-bin 0.9.8-2ubuntu17.4\nlibvirt0 0.9.8-2ubuntu17.4\nnova-common 2012.2+git201210091907~precise-0ubuntu1\nnova-compute 2012.2+git201210091907~precise-0ubuntu1\nnova-compute-kvm 2012.2+git201210091907~precise-0ubuntu1\nopenvswitch-common 1.4.0-1ubuntu1.3\nopenvswitch-datapath-dkms 1.4.0-1ubuntu1.3\nopenvswitch-switch 1.4.0-1ubuntu1.3\npython-libvirt 0.9.8-2ubuntu17.4\npython-nova 2012.2+git201210091907~precise-0ubuntu1\npython-novaclient 1:2.9.0.10+git201210101300~precise-0ubuntu1\npython-quantum 2012.2+git201209271425~precise-0ubuntu1\npython-quantumclient 1:2.1.1+git201209200900~precise-0ubuntu1\nquantum-common 2012.2+git201209271425~precise-0ubuntu1\nquantum-plugin-openvswitch 2012.2+git201209271425~precise-0ubuntu1\nquantum-plugin-openvswitch-agent 2012.2+git201209271425~precise-0ubuntu1\n\nControl node is running:\nceph-common 0.53-1precise\ncinder-api 2012.2+git201209252100~precise-0ubuntu1\ncinder-common 2012.2+git201209252100~precise-0ubuntu1\ncinder-scheduler 2012.2+git201209252100~precise-0ubuntu1\ncinder-volume 2012.2+git201209252100~precise-0ubuntu1\nglance 2012.2+git201209250330~precise-0ubuntu1\nglance-api 2012.2+git201209250330~precise-0ubuntu1\nglance-common 2012.2+git201209250330~precise-0ubuntu1\nglance-registry 2012.2+git201209250330~precise-0ubuntu1\nkeystone 2012.2+git201209252030~precise-0ubuntu1\nnova-api 2012.2+git201210091907~precise-0ubuntu1\nnova-cert 2012.2+git201210091907~precise-0ubuntu1\nnova-common 2012.2+git201210091907~precise-0ubuntu1\nnova-consoleauth 2012.2+git201210091907~precise-0ubuntu1\nnova-novncproxy 2012.2+git201210091907~precise-0ubuntu1\nnova-scheduler 2012.2+git201210091907~precise-0ubuntu1\nopenvswitch-common 1.4.0-1ubuntu1.3\nopenvswitch-datapath-dkms 1.4.0-1ubuntu1.3\nopenvswitch-datapath-module-3.2.0-32-generic 1.4.0-1ubuntu1.3\nopenvswitch-datapath-source 1.4.0-1ubuntu1.3\nopenvswitch-switch 1.4.0-1ubuntu1.3\npostgresql-9.1 9.1.6-0ubuntu12.04\npostgresql-client-9.1 9.1.6-0ubuntu12.04\npostgresql-client-common 129ubuntu1\npostgresql-common 129ubuntu1\npython-cinder 2012.2+git201209252100~precise-0ubuntu1\npython-cinderclient 1:1.0.0.1+git201210051400~precise-0ubuntu1\npython-glance 2012.2+git201209250330~precise-0ubuntu1\npython-glanceclient 1:0.5.1.8.cdc06d9+git201210051430~precise-0ubuntu1\npython-keystone 2012.2+git201209252030~precise-0ubuntu1\npython-keystoneclient 1:0.1.3.27+git201210122030~precise-0ubuntu1\npython-nova 2012.2+git201210091907~precise-0ubuntu1\npython-novaclient 1:2.9.0.10+git201210101300~precise-0ubuntu1\nquantum-plugin-openvswitch 2012.2+git201209271425~precise-0ubuntu1\nquantum-plugin-openvswitch-agent 2012.2+git201209271425~precise-0ubuntu1\nrabbitmq-server 2.7.1-0ubuntu4", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 22, 
    "link": "https://bugs.launchpad.net/nova/+bug/1068048", 
    "owner": "None", 
    "id": 1068048, 
    "index": 3151, 
    "created": "2012-10-18 09:42:36.302380+00:00", 
    "title": "nova live-migration with ceph backend attempts to detach vda", 
    "comments": [
        {
            "content": "Migration of an instance between two Folsom Compute nodes more often than not results in failure.\n\nWhen attempting to migrate a VM with block_device_mapping=vda:ceph_volume destination compute node attempts to detach vda\n\nDestination host on failed migration: http://pastebin.com/3GRnZzkL\nSource host on failed migration: http://pastebin.com/dMann0vL\n\nAbout 4 attempts later, after no changes.\nDestination host on successful migration: http://pastebin.com/aSDN4Myn\nSource host on successful migration: http://pastebin.com/PW1LbeW8\n\n\nCommand being run:\n[admin:admin] root@openstack-control:~# nova live-migration 8c5cde28-904c-49ee-ac18-2885e87925b7 openstack-compute1\n\n\nInfo:\n[demo:demo] root@openstack-control:~# nova boot --flavor 1 --image 7c55a705-c642-4223-914a-44e777beb859 --key_name mykey --block_device_mapping vda=923f330d-a084-491d-a32b-b4e38ccc9ca1::10:0 l-vol-vm_1\n[demo:demo] root@openstack-control:~# nova boot --flavor 1 --image 7c55a705-c642-4223-914a-44e777beb859 --key_name mykey --block_device_mapping vda=bb9a9ae7-e3c6-43f6-9aae-2701e1543adc::10:0 l-vol-vm_2\n[demo:demo] root@openstack-control:~# nova boot --flavor 1 --image 7c55a705-c642-4223-914a-44e777beb859 --key_name mykey --block_device_mapping vda=74dcc66f-53fc-43ec-9f79-16e8442d4b5c::10:0 l-vol-vm_3\n\n[demo:demo] root@openstack-control:~# nova list\n+--------------------------------------+------------+-----------+-------------------+\n| ID                                   | Name       | Status    | Networks          |\n+--------------------------------------+------------+-----------+-------------------+\n| 050c406b-3a3b-41b3-85ae-7ab4765f8d6e | l-vol-vm_1 | ACTIVE    | demo-net=10.7.7.7 |\n| 8c5cde28-904c-49ee-ac18-2885e87925b7 | l-vol-vm_2 | ACTIVE    | demo-net=10.7.7.8 |\n| 1fb5935f-8ab0-4464-8eb7-35b355f3c2ad | l-vol-vm_3 | ACTIVE    | demo-net=10.7.7.3 |\n+--------------------------------------+------------+-----------+-------------------+\n\n[demo:demo] root@openstack-control:~# cinder list\n+--------------------------------------+-----------+------------------+------+-------------+--------------------------------------+\n|                  ID                  |   Status  |   Display Name   | Size | Volume Type |             Attached to              |\n+--------------------------------------+-----------+------------------+------+-------------+--------------------------------------+\n| 74dcc66f-53fc-43ec-9f79-16e8442d4b5c |   in-use  |  linux-vm_3-vol  |  10  |     None    | 1fb5935f-8ab0-4464-8eb7-35b355f3c2ad |\n| 923f330d-a084-491d-a32b-b4e38ccc9ca1 |   in-use  |  linux-vm_1-vol  |  10  |     None    | 050c406b-3a3b-41b3-85ae-7ab4765f8d6e |\n| bb9a9ae7-e3c6-43f6-9aae-2701e1543adc |   in-use  |  linux-vm_2-vol  |  10  |     None    | 8c5cde28-904c-49ee-ac18-2885e87925b7 |\n| ccb71b41-efdf-4ae3-8b3e-ccb299a378e5 | available | Linux-Master-Vol |  10  |     None    |                                      |\n+--------------------------------------+-----------+------------------+------+-------------+--------------------------------------+\n\n\nCompute nodes are both running:\nceph-common 0.53-1precise\nlibvirt-bin 0.9.8-2ubuntu17.4\nlibvirt0 0.9.8-2ubuntu17.4\nnova-common 2012.2+git201210091907~precise-0ubuntu1\nnova-compute 2012.2+git201210091907~precise-0ubuntu1\nnova-compute-kvm 2012.2+git201210091907~precise-0ubuntu1\nopenvswitch-common 1.4.0-1ubuntu1.3\nopenvswitch-datapath-dkms 1.4.0-1ubuntu1.3\nopenvswitch-switch 1.4.0-1ubuntu1.3\npython-libvirt 0.9.8-2ubuntu17.4\npython-nova 2012.2+git201210091907~precise-0ubuntu1\npython-novaclient 1:2.9.0.10+git201210101300~precise-0ubuntu1\npython-quantum 2012.2+git201209271425~precise-0ubuntu1\npython-quantumclient 1:2.1.1+git201209200900~precise-0ubuntu1\nquantum-common 2012.2+git201209271425~precise-0ubuntu1\nquantum-plugin-openvswitch 2012.2+git201209271425~precise-0ubuntu1\nquantum-plugin-openvswitch-agent 2012.2+git201209271425~precise-0ubuntu1\n\nControl node is running:\nceph-common 0.53-1precise\ncinder-api 2012.2+git201209252100~precise-0ubuntu1\ncinder-common 2012.2+git201209252100~precise-0ubuntu1\ncinder-scheduler 2012.2+git201209252100~precise-0ubuntu1\ncinder-volume 2012.2+git201209252100~precise-0ubuntu1\nglance 2012.2+git201209250330~precise-0ubuntu1\nglance-api 2012.2+git201209250330~precise-0ubuntu1\nglance-common 2012.2+git201209250330~precise-0ubuntu1\nglance-registry 2012.2+git201209250330~precise-0ubuntu1\nkeystone 2012.2+git201209252030~precise-0ubuntu1\nnova-api 2012.2+git201210091907~precise-0ubuntu1\nnova-cert 2012.2+git201210091907~precise-0ubuntu1\nnova-common 2012.2+git201210091907~precise-0ubuntu1\nnova-consoleauth 2012.2+git201210091907~precise-0ubuntu1\nnova-novncproxy 2012.2+git201210091907~precise-0ubuntu1\nnova-scheduler 2012.2+git201210091907~precise-0ubuntu1\nopenvswitch-common 1.4.0-1ubuntu1.3\nopenvswitch-datapath-dkms 1.4.0-1ubuntu1.3\nopenvswitch-datapath-module-3.2.0-32-generic 1.4.0-1ubuntu1.3\nopenvswitch-datapath-source 1.4.0-1ubuntu1.3\nopenvswitch-switch 1.4.0-1ubuntu1.3\npostgresql-9.1 9.1.6-0ubuntu12.04\npostgresql-client-9.1 9.1.6-0ubuntu12.04\npostgresql-client-common 129ubuntu1\npostgresql-common 129ubuntu1\npython-cinder 2012.2+git201209252100~precise-0ubuntu1\npython-cinderclient 1:1.0.0.1+git201210051400~precise-0ubuntu1\npython-glance 2012.2+git201209250330~precise-0ubuntu1\npython-glanceclient 1:0.5.1.8.cdc06d9+git201210051430~precise-0ubuntu1\npython-keystone 2012.2+git201209252030~precise-0ubuntu1\npython-keystoneclient 1:0.1.3.27+git201210122030~precise-0ubuntu1\npython-nova 2012.2+git201210091907~precise-0ubuntu1\npython-novaclient 1:2.9.0.10+git201210101300~precise-0ubuntu1\nquantum-plugin-openvswitch 2012.2+git201209271425~precise-0ubuntu1\nquantum-plugin-openvswitch-agent 2012.2+git201209271425~precise-0ubuntu1\nrabbitmq-server 2.7.1-0ubuntu4", 
            "date_created": "2012-10-18 09:42:36.302380+00:00", 
            "author": "https://api.launchpad.net/1.0/~msymonds"
        }, 
        {
            "content": "This error on the source side:\n\n2012-10-18 09:58:13 ERROR nova.virt.libvirt.driver [-] [instance: 8c5cde28-904c-49ee-ac18-2885e87925b7] Live Migration failure: Unable to wait for child process: Bad file descriptor\n\nLooks like it's the root cause\n\nThe error is from libvirt - could you attach your libvirt logs? Maybe turning on libvirt debugging might help too", 
            "date_created": "2012-12-13 10:36:16.604730+00:00", 
            "author": "https://api.launchpad.net/1.0/~markmc"
        }, 
        {
            "content": "From bug #961217 it looks like upgrading to 0.9.8-2ubuntu17.5 might help", 
            "date_created": "2012-12-13 10:42:23.889300+00:00", 
            "author": "https://api.launchpad.net/1.0/~markmc"
        }, 
        {
            "content": "This bug lacks the necessary information to effectively reproduce and fix it, therefore it has been closed. Feel free to reopen the bug by providing the requested information and set the bug status back to ''New''.\n", 
            "date_created": "2013-03-18 11:38:14.416817+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "I have met the same error.\r\n\r\nand I try directly run libvirt command :\r\nvirsh migrate --live instance-00000782 qemu+ssh://root@compute-node-2/system --verbose\r\n\r\nIt works fine.", 
            "date_created": "2013-03-20 06:46:20.539829+00:00", 
            "author": "https://api.launchpad.net/1.0/~chen-li"
        }, 
        {
            "content": "my error is due to missing configuration about libvirt.", 
            "date_created": "2013-03-22 09:31:53.163198+00:00", 
            "author": "https://api.launchpad.net/1.0/~chen-li"
        }
    ]
}