{
    "status": "Fix Released", 
    "last_updated": "2011-02-07 13:57:06.612372+00:00", 
    "description": "I'm not sure why it doesn't happen with Python 2.6 (and it doesn't even seem to happen every time with python 2.7), but here's the traceback:\n\n\n======================================================================\nERROR: test_associate_disassociate_address (nova.tests.test_cloud.CloudTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/build/buildd/nova-2011.1~bzr549/nova/tests/test_cloud.py\", line 112, in test_associate_disassociate_address\n    public_ip=address)\n  File \"/build/buildd/nova-2011.1~bzr549/nova/api/ec2/cloud.py\", line 708, in associate_address\n    self.compute_api.associate_floating_ip(context, instance_id, public_ip)\n  File \"/build/buildd/nova-2011.1~bzr549/nova/compute/api.py\", line 500, in associate_floating_ip\n    instance['fixed_ip'])\n  File \"/build/buildd/nova-2011.1~bzr549/nova/network/api.py\", line 70, in associate_floating_ip\n    host = fixed_ip['network']['host']\n  File \"/build/buildd/nova-2011.1~bzr549/nova/db/sqlalchemy/models.py\", line 74, in __getitem__\n    return getattr(self, key)\n  File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 163, in __get__\n    instance_dict(instance))\n  File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 383, in get\n    value = callable_(passive=passive)\n  File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/strategies.py\", line 595, in __call__\n    (mapperutil.state_str(state), self.key)\nDetachedInstanceError: Parent instance <FixedIp at 0x97deaac> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed\n\n======================================================================\nFAIL: test_instance_update_state (nova.tests.test_cloud.CloudTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/build/buildd/nova-2011.1~bzr549/nova/tests/test_cloud.py\", line 263, in test_instance_update_state\n    self.assert_(len(rv['reservationSet']) == 0)\nAssertionError: False is not true\n\n======================================================================\nFAIL: test_run_terminate (nova.tests.test_compute.ComputeTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/build/buildd/nova-2011.1~bzr549/nova/tests/test_compute.py\", line 105, in test_run_terminate\n    self.assertEqual(len(instances), 1)\nAssertionError: 2 != 1\n\n\n\nThe last two are follow-on errors from the first (due to unclean data store afterwards).", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/701864", 
    "owner": "https://api.launchpad.net/1.0/~soren", 
    "id": 701864, 
    "index": 2237, 
    "created": "2011-01-12 11:28:24.893236+00:00", 
    "title": "nova.tests.test_cloud.CloudTestCase.test_associate_disassociate_address fails under python 2.7", 
    "comments": [
        {
            "content": "I'm not sure why it doesn't happen with Python 2.6 (and it doesn't even seem to happen every time with python 2.7), but here's the traceback:\n\n\n======================================================================\nERROR: test_associate_disassociate_address (nova.tests.test_cloud.CloudTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/build/buildd/nova-2011.1~bzr549/nova/tests/test_cloud.py\", line 112, in test_associate_disassociate_address\n    public_ip=address)\n  File \"/build/buildd/nova-2011.1~bzr549/nova/api/ec2/cloud.py\", line 708, in associate_address\n    self.compute_api.associate_floating_ip(context, instance_id, public_ip)\n  File \"/build/buildd/nova-2011.1~bzr549/nova/compute/api.py\", line 500, in associate_floating_ip\n    instance['fixed_ip'])\n  File \"/build/buildd/nova-2011.1~bzr549/nova/network/api.py\", line 70, in associate_floating_ip\n    host = fixed_ip['network']['host']\n  File \"/build/buildd/nova-2011.1~bzr549/nova/db/sqlalchemy/models.py\", line 74, in __getitem__\n    return getattr(self, key)\n  File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 163, in __get__\n    instance_dict(instance))\n  File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 383, in get\n    value = callable_(passive=passive)\n  File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/strategies.py\", line 595, in __call__\n    (mapperutil.state_str(state), self.key)\nDetachedInstanceError: Parent instance <FixedIp at 0x97deaac> is not bound to a Session; lazy load operation of attribute 'network' cannot proceed\n\n======================================================================\nFAIL: test_instance_update_state (nova.tests.test_cloud.CloudTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/build/buildd/nova-2011.1~bzr549/nova/tests/test_cloud.py\", line 263, in test_instance_update_state\n    self.assert_(len(rv['reservationSet']) == 0)\nAssertionError: False is not true\n\n======================================================================\nFAIL: test_run_terminate (nova.tests.test_compute.ComputeTestCase)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/build/buildd/nova-2011.1~bzr549/nova/tests/test_compute.py\", line 105, in test_run_terminate\n    self.assertEqual(len(instances), 1)\nAssertionError: 2 != 1\n\n\n\nThe last two are follow-on errors from the first (due to unclean data store afterwards).", 
            "date_created": "2011-01-12 11:28:24.893236+00:00", 
            "author": "https://api.launchpad.net/1.0/~soren"
        }
    ]
}