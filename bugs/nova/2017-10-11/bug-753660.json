{
    "status": "Fix Released", 
    "last_updated": "2011-09-22 13:35:16.659813+00:00", 
    "description": "Hi,\n\nA colleague of mine mentioned that Nova cannot work with Ruby RightAWS, and\nhere is result of our analysis.\n\nWhen RightAWS generates a Signature, it drops port number (e.g., ':8773'\nor ':443') from the given server_string. On the contrary, Python boto does not\ndrop it.\n\nActually, Amazon AWS accepts Signatures generated both with and without port\nnumbers. Therefore, Amazon AWS must be generating 2 Signatures for each\nrequest and pick one which matches with Signature with the given Request,\nI think. I heard that Eucalyptus also does like the above.\n\nThe below are some evidence logs. I got both of the log lines below using\neuca-describe-availability-zones and a simple RightAWS script issuing\nDescribeAvailabilityZones using exactly the same EC2_URL:\n\n  EC2_URL=\"http://192.168.138.135:8773/services/Cloud/\"\n\n1) boto (euca-describe-availability-zones) case\n\n2011-04-07 23:04:29,343 DEBUG nova.signer [-] string_to_sign: GET\n192.168.138.135:8773 *** NOTE(itoumsn): WITH PORT NUMBER  \":8773\" ***\n/services/Cloud/\nAWSAccessKeyId=admin%3Aadmin&Action=DescribeAvailabilityZones&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-04-07T14%3A04%3A28&Version=2009-11-30 from (pid=2307) _calc_signature_2 /home/itoumsn/nova/nova/auth/signer.py:144\n\n2) RightAWS case\n\n2011-04-07 23:05:10,544 DEBUG nova.signer [-] string_to_sign: GET\n192.168.138.135  *** NOTE(itoumsn): WITHOUT PORT NUMBER  \":8773\" ***\n/services/Cloud\nAWSAccessKeyId=admin%3Aadmin&Action=DescribeAvailabilityZones&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-04-07T14%3A05%3A10.000Z&Version=2008-12-01 from (pid=2307) _calc_signature_2 /home/itoumsn/nova/nova/auth/signer.py:144\n\n\nI wrote a patch for EC2 API authentication code retrying authentication\nusing server_string without port number on Signature un-match failure:\n\n  lp:~itoumsn/nova/enable-rightaws\n\n, and I would like to know thoughts of people on this issue.\n\n# Should I post a merge proposal right now...???\n\n-Masanori", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/753660", 
    "owner": "https://api.launchpad.net/1.0/~itohm", 
    "id": 753660, 
    "index": 2365, 
    "created": "2011-04-07 15:08:24.010146+00:00", 
    "title": "Cannot work with Nova using RightAWS", 
    "comments": [
        {
            "content": "Hi,\n\nA colleague of mine mentioned that Nova cannot work with Ruby RightAWS, and\nhere is result of our analysis.\n\nWhen RightAWS generates a Signature, it drops port number (e.g., ':8773'\nor ':443') from the given server_string. On the contrary, Python boto does not\ndrop it.\n\nActually, Amazon AWS accepts Signatures generated both with and without port\nnumbers. Therefore, Amazon AWS must be generating 2 Signatures for each\nrequest and pick one which matches with Signature with the given Request,\nI think. I heard that Eucalyptus also does like the above.\n\nThe below are some evidence logs. I got both of the log lines below using\neuca-describe-availability-zones and a simple RightAWS script issuing\nDescribeAvailabilityZones using exactly the same EC2_URL:\n\n  EC2_URL=\"http://192.168.138.135:8773/services/Cloud/\"\n\n1) boto (euca-describe-availability-zones) case\n\n2011-04-07 23:04:29,343 DEBUG nova.signer [-] string_to_sign: GET\n192.168.138.135:8773 *** NOTE(itoumsn): WITH PORT NUMBER  \":8773\" ***\n/services/Cloud/\nAWSAccessKeyId=admin%3Aadmin&Action=DescribeAvailabilityZones&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-04-07T14%3A04%3A28&Version=2009-11-30 from (pid=2307) _calc_signature_2 /home/itoumsn/nova/nova/auth/signer.py:144\n\n2) RightAWS case\n\n2011-04-07 23:05:10,544 DEBUG nova.signer [-] string_to_sign: GET\n192.168.138.135  *** NOTE(itoumsn): WITHOUT PORT NUMBER  \":8773\" ***\n/services/Cloud\nAWSAccessKeyId=admin%3Aadmin&Action=DescribeAvailabilityZones&SignatureMethod=HmacSHA256&SignatureVersion=2&Timestamp=2011-04-07T14%3A05%3A10.000Z&Version=2008-12-01 from (pid=2307) _calc_signature_2 /home/itoumsn/nova/nova/auth/signer.py:144\n\n\nI wrote a patch for EC2 API authentication code retrying authentication\nusing server_string without port number on Signature un-match failure:\n\n  lp:~itoumsn/nova/enable-rightaws\n\n, and I would like to know thoughts of people on this issue.\n\n# Should I post a merge proposal right now...???\n\n-Masanori", 
            "date_created": "2011-04-07 15:08:24.010146+00:00", 
            "author": "https://api.launchpad.net/1.0/~itohm"
        }
    ]
}