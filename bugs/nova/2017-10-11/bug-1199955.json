{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:56:29.827663+00:00", 
    "description": "Steps to reproduce:\nnova rescue <uuid>\n\n Error:\n[req-b38a1751-568c-4e05-b8f0-768af5c286d8 demo demo] [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02] Error trying to Rescue Instance\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02] Traceback (most recent call last):\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2189, in rescue_instance\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     rescue_image_meta, admin_password)\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 217, in rescue\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     self._vmops.rescue(context, instance, network_info, image_meta)\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 783, in rescue\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     self.spawn(context, instance, image_meta, network_info)\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 209, in spawn\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     _execute_create_vm()\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 205, in _execute_create_vm\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     self._session._wait_for_task(instance['uuid'], vm_create_task)\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 600, in _wait_for_task\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     ret_val = done.wait()\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 116, in wait\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     return hubs.get_hub().switch()\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 187, in switch\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     return self.greenlet.switch()\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02] NovaException: The name '84d69b6e-41db-498a-a8e0-de34c96c7c02' already exists.\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]", 
    "tags": [
        "vmware"
    ], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1199955", 
    "owner": "https://api.launchpad.net/1.0/~garyk", 
    "id": 1199955, 
    "index": 1155, 
    "created": "2013-07-10 19:44:04.254536+00:00", 
    "title": "VCDriver: Rescue broken for VCDriver", 
    "comments": [
        {
            "content": "Steps to reproduce:\nnova rescue <uuid>\n\n Error:\n[req-b38a1751-568c-4e05-b8f0-768af5c286d8 demo demo] [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02] Error trying to Rescue Instance\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02] Traceback (most recent call last):\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2189, in rescue_instance\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     rescue_image_meta, admin_password)\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 217, in rescue\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     self._vmops.rescue(context, instance, network_info, image_meta)\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 783, in rescue\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     self.spawn(context, instance, image_meta, network_info)\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 209, in spawn\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     _execute_create_vm()\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 205, in _execute_create_vm\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     self._session._wait_for_task(instance['uuid'], vm_create_task)\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 600, in _wait_for_task\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     ret_val = done.wait()\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 116, in wait\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     return hubs.get_hub().switch()\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 187, in switch\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]     return self.greenlet.switch()\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02] NovaException: The name '84d69b6e-41db-498a-a8e0-de34c96c7c02' already exists.\n [instance: 84d69b6e-41db-498a-a8e0-de34c96c7c02]", 
            "date_created": "2013-07-10 19:44:04.254536+00:00", 
            "author": "https://api.launchpad.net/1.0/~syerrapragada"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/39046", 
            "date_created": "2013-07-29 10:04:16.042013+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/39046\nCommitted: http://github.com/openstack/nova/commit/8db2f23a43cf8aff21d7ef07af742383c275dd76\nSubmitter: Jenkins\nBranch:    master\n\ncommit 8db2f23a43cf8aff21d7ef07af742383c275dd76\nAuthor: Gary Kotton <email address hidden>\nDate:   Mon Jul 29 03:02:03 2013 -0700\n\n    VMware: fix rescue/unrescue instance\n    \n    Fixes bug 1199955\n    \n    The problem is due to the way in which the VM's are named on vCenter.\n    That is, in Nova a VM has a name and a UUID. In vCenter the VM only\n    has a name. The VM name on vCenter is Nova's instance UUID. When the\n    rescue/unrescue operation takes place a new VM is spawned/destroyed.\n    The Nova VM has the name '<name>-rescue'. The problem is that the\n    new rescue name was not passed correctly to the vCenter, that is,\n    it should have been '<uuid>-rescue' but it was just '<uuid>'. This\n    caused the opertaion to fail as there is already a VM with that name\n    on vCenter. A new name should have been passed which is '<uuid>-rescue'.\n    \n    Change-Id: Icfe6e5021b29026788bec8f3526f94a8ec0a65e2\n", 
            "date_created": "2013-08-26 04:03:59.119325+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}