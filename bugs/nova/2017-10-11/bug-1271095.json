{
    "status": "Invalid", 
    "last_updated": "2014-01-21 09:38:00.206315+00:00", 
    "description": "this bug is invalid, sorry", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1271095", 
    "owner": "None", 
    "id": 1271095, 
    "index": 4491, 
    "created": "2014-01-21 09:23:11.954662+00:00", 
    "title": "nova-compute start failed because of instance_type not found", 
    "comments": [
        {
            "content": "I got this issue in my stable havana nova,\nthe reproduce steps are:\n1. create a new flavor\n2. boot an instance with this flavor\n3. delete the flavor\n4. restart the nova-compute service\n\nthe trace stack in compute.log:\n2014-01-21 17:03:58.395 45856 ERROR nova.openstack.common.threadgroup [-] Instance type 3537 could not be found.\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/threadgroup.py\", line 117, in wait\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     x.wait()\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/threadgroup.py\", line 49, in wait\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 168, in wait\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/eventlet/event.py\", line 116, in wait\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 187, in switch\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 194, in main\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     result = function(*args, **kwargs)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/service.py\", line 65, in run_service\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     service.start()\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 164, in start\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     self.manager.pre_start_hook()\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 963, in pre_start_hook\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     self.update_available_resource(nova.context.get_admin_context())\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 5617, in update_available_resource\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     rt.update_available_resource(context)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/lockutils.py\", line 246, in inner\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     return f(*args, **kwargs)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/compute/resource_tracker.py\", line 306, in update_available_resource\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     self._update_usage_from_instances(resources, instances)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/compute/resource_tracker.py\", line 637, in _update_usage_from_instances\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     self._update_usage_from_instance(resources, instance)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/compute/resource_tracker.py\", line 564, in _update_usage_from_instance\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     instance['instance_type_id'])\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/conductor/api.py\", line 110, in instance_type_get\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     return self._manager.instance_type_get(context, instance_type_id)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/utils.py\", line 1129, in wrapper\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     return func(*args, **kwargs)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/conductor/manager.py\", line 376, in instance_type_get\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     result = self.db.flavor_get(context, instance_type_id)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 1433, in flavor_get\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     return IMPL.flavor_get(context, id)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 128, in wrapper\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     return f(*args, **kwargs)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 4440, in flavor_get\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup     raise exception.InstanceTypeNotFound(instance_type_id=id)\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup InstanceTypeNotFound: Instance type 3537 could not be found.\n2014-01-21 17:03:58.395 45856 TRACE nova.openstack.common.threadgroup", 
            "date_created": "2014-01-21 09:23:11.954662+00:00", 
            "author": "https://api.launchpad.net/1.0/~hzwangpan"
        }
    ]
}