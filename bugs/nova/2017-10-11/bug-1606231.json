{
    "status": "Invalid", 
    "last_updated": "2016-09-14 19:47:59.031551+00:00", 
    "description": "Steps to reproduce:\n1. Get list of attached ports of instance:\nnova interface-list 42dd8b8b-b2bc-420e-96b6-958e9295b2d4\n+------------+--------------------------------------+--------------------------------------+-----------------------------------------------+-------------------+\n| Port State | Port ID                              | Net ID                               | IP addresses                                  | MAC Addr          |\n+------------+--------------------------------------+--------------------------------------+-----------------------------------------------+-------------------+\n| ACTIVE     | 512e6c8e-3829-4bbd-8731-c03e5d7f7639 | ccd0fd43-9cc3-4544-b17c-dfacd8fa4d14 | 10.1.0.6,fdea:fd32:11ff:0:f816:3eff:fed1:8a7c | 52:54:00:85:19:89 |\n+------------+--------------------------------------+--------------------------------------+-----------------------------------------------+-------------------+\n2. Show ironic port. it has vif_port_id in extra with id of neutron port:\nironic port-show 735fcaf5-145d-4125-8701-365c58c6b796\n+-----------------------+-----------------------------------------------------------+\n| Property              | Value                                                     |\n+-----------------------+-----------------------------------------------------------+\n| address               | 52:54:00:85:19:89                                         |\n| created_at            | 2016-07-20T13:15:23+00:00                                 |\n| extra                 | {u'vif_port_id': u'512e6c8e-3829-4bbd-8731-c03e5d7f7639'} |\n| local_link_connection |                                                           |\n| node_uuid             | 679fa8a9-066e-4166-ac1e-6e77af83e741                      |\n| pxe_enabled           |                                                           |\n| updated_at            | 2016-07-22T13:31:29+00:00                                 |\n| uuid                  | 735fcaf5-145d-4125-8701-365c58c6b796                      |\n+-----------------------+-----------------------------------------------------------+\n3. Delete neutron port:\nneutron port-delete 512e6c8e-3829-4bbd-8731-c03e5d7f7639\nDeleted port: 512e6c8e-3829-4bbd-8731-c03e5d7f7639\n4. It is done from interface list:\nnova interface-list 42dd8b8b-b2bc-420e-96b6-958e9295b2d4\n+------------+---------+--------+--------------+----------+\n| Port State | Port ID | Net ID | IP addresses | MAC Addr |\n+------------+---------+--------+--------------+----------+\n+------------+---------+--------+--------------+----------+\n5. ironic port still has vif_port_id with neutron's port id:\nironic port-show 735fcaf5-145d-4125-8701-365c58c6b796\n+-----------------------+-----------------------------------------------------------+\n| Property              | Value                                                     |\n+-----------------------+-----------------------------------------------------------+\n| address               | 52:54:00:85:19:89                                         |\n| created_at            | 2016-07-20T13:15:23+00:00                                 |\n| extra                 | {u'vif_port_id': u'512e6c8e-3829-4bbd-8731-c03e5d7f7639'} |\n| local_link_connection |                                                           |\n| node_uuid             | 679fa8a9-066e-4166-ac1e-6e77af83e741                      |\n| pxe_enabled           |                                                           |\n| updated_at            | 2016-07-22T13:31:29+00:00                                 |\n| uuid                  | 735fcaf5-145d-4125-8701-365c58c6b796                      |\n+-----------------------+-----------------------------------------------------------+\n\nThis can confuse when user wants to get list of unused ports of ironic node.\nvif_port_id should be removed after neutron port-delete.", 
    "tags": [
        "rfe"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1606231", 
    "owner": "None", 
    "id": 1606231, 
    "index": 6342, 
    "created": "2016-07-25 13:19:25.227787+00:00", 
    "title": "[RFE] Support nova virt interface attach/detach", 
    "comments": [
        {
            "content": "Steps to reproduce:\n1. Get list of attached ports of instance:\nnova interface-list 42dd8b8b-b2bc-420e-96b6-958e9295b2d4\n+------------+--------------------------------------+--------------------------------------+-----------------------------------------------+-------------------+\n| Port State | Port ID                              | Net ID                               | IP addresses                                  | MAC Addr          |\n+------------+--------------------------------------+--------------------------------------+-----------------------------------------------+-------------------+\n| ACTIVE     | 512e6c8e-3829-4bbd-8731-c03e5d7f7639 | ccd0fd43-9cc3-4544-b17c-dfacd8fa4d14 | 10.1.0.6,fdea:fd32:11ff:0:f816:3eff:fed1:8a7c | 52:54:00:85:19:89 |\n+------------+--------------------------------------+--------------------------------------+-----------------------------------------------+-------------------+\n2. Show ironic port. it has vif_port_id in extra with id of neutron port:\nironic port-show 735fcaf5-145d-4125-8701-365c58c6b796\n+-----------------------+-----------------------------------------------------------+\n| Property              | Value                                                     |\n+-----------------------+-----------------------------------------------------------+\n| address               | 52:54:00:85:19:89                                         |\n| created_at            | 2016-07-20T13:15:23+00:00                                 |\n| extra                 | {u'vif_port_id': u'512e6c8e-3829-4bbd-8731-c03e5d7f7639'} |\n| local_link_connection |                                                           |\n| node_uuid             | 679fa8a9-066e-4166-ac1e-6e77af83e741                      |\n| pxe_enabled           |                                                           |\n| updated_at            | 2016-07-22T13:31:29+00:00                                 |\n| uuid                  | 735fcaf5-145d-4125-8701-365c58c6b796                      |\n+-----------------------+-----------------------------------------------------------+\n3. Delete neutron port:\nneutron port-delete 512e6c8e-3829-4bbd-8731-c03e5d7f7639\nDeleted port: 512e6c8e-3829-4bbd-8731-c03e5d7f7639\n4. It is done from interface list:\nnova interface-list 42dd8b8b-b2bc-420e-96b6-958e9295b2d4\n+------------+---------+--------+--------------+----------+\n| Port State | Port ID | Net ID | IP addresses | MAC Addr |\n+------------+---------+--------+--------------+----------+\n+------------+---------+--------+--------------+----------+\n5. ironic port still has vif_port_id with neutron's port id:\nironic port-show 735fcaf5-145d-4125-8701-365c58c6b796\n+-----------------------+-----------------------------------------------------------+\n| Property              | Value                                                     |\n+-----------------------+-----------------------------------------------------------+\n| address               | 52:54:00:85:19:89                                         |\n| created_at            | 2016-07-20T13:15:23+00:00                                 |\n| extra                 | {u'vif_port_id': u'512e6c8e-3829-4bbd-8731-c03e5d7f7639'} |\n| local_link_connection |                                                           |\n| node_uuid             | 679fa8a9-066e-4166-ac1e-6e77af83e741                      |\n| pxe_enabled           |                                                           |\n| updated_at            | 2016-07-22T13:31:29+00:00                                 |\n| uuid                  | 735fcaf5-145d-4125-8701-365c58c6b796                      |\n+-----------------------+-----------------------------------------------------------+\n\nThis can confuse when user wants to get list of unused ports of ironic node.\nvif_port_id should be removed after neutron port-delete.", 
            "date_created": "2016-07-25 13:19:25.227787+00:00", 
            "author": "https://api.launchpad.net/1.0/~ashestakov"
        }, 
        {
            "content": "Same bug in neutron https://bugs.launchpad.net/neutron/+bug/1606229", 
            "date_created": "2016-07-26 14:50:05.894044+00:00", 
            "author": "https://api.launchpad.net/1.0/~ashestakov"
        }, 
        {
            "content": "Ok, thank you!\n", 
            "date_created": "2016-07-26 15:09:07.253661+00:00", 
            "author": "https://api.launchpad.net/1.0/~anton-kremenetsky"
        }, 
        {
            "content": "Hi Andrey, \nCould you clarify some points. \nThere are no notifications to Ironic server form Neutron after port deletion. At least I didn't see ones in the ironic-api log. Therefore I cannot continue working on this bug until you finish the fix https://review.openstack.org/#/c/346823/\n\nIs my understanding correct?", 
            "date_created": "2016-07-26 16:01:26.635936+00:00", 
            "author": "https://api.launchpad.net/1.0/~anton-kremenetsky"
        }, 
        {
            "content": "Notification should be passed to nova when port deleted:\nhttps://github.com/openstack/neutron/blob/master/neutron/notifiers/nova.py#L117\nhttps://github.com/openstack/neutron/blob/master/neutron/notifiers/nova.py#L145\nhttps://github.com/openstack/neutron/blob/master/neutron/notifiers/nova.py#L171\n\nAnd nova compute manager should process this event:\nhttps://github.com/openstack/nova/blob/master/nova/compute/manager.py#L6586\nand detach interface:\nhttps://github.com/openstack/nova/blob/master/nova/compute/manager.py#L6605\n\nCurrently this event sends only when deleting port of compute instances (and not of baremetal instances)\n\nAlso corresponding part of detach should be implemented on nova side:\nhttps://review.openstack.org/#/c/347410/", 
            "date_created": "2016-07-26 16:47:37.923290+00:00", 
            "author": "https://api.launchpad.net/1.0/~ashestakov"
        }, 
        {
            "content": "Hi Andrey,\nI've applied your nova patch that hasn't been accepted yet. It works fine on my side and it resolves this bug.\nDo you suppose that other changes should be added to Ironic?\nOtherwise I can mark the bug like an \"Invalid\" one.\nWhat do you think?\n", 
            "date_created": "2016-09-06 17:54:31.256588+00:00", 
            "author": "https://api.launchpad.net/1.0/~anton-kremenetsky"
        }, 
        {
            "content": "Sorry, but technically I don't see a bug here, rather some behaviour that should be modified, right?\n\nI mean, you're providing support for detaching an interface in the ironic driver, that's not a bug then.\n\nIf so, please follow the existing process where you should fill in a blueprint and ask for a spec-less implementation, that should be enough I guess.\nhttp://docs.openstack.org/developer/nova/process.html#how-do-i-get-my-code-merged\n", 
            "date_created": "2016-09-14 13:16:11.076318+00:00", 
            "author": "https://api.launchpad.net/1.0/~sylvain-bauza"
        }, 
        {
            "content": "In ironic, this is a duplicate of an RFE to do the same: https://bugs.launchpad.net/ironic/+bug/1582188", 
            "date_created": "2016-09-14 19:47:46.872969+00:00", 
            "author": "https://api.launchpad.net/1.0/~jim-rollenhagen"
        }
    ]
}