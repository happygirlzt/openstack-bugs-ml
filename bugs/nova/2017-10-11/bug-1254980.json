{
    "status": "Expired", 
    "last_updated": "2016-07-05 09:45:16.531570+00:00", 
    "description": "Updated time is null value in response body while updating \"availability_zone\" for aggregate only. \n\nThere are two tables \"aggregates\" and \"aggregate_metadata\",if you call the update_aggregate api to update the \"availability_zone\" for aggregate, the  tables \"aggregates\" hasn't been updated, so the updated_time is null value in response body  which get from tables \"aggregates\" .But for user, the aggregate is updated, why the updated_time is null?\n\nAlso, get and list has the same problem.\n\nI think it's a bug.", 
    "tags": [
        "api"
    ], 
    "importance": "Undecided", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1254980", 
    "owner": "None", 
    "id": 1254980, 
    "index": 4321, 
    "created": "2013-11-26 07:06:10.520016+00:00", 
    "title": "Fix null value for updated time ", 
    "comments": [
        {
            "content": "Updated time is null value in response body while updating \"availability_zone\" for aggregate only. \n\nThere are two tables \"aggregates\" and \"aggregate_metadata\",if you call the update_aggregate api to update the \"availability_zone\" for aggregate, the  tables \"aggregates\" hasn't been updated, so the updated_time is null value in response body  which get from tables \"aggregates\" .But for user, the aggregate is updated, why the updated_time is null?\n\nAlso, get and list has the same problem.\n\nI think it's a bug.", 
            "date_created": "2013-11-26 07:06:10.520016+00:00", 
            "author": "https://api.launchpad.net/1.0/~huangtianhua"
        }, 
        {
            "content": "This is another case where we're returning these timestamps directly from the db, but they don't always make sense in the API.  As you describe, there's multiple tables on the backend, but from the user perspective, the aggregate was updated, and the APi should reflect that, IMO.", 
            "date_created": "2014-02-08 21:21:05.198462+00:00", 
            "author": "https://api.launchpad.net/1.0/~russellb"
        }, 
        {
            "content": "Thanks.\nI will modify this.", 
            "date_created": "2014-02-11 04:01:16.715953+00:00", 
            "author": "https://api.launchpad.net/1.0/~huangtianhua"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/72859", 
            "date_created": "2014-02-12 07:22:50.076828+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Hi Russell Bryant:\n\nWould you please to review this patch.\nThanks very much.", 
            "date_created": "2014-02-13 01:29:19.646226+00:00", 
            "author": "https://api.launchpad.net/1.0/~huangtianhua"
        }, 
        {
            "content": "Huangtianhua,\n\nThe associated patch for this has been abandoned. Do you still plan to continue work on this? If not, please unassign yourself on the bug and set the status back to Confirmed, please! Thanks!\n\n-jay", 
            "date_created": "2014-07-23 00:11:59.380370+00:00", 
            "author": "https://api.launchpad.net/1.0/~jaypipes"
        }, 
        {
            "content": "I can work on it .. might need some pointers", 
            "date_created": "2015-01-20 17:11:55.014022+00:00", 
            "author": "https://api.launchpad.net/1.0/~nutshi"
        }, 
        {
            "content": "What should be steps of reproduction for this ?\n\ni tried :- \n\n1)  nova aggregate-create  new 1\n2)  nova --debug aggregate-update new1 new2 4 \n\nand the response i get is this ( i can see the updates_at correclty its not NULL) :- \n\n\n\n\nREQ: curl -i 'http://172.30.178.143:5000/v2.0/tokens' -X POST -H \"Accept: application/json\" -H \"Content-Type: application/json\" -H \"User-Agent: python-novaclient\" -d '{\"auth\": {\"tenantName\": \"admin\", \"passwordCredentials\": {\"username\": \"admin\", \"password\": \"{SHA1}3ebccd10704df17bc0dfd839372586ec9f1812c0\"}}}'\nINFO (connectionpool:258) Starting new HTTP connection (1): 172.30.178.143\nDEBUG (connectionpool:375) Setting read timeout to 600.0\nDEBUG (connectionpool:415) \"POST /v2.0/tokens HTTP/1.1\" 200 3963\nRESP: [200] CaseInsensitiveDict({'date': 'Wed, 21 Jan 2015 20:55:49 GMT', 'vary': 'X-Auth-Token', 'content-length': '3963', 'content-type': 'application/json', 'server': 'Apache/2.4.7 (Ubuntu)'})\nRESP BODY: {\"access\": {\"token\": {\"issued_at\": \"2015-01-21T20:55:49.672336\", \"expires\": \"2015-01-21T21:55:49Z\", \"id\": \"{SHA1}886b8bdac63d3fe3d5a6c5c9c409dcd1beb39137\", \"tenant\": {\"parent_id\": null, \"enabled\": true, \"description\": null, \"name\": \"admin\", \"id\": \"2602402def694ba182612e6bca999494\"}, \"audit_ids\": [\"sYsaIc7YT0WXTDQf-elREg\"]}, \"serviceCatalog\": [{\"endpoints_links\": [], \"endpoints\": [{\"adminURL\": \"http://172.30.178.143:8774/v2/2602402def694ba182612e6bca999494\", \"region\": \"RegionOne\", \"publicURL\": \"http://172.30.178.143:8774/v2/2602402def694ba182612e6bca999494\", \"internalURL\": \"http://172.30.178.143:8774/v2/2602402def694ba182612e6bca999494\", \"id\": \"5228d5d3b1284a41bb6f4ca7850c6c69\"}], \"type\": \"compute\", \"name\": \"nova\"}, {\"endpoints_links\": [], \"endpoints\": [{\"adminURL\": \"http://172.30.178.143:8004/v1/2602402def694ba182612e6bca999494\", \"region\": \"RegionOne\", \"publicURL\": \"http://172.30.178.143:8004/v1/2602402def694ba182612e6bca999494\", \"internalURL\": \"http://172.30.178.143:8004/v1/2602402def694ba182612e6bca999494\", \"id\": \"4da68614b8a5462397f94fd5744512ae\"}], \"type\": \"orchestration\", \"name\": \"heat\"}, {\"endpoints_links\": [], \"endpoints\": [{\"adminURL\": \"http://172.30.178.143:8776/v2/2602402def694ba182612e6bca999494\", \"region\": \"RegionOne\", \"publicURL\": \"http://172.30.178.143:8776/v2/2602402def694ba182612e6bca999494\", \"internalURL\": \"http://172.30.178.143:8776/v2/2602402def694ba182612e6bca999494\", \"id\": \"445ac8827aef435d8de4f381fd1f51a3\"}], \"type\": \"volumev2\", \"name\": \"cinderv2\"}, {\"endpoints_links\": [], \"endpoints\": [{\"adminURL\": \"http://172.30.178.143:3333\", \"region\": \"RegionOne\", \"publicURL\": \"http://172.30.178.143:3333\", \"internalURL\": \"http://172.30.178.143:3333\", \"id\": \"3cebf810143b440d9044bd511d66c95a\"}], \"type\": \"s3\", \"name\": \"s3\"}, {\"endpoints_links\": [], \"endpoints\": [{\"adminURL\": \"http://172.30.178.143:9292\", \"region\": \"RegionOne\", \"publicURL\": \"http://172.30.178.143:9292\", \"internalURL\": \"http://172.30.178.143:9292\", \"id\": \"2b5740ee72f24191aa23e158ffd71b7f\"}], \"type\": \"image\", \"name\": \"glance\"}, {\"endpoints_links\": [], \"endpoints\": [{\"adminURL\": \"http://172.30.178.143:8000/v1\", \"region\": \"RegionOne\", \"publicURL\": \"http://172.30.178.143:8000/v1\", \"internalURL\": \"http://172.30.178.143:8000/v1\", \"id\": \"041cb95b2dd248c6be7b3af33b507623\"}], \"type\": \"cloudformation\", \"name\": \"heat-cfn\"}, {\"endpoints_links\": [], \"endpoints\": [{\"adminURL\": \"http://172.30.178.143:8776/v1/2602402def694ba182612e6bca999494\", \"region\": \"RegionOne\", \"publicURL\": \"http://172.30.178.143:8776/v1/2602402def694ba182612e6bca999494\", \"internalURL\": \"http://172.30.178.143:8776/v1/2602402def694ba182612e6bca999494\", \"id\": \"305373a9ac04483ca78fc576ee4b8358\"}], \"type\": \"volume\", \"name\": \"cinder\"}, {\"endpoints_links\": [], \"endpoints\": [{\"adminURL\": \"http://172.30.178.143:8773/services/Admin\", \"region\": \"RegionOne\", \"publicURL\": \"http://172.30.178.143:8773/services/Cloud\", \"internalURL\": \"http://172.30.178.143:8773/services/Cloud\", \"id\": \"3358c1eb009f4890a1de115ac433c1ef\"}], \"type\": \"ec2\", \"name\": \"ec2\"}, {\"endpoints_links\": [], \"endpoints\": [{\"adminURL\": \"http://172.30.178.143:8774/v2.1/2602402def694ba182612e6bca999494\", \"region\": \"RegionOne\", \"publicURL\": \"http://172.30.178.143:8774/v2.1/2602402def694ba182612e6bca999494\", \"internalURL\": \"http://172.30.178.143:8774/v2.1/2602402def694ba182612e6bca999494\", \"id\": \"90f8406404d54d49b4b2eddec5663b8a\"}], \"type\": \"computev21\", \"name\": \"novav21\"}, {\"endpoints_links\": [], \"endpoints\": [{\"adminURL\": \"http://172.30.178.143:35357/v2.0\", \"region\": \"RegionOne\", \"publicURL\": \"http://172.30.178.143:5000/v2.0\", \"internalURL\": \"http://172.30.178.143:5000/v2.0\", \"id\": \"0421136042ee42ba9c0cb7443b7a6092\"}], \"type\": \"identity\", \"name\": \"keystone\"}], \"user\": {\"username\": \"admin\", \"roles_links\": [], \"id\": \"9b87a650dd7e483bbbded864f11cff92\", \"roles\": [{\"name\": \"_member_\"}, {\"name\": \"admin\"}], \"name\": \"admin\"}, \"metadata\": {\"is_admin\": 0, \"roles\": [\"9fe2ff9ee4384b1894a90878d3e92bab\", \"0185cbc70f244e2db9dd1c5bb1b4cb66\"]}}}\n\nREQ: curl -i 'http://172.30.178.143:8774/v2/2602402def694ba182612e6bca999494/os-aggregates' -X GET -H \"Accept: application/json\" -H \"User-Agent: python-novaclient\" -H \"X-Auth-Project-Id: admin\" -H \"X-Auth-Token: {SHA1}886b8bdac63d3fe3d5a6c5c9c409dcd1beb39137\"\nINFO (connectionpool:258) Starting new HTTP connection (1): 172.30.178.143\nDEBUG (connectionpool:375) Setting read timeout to 600.0\nDEBUG (connectionpool:415) \"GET /v2/2602402def694ba182612e6bca999494/os-aggregates HTTP/1.1\" 200 276\nRESP: [200] CaseInsensitiveDict({'date': 'Wed, 21 Jan 2015 20:55:49 GMT', 'content-length': '276', 'content-type': 'application/json', 'x-compute-request-id': 'req-a46d7626-80cb-4c6a-832b-c2852eeb5b18'})\nRESP BODY: {\"aggregates\": [{\"name\": \"new1\", \"availability_zone\": \"4\", \"deleted\": false, \"created_at\": \"2015-01-21T20:20:43.000000\", \"updated_at\": \"2015-01-21T20:55:31.000000\", \"hosts\": [], \"deleted_at\": null, \"id\": 1, \"metadata\": {\"key1\": \"my2\", \"key\": \"my\", \"availability_zone\": \"4\"}}]}\n\nREQ: curl -i 'http://172.30.178.143:8774/v2/2602402def694ba182612e6bca999494/os-aggregates' -X GET -H \"Accept: application/json\" -H \"User-Agent: python-novaclient\" -H \"X-Auth-Project-Id: admin\" -H \"X-Auth-Token: {SHA1}886b8bdac63d3fe3d5a6c5c9c409dcd1beb39137\"\nINFO (connectionpool:258) Starting new HTTP connection (1): 172.30.178.143\nDEBUG (connectionpool:375) Setting read timeout to 600.0\nDEBUG (connectionpool:415) \"GET /v2/2602402def694ba182612e6bca999494/os-aggregates HTTP/1.1\" 200 276\nRESP: [200] CaseInsensitiveDict({'date': 'Wed, 21 Jan 2015 20:55:49 GMT', 'content-length': '276', 'content-type': 'application/json', 'x-compute-request-id': 'req-b49a4160-3991-41d9-a3e3-3d95ce2b8a63'})\nRESP BODY: {\"aggregates\": [{\"name\": \"new1\", \"availability_zone\": \"4\", \"deleted\": false, \"created_at\": \"2015-01-21T20:20:43.000000\", \"updated_at\": \"2015-01-21T20:55:31.000000\", \"hosts\": [], \"deleted_at\": null, \"id\": 1, \"metadata\": {\"key1\": \"my2\", \"key\": \"my\", \"availability_zone\": \"4\"}}]}\n\nREQ: curl -i 'http://172.30.178.143:8774/v2/2602402def694ba182612e6bca999494/os-aggregates/1' -X PUT -H \"Accept: application/json\" -H \"Content-Type: application/json\" -H \"User-Agent: python-novaclient\" -H \"X-Auth-Project-Id: admin\" -H \"X-Auth-Token: {SHA1}886b8bdac63d3fe3d5a6c5c9c409dcd1beb39137\" -d '{\"aggregate\": {\"name\": \"new2\", \"availability_zone\": \"4\"}}'\nINFO (connectionpool:258) Starting new HTTP connection (1): 172.30.178.143\nDEBUG (connectionpool:375) Setting read timeout to 600.0\nDEBUG (connectionpool:415) \"PUT /v2/2602402def694ba182612e6bca999494/os-aggregates/1 HTTP/1.1\" 200 273\nRESP: [200] CaseInsensitiveDict({'date': 'Wed, 21 Jan 2015 20:55:50 GMT', 'content-length': '273', 'content-type': 'application/json', 'x-compute-request-id': 'req-7406663f-6f95-4d6a-8f47-e24857000467'})\nRESP BODY: {\"aggregate\": {\"name\": \"new2\", \"availability_zone\": \"4\", \"deleted\": false, \"created_at\": \"2015-01-21T20:20:43.000000\", \"updated_at\": \"2015-01-21T20:55:49.000000\", \"hosts\": [], \"deleted_at\": null, \"id\": 1, \"metadata\": {\"key1\": \"my2\", \"key\": \"my\", \"availability_zone\": \"4\"}}}\n\nAggregate 1 has been successfully updated.\n+----+------+-------------------+-------+---------------------------------------------+\n| Id | Name | Availability Zone | Hosts | Metadata                                    |\n+----+------+-------------------+-------+---------------------------------------------+\n| 1  | new2 | 4                 |       | 'availability_zone=4', 'key=my', 'key1=my2' |\n+----+------+-------------------+-------+---------------------------------------------+\n\n", 
            "date_created": "2015-01-21 20:57:42.689298+00:00", 
            "author": "https://api.launchpad.net/1.0/~nutshi"
        }, 
        {
            "content": "i meant \n\nWhat should be steps of reproduction for this ?\n\ni tried :-\n\n1) nova aggregate-create new 1\n2) nova --debug aggregate-update new1 new2 4\n\nand in the response (when i use --debug)  i can see the updates_at set correclty its not NULL) :-\n\n\nRESP: [200] CaseInsensitiveDict({'date': 'Wed, 21 Jan 2015 20:55:50 GMT', 'content-length': '273', 'content-type': 'application/json', 'x-compute-request-id': 'req-7406663f-6f95-4d6a-8f47-e24857000467'})\nRESP BODY: {\"aggregate\": {\"name\": \"new2\", \"availability_zone\": \"4\", \"deleted\": false, \"created_at\": \"2015-01-21T20:20:43.000000\", \"updated_at\": \"2015-01-21T20:55:49.000000\", \"hosts\": [], \"deleted_at\": null, \"id\": 1, \"metadata\": {\"key1\": \"my2\", \"key\": \"my\", \"availability_zone\": \"4\"}}}\n\n\nAggregate 1 has been successfully updated.\n+----+------+-------------------+-------+---------------------------------------------+\n| Id | Name | Availability Zone | Hosts | Metadata |\n+----+------+-------------------+-------+---------------------------------------------+\n| 1 | new2 | 4 | | 'availability_zone=4', 'key=my', 'key1=my2' |\n+----+------+-------------------+-------+---------------------------------------------+", 
            "date_created": "2015-01-21 21:43:57.589115+00:00", 
            "author": "https://api.launchpad.net/1.0/~nutshi"
        }, 
        {
            "content": "There is no longer a reproduce for this, marking as incomplete", 
            "date_created": "2016-02-12 13:50:03.896517+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "This is bug is still there, steps to reproduce:\n\n$ nova aggregate-create fast-mem\n\n$ nova aggregate-list\n+----+----------+-------------------+\n| Id | Name     | Availability Zone |\n+----+----------+-------------------+\n| 2  | fast-io  | nova              |\n| 3  | fast-mem | -                 |\n+----+----------+-------------------+\n\n$ nova --debug  aggregate-set-metadata fast-mem availability_zone=nova\nDEBUG (session:198) REQ: curl -g -i -X POST http://192.168.2.19:8774/v2.1/2bf6e5aebee849d7a374e732c1c0038a/os-aggregates/3/action -H \"User-Agent: python-novaclient\" -H \"Content-Type: application/json\" -H \"Accept: application/json\" -H \"X-OpenStack-Nova-API-Version: 2.6\" -H \"X-Auth-Token: {SHA1}c099aea4aa1adeab284853da4a3d1d76af474f34\" -d '{\"set_metadata\": {\"metadata\": {\"availability_zone\": \"nova\"}}}'\nDEBUG (connectionpool:387) \"POST /v2.1/2bf6e5aebee849d7a374e732c1c0038a/os-aggregates/3/action HTTP/1.1\" 200 231\nDEBUG (session:216) RESP: [200] Content-Length: 231 X-Compute-Request-Id: req-aa455149-48ae-4b87-85ff-e1c9e70a2ad4 Vary: X-OpenStack-Nova-API-Version Connection: keep-alive X-Openstack-Nova-Api-Version: 2.6 Date: Thu, 25 Feb 2016 02:34:09 GMT Content-Type: application/json \nRESP BODY: {\"aggregate\": {\"name\": \"fast-mem\", \"availability_zone\": \"nova\", \"deleted\": false, \"created_at\": \"2016-02-25T02:32:08.000000\", \"updated_at\": null, \"hosts\": [], \"deleted_at\": null, \"id\": 3, \"metadata\": {\"availability_zone\": \"nova\"}}}\n", 
            "date_created": "2016-02-25 02:46:56.722192+00:00", 
            "author": "https://api.launchpad.net/1.0/~yuntongjin"
        }, 
        {
            "content": "This bug report has an assignee for over 1 month and there is no patch\nfor that. It looks like that the chance of getting a patch is low. \nI'm going to remove the assignee to signal to others that they can take\nover if they like.\n\nIf you want to work on this, please:\n* add yourself as assignee AND \n* set the status to \"In Progress\" AND\n* provide a (WIP) patch within the next 2 weeks after that. \n\nIf you need assistance, reach out on the IRC channel #openstack-nova or \nuse the mailing list.", 
            "date_created": "2016-04-18 11:44:52.105384+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "\nThis is an automated cleanup. This bug report has been closed because it\nis older than 18 months and there is no open code change to fix this.\nAfter this time it is unlikely that the circumstances which lead to\nthe observed issue can be reproduced.\n\nIf you can reproduce the bug, please:\n* reopen the bug report (set to status \"New\")\n* AND add the detailed steps to reproduce the issue (if applicable)\n* AND leave a comment \"CONFIRMED FOR: <RELEASE_NAME>\"\n  Only still supported release names are valid (LIBERTY, MITAKA, OCATA, NEWTON).\n  Valid example: CONFIRMED FOR: LIBERTY\n", 
            "date_created": "2016-07-05 09:45:15.743180+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }
    ]
}