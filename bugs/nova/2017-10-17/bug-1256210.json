{
    "status": "Fix Released", 
    "last_updated": "2014-04-17 08:53:52.356925+00:00", 
    "description": "Looks like there is a timing issue with  nova.tests.integrated.v3.test_shelve.ShelveXmlTest.test_shelve_offload\n\nINFO [nova.tests.integrated.api.client] Doing POST on /v3/servers\nINFO [nova.tests.integrated.api.client] Body: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<server xmlns=\"http://docs.openstack.org/compute/api/v1.1\" image_ref=\"http://glance.openstack.example.com/openstack/images/70a599e0-31e7-49b7-b260-868f441e862b\" flavor_ref=\"http://openstack.example.com/flavors/1\" name=\"new-server-test\">\n  <metadata>\n    <meta key=\"My Server Name\">Apache1</meta>\n  </metadata>\n  <personality>\n    <file path=\"/etc/banner.txt\">\n        ICAgICAgDQoiQSBjbG91ZCBkb2VzIG5vdCBrbm93IHdoeSBp\n        dCBtb3ZlcyBpbiBqdXN0IHN1Y2ggYSBkaXJlY3Rpb24gYW5k\n        IGF0IHN1Y2ggYSBzcGVlZC4uLkl0IGZlZWxzIGFuIGltcHVs\n        c2lvbi4uLnRoaXMgaXMgdGhlIHBsYWNlIHRvIGdvIG5vdy4g\n        QnV0IHRoZSBza3kga25vd3MgdGhlIHJlYXNvbnMgYW5kIHRo\n        ZSBwYXR0ZXJucyBiZWhpbmQgYWxsIGNsb3VkcywgYW5kIHlv\n        dSB3aWxsIGtub3csIHRvbywgd2hlbiB5b3UgbGlmdCB5b3Vy\n        c2VsZiBoaWdoIGVub3VnaCB0byBzZWUgYmV5b25kIGhvcml6\n        b25zLiINCg0KLVJpY2hhcmQgQmFjaA==\n    </file>\n  </personality>\n</server>\nINFO [nova.osapi_compute.wsgi.server] (9819) accepted ('127.0.0.1', 44341)\n\nAUDIT [nova.compute.manager] Starting instance...\nAUDIT [nova.compute.claims] Attempting claim: memory 512 MB, disk 1 GB, VCPUs 1\nAUDIT [nova.compute.claims] Total Memory: 8192 MB, used: 512.00 MB\nAUDIT [nova.compute.claims] Memory limit not specified, defaulting to unlimited\nAUDIT [nova.compute.claims] Total Disk: 1028 GB, used: 0.00 GB\nAUDIT [nova.compute.claims] Disk limit not specified, defaulting to unlimited\nAUDIT [nova.compute.claims] Total CPU: 1 VCPUs, used: 0.00 VCPUs\nAUDIT [nova.compute.claims] CPU limit not specified, defaulting to unlimited\nAUDIT [nova.compute.claims] Claim successful\nINFO [nova.osapi_compute.wsgi.server] 127.0.0.1 \"POST /v3/servers HTTP/1.1\" status: 202 len: 712 time: 1.0159640\n\nINFO [nova.tests.integrated.api.client] Doing POST on /v3/servers/67640a75-d7cd-4d96-91a4-b26e28485aa0/action\nINFO [nova.tests.integrated.api.client] Body: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <shelve/>\nINFO [nova.osapi_compute.wsgi.server] (9819) accepted ('127.0.0.1', 44348)\n\nINFO [nova.osapi_compute.wsgi.server] 127.0.0.1 \"POST /v3/servers/67640a75-d7cd-4d96-91a4-b26e28485aa0/action HTTP/1.1\" status: 202 len: 185 time: 0.3799698\n\nINFO [nova.tests.integrated.api.client] Doing POST on /v3/servers/67640a75-d7cd-4d96-91a4-b26e28485aa0/action\nINFO [nova.tests.integrated.api.client] Body: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <shelve_offload/>\nINFO [nova.osapi_compute.wsgi.server] (9819) accepted ('127.0.0.1', 44350)\n\nINFO [nova.api.openstack.wsgi] HTTP exception thrown: Cannot 'shelve_offload' while instance is in vm_state shelved_offloaded\nINFO [nova.osapi_compute.wsgi.server] 127.0.0.1 \"POST /v3/servers/67640a75-d7cd-4d96-91a4-b26e28485aa0/action HTTP/1.1\" status: 409 len: 386 time: 0.0510960\n\nINFO [nova.wsgi] Stopping WSGI server.\n}}}\n\nTraceback (most recent call last):\n  File \"nova/tests/integrated/v3/test_shelve.py\", line 46, in test_shelve_offload\n    self._test_server_action(uuid, 'shelve_offload')\n  File \"nova/tests/integrated/v3/test_shelve.py\", line 36, in _test_server_action\n    self.assertEqual(response.status, 202)\n  File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 322, in assertEqual\n    self.assertThat(observed, matcher, message)\n  File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 412, in assertThat\n    raise MismatchError(matchee, matcher, mismatch, verbose)\nMismatchError: 409 != 202\n\nFull logs here:\n\nhttp://logs.openstack.org/66/55766/3/gate/gate-nova-python27/8a3f3bc/testr_results.html.gz", 
    "tags": [
        "api"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1256210", 
    "owner": "https://api.launchpad.net/1.0/~cyeoh-0", 
    "id": 1256210, 
    "index": 5609, 
    "openned": "2013-11-29 06:38:20.110398+00:00", 
    "created": "2013-11-29 06:38:20.110398+00:00", 
    "title": "shelve unittest flakey fail", 
    "comments": [
        {
            "content": "Looks like there is a timing issue with  nova.tests.integrated.v3.test_shelve.ShelveXmlTest.test_shelve_offload\n\nINFO [nova.tests.integrated.api.client] Doing POST on /v3/servers\nINFO [nova.tests.integrated.api.client] Body: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<server xmlns=\"http://docs.openstack.org/compute/api/v1.1\" image_ref=\"http://glance.openstack.example.com/openstack/images/70a599e0-31e7-49b7-b260-868f441e862b\" flavor_ref=\"http://openstack.example.com/flavors/1\" name=\"new-server-test\">\n  <metadata>\n    <meta key=\"My Server Name\">Apache1</meta>\n  </metadata>\n  <personality>\n    <file path=\"/etc/banner.txt\">\n        ICAgICAgDQoiQSBjbG91ZCBkb2VzIG5vdCBrbm93IHdoeSBp\n        dCBtb3ZlcyBpbiBqdXN0IHN1Y2ggYSBkaXJlY3Rpb24gYW5k\n        IGF0IHN1Y2ggYSBzcGVlZC4uLkl0IGZlZWxzIGFuIGltcHVs\n        c2lvbi4uLnRoaXMgaXMgdGhlIHBsYWNlIHRvIGdvIG5vdy4g\n        QnV0IHRoZSBza3kga25vd3MgdGhlIHJlYXNvbnMgYW5kIHRo\n        ZSBwYXR0ZXJucyBiZWhpbmQgYWxsIGNsb3VkcywgYW5kIHlv\n        dSB3aWxsIGtub3csIHRvbywgd2hlbiB5b3UgbGlmdCB5b3Vy\n        c2VsZiBoaWdoIGVub3VnaCB0byBzZWUgYmV5b25kIGhvcml6\n        b25zLiINCg0KLVJpY2hhcmQgQmFjaA==\n    </file>\n  </personality>\n</server>\nINFO [nova.osapi_compute.wsgi.server] (9819) accepted ('127.0.0.1', 44341)\n\nAUDIT [nova.compute.manager] Starting instance...\nAUDIT [nova.compute.claims] Attempting claim: memory 512 MB, disk 1 GB, VCPUs 1\nAUDIT [nova.compute.claims] Total Memory: 8192 MB, used: 512.00 MB\nAUDIT [nova.compute.claims] Memory limit not specified, defaulting to unlimited\nAUDIT [nova.compute.claims] Total Disk: 1028 GB, used: 0.00 GB\nAUDIT [nova.compute.claims] Disk limit not specified, defaulting to unlimited\nAUDIT [nova.compute.claims] Total CPU: 1 VCPUs, used: 0.00 VCPUs\nAUDIT [nova.compute.claims] CPU limit not specified, defaulting to unlimited\nAUDIT [nova.compute.claims] Claim successful\nINFO [nova.osapi_compute.wsgi.server] 127.0.0.1 \"POST /v3/servers HTTP/1.1\" status: 202 len: 712 time: 1.0159640\n\nINFO [nova.tests.integrated.api.client] Doing POST on /v3/servers/67640a75-d7cd-4d96-91a4-b26e28485aa0/action\nINFO [nova.tests.integrated.api.client] Body: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <shelve/>\nINFO [nova.osapi_compute.wsgi.server] (9819) accepted ('127.0.0.1', 44348)\n\nINFO [nova.osapi_compute.wsgi.server] 127.0.0.1 \"POST /v3/servers/67640a75-d7cd-4d96-91a4-b26e28485aa0/action HTTP/1.1\" status: 202 len: 185 time: 0.3799698\n\nINFO [nova.tests.integrated.api.client] Doing POST on /v3/servers/67640a75-d7cd-4d96-91a4-b26e28485aa0/action\nINFO [nova.tests.integrated.api.client] Body: <?xml version=\"1.0\" encoding=\"UTF-8\"?>\n    <shelve_offload/>\nINFO [nova.osapi_compute.wsgi.server] (9819) accepted ('127.0.0.1', 44350)\n\nINFO [nova.api.openstack.wsgi] HTTP exception thrown: Cannot 'shelve_offload' while instance is in vm_state shelved_offloaded\nINFO [nova.osapi_compute.wsgi.server] 127.0.0.1 \"POST /v3/servers/67640a75-d7cd-4d96-91a4-b26e28485aa0/action HTTP/1.1\" status: 409 len: 386 time: 0.0510960\n\nINFO [nova.wsgi] Stopping WSGI server.\n}}}\n\nTraceback (most recent call last):\n  File \"nova/tests/integrated/v3/test_shelve.py\", line 46, in test_shelve_offload\n    self._test_server_action(uuid, 'shelve_offload')\n  File \"nova/tests/integrated/v3/test_shelve.py\", line 36, in _test_server_action\n    self.assertEqual(response.status, 202)\n  File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 322, in assertEqual\n    self.assertThat(observed, matcher, message)\n  File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 412, in assertThat\n    raise MismatchError(matchee, matcher, mismatch, verbose)\nMismatchError: 409 != 202\n\nFull logs here:\n\nhttp://logs.openstack.org/66/55766/3/gate/gate-nova-python27/8a3f3bc/testr_results.html.gz", 
            "date_created": "2013-11-29 06:38:20.110398+00:00", 
            "author": "https://api.launchpad.net/1.0/~cyeoh-0"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/59142", 
            "date_created": "2013-11-29 09:39:14.919982+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/59142\nCommitted: http://github.com/openstack/nova/commit/c7367823fdc1a55d515e8cbf9532e7ebbc641d7c\nSubmitter: Jenkins\nBranch:    master\n\ncommit c7367823fdc1a55d515e8cbf9532e7ebbc641d7c\nAuthor: Chris Yeoh <email address hidden>\nDate:   Fri Nov 29 19:38:19 2013 +1030\n\n    Fix testcase config option imports\n    \n    Fixes some testcases where config options were used before they\n    were guaranteed to be imported. This was causing intermittent\n    failures of tests such as test_shelve_offload.\n    \n    Closes-Bug: 1256210\n    \n    Change-Id: Id0204d67f35cb098a4ddfb670f5968e76b327705\n", 
            "date_created": "2013-12-02 15:20:47.040493+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-12-04 10:38:39.387467+00:00"
}