{
    "status": "Fix Released", 
    "last_updated": "2014-04-17 09:01:26.473246+00:00", 
    "description": "The XML serilaziation is failing when it's trying to create a datum selector with no values.\nIt's possible to use devstack to reproduce this issue following these steps:\n- boot an instance from volume without specifying an image id:\n\u00a0nova boot --flavor 1 --block-device-mapping vda=<VOL_ID> inst1\n- perform a GET servers for the instance created in the previous step requiring the results in XML:\ncurl -i http://10.0.0.5:8774/v2/<Tenant_id>/servers/<inst1_uuid> -X GET\n-H \"X-Auth-Project-Id: admin\" -H \"Accept: application/xml\" -H \"X-Auth-Token: <TOKEN>\"\nThe response is a 500 error:\nHTTP/1.1 500 Internal Server Error\nContent-Length: 192\nContent-Type: application/xml; charset=UTF-8\nX-Compute-Request-Id: req-5f69cdc2-7b10-4832-89e6-9500601d3ec7\nDate: Tue, 10 Sep 2013 13:43:30 GMT\n\n<computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>\n\nAnd in the compute log you can find details of the exception:\n\n2013-09-10 13:43:30.729 ERROR nova.api.openstack [req-5f69cdc2-7b10-4832-89e6-9500601d3ec7 admin admin] Caught error: string indices must be integers, not str\n2013-09-10 13:43:30.729 TRACE nova.api.openstack Traceback (most recent call last):\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 111, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return req.get_response(self.application)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1296, in send\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     application, catch_exc_info=False)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1260, in call_application\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 534, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return self.app(env, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 904, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     content_type, body, accept)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 993, in _process_stack\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     self.default_serializers)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 604, in serialize\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     response.body = serializer.serialize(self.obj)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 591, in serialize\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     elem = self.make_tree(obj)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 619, in make_tree\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return self._serialize(None, obj, siblings, nsmap)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 574, in _serialize\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     self._serialize(elem, datum, nieces)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 555, in _serialize\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     elems = siblings[0].render(parent, obj, siblings[1:], nsmap)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 427, in render\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     elems.append((self._render(parent, datum, patches, nsmap), datum))\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 381, in _render\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     self.apply(elem, datum)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 346, in apply\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     elem.set(key, unicode(value(obj, True)))\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 85, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     obj = obj[elem]\n2013-09-10 13:43:30.729 TRACE nova.api.openstack TypeError: string indices must be integers, not str", 
    "tags": [
        "api"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1223358", 
    "owner": "https://api.launchpad.net/1.0/~andrea-rosa-m", 
    "id": 1223358, 
    "index": 5331, 
    "openned": "2013-09-10 13:47:08.327743+00:00", 
    "created": "2013-09-10 13:47:08.327743+00:00", 
    "title": "XML serialization fails when it's trying to serialize an empty selector", 
    "comments": [
        {
            "content": "The XML serilaziation is failing when it's trying to create a selector with no values.\nIt's possible to use devstack to reproduce this issue following these steps:\n- boot an instance from volume without specifying an image id:\n nova boot --flavor 1 --block-device-mapping vda=<VOL_ID> inst1\n- perform a GET servers for the instance created in the previous step requiring the results in XML:\ncurl -i http://10.0.0.5:8774/v2/<Tenant_id>/servers/<inst1_uuid> -X GET \n-H \"X-Auth-Project-Id: admin\" -H \"Accept: application/xml\" -H \"X-Auth-Token: <TOKEN>\"\nThe response is a 500 error:\nHTTP/1.1 500 Internal Server Error\nContent-Length: 192\nContent-Type: application/xml; charset=UTF-8\nX-Compute-Request-Id: req-5f69cdc2-7b10-4832-89e6-9500601d3ec7\nDate: Tue, 10 Sep 2013 13:43:30 GMT\n\n<computeFault code=\"500\" xmlns=\"http://docs.openstack.org/compute/api/v1.1\"><message>The server has either erred or is incapable of performing the requested operation.</message></computeFault>\n\nAnd in the compute log you can find details of the exception:\n\n2013-09-10 13:43:30.729 ERROR nova.api.openstack [req-5f69cdc2-7b10-4832-89e6-9500601d3ec7 admin admin] Caught error: string indices must be integers, not str\n2013-09-10 13:43:30.729 TRACE nova.api.openstack Traceback (most recent call last):\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 111, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return req.get_response(self.application)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1296, in send\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     application, catch_exc_info=False)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1260, in call_application\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 534, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return self.app(env, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 904, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     content_type, body, accept)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 993, in _process_stack\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     self.default_serializers)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 604, in serialize\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     response.body = serializer.serialize(self.obj)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 591, in serialize\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     elem = self.make_tree(obj)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 619, in make_tree\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     return self._serialize(None, obj, siblings, nsmap)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 574, in _serialize\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     self._serialize(elem, datum, nieces)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 555, in _serialize\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     elems = siblings[0].render(parent, obj, siblings[1:], nsmap)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 427, in render\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     elems.append((self._render(parent, datum, patches, nsmap), datum))\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 381, in _render\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     self.apply(elem, datum)\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 346, in apply\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     elem.set(key, unicode(value(obj, True)))\n2013-09-10 13:43:30.729 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/xmlutil.py\", line 85, in __call__\n2013-09-10 13:43:30.729 TRACE nova.api.openstack     obj = obj[elem]\n2013-09-10 13:43:30.729 TRACE nova.api.openstack TypeError: string indices must be integers, not str", 
            "date_created": "2013-09-10 13:47:08.327743+00:00", 
            "author": "https://api.launchpad.net/1.0/~andrea-rosa-m"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/46086", 
            "date_created": "2013-09-11 15:31:40.552956+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/46086\nCommitted: http://github.com/openstack/nova/commit/902184f5dad8334c07e5bee0050376cdfc26f62c\nSubmitter: Jenkins\nBranch:    master\n\ncommit 902184f5dad8334c07e5bee0050376cdfc26f62c\nAuthor: Andrea Rosa <email address hidden>\nDate:   Wed Sep 11 16:24:09 2013 +0100\n\n    Fix empty selector XML bug\n    \n    The XML serialization fails when it's trying to create a datum selector with no\n    values. In that case the obj is an empty string so the selection of datum from\n    it just fails.\n    Instead of raising an exception the fix is returning an empty string, that\n    allows to serialize Selector with an empty object.\n    \n    Fixes bug 1223358\n    \n    Change-Id: If5d564c9b037eb0a107f4688ffa1aceb5281dc42\n", 
            "date_created": "2013-12-06 13:24:53.706599+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2014-01-22 16:18:45.625855+00:00"
}