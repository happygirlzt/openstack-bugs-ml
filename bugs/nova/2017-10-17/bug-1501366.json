{
    "status": "Fix Released", 
    "last_updated": "2016-03-03 16:20:28.892703+00:00", 
    "description": "http://logs.openstack.org/20/223320/3/check/gate-tempest-dsvm-nova-v20-api/ce04943/logs/screen-n-cpu.txt.gz?level=TRACE#_2015-09-29_21_38_32_631\n\n2015-09-29 21:38:32.631 ERROR nova.compute.manager [req-f57dc3ad-e960-4a18-8290-b01ab46b256b tempest-SecurityGroupsTestJSON-816336435 tempest-SecurityGroupsTestJSON-717971163] [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91] Instance failed to spawn\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91] Traceback (most recent call last):\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 2155, in _build_resources\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     yield resources\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 2009, in _build_and_run_instance\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     block_device_info=block_device_info)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 2444, in spawn\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     block_device_info=block_device_info)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 4516, in _create_domain_and_network\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     xml, pause=pause, power_on=power_on)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 4446, in _create_domain\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     guest.launch(pause=pause)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/virt/libvirt/guest.py\", line 141, in launch\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     self._encoded_xml, errors='ignore')\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 195, in __exit__\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     six.reraise(self.type_, self.value, self.tb)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/virt/libvirt/guest.py\", line 136, in launch\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     return self._domain.createWithFlags(flags)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 183, in doit\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 141, in proxy_call\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     rv = execute(f, *args, **kwargs)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 122, in execute\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     six.reraise(c, e, tb)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 80, in tworker\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     rv = meth(*args, **kwargs)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/libvirt.py\", line 900, in createWithFlags\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91] libvirtError: Error while building firewall: Some rules could not be created for interface vnet3: Failure to execute command '$EBT -t nat -A libvirt-J-vnet3  -p 0x0800 -j J-vnet3-ipv4' : 'Illegal target name 'J-vnet3-ipv4'.'.\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91] \n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91] \n\n\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwibGlidmlydEVycm9yOiBFcnJvciB3aGlsZSBidWlsZGluZyBmaXJld2FsbDogU29tZSBydWxlcyBjb3VsZCBub3QgYmUgY3JlYXRlZCBmb3IgaW50ZXJmYWNlXCIgQU5EIG1lc3NhZ2U6XCJJbGxlZ2FsIHRhcmdldCBuYW1lXCIgQU5EIHRhZ3M6XCJzY3JlZW4tbi1jcHUudHh0XCIiLCJmaWVsZHMiOltdLCJvZmZzZXQiOjAsInRpbWVmcmFtZSI6IjYwNDgwMCIsImdyYXBobW9kZSI6ImNvdW50IiwidGltZSI6eyJ1c2VyX2ludGVydmFsIjowfSwic3RhbXAiOjE0NDM2MjM3MjY1MDV9\n\n10 hits in 7 days, check and gate, all failures.  Looks like this is starting to spike.", 
    "tags": [
        "libvirt", 
        "network"
    ], 
    "importance": "High", 
    "heat": 22, 
    "link": "https://bugs.launchpad.net/nova/+bug/1501366", 
    "owner": "https://api.launchpad.net/1.0/~sdague", 
    "id": 1501366, 
    "index": 1817, 
    "openned": "2015-09-30 14:38:01.280941+00:00", 
    "created": "2015-09-30 14:38:01.280941+00:00", 
    "title": "libvirtError: Error while building firewall: Some rules could not be created for interface", 
    "comments": [
        {
            "content": "http://logs.openstack.org/20/223320/3/check/gate-tempest-dsvm-nova-v20-api/ce04943/logs/screen-n-cpu.txt.gz?level=TRACE#_2015-09-29_21_38_32_631\n\n2015-09-29 21:38:32.631 ERROR nova.compute.manager [req-f57dc3ad-e960-4a18-8290-b01ab46b256b tempest-SecurityGroupsTestJSON-816336435 tempest-SecurityGroupsTestJSON-717971163] [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91] Instance failed to spawn\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91] Traceback (most recent call last):\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 2155, in _build_resources\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     yield resources\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 2009, in _build_and_run_instance\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     block_device_info=block_device_info)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 2444, in spawn\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     block_device_info=block_device_info)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 4516, in _create_domain_and_network\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     xml, pause=pause, power_on=power_on)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 4446, in _create_domain\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     guest.launch(pause=pause)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/virt/libvirt/guest.py\", line 141, in launch\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     self._encoded_xml, errors='ignore')\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 195, in __exit__\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     six.reraise(self.type_, self.value, self.tb)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/opt/stack/new/nova/nova/virt/libvirt/guest.py\", line 136, in launch\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     return self._domain.createWithFlags(flags)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 183, in doit\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 141, in proxy_call\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     rv = execute(f, *args, **kwargs)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 122, in execute\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     six.reraise(c, e, tb)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 80, in tworker\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     rv = meth(*args, **kwargs)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]   File \"/usr/local/lib/python2.7/dist-packages/libvirt.py\", line 900, in createWithFlags\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91]     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91] libvirtError: Error while building firewall: Some rules could not be created for interface vnet3: Failure to execute command '$EBT -t nat -A libvirt-J-vnet3  -p 0x0800 -j J-vnet3-ipv4' : 'Illegal target name 'J-vnet3-ipv4'.'.\n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91] \n2015-09-29 21:38:32.631 24733 ERROR nova.compute.manager [instance: 00a32e3b-4fb9-4c95-951e-febc02c1ba91] \n\n\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwibGlidmlydEVycm9yOiBFcnJvciB3aGlsZSBidWlsZGluZyBmaXJld2FsbDogU29tZSBydWxlcyBjb3VsZCBub3QgYmUgY3JlYXRlZCBmb3IgaW50ZXJmYWNlXCIgQU5EIG1lc3NhZ2U6XCJJbGxlZ2FsIHRhcmdldCBuYW1lXCIgQU5EIHRhZ3M6XCJzY3JlZW4tbi1jcHUudHh0XCIiLCJmaWVsZHMiOltdLCJvZmZzZXQiOjAsInRpbWVmcmFtZSI6IjYwNDgwMCIsImdyYXBobW9kZSI6ImNvdW50IiwidGltZSI6eyJ1c2VyX2ludGVydmFsIjowfSwic3RhbXAiOjE0NDM2MjM3MjY1MDV9\n\n10 hits in 7 days, check and gate, all failures.  Looks like this is starting to spike.", 
            "date_created": "2015-09-30 14:38:01.280941+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "On juno, the message seems different. \n\nlibvirtError: Error while building firewall: Some rules could not be created for interface vnet0: Failure to execute command '$EBT -t nat -A libvirt-J-vnet0  -j J-vnet0-mac' : 'Chain 'libvirt-J-vnet0' doesn't exist.'\n\nMaybe it's a different bug... \n\nSeen here : http://logs.openstack.org/82/219382/10/check/gate-tempest-dsvm-full-juno/2a7e246/logs/screen-n-cpu.txt.gz#_2015-10-01_01_38_37_166", 
            "date_created": "2015-10-01 08:43:02.922630+00:00", 
            "author": "https://api.launchpad.net/1.0/~jordan-pittier"
        }, 
        {
            "content": "Similar error but without the 'Illegal target name' part, instead has 'Unable to update the kernel.':\n\nhttp://logs.openstack.org/41/216241/9/check/gate-tempest-dsvm-full/841feff/logs/screen-n-cpu.txt.gz?level=TRACE#_2015-10-01_07_35_52_565", 
            "date_created": "2015-10-01 08:46:15.205356+00:00", 
            "author": "https://api.launchpad.net/1.0/~hanlind"
        }, 
        {
            "content": "Bug 1501558 was originally reported for Juno.  These might be duplicates now.  It was also noted that the fix for related bug 1316621 to have a retry in the nova code was only made in Kilo, so might explain why we are possibly seeing different failures in Juno.", 
            "date_created": "2015-10-05 17:03:37.225090+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "@mriedem:  I believe that the error in comment #2 has the same cause as I mention in comments 11 and 12 of bug 1501558.    Ie. libvirt should be at version 1.2.11 or later.\n\nI looked at the libvirt log for the comment #2 error:\nhttp://logs.openstack.org/41/216241/9/check/gate-tempest-dsvm-full/841feff/logs/libvirt/libvirtd.txt.gz#_2015-10-01_07_35_52_429\nLooks the same as the kilo error in bug 1501558 comments 11 and 12.\n\nSo I think for juno we need to backport the nova-network bug 1316621 fix (retry logic on the ebtables call) and for both juno and kilo we would need libvirt 1.2.11 to get the libvirt side of the ebtables concurrency fix.\n\n", 
            "date_created": "2015-10-05 18:57:24.729888+00:00", 
            "author": "https://api.launchpad.net/1.0/~chuckcarmack75"
        }, 
        {
            "content": "Similar but slightly different failure here:\n\nhttp://logs.openstack.org/66/231166/1/check/gate-tempest-dsvm-full-ceph/4bf48fe/logs/screen-n-cpu.txt.gz?level=TRACE#_2015-10-05_21_15_11_343\n\n2015-10-05 21:15:11.343 ERROR nova.compute.manager [req-27e04cc8-35e4-477f-9278-b8436a384be9 tempest-ImagesNegativeTestJSON-735291181 tempest-ImagesNegativeTestJSON-254370333] [instance: 560c829f-5cb5-4177-adb9-082aea608505] Instance failed to spawn\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505] Traceback (most recent call last):\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 2168, in _build_resources\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     yield resources\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 2015, in _build_and_run_instance\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     block_device_info=block_device_info)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 2444, in spawn\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     block_device_info=block_device_info)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 4519, in _create_domain_and_network\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     xml, pause=pause, power_on=power_on)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 4449, in _create_domain\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     guest.launch(pause=pause)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/opt/stack/new/nova/nova/virt/libvirt/guest.py\", line 141, in launch\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     self._encoded_xml, errors='ignore')\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 195, in __exit__\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     six.reraise(self.type_, self.value, self.tb)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/opt/stack/new/nova/nova/virt/libvirt/guest.py\", line 136, in launch\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     return self._domain.createWithFlags(flags)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 183, in doit\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 141, in proxy_call\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     rv = execute(f, *args, **kwargs)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 122, in execute\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     six.reraise(c, e, tb)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 80, in tworker\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     rv = meth(*args, **kwargs)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]   File \"/usr/local/lib/python2.7/dist-packages/libvirt.py\", line 900, in createWithFlags\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505]     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2015-10-05 21:15:11.343 7756 ERROR nova.compute.manager [instance: 560c829f-5cb5-4177-adb9-082aea608505] libvirtError: Error while building firewall: Some rules could not be created for interface vnet3: Failure to execute command '$EBT -t nat -A libvirt-J-vnet3  -j J-vnet3-mac' : 'Chain 'libvirt-J-vnet3' doesn't exist.'.", 
            "date_created": "2015-10-06 00:20:39.702590+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "https://review.openstack.org/#/c/242064/1 got hit by that.", 
            "date_created": "2015-11-05 16:23:36.444256+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "Simply upgrading to libvirt 1.2.11 isn't sufficient to fix the problem. The nova fix implemented in  bug 1316621 only adds retry logic. It doesn't implement support for --concurrent. Without both nova and libvirt using --concurrent we will still get a race. \n\nIf we want to support --concurrent we have to update nova to detect the version of libvirt and ebtables and assuming the right version of each is present use --concurrent. Otherwise it should fall back to simply retry.", 
            "date_created": "2015-11-12 21:20:55.410889+00:00", 
            "author": "https://api.launchpad.net/1.0/~cfb-n"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/246580", 
            "date_created": "2015-11-17 20:00:53.404522+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/246581", 
            "date_created": "2015-11-17 20:01:02.801765+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/246580\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=103cb6bdc321f1f7fdc09bf8a5b178ff6ecd8f9f\nSubmitter: Jenkins\nBranch:    master\n\ncommit 103cb6bdc321f1f7fdc09bf8a5b178ff6ecd8f9f\nAuthor: Chet Burgess <email address hidden>\nDate:   Tue Nov 17 11:43:09 2015 -0800\n\n    Use --concurrent with ebtables\n    \n    Update our usage of ebtables to pass the --concurrent flag.\n    \n    With --concurrent ebtables will attempt to acquire a lock file\n    before making changes. This allows multiple processes, such as\n    nova an libvirt, to safely access ebtables at the same time.\n    \n    Support for using --concurrent was added in libvirt 1.2.11, since\n    we don't know the version of libvirt being used in all\n    deployments we still retry the ebtables call several times just\n    in case libvirt isn't using --concurrent.\n    \n    DocImpact:\n     * nova now requires ebtables 2.0.10 or later\n     * nova now recommends libvirt 1.2.11 or later\n    \n    Change-Id: I00ff805cee9653508f013f8aa6d206362ac0f6cb\n    Partial-Bug: #1501366\n", 
            "date_created": "2015-11-19 16:45:33.793760+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "https://github.com/openstack-dev/devstack/commit/7860f2ba3189b0361693c8ee9c65d8d03fb115d6 works around the failure in the gate.", 
            "date_created": "2016-01-18 22:04:17.429627+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/246581\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=17264ee6a66dd60f9af1aa3a737b17f290fc7e19\nSubmitter: Jenkins\nBranch:    master\n\ncommit 17264ee6a66dd60f9af1aa3a737b17f290fc7e19\nAuthor: Chet Burgess <email address hidden>\nDate:   Tue Nov 17 11:55:55 2015 -0800\n\n    ebtables/libvirt workaround\n    \n    Idealy nova is run with libvirt 1.2.11 or later to guarantee that\n    libvirt is calling ebtables with --concurrent. Since we can't\n    always guarantee this we have created this workaround.\n    \n    The workaround is extremely hacky and not recommend but for those\n    who simply have no other way to address this bug the following\n    should be done.\n    \n     * Copy /sbin/ebtables to /sbin/ebtables.real\n     * Copy the ebtables.workaround script to /sbin/ebtables\n    \n    Caution: Future OS level updates and packages way overwrite the\n    above changes. Its recommend users upgrade to libvirt 1.2.11.\n    \n    The work around script was copied from devstack and originally\n    written by sdague.\n    \n    Change-Id: Icdffc59d68b73a6df22ce138558d6e23e1c96336\n    Closes-Bug: #1501366\n", 
            "date_created": "2016-02-08 13:10:28.122505+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 13.0.0.0b3 development milestone.", 
            "date_created": "2016-03-03 16:20:28.141245+00:00", 
            "author": "https://api.launchpad.net/1.0/~doug-hellmann"
        }
    ], 
    "closed": "2016-02-08 13:10:25.615075+00:00"
}