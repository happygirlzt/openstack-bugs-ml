{
    "status": "Fix Released", 
    "last_updated": "2017-08-28 09:55:33.001244+00:00", 
    "description": "Description\n===========\nA TypeError occurs when using Nova to boot an instance with ephemeral storage encryption enabled.\n\nWhen key management was moved from Nova to Castellan in the Newton release, the key retrieval return value was changed from being formatted as a list of unsigned ints (in the case of an octet stream) [1] to not being formatted at all [2]. Nova's dmcrypt still expects the retrieved key [3][4] to be formatted as an array of unsigned bytes [5].\n\nReferences:\n[1] https://github.com/openstack/nova/blob/9702e5d2e9433c67067847c02fb100cd808a3596/nova/keymgr/barbican.py#L297-L323\n[2] https://github.com/openstack/castellan/blob/8d3f1cf375d28047cfd5f251afbb3f6d3ea7cda5/castellan/key_manager/barbican_key_manager.py#L527-L549\n[3] https://github.com/openstack/nova/blob/d219a3dcdc9c51bff3ebf2df086ea61a840ea3e9/nova/virt/libvirt/imagebackend.py#L714-L715\n[4] https://github.com/openstack/nova/blob/d219a3dcdc9c51bff3ebf2df086ea61a840ea3e9/nova/virt/libvirt/imagebackend.py#L674-L680\n[5] https://github.com/openstack/nova/blob/d219a3dcdc9c51bff3ebf2df086ea61a840ea3e9/nova/virt/libvirt/storage/dmcrypt.py#L48-L70\n\n\nSteps to reproduce\n==================\n1. Set up an LVM device:\nCreate a backing file:\n  $ truncate nova-lvm -s 2G\n\nMount the backing file on a loop device:\n  $ sudo losetup /dev/loop1 nova-lvm\n\nPrepare the device for LVM:\n  $ sudo pvcreate /dev/loop1\n\nCreate the LVM group on the loop device:\n  $ sudo vgcreate nova-lvm /dev/loop1\n\n2. Set up a devstack environment with ephemeral storage encryption enabled by adding the following lines to `lib/nova`:\n  iniset $NOVA_CONF ephemeral_storage_encryption enabled \"True\"\n  iniset $NOVA_CONF ephemeral_storage_encryption cipher \"aes-xts-plain64\"\n  iniset $NOVA_CONF ephemeral_storage_encryption key_size \"256\"\n  iniset $NOVA_CONF libvirt images_type \"lvm\"\n  iniset $NOVA_CONF libvirt images_volume_group \"nova-lvm\"\n\n3. Stack:\n  $ ./stack\n\n4. Use Nova to boot an instance:\n  $ nova boot --flavor 1 --image {image_id}\n\n\nExpected result\n===============\nEphemeral storage encryption succeeds and Nova successfully boots the instance.\n\n\nActual result\n=============\nEphemeral storage encryption fails with a TypeError (similar results can be seen from Barbican Tempest gate failures [1]):\n\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56] Traceback (most recent call last):\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2122, in _build_resources\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     yield resources\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1927, in _build_and_run_instance\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     block_device_info=block_device_info)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2688, in spawn\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     block_device_info=block_device_info)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3095, in _create_image\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     fallback_from_host)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3211, in _create_and_inject_local_root\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     instance, size, fallback_from_host)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 6780, in _try_fetch_image_cache\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     size=size)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 227, in cache\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     *args, **kwargs)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 735, in create_image\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     create_lvm_image(base, size)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 271, in inner\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     return f(*args, **kwargs)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 693, in create_lvm_image\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     encrypt_lvm_image()\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 680, in encrypt_lvm_image\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     key)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/storage/dmcrypt.py\", line 64, in create_volume\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     key = ''.join(map(lambda byte: \"%02x\" % byte, key))\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/storage/dmcrypt.py\", line 64, in <lambda>\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     key = ''.join(map(lambda byte: \"%02x\" % byte, key))\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56] TypeError: %x format: a number is required, not str\n\n\nNova fails to boot the instance.\n\n\n[1] http://logs.openstack.org/59/455459/16/check/gate-barbican-simple-crypto-dsvm-tempest-ubuntu-xenial-nv/9c0fa48/logs/screen-n-cpu.txt.gz#_2017-04-24_21_01_37_841\n\n\nEnvironment\n===========\n\nLatest `master` branch for all projects, except for Nova, which has patch [1] applied to get around the error addressed by the patch. However, remnants of the TypeError can still be seen without this patch [2].\n\n[1] https://review.openstack.org/#/c/462348/\n[2] http://logs.openstack.org/59/455459/17/check/gate-barbican-simple-crypto-dsvm-tempest-ubuntu-xenial-nv/26e8659/logs/screen-n-cpu.txt.gz#_2017-04-30_16_16_43_532", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1688342", 
    "owner": "https://api.launchpad.net/1.0/~jackie-truong", 
    "id": 1688342, 
    "index": 4817, 
    "openned": "2017-05-04 16:31:07.513314+00:00", 
    "created": "2017-05-04 16:31:07.513314+00:00", 
    "title": "Encryption key is not properly formatted before being passed to dmcrypt", 
    "comments": [
        {
            "content": "Description\n===========\nA TypeError occurs when using Nova to boot an instance with ephemeral storage encryption enabled.\n\nWhen key management was moved from Nova to Castellan in the Newton release, the key retrieval return value was changed from being formatted as a list of unsigned ints (in the case of an octet stream) [1] to not being formatted at all [2]. Nova's dmcrypt still expects the retrieved key [3][4] to be formatted as an array of unsigned bytes [5].\n\nReferences:\n[1] https://github.com/openstack/nova/blob/9702e5d2e9433c67067847c02fb100cd808a3596/nova/keymgr/barbican.py#L297-L323\n[2] https://github.com/openstack/castellan/blob/8d3f1cf375d28047cfd5f251afbb3f6d3ea7cda5/castellan/key_manager/barbican_key_manager.py#L527-L549\n[3] https://github.com/openstack/nova/blob/d219a3dcdc9c51bff3ebf2df086ea61a840ea3e9/nova/virt/libvirt/imagebackend.py#L714-L715\n[4] https://github.com/openstack/nova/blob/d219a3dcdc9c51bff3ebf2df086ea61a840ea3e9/nova/virt/libvirt/imagebackend.py#L674-L680\n[5] https://github.com/openstack/nova/blob/d219a3dcdc9c51bff3ebf2df086ea61a840ea3e9/nova/virt/libvirt/storage/dmcrypt.py#L48-L70\n\n\nSteps to reproduce\n==================\n1. Set up an LVM device:\nCreate a backing file:\n  $ truncate nova-lvm -s 2G\n\nMount the backing file on a loop device:\n  $ sudo losetup /dev/loop1 nova-lvm\n\nPrepare the device for LVM:\n  $ sudo pvcreate /dev/loop1\n\nCreate the LVM group on the loop device:\n  $ sudo vgcreate nova-lvm /dev/loop1\n\n2. Set up a devstack environment with ephemeral storage encryption enabled by adding the following lines to `lib/nova`:\n  iniset $NOVA_CONF ephemeral_storage_encryption enabled \"True\"\n  iniset $NOVA_CONF ephemeral_storage_encryption cipher \"aes-xts-plain64\"\n  iniset $NOVA_CONF ephemeral_storage_encryption key_size \"256\"\n  iniset $NOVA_CONF libvirt images_type \"lvm\"\n  iniset $NOVA_CONF libvirt images_volume_group \"nova-lvm\"\n\n3. Stack:\n  $ ./stack\n\n4. Use Nova to boot an instance:\n  $ nova boot --flavor 1 --image {image_id}\n\n\nExpected result\n===============\nEphemeral storage encryption succeeds and Nova successfully boots the instance.\n\n\nActual result\n=============\nEphemeral storage encryption fails with a TypeError (similar results can be seen from Barbican Tempest gate failures [1]):\n\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56] Traceback (most recent call last):\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2122, in _build_resources\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     yield resources\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1927, in _build_and_run_instance\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     block_device_info=block_device_info)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2688, in spawn\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     block_device_info=block_device_info)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3095, in _create_image\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     fallback_from_host)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3211, in _create_and_inject_local_root\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     instance, size, fallback_from_host)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 6780, in _try_fetch_image_cache\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     size=size)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 227, in cache\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     *args, **kwargs)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 735, in create_image\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     create_lvm_image(base, size)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 271, in inner\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     return f(*args, **kwargs)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 693, in create_lvm_image\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     encrypt_lvm_image()\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 680, in encrypt_lvm_image\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     key)\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/storage/dmcrypt.py\", line 64, in create_volume\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     key = ''.join(map(lambda byte: \"%02x\" % byte, key))\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]   File \"/opt/stack/nova/nova/virt/libvirt/storage/dmcrypt.py\", line 64, in <lambda>\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56]     key = ''.join(map(lambda byte: \"%02x\" % byte, key))\n2017-05-04 11:51:23.531 TRACE nova.compute.manager [instance: 760dedd5-60d7-470e-b753-70ee65e3ec56] TypeError: %x format: a number is required, not str\n\n\nNova fails to boot the instance.\n\n\n[1] http://logs.openstack.org/59/455459/16/check/gate-barbican-simple-crypto-dsvm-tempest-ubuntu-xenial-nv/9c0fa48/logs/screen-n-cpu.txt.gz#_2017-04-24_21_01_37_841\n\n\nEnvironment\n===========\n\nLatest `master` branch for all projects, except for Nova, which has patch [1] applied to get around the error addressed by the patch. However, remnants of the TypeError can still be seen without this patch [2].\n\n[1] https://review.openstack.org/#/c/462348/\n[2] http://logs.openstack.org/59/455459/17/check/gate-barbican-simple-crypto-dsvm-tempest-ubuntu-xenial-nv/26e8659/logs/screen-n-cpu.txt.gz#_2017-04-30_16_16_43_532", 
            "date_created": "2017-05-04 16:31:07.513314+00:00", 
            "author": "https://api.launchpad.net/1.0/~jackie-truong"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/462674", 
            "date_created": "2017-05-04 16:58:18.369626+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/462674\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=53a71c1241aac70018c16d174032427a172378ed\nSubmitter: Jenkins\nBranch:    master\n\ncommit 53a71c1241aac70018c16d174032427a172378ed\nAuthor: Jackie Truong <email address hidden>\nDate:   Thu May 4 12:51:22 2017 -0400\n\n    Fix decoding of encryption key passed to dmcrypt\n    \n    This patch fixes the decoding of the encryption key passed to dmcrypt.\n    During the key management move from Nova to Castellan, in the Newton\n    release, conversion of the encryption key (from a string to list of\n    unsigned ints) was removed from the key retrieval method. This patch\n    updates dmcrypt to decode an encryption key string, rather than a list\n    of unsigned ints. See the linked bug for more information.\n    \n    The method used to decode the encryption key has been updated to use\n    binascii, as done in os-brick [1], to maintain consistency. The key\n    generation and decoding portions of test_dmcrypt have been updated to\n    reflect this change and ensure compatibility with both, Python 2 and\n    Python 3.\n    \n    [1] https://github.com/openstack/os-brick/blob/6cf9b1cd689f70a2c50c0fa83a9a9f7c502712a1/os_brick/encryptors/cryptsetup.py#L100-L102\n    \n    Depends-On: I5fe3e5d5e5a9694d0dbe5b59248e5eaf89858c62\n    Closes-Bug: #1688342\n    Change-Id: I050585ecb55742a972038cf72b0650321ded2856\n", 
            "date_created": "2017-05-19 15:49:40.725511+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/ocata\nReview: https://review.openstack.org/466480", 
            "date_created": "2017-05-20 10:48:16.582845+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/newton\nReview: https://review.openstack.org/466481", 
            "date_created": "2017-05-20 10:48:31.620067+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/466480\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=bc8d0723e6e43d9b95ff9a5c4cbf7b0bec503a2f\nSubmitter: Jenkins\nBranch:    stable/ocata\n\ncommit bc8d0723e6e43d9b95ff9a5c4cbf7b0bec503a2f\nAuthor: Jackie Truong <email address hidden>\nDate:   Thu May 4 12:51:22 2017 -0400\n\n    Fix decoding of encryption key passed to dmcrypt\n    \n    This patch fixes the decoding of the encryption key passed to dmcrypt.\n    During the key management move from Nova to Castellan, in the Newton\n    release, conversion of the encryption key (from a string to list of\n    unsigned ints) was removed from the key retrieval method. This patch\n    updates dmcrypt to decode an encryption key string, rather than a list\n    of unsigned ints. See the linked bug for more information.\n    \n    The method used to decode the encryption key has been updated to use\n    binascii, as done in os-brick [1], to maintain consistency. The key\n    generation and decoding portions of test_dmcrypt have been updated to\n    reflect this change and ensure compatibility with both, Python 2 and\n    Python 3.\n    \n    [1] https://github.com/openstack/os-brick/blob/6cf9b1cd689f70a2c50c0fa83a9a9f7c502712a1/os_brick/encryptors/cryptsetup.py#L100-L102\n    \n    Closes-Bug: #1688342\n    Change-Id: I050585ecb55742a972038cf72b0650321ded2856\n    (cherry picked from commit 53a71c1241aac70018c16d174032427a172378ed)\n", 
            "date_created": "2017-05-23 23:31:39.450210+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 15.0.5 release.", 
            "date_created": "2017-05-30 15:54:17.639611+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 16.0.0.0b2 development milestone.", 
            "date_created": "2017-06-08 21:52:23.970295+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/466481\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=10a62ec99e2839f0fb163d38f37fa09e9f7b6c1c\nSubmitter: Jenkins\nBranch:    stable/newton\n\ncommit 10a62ec99e2839f0fb163d38f37fa09e9f7b6c1c\nAuthor: Jackie Truong <email address hidden>\nDate:   Thu May 4 12:51:22 2017 -0400\n\n    Fix decoding of encryption key passed to dmcrypt\n    \n    This patch fixes the decoding of the encryption key passed to dmcrypt.\n    During the key management move from Nova to Castellan, in the Newton\n    release, conversion of the encryption key (from a string to list of\n    unsigned ints) was removed from the key retrieval method. This patch\n    updates dmcrypt to decode an encryption key string, rather than a list\n    of unsigned ints. See the linked bug for more information.\n    \n    The method used to decode the encryption key has been updated to use\n    binascii, as done in os-brick [1], to maintain consistency. The key\n    generation and decoding portions of test_dmcrypt have been updated to\n    reflect this change and ensure compatibility with both, Python 2 and\n    Python 3.\n    \n    [1] https://github.com/openstack/os-brick/blob/6cf9b1cd689f70a2c50c0fa83a9a9f7c502712a1/os_brick/encryptors/cryptsetup.py#L100-L102\n    \n    Closes-Bug: #1688342\n    Change-Id: I050585ecb55742a972038cf72b0650321ded2856\n    (cherry picked from commit 53a71c1241aac70018c16d174032427a172378ed)\n", 
            "date_created": "2017-08-12 03:30:32.347445+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.8 release.", 
            "date_created": "2017-08-28 09:55:32.541108+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2017-05-19 15:49:38.626696+00:00"
}