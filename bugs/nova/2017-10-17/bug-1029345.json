{
    "status": "Invalid", 
    "last_updated": "2012-09-10 13:49:26.785072+00:00", 
    "description": "I am using Debian Wheezy with xcp. I am upload image.raw into glance:\n#glance add name=xen.raw disk_format=raw container_format=ovf < xen.raw\nThen try to boot:\n# nova boot --flavor 1 --image e132ec71-f42a-4854-a3f4-16ae3a8b1ce9 --key_name mykey --security_group default xen.raw\nLast trace from nova-compute.log:\n2012-07-26 13:15:04 ERROR nova.rpc.amqp [req-b2e99aed-626c-4b7f-9358-4f96ffb9d767 02b1f6a1d6264561a390a7835452524e ae4175d1bc32499f9a2437a5a0816521] Exception during message handling\n2012-07-26 13:15:04 TRACE nova.rpc.amqp Traceback (most recent call last):\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 253, in _process_data\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     rval = node_func(context=ctxt, **node_args)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 114, in wrapped\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     return f(*args, **kw)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 183, in decorated_function\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     sys.exc_info())\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self.gen.next()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 177,\n in decorated_function\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     return function(self, context, instance_uuid, *args, **kwargs)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 663,\n in run_instance\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     do_run_instance()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/utils.py\", line 945, in inner\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     retval = f(*args, **kwargs)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 662,\n in do_run_instance\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._run_instance(context, instance_uuid, **kwargs)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 463,\n in _run_instance                                                                                                                                                                                          [109/1028]\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._set_instance_error_state(context, instance_uuid)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self.gen.next()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 444,\n in _run_instance\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._deallocate_network(context, instance)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self.gen.next()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 441,\n in _run_instance\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     injected_files, admin_password)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 604,\n in _spawn\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._legacy_nw_info(network_info), block_device_info)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi_conn.py\", line 184, in spawn\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._vmops.spawn(context, instance, image_meta, network_info)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 359, in spawn\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     undo_mgr.rollback_and_reraise(msg=msg)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/utils.py\", line 1714, in rollback_and_reraise\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._rollback()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self.gen.next()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 352, in spawn\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     boot_instance_step(undo_mgr, vm_ref)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 138, in inner\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     rv = f(*args, **kwargs)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 336, in boot_instance_step\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._spawn(instance, vm_ref)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 548, in _spawn\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._start(instance, vm_ref)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 235, in _start\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     False, False)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi_conn.py\", line 576, in call_xenapi\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     return tpool.execute(f, *args)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 76, in tworker\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     rv = meth(*args,**kwargs)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/XenAPI.py\", line 235, in __call__\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     return self.__send(self.__name, args)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/XenAPI.py\", line 139, in xenapi_request\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     result = _parse_result(getattr(self, methodname)(*full_params))\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/XenAPI.py\", line 209, in _parse_result\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     raise Failure(result['ErrorDescription'])\n2012-07-26 13:15:04 TRACE nova.rpc.amqp Failure: ['INTERNAL_ERROR', 'device model failed to initialise: qemu-dm exit\nted unexpectedly']\n2012-07-26 13:15:04 TRACE nova.rpc.amqp", 
    "tags": [
        "qemu-dm"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1029345", 
    "owner": "None", 
    "id": 1029345, 
    "index": 4244, 
    "openned": "2012-07-26 09:43:22.476336+00:00", 
    "created": "2012-07-26 09:43:22.476336+00:00", 
    "title": "nova can not boot instance from image", 
    "comments": [
        {
            "content": "I am using Debian Wheezy with xcp. I am upload image.raw into glance:\n#glance add name=xen.raw disk_format=raw container_format=ovf < xen.raw\nThen try to boot:\n# nova boot --flavor 1 --image e132ec71-f42a-4854-a3f4-16ae3a8b1ce9 --key_name mykey --security_group default xen.raw\nLast trace from nova-compute.log:\n2012-07-26 13:15:04 ERROR nova.rpc.amqp [req-b2e99aed-626c-4b7f-9358-4f96ffb9d767 02b1f6a1d6264561a390a7835452524e ae4175d1bc32499f9a2437a5a0816521] Exception during message handling\n2012-07-26 13:15:04 TRACE nova.rpc.amqp Traceback (most recent call last):\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 253, in _process_data\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     rval = node_func(context=ctxt, **node_args)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 114, in wrapped\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     return f(*args, **kw)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 183, in decorated_function\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     sys.exc_info())\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self.gen.next()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 177,\n in decorated_function\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     return function(self, context, instance_uuid, *args, **kwargs)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 663,\n in run_instance\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     do_run_instance()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/utils.py\", line 945, in inner\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     retval = f(*args, **kwargs)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 662,\n in do_run_instance\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._run_instance(context, instance_uuid, **kwargs)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 463,\n in _run_instance                                                                                                                                                                                          [109/1028]\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._set_instance_error_state(context, instance_uuid)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self.gen.next()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 444,\n in _run_instance\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._deallocate_network(context, instance)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self.gen.next()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 441,\n in _run_instance\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     injected_files, admin_password)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 604,\n in _spawn\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._legacy_nw_info(network_info), block_device_info)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi_conn.py\", line 184, in spawn\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._vmops.spawn(context, instance, image_meta, network_info)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 359, in spawn\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     undo_mgr.rollback_and_reraise(msg=msg)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/utils.py\", line 1714, in rollback_and_reraise\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._rollback()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self.gen.next()\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 352, in spawn\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     boot_instance_step(undo_mgr, vm_ref)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 138, in inner\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     rv = f(*args, **kwargs)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 336, in boot_instance_step\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._spawn(instance, vm_ref)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 548, in _spawn\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     self._start(instance, vm_ref)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 235, in _start\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     False, False)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi_conn.py\", line 576, in call_xenapi\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     return tpool.execute(f, *args)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 76, in tworker\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     rv = meth(*args,**kwargs)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/XenAPI.py\", line 235, in __call__\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     return self.__send(self.__name, args)\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/XenAPI.py\", line 139, in xenapi_request\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     result = _parse_result(getattr(self, methodname)(*full_params))\n2012-07-26 13:15:04 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/XenAPI.py\", line 209, in _parse_result\n2012-07-26 13:15:04 TRACE nova.rpc.amqp     raise Failure(result['ErrorDescription'])\n2012-07-26 13:15:04 TRACE nova.rpc.amqp Failure: ['INTERNAL_ERROR', 'device model failed to initialise: qemu-dm exit\nted unexpectedly']\n2012-07-26 13:15:04 TRACE nova.rpc.amqp", 
            "date_created": "2012-07-26 09:43:22.476336+00:00", 
            "author": "https://api.launchpad.net/1.0/~bilenkis-yuri"
        }, 
        {
            "content": "Can you launch a VM without using nova?\nThis looks like the xcp-xapi package is not working on your system.", 
            "date_created": "2012-08-17 17:35:51.368702+00:00", 
            "author": "https://api.launchpad.net/1.0/~johngarbutt"
        }, 
        {
            "content": "Thank you for help. I have updates about this bug.\r\nThe reason of \"nova.rpc.amqp Failure: ['INTERNAL_ERROR', 'device model failed to initialise: qemu-dm exit\" is qemu could not work properly with bridge mode of xcp.\r\nYou must write \"openvswitch\" in /etc/xcp/network.conf and then configure xcp for working with this mode (from manual \"/usr/share/doc/xcp-xapi/README.Debian.gz\").\r\nThen you virtual machine run almost properly. But I have new problem.\r\n#nova boot --flavor 1 --image e132ec71-f42a-4854-a3f4-16ae3a8b1ce9 --key_name mykey --security_group default xen.raw\r\nWait for a wile and watch console of VM:\r\n#xtightvncviewer 127.0.0.1:5901\r\nMy VM is freeze and nothing helps (reboot too).\r\nI can not understand, why VM running under qemu? This is pvm machine... May be I send wrong parameters from nova to xcp?", 
            "date_created": "2012-08-30 11:44:57.624372+00:00", 
            "author": "https://api.launchpad.net/1.0/~bilenkis-yuri"
        }, 
        {
            "content": "Closing this bug, maybe file a new one about the new issue you encounter. Looks like you have usage issues rather than a bug to report, though, in which case I'd recommend posting a message on the users general mailing-list instead.", 
            "date_created": "2012-09-10 13:49:22.674621+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }
    ], 
    "closed": "2012-09-10 13:49:25.132446+00:00"
}