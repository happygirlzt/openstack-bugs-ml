{
    "status": "Won't Fix", 
    "last_updated": "2016-03-23 20:11:35.046205+00:00", 
    "description": "Version : Juno Devstack\n\nSteps to reproduce.\n\nStep1 : Create an instance with m1.tiny flavor. \n\nstack@onecloud-Standard-PC-i440FX-PIIX-1996:~/nova/nova/compute$ nova boot --image cirros-0.3.4-x86_64-uec --flavor m1.tiny vm1\n\n+--------------------------------------+----------------------------------------------------------------+\n| Property                             | Value                                                          |\n+--------------------------------------+----------------------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                                         |\n| OS-EXT-AZ:availability_zone          | nova                                                           |\n| OS-EXT-SRV-ATTR:host                 | -                                                              |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | -                                                              |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000006                                              |\n| OS-EXT-STS:power_state               | 0                                                              |\n| OS-EXT-STS:task_state                | scheduling                                                     |\n| OS-EXT-STS:vm_state                  | building                                                       |\n| OS-SRV-USG:launched_at               | -                                                              |\n| OS-SRV-USG:terminated_at             | -                                                              |\n| accessIPv4                           |                                                                |\n| accessIPv6                           |                                                                |\n| adminPass                            | Uaypcj6qKzbr                                                   |\n| config_drive                         |                                                                |\n| created                              | 2015-05-18T12:38:25Z                                           |\n| flavor                               | m1.tiny (6)                                                        |\n| hostId                               |                                                                |\n| id                                   | 7b4fdada-6900-4836-9de7-3bda0f13dabf                           |\n| image                                | cirros-0.3.4-x86_64-uec (a49af497-e336-4c5a-8508-6dabb70fe261) |\n| key_name                             | -                                                              |\n| metadata                             | {}                                                             |\n| name                                 | vm1                                                            |\n| os-extended-volumes:volumes_attached | []                                                             |\n| progress                             | 0                                                              |\n| security_groups                      | default                                                        |\n| status                               | BUILD                                                          |\n| tenant_id                            | d5a7933dfa98430abf7fcc37ff2661b1                               |\n| updated                              | 2015-05-18T12:38:26Z                                           |\n| user_id                              | a20aaf87a4344985ae17e378065858ed                               |\n+--------------------------------------+----------------------------------------------------------------+\n\nBefore deleting flavor please note the above output.\n\nStep 2: Once instance gets active delete the m1.tiny flavor.\n\nstack@onecloud-Standard-PC-i440FX-PIIX-1996:~/nova/nova/compute$ nova flavor-delete m1.tiny\n+----+------+-----------+------+-----------+------+-------+-------------+-----------+\n| ID | Name | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |\n+----+------+-----------+------+-----------+------+-------+-------------+-----------+\n| 6  | m1.tiny  | 512       | 1    | 0         |      | 1     | 1.0         | True      |\n+----+------+-----------+------+-----------+------+-------+-------------+-----------+\n\nStep 3 : Nova show vmname after deleting the flavor.\n\nstack@onecloud-Standard-PC-i440FX-PIIX-1996:~/nova/nova/compute$ nova show vm1\n+--------------------------------------+----------------------------------------------------------------+\n| Property                             | Value                                                          |\n+--------------------------------------+----------------------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                                         |\n| OS-EXT-AZ:availability_zone          | nova                                                           |\n| OS-EXT-SRV-ATTR:host                 | onecloud-Standard-PC-i440FX-PIIX-1996                          |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | onecloud-Standard-PC-i440FX-PIIX-1996                          |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000006                                              |\n| OS-EXT-STS:power_state               | 1                                                              |\n| OS-EXT-STS:task_state                | -                                                              |\n| OS-EXT-STS:vm_state                  | active                                                         |\n| OS-SRV-USG:launched_at               | 2015-05-18T12:38:30.000000                                     |\n| OS-SRV-USG:terminated_at             | -                                                              |\n| accessIPv4                           |                                                                |\n| accessIPv6                           |                                                                |\n| config_drive                         | True                                                           |\n| created                              | 2015-05-18T12:38:25Z                                           |\n| flavor                               | m1.tiny (6)                                                        |\n| hostId                               | b2f6e09e63c5ae998e9ad50cca85ac7ba506cee9159da4418e8893de       |\n| id                                   | 7b4fdada-6900-4836-9de7-3bda0f13dabf                           |\n| image                                | cirros-0.3.4-x86_64-uec (a49af497-e336-4c5a-8508-6dabb70fe261) |\n| key_name                             | -                                                              |\n| metadata                             | {}                                                             |\n| name                                 | vm1                                                            |\n| os-extended-volumes:volumes_attached | []                                                             |\n| private network                      | 10.0.0.2                                                       |\n| progress                             | 0                                                              |\n| security_groups                      | default                                                        |\n| status                               | ACTIVE                                                         |\n| tenant_id                            | d5a7933dfa98430abf7fcc37ff2661b1                               |\n| updated                              | 2015-05-18T12:38:31Z                                           |\n| user_id                              | a20aaf87a4344985ae17e378065858ed                               |\n+--------------------------------------+----------------------------------------------------------------+\n\nPlease note after deleting flavor, nova show command output above.\n\nflavor --  m1.tiny (6) still displaying the same before and after.\n\nRegards\nNoel", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 14, 
    "link": "https://bugs.launchpad.net/nova/+bug/1456196", 
    "owner": "https://api.launchpad.net/1.0/~noelnelson", 
    "id": 1456196, 
    "index": 6809, 
    "openned": "2015-05-18 13:16:30.274880+00:00", 
    "created": "2015-05-18 13:16:30.274880+00:00", 
    "title": "Delete flavor should raise error, if it is inuse (any existing vms booted with this flavor)", 
    "comments": [
        {
            "content": "Version : Juno Devstack\n\nSteps to reproduce.\n\nStep1 : Create an instance with m1.tiny flavor. \n\nstack@onecloud-Standard-PC-i440FX-PIIX-1996:~/nova/nova/compute$ nova boot --image cirros-0.3.4-x86_64-uec --flavor m1.tiny vm1\n\n+--------------------------------------+----------------------------------------------------------------+\n| Property                             | Value                                                          |\n+--------------------------------------+----------------------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                                         |\n| OS-EXT-AZ:availability_zone          | nova                                                           |\n| OS-EXT-SRV-ATTR:host                 | -                                                              |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | -                                                              |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000006                                              |\n| OS-EXT-STS:power_state               | 0                                                              |\n| OS-EXT-STS:task_state                | scheduling                                                     |\n| OS-EXT-STS:vm_state                  | building                                                       |\n| OS-SRV-USG:launched_at               | -                                                              |\n| OS-SRV-USG:terminated_at             | -                                                              |\n| accessIPv4                           |                                                                |\n| accessIPv6                           |                                                                |\n| adminPass                            | Uaypcj6qKzbr                                                   |\n| config_drive                         |                                                                |\n| created                              | 2015-05-18T12:38:25Z                                           |\n| flavor                               | m1.tiny (6)                                                        |\n| hostId                               |                                                                |\n| id                                   | 7b4fdada-6900-4836-9de7-3bda0f13dabf                           |\n| image                                | cirros-0.3.4-x86_64-uec (a49af497-e336-4c5a-8508-6dabb70fe261) |\n| key_name                             | -                                                              |\n| metadata                             | {}                                                             |\n| name                                 | vm1                                                            |\n| os-extended-volumes:volumes_attached | []                                                             |\n| progress                             | 0                                                              |\n| security_groups                      | default                                                        |\n| status                               | BUILD                                                          |\n| tenant_id                            | d5a7933dfa98430abf7fcc37ff2661b1                               |\n| updated                              | 2015-05-18T12:38:26Z                                           |\n| user_id                              | a20aaf87a4344985ae17e378065858ed                               |\n+--------------------------------------+----------------------------------------------------------------+\n\nBefore deleting flavor please note the above output.\n\nStep 2: Once instance gets active delete the m1.tiny flavor.\n\nstack@onecloud-Standard-PC-i440FX-PIIX-1996:~/nova/nova/compute$ nova flavor-delete m1.tiny\n+----+------+-----------+------+-----------+------+-------+-------------+-----------+\n| ID | Name | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |\n+----+------+-----------+------+-----------+------+-------+-------------+-----------+\n| 6  | m1.tiny  | 512       | 1    | 0         |      | 1     | 1.0         | True      |\n+----+------+-----------+------+-----------+------+-------+-------------+-----------+\n\nStep 3 : Nova show vmname after deleting the flavor.\n\nstack@onecloud-Standard-PC-i440FX-PIIX-1996:~/nova/nova/compute$ nova show vm1\n+--------------------------------------+----------------------------------------------------------------+\n| Property                             | Value                                                          |\n+--------------------------------------+----------------------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                                         |\n| OS-EXT-AZ:availability_zone          | nova                                                           |\n| OS-EXT-SRV-ATTR:host                 | onecloud-Standard-PC-i440FX-PIIX-1996                          |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | onecloud-Standard-PC-i440FX-PIIX-1996                          |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000006                                              |\n| OS-EXT-STS:power_state               | 1                                                              |\n| OS-EXT-STS:task_state                | -                                                              |\n| OS-EXT-STS:vm_state                  | active                                                         |\n| OS-SRV-USG:launched_at               | 2015-05-18T12:38:30.000000                                     |\n| OS-SRV-USG:terminated_at             | -                                                              |\n| accessIPv4                           |                                                                |\n| accessIPv6                           |                                                                |\n| config_drive                         | True                                                           |\n| created                              | 2015-05-18T12:38:25Z                                           |\n| flavor                               | m1.tiny (6)                                                        |\n| hostId                               | b2f6e09e63c5ae998e9ad50cca85ac7ba506cee9159da4418e8893de       |\n| id                                   | 7b4fdada-6900-4836-9de7-3bda0f13dabf                           |\n| image                                | cirros-0.3.4-x86_64-uec (a49af497-e336-4c5a-8508-6dabb70fe261) |\n| key_name                             | -                                                              |\n| metadata                             | {}                                                             |\n| name                                 | vm1                                                            |\n| os-extended-volumes:volumes_attached | []                                                             |\n| private network                      | 10.0.0.2                                                       |\n| progress                             | 0                                                              |\n| security_groups                      | default                                                        |\n| status                               | ACTIVE                                                         |\n| tenant_id                            | d5a7933dfa98430abf7fcc37ff2661b1                               |\n| updated                              | 2015-05-18T12:38:31Z                                           |\n| user_id                              | a20aaf87a4344985ae17e378065858ed                               |\n+--------------------------------------+----------------------------------------------------------------+\n\nPlease note after deleting flavor, nova show command output above.\n\nflavor --  m1.tiny (6) still displaying the same before and after.\n\nRegards\nNoel", 
            "date_created": "2015-05-18 13:16:30.274880+00:00", 
            "author": "https://api.launchpad.net/1.0/~noelnelson"
        }, 
        {
            "content": "The old flavors, after having been deleted, still exist in the instance_types table, so this isn't necessarily a problem.\n\nHowever, if a flavor is deleted, then the instance based on that deleted flavor is migrated, the migration fails.\n\nShould we be discussing a check to make sure a flavor isn't in use before deleting, or making it possible to use deleted flavors for existing instances?", 
            "date_created": "2015-05-20 08:02:07.256805+00:00", 
            "author": "https://api.launchpad.net/1.0/~xavpaice"
        }, 
        {
            "content": "I agree with Xav Paice,\n\nRaising error when flavor doesn't exist is incorrect.\nWe can adress the same issue by \"Raising error while deleting flavor, if the flavor in in use(vms already booted with this flavor).\"", 
            "date_created": "2015-05-20 09:26:23.832397+00:00", 
            "author": "https://api.launchpad.net/1.0/~bharat-kobagana"
        }, 
        {
            "content": "Are you working on this bug Bhavaniprasad else I would like to pick this.", 
            "date_created": "2015-06-15 09:51:38.083450+00:00", 
            "author": "https://api.launchpad.net/1.0/~harshada-kakad"
        }, 
        {
            "content": "*I am not working on that. I have provided the patch for some other bug,\nthat should be solution  this bug also.. *\n\nOn Mon, Jun 15, 2015 at 3:21 PM, Harshada Mangesh Kakad <\n<email address hidden>> wrote:\n\n> Are you working on this bug Bhavaniprasad else I would like to pick\n> this.\n>\n> --\n> You received this bug notification because you are subscribed to the bug\n> report.\n> https://bugs.launchpad.net/bugs/1456196\n>\n> Title:\n>   Delete flavor should raise error, if it is inuse (any existing vms\n>   booted with this flavor)\n>\n> Status in OpenStack Compute (Nova):\n>   Confirmed\n>\n> Bug description:\n>   Version : Juno Devstack\n>\n>   Steps to reproduce.\n>\n>   Step1 : Create an instance with m1.tiny flavor.\n>\n>   stack@onecloud-Standard-PC-i440FX-PIIX-1996:~/nova/nova/compute$ nova\n>   boot --image cirros-0.3.4-x86_64-uec --flavor m1.tiny vm1\n>\n>\n> +--------------------------------------+----------------------------------------------------------------+\n>   | Property                             | Value\n>                                 |\n>\n> +--------------------------------------+----------------------------------------------------------------+\n>   | OS-DCF:diskConfig                    | MANUAL\n>                                |\n>   | OS-EXT-AZ:availability_zone          | nova\n>                                |\n>   | OS-EXT-SRV-ATTR:host                 | -\n>                                 |\n>   | OS-EXT-SRV-ATTR:hypervisor_hostname  | -\n>                                 |\n>   | OS-EXT-SRV-ATTR:instance_name        | instance-00000006\n>                                 |\n>   | OS-EXT-STS:power_state               | 0\n>                                 |\n>   | OS-EXT-STS:task_state                | scheduling\n>                                |\n>   | OS-EXT-STS:vm_state                  | building\n>                                |\n>   | OS-SRV-USG:launched_at               | -\n>                                 |\n>   | OS-SRV-USG:terminated_at             | -\n>                                 |\n>   | accessIPv4                           |\n>                                 |\n>   | accessIPv6                           |\n>                                 |\n>   | adminPass                            | Uaypcj6qKzbr\n>                                |\n>   | config_drive                         |\n>                                 |\n>   | created                              | 2015-05-18T12:38:25Z\n>                                |\n>   | flavor                               | m1.tiny (6)\n>                                     |\n>   | hostId                               |\n>                                 |\n>   | id                                   |\n> 7b4fdada-6900-4836-9de7-3bda0f13dabf                           |\n>   | image                                | cirros-0.3.4-x86_64-uec\n> (a49af497-e336-4c5a-8508-6dabb70fe261) |\n>   | key_name                             | -\n>                                 |\n>   | metadata                             | {}\n>                                |\n>   | name                                 | vm1\n>                                 |\n>   | os-extended-volumes:volumes_attached | []\n>                                |\n>   | progress                             | 0\n>                                 |\n>   | security_groups                      | default\n>                                 |\n>   | status                               | BUILD\n>                                 |\n>   | tenant_id                            |\n> d5a7933dfa98430abf7fcc37ff2661b1                               |\n>   | updated                              | 2015-05-18T12:38:26Z\n>                                |\n>   | user_id                              |\n> a20aaf87a4344985ae17e378065858ed                               |\n>\n> +--------------------------------------+----------------------------------------------------------------+\n>\n>   Before deleting flavor please note the above output.\n>\n>   Step 2: Once instance gets active delete the m1.tiny flavor.\n>\n>   stack@onecloud-Standard-PC-i440FX-PIIX-1996:~/nova/nova/compute$ nova\n> flavor-delete m1.tiny\n>\n> +----+------+-----------+------+-----------+------+-------+-------------+-----------+\n>   | ID | Name | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor\n> | Is_Public |\n>\n> +----+------+-----------+------+-----------+------+-------+-------------+-----------+\n>   | 6  | m1.tiny  | 512       | 1    | 0         |      | 1     | 1.0\n>    | True      |\n>\n> +----+------+-----------+------+-----------+------+-------+-------------+-----------+\n>\n>   Step 3 : Nova show vmname after deleting the flavor.\n>\n>   stack@onecloud-Standard-PC-i440FX-PIIX-1996:~/nova/nova/compute$ nova\n> show vm1\n>\n> +--------------------------------------+----------------------------------------------------------------+\n>   | Property                             | Value\n>                                 |\n>\n> +--------------------------------------+----------------------------------------------------------------+\n>   | OS-DCF:diskConfig                    | MANUAL\n>                                |\n>   | OS-EXT-AZ:availability_zone          | nova\n>                                |\n>   | OS-EXT-SRV-ATTR:host                 |\n> onecloud-Standard-PC-i440FX-PIIX-1996                          |\n>   | OS-EXT-SRV-ATTR:hypervisor_hostname  |\n> onecloud-Standard-PC-i440FX-PIIX-1996                          |\n>   | OS-EXT-SRV-ATTR:instance_name        | instance-00000006\n>                                 |\n>   | OS-EXT-STS:power_state               | 1\n>                                 |\n>   | OS-EXT-STS:task_state                | -\n>                                 |\n>   | OS-EXT-STS:vm_state                  | active\n>                                |\n>   | OS-SRV-USG:launched_at               | 2015-05-18T12:38:30.000000\n>                                |\n>   | OS-SRV-USG:terminated_at             | -\n>                                 |\n>   | accessIPv4                           |\n>                                 |\n>   | accessIPv6                           |\n>                                 |\n>   | config_drive                         | True\n>                                |\n>   | created                              | 2015-05-18T12:38:25Z\n>                                |\n>   | flavor                               | m1.tiny (6)\n>                                     |\n>   | hostId                               |\n> b2f6e09e63c5ae998e9ad50cca85ac7ba506cee9159da4418e8893de       |\n>   | id                                   |\n> 7b4fdada-6900-4836-9de7-3bda0f13dabf                           |\n>   | image                                | cirros-0.3.4-x86_64-uec\n> (a49af497-e336-4c5a-8508-6dabb70fe261) |\n>   | key_name                             | -\n>                                 |\n>   | metadata                             | {}\n>                                |\n>   | name                                 | vm1\n>                                 |\n>   | os-extended-volumes:volumes_attached | []\n>                                |\n>   | private network                      | 10.0.0.2\n>                                |\n>   | progress                             | 0\n>                                 |\n>   | security_groups                      | default\n>                                 |\n>   | status                               | ACTIVE\n>                                |\n>   | tenant_id                            |\n> d5a7933dfa98430abf7fcc37ff2661b1                               |\n>   | updated                              | 2015-05-18T12:38:31Z\n>                                |\n>   | user_id                              |\n> a20aaf87a4344985ae17e378065858ed                               |\n>\n> +--------------------------------------+----------------------------------------------------------------+\n>\n>   Please note after deleting flavor, nova show command output above.\n>\n>   flavor --  m1.tiny (6) still displaying the same before and after.\n>\n>   Regards\n>   Noel\n>\n> To manage notifications about this bug go to:\n> https://bugs.launchpad.net/nova/+bug/1456196/+subscriptions\n>\n", 
            "date_created": "2015-06-15 10:31:27+00:00", 
            "author": "https://api.launchpad.net/1.0/~noelnelson"
        }, 
        {
            "content": "is anybody still working on this? I want to take over this.", 
            "date_created": "2015-07-03 02:24:39.741984+00:00", 
            "author": "https://api.launchpad.net/1.0/~jeffrey4l"
        }, 
        {
            "content": "@Jeffrey Zhang:\nIf this bug is still valid and since there doesn't seem to be a patch set for 2 months, I think it is fair to take over from Bhavaniprasad.\n\n@Bhavaniprasad:\nI couldn't find your IRC handle in your Launchpad account to ask you directly.", 
            "date_created": "2015-08-18 08:09:04.020938+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "A related bug to this is bug 1485767.", 
            "date_created": "2015-08-18 08:09:27.003718+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "unless we have a reference count mechanism, it's hard to prevent this action\nand flavor belongs to admin usually, instance belongs to user usually, user actions might not block admin's\n\nThis is not very related , but I guess here some changes are helpful to the resize case for the old, new flavor stuff?\nhttp://specs.openstack.org/openstack/nova-specs/specs/kilo/approved/flavor-from-sysmeta-to-blob.html", 
            "date_created": "2015-08-20 12:22:00.484845+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/217674", 
            "date_created": "2015-08-27 12:03:16.066890+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Not allowing the deletion of flavors seems like the wrong approach to me. Instead I think we could consider exposing flavor information with the instance rather than just exposing a flavor id for a flavor which may no longer exist. We store a copy of flavor information in the instance_extra table so it would be easy enough to get access to it. However this solution or that solution would need a spec so that we can discuss the proper approach to this problem. If you are unfamiliar with the process there is some documentation on it at http://git.openstack.org/cgit/openstack/nova-specs/tree/README.rst", 
            "date_created": "2015-10-07 16:53:36.841155+00:00", 
            "author": "https://api.launchpad.net/1.0/~alaski"
        }, 
        {
            "content": "See https://review.openstack.org/#/c/265282/", 
            "date_created": "2016-03-23 20:04:04.794594+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Change abandoned by Matt Riedemann (<email address hidden>) on branch: master\nReview: https://review.openstack.org/217674\nReason: See https://review.openstack.org/#/c/265282/", 
            "date_created": "2016-03-23 20:05:16.427987+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2016-02-20 15:03:58.791159+00:00"
}