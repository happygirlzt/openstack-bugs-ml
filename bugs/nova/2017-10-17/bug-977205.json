{
    "status": "Fix Released", 
    "last_updated": "2012-06-07 07:28:28.422666+00:00", 
    "description": "instance launching is fails and goes into error due to unavailability of fixed-ips and throwing an exception as below \nnova-compute log : Remote error: NoMoreFixedIps Zero fixed ips available\nBut observed that Fixed-Ip is being assigned to failed instance.\n\nSteps to reproduce:\n1. Fill up/reach the maximum fixed-ip limit\n2. launch an instance and see the logs and state of the VM\n\nFixed-IP should not be allocated and throw an friendly message\n\nExpected Result:\nMessage in nova-compute log : Remote error: NoMoreFixedIps Zero fixed ips available\n\nActual Result:\nExecute Nova list : 699d824f-f6cd-4ba7-a43c-9a32a26c06a0 | server2 | ERROR | private_0=10.0.0.22", 
    "tags": [
        "persistent-systems"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/977205", 
    "owner": "None", 
    "id": 977205, 
    "index": 4029, 
    "openned": "2012-04-09 13:17:52.787836+00:00", 
    "created": "2012-04-09 13:17:52.787836+00:00", 
    "title": "Fixed-Ips are being allocated to instances though unavailability of fixed-ips", 
    "comments": [
        {
            "content": "instance launching is fails and goes into error due to unavailability of fixed-ips and throwing an exception as below \nnova-compute log : Remote error: NoMoreFixedIps Zero fixed ips available\nBut observed that Fixed-Ip is being assigned to failed instance.\n\nSteps to reproduce:\n1. Fill up/reach the maximum fixed-ip limit\n2. launch an instance and see the logs and state of the VM\n\nFixed-IP should not be allocated and throw an friendly message\n\nExpected Result:\nMessage in nova-compute log : Remote error: NoMoreFixedIps Zero fixed ips available\n\nActual Result:\nExecute Nova list : 699d824f-f6cd-4ba7-a43c-9a32a26c06a0 | server2 | ERROR | private_0=10.0.0.22", 
            "date_created": "2012-04-09 13:17:52.787836+00:00", 
            "author": "https://api.launchpad.net/1.0/~kommuri-siddanth"
        }, 
        {
            "content": "This is the current result. I think it has been solved.\n\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     self._set_instance_error_state(context, instance_uuid)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     self.gen.next()\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 457, in _run_instance\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     requested_networks)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 602, in _allocate_network\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     requested_networks=requested_networks)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/network/api.py\", line 168, in allocate_for_instance\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     'args': args})\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/rpc/__init__.py\", line 99, in call\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     return _get_impl().call(cfg.CONF, context, topic, msg, timeout)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/rpc/impl_kombu.py\", line 725, in call\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     rpc_amqp.get_connection_pool(conf, Connection))\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/rpc/amqp.py\", line 366, in call\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     rv = list(rv)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/rpc/amqp.py\", line 334, in __iter__\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     raise result\n2012-06-07 15:23:31 TRACE nova.rpc.amqp NoMoreFixedIps_Remote: \\u6ca1\\u6709\\u56fa\\u5b9aip\\u53ef\\u7528\\u3002\n2012-06-07 15:23:31 TRACE nova.rpc.amqp Traceback (most recent call last):\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/rpc/amqp.py\", line 273, in _process_data\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/rpc/dispatcher.py\", line 103, in dispatch\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 261, in wrapped\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     return func(self, context, *args, **kwargs)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 323, in allocate_for_instance\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     **kwargs)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 261, in wrapped\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     return func(self, context, *args, **kwargs)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 957, in allocate_for_instance\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     requested_networks=requested_networks)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 217, in _allocate_fixed_ips\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     vpn=vpn, address=address)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 1233, in allocate_fixed_ip\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     instance_id)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/db/api.py\", line 429, in fixed_ip_associate_pool\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     instance_id, host)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/db/sqlalchemy/api.py\", line 113, in wrapper\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     return f(*args, **kwargs)\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp   File \"/opt/stack/nova/nova/db/sqlalchemy/api.py\", line 1015, in fixed_ip_associate_pool\n2012-06-07 15:23:31 TRACE nova.rpc.amqp     raise exception.NoMoreFixedIps()\n2012-06-07 15:23:31 TRACE nova.rpc.amqp\n2012-06-07 15:23:31 TRACE nova.rpc.amqp NoMoreFixedIps: \\u6ca1\\u6709\\u56fa\\u5b9aip\\u53ef\\u7528\\u3002\n", 
            "date_created": "2012-06-07 07:27:34.655189+00:00", 
            "author": "https://api.launchpad.net/1.0/~houshengbo"
        }
    ], 
    "closed": "2012-06-07 07:28:26.373965+00:00"
}