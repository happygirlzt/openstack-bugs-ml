{
    "status": "Invalid", 
    "last_updated": "2016-06-24 02:07:51.080860+00:00", 
    "description": "Description\n===========\nThere is an active instance and stop the instance. When the task_state of the\ninstance is powering-off, then I restart the nova-compute services, the _init_instance\nfunction will stop the instance again. The expected result is stop instance success and\ninstance is SHUTOFF, but now stop raise error.\ncode:\n\u00a0\u00a0\u00a0\u00a0if instance.task_state == task_states.POWERING_OFF:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0try:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0  LOG.debug(\"Instance in transitional state %s at start-up \"\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"retrying stop request\",\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance.task_state, instance=instance)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0self.stop_instance(context, instance)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0except Exception:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0# we don't want that an exception blocks the init_host\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0msg = _LE('Failed to stop instance')\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0LOG.exception(msg, instance=instance)\n\u00a0\u00a0\u00a0\u00a0return\n\nThe powering-on task-state also has the same issue.\n\nSteps to reproduce\n==================\nA chronological list of steps which will bring off the\nissue :\n* I boot an instance\n\u00a0\u00a0\u00a0nova boot --flavor 2 --image c61966bd-7969-40af-9f9b-ed282fb25bdf --nic\n\u00a0\u00a0\u00a0net-id=ea2a9eb5-f52e-4822-aa5d-168658e9c383  test_iso8\n* then I stop the instance\n\u00a0\u00a0\u00a0nova stop test_iso8\n* then I restart the nova-compute service when instance in powering-off task-state\n\nExpected result\n===============\nWhen nova-compute service restart\uff0cthe instance test_iso8 should be stopped.\n\nActual result\n=============\nAfter the nova-compute service restart, the instance test_iso8 is active.\nThe nova-compute.log has error information.\n\nEnvironment\n===========\n1. Exact version of OpenStack you are running.\n\u00a0\u00a0\u00a0Mitaka\n2. Which hypervisor did you use?\n\u00a0\u00a0\u00a0Libvirt + KVM\n3. Which networking type did you use?\n\u00a0\u00a0\u00a0 Neutron with OpenVSwitch\n\nLogs & Configs\n==============\n[root@slot4 ~(keystone_admin)]# nova boot --flavor 2 --image c61966bd-7969-40af-9f9b-ed282fb25bdf --nic net-id=ea2a9eb5-f52e-4822-aa5d-168658e9c383  test_iso8\n[root@slot4 ~(keystone_admin)]# nova stop test_iso8\nRequest to stop server test_iso8 has been accepted.\n\nrestart nova-compute service\n\n[root@slot4 ~(keystone_admin)]# nova list\n+--------------------------------------+-----------+--------+------------+-------------+-----------------+\n| ID                                   | Name      | Status | Task State | Power State | Networks        |\n+--------------------------------------+-----------+--------+------------+-------------+-----------------+\n| 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9 | test_iso8 | ACTIVE | -          | Running     | net01=5.5.5.249 |\n+--------------------------------------+-----------+--------+------------+-------------+-----------------+\n[root@slot4 ~(keystone_admin)]# nova instance-action-list 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9\n+-------------------+------------------------------------------+---------+----------------------------+\n| Action            | Request_ID                               | Message | Start_Time                 |\n+-------------------+------------------------------------------+---------+----------------------------+\n| create            | req-25400b17-6c33-45e5-ae4e-87cba0d0de15 | -       | 2016-06-22T04:40:43.000000 |\n| stop              | req-5a7d26eb-79d3-4e69-86a8-d40c02bc6a00 | -       | 2016-06-22T07:08:23.000000 |\n+-------------------+------------------------------------------+---------+----------------------------+\n\nnova-compute.log error information:\n2016-06-22 15:08:29.942 28875 ERROR nova.compute.manager [req-b6bbfa68-334c-4c31-9f6d-4d5523cebc4d - - - - -] [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] Failed to stop instance\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] Traceback (most recent call last):\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 1304, in _init_instance\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     self.stop_instance(context, instance)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     payload)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     six.reraise(self.type_, self.value, self.tb)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     return f(self, context, *args, **kw)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 377, in decorated_function\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     LOG.warning(msg, e, instance_uuid=instance_uuid)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     six.reraise(self.type_, self.value, self.tb)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 348, in decorated_function\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     return function(self, context, *args, **kwargs)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 426, in decorated_function\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     with compute_utils.EventReporter(context, event_name, instance_uuid):\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/compute/utils.py\", line 540, in __enter__\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     self.context, uuid, self.event_name, want_result=False)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/objects/base.py\", line 161, in wrapper\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     args, kwargs)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/conductor/rpcapi.py\", line 335, in object_class_action\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     objver=objver, args=args, kwargs=kwargs)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 156, in call\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     retry=self.retry)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     timeout=timeout, retry=retry)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 350, in send\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     retry=retry)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 341, in _send\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     raise result\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] InstanceActionNotFound_Remote: Action for request_id req-e8ef400f-ca1b-4252-a2aa-9d749cd57ae4 on instance 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9 not found\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] Traceback (most recent call last):\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/conductor/manager.py\", line 426, in _object_dispatch\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     return getattr(target, method)(*args, **kwargs)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/objects/base.py\", line 163, in wrapper\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     result = fn(cls, context, *args, **kwargs)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/objects/instance_action.py\", line 170, in event_start\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     db_event = db.action_event_start(context, values)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/db/api.py\", line 1858, in action_event_start\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     return IMPL.action_event_start(context, values)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 5748, in action_event_start\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     instance_uuid=values['instance_uuid'])\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] InstanceActionNotFound: Action for request_id req-e8ef400f-ca1b-4252-a2aa-9d749cd57ae4 on instance 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9 not found", 
    "tags": [
        "nova-compute", 
        "powering-off", 
        "restart", 
        "service", 
        "stop"
    ], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1595083", 
    "owner": "None", 
    "id": 1595083, 
    "index": 7562, 
    "openned": "2016-06-22 08:37:34.007147+00:00", 
    "created": "2016-06-22 08:37:34.007147+00:00", 
    "title": "Instance with powering-off task-state stop failure when the nova-compute restarts", 
    "comments": [
        {
            "content": "Description\n===========\nThere is an active instance and stop the instance. When the task_state of the\ninstance is powering-off, then I restart the nova-compute services, the _init_instance \nfunction will stop the instance again. The expected result is stop instance success and \ninstance is SHUTOFF, but now stop raise error.\ncode:\n        if instance.task_state == task_states.POWERING_OFF:\n            try:\n                LOG.debug(\"Instance in transitional state %s at start-up \"\n                          \"retrying stop request\",\n                          instance.task_state, instance=instance)\n                self.stop_instance(context, instance)\n            except Exception:\n                # we don't want that an exception blocks the init_host\n                msg = _LE('Failed to stop instance')\n                LOG.exception(msg, instance=instance)\n            return\n\nThe powering-on task-state also has the same issue.\n\nSteps to reproduce\n==================\nA chronological list of steps which will bring off the\nissue :\n* I boot an instance \n   nova boot --flavor 2 --image c61966bd-7969-40af-9f9b-ed282fb25bdf --nic \n   net-id=ea2a9eb5-f52e-4822-aa5d-168658e9c383  test_iso8\n* then I stop the instance\n   nova stop test_iso8\n* then I restart the nova-compute service when instance in powering-off task-state\n\nExpected result\n===============\nWhen nova-compute service restart\uff0cthe instance test_iso8 should be stopped.\n\nActual result\n=============\nAfter the nova-compute service restart, the instance test_iso8 is active.\nThe nova-compute.log has error information.\n\nEnvironment\n===========\n1. Exact version of OpenStack you are running. \n   Mitaka\n2. Which hypervisor did you use?\n\u00a0\u00a0\u00a0Libvirt + KVM\n3. Which networking type did you use?\n\u00a0\u00a0\u00a0 Neutron with OpenVSwitch\n\nLogs & Configs\n==============\n[root@slot4 ~(keystone_admin)]# nova boot --flavor 2 --image c61966bd-7969-40af-9f9b-ed282fb25bdf --nic net-id=ea2a9eb5-f52e-4822-aa5d-168658e9c383  test_iso8\n[root@slot4 ~(keystone_admin)]# nova stop test_iso8\nRequest to stop server test_iso8 has been accepted.\n\nrestart nova-compute service\n\n[root@slot4 ~(keystone_admin)]# nova list\n+--------------------------------------+-----------+--------+------------+-------------+-----------------+\n| ID                                   | Name      | Status | Task State | Power State | Networks        |\n+--------------------------------------+-----------+--------+------------+-------------+-----------------+\n| 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9 | test_iso8 | ACTIVE | -          | Running     | net01=5.5.5.249 |\n+--------------------------------------+-----------+--------+------------+-------------+-----------------+\n[root@slot4 ~(keystone_admin)]# nova instance-action-list 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9\n+-------------------+------------------------------------------+---------+----------------------------+\n| Action            | Request_ID                               | Message | Start_Time                 |\n+-------------------+------------------------------------------+---------+----------------------------+\n| create            | req-25400b17-6c33-45e5-ae4e-87cba0d0de15 | -       | 2016-06-22T04:40:43.000000 |\n| stop              | req-5a7d26eb-79d3-4e69-86a8-d40c02bc6a00 | -       | 2016-06-22T07:08:23.000000 |\n+-------------------+------------------------------------------+---------+----------------------------+\n\nnova-compute.log error information:\n2016-06-22 15:08:29.942 28875 ERROR nova.compute.manager [req-b6bbfa68-334c-4c31-9f6d-4d5523cebc4d - - - - -] [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] Failed to stop instance\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] Traceback (most recent call last):\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 1304, in _init_instance\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     self.stop_instance(context, instance)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     payload)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     six.reraise(self.type_, self.value, self.tb)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     return f(self, context, *args, **kw)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 377, in decorated_function\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     LOG.warning(msg, e, instance_uuid=instance_uuid)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     six.reraise(self.type_, self.value, self.tb)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 348, in decorated_function\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     return function(self, context, *args, **kwargs)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 426, in decorated_function\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     with compute_utils.EventReporter(context, event_name, instance_uuid):\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/compute/utils.py\", line 540, in __enter__\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     self.context, uuid, self.event_name, want_result=False)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/objects/base.py\", line 161, in wrapper\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     args, kwargs)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/conductor/rpcapi.py\", line 335, in object_class_action\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     objver=objver, args=args, kwargs=kwargs)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 156, in call\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     retry=self.retry)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     timeout=timeout, retry=retry)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 350, in send\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     retry=retry)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 341, in _send\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     raise result\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] InstanceActionNotFound_Remote: Action for request_id req-e8ef400f-ca1b-4252-a2aa-9d749cd57ae4 on instance 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9 not found\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] Traceback (most recent call last):\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] \n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/conductor/manager.py\", line 426, in _object_dispatch\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     return getattr(target, method)(*args, **kwargs)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] \n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/objects/base.py\", line 163, in wrapper\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     result = fn(cls, context, *args, **kwargs)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] \n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/objects/instance_action.py\", line 170, in event_start\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     db_event = db.action_event_start(context, values)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] \n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/db/api.py\", line 1858, in action_event_start\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     return IMPL.action_event_start(context, values)\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] \n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 5748, in action_event_start\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9]     instance_uuid=values['instance_uuid'])\n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] \n2016-06-22 15:08:29.942 28875 TRACE nova.compute.manager [instance: 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9] InstanceActionNotFound: Action for request_id req-e8ef400f-ca1b-4252-a2aa-9d749cd57ae4 on instance 40d78f1d-38fc-4bfb-8e7e-a3dfe60398d9 not found", 
            "date_created": "2016-06-22 08:37:34.007147+00:00", 
            "author": "https://api.launchpad.net/1.0/~song-ruixia"
        }, 
        {
            "content": "The reason for the question is that the request id in _init_instance is different to the stop action request id, then it can not find action by request_id from instance_actions table.", 
            "date_created": "2016-06-23 01:48:28.539854+00:00", 
            "author": "https://api.launchpad.net/1.0/~song-ruixia"
        }
    ], 
    "closed": "2016-06-24 02:07:49.344122+00:00"
}