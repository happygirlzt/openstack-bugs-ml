{
    "status": "Invalid", 
    "last_updated": "2014-02-10 10:11:58.985519+00:00", 
    "description": "When testing OpenStack in my local environment, downloading package or yum install takes a lot of time.\n\nThus, I enable squid in all nodes, by pointing http_proxy to a local squid server.\n,-----------\n| echo \"export http_proxy='http://denny:@192.168.209.1:3128/'\" >>/etc/profile\n`-----------\n\nsquid client works well, but nova cli fail.\n,-----------\n| [root@control ~(keystone_admin)]# nova --debug hypervisor-show 1\n| nova --debug hypervisor-show 1\n| \n| REQ: curl -i http://192.168.209.131:35357/v2.0/tokens -X POST -H \"Content-Type: application/json\" -H \"Accept: application/json\" -H \"User-Agent: python-novaclient\" -d '{\"auth\": {\"tenantName\": \"admin\", \"passwordCredentials\": {\"username\": \"admin\", \"password\": \"9d278a0b5fcc4f4e\"}}}'\n| \n| INFO (connectionpool:203) Starting new HTTP connection (1): 192.168.209.1\n| DEBUG (connectionpool:295) \"POST http://192.168.209.131:35357/v2.0/tokens HTTP/1.1\" 504 1113\n| RESP: [504] {'content-length': '1113', 'via': '1.0 macs-mac-mini.att.net:3128 (squid/2.7.STABLE9)', 'x-cache': 'MISS from macs-mac-mini.att.net', 'x-squid-error': 'ERR_CONNECT_FAIL 61', 'server': 'squid/2.7.STABLE9', 'connection': 'close', 'date': 'Sat, 28 Dec 2013 21:08:08 GMT', 'content-type': 'text/html'}\n| RESP BODY: <!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n| <HTML><HEAD><META HTTP-EQUIV=\"Content-Type\" CONTENT=\"text/html; charset=iso-8859-1\">\n| <TITLE>ERROR: The requested URL could not be retrieved</TITLE>\n| <STYLE type=\"text/css\"><!--BODY{background-color:#ffffff;font-family:verdana,sans-serif}PRE{font-family:sans-serif}--></STYLE>\n| </HEAD><BODY>\n| <H1>ERROR</H1>\n| <H2>The requested URL could not be retrieved</H2>\n| <HR noshade size=\"1px\">\n| <P>\n| While trying to retrieve the URL:\n| <A HREF=\"http://192.168.209.131:35357/v2.0/tokens\">http://192.168.209.131:35357/v2.0/tokens</A>\n| <P>\n| The following error was encountered:\n| <UL>\n| <LI>\n| <STRONG>\n| Connection to 192.168.209.131 Failed\n| </STRONG>\n| </UL>\n| \n| <P>\n| The system returned:\n| <PRE><I>    (61) Connection refused</I></PRE>\n| \n| <P>\n| The remote host or network may be down.  Please try the request again.\n| <P>Your cache administrator is <A HREF=\"mailto:webmaster\">webmaster</A>. \n| \n| <BR clear=\"all\">\n| <HR noshade size=\"1px\">\n| <ADDRESS>\n| Generated Sat, 28 Dec 2013 21:08:08 GMT by macs-mac-mini.att.net (squid/2.7.STABLE9)\n| </ADDRESS>\n| </BODY></HTML>\n| \n| \n| DEBUG (shell:740) <attribute 'message' of 'exceptions.BaseException' objects> (HTTP 504)\n| Traceback (most recent call last):\n|   File \"/usr/lib/python2.6/site-packages/novaclient/shell.py\", line 737, in main\n|     OpenStackComputeShell().main(map(strutils.safe_decode, sys.argv[1:]))\n|   File \"/usr/lib/python2.6/site-packages/novaclient/shell.py\", line 667, in main\n|     self.cs.authenticate()\n|   File \"/usr/lib/python2.6/site-packages/novaclient/v1_1/client.py\", line 171, in authenticate\n|     self.client.authenticate()\n|   File \"/usr/lib/python2.6/site-packages/novaclient/client.py\", line 329, in authenticate\n|     auth_url = self._v2_auth(auth_url)\n|   File \"/usr/lib/python2.6/site-packages/novaclient/client.py\", line 411, in _v2_auth\n|     return self._authenticate(url, body)\n|   File \"/usr/lib/python2.6/site-packages/novaclient/client.py\", line 423, in _authenticate\n|     **kwargs)\n|   File \"/usr/lib/python2.6/site-packages/novaclient/client.py\", line 195, in _time_request\n|     resp, body = self.request(url, method, **kwargs)\n|   File \"/usr/lib/python2.6/site-packages/novaclient/client.py\", line 189, in request\n|     raise exceptions.from_response(resp, body, url, method)\n| ClientException: <attribute 'message' of 'exceptions.BaseException' objects> (HTTP 504)\n| ERROR: <attribute 'message' of 'exceptions.BaseException' objects> (HTTP 504)\n`-----------", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1264748", 
    "owner": "None", 
    "id": 1264748, 
    "index": 5683, 
    "openned": "2013-12-28 21:37:31.478220+00:00", 
    "created": "2013-12-28 21:37:31.478220+00:00", 
    "title": "nova command fails, when enable squid client in /etc/profile", 
    "comments": [
        {
            "content": "When testing OpenStack in my local environment, downloading package or yum install takes a lot of time.\n\nThus, I enable squid in all nodes, by pointing http_proxy to a local squid server.\n,-----------\n| echo \"export http_proxy='http://denny:@192.168.209.1:3128/'\" >>/etc/profile\n`-----------\n\nsquid client works well, but nova cli fail.\n,-----------\n| [root@control ~(keystone_admin)]# nova --debug hypervisor-show 1\n| nova --debug hypervisor-show 1\n| \n| REQ: curl -i http://192.168.209.131:35357/v2.0/tokens -X POST -H \"Content-Type: application/json\" -H \"Accept: application/json\" -H \"User-Agent: python-novaclient\" -d '{\"auth\": {\"tenantName\": \"admin\", \"passwordCredentials\": {\"username\": \"admin\", \"password\": \"9d278a0b5fcc4f4e\"}}}'\n| \n| INFO (connectionpool:203) Starting new HTTP connection (1): 192.168.209.1\n| DEBUG (connectionpool:295) \"POST http://192.168.209.131:35357/v2.0/tokens HTTP/1.1\" 504 1113\n| RESP: [504] {'content-length': '1113', 'via': '1.0 macs-mac-mini.att.net:3128 (squid/2.7.STABLE9)', 'x-cache': 'MISS from macs-mac-mini.att.net', 'x-squid-error': 'ERR_CONNECT_FAIL 61', 'server': 'squid/2.7.STABLE9', 'connection': 'close', 'date': 'Sat, 28 Dec 2013 21:08:08 GMT', 'content-type': 'text/html'}\n| RESP BODY: <!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\">\n| <HTML><HEAD><META HTTP-EQUIV=\"Content-Type\" CONTENT=\"text/html; charset=iso-8859-1\">\n| <TITLE>ERROR: The requested URL could not be retrieved</TITLE>\n| <STYLE type=\"text/css\"><!--BODY{background-color:#ffffff;font-family:verdana,sans-serif}PRE{font-family:sans-serif}--></STYLE>\n| </HEAD><BODY>\n| <H1>ERROR</H1>\n| <H2>The requested URL could not be retrieved</H2>\n| <HR noshade size=\"1px\">\n| <P>\n| While trying to retrieve the URL:\n| <A HREF=\"http://192.168.209.131:35357/v2.0/tokens\">http://192.168.209.131:35357/v2.0/tokens</A>\n| <P>\n| The following error was encountered:\n| <UL>\n| <LI>\n| <STRONG>\n| Connection to 192.168.209.131 Failed\n| </STRONG>\n| </UL>\n| \n| <P>\n| The system returned:\n| <PRE><I>    (61) Connection refused</I></PRE>\n| \n| <P>\n| The remote host or network may be down.  Please try the request again.\n| <P>Your cache administrator is <A HREF=\"mailto:webmaster\">webmaster</A>. \n| \n| <BR clear=\"all\">\n| <HR noshade size=\"1px\">\n| <ADDRESS>\n| Generated Sat, 28 Dec 2013 21:08:08 GMT by macs-mac-mini.att.net (squid/2.7.STABLE9)\n| </ADDRESS>\n| </BODY></HTML>\n| \n| \n| DEBUG (shell:740) <attribute 'message' of 'exceptions.BaseException' objects> (HTTP 504)\n| Traceback (most recent call last):\n|   File \"/usr/lib/python2.6/site-packages/novaclient/shell.py\", line 737, in main\n|     OpenStackComputeShell().main(map(strutils.safe_decode, sys.argv[1:]))\n|   File \"/usr/lib/python2.6/site-packages/novaclient/shell.py\", line 667, in main\n|     self.cs.authenticate()\n|   File \"/usr/lib/python2.6/site-packages/novaclient/v1_1/client.py\", line 171, in authenticate\n|     self.client.authenticate()\n|   File \"/usr/lib/python2.6/site-packages/novaclient/client.py\", line 329, in authenticate\n|     auth_url = self._v2_auth(auth_url)\n|   File \"/usr/lib/python2.6/site-packages/novaclient/client.py\", line 411, in _v2_auth\n|     return self._authenticate(url, body)\n|   File \"/usr/lib/python2.6/site-packages/novaclient/client.py\", line 423, in _authenticate\n|     **kwargs)\n|   File \"/usr/lib/python2.6/site-packages/novaclient/client.py\", line 195, in _time_request\n|     resp, body = self.request(url, method, **kwargs)\n|   File \"/usr/lib/python2.6/site-packages/novaclient/client.py\", line 189, in request\n|     raise exceptions.from_response(resp, body, url, method)\n| ClientException: <attribute 'message' of 'exceptions.BaseException' objects> (HTTP 504)\n| ERROR: <attribute 'message' of 'exceptions.BaseException' objects> (HTTP 504)\n`-----------", 
            "date_created": "2013-12-28 21:37:31.478220+00:00", 
            "author": "https://api.launchpad.net/1.0/~denny-6"
        }, 
        {
            "content": "So I tested this by:\n\n - bringing up a new VM in a public cloud\n - installing devstack\n - verifying that I could boot an instance in devstack\n - installing / configuring squid\n - verified squid was working\n - made python nova client requests\n\nThese requests appear in the squid log, and work for me.\n\nAre there additional steps I need to duplicate this problem, or is it perhaps a local squid misconfiguration?", 
            "date_created": "2013-12-29 22:49:28.576744+00:00", 
            "author": "https://api.launchpad.net/1.0/~mikal"
        }, 
        {
            "content": "I think maybe the openstack management network should not be proxied. I use another proxy software in my local env and set openstack management network to ignore list.", 
            "date_created": "2013-12-30 04:23:10.806924+00:00", 
            "author": "https://api.launchpad.net/1.0/~aji-zqfan"
        }, 
        {
            "content": "i encountered this issue, when i use command \"nova volume-list --all-tenants 1\", it gave the follow error message \"ERROR: <attribute 'message' of 'exceptions.BaseException' objects> (HTTP 504)\"", 
            "date_created": "2014-02-10 10:11:57.714898+00:00", 
            "author": "https://api.launchpad.net/1.0/~yilong-sun"
        }
    ], 
    "closed": "2014-02-04 04:05:11.246597+00:00"
}