{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:43:43.143200+00:00", 
    "description": "In case a floating ip address is associated with a new instance via EC2 API call (AssociateAddress) and the address was already in use by another instance an exception is raised in the EC2 API and a error is returned to the caller of the API.\n\nAccording to EC2 API Documentation this should not be the case and the address should be assigned to the new instance:\n\"\"\"\nFor EC2 addresses: This action associates an Elastic IP address with an instance (not running in a VPC). If the IP address is currently assigned to another instance, the IP address is assigned to the new instance. For more information about EC2 Elastic IP addresses, go to Instance Addressing in the Amazon Elastic Compute Cloud User Guide.\n\"\"\"\n\nVERSION INFO:\nEssex ubuntu package nova-api 2012.1-0ubuntu2\n\nTRACES:\n\n(nova.api.ec2): 2012-05-26 13:17:57,379 ERROR Unexpected error raised: Remote error: FloatingIpAssociated Floating ip 172.31.237.80 is associated.\n[u'Traceback (most recent call last):\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 252, in _process_data\\n    rval = node_func(context=ctxt, **node_args)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 258, in wrapped\\n    return func(self, context, *args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 453, in associate_floating_ip\\n    raise exception.FloatingIpAssociated(address=floating_address)\\n', u'FloatingIpAssociated: Floating ip 172.31.237.80 is associated.\\n'].\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/dist-packages/nova/api/ec2/__init__.py\", line 582, in __call__\n    result = api_request.invoke(context)\n  File \"/usr/lib/python2.7/dist-packages/nova/api/ec2/apirequest.py\", line 81, in invoke\n    result = method(context, **args)\n  File \"/usr/lib/python2.7/dist-packages/nova/api/ec2/cloud.py\", line 1291, in associate_address\n    address=public_ip)\n  File \"/usr/lib/python2.7/dist-packages/nova/compute/api.py\", line 100, in wrapped\n    return func(self, context, target, *args, **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/nova/compute/api.py\", line 1638, in associate_floating_ip\n    floating_address=address, fixed_address=ips[0]['address'])\n  File \"/usr/lib/python2.7/dist-packages/nova/network/api.py\", line 146, in associate_floating_ip\n    'affect_auto_assigned': affect_auto_assigned}})\n  File \"/usr/lib/python2.7/dist-packages/nova/rpc/__init__.py\", line 68, in call\n    return _get_impl().call(context, topic, msg, timeout)\n  File \"/usr/lib/python2.7/dist-packages/nova/rpc/impl_kombu.py\", line 674, in call\n    return rpc_amqp.call(context, topic, msg, timeout, Connection.pool)\n  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 338, in call\n    rv = list(rv)\n  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 306, in __iter__\n    raise result\nRemoteError: Remote error: FloatingIpAssociated Floating ip 172.31.237.80 is associated.", 
    "tags": [
        "ec2"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1004860", 
    "owner": "https://api.launchpad.net/1.0/~jtran", 
    "id": 1004860, 
    "index": 2923, 
    "openned": "2012-05-26 11:33:26.668977+00:00", 
    "created": "2012-05-26 11:33:26.668977+00:00", 
    "title": "EC2 API AssociateAddress not compliant on addresses already in use", 
    "comments": [
        {
            "content": "In case a floating ip address is associated with a new instance via EC2 API call (AssociateAddress) and the address was already in use by another instance an exception is raised in the EC2 API and a error is returned to the caller of the API.\n\nAccording to EC2 API Documentation this should not be the case and the address should be assigned to the new instance:\n\"\"\"\nFor EC2 addresses: This action associates an Elastic IP address with an instance (not running in a VPC). If the IP address is currently assigned to another instance, the IP address is assigned to the new instance. For more information about EC2 Elastic IP addresses, go to Instance Addressing in the Amazon Elastic Compute Cloud User Guide.\n\"\"\"\n\nVERSION INFO:\nEssex ubuntu package nova-api 2012.1-0ubuntu2\n\nTRACES:\n\n(nova.api.ec2): 2012-05-26 13:17:57,379 ERROR Unexpected error raised: Remote error: FloatingIpAssociated Floating ip 172.31.237.80 is associated.\n[u'Traceback (most recent call last):\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 252, in _process_data\\n    rval = node_func(context=ctxt, **node_args)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 258, in wrapped\\n    return func(self, context, *args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 453, in associate_floating_ip\\n    raise exception.FloatingIpAssociated(address=floating_address)\\n', u'FloatingIpAssociated: Floating ip 172.31.237.80 is associated.\\n'].\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/dist-packages/nova/api/ec2/__init__.py\", line 582, in __call__\n    result = api_request.invoke(context)\n  File \"/usr/lib/python2.7/dist-packages/nova/api/ec2/apirequest.py\", line 81, in invoke\n    result = method(context, **args)\n  File \"/usr/lib/python2.7/dist-packages/nova/api/ec2/cloud.py\", line 1291, in associate_address\n    address=public_ip)\n  File \"/usr/lib/python2.7/dist-packages/nova/compute/api.py\", line 100, in wrapped\n    return func(self, context, target, *args, **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/nova/compute/api.py\", line 1638, in associate_floating_ip\n    floating_address=address, fixed_address=ips[0]['address'])\n  File \"/usr/lib/python2.7/dist-packages/nova/network/api.py\", line 146, in associate_floating_ip\n    'affect_auto_assigned': affect_auto_assigned}})\n  File \"/usr/lib/python2.7/dist-packages/nova/rpc/__init__.py\", line 68, in call\n    return _get_impl().call(context, topic, msg, timeout)\n  File \"/usr/lib/python2.7/dist-packages/nova/rpc/impl_kombu.py\", line 674, in call\n    return rpc_amqp.call(context, topic, msg, timeout, Connection.pool)\n  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 338, in call\n    rv = list(rv)\n  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 306, in __iter__\n    raise result\nRemoteError: Remote error: FloatingIpAssociated Floating ip 172.31.237.80 is associated.", 
            "date_created": "2012-05-26 11:33:26.668977+00:00", 
            "author": "https://api.launchpad.net/1.0/~vanwinkeljan"
        }, 
        {
            "content": "https://review.openstack.org/#/c/9566/", 
            "date_created": "2012-07-10 18:07:56.171057+00:00", 
            "author": "https://api.launchpad.net/1.0/~jtran"
        }, 
        {
            "content": "The above patch was merged.  But had the wrong Bug# so this bug did not get updated properly.", 
            "date_created": "2012-09-10 19:57:30.954279+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }
    ], 
    "closed": "2012-09-19 06:38:04.296838+00:00"
}