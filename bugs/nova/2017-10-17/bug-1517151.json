{
    "status": "Invalid", 
    "last_updated": "2016-09-21 13:48:09.779477+00:00", 
    "description": "OS = Ubuntu 14.04.3 LTS (GNU/Linux 3.13.0-68-generic x86_64)\nOpenstack = Liberty\nNova version = 2.17.0\n\n\nLog info\nCompute Node\n\n/var/log/nova/nova-compute.log\n\n2015-11-17 11:20:17.827 2543 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 29 seconds.\n2015-11-17 11:20:46.852 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2015-11-17 11:20:46.852 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2015-11-17 11:20:47.868 2543 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 30 seconds.\n2015-11-17 11:21:17.894 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2015-11-17 11:21:17.895 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2015-11-17 11:21:18.911 2543 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 30 seconds.\n2015-11-17 11:21:48.937 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2015-11-17 11:21:48.937 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2015-11-17 11:21:49.953 2543 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 30 seconds.\n2015-11-17 11:22:19.979 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2015-11-17 11:22:19.980 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2015-11-17 11:22:20.992 2543 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 30 seconds.\n2015-11-17 11:22:51.017 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2015-11-17 11:22:51.018 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n\nCompute Node\n/etc/nova/nova.conf\n\n[DEFAULT]\ndebug = True\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlogdir=/var/log/nova\nstate_path=/var/lib/nova\nlock_path=/var/lock/nova\nforce_dhcp_release=True\niscsi_helper=tgtadm\nlibvirt_use_virtio_for_bridges=True\nconnection_type=libvirt\nroot_helper=sudo nova-rootwrap /etc/nova/rootwrap.conf\nverbose=True\nec2_private_dns_show_ip=True\napi_paste_config=/etc/nova/api-paste.ini\nvolumes_path=/var/lib/nova/volumes\nenabled_apis=ec2,osapi_compute,metadata\nrpc_backend = rabbit\nauth_strategy = keystone\nmy_ip = 192.168.1.14\nnetwork_api_class = nova.network.neutronv2.api.API\nsecurity_group_api = neutron\nlinuxnet_interface_driver = nova.network.linux_net.NeutronLinuxBridgeInterfaceDriver\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\n\n\n[oslo_messaging_rabbit]\nrabbit_host = 192.168.1.13\nrabbit_userid = openstack\nrabbit_password = ********\n\n\nSteps\n\n- Fist, I installed Ubuntu 14.04.3 LTS in 2 physical boxes, Controller (cloud03 - 192.168.1.13) and Compute (cloud04 -192.68.1.14)\n- Then I did the base configuration on both nodes according to http://docs.openstack.org/liberty/install-guide-ubuntu/environment-packages.html\n - Then I follow the steps to configur/install the  Controller node, Add the SQL Database, then the Message queue , then add the Identity service, then Add the image Sevice.\n- Then configure the Compute service for the controller node\n - Then configure the compute service for the compute node (cloud03 - 192.168.1.14) according to http://docs.openstack.org/liberty/install-guide-ubuntu/nova-compute-install.html\n-Then restart the nova-compute service\n\nExpected result\n\ncompute node should be able to communicate with the controller node\n\nActual Result:\n\nCompute node tries to connect to the RabbitMQ server in localhost instead of the server specified in the   [oslo_messaging_rabbit] section in the /etc/nova/nova.conf file, however, if this values are moved to the [DEFAULT] section, the compute node is able to connect to the controller node", 
    "tags": [
        "nova", 
        "rabbitmq"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1517151", 
    "owner": "None", 
    "id": 1517151, 
    "index": 7119, 
    "openned": "2015-11-17 17:37:23.798419+00:00", 
    "created": "2015-11-17 17:37:23.798419+00:00", 
    "title": "Compute node looks for RabbitMQ server in localhost instead of the Controller node ignoring nova.conf configuration", 
    "comments": [
        {
            "content": "OS = Ubuntu 14.04.3 LTS (GNU/Linux 3.13.0-68-generic x86_64)\nOpenstack = Liberty\nNova version = 2.17.0\n\n\nLog info\nCompute Node\n\n/var/log/nova/nova-compute.log\n\n2015-11-17 11:20:17.827 2543 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 29 seconds.\n2015-11-17 11:20:46.852 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2015-11-17 11:20:46.852 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2015-11-17 11:20:47.868 2543 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 30 seconds.\n2015-11-17 11:21:17.894 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2015-11-17 11:21:17.895 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2015-11-17 11:21:18.911 2543 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 30 seconds.\n2015-11-17 11:21:48.937 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2015-11-17 11:21:48.937 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2015-11-17 11:21:49.953 2543 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 30 seconds.\n2015-11-17 11:22:19.979 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2015-11-17 11:22:19.980 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n2015-11-17 11:22:20.992 2543 ERROR oslo.messaging._drivers.impl_rabbit [-] AMQP server on localhost:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 30 seconds.\n2015-11-17 11:22:51.017 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on localhost:5672\n2015-11-17 11:22:51.018 2543 INFO oslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\n\nCompute Node\n/etc/nova/nova.conf\n\n[DEFAULT]\ndebug = True\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlogdir=/var/log/nova\nstate_path=/var/lib/nova\nlock_path=/var/lock/nova\nforce_dhcp_release=True\niscsi_helper=tgtadm\nlibvirt_use_virtio_for_bridges=True\nconnection_type=libvirt\nroot_helper=sudo nova-rootwrap /etc/nova/rootwrap.conf\nverbose=True\nec2_private_dns_show_ip=True\napi_paste_config=/etc/nova/api-paste.ini\nvolumes_path=/var/lib/nova/volumes\nenabled_apis=ec2,osapi_compute,metadata\nrpc_backend = rabbit\nauth_strategy = keystone\nmy_ip = 192.168.1.14\nnetwork_api_class = nova.network.neutronv2.api.API\nsecurity_group_api = neutron\nlinuxnet_interface_driver = nova.network.linux_net.NeutronLinuxBridgeInterfaceDriver\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\n\n\n[oslo_messaging_rabbit]\nrabbit_host = 192.168.1.13\nrabbit_userid = openstack\nrabbit_password = ********\n\n\nSteps\n\n- Fist, I installed Ubuntu 14.04.3 LTS in 2 physical boxes, Controller (cloud03 - 192.168.1.13) and Compute (cloud04 -192.68.1.14)\n- Then I did the base configuration on both nodes according to http://docs.openstack.org/liberty/install-guide-ubuntu/environment-packages.html\n - Then I follow the steps to configur/install the  Controller node, Add the SQL Database, then the Message queue , then add the Identity service, then Add the image Sevice.\n- Then configure the Compute service for the controller node\n - Then configure the compute service for the compute node (cloud03 - 192.168.1.14) according to http://docs.openstack.org/liberty/install-guide-ubuntu/nova-compute-install.html\n-Then restart the nova-compute service\n\nExpected result\n\ncompute node should be able to communicate with the controller node\n\nActual Result:\n\nCompute node tries to connect to the RabbitMQ server in localhost instead of the server specified in the   [oslo_messaging_rabbit] section in the /etc/nova/nova.conf file, however, if this values are moved to the [DEFAULT] section, the compute node is able to connect to the controller node", 
            "date_created": "2015-11-17 17:37:23.798419+00:00", 
            "author": "https://api.launchpad.net/1.0/~arturoiscitm"
        }, 
        {
            "content": "Can you provide version of  oslo.messaging  ,   these config options from oslo.messaging.", 
            "date_created": "2015-11-19 03:26:12.619622+00:00", 
            "author": "https://api.launchpad.net/1.0/~glongwave"
        }, 
        {
            "content": "Hi https://launchpad.net/~glongwave ,\n\nThanks for the answer, after some review, i found that for some reason my compute node pick the old code for Nova (looks like something went wrong with update && upgrade), after purge and update, it pick the right version of the code and Nova is working as expected :).\n\nI'm closing this bug\n\nThanks", 
            "date_created": "2015-11-19 17:28:58.673797+00:00", 
            "author": "https://api.launchpad.net/1.0/~arturoiscitm"
        }, 
        {
            "content": "Hii.. i am facing the same issue while adding the compute node to pre-installed openstack on another vm... i thought my compute node also picks the old code for Nova as nova-compute.log shows log of previous runs... Will you please tell me how you purge and update nova... Thank you in advance... ", 
            "date_created": "2016-09-21 13:48:08.658104+00:00", 
            "author": "https://api.launchpad.net/1.0/~suneha"
        }
    ], 
    "closed": "2015-11-19 17:29:40.436636+00:00"
}