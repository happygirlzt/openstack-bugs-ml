{
    "status": "Invalid", 
    "last_updated": "2011-06-27 13:11:21.176425+00:00", 
    "description": "I successfully create a new iscsi volume and now I try to attach it to a running instance. But I got the attached error in /var/log/nova/compute.log.\n\nares:~ # euca-describe-instances \nRESERVATION     r-0axmd0ci      testing default\nINSTANCE        i-00000079      ami-2a1izx00    192.168.3.18    192.168.3.18    running         foobar (testing, ares)  0       m1.tiny         2011-02-22T15:28:05     nova\n\nares:~ # euca-describe-volumes \nVOLUME  vol-00000001     7              nova    available (berendt, deimos, None, None) 2011-02-22T14:45:00\n\nares:~ # euca-attach-volume vol-00000001 -i i-00000079 -d /dev/vdb\nVOLUME  vol-00000001\n\n2011-02-22 16:32:34,894 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: decorating: |<function attach_volume at 0xff0050>|\n2011-02-22 16:32:34,894 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: arguments: |<nova.compute.manager.ComputeManager object at 0xf6ec90>| |<nova.context.RequestContext object at 0x13f4b50>| |121|\n2011-02-22 16:32:34,895 DEBUG nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] instance 121: getting locked state from (pid=4273) get_lock /usr/lib64/python2.6/site-packages/nova/compute/manager.py:514\n2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: locked: |False|\n2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: admin: |True|\n2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: executing: |<function attach_volume at 0xff0050>|\n2011-02-22 16:32:34,990 AUDIT nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] instance 121: attaching volume 1 to /dev/vdb\n2011-02-22 16:30:21,250 ERROR nova.root [-] Exception during message handling\n(nova.root): TRACE: Traceback (most recent call last):\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/rpc.py\", line 199, in _receive\n(nova.root): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/compute/manager.py\", line 93, in decorated_function\n(nova.root): TRACE:     function(self, context, instance_id, *args, **kwargs)\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/compute/manager.py\", line 556, in attach_volume\n(nova.root): TRACE:     volume_id)\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/manager.py\", line 159, in setup_compute_volume\n(nova.root): TRACE:     path = self.driver.discover_volume(volume_ref)\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/driver.py\", line 312, in discover_volume\n(nova.root): TRACE:     iscsi_name, iscsi_portal = self._get_name_and_portal(volume)\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/driver.py\", line 307, in _get_name_and_portal\n(nova.root): TRACE:     iscsi_portal = location.split(\",\")[0]\n(nova.root): TRACE: UnboundLocalError: local variable 'location' referenced before assignment\n(nova.root): TRACE:", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/723192", 
    "owner": "None", 
    "id": 723192, 
    "index": 3308, 
    "openned": "2011-02-22 15:33:21.801329+00:00", 
    "created": "2011-02-22 15:33:21.801329+00:00", 
    "title": "getting error 'local variable 'location' referenced before assignment' while trying to attach an iscsi target", 
    "comments": [
        {
            "content": "I successfully create a new iscsi volume and now I try to attach it to a running instance. But I got the attached error in /var/log/nova/compute.log.\n\nares:~ # euca-describe-instances \nRESERVATION     r-0axmd0ci      testing default\nINSTANCE        i-00000079      ami-2a1izx00    192.168.3.18    192.168.3.18    running         foobar (testing, ares)  0       m1.tiny         2011-02-22T15:28:05     nova\n\nares:~ # euca-describe-volumes \nVOLUME  vol-00000001     7              nova    available (berendt, deimos, None, None) 2011-02-22T14:45:00\n\nares:~ # euca-attach-volume vol-00000001 -i i-00000079 -d /dev/vdb\nVOLUME  vol-00000001\n\n2011-02-22 16:32:34,894 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: decorating: |<function attach_volume at 0xff0050>|\n2011-02-22 16:32:34,894 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: arguments: |<nova.compute.manager.ComputeManager object at 0xf6ec90>| |<nova.context.RequestContext object at 0x13f4b50>| |121|\n2011-02-22 16:32:34,895 DEBUG nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] instance 121: getting locked state from (pid=4273) get_lock /usr/lib64/python2.6/site-packages/nova/compute/manager.py:514\n2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: locked: |False|\n2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: admin: |True|\n2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: executing: |<function attach_volume at 0xff0050>|\n2011-02-22 16:32:34,990 AUDIT nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] instance 121: attaching volume 1 to /dev/vdb\n2011-02-22 16:30:21,250 ERROR nova.root [-] Exception during message handling\n(nova.root): TRACE: Traceback (most recent call last):\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/rpc.py\", line 199, in _receive\n(nova.root): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/compute/manager.py\", line 93, in decorated_function\n(nova.root): TRACE:     function(self, context, instance_id, *args, **kwargs)\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/compute/manager.py\", line 556, in attach_volume\n(nova.root): TRACE:     volume_id)\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/manager.py\", line 159, in setup_compute_volume\n(nova.root): TRACE:     path = self.driver.discover_volume(volume_ref)\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/driver.py\", line 312, in discover_volume\n(nova.root): TRACE:     iscsi_name, iscsi_portal = self._get_name_and_portal(volume)\n(nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/driver.py\", line 307, in _get_name_and_portal\n(nova.root): TRACE:     iscsi_portal = location.split(\",\")[0]\n(nova.root): TRACE: UnboundLocalError: local variable 'location' referenced before assignment\n(nova.root): TRACE:", 
            "date_created": "2011-02-22 15:33:21.801329+00:00", 
            "author": "https://api.launchpad.net/1.0/~berendt"
        }, 
        {
            "content": "you need to set --iscsi_ip_prefix (for nova-compute) to something useful.  It is essentially used as a grep to figure out which ip it should try to connect on during discovery,since discovery returns all ips of the volume-host that is exporting the volume.  So if your hosts are on 192.168.0.0/24, then set it to 192.168.0.  This will be removed once we git rid of discovery in the iscsi code.  Justin's branch is most of the way there.\n\nOn Feb 22, 2011, at 7:33 AM, Christian Berendt wrote:\n\n> Public bug reported:\n> \n> I successfully create a new iscsi volume and now I try to attach it to a\n> running instance. But I got the attached error in\n> /var/log/nova/compute.log.\n> \n> ares:~ # euca-describe-instances \n> RESERVATION     r-0axmd0ci      testing default\n> INSTANCE        i-00000079      ami-2a1izx00    192.168.3.18    192.168.3.18    running         foobar (testing, ares)  0       m1.tiny         2011-02-22T15:28:05     nova\n> \n> ares:~ # euca-describe-volumes \n> VOLUME  vol-00000001     7              nova    available (berendt, deimos, None, None) 2011-02-22T14:45:00\n> \n> ares:~ # euca-attach-volume vol-00000001 -i i-00000079 -d /dev/vdb\n> VOLUME  vol-00000001\n> \n> 2011-02-22 16:32:34,894 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: decorating: |<function attach_volume at 0xff0050>|\n> 2011-02-22 16:32:34,894 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: arguments: |<nova.compute.manager.ComputeManager object at 0xf6ec90>| |<nova.context.RequestContext object at 0x13f4b50>| |121|\n> 2011-02-22 16:32:34,895 DEBUG nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] instance 121: getting locked state from (pid=4273) get_lock /usr/lib64/python2.6/site-packages/nova/compute/manager.py:514\n> 2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: locked: |False|\n> 2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: admin: |True|\n> 2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: executing: |<function attach_volume at 0xff0050>|\n> 2011-02-22 16:32:34,990 AUDIT nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] instance 121: attaching volume 1 to /dev/vdb\n> 2011-02-22 16:30:21,250 ERROR nova.root [-] Exception during message handling\n> (nova.root): TRACE: Traceback (most recent call last):\n> (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/rpc.py\", line 199, in _receive\n> (nova.root): TRACE:     rval = node_func(context=ctxt, **node_args)\n> (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/compute/manager.py\", line 93, in decorated_function\n> (nova.root): TRACE:     function(self, context, instance_id, *args, **kwargs)\n> (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/compute/manager.py\", line 556, in attach_volume\n> (nova.root): TRACE:     volume_id)\n> (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/manager.py\", line 159, in setup_compute_volume\n> (nova.root): TRACE:     path = self.driver.discover_volume(volume_ref)\n> (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/driver.py\", line 312, in discover_volume\n> (nova.root): TRACE:     iscsi_name, iscsi_portal = self._get_name_and_portal(volume)\n> (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/driver.py\", line 307, in _get_name_and_portal\n> (nova.root): TRACE:     iscsi_portal = location.split(\",\")[0]\n> (nova.root): TRACE: UnboundLocalError: local variable 'location' referenced before assignment\n> (nova.root): TRACE:\n> \n> ** Affects: nova\n>     Importance: Undecided\n>         Status: New\n> \n> -- \n> You received this bug notification because you are a member of Nova Bug\n> Team, which is subscribed to OpenStack Compute (nova).\n> https://bugs.launchpad.net/bugs/723192\n> \n> Title:\n>  getting error \"local variable 'location' referenced before assignment\"\n>  while trying to attach an iscsi target\n> \n> Status in OpenStack Compute (Nova):\n>  New\n> \n> Bug description:\n>  I successfully create a new iscsi volume and now I try to attach it to\n>  a running instance. But I got the attached error in\n>  /var/log/nova/compute.log.\n> \n>  ares:~ # euca-describe-instances \n>  RESERVATION     r-0axmd0ci      testing default\n>  INSTANCE        i-00000079      ami-2a1izx00    192.168.3.18    192.168.3.18    running         foobar (testing, ares)  0       m1.tiny         2011-02-22T15:28:05     nova\n> \n>  ares:~ # euca-describe-volumes \n>  VOLUME  vol-00000001     7              nova    available (berendt, deimos, None, None) 2011-02-22T14:45:00\n> \n>  ares:~ # euca-attach-volume vol-00000001 -i i-00000079 -d /dev/vdb\n>  VOLUME  vol-00000001\n> \n>  2011-02-22 16:32:34,894 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: decorating: |<function attach_volume at 0xff0050>|\n>  2011-02-22 16:32:34,894 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: arguments: |<nova.compute.manager.ComputeManager object at 0xf6ec90>| |<nova.context.RequestContext object at 0x13f4b50>| |121|\n>  2011-02-22 16:32:34,895 DEBUG nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] instance 121: getting locked state from (pid=4273) get_lock /usr/lib64/python2.6/site-packages/nova/compute/manager.py:514\n>  2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: locked: |False|\n>  2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: admin: |True|\n>  2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: executing: |<function attach_volume at 0xff0050>|\n>  2011-02-22 16:32:34,990 AUDIT nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] instance 121: attaching volume 1 to /dev/vdb\n>  2011-02-22 16:30:21,250 ERROR nova.root [-] Exception during message handling\n>  (nova.root): TRACE: Traceback (most recent call last):\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/rpc.py\", line 199, in _receive\n>  (nova.root): TRACE:     rval = node_func(context=ctxt, **node_args)\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/compute/manager.py\", line 93, in decorated_function\n>  (nova.root): TRACE:     function(self, context, instance_id, *args, **kwargs)\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/compute/manager.py\", line 556, in attach_volume\n>  (nova.root): TRACE:     volume_id)\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/manager.py\", line 159, in setup_compute_volume\n>  (nova.root): TRACE:     path = self.driver.discover_volume(volume_ref)\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/driver.py\", line 312, in discover_volume\n>  (nova.root): TRACE:     iscsi_name, iscsi_portal = self._get_name_and_portal(volume)\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/driver.py\", line 307, in _get_name_and_portal\n>  (nova.root): TRACE:     iscsi_portal = location.split(\",\")[0]\n>  (nova.root): TRACE: UnboundLocalError: local variable 'location' referenced before assignment\n>  (nova.root): TRACE:\n\n", 
            "date_created": "2011-02-22 17:40:21+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "I added \"--iscsi_ip_prefix=192.168.3.\" (using network 192.168.3.0/24) to my nova.conf, but still not working.\n\nares:~ # iscsiadm -m discovery -t sendtargets -p deimos\n192.168.2.140:3260,1 iqn.2010-10.org.openstack:volume-00000001\n\nFirst question: I'm running all my services in the 192.168.2.0/24 network, all running instances will get an ip address in 192.168.3.0/24. If I understood you in the right way I should set the prefix to the network where my instances are located. Differs the output of iscsiadm (produced on a SLES system) to the output of a ubuntu system? I don't think so. Probably I missunderstood you...\n\nI changed the flag to --iscsi_ip_prefix=192.168.2. and now it's working fine... (got a new device /dev/vdb on the instance... [  913.710033]  vdb: unknown partition table).\n\nAlso there is a missing check in _get_name_and_portal(self, volume) in nova/volume/driver.py. iscsiadm is called (not checking if there was some kind of error) and then it iterates through the results. If there is not entry matching FLAGS.iscsi_ip_prefix (which is $my_ip per default btw...) the method doesn't notice this.\n\nNot sure to commit a bugfix if there will come in some new code (Justin's branch).\n\n    def _get_name_and_portal(self, volume):\n        \"\"\"Gets iscsi name and portal from volume name and host.\"\"\"\n        volume_name = volume['name']\n        host = volume['host']\n        (out, _err) = self._execute(\"sudo iscsiadm -m discovery -t \"\n                                    \"sendtargets -p %s\" % host)\n        for target in out.splitlines():\n            if FLAGS.iscsi_ip_prefix in target and volume_name in target:\n                (location, _sep, iscsi_name) = target.partition(\" \")\n                break\n        iscsi_portal = location.split(\",\")[0]\n        return (iscsi_name, iscsi_portal)", 
            "date_created": "2011-02-22 21:53:41.509687+00:00", 
            "author": "https://api.launchpad.net/1.0/~berendt"
        }, 
        {
            "content": "Actually, it should be the prefix where the hosts are running.  Better error checking would be good.  It should also put a specific ip into the db instead of using a prefix, which would get rid of the need to use discover.\n\nVish\nOn Feb 22, 2011, at 1:53 PM, Christian Berendt wrote:\n\n> I added \"--iscsi_ip_prefix=192.168.3.\" (using network 192.168.3.0/24) to\n> my nova.conf, but still not working.\n> \n> ares:~ # iscsiadm -m discovery -t sendtargets -p deimos\n> 192.168.2.140:3260,1 iqn.2010-10.org.openstack:volume-00000001\n> \n> First question: I'm running all my services in the 192.168.2.0/24\n> network, all running instances will get an ip address in 192.168.3.0/24.\n> If I understood you in the right way I should set the prefix to the\n> network where my instances are located. Differs the output of iscsiadm\n> (produced on a SLES system) to the output of a ubuntu system? I don't\n> think so. Probably I missunderstood you...\n> \n> I changed the flag to --iscsi_ip_prefix=192.168.2. and now it's working\n> fine... (got a new device /dev/vdb on the instance... [  913.710033]\n> vdb: unknown partition table).\n> \n> Also there is a missing check in _get_name_and_portal(self, volume) in\n> nova/volume/driver.py. iscsiadm is called (not checking if there was\n> some kind of error) and then it iterates through the results. If there\n> is not entry matching FLAGS.iscsi_ip_prefix (which is $my_ip per default\n> btw...) the method doesn't notice this.\n> \n> Not sure to commit a bugfix if there will come in some new code\n> (Justin's branch).\n> \n>    def _get_name_and_portal(self, volume):\n>        \"\"\"Gets iscsi name and portal from volume name and host.\"\"\"\n>        volume_name = volume['name']\n>        host = volume['host']\n>        (out, _err) = self._execute(\"sudo iscsiadm -m discovery -t \"\n>                                    \"sendtargets -p %s\" % host)\n>        for target in out.splitlines():\n>            if FLAGS.iscsi_ip_prefix in target and volume_name in target:\n>                (location, _sep, iscsi_name) = target.partition(\" \")\n>                break\n>        iscsi_portal = location.split(\",\")[0]\n>        return (iscsi_name, iscsi_portal)\n> \n> -- \n> You received this bug notification because you are a member of Nova Bug\n> Team, which is subscribed to OpenStack Compute (nova).\n> https://bugs.launchpad.net/bugs/723192\n> \n> Title:\n>  getting error \"local variable 'location' referenced before assignment\"\n>  while trying to attach an iscsi target\n> \n> Status in OpenStack Compute (Nova):\n>  New\n> \n> Bug description:\n>  I successfully create a new iscsi volume and now I try to attach it to\n>  a running instance. But I got the attached error in\n>  /var/log/nova/compute.log.\n> \n>  ares:~ # euca-describe-instances \n>  RESERVATION     r-0axmd0ci      testing default\n>  INSTANCE        i-00000079      ami-2a1izx00    192.168.3.18    192.168.3.18    running         foobar (testing, ares)  0       m1.tiny         2011-02-22T15:28:05     nova\n> \n>  ares:~ # euca-describe-volumes \n>  VOLUME  vol-00000001     7              nova    available (berendt, deimos, None, None) 2011-02-22T14:45:00\n> \n>  ares:~ # euca-attach-volume vol-00000001 -i i-00000079 -d /dev/vdb\n>  VOLUME  vol-00000001\n> \n>  2011-02-22 16:32:34,894 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: decorating: |<function attach_volume at 0xff0050>|\n>  2011-02-22 16:32:34,894 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: arguments: |<nova.compute.manager.ComputeManager object at 0xf6ec90>| |<nova.context.RequestContext object at 0x13f4b50>| |121|\n>  2011-02-22 16:32:34,895 DEBUG nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] instance 121: getting locked state from (pid=4273) get_lock /usr/lib64/python2.6/site-packages/nova/compute/manager.py:514\n>  2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: locked: |False|\n>  2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: admin: |True|\n>  2011-02-22 16:32:34,944 INFO nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] check_instance_lock: executing: |<function attach_volume at 0xff0050>|\n>  2011-02-22 16:32:34,990 AUDIT nova.compute.manager [JRZCL-3E16YICPXKCARK berendt testing] instance 121: attaching volume 1 to /dev/vdb\n>  2011-02-22 16:30:21,250 ERROR nova.root [-] Exception during message handling\n>  (nova.root): TRACE: Traceback (most recent call last):\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/rpc.py\", line 199, in _receive\n>  (nova.root): TRACE:     rval = node_func(context=ctxt, **node_args)\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/compute/manager.py\", line 93, in decorated_function\n>  (nova.root): TRACE:     function(self, context, instance_id, *args, **kwargs)\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/compute/manager.py\", line 556, in attach_volume\n>  (nova.root): TRACE:     volume_id)\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/manager.py\", line 159, in setup_compute_volume\n>  (nova.root): TRACE:     path = self.driver.discover_volume(volume_ref)\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/driver.py\", line 312, in discover_volume\n>  (nova.root): TRACE:     iscsi_name, iscsi_portal = self._get_name_and_portal(volume)\n>  (nova.root): TRACE:   File \"/usr/lib64/python2.6/site-packages/nova/volume/driver.py\", line 307, in _get_name_and_portal\n>  (nova.root): TRACE:     iscsi_portal = location.split(\",\")[0]\n>  (nova.root): TRACE: UnboundLocalError: local variable 'location' referenced before assignment\n>  (nova.root): TRACE:\n\n", 
            "date_created": "2011-02-22 22:28:21+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "What hypervisor are you using? If you're using xapi the flags you need are:\n\ntarget_host:                the iSCSI Target Host IP address, i.e. the IP address for the nova-volume host\ntarget_port:                iSCSI Target Port, 3260 Default\niqn_prefix:                 IQN Prefix, e.g. 'iqn.2010-10.org.openstack'\n\nThis part of the code would do with a bit of cleaning. More info on:\n\nhttps://bugs.launchpad.net/nova/+bug/695045\nhttp://wiki.openstack.org/iSCSISupportXenAPI\n", 
            "date_created": "2011-02-23 09:19:53.795524+00:00", 
            "author": "https://api.launchpad.net/1.0/~armando-migliaccio"
        }, 
        {
            "content": "@Christian: any chance you could provide the requested information ? We can't really make progress on this without your input.", 
            "date_created": "2011-03-16 11:02:03.095668+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "Closing in absence of response from reporter. Please reopen if you can still reproduce with current version.", 
            "date_created": "2011-06-27 13:11:19.407292+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }
    ], 
    "closed": "2011-06-27 13:11:20.191432+00:00"
}