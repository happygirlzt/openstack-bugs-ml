{
    "status": "Invalid", 
    "last_updated": "2014-07-25 07:36:15.349019+00:00", 
    "description": "Post migration operation fails  after successful migration, and fields \"node\",\"host\",\"task_state\"  in the table \"instances\" are not changed in nova database.  When nova configured to work with neutron:\n\ngrep neutron /etc/nova/nova.conf :\n\nnetwork_api_class=nova.network.neutronv2.api.API\nneutron_url=http://controller:9696\nneutron_auth_strategy=keystone\nneutron_admin_tenant_name=service\nneutron_admin_username=neutron\nneutron_admin_password=pass\nneutron_admin_auth_url=http://controller:35357/v2.0\nneutron_metadata_proxy_shared_secret = pass\nservice_neutron_metadata_proxy = true\n\nLatest nova/neutron code in Trusty:\n nova-compute                        1:2014.1-0ubuntu1 \n python-novaclient                   1:2.17.0-0ubuntu1 \npython-neutronclient                1:2.3.4-0ubuntu1   \n neutron-common                      1:2014.1~rc2-0ubuntu4  \n\n /var/log/nova/nova-compute.log has stacktrace:\nTRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\nTRACE oslo.messaging.rpc.dispatcher     incoming.message))\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\nTRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\nTRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 399, in decorated_function\nTRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 88, in wrapped\nTRACE oslo.messaging.rpc.dispatcher     payload)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\nTRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 71, in wrapped\n8 TRACE oslo.messaging.rpc.dispatcher     return f(self, context, *args, **kw)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 309, in decorated_function\nTRACE oslo.messaging.rpc.dispatcher     e, sys.exc_info())\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\nTRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 296, in decorated_function\nTRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 4669, in post_live_migration_at_destination\nTRACE oslo.messaging.rpc.dispatcher     migration)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/conductor/api.py\", line 259, in network_migrate_instance_finish\nTRACE oslo.messaging.rpc.dispatcher     migration)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/conductor/rpcapi.py\", line 391, in network_migrate_instance_finish\nTRACE oslo.messaging.rpc.dispatcher     instance=instance_p, migration=migration_p)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/client.py\", line 150, in call\nTRACE oslo.messaging.rpc.dispatcher     wait_for_reply=True, timeout=timeout)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/transport.py\", line 90, in _send\nTRACE oslo.messaging.rpc.dispatcher     timeout=timeout)\n TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 412, in send\n TRACE oslo.messaging.rpc.dispatcher     return self._send(target, ctxt, message, wait_for_reply, timeout)\n TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 405, in _send\nTRACE oslo.messaging.rpc.dispatcher     raise result\nTRACE oslo.messaging.rpc.dispatcher RemoteError: Remote error: ConnectionFailed Connection to neutron failed: Maximum attempts reached", 
    "tags": [
        "net"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1309055", 
    "owner": "None", 
    "id": 1309055, 
    "index": 6040, 
    "openned": "2014-04-17 14:55:56.839313+00:00", 
    "created": "2014-04-17 14:55:56.839313+00:00", 
    "title": " Post operation of migration  fails whith 'Connection to neutron failed' error", 
    "comments": [
        {
            "content": "Post migration operation fails  after successful migration, and fields \"node\",\"host\",\"task_state\"  in the table \"instances\" are not changed in nova database.  When nova configured to work with neutron:\n\ngrep neutron /etc/nova/nova.conf :\n\nnetwork_api_class=nova.network.neutronv2.api.API\nneutron_url=http://controller:9696\nneutron_auth_strategy=keystone\nneutron_admin_tenant_name=service\nneutron_admin_username=neutron\nneutron_admin_password=pass\nneutron_admin_auth_url=http://controller:35357/v2.0\nneutron_metadata_proxy_shared_secret = pass\nservice_neutron_metadata_proxy = true\n\nLatest nova/neutron code in Trusty:\n nova-compute                        1:2014.1-0ubuntu1 \n python-novaclient                   1:2.17.0-0ubuntu1 \npython-neutronclient                1:2.3.4-0ubuntu1   \n neutron-common                      1:2014.1~rc2-0ubuntu4  \n\n /var/log/nova/nova-compute.log has stacktrace:\nTRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\nTRACE oslo.messaging.rpc.dispatcher     incoming.message))\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\nTRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\nTRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 399, in decorated_function\nTRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 88, in wrapped\nTRACE oslo.messaging.rpc.dispatcher     payload)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\nTRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 71, in wrapped\n8 TRACE oslo.messaging.rpc.dispatcher     return f(self, context, *args, **kw)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 309, in decorated_function\nTRACE oslo.messaging.rpc.dispatcher     e, sys.exc_info())\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\nTRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 296, in decorated_function\nTRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 4669, in post_live_migration_at_destination\nTRACE oslo.messaging.rpc.dispatcher     migration)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/conductor/api.py\", line 259, in network_migrate_instance_finish\nTRACE oslo.messaging.rpc.dispatcher     migration)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/conductor/rpcapi.py\", line 391, in network_migrate_instance_finish\nTRACE oslo.messaging.rpc.dispatcher     instance=instance_p, migration=migration_p)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/client.py\", line 150, in call\nTRACE oslo.messaging.rpc.dispatcher     wait_for_reply=True, timeout=timeout)\nTRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/transport.py\", line 90, in _send\nTRACE oslo.messaging.rpc.dispatcher     timeout=timeout)\n TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 412, in send\n TRACE oslo.messaging.rpc.dispatcher     return self._send(target, ctxt, message, wait_for_reply, timeout)\n TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 405, in _send\nTRACE oslo.messaging.rpc.dispatcher     raise result\nTRACE oslo.messaging.rpc.dispatcher RemoteError: Remote error: ConnectionFailed Connection to neutron failed: Maximum attempts reached", 
            "date_created": "2014-04-17 14:55:56.839313+00:00", 
            "author": "https://api.launchpad.net/1.0/~gnomino"
        }, 
        {
            "content": "Still present after apdate from repo ppa:openstack-ubuntu-testing/icehouse\n", 
            "date_created": "2014-04-18 08:12:39.194345+00:00", 
            "author": "https://api.launchpad.net/1.0/~gnomino"
        }, 
        {
            "content": "Is not a nova bug. Is error in nova.conf on controller node, missing URL in neutron_admin_auth_url: http://controller.sate,local:35357/v2.0\nDifficult detectable misprint (", 
            "date_created": "2014-04-24 10:50:39.952522+00:00", 
            "author": "https://api.launchpad.net/1.0/~gnomino"
        }
    ], 
    "closed": "2014-07-25 07:36:12.565784+00:00"
}