{
    "status": "Invalid", 
    "last_updated": "2015-04-02 15:10:11.415539+00:00", 
    "description": "The following Tempest tests are failing with the VMware nova driver:\n\ntempest.api.compute.servers.test_delete_server.DeleteServersTestJSON.test_delete_server_while_in_attached_volume\ntempest.api.compute.servers.test_delete_server.DeleteServersTestXML.test_delete_server_while_in_attached_volume\ntempest.api.compute.servers.test_server_rescue_negative.ServerRescueNegativeTestJSON.test_rescued_vm_detach_volume\ntempest.api.compute.servers.test_server_rescue_negative.ServerRescueNegativeTestXML.test_rescued_vm_detach_volume\n\nThe following error is seen in the logs:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 134, in _dispatch_and_reply\n    incoming.message))\n  File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 177, in _dispatch\n    return self._do_dispatch(endpoint, method, ctxt, args)\n  File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 123, in _do_dispatch\n    result = getattr(endpoint, method)(ctxt, **new_args)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 405, in decorated_function\n    return function(self, context, *args, **kwargs)\n  File \"/opt/stack/nova/nova/exception.py\", line 88, in wrapped\n    payload)\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/exception.py\", line 71, in wrapped\n    return f(self, context, *args, **kw)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 290, in decorated_function\n    pass\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 276, in decorated_function\n    return function(self, context, *args, **kwargs)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 318, in decorated_function\n    kwargs['instance'], e, sys.exc_info())\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 306, in decorated_function\n    return function(self, context, *args, **kwargs)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 4269, in attach_volume\n    bdm.destroy(context)\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 4266, in attach_volume\n    return self._attach_volume(context, instance, driver_bdm)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 4287, in _attach_volume\n    self.volume_api.unreserve_volume(context, bdm.volume_id)\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 4279, in _attach_volume\n    do_check_attach=False, do_driver_attach=True)\n  File \"/opt/stack/nova/nova/virt/block_device.py\", line 45, in wrapped\n    ret_val = method(obj, context, *args, **kwargs)\n  File \"/opt/stack/nova/nova/virt/block_device.py\", line 249, in attach\n    connector)\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/virt/block_device.py\", line 240, in attach\n    device_type=self['device_type'], encryption=encryption)\n  File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 646, in attach_volume\n    mountpoint)\n  File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 388, in attach_volume\n    self._attach_volume_iscsi(connection_info, instance, mountpoint)\n  File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 363, in _attach_volume_iscsi\n    reason=_(\"Unable to find iSCSI Target\"))\nStorageError: Storage error: Unable to find iSCSI Target", 
    "tags": [
        "vmware"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1346549", 
    "owner": "None", 
    "id": 1346549, 
    "index": 6284, 
    "openned": "2014-07-21 20:56:03.659446+00:00", 
    "created": "2014-07-21 20:56:03.659446+00:00", 
    "title": "VMware: 'Storage error: Unable to find iSCSI Target'", 
    "comments": [
        {
            "content": "The following Tempest tests are failing with the VMware nova driver:\n\ntempest.api.compute.servers.test_delete_server.DeleteServersTestJSON.test_delete_server_while_in_attached_volume\ntempest.api.compute.servers.test_delete_server.DeleteServersTestXML.test_delete_server_while_in_attached_volume\ntempest.api.compute.servers.test_server_rescue_negative.ServerRescueNegativeTestJSON.test_rescued_vm_detach_volume\ntempest.api.compute.servers.test_server_rescue_negative.ServerRescueNegativeTestXML.test_rescued_vm_detach_volume\n\nThe following error is seen in the logs:\n\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 134, in _dispatch_and_reply\n    incoming.message))\n  File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 177, in _dispatch\n    return self._do_dispatch(endpoint, method, ctxt, args)\n  File \"/usr/local/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 123, in _do_dispatch\n    result = getattr(endpoint, method)(ctxt, **new_args)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 405, in decorated_function\n    return function(self, context, *args, **kwargs)\n  File \"/opt/stack/nova/nova/exception.py\", line 88, in wrapped\n    payload)\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/exception.py\", line 71, in wrapped\n    return f(self, context, *args, **kw)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 290, in decorated_function\n    pass\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 276, in decorated_function\n    return function(self, context, *args, **kwargs)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 318, in decorated_function\n    kwargs['instance'], e, sys.exc_info())\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 306, in decorated_function\n    return function(self, context, *args, **kwargs)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 4269, in attach_volume\n    bdm.destroy(context)\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 4266, in attach_volume\n    return self._attach_volume(context, instance, driver_bdm)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 4287, in _attach_volume\n    self.volume_api.unreserve_volume(context, bdm.volume_id)\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 4279, in _attach_volume\n    do_check_attach=False, do_driver_attach=True)\n  File \"/opt/stack/nova/nova/virt/block_device.py\", line 45, in wrapped\n    ret_val = method(obj, context, *args, **kwargs)\n  File \"/opt/stack/nova/nova/virt/block_device.py\", line 249, in attach\n    connector)\n  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 82, in __exit__\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/nova/nova/virt/block_device.py\", line 240, in attach\n    device_type=self['device_type'], encryption=encryption)\n  File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 646, in attach_volume\n    mountpoint)\n  File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 388, in attach_volume\n    self._attach_volume_iscsi(connection_info, instance, mountpoint)\n  File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 363, in _attach_volume_iscsi\n    reason=_(\"Unable to find iSCSI Target\"))\nStorageError: Storage error: Unable to find iSCSI Target", 
            "date_created": "2014-07-21 20:56:03.659446+00:00", 
            "author": "https://api.launchpad.net/1.0/~rhsu"
        }, 
        {
            "content": "do you have iSCSI in the tempest env?", 
            "date_created": "2014-08-29 00:10:40.973233+00:00", 
            "author": "https://api.launchpad.net/1.0/~tjones-i"
        }, 
        {
            "content": "Is this related? https://review.openstack.org/#/c/144600/", 
            "date_created": "2015-04-01 14:00:17.966843+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "I hit the same issue and it was due to the way in which cinder was configured. My understanding is that this is the case here as this is the CI. Since updating the config is up and running.", 
            "date_created": "2015-04-02 15:10:10.973403+00:00", 
            "author": "https://api.launchpad.net/1.0/~garyk"
        }
    ], 
    "closed": "2015-04-02 15:09:37.779161+00:00"
}