{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:42:11.573523+00:00", 
    "description": "Hi,\n\nAfter the quota limit of floating addresses for a user is reached next time API  call would fail showing an unknown error instead of a quota error:\n\n$ euca-describe-addresses\nADDRESS\txxx.xxx.xxx.1\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.2\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.3\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.4\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.5\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.6\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.7\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.8\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.9\tNone (4038c766cd4d4ac081f44934c175f82d)\n\n$ euca-allocate-address\nADDRESS\txxx.xxx.xxx.10\n\n$ euca-allocate-address\nUnknownError: An unknown error has occurred. Please try your request again.\n\nAlmost the same error using Openstack API:\n$ nova floating-ip-create\nERROR: The server has either erred or is incapable of performing the requested operation. (HTTP 500)\n\nLooking at nova-api.log:\n\n(nova.api.openstack): TRACE: Traceback (most recent call last):\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/__init__.py\", line 41, in __call__\n(nova.api.openstack): TRACE:     return req.get_response(self.application)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1086, in get_response\n(nova.api.openstack): TRACE:     application, catch_exc_info=False)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1055, in call_application\n(nova.api.openstack): TRACE:     app_iter = application(self.environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 176, in __call__\n(nova.api.openstack): TRACE:     return self.app(env, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n(nova.api.openstack): TRACE:     response = self.app(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 147, in __call__\n(nova.api.openstack): TRACE:     resp = self.call_func(req, *args, **self.kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 210, in call_func\n(nova.api.openstack): TRACE:     return self.func(req, *args, **kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 803, in __call__\n(nova.api.openstack): TRACE:     content_type, body, accept)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 851, in _process_stack\n(nova.api.openstack): TRACE:     action_result = self.dispatch(meth, request, action_args)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 926, in dispatch\n(nova.api.openstack): TRACE:     return method(req=request, **action_args)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/contrib/floating_ips.py\", line 153, in create\n(nova.api.openstack): TRACE:     address = self.network_api.allocate_floating_ip(context, pool)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/network/api.py\", line 124, in allocate_floating_ip\n(nova.api.openstack): TRACE:     'pool': pool}})\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/__init__.py\", line 68, in call\n(nova.api.openstack): TRACE:     return _get_impl().call(context, topic, msg, timeout)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/impl_kombu.py\", line 674, in call\n(nova.api.openstack): TRACE:     return rpc_amqp.call(context, topic, msg, timeout, Connection.pool)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 338, in call\n(nova.api.openstack): TRACE:     rv = list(rv)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 306, in __iter__\n(nova.api.openstack): TRACE:     raise result\n(nova.api.openstack): TRACE: RemoteError: Remote error: QuotaError Quota exceeded: code=AddressLimitExceeded\n(nova.api.openstack): TRACE: [u'Traceback (most recent call last):\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 252, in _process_data\\n    rval = node_func(context=ctxt, **node_args)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 258, in wrapped\\n    return func(self, context, *args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 396, in allocate_floating_ip\\n    raise exception.QuotaError(code=\\'AddressLimitExceeded\\')\\n', u'QuotaError: Quota exceeded: code=AddressLimitExceeded\\n'].\n(nova.api.openstack): TRACE:\n2012-04-02 14:52:03 INFO nova.api.openstack [req-97a1e381-1f6b-4d58-9de2-051f27261863 91d9de02e2e848f99729903a8aa79852 4038c766cd4d4ac081f44934c175f82d] http://10.130.0.16:8774/v2/4038c766cd4d4ac081f44934c175f82d/os-floating-ips returned with HTTP 500\n\nAll services are running RC2 packages from Ubuntu Precise:\nii  nova-api                         2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - API frontend\nii  nova-cert                        2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - virtual machine scheduler\nii  nova-common                      2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - common files\nii  nova-compute                     2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - compute node\nii  nova-compute-kvm                 2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - compute node (KVM)\nii  nova-network                     2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - Network manager\nii  python-nova                      2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute Python libraries\nii  python-novaclient                2012.1~rc2~20120326.r531-0ubuntu0~precise14    client library for OpenStack Compute API\n\nI've also attached the output with debug information.", 
    "tags": [
        "ec2"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/971609", 
    "owner": "https://api.launchpad.net/1.0/~zulcss", 
    "id": 971609, 
    "index": 4012, 
    "openned": "2012-04-02 15:05:36.716570+00:00", 
    "created": "2012-04-02 15:05:36.716570+00:00", 
    "title": "Error allocating addresses when quota is exceeded", 
    "comments": [
        {
            "content": "Hi,\n\nAfter the quota limit of floating addresses for a user is reached next time API  call would fail showing an unknown error instead of a quota error:\n\n$ euca-describe-addresses\nADDRESS\txxx.xxx.xxx.1\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.2\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.3\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.4\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.5\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.6\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.7\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.8\tNone (4038c766cd4d4ac081f44934c175f82d)\nADDRESS\txxx.xxx.xxx.9\tNone (4038c766cd4d4ac081f44934c175f82d)\n\n$ euca-allocate-address\nADDRESS\txxx.xxx.xxx.10\n\n$ euca-allocate-address\nUnknownError: An unknown error has occurred. Please try your request again.\n\nAlmost the same error using Openstack API:\n$ nova floating-ip-create\nERROR: The server has either erred or is incapable of performing the requested operation. (HTTP 500)\n\nLooking at nova-api.log:\n\n(nova.api.openstack): TRACE: Traceback (most recent call last):\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/__init__.py\", line 41, in __call__\n(nova.api.openstack): TRACE:     return req.get_response(self.application)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1086, in get_response\n(nova.api.openstack): TRACE:     application, catch_exc_info=False)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1055, in call_application\n(nova.api.openstack): TRACE:     app_iter = application(self.environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 176, in __call__\n(nova.api.openstack): TRACE:     return self.app(env, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n(nova.api.openstack): TRACE:     response = self.app(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 147, in __call__\n(nova.api.openstack): TRACE:     resp = self.call_func(req, *args, **self.kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 210, in call_func\n(nova.api.openstack): TRACE:     return self.func(req, *args, **kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 803, in __call__\n(nova.api.openstack): TRACE:     content_type, body, accept)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 851, in _process_stack\n(nova.api.openstack): TRACE:     action_result = self.dispatch(meth, request, action_args)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 926, in dispatch\n(nova.api.openstack): TRACE:     return method(req=request, **action_args)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/contrib/floating_ips.py\", line 153, in create\n(nova.api.openstack): TRACE:     address = self.network_api.allocate_floating_ip(context, pool)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/network/api.py\", line 124, in allocate_floating_ip\n(nova.api.openstack): TRACE:     'pool': pool}})\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/__init__.py\", line 68, in call\n(nova.api.openstack): TRACE:     return _get_impl().call(context, topic, msg, timeout)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/impl_kombu.py\", line 674, in call\n(nova.api.openstack): TRACE:     return rpc_amqp.call(context, topic, msg, timeout, Connection.pool)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 338, in call\n(nova.api.openstack): TRACE:     rv = list(rv)\n(nova.api.openstack): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 306, in __iter__\n(nova.api.openstack): TRACE:     raise result\n(nova.api.openstack): TRACE: RemoteError: Remote error: QuotaError Quota exceeded: code=AddressLimitExceeded\n(nova.api.openstack): TRACE: [u'Traceback (most recent call last):\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 252, in _process_data\\n    rval = node_func(context=ctxt, **node_args)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 258, in wrapped\\n    return func(self, context, *args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 396, in allocate_floating_ip\\n    raise exception.QuotaError(code=\\'AddressLimitExceeded\\')\\n', u'QuotaError: Quota exceeded: code=AddressLimitExceeded\\n'].\n(nova.api.openstack): TRACE:\n2012-04-02 14:52:03 INFO nova.api.openstack [req-97a1e381-1f6b-4d58-9de2-051f27261863 91d9de02e2e848f99729903a8aa79852 4038c766cd4d4ac081f44934c175f82d] http://10.130.0.16:8774/v2/4038c766cd4d4ac081f44934c175f82d/os-floating-ips returned with HTTP 500\n\nAll services are running RC2 packages from Ubuntu Precise:\nii  nova-api                         2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - API frontend\nii  nova-cert                        2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - virtual machine scheduler\nii  nova-common                      2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - common files\nii  nova-compute                     2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - compute node\nii  nova-compute-kvm                 2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - compute node (KVM)\nii  nova-network                     2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute - Network manager\nii  python-nova                      2012.1~rc2~20120327.r13456-0ubuntu0~precise209 OpenStack Compute Python libraries\nii  python-novaclient                2012.1~rc2~20120326.r531-0ubuntu0~precise14    client library for OpenStack Compute API\n\nI've also attached the output with debug information.", 
            "date_created": "2012-04-02 15:05:36.716570+00:00", 
            "author": "https://api.launchpad.net/1.0/~rafadurancastaneda"
        }, 
        {
            "content": "", 
            "date_created": "2012-04-02 15:05:36.716570+00:00", 
            "author": "https://api.launchpad.net/1.0/~rafadurancastaneda"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/11106", 
            "date_created": "2012-08-09 20:43:27.400624+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/11106\nCommitted: http://github.com/openstack/nova/commit/65c3759674dec87c895c44d95c7b279ea4e4eb05\nSubmitter: Jenkins\nBranch:    master\n\ncommit 65c3759674dec87c895c44d95c7b279ea4e4eb05\nAuthor: Chuck Short <email address hidden>\nDate:   Thu Aug 9 15:32:20 2012 -0500\n\n    Traceback when over allocating IP addresses\n    \n    When a user over allocates a number of IP addresses\n    via euca-allocate-address, the user will get a nice\n    traceback saying that they over quota for IP address\n    allocation. Display a more userfriendly error when this\n    happens.\n    \n    LP: #971609\n    \n    Change-Id: If8586e246564f1069cb60bac9592f9d750522e81\n    Signed-off-by: Chuck Short <email address hidden>\n", 
            "date_created": "2012-08-09 22:02:31.443871+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2012-08-16 07:42:19.008819+00:00"
}