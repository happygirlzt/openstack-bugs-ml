{
    "status": "Fix Released", 
    "last_updated": "2013-01-27 14:56:37.575679+00:00", 
    "description": "running a devstack with with LIBVIRT_TYPE=lxc  and nova at:\n  commit f597dc5548d66530e68ff5809ac2c56b7edbc6d8\n  Merge: c979656 724e5e7\n  Date: Tue Dec 13 18:05:39 2011 +0000\n\nI ran a couple instances, killed some, and eventually saw this in nova compute log:\n\n2011-12-13 21:13:41,875 DEBUG nova.virt.libvirt_conn [43af388f-bc82-4ad9-b4d5-7dfa1c0263fc None None] Updating host stats from (pid=5839) update_status /opt/stack/nova/nova/virt/libvirt/connection.py:1913\nlibvir: error : this function is not supported by the connection driver: virDomainGetVcpus\n2011-12-13 21:13:41,881 ERROR nova.manager [43af388f-bc82-4ad9-b4d5-7dfa1c0263fc None None] Error during ComputeManager._report_driver_status: 'NoneType' object has no attribute '__getitem__'\n(nova.manager): TRACE: Traceback (most recent call last):\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/manager.py\", line 154, in periodic_tasks\n(nova.manager): TRACE:     task(self, context)\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 1896, in _report_driver_status\n(nova.manager): TRACE:     self.driver.get_host_stats(refresh=True))\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1883, in get_host_stats\n(nova.manager): TRACE:     return self.host_state.get_host_stats(refresh=refresh)\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1908, in get_host_stats\n(nova.manager): TRACE:     self.update_status()\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1918, in update_status\n(nova.manager): TRACE:     data[\"vcpus_used\"] = self.connection.get_vcpu_used()\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1357, in get_vcpu_used\n(nova.manager): TRACE:     total += len(dom.vcpus()[1])\n(nova.manager): TRACE: TypeError: 'NoneType' object has no attribute '__getitem__'\n(nova.manager): TRACE: \n\n\nand also:\n2011-12-13 21:15:42,029 DEBUG nova.virt.libvirt_conn [d3c67c9b-08db-4238-9dde-7fa0e81bf6e4 None None] Updating host stats from (pid=5839) update_status /opt/stack/nova/nova/virt/libvirt/connection.py:1913\nlibvir: error : this function is not supported by the connection driver: virDomainGetVcpus\n2011-12-13 21:15:42,033 ERROR nova.manager [d3c67c9b-08db-4238-9dde-7fa0e81bf6e4 None None] Error during ComputeManager._report_driver_status: 'NoneType' object has no attribute '__getitem__'\n(nova.manager): TRACE: Traceback (most recent call last):\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/manager.py\", line 154, in periodic_tasks\n(nova.manager): TRACE:     task(self, context)\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 1896, in _report_driver_status\n(nova.manager): TRACE:     self.driver.get_host_stats(refresh=True))\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1883, in get_host_stats\n(nova.manager): TRACE:     return self.host_state.get_host_stats(refresh=refresh)\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1908, in get_host_stats\n(nova.manager): TRACE:     self.update_status()\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1918, in update_status\n(nova.manager): TRACE:     data[\"vcpus_used\"] = self.connection.get_vcpu_used()\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1357, in get_vcpu_used\n(nova.manager): TRACE:     total += len(dom.vcpus()[1])\n(nova.manager): TRACE: TypeError: 'NoneType' object has no attribute '__getitem__'\n(nova.manager): TRACE:", 
    "tags": [
        "in-stable-diablo"
    ], 
    "importance": "Undecided", 
    "heat": 22, 
    "link": "https://bugs.launchpad.net/nova/+bug/903943", 
    "owner": "https://api.launchpad.net/1.0/~zulcss", 
    "id": 903943, 
    "index": 3700, 
    "openned": "2011-12-13 21:16:28.822601+00:00", 
    "created": "2011-12-13 21:16:28.822601+00:00", 
    "title": "lxc: libvirt error due to use of dom.vcpus()", 
    "comments": [
        {
            "content": "running a devstack with with LIBVIRT_TYPE=lxc  and nova at:\n  commit f597dc5548d66530e68ff5809ac2c56b7edbc6d8\n  Merge: c979656 724e5e7\n  Date: Tue Dec 13 18:05:39 2011 +0000\n\nI ran a couple instances, killed some, and eventually saw this in nova compute log:\n\n2011-12-13 21:13:41,875 DEBUG nova.virt.libvirt_conn [43af388f-bc82-4ad9-b4d5-7dfa1c0263fc None None] Updating host stats from (pid=5839) update_status /opt/stack/nova/nova/virt/libvirt/connection.py:1913\nlibvir: error : this function is not supported by the connection driver: virDomainGetVcpus\n2011-12-13 21:13:41,881 ERROR nova.manager [43af388f-bc82-4ad9-b4d5-7dfa1c0263fc None None] Error during ComputeManager._report_driver_status: 'NoneType' object has no attribute '__getitem__'\n(nova.manager): TRACE: Traceback (most recent call last):\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/manager.py\", line 154, in periodic_tasks\n(nova.manager): TRACE:     task(self, context)\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 1896, in _report_driver_status\n(nova.manager): TRACE:     self.driver.get_host_stats(refresh=True))\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1883, in get_host_stats\n(nova.manager): TRACE:     return self.host_state.get_host_stats(refresh=refresh)\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1908, in get_host_stats\n(nova.manager): TRACE:     self.update_status()\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1918, in update_status\n(nova.manager): TRACE:     data[\"vcpus_used\"] = self.connection.get_vcpu_used()\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1357, in get_vcpu_used\n(nova.manager): TRACE:     total += len(dom.vcpus()[1])\n(nova.manager): TRACE: TypeError: 'NoneType' object has no attribute '__getitem__'\n(nova.manager): TRACE: \n\n\nand also:\n2011-12-13 21:15:42,029 DEBUG nova.virt.libvirt_conn [d3c67c9b-08db-4238-9dde-7fa0e81bf6e4 None None] Updating host stats from (pid=5839) update_status /opt/stack/nova/nova/virt/libvirt/connection.py:1913\nlibvir: error : this function is not supported by the connection driver: virDomainGetVcpus\n2011-12-13 21:15:42,033 ERROR nova.manager [d3c67c9b-08db-4238-9dde-7fa0e81bf6e4 None None] Error during ComputeManager._report_driver_status: 'NoneType' object has no attribute '__getitem__'\n(nova.manager): TRACE: Traceback (most recent call last):\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/manager.py\", line 154, in periodic_tasks\n(nova.manager): TRACE:     task(self, context)\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/compute/manager.py\", line 1896, in _report_driver_status\n(nova.manager): TRACE:     self.driver.get_host_stats(refresh=True))\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1883, in get_host_stats\n(nova.manager): TRACE:     return self.host_state.get_host_stats(refresh=refresh)\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1908, in get_host_stats\n(nova.manager): TRACE:     self.update_status()\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1918, in update_status\n(nova.manager): TRACE:     data[\"vcpus_used\"] = self.connection.get_vcpu_used()\n(nova.manager): TRACE:   File \"/opt/stack/nova/nova/virt/libvirt/connection.py\", line 1357, in get_vcpu_used\n(nova.manager): TRACE:     total += len(dom.vcpus()[1])\n(nova.manager): TRACE: TypeError: 'NoneType' object has no attribute '__getitem__'\n(nova.manager): TRACE:", 
            "date_created": "2011-12-13 21:16:28.822601+00:00", 
            "author": "https://api.launchpad.net/1.0/~smoser"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/2305\nCommitted: http://github.com/openstack/nova/commit/f4368e5cdf286d065742e0da1977a3e48c091123\nSubmitter: Jenkins\nBranch:    master\n\n status fixcommitted\n done\n\ncommit f4368e5cdf286d065742e0da1977a3e48c091123\nAuthor: Scott Moser <email address hidden>\nDate:   Tue Dec 13 16:48:05 2011 -0500\n\n    avoid error and trace on dom.vcpus() in lxc\n    \n    This fixes bug 903943.  If you used lxc, you'd eventually\n    see stack traces in nova-compute due to use of dom.vcpus().\n    \n    Change-Id: I8ff4e973d33eef3df116feb237b2febc8e6a59b5\n", 
            "date_created": "2011-12-17 04:04:19+00:00", 
            "author": "https://api.launchpad.net/1.0/~openstack-gerrit"
        }, 
        {
            "content": "Fix proposed to branch: stable/diablo\nReview: https://review.openstack.org/2802", 
            "date_created": "2012-01-04 20:42:22.979762+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/2802\nCommitted: http://github.com/openstack/nova/commit/abea7aac12704dcd0bc337e03f4e47a8ec189df8\nSubmitter: Jenkins\nBranch:    stable/diablo\n\ncommit abea7aac12704dcd0bc337e03f4e47a8ec189df8\nAuthor: Scott Moser <email address hidden>\nDate:   Tue Dec 13 16:48:05 2011 -0500\n\n    avoid error and trace on dom.vcpus() in lxc\n    \n    This fixes bug 903943.  If you used lxc, you'd eventually\n    see stack traces in nova-compute due to use of dom.vcpus().\n    \n    Change-Id: I8ff4e973d33eef3df116feb237b2febc8e6a59b5\n", 
            "date_created": "2012-01-05 13:03:03.153974+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "libvir:  error : this function is not supported by the connection driver: virDomainGetVcpus\r\n2013-01-27 08:24:50.832 ERROR nova.manager [-] Error during ComputeManager._report_driver_status: this function is not supported by the connection driver: virDomainGetVcpus\r\n2013-01-27 08:24:50.832 TRACE nova.manager Traceback (most recent call last):\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/manager.py\", line 230, in periodic_tasks\r\n2013-01-27 08:24:50.832 TRACE nova.manager     task(self, context)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/compute/manager.py\", line 3275, in _report_driver_status\r\n2013-01-27 08:24:50.832 TRACE nova.manager     capabilities = self.driver.get_host_stats(refresh=True)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2925, in get_host_stats\r\n2013-01-27 08:24:50.832 TRACE nova.manager     return self.host_state.get_host_stats(refresh=refresh)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3198, in get_host_stats\r\n2013-01-27 08:24:50.832 TRACE nova.manager     self.update_status()\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3208, in update_status\r\n2013-01-27 08:24:50.832 TRACE nova.manager     data[\"vcpus_used\"] = self.connection.get_vcpu_used()\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2109, in get_vcpu_used\r\n2013-01-27 08:24:50.832 TRACE nova.manager     vcpus = dom.vcpus()\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 187, in doit\r\n2013-01-27 08:24:50.832 TRACE nova.manager     result = proxy_call(self._autowrap, f, *args, **kwargs)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 147, in proxy_call\r\n2013-01-27 08:24:50.832 TRACE nova.manager     rv = execute(f,*args,**kwargs)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 76, in tworker\r\n2013-01-27 08:24:50.832 TRACE nova.manager     rv = meth(*args,**kwargs)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 2087, in vcpus\r\n2013-01-27 08:24:50.832 TRACE nova.manager     if ret == -1: raise libvirtError ('virDomainGetVcpus() failed', dom=self)\r\n2013-01-27 08:24:50.832 TRACE nova.manager libvirtError: this function is not supported by the connection driver: virDomainGetVcpus\r\n2013-01-27 08:24:50.832 TRACE nova.manager \r\nERROR:nova.manager:Error during ComputeManager._report_driver_status: this function is not supported by the connection driver: virDomainGetVcpus\r\n2013-01-27 08:24:50.832 TRACE nova.manager Traceback (most recent call last):\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/manager.py\", line 230, in periodic_tasks\r\n2013-01-27 08:24:50.832 TRACE nova.manager     task(self, context)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/compute/manager.py\", line 3275, in _report_driver_status\r\n2013-01-27 08:24:50.832 TRACE nova.manager     capabilities = self.driver.get_host_stats(refresh=True)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2925, in get_host_stats\r\n2013-01-27 08:24:50.832 TRACE nova.manager     return self.host_state.get_host_stats(refresh=refresh)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3198, in get_host_stats\r\n2013-01-27 08:24:50.832 TRACE nova.manager     self.update_status()\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3208, in update_status\r\n2013-01-27 08:24:50.832 TRACE nova.manager     data[\"vcpus_used\"] = self.connection.get_vcpu_used()\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2109, in get_vcpu_used\r\n2013-01-27 08:24:50.832 TRACE nova.manager     vcpus = dom.vcpus()\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 187, in doit\r\n2013-01-27 08:24:50.832 TRACE nova.manager     result = proxy_call(self._autowrap, f, *args, **kwargs)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 147, in proxy_call\r\n2013-01-27 08:24:50.832 TRACE nova.manager     rv = execute(f,*args,**kwargs)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 76, in tworker\r\n2013-01-27 08:24:50.832 TRACE nova.manager     rv = meth(*args,**kwargs)\r\n2013-01-27 08:24:50.832 TRACE nova.manager   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 2087, in vcpus\r\n2013-01-27 08:24:50.832 TRACE nova.manager     if ret == -1: raise libvirtError ('virDomainGetVcpus() failed', dom=self)\r\n2013-01-27 08:24:50.832 TRACE nova.manager libvirtError: this function is not supported by the connection driver: virDomainGetVcpus\r\n", 
            "date_created": "2013-01-27 14:27:23.212634+00:00", 
            "author": "https://api.launchpad.net/1.0/~zulcss"
        }
    ], 
    "closed": "2013-01-27 14:56:36.222496+00:00"
}