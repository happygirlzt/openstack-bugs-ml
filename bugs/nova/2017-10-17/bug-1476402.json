{
    "status": "Fix Released", 
    "last_updated": "2015-10-15 08:56:08.783851+00:00", 
    "description": "On rug startup, the devstack-created router appliance fails to spawn with the following traceback in nova:\n\nams': None})]| from (pid=17775) _allocate_network_async /opt/stack/nova/nova/compute/manager.py:1527\n2015-07-20 14:07:26.462 ERROR nova.compute.manager [req-057f87b7-b0b5-45e7-b6f8-5c6cbb7a2be0 neutron service] [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7] Instance failed to spawn\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7] Traceback (most recent call last):\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2110, in _build_resources\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     yield resources\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1982, in _build_and_run_instance\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     block_device_info=block_device_info)\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2409, in spawn\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     admin_pass=admin_password)\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2882, in _create_image\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     content=files, extra_md=extra_md, network_info=network_info)\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/api/metadata/base.py\", line 156, in __init__\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     self.network_metadata = netutils.get_network_metadata(network_info)\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/virt/netutils.py\", line 229, in get_network_metadata\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     if subnet_v4.get('ips'):\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7] AttributeError: 'NoneType' object has no attribute 'get'\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7] \n2015-07-20 14:07:26.464 INFO nova.compute.manager [req-057f87b7-b0b5-45e7-b6f8-5c6cbb7a2be0 neutron service] [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7] Terminating instance\n\nA little digging shows that this recently merged into nova and is likely the cause of the breakage: https://review.openstack.org/#/c/102649/", 
    "tags": [
        "low-hanging-fruit", 
        "network"
    ], 
    "importance": "Low", 
    "heat": 12, 
    "link": "https://bugs.launchpad.net/nova/+bug/1476402", 
    "owner": "None", 
    "id": 1476402, 
    "index": 1784, 
    "openned": "2015-07-20 22:33:11.440447+00:00", 
    "created": "2015-07-20 21:13:59.855751+00:00", 
    "title": "boot fails on network /w only an ipv6 subnet, AttributeError: 'NoneType' object has no attribute 'get'", 
    "comments": [
        {
            "content": "On rug startup, the devstack-created router appliance fails to spawn with the following traceback in nova:\n\nams': None})]| from (pid=17775) _allocate_network_async /opt/stack/nova/nova/compute/manager.py:1527\n2015-07-20 14:07:26.462 ERROR nova.compute.manager [req-057f87b7-b0b5-45e7-b6f8-5c6cbb7a2be0 neutron service] [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7] Instance failed to spawn\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7] Traceback (most recent call last):\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2110, in _build_resources\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     yield resources\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1982, in _build_and_run_instance\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     block_device_info=block_device_info)\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2409, in spawn\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     admin_pass=admin_password)\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2882, in _create_image\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     content=files, extra_md=extra_md, network_info=network_info)\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/api/metadata/base.py\", line 156, in __init__\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     self.network_metadata = netutils.get_network_metadata(network_info)\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]   File \"/opt/stack/nova/nova/virt/netutils.py\", line 229, in get_network_metadata\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7]     if subnet_v4.get('ips'):\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7] AttributeError: 'NoneType' object has no attribute 'get'\n2015-07-20 14:07:26.462 TRACE nova.compute.manager [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7] \n2015-07-20 14:07:26.464 INFO nova.compute.manager [req-057f87b7-b0b5-45e7-b6f8-5c6cbb7a2be0 neutron service] [instance: 2e5ff228-9d7b-436a-8053-6fcd11b02eb7] Terminating instance\n\nA little digging shows that this recently merged into nova and is likely the cause of the breakage: https://review.openstack.org/#/c/102649/", 
            "date_created": "2015-07-20 21:13:59.855751+00:00", 
            "author": "https://api.launchpad.net/1.0/~gandelman-a"
        }, 
        {
            "content": "This is a nova bug introduced /w https://review.openstack.org/#/c/102649/  that prevents instances from booting unless their network has an ipv4 subnet.  Instances on a network that only have a single ipv6 subnet will fail on this AttributeError", 
            "date_created": "2015-07-20 22:34:28.204949+00:00", 
            "author": "https://api.launchpad.net/1.0/~gandelman-a"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/203846", 
            "date_created": "2015-07-20 22:46:18.614070+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/203846\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=6cce41eaa3e73cad9d04255521634f1af08267b6\nSubmitter: Jenkins\nBranch:    master\n\ncommit 6cce41eaa3e73cad9d04255521634f1af08267b6\nAuthor: Adam Gandelman <email address hidden>\nDate:   Mon Jul 20 15:44:23 2015 -0700\n\n    Only work with ipv4 subnet metadata if one exists\n    \n    This code currently throws an exception and fails the build if an\n    instance boots on a network without a v4 subnet.  Protect against\n    this by checking it has a ipv4 subnet.\n    \n    Change-Id: I7c5de308b557293f5ac6b919d5566ace809ce200\n    Closes-bug: #1476402\n", 
            "date_created": "2015-07-27 17:30:22.430259+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2015-07-28 09:09:42.867000+00:00"
}