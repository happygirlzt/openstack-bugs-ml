{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:39:51.639706+00:00", 
    "description": "During a the tempest test tempest.tests.boto.test_ec2_volumes.EC2VolumesTest.test_create_volume_from_snapshot the cleanup code does a snapshot update request until it fails. The behavior is correct, but causes a stacktrace from cinderclient\n\n2013-04-17 08:58:47     INFO [requests.packages.urllib3.connectionpool] Starting new HTTP connection (1): 192.168.1.18  \n2013-04-17 08:58:47    DEBUG [requests.packages.urllib3.connectionpool] \"GET /v1/fe2faa887f5848449a8e02c4000ffff0/snapshots/69b0651c-34f4-4fdf-8135-1c125aeeeab9 HTTP/1.1\" 404 78\n2013-04-17 08:58:47    ERROR [nova.api.ec2] Unexpected error raised: The resource could not be found. (HTTP 404) (Request-ID: req-6d441c5b-e271-4130-8853-3530b21927e3)\nTraceback (most recent call last):\n  File \"/srv/compile/openstack/nova/nova/api/ec2/__init__.py\", line 481, in __call__\n    result = api_request.invoke(context)\n  File \"/srv/compile/openstack/nova/nova/api/ec2/apirequest.py\", line 79, in invoke\n    result = method(context, **args)\n  File \"/srv/compile/openstack/nova/nova/api/ec2/cloud.py\", line 350, in describe_snapshots\n    snapshot_id=internal_id)\n  File \"/srv/compile/openstack/nova/nova/volume/cinder.py\", line 283, in get_snapshot\n    item = cinderclient(context).volume_snapshots.get(snapshot_id)\n  File \"/usr/local/lib/python2.7/dist-packages/cinderclient/v1/volume_snapshots.py\", line 84, in get\n    return self._get(\"/snapshots/%s\" % snapshot_id, \"snapshot\")\n  File \"/usr/local/lib/python2.7/dist-packages/cinderclient/base.py\", line 141, in _get\n    resp, body = self.api.client.get(url)\n  File \"/usr/local/lib/python2.7/dist-packages/cinderclient/client.py\", line 189, in get\n    return self._cs_request(url, 'GET', **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/cinderclient/client.py\", line 157, in _cs_request\n    **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/cinderclient/client.py\", line 140, in request\n    raise exceptions.from_response(resp, body)\nNotFound: The resource could not be found. (HTTP 404) (Request-ID: req-6d441c5b-e271-4130-8853-3530b21927e3)\n2013-04-17 08:58:47    ERROR [nova.api.ec2] Environment: {\"CONTENT_TYPE\": \"application/x-www-form-urlencoded; charset=UTF-8\", \"SCRIPT_NAME\": \"/services/Cloud\", \"REQUEST_METHOD\": \"POST\", \"HTTP_HOST\": \"192.168.1.18:8773\", \"PATH_INFO\": \"/\", \"SERVER_PROTOCOL\": \"HTTP/1.0\", \"HTTP_USER_AGENT\": \"Boto/2.8.0 (linux2)\", \"RAW_PATH_INFO\": \"/services/Cloud/\", \"REMOTE_ADDR\": \"192.168.1.18\", \"wsgi.url_scheme\": \"http\", \"SERVER_NAME\": \"192.168.1.18\", \"SERVER_PORT\": \"8773\", \"GATEWAY_INTERFACE\": \"CGI/1.1\", \"HTTP_ACCEPT_ENCODING\": \"identity\"}\n\nWe should catch the exception so the traceback does not occur, but otherwise preserve the current API behavior", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1169777", 
    "owner": "https://api.launchpad.net/1.0/~cyeoh-0", 
    "id": 1169777, 
    "index": 4854, 
    "openned": "2013-04-17 00:30:43.154719+00:00", 
    "created": "2013-04-17 00:30:43.154719+00:00", 
    "title": "cinderclient stacktrace when 404 from cinder get_snapshot", 
    "comments": [
        {
            "content": "During a the tempest test tempest.tests.boto.test_ec2_volumes.EC2VolumesTest.test_create_volume_from_snapshot the cleanup code does a snapshot update request until it fails. The behavior is correct, but causes a stacktrace from cinderclient\n\n2013-04-17 08:58:47     INFO [requests.packages.urllib3.connectionpool] Starting new HTTP connection (1): 192.168.1.18  \n2013-04-17 08:58:47    DEBUG [requests.packages.urllib3.connectionpool] \"GET /v1/fe2faa887f5848449a8e02c4000ffff0/snapshots/69b0651c-34f4-4fdf-8135-1c125aeeeab9 HTTP/1.1\" 404 78\n2013-04-17 08:58:47    ERROR [nova.api.ec2] Unexpected error raised: The resource could not be found. (HTTP 404) (Request-ID: req-6d441c5b-e271-4130-8853-3530b21927e3)\nTraceback (most recent call last):\n  File \"/srv/compile/openstack/nova/nova/api/ec2/__init__.py\", line 481, in __call__\n    result = api_request.invoke(context)\n  File \"/srv/compile/openstack/nova/nova/api/ec2/apirequest.py\", line 79, in invoke\n    result = method(context, **args)\n  File \"/srv/compile/openstack/nova/nova/api/ec2/cloud.py\", line 350, in describe_snapshots\n    snapshot_id=internal_id)\n  File \"/srv/compile/openstack/nova/nova/volume/cinder.py\", line 283, in get_snapshot\n    item = cinderclient(context).volume_snapshots.get(snapshot_id)\n  File \"/usr/local/lib/python2.7/dist-packages/cinderclient/v1/volume_snapshots.py\", line 84, in get\n    return self._get(\"/snapshots/%s\" % snapshot_id, \"snapshot\")\n  File \"/usr/local/lib/python2.7/dist-packages/cinderclient/base.py\", line 141, in _get\n    resp, body = self.api.client.get(url)\n  File \"/usr/local/lib/python2.7/dist-packages/cinderclient/client.py\", line 189, in get\n    return self._cs_request(url, 'GET', **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/cinderclient/client.py\", line 157, in _cs_request\n    **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/cinderclient/client.py\", line 140, in request\n    raise exceptions.from_response(resp, body)\nNotFound: The resource could not be found. (HTTP 404) (Request-ID: req-6d441c5b-e271-4130-8853-3530b21927e3)\n2013-04-17 08:58:47    ERROR [nova.api.ec2] Environment: {\"CONTENT_TYPE\": \"application/x-www-form-urlencoded; charset=UTF-8\", \"SCRIPT_NAME\": \"/services/Cloud\", \"REQUEST_METHOD\": \"POST\", \"HTTP_HOST\": \"192.168.1.18:8773\", \"PATH_INFO\": \"/\", \"SERVER_PROTOCOL\": \"HTTP/1.0\", \"HTTP_USER_AGENT\": \"Boto/2.8.0 (linux2)\", \"RAW_PATH_INFO\": \"/services/Cloud/\", \"REMOTE_ADDR\": \"192.168.1.18\", \"wsgi.url_scheme\": \"http\", \"SERVER_NAME\": \"192.168.1.18\", \"SERVER_PORT\": \"8773\", \"GATEWAY_INTERFACE\": \"CGI/1.1\", \"HTTP_ACCEPT_ENCODING\": \"identity\"}\n\nWe should catch the exception so the traceback does not occur, but otherwise preserve the current API behavior", 
            "date_created": "2013-04-17 00:30:43.154719+00:00", 
            "author": "https://api.launchpad.net/1.0/~cyeoh-0"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/27027", 
            "date_created": "2013-04-17 00:43:46.733016+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/27027\nCommitted: http://github.com/openstack/nova/commit/673f3118b6b558f8c23a669ad6aae1cf8df6632e\nSubmitter: Jenkins\nBranch:    master\n\ncommit 673f3118b6b558f8c23a669ad6aae1cf8df6632e\nAuthor: Chris Yeoh <email address hidden>\nDate:   Wed Apr 17 10:02:33 2013 +0930\n\n    Translate cinder NotFound exception\n    \n    When we attempt to get information about a snapshot\n    which doesn't exist we get a cinder NotFound exception.\n    However, this is not caught and causes a stacktrace in the logs.\n    This occurs on every tempest run in the test\n    EC2VolumesTest.test_create_volume_from_snapshot.\n    \n    The fix is to translate the exception to SnapshotNotFound\n    which is handled correctly further up the call chain.\n    \n    Fixes bug 1169777\n    \n    Part of blueprint no-stacktraces-in-logs\n    \n    Change-Id: If893b5083b93894e671c978bd23bd89d3d017531\n", 
            "date_created": "2013-04-23 16:21:25.343904+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-05-29 10:21:08.360896+00:00"
}