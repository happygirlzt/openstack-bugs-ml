{
    "status": "Invalid", 
    "last_updated": "2015-01-18 20:57:00.666883+00:00", 
    "description": "Launched VM :\nExternal network:\n+---------------------------+--------------------------------------+\n| Field                     | Value                                |\n+---------------------------+--------------------------------------+\n| admin_state_up            | True                                 |\n| id                        | 35d70304-cbb6-4b1d-b73e-334c47148f32 |\n| name                      | public                               |\n| provider:network_type     | vlan                                 |\n| provider:physical_network | physnet1                             |\n| provider:segmentation_id  | 101                                  |\n| router:external           | True                                 |\n| shared                    | False                                |\n| status                    | ACTIVE                               |\n| subnets                   | f2025c22-a90d-4576-803a-b93274f5ef45 |\n| tenant_id                 | 5623e92cd94c4741b4b9c117ecebd0be     |\n+---------------------------+--------------------------------------+\nsubnet:\n+-------------------+------------------------------------------------+\n| Field             | Value                                          |\n+-------------------+------------------------------------------------+\n| allocation_pools  | {\"start\": \"172.24.4.2\", \"end\": \"172.24.4.254\"} |\n| cidr              | 172.24.4.0/24                                  |\n| dns_nameservers   |                                                |\n| enable_dhcp       | False                                          |\n| gateway_ip        | 172.24.4.1                                     |\n| host_routes       |                                                |\n| id                | f2025c22-a90d-4576-803a-b93274f5ef45           |\n| ip_version        | 4                                              |\n| ipv6_address_mode |                                                |\n| ipv6_ra_mode      |                                                |\n| name              | public-subnet                                  |\n| network_id        | 35d70304-cbb6-4b1d-b73e-334c47148f32           |\n| tenant_id         | 5623e92cd94c4741b4b9c117ecebd0be               |\n+-------------------+------------------------------------------------+\nprivate network:\n+---------------------------+--------------------------------------+\n| Field                     | Value                                |\n+---------------------------+--------------------------------------+\n| admin_state_up            | True                                 |\n| id                        | a82c3db3-1bb6-4b17-9c48-e508a49f5f4b |\n| name                      | private                              |\n| provider:network_type     | vlan                                 |\n| provider:physical_network | physnet1                             |\n| provider:segmentation_id  | 100                                  |\n| router:external           | False                                |\n| shared                    | False                                |\n| status                    | ACTIVE                               |\n| subnets                   | 6fed0e5f-8037-4637-ae7e-1c413415172a |\n| tenant_id                 | 90e3e6153f444a07986c3c12d3129852     |\n+---------------------------+--------------------------------------+\nsubnet:\n+-------------------+--------------------------------------------+\n| Field             | Value                                      |\n+-------------------+--------------------------------------------+\n| allocation_pools  | {\"start\": \"10.0.0.2\", \"end\": \"10.0.0.254\"} |\n| cidr              | 10.0.0.0/24                                |\n| dns_nameservers   |                                            |\n| enable_dhcp       | True                                       |\n| gateway_ip        | 10.0.0.1                                   |\n| host_routes       |                                            |\n| id                | 6fed0e5f-8037-4637-ae7e-1c413415172a       |\n| ip_version        | 4                                          |\n| ipv6_address_mode |                                            |\n| ipv6_ra_mode      |                                            |\n| name              | private-subnet                             |\n| network_id        | a82c3db3-1bb6-4b17-9c48-e508a49f5f4b       |\n| tenant_id         | 90e3e6153f444a07986c3c12d3129852           |\n+-------------------+--------------------------------------------+\nport:\n+-----------------------+----------------------------------------------------------------------------------------------+\n| Field                 | Value                                                                                        |\n+-----------------------+----------------------------------------------------------------------------------------------+\n| admin_state_up        | True                                                                                         |\n| allowed_address_pairs |                                                                                              |\n| binding:host_id       | mvcw                                                                                         |\n| binding:profile       | {\"pci_slot\": \"0000:04:11.7\", \"physical_network\": \"physnet1\", \"pci_vendor_info\": \"8086:1515\"} |\n| binding:vif_details   | {\"port_filter\": false, \"vlan\": \"100\"}                                                        |\n| binding:vif_type      | hw_veb                                                                                       |\n| binding:vnic_type     | direct                                                                                       |\n| device_id             | f4e35c33-4466-4897-af2a-c0ded655d212                                                         |\n| device_owner          | compute:None                                                                                 |\n| extra_dhcp_opts       |                                                                                              |\n| fixed_ips             | {\"subnet_id\": \"6fed0e5f-8037-4637-ae7e-1c413415172a\", \"ip_address\": \"10.0.0.2\"}              |\n| id                    | afeace83-8a6a-4c6d-8f2b-9b8a276f068c                                                         |\n| mac_address           | fa:16:3e:b1:2a:1e                                                                            |\n| name                  |                                                                                              |\n| network_id            | a82c3db3-1bb6-4b17-9c48-e508a49f5f4b                                                         |\n| security_groups       | 738a8aec-2e4c-4c9f-ab11-e855810838f8                                                         |\n| status                | BUILD                                                                                        |\n| tenant_id             | 90e3e6153f444a07986c3c12d3129852                                                             |\n+-----------------------+----------------------------------------------------------------------------------------------+\n\nnova boot --image <image-id> --flavor m1.tiny --nic port-id=afeace83-8a6a-4c6d-8f2b-9b8a276f068c vm1\n\nAnd here is the log from VM:\n\n[    0.062832] EVM: security.selinux\n[    0.063639] EVM: security.SMACK64\n[    0.064006] EVM: security.capability\n[    0.065528] print_constraints: dummy: \n[    0.066485] RTC time:  6:29:57, date: 01/08/15\n[    0.067505] NET: Registered protocol family 16\n[    0.068097] ACPI: bus type pci registered\n[    0.069133] PCI: Using configuration type 1 for base access\n[    0.070893] bio: create slab <bio-0> at 0\n[    0.072068] ACPI: Added _OSI(Module Device)\n[    0.073033] ACPI: Added _OSI(Processor Device)\n[    0.074026] ACPI: Added _OSI(3.0 _SCP Extensions)\n[    0.075052] ACPI: Added _OSI(Processor Aggregator Device)\n[    0.077575] ACPI: Interpreter enabled\n[    0.078447] ACPI: (supports S0 S3 S4 S5)\n[    0.080732] ACPI: Using IOAPIC for interrupt routing\n[    0.083832] ACPI: No dock devices found.\n[    0.084006] HEST: Table not found.\n[    0.084840] PCI: Using host bridge windows from ACPI; if necessary, use \"pci=nocrs\" and report a bug\n[    0.086785] ACPI: PCI Root Bridge [PCI0] (domain 0000 [bus 00-ff])\n[    0.088096] pci_root PNP0A03:00: host bridge window [io  0x0000-0x0cf7]\n[    0.089487] pci_root PNP0A03:00: host bridge window [io  0x0d00-0xadff]\n[    0.090841] pci_root PNP0A03:00: host bridge window [io  0xae0f-0xaeff]\n[    0.092008] pci_root PNP0A03:00: host bridge window [io  0xaf20-0xafdf]\n[    0.093366] pci_root PNP0A03:00: host bridge window [io  0xafe4-0xffff]\n[    0.094703] pci_root PNP0A03:00: host bridge window [mem 0x000a0000-0x000bffff]\n[    0.096008] pci_root PNP0A03:00: host bridge window [mem 0x20000000-0xfebfffff]\n[    0.109141] pci 0000:00:01.3: quirk: [io  0xb000-0xb03f] claimed by PIIX4 ACPI\n[    0.110791] pci 0000:00:01.3: quirk: [io  0xb100-0xb10f] claimed by PIIX4 SMB\n\nVM never comes up as VM console hangs forever.\nAnother issue is that after this launching another VM is not possible . nova-compute fails to run.\n\nUbuntu 14.04 with devstack setup has been used to verify this feature and  the to configure nova and neutron this link has been used.\nhttps://wiki.openstack.org/wiki/SR-IOV-Passthrough-For-Networking#SR-IOV_Configuration", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 16, 
    "link": "https://bugs.launchpad.net/nova/+bug/1408572", 
    "owner": "https://api.launchpad.net/1.0/~ribs-1988", 
    "id": 1408572, 
    "index": 6637, 
    "openned": "2015-01-08 07:08:26.721333+00:00", 
    "created": "2015-01-08 07:08:26.721333+00:00", 
    "title": "Launch VM is having issue when using sriov pci passthrough feature", 
    "comments": [
        {
            "content": "Launched VM :\nExternal network:\n+---------------------------+--------------------------------------+\n| Field                     | Value                                |\n+---------------------------+--------------------------------------+\n| admin_state_up            | True                                 |\n| id                        | 35d70304-cbb6-4b1d-b73e-334c47148f32 |\n| name                      | public                               |\n| provider:network_type     | vlan                                 |\n| provider:physical_network | physnet1                             |\n| provider:segmentation_id  | 101                                  |\n| router:external           | True                                 |\n| shared                    | False                                |\n| status                    | ACTIVE                               |\n| subnets                   | f2025c22-a90d-4576-803a-b93274f5ef45 |\n| tenant_id                 | 5623e92cd94c4741b4b9c117ecebd0be     |\n+---------------------------+--------------------------------------+\nsubnet:\n+-------------------+------------------------------------------------+\n| Field             | Value                                          |\n+-------------------+------------------------------------------------+\n| allocation_pools  | {\"start\": \"172.24.4.2\", \"end\": \"172.24.4.254\"} |\n| cidr              | 172.24.4.0/24                                  |\n| dns_nameservers   |                                                |\n| enable_dhcp       | False                                          |\n| gateway_ip        | 172.24.4.1                                     |\n| host_routes       |                                                |\n| id                | f2025c22-a90d-4576-803a-b93274f5ef45           |\n| ip_version        | 4                                              |\n| ipv6_address_mode |                                                |\n| ipv6_ra_mode      |                                                |\n| name              | public-subnet                                  |\n| network_id        | 35d70304-cbb6-4b1d-b73e-334c47148f32           |\n| tenant_id         | 5623e92cd94c4741b4b9c117ecebd0be               |\n+-------------------+------------------------------------------------+\nprivate network:\n+---------------------------+--------------------------------------+\n| Field                     | Value                                |\n+---------------------------+--------------------------------------+\n| admin_state_up            | True                                 |\n| id                        | a82c3db3-1bb6-4b17-9c48-e508a49f5f4b |\n| name                      | private                              |\n| provider:network_type     | vlan                                 |\n| provider:physical_network | physnet1                             |\n| provider:segmentation_id  | 100                                  |\n| router:external           | False                                |\n| shared                    | False                                |\n| status                    | ACTIVE                               |\n| subnets                   | 6fed0e5f-8037-4637-ae7e-1c413415172a |\n| tenant_id                 | 90e3e6153f444a07986c3c12d3129852     |\n+---------------------------+--------------------------------------+\nsubnet:\n+-------------------+--------------------------------------------+\n| Field             | Value                                      |\n+-------------------+--------------------------------------------+\n| allocation_pools  | {\"start\": \"10.0.0.2\", \"end\": \"10.0.0.254\"} |\n| cidr              | 10.0.0.0/24                                |\n| dns_nameservers   |                                            |\n| enable_dhcp       | True                                       |\n| gateway_ip        | 10.0.0.1                                   |\n| host_routes       |                                            |\n| id                | 6fed0e5f-8037-4637-ae7e-1c413415172a       |\n| ip_version        | 4                                          |\n| ipv6_address_mode |                                            |\n| ipv6_ra_mode      |                                            |\n| name              | private-subnet                             |\n| network_id        | a82c3db3-1bb6-4b17-9c48-e508a49f5f4b       |\n| tenant_id         | 90e3e6153f444a07986c3c12d3129852           |\n+-------------------+--------------------------------------------+\nport:\n+-----------------------+----------------------------------------------------------------------------------------------+\n| Field                 | Value                                                                                        |\n+-----------------------+----------------------------------------------------------------------------------------------+\n| admin_state_up        | True                                                                                         |\n| allowed_address_pairs |                                                                                              |\n| binding:host_id       | mvcw                                                                                         |\n| binding:profile       | {\"pci_slot\": \"0000:04:11.7\", \"physical_network\": \"physnet1\", \"pci_vendor_info\": \"8086:1515\"} |\n| binding:vif_details   | {\"port_filter\": false, \"vlan\": \"100\"}                                                        |\n| binding:vif_type      | hw_veb                                                                                       |\n| binding:vnic_type     | direct                                                                                       |\n| device_id             | f4e35c33-4466-4897-af2a-c0ded655d212                                                         |\n| device_owner          | compute:None                                                                                 |\n| extra_dhcp_opts       |                                                                                              |\n| fixed_ips             | {\"subnet_id\": \"6fed0e5f-8037-4637-ae7e-1c413415172a\", \"ip_address\": \"10.0.0.2\"}              |\n| id                    | afeace83-8a6a-4c6d-8f2b-9b8a276f068c                                                         |\n| mac_address           | fa:16:3e:b1:2a:1e                                                                            |\n| name                  |                                                                                              |\n| network_id            | a82c3db3-1bb6-4b17-9c48-e508a49f5f4b                                                         |\n| security_groups       | 738a8aec-2e4c-4c9f-ab11-e855810838f8                                                         |\n| status                | BUILD                                                                                        |\n| tenant_id             | 90e3e6153f444a07986c3c12d3129852                                                             |\n+-----------------------+----------------------------------------------------------------------------------------------+\n\nnova boot --image <image-id> --flavor m1.tiny --nic port-id=afeace83-8a6a-4c6d-8f2b-9b8a276f068c vm1\n\nAnd here is the log from VM:\n\n[    0.062832] EVM: security.selinux\n[    0.063639] EVM: security.SMACK64\n[    0.064006] EVM: security.capability\n[    0.065528] print_constraints: dummy: \n[    0.066485] RTC time:  6:29:57, date: 01/08/15\n[    0.067505] NET: Registered protocol family 16\n[    0.068097] ACPI: bus type pci registered\n[    0.069133] PCI: Using configuration type 1 for base access\n[    0.070893] bio: create slab <bio-0> at 0\n[    0.072068] ACPI: Added _OSI(Module Device)\n[    0.073033] ACPI: Added _OSI(Processor Device)\n[    0.074026] ACPI: Added _OSI(3.0 _SCP Extensions)\n[    0.075052] ACPI: Added _OSI(Processor Aggregator Device)\n[    0.077575] ACPI: Interpreter enabled\n[    0.078447] ACPI: (supports S0 S3 S4 S5)\n[    0.080732] ACPI: Using IOAPIC for interrupt routing\n[    0.083832] ACPI: No dock devices found.\n[    0.084006] HEST: Table not found.\n[    0.084840] PCI: Using host bridge windows from ACPI; if necessary, use \"pci=nocrs\" and report a bug\n[    0.086785] ACPI: PCI Root Bridge [PCI0] (domain 0000 [bus 00-ff])\n[    0.088096] pci_root PNP0A03:00: host bridge window [io  0x0000-0x0cf7]\n[    0.089487] pci_root PNP0A03:00: host bridge window [io  0x0d00-0xadff]\n[    0.090841] pci_root PNP0A03:00: host bridge window [io  0xae0f-0xaeff]\n[    0.092008] pci_root PNP0A03:00: host bridge window [io  0xaf20-0xafdf]\n[    0.093366] pci_root PNP0A03:00: host bridge window [io  0xafe4-0xffff]\n[    0.094703] pci_root PNP0A03:00: host bridge window [mem 0x000a0000-0x000bffff]\n[    0.096008] pci_root PNP0A03:00: host bridge window [mem 0x20000000-0xfebfffff]\n[    0.109141] pci 0000:00:01.3: quirk: [io  0xb000-0xb03f] claimed by PIIX4 ACPI\n[    0.110791] pci 0000:00:01.3: quirk: [io  0xb100-0xb10f] claimed by PIIX4 SMB\n\nVM never comes up as VM console hangs forever.\nAnother issue is that after this launching another VM is not possible . nova-compute fails to run.\n\nUbuntu 14.04 with devstack setup has been used to verify this feature and  the to configure nova and neutron this link has been used.\nhttps://wiki.openstack.org/wiki/SR-IOV-Passthrough-For-Networking#SR-IOV_Configuration", 
            "date_created": "2015-01-08 07:08:26.721333+00:00", 
            "author": "https://api.launchpad.net/1.0/~srangare"
        }, 
        {
            "content": "", 
            "date_created": "2015-01-08 09:28:59.081046+00:00", 
            "author": "https://api.launchpad.net/1.0/~srangare"
        }, 
        {
            "content": "It's not a BUG may be you are booting with wrong image , First check with same image without openstack using qemu give pci host devices ( VF's) and boot VM via qemu . I am sure It will not boot . \nThe same problem happens to me I am booting with cirros image and same console was comming and boot process hangs because support was not there in image itself to handle sriov vf's . \n\nThen I booted with image (ubuntu 14.04) which I already checked with qemu that sriov vf's are comming up . \nAnd it's Booted fine with sriov vf's .  \nNow I only had a problem the assigned IP address for sriov ports are not reflecting in instances .", 
            "date_created": "2015-01-13 13:41:32.082719+00:00", 
            "author": "https://api.launchpad.net/1.0/~ribs-1988"
        }, 
        {
            "content": "Yes, it was the problem with cirros image, using another image say ubuntu or fedora has worked. I have assigned ip address manually and verified this feature.", 
            "date_created": "2015-01-13 13:53:01.680988+00:00", 
            "author": "https://api.launchpad.net/1.0/~srangare"
        }, 
        {
            "content": "Thanks,\nYes checked with assigning ip address other than which openstack assigned for particular instance . \nBut still if openstack is binding a port having particular ip , instance should get that particular IP . \n\nGetting Errors in neutron-sriov-nic-agent :\n2015-01-13 18:28:46.843 18880 TRACE neutron.plugins.sriovnicagent.pci_lib Command: ['sudo', '/usr/bin/neutron-rootwrap', '/etc/neutron/rootwrap.conf', 'ip', 'link', 'set', 'eth6', 'vf', '11', 'state', 'enable']\n2015-01-13 18:28:46.843 18880 TRACE neutron.plugins.sriovnicagent.pci_lib Exit code: 2\n2015-01-13 18:28:46.843 18880 TRACE neutron.plugins.sriovnicagent.pci_lib Stdout: ''\n2015-01-13 18:28:46.843 18880 TRACE neutron.plugins.sriovnicagent.pci_lib Stderr: 'RTNETLINK answers: Operation not supported\\n'\n\nbecause driver does not support ip link set <PF> vf <VF_NO.> state enable   . ", 
            "date_created": "2015-01-13 14:17:09.202268+00:00", 
            "author": "https://api.launchpad.net/1.0/~ribs-1988"
        }, 
        {
            "content": "Rito,\n\nwhat is the NIC you are using?\nas far as I know Intel NIC does't support ip link up/down so there is no point in using sriovnicagent.\nwith Nellanox NIC this operation is supported. ", 
            "date_created": "2015-01-13 18:30:46.190119+00:00", 
            "author": "https://api.launchpad.net/1.0/~moshele"
        }, 
        {
            "content": "Moshe,\n\nUsing Intel Cards only :\nproduct: Ethernet 10G 2P X520 Adapter \n\nAs I followed the document \nhttps://wiki.openstack.org/wiki/SR-IOV-Passthrough-For-Networking#SR-IOV_Configuration\n\nSo You mean to say the settings should be \n1. In Neutron Server  under /etc/neutron/plugins/ml2/ml2_conf_sriov.ini\nagent_required = False\n\n2. Neutron Server should run without  --config-file /etc/neutron/plugins/ml2/ml2_conf_sriov.ini\n\n3. No need to run   neutron-sriov-nic-agent\n\n4. But under /etc/neutron/plugins/ml2/ml2_conf_sriov.ini\n[sriov_nic]\nphysical_device_mappings = physnet1:eth1\nexclude_devices =\nIS Necessasry", 
            "date_created": "2015-01-14 04:36:45.328822+00:00", 
            "author": "https://api.launchpad.net/1.0/~ribs-1988"
        }, 
        {
            "content": "for 1-3 the answer is yes.\nfor 4 you don't need this section as well.\nI am moving it to invalid.\n", 
            "date_created": "2015-01-18 20:56:20.835312+00:00", 
            "author": "https://api.launchpad.net/1.0/~moshele"
        }
    ], 
    "closed": "2015-01-18 20:56:58.157110+00:00"
}