{
    "status": "In Progress", 
    "last_updated": "2017-06-28 12:09:15.742570+00:00", 
    "description": "2015-06-29 14:24:49.211 DEBUG oslo_vmware.exceptions [-] Fault InvalidDatastorePath not matched. from (pid=21558) get_fault_class /usr/local/lib/python2.7/dist-packages/oslo_vmware/exceptions.py:250\n2015-06-29 14:24:49.212 ERROR oslo_vmware.common.loopingcall [-] in fixed duration looping call\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall Traceback (most recent call last):\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall   File \"/usr/local/lib/python2.7/dist-packages/oslo_vmware/common/loopingcall.py\", line 76, in _inner\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall     self.f(*self.args, **self.kw)\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall   File \"/usr/local/lib/python2.7/dist-packages/oslo_vmware/api.py\", line 417, in _poll_task\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall     raise task_ex\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall VMwareDriverException: Invalid datastore path '[localdatastore] volume-c279ad39-f1f9-4861-9d00-2de8f6df7756/volume-c279ad39-f1f9-4861-9d00-2de8f6df7756.vmdk'.\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall\n2015-06-29 14:24:49.212 ERROR nova.compute.manager [-] [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215] Instance failed to spawn\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215] Traceback (most recent call last):\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2442, in _build_resources\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     yield resources\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2314, in _build_and_run_instance\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     block_device_info=block_device_info)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 480, in spawn\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     admin_password, network_info, block_device_info)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 628, in spawn\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     instance, adapter_type)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 371, in attach_volume\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     self._attach_volume_vmdk(connection_info, instance, adapter_type)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 330, in _attach_volume_vmdk\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     vmdk_path=vmdk.path)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 71, in attach_disk_to_vm\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     vm_util.reconfigure_vm(self._session, vm_ref, vmdk_attach_config_spec)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/vm_util.py\", line 1377, in reconfigure_vm\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     session._wait_for_task(reconfig_task)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 680, in _wait_for_task\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     return self.wait_for_task(task_ref)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/usr/local/lib/python2.7/dist-packages/oslo_vmware/api.py\", line 380, in wait_for_task\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     return evt.wait()\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 121, in wait\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     return hubs.get_hub().switch()\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 294, in switch\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     return self.greenlet.switch()\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/usr/local/lib/python2.7/dist-packages/oslo_vmware/common/loopingcall.py\", line 76, in _inner\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     self.f(*self.args, **self.kw)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/usr/local/lib/python2.7/dist-packages/oslo_vmware/api.py\", line 417, in _poll_task\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     raise task_ex\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215] VMwareDriverException: Invalid datastore path '[localdatastore] volume-c279ad39-f1f9-4861-9d00-2de8f6df7756/volume-c279ad39-f1f9-4861-9d00-2de8f6df7756.vmdk'.", 
    "tags": [
        "vmware"
    ], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1469655", 
    "owner": "https://api.launchpad.net/1.0/~garyk", 
    "id": 1469655, 
    "index": 4283, 
    "openned": "2015-06-29 09:24:09.613783+00:00", 
    "created": "2015-06-29 09:24:09.613783+00:00", 
    "title": "VMware: Instance creation fails using block device mapping in different cluster", 
    "comments": [
        {
            "content": "2015-06-29 14:24:49.211 DEBUG oslo_vmware.exceptions [-] Fault InvalidDatastorePath not matched. from (pid=21558) get_fault_class /usr/local/lib/python2.7/dist-packages/oslo_vmware/exceptions.py:250\n2015-06-29 14:24:49.212 ERROR oslo_vmware.common.loopingcall [-] in fixed duration looping call\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall Traceback (most recent call last):\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall   File \"/usr/local/lib/python2.7/dist-packages/oslo_vmware/common/loopingcall.py\", line 76, in _inner\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall     self.f(*self.args, **self.kw)\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall   File \"/usr/local/lib/python2.7/dist-packages/oslo_vmware/api.py\", line 417, in _poll_task\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall     raise task_ex\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall VMwareDriverException: Invalid datastore path '[localdatastore] volume-c279ad39-f1f9-4861-9d00-2de8f6df7756/volume-c279ad39-f1f9-4861-9d00-2de8f6df7756.vmdk'.\n2015-06-29 14:24:49.212 TRACE oslo_vmware.common.loopingcall\n2015-06-29 14:24:49.212 ERROR nova.compute.manager [-] [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215] Instance failed to spawn\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215] Traceback (most recent call last):\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2442, in _build_resources\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     yield resources\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2314, in _build_and_run_instance\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     block_device_info=block_device_info)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 480, in spawn\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     admin_password, network_info, block_device_info)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 628, in spawn\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     instance, adapter_type)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 371, in attach_volume\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     self._attach_volume_vmdk(connection_info, instance, adapter_type)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 330, in _attach_volume_vmdk\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     vmdk_path=vmdk.path)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 71, in attach_disk_to_vm\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     vm_util.reconfigure_vm(self._session, vm_ref, vmdk_attach_config_spec)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/vm_util.py\", line 1377, in reconfigure_vm\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     session._wait_for_task(reconfig_task)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 680, in _wait_for_task\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     return self.wait_for_task(task_ref)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/usr/local/lib/python2.7/dist-packages/oslo_vmware/api.py\", line 380, in wait_for_task\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     return evt.wait()\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 121, in wait\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     return hubs.get_hub().switch()\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 294, in switch\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     return self.greenlet.switch()\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/usr/local/lib/python2.7/dist-packages/oslo_vmware/common/loopingcall.py\", line 76, in _inner\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     self.f(*self.args, **self.kw)\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]   File \"/usr/local/lib/python2.7/dist-packages/oslo_vmware/api.py\", line 417, in _poll_task\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215]     raise task_ex\n2015-06-29 14:24:49.212 TRACE nova.compute.manager [instance: 0a55fe16-3a21-40f0-85f3-777d6254f215] VMwareDriverException: Invalid datastore path '[localdatastore] volume-c279ad39-f1f9-4861-9d00-2de8f6df7756/volume-c279ad39-f1f9-4861-9d00-2de8f6df7756.vmdk'.", 
            "date_created": "2015-06-29 09:24:09.613783+00:00", 
            "author": "https://api.launchpad.net/1.0/~acbharadwaj"
        }, 
        {
            "content": "During instance creation with volume, \n\nnova boot bdm1 --flavor 2 --image  cirros-0.3.2-i386-disk --block-device-mapping  sdb=c279ad39-f1f9-4861-9d00-2de8f6df7756::5\n\nif the volume gets created in a different cluster/ different datacenter and instance gets created in another cluster, this bug is observed. ", 
            "date_created": "2015-06-29 09:28:38.643151+00:00", 
            "author": "https://api.launchpad.net/1.0/~acbharadwaj"
        }, 
        {
            "content": "@Chinmaya Bharadwaj (acbharadwaj):\n\nSince you are set as assignee, I switch the status to \"In Progress\".", 
            "date_created": "2015-06-29 12:11:36.604157+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "Please  provide steps to reproduce this.\n\nIf the volume gets created in a datastore which is not accessible to instance's ESX host, it's a Cinder bug.", 
            "date_created": "2015-07-06 04:00:33.135217+00:00", 
            "author": "https://api.launchpad.net/1.0/~vbala"
        }, 
        {
            "content": "@vipin: \n Agree that cinder relocated volume during attach. In normal attach volumes when instances are already created, cinder properly relocated the volume to the proper datastore. \n\nAs I mentioned in the the bug, when doing nova boot with block device mapping, instances are not created, hence Cinder won't know where the instance resides, so nova should do the relocation. Its doing while boot with volume now.", 
            "date_created": "2015-07-06 06:24:06.476271+00:00", 
            "author": "https://api.launchpad.net/1.0/~acbharadwaj"
        }, 
        {
            "content": "steps to reproduce:\n\n1) have multiple clusters/ datacenters\n2) Nova boot with volume, ex:\nnova boot bdm1 --flavor 2 --image cirros-0.3.2-i386-disk --block-device-mapping sdb=c279ad39-f1f9-4861-9d00-2de8f6df7756::5\n\nIssue wont be seen if the volume gets created in the compute cluster itself. If so, delete the VM and move the volume to a datastore where the cluster's host wont have access to.  Try nova boot again. ", 
            "date_created": "2015-07-06 17:08:07.943752+00:00", 
            "author": "https://api.launchpad.net/1.0/~acbharadwaj"
        }, 
        {
            "content": "Change abandoned by Chinmaya Bharadwaj (<email address hidden>) on branch: master\nReview: https://review.openstack.org/197192\nReason: Abandoning since https://review.openstack.org/#/c/218639/  addresses this.", 
            "date_created": "2015-09-11 03:08:57.483433+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "\nThere are no currently open reviews on this bug, changing\nthe status back to the previous state and unassigning. If\nthere are active reviews related to this bug, please include\nlinks in comments.\n", 
            "date_created": "2017-06-23 12:34:04.584720+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }
    ]
}