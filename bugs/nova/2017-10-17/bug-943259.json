{
    "status": "Fix Released", 
    "last_updated": "2012-04-05 10:55:36.365288+00:00", 
    "description": "I have a Nova installation that's configured to use Glance as image service. Glance is configured to use PostgreSQL as a database.\n\nImage listing in Nova doesn't return any images if I filter by status in upper case. Example:\n\ncurl -i http://172.18.67.136:8774/v1.1/1/images?status=ACTIVE -X GET -H \"X-Auth-Project-Id: admin\" -H \"User-Agent: python-novaclient\" -H \"X-Auth-Token: nova\"\nHTTP/1.1 200 OK\nContent-Type: application/json\nContent-Length: 14\nDate: Wed, 29 Feb 2012 13:26:21 GMT\n\n{\"images\": []}\n\nHowever,\n\ncurl -i http://172.18.67.137:8774/v1.1/1/images?status=active -X GET -H \"X-Auth-Project-Id: admin\" -H \"User-Agent: python-novaclient\" -H \"X-Auth-Token: nova\"\nHTTP/1.1 200 OK\nContent-Type: application/json\nContent-Length: 1320\nDate: Wed, 29 Feb 2012 13:27:30 GMT\n\n{\"images\": [{\"id\": \"23e2fb2d-6c1d-40a3-bcf2-825b44a064c4\", \"links\": [{\"href\": \"http://172.18.67.137:8774/v1.1/1/images/23e2fb2d-6c1d-40a3-bcf2-825b44a064c4\", \"rel\": \"self\"}, {\"href\": \"http://172.18.67.137:8774/1/images/23e2fb2d-6c1d-40a3-bcf2-825b44a064c4\", \"rel\": \"bookmark\"}, {\"href\": \"http://172.18.67.137:9292/1/images/23e2fb2d-6c1d-40a3-bcf2-825b44a064c4\", \"type\": \"application/vnd.openstack.image\", \"rel\": \"alternate\"}], \"name\": \"tty\"}, {\"id\": \"26d6b279-be00-4f1b-b5aa-04019f0cf187\", \"links\": [{\"href\": \"http://172.18.67.137:8774/v1.1/1/images/26d6b279-be00-4f1b-b5aa-04019f0cf187\", \"rel\": \"self\"}, {\"href\": \"http://172.18.67.137:8774/1/images/26d6b279-be00-4f1b-b5aa-04019f0cf187\", \"rel\": \"bookmark\"}, {\"href\": \"http://172.18.67.137:9292/1/images/26d6b279-be00-4f1b-b5aa-04019f0cf187\", \"type\": \"application/vnd.openstack.image\", \"rel\": \"alternate\"}], \"name\": \"tty-ramdisk\"}, {\"id\": \"e685e213-50ce-4055-8ad4-084f9df44d58\", \"links\": [{\"href\": \"http://172.18.67.137:8774/v1.1/1/images/e685e213-50ce-4055-8ad4-084f9df44d58\", \"rel\": \"self\"}, {\"href\": \"http://172.18.67.137:8774/1/images/e685e213-50ce-4055-8ad4-084f9df44d58\", \"rel\": \"bookmark\"}, {\"href\": \"http://172.18.67.137:9292/1/images/e685e213-50ce-4055-8ad4-084f9df44d58\", \"type\": \"application/vnd.openstack.image\", \"rel\": \"alternate\"}], \"name\": \"tty-kernel\"}]}\n\nThe reason is that PostgreSQL is case sensitive. Glance stores images' statuses in lower case, so filtering by status in upper case doesn't show any result.  And nova passes filters as is, the request above doesn't show relevant results. This is not quite right as some API consumers doesn't care much about case of the status.\n\n\nThe problem could be easily reproduced by glance only:\n\nroot@host:~# glance -A nova index status=ACTIVE|wc -l\n0\nroot@host:~# glance -A nova index status=active|wc -l\n5\nroot@host:~# \n\nAccording to the documentation, nova uses uppercase statuses in filters: \"In-flight images will have the status attribute set to SAVING and the conditional progress element (0-100% completion) will also be returned. Other possible values for the status attribute include: UNKNOWN, ACTIVE, SAVING, ERROR, and DELETED. \" (c) http://docs.openstack.org/api/openstack-compute/2/content/List_Images-d1e4435.html\n\nAnd Glance expects statuses to be lowercase: http://glance.openstack.org/statuses.html\n\nSo appears that the right think would be to convert statuses to lowercase before passing them to Glance. \n\nAttached a patch which fixes the problem for me.", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/943259", 
    "owner": "https://api.launchpad.net/1.0/~bcwaldon", 
    "id": 943259, 
    "index": 2781, 
    "openned": "2012-02-29 13:41:56.488713+00:00", 
    "created": "2012-02-29 13:41:56.488713+00:00", 
    "title": "images filtering with Glance image services and PostgreSQL", 
    "comments": [
        {
            "content": "I have a Nova installation that's configured to use Glance as image service. Glance is configured to use PostgreSQL as a database.\n\nImage listing in Nova doesn't return any images if I filter by status in upper case. Example:\n\ncurl -i http://172.18.67.136:8774/v1.1/1/images?status=ACTIVE -X GET -H \"X-Auth-Project-Id: admin\" -H \"User-Agent: python-novaclient\" -H \"X-Auth-Token: nova\"\nHTTP/1.1 200 OK\nContent-Type: application/json\nContent-Length: 14\nDate: Wed, 29 Feb 2012 13:26:21 GMT\n\n{\"images\": []}\n\nHowever,\n\ncurl -i http://172.18.67.137:8774/v1.1/1/images?status=active -X GET -H \"X-Auth-Project-Id: admin\" -H \"User-Agent: python-novaclient\" -H \"X-Auth-Token: nova\"\nHTTP/1.1 200 OK\nContent-Type: application/json\nContent-Length: 1320\nDate: Wed, 29 Feb 2012 13:27:30 GMT\n\n{\"images\": [{\"id\": \"23e2fb2d-6c1d-40a3-bcf2-825b44a064c4\", \"links\": [{\"href\": \"http://172.18.67.137:8774/v1.1/1/images/23e2fb2d-6c1d-40a3-bcf2-825b44a064c4\", \"rel\": \"self\"}, {\"href\": \"http://172.18.67.137:8774/1/images/23e2fb2d-6c1d-40a3-bcf2-825b44a064c4\", \"rel\": \"bookmark\"}, {\"href\": \"http://172.18.67.137:9292/1/images/23e2fb2d-6c1d-40a3-bcf2-825b44a064c4\", \"type\": \"application/vnd.openstack.image\", \"rel\": \"alternate\"}], \"name\": \"tty\"}, {\"id\": \"26d6b279-be00-4f1b-b5aa-04019f0cf187\", \"links\": [{\"href\": \"http://172.18.67.137:8774/v1.1/1/images/26d6b279-be00-4f1b-b5aa-04019f0cf187\", \"rel\": \"self\"}, {\"href\": \"http://172.18.67.137:8774/1/images/26d6b279-be00-4f1b-b5aa-04019f0cf187\", \"rel\": \"bookmark\"}, {\"href\": \"http://172.18.67.137:9292/1/images/26d6b279-be00-4f1b-b5aa-04019f0cf187\", \"type\": \"application/vnd.openstack.image\", \"rel\": \"alternate\"}], \"name\": \"tty-ramdisk\"}, {\"id\": \"e685e213-50ce-4055-8ad4-084f9df44d58\", \"links\": [{\"href\": \"http://172.18.67.137:8774/v1.1/1/images/e685e213-50ce-4055-8ad4-084f9df44d58\", \"rel\": \"self\"}, {\"href\": \"http://172.18.67.137:8774/1/images/e685e213-50ce-4055-8ad4-084f9df44d58\", \"rel\": \"bookmark\"}, {\"href\": \"http://172.18.67.137:9292/1/images/e685e213-50ce-4055-8ad4-084f9df44d58\", \"type\": \"application/vnd.openstack.image\", \"rel\": \"alternate\"}], \"name\": \"tty-kernel\"}]}\n\nThe reason is that PostgreSQL is case sensitive. Glance stores images' statuses in lower case, so filtering by status in upper case doesn't show any result.  And nova passes filters as is, the request above doesn't show relevant results. This is not quite right as some API consumers doesn't care much about case of the status.\n\n\nThe problem could be easily reproduced by glance only:\n\nroot@host:~# glance -A nova index status=ACTIVE|wc -l\n0\nroot@host:~# glance -A nova index status=active|wc -l\n5\nroot@host:~# \n\nAccording to the documentation, nova uses uppercase statuses in filters: \"In-flight images will have the status attribute set to SAVING and the conditional progress element (0-100% completion) will also be returned. Other possible values for the status attribute include: UNKNOWN, ACTIVE, SAVING, ERROR, and DELETED. \" (c) http://docs.openstack.org/api/openstack-compute/2/content/List_Images-d1e4435.html\n\nAnd Glance expects statuses to be lowercase: http://glance.openstack.org/statuses.html\n\nSo appears that the right think would be to convert statuses to lowercase before passing them to Glance. \n\nAttached a patch which fixes the problem for me.", 
            "date_created": "2012-02-29 13:41:56.488713+00:00", 
            "author": "https://api.launchpad.net/1.0/~novel"
        }, 
        {
            "content": "", 
            "date_created": "2012-02-29 13:41:56.488713+00:00", 
            "author": "https://api.launchpad.net/1.0/~novel"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/4775", 
            "date_created": "2012-03-01 22:55:28.648113+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/4775\nCommitted: http://github.com/openstack/nova/commit/ff716dee035dd51257b240fad842ecfd70d9d90d\nSubmitter: Jenkins\nBranch:    master\n\ncommit ff716dee035dd51257b240fad842ecfd70d9d90d\nAuthor: Brian Waldon <email address hidden>\nDate:   Thu Mar 1 14:51:03 2012 -0800\n\n    Ensure image status filter matches glance format\n    \n    * Fixes bug 943259\n    \n    Change-Id: Id5172aa40be2f5a337b3e192b4bee8139c16c4d3\n", 
            "date_created": "2012-03-06 23:05:21.509583+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2012-03-20 08:43:40.406627+00:00"
}