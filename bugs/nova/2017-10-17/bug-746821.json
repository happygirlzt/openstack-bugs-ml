{
    "status": "Fix Released", 
    "last_updated": "2011-04-15 08:35:21.636020+00:00", 
    "description": "Steps to reproduce:-\n\nnova.conf settings\nuse_cow_images=False\n\n1) First I created one instance which is running on host ubuntu-openstack-compute-02\n$root@ubuntu-openstack-network-api-server:/home/tpatil# euca-describe-instances\nRESERVATION     r-z0ks6nqu      admin   default\nINSTANCE        i-00000030      ami-0000000b    10.0.0.5        10.0.0.5        running flat (admin, ubuntu-openstack-compute-02)       0               m1.tiny 2011-03-31T22:33:25Z  nova\n\n2) Migrate instance running on ubuntu-openstack-compute-02 to another host ubuntu-openstack-compute-01 using nova-manage command\n$nova/bin/nova-manage --flagfile=/etc/nova/nova.conf vm live_migration i-00000030  ubuntu-openstack-compute-01\nMigration of i-00000030 initiated.Check its progress using euca-describe-instances.\n\n3) Error in nova-compute.log on destination host.\n2011-03-31 15:42:34,081 DEBUG nova.rpc [-] received {'_msg_id': '1e11547d29734cdf8419a518268622b1', '_context_read_deleted': False, '_context_request_id': 'VPPW4LMUT3B8XDVOO92Y', '_context_timestamp': '2011-03-31T22:42:05Z', '_context_is_admin': True, '_context_user': None, 'method': 'create_shared_storage_test_file', '_context_project': None, '_context_remote_address': None} from (pid=12463) _receive /home/tpatil/nova/nova/rpc.py:169\n2011-03-31 15:42:34,082 DEBUG nova.rpc [-] unpacked context: {'timestamp': '2011-03-31T22:42:05Z', 'remote_address': None, 'project': None, 'is_admin': True, 'user': None, 'request_id': 'VPPW4LMUT3B8XDVOO92Y', 'read_deleted': False} from (pid=12463) _unpack_context /home/tpatil/nova/nova/rpc.py:333\n2011-03-31 15:42:34,206 DEBUG nova.compute.manager [-] Creating tmpfile /nova/instances/tmp2FvNq8 to notify to other compute nodes that they should mount the same storage. from (pid=12463) create_shared_storage_test_file /home/tpatil/nova/nova/compute/manager.py:812\n2011-03-31 15:42:34,814 DEBUG nova.rpc [-] received {'_msg_id': '0664ca60960a4882841a5b2eb313cf33', '_context_read_deleted': False, '_context_request_id': 'VPPW4LMUT3B8XDVOO92Y', 'args': {'filename': 'tmp2FvNq8'}, '_context_is_admin': True, '_context_timestamp': '2011-03-31T22:42:05Z', '_context_user': None, 'method': 'cleanup_shared_storage_test_file', '_context_project': None, '_context_remote_address': None} from (pid=12463) _receive /home/tpatil/nova/nova/rpc.py:169\n2011-03-31 15:42:34,815 DEBUG nova.rpc [-] unpacked context: {'timestamp': '2011-03-31T22:42:05Z', 'remote_address': None, 'project': None, 'is_admin': True, 'user': None, 'request_id': 'VPPW4LMUT3B8XDVOO92Y', 'read_deleted': False} from (pid=12463) _unpack_context /home/tpatil/nova/nova/rpc.py:333\n2011-03-31 15:42:35,118 DEBUG nova.rpc [-] received {'_msg_id': 'eb6b2604e0634b18b2f12b8b1477cf64', '_context_read_deleted': False, '_context_request_id': 'VPPW4LMUT3B8XDVOO92Y', 'args': {'cpu_info': '{\"vendor\": \"Intel\", \"model\": \"Nehalem\", \"arch\": \"x86_64\", \"features\": [\"rdtscp\", \"xtpr\", \"tm2\", \"est\", \"vmx\", \"ds_cpl\", \"monitor\", \"pbe\", \"tm\", \"ht\", \"ss\", \"acpi\", \"ds\", \"vme\"], \"topology\": {\"cores\": \"4\", \"threads\": \"2\", \"sockets\": \"1\"}}'}, '_context_is_admin': True, '_context_timestamp': '2011-03-31T22:42:05Z', '_context_user': None, 'method': 'compare_cpu', '_context_project': None, '_context_remote_address': None} from (pid=12463) _receive /home/tpatil/nova/nova/rpc.py:169\n2011-03-31 15:42:35,118 DEBUG nova.rpc [-] unpacked context: {'timestamp': '2011-03-31T22:42:05Z', 'remote_address': None, 'project': None, 'is_admin': True, 'user': None, 'request_id': 'VPPW4LMUT3B8XDVOO92Y', 'read_deleted': False} from (pid=12463) _unpack_context /home/tpatil/nova/nova/rpc.py:333\n2011-03-31 15:42:35,119 INFO nova.virt.libvirt_conn [-] Instance launched has CPU info:\n{\"vendor\": \"Intel\", \"model\": \"Nehalem\", \"arch\": \"x86_64\", \"features\": [\"rdtscp\", \"xtpr\", \"tm2\", \"est\", \"vmx\", \"ds_cpl\", \"monitor\", \"pbe\", \"tm\", \"ht\", \"ss\", \"acpi\", \"ds\", \"vme\"], \"topology\": {\"cores\": \"4\", \"threads\": \"2\", \"sockets\": \"1\"}}\n2011-03-31 15:42:35,148 INFO nova.virt.libvirt_conn [-] to xml...\n:<cpu>\n    <arch>x86_64</arch>\n    <model>Nehalem</model>\n    <vendor>Intel</vendor>\n    <topology sockets=\"1\" cores=\"4\" threads=\"2\"/>\n    <features name=\"rdtscp\" />\n    <features name=\"xtpr\" />\n    <features name=\"tm2\" />\n    <features name=\"est\" />\n    <features name=\"vmx\" />\n    <features name=\"ds_cpl\" />\n    <features name=\"monitor\" />\n    <features name=\"pbe\" />\n    <features name=\"tm\" />\n    <features name=\"ht\" />\n    <features name=\"ss\" />\n    <features name=\"acpi\" />\n    <features name=\"ds\" />\n    <features name=\"vme\" />\n</cpu>\n\n2011-03-31 15:42:35,730 DEBUG nova.rpc [-] received {'_msg_id': 'b6fca21f60c34221aa3491702fe13253', '_context_read_deleted': False, '_context_request_id': 'VPPW4LMUT3B8XDVOO92Y', 'args': {'instance_id': 48}, '_context_is_admin': True, '_context_timestamp': '2011-03-31T22:42:05Z', '_context_user': None, 'method': 'pre_live_migration', '_context_project': None, '_context_remote_address': None} from (pid=12463) _receive /home/tpatil/nova/nova/rpc.py:169\n2011-03-31 15:42:35,730 DEBUG nova.rpc [-] unpacked context: {'timestamp': '2011-03-31T22:42:05Z', 'remote_address': None, 'project': None, 'is_admin': True, 'user': None, 'request_id': 'VPPW4LMUT3B8XDVOO92Y', 'read_deleted': False} from (pid=12463) _unpack_context /home/tpatil/nova/nova/rpc.py:333\n2011-03-31 15:42:35,891 INFO nova.compute.manager [-] i-00000030 has no volume.\n2011-03-31 15:42:35,919 DEBUG nova.utils [-] Running cmd (subprocess): ip link show dev vlan100 from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:35,926 DEBUG nova.utils [-] Running cmd (subprocess): ip link show dev br100 from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:35,933 DEBUG nova.utils [-] Running cmd (subprocess): sudo route -n from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:35,944 DEBUG nova.utils [-] Running cmd (subprocess): sudo ip addr show dev vlan100 scope global from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:35,954 DEBUG nova.utils [-] Running cmd (subprocess): sudo brctl addif br100 vlan100 from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:35,963 DEBUG nova.utils [-] Result was 1 from (pid=12463) execute /home/tpatil/nova/nova/utils.py:166\n2011-03-31 15:42:36,004 INFO nova [-] called setup_basic_filtering in nwfilter\n2011-03-31 15:42:36,005 INFO nova [-] ensuring static filters\n2011-03-31 15:42:36,225 INFO nova [-] <nova.db.sqlalchemy.models.SecurityGroupIngressRule object at 0x44e64d0>\n2011-03-31 15:42:36,225 INFO nova [-] <nova.db.sqlalchemy.models.SecurityGroupIngressRule object at 0x44e6850>\n2011-03-31 15:42:36,247 DEBUG nova.utils [-] Attempting to grab semaphore \"iptables\" for method \"apply\"... from (pid=12463) inner /home/tpatil/nova/nova/utils.py:594\n2011-03-31 15:42:36,247 DEBUG nova.utils [-] Attempting to grab file lock \"iptables\" for method \"apply\"... from (pid=12463) inner /home/tpatil/nova/nova/utils.py:599\n2011-03-31 15:42:36,269 DEBUG nova.utils [-] Running cmd (subprocess): sudo iptables-save -t filter from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:36,281 DEBUG nova.utils [-] Running cmd (subprocess): sudo iptables-restore from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:36,301 DEBUG nova.utils [-] Running cmd (subprocess): sudo iptables-save -t nat from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:36,312 DEBUG nova.utils [-] Running cmd (subprocess): sudo iptables-restore from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:36,323 DEBUG nova.utils [-] Running cmd (subprocess): sudo ip6tables-save -t filter from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:36,335 DEBUG nova.utils [-] Running cmd (subprocess): sudo ip6tables-restore from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:43:05,624 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/home/tpatil/nova/nova/rpc.py\", line 190, in _receive\n(nova): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova): TRACE:   File \"/home/tpatil/nova/nova/compute/manager.py\", line 908, in pre_live_migration\n(nova): TRACE:     self.driver.ensure_filtering_rules_for_instance(instance_ref)\n(nova): TRACE:   File \"/home/tpatil/nova/nova/virt/libvirt_conn.py\", line 1414, in ensure_filtering_rules_for_instance\n(nova): TRACE:     raise exception.Error(msg % locals())\n(nova): TRACE: Error: Timeout migrating for i-00000030(instance-00000030)\n(nova): TRACE:\n2011-03-31 15:43:05,625 ERROR nova.rpc [-] Returning exception Timeout migrating for i-00000030(instance-00000030) to caller\n2011-03-31 15:43:05,626 ERROR nova.rpc [-] ['Traceback (most recent call last):\\n', '  File \"/home/tpatil/nova/nova/rpc.py\", line 190, in _receive\\n    rval = node_func(context=ctxt, **node_args)\\n', '  File \"/home/tpatil/nova/nova/compute/manager.py\", line 908, in pre_live_migration\\n    self.driver.ensure_filtering_rules_for_instance(instance_ref)\\n', '  File \"/home/tpatil/nova/nova/virt/libvirt_conn.py\", line 1414, in ensure_filtering_rules_for_instance\\n    raise exception.Error(msg % locals())\\n', 'Error: Timeout migrating for i-00000030(instance-00000030)\\n']\n\n4) Also I could see following console messages on the destination host (on the terminal running nova-compute service)\nlibvir: Network Filter error : Network filter not found: no nwfilter with matching name 'nova-instance-instance-00000030'\nlibvir: Network Filter error : Network filter not found: no nwfilter with matching name 'nova-instance-instance-00000030'\nlibvir: Network Filter error : Network filter not found: no nwfilter with matching name 'nova-instance-instance-00000030'\nlibvir: Network Filter error : Network filter not found: no nwfilter with matching name 'nova-instance-instance-00000030'\nlibvir: Network Filter error : Network filter not found: no nwfilter with matching name 'nova-instance-instance-00000030'", 
    "tags": [], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/746821", 
    "owner": "https://api.launchpad.net/1.0/~masumotok", 
    "id": 746821, 
    "index": 388, 
    "openned": "2011-03-31 22:52:58.901868+00:00", 
    "created": "2011-03-31 22:52:58.901868+00:00", 
    "title": "live_migration failing due to network filter not found", 
    "comments": [
        {
            "content": "Steps to reproduce:-\n\nnova.conf settings\nuse_cow_images=False\n\n1) First I created one instance which is running on host ubuntu-openstack-compute-02\n$root@ubuntu-openstack-network-api-server:/home/tpatil# euca-describe-instances\nRESERVATION     r-z0ks6nqu      admin   default\nINSTANCE        i-00000030      ami-0000000b    10.0.0.5        10.0.0.5        running flat (admin, ubuntu-openstack-compute-02)       0               m1.tiny 2011-03-31T22:33:25Z  nova\n\n2) Migrate instance running on ubuntu-openstack-compute-02 to another host ubuntu-openstack-compute-01 using nova-manage command\n$nova/bin/nova-manage --flagfile=/etc/nova/nova.conf vm live_migration i-00000030  ubuntu-openstack-compute-01\nMigration of i-00000030 initiated.Check its progress using euca-describe-instances.\n\n3) Error in nova-compute.log on destination host.\n2011-03-31 15:42:34,081 DEBUG nova.rpc [-] received {'_msg_id': '1e11547d29734cdf8419a518268622b1', '_context_read_deleted': False, '_context_request_id': 'VPPW4LMUT3B8XDVOO92Y', '_context_timestamp': '2011-03-31T22:42:05Z', '_context_is_admin': True, '_context_user': None, 'method': 'create_shared_storage_test_file', '_context_project': None, '_context_remote_address': None} from (pid=12463) _receive /home/tpatil/nova/nova/rpc.py:169\n2011-03-31 15:42:34,082 DEBUG nova.rpc [-] unpacked context: {'timestamp': '2011-03-31T22:42:05Z', 'remote_address': None, 'project': None, 'is_admin': True, 'user': None, 'request_id': 'VPPW4LMUT3B8XDVOO92Y', 'read_deleted': False} from (pid=12463) _unpack_context /home/tpatil/nova/nova/rpc.py:333\n2011-03-31 15:42:34,206 DEBUG nova.compute.manager [-] Creating tmpfile /nova/instances/tmp2FvNq8 to notify to other compute nodes that they should mount the same storage. from (pid=12463) create_shared_storage_test_file /home/tpatil/nova/nova/compute/manager.py:812\n2011-03-31 15:42:34,814 DEBUG nova.rpc [-] received {'_msg_id': '0664ca60960a4882841a5b2eb313cf33', '_context_read_deleted': False, '_context_request_id': 'VPPW4LMUT3B8XDVOO92Y', 'args': {'filename': 'tmp2FvNq8'}, '_context_is_admin': True, '_context_timestamp': '2011-03-31T22:42:05Z', '_context_user': None, 'method': 'cleanup_shared_storage_test_file', '_context_project': None, '_context_remote_address': None} from (pid=12463) _receive /home/tpatil/nova/nova/rpc.py:169\n2011-03-31 15:42:34,815 DEBUG nova.rpc [-] unpacked context: {'timestamp': '2011-03-31T22:42:05Z', 'remote_address': None, 'project': None, 'is_admin': True, 'user': None, 'request_id': 'VPPW4LMUT3B8XDVOO92Y', 'read_deleted': False} from (pid=12463) _unpack_context /home/tpatil/nova/nova/rpc.py:333\n2011-03-31 15:42:35,118 DEBUG nova.rpc [-] received {'_msg_id': 'eb6b2604e0634b18b2f12b8b1477cf64', '_context_read_deleted': False, '_context_request_id': 'VPPW4LMUT3B8XDVOO92Y', 'args': {'cpu_info': '{\"vendor\": \"Intel\", \"model\": \"Nehalem\", \"arch\": \"x86_64\", \"features\": [\"rdtscp\", \"xtpr\", \"tm2\", \"est\", \"vmx\", \"ds_cpl\", \"monitor\", \"pbe\", \"tm\", \"ht\", \"ss\", \"acpi\", \"ds\", \"vme\"], \"topology\": {\"cores\": \"4\", \"threads\": \"2\", \"sockets\": \"1\"}}'}, '_context_is_admin': True, '_context_timestamp': '2011-03-31T22:42:05Z', '_context_user': None, 'method': 'compare_cpu', '_context_project': None, '_context_remote_address': None} from (pid=12463) _receive /home/tpatil/nova/nova/rpc.py:169\n2011-03-31 15:42:35,118 DEBUG nova.rpc [-] unpacked context: {'timestamp': '2011-03-31T22:42:05Z', 'remote_address': None, 'project': None, 'is_admin': True, 'user': None, 'request_id': 'VPPW4LMUT3B8XDVOO92Y', 'read_deleted': False} from (pid=12463) _unpack_context /home/tpatil/nova/nova/rpc.py:333\n2011-03-31 15:42:35,119 INFO nova.virt.libvirt_conn [-] Instance launched has CPU info:\n{\"vendor\": \"Intel\", \"model\": \"Nehalem\", \"arch\": \"x86_64\", \"features\": [\"rdtscp\", \"xtpr\", \"tm2\", \"est\", \"vmx\", \"ds_cpl\", \"monitor\", \"pbe\", \"tm\", \"ht\", \"ss\", \"acpi\", \"ds\", \"vme\"], \"topology\": {\"cores\": \"4\", \"threads\": \"2\", \"sockets\": \"1\"}}\n2011-03-31 15:42:35,148 INFO nova.virt.libvirt_conn [-] to xml...\n:<cpu>\n    <arch>x86_64</arch>\n    <model>Nehalem</model>\n    <vendor>Intel</vendor>\n    <topology sockets=\"1\" cores=\"4\" threads=\"2\"/>\n    <features name=\"rdtscp\" />\n    <features name=\"xtpr\" />\n    <features name=\"tm2\" />\n    <features name=\"est\" />\n    <features name=\"vmx\" />\n    <features name=\"ds_cpl\" />\n    <features name=\"monitor\" />\n    <features name=\"pbe\" />\n    <features name=\"tm\" />\n    <features name=\"ht\" />\n    <features name=\"ss\" />\n    <features name=\"acpi\" />\n    <features name=\"ds\" />\n    <features name=\"vme\" />\n</cpu>\n\n2011-03-31 15:42:35,730 DEBUG nova.rpc [-] received {'_msg_id': 'b6fca21f60c34221aa3491702fe13253', '_context_read_deleted': False, '_context_request_id': 'VPPW4LMUT3B8XDVOO92Y', 'args': {'instance_id': 48}, '_context_is_admin': True, '_context_timestamp': '2011-03-31T22:42:05Z', '_context_user': None, 'method': 'pre_live_migration', '_context_project': None, '_context_remote_address': None} from (pid=12463) _receive /home/tpatil/nova/nova/rpc.py:169\n2011-03-31 15:42:35,730 DEBUG nova.rpc [-] unpacked context: {'timestamp': '2011-03-31T22:42:05Z', 'remote_address': None, 'project': None, 'is_admin': True, 'user': None, 'request_id': 'VPPW4LMUT3B8XDVOO92Y', 'read_deleted': False} from (pid=12463) _unpack_context /home/tpatil/nova/nova/rpc.py:333\n2011-03-31 15:42:35,891 INFO nova.compute.manager [-] i-00000030 has no volume.\n2011-03-31 15:42:35,919 DEBUG nova.utils [-] Running cmd (subprocess): ip link show dev vlan100 from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:35,926 DEBUG nova.utils [-] Running cmd (subprocess): ip link show dev br100 from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:35,933 DEBUG nova.utils [-] Running cmd (subprocess): sudo route -n from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:35,944 DEBUG nova.utils [-] Running cmd (subprocess): sudo ip addr show dev vlan100 scope global from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:35,954 DEBUG nova.utils [-] Running cmd (subprocess): sudo brctl addif br100 vlan100 from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:35,963 DEBUG nova.utils [-] Result was 1 from (pid=12463) execute /home/tpatil/nova/nova/utils.py:166\n2011-03-31 15:42:36,004 INFO nova [-] called setup_basic_filtering in nwfilter\n2011-03-31 15:42:36,005 INFO nova [-] ensuring static filters\n2011-03-31 15:42:36,225 INFO nova [-] <nova.db.sqlalchemy.models.SecurityGroupIngressRule object at 0x44e64d0>\n2011-03-31 15:42:36,225 INFO nova [-] <nova.db.sqlalchemy.models.SecurityGroupIngressRule object at 0x44e6850>\n2011-03-31 15:42:36,247 DEBUG nova.utils [-] Attempting to grab semaphore \"iptables\" for method \"apply\"... from (pid=12463) inner /home/tpatil/nova/nova/utils.py:594\n2011-03-31 15:42:36,247 DEBUG nova.utils [-] Attempting to grab file lock \"iptables\" for method \"apply\"... from (pid=12463) inner /home/tpatil/nova/nova/utils.py:599\n2011-03-31 15:42:36,269 DEBUG nova.utils [-] Running cmd (subprocess): sudo iptables-save -t filter from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:36,281 DEBUG nova.utils [-] Running cmd (subprocess): sudo iptables-restore from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:36,301 DEBUG nova.utils [-] Running cmd (subprocess): sudo iptables-save -t nat from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:36,312 DEBUG nova.utils [-] Running cmd (subprocess): sudo iptables-restore from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:36,323 DEBUG nova.utils [-] Running cmd (subprocess): sudo ip6tables-save -t filter from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:42:36,335 DEBUG nova.utils [-] Running cmd (subprocess): sudo ip6tables-restore from (pid=12463) execute /home/tpatil/nova/nova/utils.py:150\n2011-03-31 15:43:05,624 ERROR nova [-] Exception during message handling\n(nova): TRACE: Traceback (most recent call last):\n(nova): TRACE:   File \"/home/tpatil/nova/nova/rpc.py\", line 190, in _receive\n(nova): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova): TRACE:   File \"/home/tpatil/nova/nova/compute/manager.py\", line 908, in pre_live_migration\n(nova): TRACE:     self.driver.ensure_filtering_rules_for_instance(instance_ref)\n(nova): TRACE:   File \"/home/tpatil/nova/nova/virt/libvirt_conn.py\", line 1414, in ensure_filtering_rules_for_instance\n(nova): TRACE:     raise exception.Error(msg % locals())\n(nova): TRACE: Error: Timeout migrating for i-00000030(instance-00000030)\n(nova): TRACE:\n2011-03-31 15:43:05,625 ERROR nova.rpc [-] Returning exception Timeout migrating for i-00000030(instance-00000030) to caller\n2011-03-31 15:43:05,626 ERROR nova.rpc [-] ['Traceback (most recent call last):\\n', '  File \"/home/tpatil/nova/nova/rpc.py\", line 190, in _receive\\n    rval = node_func(context=ctxt, **node_args)\\n', '  File \"/home/tpatil/nova/nova/compute/manager.py\", line 908, in pre_live_migration\\n    self.driver.ensure_filtering_rules_for_instance(instance_ref)\\n', '  File \"/home/tpatil/nova/nova/virt/libvirt_conn.py\", line 1414, in ensure_filtering_rules_for_instance\\n    raise exception.Error(msg % locals())\\n', 'Error: Timeout migrating for i-00000030(instance-00000030)\\n']\n\n4) Also I could see following console messages on the destination host (on the terminal running nova-compute service)\nlibvir: Network Filter error : Network filter not found: no nwfilter with matching name 'nova-instance-instance-00000030'\nlibvir: Network Filter error : Network filter not found: no nwfilter with matching name 'nova-instance-instance-00000030'\nlibvir: Network Filter error : Network filter not found: no nwfilter with matching name 'nova-instance-instance-00000030'\nlibvir: Network Filter error : Network filter not found: no nwfilter with matching name 'nova-instance-instance-00000030'\nlibvir: Network Filter error : Network filter not found: no nwfilter with matching name 'nova-instance-instance-00000030'", 
            "date_created": "2011-03-31 22:52:58.901868+00:00", 
            "author": "https://api.launchpad.net/1.0/~tpatil"
        }, 
        {
            "content": "I am getting this problem in revision No 925.", 
            "date_created": "2011-03-31 22:59:09.093442+00:00", 
            "author": "https://api.launchpad.net/1.0/~tpatil"
        }, 
        {
            "content": "hold on. I'm reproducing...", 
            "date_created": "2011-04-01 06:12:00.044242+00:00", 
            "author": "https://api.launchpad.net/1.0/~masumotok"
        }, 
        {
            "content": "The case an instance has only one NIC, this bug never occurs. According to error log, live migration should follow multi-NIC changes.", 
            "date_created": "2011-04-01 12:51:48.352536+00:00", 
            "author": "https://api.launchpad.net/1.0/~masumotok"
        }, 
        {
            "content": "I can reprodule this issue. Here is a detail explanatioin.\n\nThe procedures of live-migration is, \n1. destination compute node prepares volumes/secgrp/etc config for coming instances\n2. src compute node migrates instance to destination compute node.\n3. src compute node updates db records.\n\nRegarding to 1 above, destination compute node creates nwfilter-instance-instance-<id> through libvirt.\nBut because of multinic changes, nwfilter-instance-instance-<id>-<nic> is necessary, so some changes at nova.virt.libvirtConnection are necessary.\n\nDetail changes are shown at lp:~nttdata/nova/lp746821", 
            "date_created": "2011-04-05 10:46:46.925446+00:00", 
            "author": "https://api.launchpad.net/1.0/~masumotok"
        }
    ], 
    "closed": "2011-04-15 08:35:20.166207+00:00"
}