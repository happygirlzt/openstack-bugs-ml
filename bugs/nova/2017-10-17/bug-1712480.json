{
    "status": "Confirmed", 
    "last_updated": "2017-08-23 10:04:41.988273+00:00", 
    "description": "Description\n===========\nI use \"nova resize\" command to resize the vm ,but I don't call \"nova resize-confirm\" ,then I use \"nova delete\" command to soft-delete the vm ,it reports ERROR as this:\nUnexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'UnexpectedTaskStateError_Remote'> (HTTP 500) (Request-ID: req-2ee1cacd-78d8-4a9d-b975-dec7d31c8033)\nERROR (CommandError): Unable to delete the specified server(s).\n\n\nSteps to reproduce\n==================\n1)I config nova.conf, make reclaim_instance_interval equal to 60 to enable \"soft-delete\",\n  then restart openstack-nova-api service, restart openstack-nova-compute service.\n1)resize vm1 by \"nova resize\" command line\n2)delete vm1 by \"nova delete\" command line\n\n\nEnvironment\n===========\nThe branch of OpenStack that I use is \"mitaka\"\n\n\nExpected result\n===============\nThe vm is deleted\n\n\nActual result\n=============\nThe vm is not deleted ,and report ERROR.\n\n\nLogs & Configs\n==============\nnova.conf:\n reclaim_instance_interval = 60\n\nnova-api.log:\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions [req-2ee1cacd-78d8-4a9d-b975-dec7d31c8033 fbc7acf5e66e4a2289f419d257ffba84 95579f6a417e41ca8e8a74fdd8b23b14 - - -] Unexpected exception in API method\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/extensions.py\", line 478, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/compute/servers.py\", line 959, in delete\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/compute/servers.py\", line 809, in _delete\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 170, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 159, in inner\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 187, in _wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 140, in inner\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1928, in soft_delete\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1708, in _delete\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     self.force_reraise()\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1661, in _delete\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1757, in _confirm_resize_on_deleting\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/rpcapi.py\", line 500, in confirm_resize\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 158, in call\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     retry=self.retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     timeout=timeout, retry=retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 470, in send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     retry=retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 461, in _send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     raise result\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions UnexpectedTaskStateError_Remote: Conflict updating instance 282905b9-e342-4a1f-8b13-90750552d8de. Expected: {'task_state': [None, u'deleting']}. Actual: {'task_state': u'soft-deleting'}\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/conductor/manager.py\", line 90, in _object_dispatch\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_versionedobjects/base.py\", line 223, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return fn(self, *args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/objects/instance.py\", line 701, in save\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/api.py\", line 809, in instance_update_and_get_original\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 229, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_db/api.py\", line 148, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     ectxt.value = e.inner_exc\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     self.force_reraise()\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_db/api.py\", line 138, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 300, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 2717, in instance_update_and_get_original\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 2853, in _instance_update\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions UnexpectedTaskStateError: Conflict updating instance 282905b9-e342-4a1f-8b13-90750552d8de. Expected: {'task_state': [None, u'deleting']}. Actual: {'task_state': u'soft-deleting'}\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 138, in _dispatch_and_reply\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     incoming.message))\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 185, in _dispatch\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return self._do_dispatch(endpoint, method, ctxt, args)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 127, in _do_dispatch\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     result = func(ctxt, **new_args)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 110, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     self.force_reraise()\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 89, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 414, in decorated_function\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return function(self, context, *args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 392, in decorated_function\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     kwargs['instance'], e, sys.exc_info())\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     self.force_reraise()\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 380, in decorated_function\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return function(self, context, *args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3529, in confirm_resize\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     do_confirm_resize(context, instance, migration.id)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_concurrency/lockutils.py\", line 271, in inner\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3527, in do_confirm_resize\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     migration=migration)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3581, in _confirm_resize\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     instance.save(expected_task_state=[None, task_states.DELETING])\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_versionedobjects/base.py\", line 207, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     ctxt, self, fn.__name__, args, kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/conductor/rpcapi.py\", line 245, in object_action\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 158, in call\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     retry=self.retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     timeout=timeout, retry=retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 470, in send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     retry=retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 461, in _send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     raise result\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions UnexpectedTaskStateError_Remote: Conflict updating instance 282905b9-e342-4a1f-8b13-90750552d8de. Expected: {'task_state': [None, u'deleting']}. Actual: {'task_state': u'soft-deleting'}\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/conductor/manager.py\", line 90, in _object_dispatch\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_versionedobjects/base.py\", line 223, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return fn(self, *args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/objects/instance.py\", line 701, in save\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/api.py\", line 809, in instance_update_and_get_original\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 229, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_db/api.py\", line 148, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     ectxt.value = e.inner_exc\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     self.force_reraise()\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_db/api.py\", line 138, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 300, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 2717, in instance_update_and_get_original\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 2853, in _instance_update\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions UnexpectedTaskStateError: Conflict updating instance 282905b9-e342-4a1f-8b13-90750552d8de. Expected: {'task_state': [None, u'deleting']}. Actual: {'task_state': u'soft-deleting'}\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1712480", 
    "owner": "https://api.launchpad.net/1.0/~dinesh-bhor", 
    "id": 1712480, 
    "index": 8265, 
    "openned": "2017-08-23 06:49:18.700679+00:00", 
    "created": "2017-08-23 06:49:18.700679+00:00", 
    "title": "Soft-deleting vm fails after 'nova resize'  the vm", 
    "comments": [
        {
            "content": "Description\n===========\nI use \"nova resize\" command to resize the vm ,but I don't call \"nova resize-confirm\" ,then I use \"nova delete\" command to soft-delete the vm ,it reports ERROR as this:\nUnexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'UnexpectedTaskStateError_Remote'> (HTTP 500) (Request-ID: req-2ee1cacd-78d8-4a9d-b975-dec7d31c8033)\nERROR (CommandError): Unable to delete the specified server(s).\n\n\nSteps to reproduce\n==================\n1)I config nova.conf, make reclaim_instance_interval equal to 60 to enable \"soft-delete\",\n  then restart openstack-nova-api service, restart openstack-nova-compute service.\n1)resize vm1 by \"nova resize\" command line\n2)delete vm1 by \"nova delete\" command line\n\n\nEnvironment\n===========\nThe branch of OpenStack that I use is \"mitaka\"\n\n\nExpected result\n===============\nThe vm is deleted\n\n\nActual result\n=============\nThe vm is not deleted ,and report ERROR.\n\n\nLogs & Configs\n==============\nnova.conf:\n reclaim_instance_interval = 60\n\nnova-api.log:\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions [req-2ee1cacd-78d8-4a9d-b975-dec7d31c8033 fbc7acf5e66e4a2289f419d257ffba84 95579f6a417e41ca8e8a74fdd8b23b14 - - -] Unexpected exception in API method\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/extensions.py\", line 478, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/compute/servers.py\", line 959, in delete\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/compute/servers.py\", line 809, in _delete\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 170, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 159, in inner\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 187, in _wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 140, in inner\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1928, in soft_delete\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1708, in _delete\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     self.force_reraise()\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1661, in _delete\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1757, in _confirm_resize_on_deleting\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/rpcapi.py\", line 500, in confirm_resize\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 158, in call\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     retry=self.retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     timeout=timeout, retry=retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 470, in send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     retry=retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 461, in _send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     raise result\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions UnexpectedTaskStateError_Remote: Conflict updating instance 282905b9-e342-4a1f-8b13-90750552d8de. Expected: {'task_state': [None, u'deleting']}. Actual: {'task_state': u'soft-deleting'}\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/conductor/manager.py\", line 90, in _object_dispatch\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_versionedobjects/base.py\", line 223, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return fn(self, *args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/objects/instance.py\", line 701, in save\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/api.py\", line 809, in instance_update_and_get_original\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 229, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_db/api.py\", line 148, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     ectxt.value = e.inner_exc\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     self.force_reraise()\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_db/api.py\", line 138, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 300, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 2717, in instance_update_and_get_original\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 2853, in _instance_update\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions UnexpectedTaskStateError: Conflict updating instance 282905b9-e342-4a1f-8b13-90750552d8de. Expected: {'task_state': [None, u'deleting']}. Actual: {'task_state': u'soft-deleting'}\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 138, in _dispatch_and_reply\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     incoming.message))\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 185, in _dispatch\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return self._do_dispatch(endpoint, method, ctxt, args)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 127, in _do_dispatch\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     result = func(ctxt, **new_args)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 110, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     self.force_reraise()\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 89, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 414, in decorated_function\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return function(self, context, *args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 392, in decorated_function\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     kwargs['instance'], e, sys.exc_info())\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     self.force_reraise()\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 380, in decorated_function\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return function(self, context, *args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3529, in confirm_resize\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     do_confirm_resize(context, instance, migration.id)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_concurrency/lockutils.py\", line 271, in inner\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3527, in do_confirm_resize\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     migration=migration)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3581, in _confirm_resize\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     instance.save(expected_task_state=[None, task_states.DELETING])\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_versionedobjects/base.py\", line 207, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     ctxt, self, fn.__name__, args, kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/conductor/rpcapi.py\", line 245, in object_action\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/client.py\", line 158, in call\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     retry=self.retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/transport.py\", line 90, in _send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     timeout=timeout, retry=retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 470, in send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     retry=retry)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_messaging/_drivers/amqpdriver.py\", line 461, in _send\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     raise result\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions UnexpectedTaskStateError_Remote: Conflict updating instance 282905b9-e342-4a1f-8b13-90750552d8de. Expected: {'task_state': [None, u'deleting']}. Actual: {'task_state': u'soft-deleting'}\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/conductor/manager.py\", line 90, in _object_dispatch\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_versionedobjects/base.py\", line 223, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return fn(self, *args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/objects/instance.py\", line 701, in save\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/api.py\", line 809, in instance_update_and_get_original\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 229, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_db/api.py\", line 148, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     ectxt.value = e.inner_exc\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     self.force_reraise()\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/oslo_db/api.py\", line 138, in wrapper\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 300, in wrapped\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 2717, in instance_update_and_get_original\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 2853, in _instance_update\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions UnexpectedTaskStateError: Conflict updating instance 282905b9-e342-4a1f-8b13-90750552d8de. Expected: {'task_state': [None, u'deleting']}. Actual: {'task_state': u'soft-deleting'}\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions\n2017-08-23 10:45:38.233 1458420 ERROR nova.api.openstack.extensions", 
            "date_created": "2017-08-23 06:49:18.700679+00:00", 
            "author": "https://api.launchpad.net/1.0/~better"
        }, 
        {
            "content": "Hi, \n\nI am able to reproduce this issue on current master as well.\n\nNova master:\ncommit f28da08a1b26b789f3520672facff9e7e25aa60b\nMerge: 6824847 5477259\nAuthor: Jenkins <email address hidden>\nDate:   Thu Aug 17 04:55:56 2017 +0000\n\n    Merge \"Fix contributor documentation\"\n\n", 
            "date_created": "2017-08-23 10:04:41.580527+00:00", 
            "author": "https://api.launchpad.net/1.0/~dinesh-bhor"
        }
    ]
}