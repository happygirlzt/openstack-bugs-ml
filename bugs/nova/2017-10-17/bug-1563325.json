{
    "status": "Fix Released", 
    "last_updated": "2016-12-19 12:02:04.344774+00:00", 
    "description": "When I do a hard reboot of in vmware instances which do not have vmware tools , I get following error\n\n2016-03-29 21:11:02.463 8893 ERROR oslo_messaging.rpc.dispatcher [req-181921d8-7253-4bfc-b613-6fbae41824b4 4412e38ec9814b96a03e63097ec51f1a 8f75187cd29f4715881f450646fc6e08 - - -] Exception during message handling: 'summary.guest.toolsStatus'\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     executor_callback))\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     executor_callback)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 6751, in reboot_instance\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     reboot_type)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     payload)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 327, in decorated_function\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     LOG.warning(msg, e, instance_uuid=instance_uuid)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 298, in decorated_function\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 377, in decorated_function\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 355, in decorated_function\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 343, in decorated_function\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3211, in reboot_instance\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     self._set_instance_obj_error_state(context, instance)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3192, in reboot_instance\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     bad_volumes_callback=bad_volumes_callback)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/vmwareapi/driver.py\", line 512, in reboot\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     self._vmops.reboot(instance, network_info, reboot_type)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/vmwareapi/vmops.py\", line 894, in reboot\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     tools_status = query['summary.guest.toolsStatus']\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher KeyError: 'summary.guest.toolsStatus'\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher\n2016-03-29 21:11:02.472 8893 DEBUG oslo_vmware.api [-] Task: (returnval){", 
    "tags": [
        "low-hanging-fruit", 
        "vmware"
    ], 
    "importance": "Low", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1563325", 
    "owner": "https://api.launchpad.net/1.0/~siva-radhakrishnan", 
    "id": 1563325, 
    "index": 1980, 
    "openned": "2016-03-29 13:37:49.109215+00:00", 
    "created": "2016-03-29 13:37:49.109215+00:00", 
    "title": "KeyError: 'summary.guest.toolsStatus' in vmware driver", 
    "comments": [
        {
            "content": "When I do a hard reboot of in vmware instances which do not have vmware tools , I get following error\n\n2016-03-29 21:11:02.463 8893 ERROR oslo_messaging.rpc.dispatcher [req-181921d8-7253-4bfc-b613-6fbae41824b4 4412e38ec9814b96a03e63097ec51f1a 8f75187cd29f4715881f450646fc6e08 - - -] Exception during message handling: 'summary.guest.toolsStatus'\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     executor_callback))\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     executor_callback)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 6751, in reboot_instance\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     reboot_type)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     payload)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 327, in decorated_function\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     LOG.warning(msg, e, instance_uuid=instance_uuid)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 298, in decorated_function\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 377, in decorated_function\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 355, in decorated_function\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 343, in decorated_function\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3211, in reboot_instance\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     self._set_instance_obj_error_state(context, instance)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 3192, in reboot_instance\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     bad_volumes_callback=bad_volumes_callback)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/vmwareapi/driver.py\", line 512, in reboot\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     self._vmops.reboot(instance, network_info, reboot_type)\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/vmwareapi/vmops.py\", line 894, in reboot\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher     tools_status = query['summary.guest.toolsStatus']\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher KeyError: 'summary.guest.toolsStatus'\n2016-03-29 21:11:02.463 8893 TRACE oslo_messaging.rpc.dispatcher\n2016-03-29 21:11:02.472 8893 DEBUG oslo_vmware.api [-] Task: (returnval){", 
            "date_created": "2016-03-29 13:37:49.109215+00:00", 
            "author": "https://api.launchpad.net/1.0/~luogangyi"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/298793", 
            "date_created": "2016-03-29 14:44:56.261165+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/359424", 
            "date_created": "2016-08-23 21:00:09.201360+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Michael Still (<email address hidden>) on branch: master\nReview: https://review.openstack.org/298793\nReason: This patch has been sitting unchanged for more than 12 weeks. I am therefore going to abandon it to keep the nova review queue sane. Please feel free to restore the change if you're still working on it.", 
            "date_created": "2016-10-25 16:14:57.430998+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/359424\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=d3c7396d87681b82327c59c27fe14cf5e20c3ba5\nSubmitter: Jenkins\nBranch:    master\n\ncommit d3c7396d87681b82327c59c27fe14cf5e20c3ba5\nAuthor: Sivasathurappan Radhakrishnan <email address hidden>\nDate:   Tue Aug 23 20:47:06 2016 +0000\n\n    Using get() method to prevent KeyError\n    \n    Using get() to access keys like \"summary.guest.toolsStatus\" and\n    \"summary.guest.toolrunningStatus\" to avoid exception during hard reboot.\n    This change would use a default values even if they don't exist in dict\n    as we can have VMs where VM tools wouldn't be installed/running which leads\n    to hard reboot\n    \n    Change-Id: I332867fe783d6d47b81d8a53153af140d4158217\n    Closes-bug: #1563325\n", 
            "date_created": "2016-11-26 10:19:49.381859+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/newton\nReview: https://review.openstack.org/404658", 
            "date_created": "2016-11-30 09:06:21.728635+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/404658\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=e0f021f187758268e2bd732f63cf88fbf703320c\nSubmitter: Jenkins\nBranch:    stable/newton\n\ncommit e0f021f187758268e2bd732f63cf88fbf703320c\nAuthor: Sivasathurappan Radhakrishnan <email address hidden>\nDate:   Tue Aug 23 20:47:06 2016 +0000\n\n    Using get() method to prevent KeyError\n    \n    Using get() to access keys like \"summary.guest.toolsStatus\" and\n    \"summary.guest.toolrunningStatus\" to avoid exception during hard reboot.\n    This change would use a default values even if they don't exist in dict\n    as we can have VMs where VM tools wouldn't be installed/running which leads\n    to hard reboot\n    \n    Change-Id: I332867fe783d6d47b81d8a53153af140d4158217\n    Closes-bug: #1563325\n    (cherry picked from commit d3c7396d87681b82327c59c27fe14cf5e20c3ba5)\n", 
            "date_created": "2016-12-09 18:24:21.480675+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 15.0.0.0b2 development milestone.", 
            "date_created": "2016-12-15 17:36:04.068327+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.3 release.", 
            "date_created": "2016-12-19 12:02:02.780670+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2016-11-26 10:19:46.699965+00:00"
}