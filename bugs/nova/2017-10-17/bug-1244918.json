{
    "status": "Fix Released", 
    "last_updated": "2014-10-07 09:03:52.859109+00:00", 
    "description": "When trying to perform boot instance from volume using the VMwareESXDriver, the operation errors out.\n\nCommand:\n$ nova boot --flavor 1  --block-device-mapping vda=222e8ece-8723-4930-803c-8ae5cf233a87:::0 vm1\n\nLog messages\n\nd3-59fce43903e8] Root volume attach. Driver type: vmdk attach_root_volume /opt/stack/nova/nova/virt/vmwareapi/volumeops.py:458\n2013-10-26 14:49:13.393 30706 WARNING nova.virt.vmwareapi.driver [-] Task [RelocateVM_Task] (returnval){\n   value = \"haTask-162-vim.VirtualMachine.relocate-327302855\"\n   _type = \"Task\"\n } status: error The operation is not supported on the object.\n2013-10-26 14:49:13.394 30706 ERROR nova.compute.manager [req-e95b7262-a70c-436b-a9d5-0b8045cbf3f5 4471d6567a6b4dd29affbc849f3814d9 256df8ea370d4de2b40edfe9b0ea4063] [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8] Instance failed to spawn\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8] Traceback (most recent call last):\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1410, in _spawn\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     block_device_info)\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 178, in spawn\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     admin_password, network_info, block_device_info)\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 538, in spawn\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     data_store_ref)\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 467, in attach_root_volume\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     self._relocate_vmdk_volume(volume_ref, res_pool, datastore)\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 295, in _relocate_vmdk_volume\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     self._session._wait_for_task(task.value, task)\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 901, in _wait_for_task\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     ret_val = done.wait()\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 116, in wait\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     return hubs.get_hub().switch()\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 187, in switch\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     return self.greenlet.switch()\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8] NovaException: The operation is not supported on the object.\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]", 
    "tags": [
        "drivers", 
        "icehouse-backport-potential", 
        "vmware", 
        "vmwareapi"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1244918", 
    "owner": "https://api.launchpad.net/1.0/~kartikaditya", 
    "id": 1244918, 
    "index": 3678, 
    "openned": "2013-10-26 10:36:40.923091+00:00", 
    "created": "2013-10-26 10:36:40.923091+00:00", 
    "title": "VMware ESX: Boot from volume errors out due to relocate", 
    "comments": [
        {
            "content": "When trying to perform boot instance from volume using the VMwareESXDriver, the operation errors out.\n\nCommand:\n$ nova boot --flavor 1  --block-device-mapping vda=222e8ece-8723-4930-803c-8ae5cf233a87:::0 vm1\n\nLog messages\n\nd3-59fce43903e8] Root volume attach. Driver type: vmdk attach_root_volume /opt/stack/nova/nova/virt/vmwareapi/volumeops.py:458\n2013-10-26 14:49:13.393 30706 WARNING nova.virt.vmwareapi.driver [-] Task [RelocateVM_Task] (returnval){\n   value = \"haTask-162-vim.VirtualMachine.relocate-327302855\"\n   _type = \"Task\"\n } status: error The operation is not supported on the object.\n2013-10-26 14:49:13.394 30706 ERROR nova.compute.manager [req-e95b7262-a70c-436b-a9d5-0b8045cbf3f5 4471d6567a6b4dd29affbc849f3814d9 256df8ea370d4de2b40edfe9b0ea4063] [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8] Instance failed to spawn\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8] Traceback (most recent call last):\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1410, in _spawn\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     block_device_info)\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 178, in spawn\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     admin_password, network_info, block_device_info)\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 538, in spawn\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     data_store_ref)\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 467, in attach_root_volume\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     self._relocate_vmdk_volume(volume_ref, res_pool, datastore)\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/virt/vmwareapi/volumeops.py\", line 295, in _relocate_vmdk_volume\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     self._session._wait_for_task(task.value, task)\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 901, in _wait_for_task\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     ret_val = done.wait()\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 116, in wait\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     return hubs.get_hub().switch()\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 187, in switch\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]     return self.greenlet.switch()\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8] NovaException: The operation is not supported on the object.\n2013-10-26 14:49:13.394 30706 TRACE nova.compute.manager [instance: 6b190d4d-231d-43ec-86d3-59fce43903e8]", 
            "date_created": "2013-10-26 10:36:40.923091+00:00", 
            "author": "https://api.launchpad.net/1.0/~kartikaditya"
        }, 
        {
            "content": "https://review.openstack.org/#/c/53990/", 
            "date_created": "2013-10-27 14:32:49.997551+00:00", 
            "author": "https://api.launchpad.net/1.0/~garyk"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/53990\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=34e14fbbb5293c52ef5dbfeb1172390f15d79e1f\nSubmitter: Jenkins\nBranch:    master\n\ncommit 34e14fbbb5293c52ef5dbfeb1172390f15d79e1f\nAuthor: Kartik Bommepally <email address hidden>\nDate:   Sat Oct 26 03:35:14 2013 -0700\n\n    VMware ESX: Boot from volume must not relocate vol\n    \n    ESX does not support relocate API. Moreover when working with ESX the boot\n    from volume logic need not perform relocation since the volume's datastore\n    is always visible to the ESX host.\n    \n    The fix is to ignore relocation when working with ESX.\n    \n    Change-Id: I227cf2ea5b6f681150ede0bf6257eb238f1452d2\n    Closes-bug: #1244918\n", 
            "date_created": "2014-03-14 15:56:22.841177+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2014-10-07 09:03:50.133108+00:00"
}