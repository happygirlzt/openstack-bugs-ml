{
    "status": "Fix Released", 
    "last_updated": "2012-04-05 10:34:10.679647+00:00", 
    "description": "Brand new virtual env:\n\n\n======================================================================\nERROR: test_walk_versions (nova.tests.test_migrations.TestMigrations)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/home/jkoelker/openstack/nova/nova/tests/test_migrations.py\", line 167, in test_walk_versions\n    self._walk_versions(engine, self.snake_walk)\n  File \"/home/jkoelker/openstack/nova/nova/tests/test_migrations.py\", line 179, in _walk_versions\n    TestMigrations.REPOSITORY))\n  File \"<string>\", line 2, in db_version\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/migrate/versioning/util/__init__.py\", line 159, in with_engine\n    return f(*a, **kw)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/migrate/versioning/api.py\", line 148, in db_version\n    schema = ControlledSchema(engine, repository)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/migrate/versioning/schema.py\", line 32, in __init__\n    self.load()\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/migrate/versioning/schema.py\", line 44, in load\n    self.table = Table(tname, self.meta, autoload=True)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/schema.py\", line 303, in __new__\n    table._init(name, metadata, *args, **kw)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/schema.py\", line 366, in _init\n    self._autoload(metadata, autoload_with, include_columns)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/schema.py\", line 390, in _autoload\n    self, include_columns, exclude_columns\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 2276, in run_callable\n    return conn.run_callable(callable_, *args, **kwargs)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1900, in run_callable\n    return callable_(self, *args, **kwargs)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/engine/default.py\", line 259, in reflecttable\n    return insp.reflecttable(table, include_columns, exclude_columns)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/engine/reflection.py\", line 412, in reflecttable\n    raise exc.NoSuchTableError(table.name)\nDatabaseNotControlledError: migrate_version", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/940407", 
    "owner": "https://api.launchpad.net/1.0/~jason-koelker", 
    "id": 940407, 
    "index": 3884, 
    "openned": "2012-02-24 16:04:17.661068+00:00", 
    "created": "2012-02-24 16:04:17.661068+00:00", 
    "title": "TestMigrations does not work with latest migrate and sqlaclhemy", 
    "comments": [
        {
            "content": "Brand new virtual env:\n\n\n======================================================================\nERROR: test_walk_versions (nova.tests.test_migrations.TestMigrations)\n----------------------------------------------------------------------\nTraceback (most recent call last):\n  File \"/home/jkoelker/openstack/nova/nova/tests/test_migrations.py\", line 167, in test_walk_versions\n    self._walk_versions(engine, self.snake_walk)\n  File \"/home/jkoelker/openstack/nova/nova/tests/test_migrations.py\", line 179, in _walk_versions\n    TestMigrations.REPOSITORY))\n  File \"<string>\", line 2, in db_version\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/migrate/versioning/util/__init__.py\", line 159, in with_engine\n    return f(*a, **kw)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/migrate/versioning/api.py\", line 148, in db_version\n    schema = ControlledSchema(engine, repository)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/migrate/versioning/schema.py\", line 32, in __init__\n    self.load()\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/migrate/versioning/schema.py\", line 44, in load\n    self.table = Table(tname, self.meta, autoload=True)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/schema.py\", line 303, in __new__\n    table._init(name, metadata, *args, **kw)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/schema.py\", line 366, in _init\n    self._autoload(metadata, autoload_with, include_columns)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/schema.py\", line 390, in _autoload\n    self, include_columns, exclude_columns\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 2276, in run_callable\n    return conn.run_callable(callable_, *args, **kwargs)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1900, in run_callable\n    return callable_(self, *args, **kwargs)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/engine/default.py\", line 259, in reflecttable\n    return insp.reflecttable(table, include_columns, exclude_columns)\n  File \"/home/jkoelker/.virtualenvs/nova/lib/python2.7/site-packages/sqlalchemy/engine/reflection.py\", line 412, in reflecttable\n    raise exc.NoSuchTableError(table.name)\nDatabaseNotControlledError: migrate_version", 
            "date_created": "2012-02-24 16:04:17.661068+00:00", 
            "author": "https://api.launchpad.net/1.0/~jason-koelker"
        }, 
        {
            "content": "It appears that its creating one sqlite memory db applying the version to it, and then testing a new sqlite memory db for version control.", 
            "date_created": "2012-02-24 16:08:19.660745+00:00", 
            "author": "https://api.launchpad.net/1.0/~jason-koelker"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/4511", 
            "date_created": "2012-02-24 16:46:05.584364+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/4511\nCommitted: http://github.com/openstack/nova/commit/a7df90089557516a82c0ba8f7368cdd541099059\nSubmitter: Jenkins\nBranch:    master\n\ncommit a7df90089557516a82c0ba8f7368cdd541099059\nAuthor: Jason K\u00f6lker <email address hidden>\nDate:   Fri Feb 24 10:10:21 2012 -0600\n\n    Monkey patch migrate < 0.7.3\n    \n    * Works around migrate issue 72 [1] by monkey patching migrate prior\n      to import.\n    * Removes previous workaround\n    * Refactor test config to work under nosetests directly\n    * Fixes LP940407\n    \n    1: https://code.google.com/p/sqlalchemy-migrate/issues/detail?id=72\n    \n    Change-Id: I219e4cecf8bb2e34ae238ac270428f496378ee61\n", 
            "date_created": "2012-02-25 04:08:05.376782+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2012-02-29 10:37:20.791047+00:00"
}