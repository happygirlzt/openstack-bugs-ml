{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:36:16.243617+00:00", 
    "description": "If the deploy helper has an error, the fact of the error, but not it's details are shown.\n\nI have a patch I'm going to push up in a minute.\n\nbefore:\n\n2013-05-10 10:00:58,114.114 13141 INFO nova.virt.baremetal.deploy_helper [-] start deployment for node 63, params {'swap_mb': 1, 'iqn': 'iqn-6f1501d7-786c-4b7d-88e2-81fc5ff91b5d', 'image_path': u'/var/lib/nova/instances/instance-000000ac/disk', 'address': '192.168.0.117', 'pxe_config_path': u'/tftpboot/6f1501d7-786c-4b7d-88e2-81fc5ff91b5d/config', 'port': '3260', 'lun': '1', 'root_mb': 10240}\n2013-05-10 10:00:58,200.200 13141 ERROR nova.virt.baremetal.deploy_helper [-] deployment to node 63 failed\n\n2013-05-10 10:16:25,015.015 3167 INFO nova.virt.baremetal.deploy_helper [req-7e80e861-5d27-42a3-801e-97ef26ffa90b None None] start deployment for node 63, params {'swap_mb': 1, 'iqn': 'iqn-99d3a2d9-9ce5-4eec-a095-cd374d54b6e3', 'image_path': u'/var/lib/nova/instances/instance-000000ad/disk', 'address': '192.168.0.117', 'pxe_config_path': u'/tftpboot/99d3a2d9-9ce5-4eec-a095-cd374d54b6e3/config', 'port': '3260', 'lun': '1', 'root_mb': 10240}\n2013-05-10 10:16:25,105.105 3167 ERROR nova.virt.baremetal.deploy_helper [req-7e80e861-5d27-42a3-801e-97ef26ffa90b None None] deployment to node 63 failed\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper Traceback (most recent call last):\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper   File \"/opt/stack/venvs/nova/local/lib/python2.7/site-packages/nova/cmd/baremetal_deploy_helper.py\", line 242, in run\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper     deploy(**params)\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper   File \"/opt/stack/venvs/nova/local/lib/python2.7/site-packages/nova/cmd/baremetal_deploy_helper.py\", line 200, in deploy\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper     discovery(address, port)\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper   File \"/opt/stack/venvs/nova/local/lib/python2.7/site-packages/nova/cmd/baremetal_deploy_helper.py\", line 56, in discovery\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper     check_exit_code=[0])\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper   File \"/opt/stack/venvs/nova/local/lib/python2.7/site-packages/nova/utils.py\", line 154, in execute\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper     return processutils.execute(*cmd, **kwargs)\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper   File \"/opt/stack/venvs/nova/local/lib/python2.7/site-packages/nova/openstack/common/processutils.py\", line 168, in execute\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper     cmd=' '.join(cmd))\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper ProcessExecutionError: Unexpected error while running command.\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper Command: sudo nova-rootwrap /etc/nova/rootwrap.conf iscsiadm -m discovery -t st -p 192.168.0.117:3260\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper Exit code: 1\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper Stdout: ''\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper Stderr: 'Traceback (most recent call last):\\n  File \"/usr/bin/nova-rootwrap\", line 89, in <module>\\n    env=filtermatch.get_environment(userargs))\\n  File \"/usr/lib/python2.7/subprocess.py\", line 679, in __init__\\n    errread, errwrite)\\n  File \"/usr/lib/python2.7/subprocess.py\", line 1259, in _execute_child\\n    raise child_exception\\nOSError: [Errno 2] No such file or directory\\n'\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper", 
    "tags": [
        "baremetal"
    ], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1178608", 
    "owner": "https://api.launchpad.net/1.0/~lifeless", 
    "id": 1178608, 
    "index": 1081, 
    "openned": "2013-05-10 10:20:27.238036+00:00", 
    "created": "2013-05-10 10:20:27.238036+00:00", 
    "title": "nova-baremetal-deploy-helper errors are opaque", 
    "comments": [
        {
            "content": "If the deploy helper has an error, the fact of the error, but not it's details are shown.\n\nI have a patch I'm going to push up in a minute.\n\nbefore:\n\n2013-05-10 10:00:58,114.114 13141 INFO nova.virt.baremetal.deploy_helper [-] start deployment for node 63, params {'swap_mb': 1, 'iqn': 'iqn-6f1501d7-786c-4b7d-88e2-81fc5ff91b5d', 'image_path': u'/var/lib/nova/instances/instance-000000ac/disk', 'address': '192.168.0.117', 'pxe_config_path': u'/tftpboot/6f1501d7-786c-4b7d-88e2-81fc5ff91b5d/config', 'port': '3260', 'lun': '1', 'root_mb': 10240}\n2013-05-10 10:00:58,200.200 13141 ERROR nova.virt.baremetal.deploy_helper [-] deployment to node 63 failed\n\n2013-05-10 10:16:25,015.015 3167 INFO nova.virt.baremetal.deploy_helper [req-7e80e861-5d27-42a3-801e-97ef26ffa90b None None] start deployment for node 63, params {'swap_mb': 1, 'iqn': 'iqn-99d3a2d9-9ce5-4eec-a095-cd374d54b6e3', 'image_path': u'/var/lib/nova/instances/instance-000000ad/disk', 'address': '192.168.0.117', 'pxe_config_path': u'/tftpboot/99d3a2d9-9ce5-4eec-a095-cd374d54b6e3/config', 'port': '3260', 'lun': '1', 'root_mb': 10240}\n2013-05-10 10:16:25,105.105 3167 ERROR nova.virt.baremetal.deploy_helper [req-7e80e861-5d27-42a3-801e-97ef26ffa90b None None] deployment to node 63 failed\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper Traceback (most recent call last):\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper   File \"/opt/stack/venvs/nova/local/lib/python2.7/site-packages/nova/cmd/baremetal_deploy_helper.py\", line 242, in run\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper     deploy(**params)\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper   File \"/opt/stack/venvs/nova/local/lib/python2.7/site-packages/nova/cmd/baremetal_deploy_helper.py\", line 200, in deploy\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper     discovery(address, port)\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper   File \"/opt/stack/venvs/nova/local/lib/python2.7/site-packages/nova/cmd/baremetal_deploy_helper.py\", line 56, in discovery\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper     check_exit_code=[0])\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper   File \"/opt/stack/venvs/nova/local/lib/python2.7/site-packages/nova/utils.py\", line 154, in execute\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper     return processutils.execute(*cmd, **kwargs)\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper   File \"/opt/stack/venvs/nova/local/lib/python2.7/site-packages/nova/openstack/common/processutils.py\", line 168, in execute\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper     cmd=' '.join(cmd))\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper ProcessExecutionError: Unexpected error while running command.\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper Command: sudo nova-rootwrap /etc/nova/rootwrap.conf iscsiadm -m discovery -t st -p 192.168.0.117:3260\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper Exit code: 1\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper Stdout: ''\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper Stderr: 'Traceback (most recent call last):\\n  File \"/usr/bin/nova-rootwrap\", line 89, in <module>\\n    env=filtermatch.get_environment(userargs))\\n  File \"/usr/lib/python2.7/subprocess.py\", line 679, in __init__\\n    errread, errwrite)\\n  File \"/usr/lib/python2.7/subprocess.py\", line 1259, in _execute_child\\n    raise child_exception\\nOSError: [Errno 2] No such file or directory\\n'\n2013-05-10 10:16:25,105.105 3167 TRACE nova.virt.baremetal.deploy_helper", 
            "date_created": "2013-05-10 10:20:27.238036+00:00", 
            "author": "https://api.launchpad.net/1.0/~lifeless"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/28782", 
            "date_created": "2013-05-10 10:37:35.600771+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/28782\nCommitted: http://github.com/openstack/nova/commit/2edbad643b252ef991907c915cba319d37aa93f2\nSubmitter: Jenkins\nBranch:    master\n\ncommit 2edbad643b252ef991907c915cba319d37aa93f2\nAuthor: Robert Collins <email address hidden>\nDate:   Fri May 10 22:33:13 2013 +1200\n\n    Show exception details for failed deploys.\n    \n    Without some detail errors are inscrutable and impossible to debug.\n    \n    Fixes bug 1178608\n    \n    Change-Id: I0ed6164e8689c63bd194924d3f7cb50b49feb921\n", 
            "date_created": "2013-05-10 21:53:41.748895+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-05-29 10:18:01.918531+00:00"
}