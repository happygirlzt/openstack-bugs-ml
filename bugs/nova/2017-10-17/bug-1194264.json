{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:47:23.584453+00:00", 
    "description": "Using the latest Nova Havana code today (git commit d4c7e88c or later)...\n\nI'm now seeing resize_confirm API requests fail with Torpedo when running XenServer 6.1 in SmokeStack.\n\nThe following error message is displayed in Nova's compute.log file:\n\n==> /var/log/nova/compute.log <==\n2013-06-24 20:15:02.240 10813 WARNING nova.compute.manager [req-d8b83c39-614f-4861-9b2a-0d7ecadf1c77 None None] Found 0 in the database and 2 on the hypervisor.\n2013-06-24 20:19:57.975 10813 WARNING nova.virt.xenapi.vm_utils [req-c58a796c-e6f8-4653-97ff-62f5340c74ca 62f8c747c81144209ca48df81a651964 1f41ab1eabef47f193a5b468001b55f3] [instance: b82e6f76-c34a-41df-a1a0-c39665a27f56] VM already halted, skipping shutdown...\n2013-06-24 20:19:57.977 10813 ERROR nova.compute.manager [req-c58a796c-e6f8-4653-97ff-62f5340c74ca 62f8c747c81144209ca48df81a651964 1f41ab1eabef47f193a5b468001b55f3] [instance: b82e6f76-c34a-41df-a1a0-c39665a27f56] XenAPI failed to power the instance off. Setting instance vm_state to ERROR\n2013-06-24 20:19:58.685 10813 ERROR nova.openstack.common.rpc.amqp [req-c58a796c-e6f8-4653-97ff-62f5340c74ca 62f8c747c81144209ca48df81a651964 1f41ab1eabef47f193a5b468001b55f3] Exception during message handling\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/rpc/amqp.py\", line 433, in _process_data\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 99, in wrapped\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib64/python2.7/contextlib.py\", line 24, in __exit__\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 76, in wrapped\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 266, in decorated_function\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 243, in decorated_function\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib64/python2.7/contextlib.py\", line 24, in __exit__\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 230, in decorated_function\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2216, in confirm_resize\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     self._legacy_nw_info(network_info))\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/driver.py\", line 182, in confirm_migration\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     self._vmops.confirm_migration(migration, instance, network_info)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vmops.py\", line 215, in confirm_migration\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     self._destroy_orig_vm(instance, network_info)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vmops.py\", line 220, in _destroy_orig_vm\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     return self._destroy(instance, vm_ref, network_info=network_info)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vmops.py\", line 1260, in _destroy\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     _(\"XenAPI failed to power the instance off\"))\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp InstancePowerOffFailure: XenAPI failed to power the instance off", 
    "tags": [
        "xenserver"
    ], 
    "importance": "High", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1194264", 
    "owner": "https://api.launchpad.net/1.0/~dan-prince", 
    "id": 1194264, 
    "index": 1140, 
    "openned": "2013-06-24 20:35:20.782460+00:00", 
    "created": "2013-06-24 20:35:20.782460+00:00", 
    "title": "XenServer: resize confirm causes 'XenAPI failed to power the instance off'", 
    "comments": [
        {
            "content": "Using the latest Nova Havana code today (git commit d4c7e88c or later)...\n\nI'm now seeing resize_confirm API requests fail with Torpedo when running XenServer 6.1 in SmokeStack.\n\nThe following error message is displayed in Nova's compute.log file:\n\n==> /var/log/nova/compute.log <==\n2013-06-24 20:15:02.240 10813 WARNING nova.compute.manager [req-d8b83c39-614f-4861-9b2a-0d7ecadf1c77 None None] Found 0 in the database and 2 on the hypervisor.\n2013-06-24 20:19:57.975 10813 WARNING nova.virt.xenapi.vm_utils [req-c58a796c-e6f8-4653-97ff-62f5340c74ca 62f8c747c81144209ca48df81a651964 1f41ab1eabef47f193a5b468001b55f3] [instance: b82e6f76-c34a-41df-a1a0-c39665a27f56] VM already halted, skipping shutdown...\n2013-06-24 20:19:57.977 10813 ERROR nova.compute.manager [req-c58a796c-e6f8-4653-97ff-62f5340c74ca 62f8c747c81144209ca48df81a651964 1f41ab1eabef47f193a5b468001b55f3] [instance: b82e6f76-c34a-41df-a1a0-c39665a27f56] XenAPI failed to power the instance off. Setting instance vm_state to ERROR\n2013-06-24 20:19:58.685 10813 ERROR nova.openstack.common.rpc.amqp [req-c58a796c-e6f8-4653-97ff-62f5340c74ca 62f8c747c81144209ca48df81a651964 1f41ab1eabef47f193a5b468001b55f3] Exception during message handling\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/rpc/amqp.py\", line 433, in _process_data\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 99, in wrapped\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib64/python2.7/contextlib.py\", line 24, in __exit__\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 76, in wrapped\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 266, in decorated_function\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 243, in decorated_function\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib64/python2.7/contextlib.py\", line 24, in __exit__\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 230, in decorated_function\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2216, in confirm_resize\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     self._legacy_nw_info(network_info))\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/driver.py\", line 182, in confirm_migration\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     self._vmops.confirm_migration(migration, instance, network_info)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vmops.py\", line 215, in confirm_migration\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     self._destroy_orig_vm(instance, network_info)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vmops.py\", line 220, in _destroy_orig_vm\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     return self._destroy(instance, vm_ref, network_info=network_info)\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/nova/virt/xenapi/vmops.py\", line 1260, in _destroy\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp     _(\"XenAPI failed to power the instance off\"))\n2013-06-24 20:19:58.685 10813 TRACE nova.openstack.common.rpc.amqp InstancePowerOffFailure: XenAPI failed to power the instance off", 
            "date_created": "2013-06-24 20:35:20.782460+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/34256", 
            "date_created": "2013-06-24 20:42:35.195052+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/34256\nCommitted: http://github.com/openstack/nova/commit/c9bb51c6da93a40f4057e99db146c109718bc3a6\nSubmitter: Jenkins\nBranch:    master\n\ncommit c9bb51c6da93a40f4057e99db146c109718bc3a6\nAuthor: Dan Prince <email address hidden>\nDate:   Mon Jun 24 16:41:06 2013 -0400\n\n    Revert XenApi virt driver should throw exception\n    \n    This reverts commit 2cb31123302a1ec8c8dec0cb2ac288a2e3b19c68.\n    \n    Fixes LP Bug #1194264.\n    \n    Change-Id: Ib8f8a8cfdcc1b37bb87fee3983081154a4fa2b2b\n", 
            "date_created": "2013-06-25 01:41:01.732753+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-07-17 12:17:59.493640+00:00"
}