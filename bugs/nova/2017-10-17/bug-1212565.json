{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 19:44:00.911413+00:00", 
    "description": "The \"nova interface-attach\" command fails in nova-compute with libvirt/KVM driver due to missing arguments.\n\nRelated commit: https://review.openstack.org/#q,I63c1fb51ea637d461755b309c7464f4b4d49a4b2,n,z\n\n\nIt fails with the following response:\n$ nova interface-attach --net-id 6d2b5fb2-1f4b-4b3f-b670-93a897c3721b vm\nERROR: The server could not comply with the request since it is either malformed or otherwise incorrect. (HTTP 400) (Request-ID: req-95a70e59-a401-4e42-bdb7-6d4711ebb92a)\n\n\nError message in nova-compute log:\n2013-08-15 16:10:17.971 27780 DEBUG nova.openstack.common.rpc.amqp [-] Making synchronous call on conductor ... multicall /opt/stack/nova/nova/openstack/common/rpc/amqp.py:583\n2013-08-15 16:10:17.971 27780 DEBUG nova.openstack.common.rpc.amqp [-] MSG_ID is 82cd88f9957d45dd92e34c9f45cd7819 multicall /opt/stack/nova/nova/openstack/common/rpc/amqp.py:586\n2013-08-15 16:10:17.972 27780 DEBUG nova.openstack.common.rpc.amqp [-] UNIQUE_ID is b9ba88875ff74c09b5362565a6e4d25c. _add_unique_id /opt/stack/nova/nova/openstack/common/rpc/amqp.py:337\n\n/nova/compute/manager.py\", line 3054, in attach_interface\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp     self.driver.attach_\ninterface(instance, image_meta, legacy_net_info)\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova\n/nova/exception.py\", line 117, in wrapped\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp     temp_level, payload\n)\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python\n2.7/contextlib.py\", line 24, in __exit__\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova\n/nova/exception.py\", line 94, in wrapped\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp     return f(self, cont\next, *args, **kw)\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova\n/nova/virt/libvirt/driver.py\", line 1052, in attach_interface\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp     image_meta)\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp TypeError: get_config()\n takes exactly 6 arguments (5 given)\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp\n2013-08-15 16:03:29.268 ERROR nova.openstack.common.rpc.common [req-95a70e59-a401-4e42-bdb\n7-6d4711ebb92a demo demo] Returning exception get_config() takes exactly 6 arguments (5 gi\nven) to caller\n2013-08-15 16:03:29.268 ERROR nova.openstack.common.rpc.common [req-95a70e59-a401-4e42-bdb\n7-6d4711ebb92a demo demo] ['Traceback (most recent call last):\\n', '  File \"/opt/stack/nov\na/nova/openstack/common/rpc/amqp.py\", line 430, in _process_data\\n    rval = self.proxy.di\nspatch(ctxt, version, method, **args)\\n', '  File \"/opt/stack/nova/nova/openstack/common/r\npc/dispatcher.py\", line 133, in dispatch\\n    return getattr(proxyobj, method)(ctxt, **kwa\nrgs)\\n', '  File \"/opt/stack/nova/nova/compute/manager.py\", line 3054, in attach_interface\n\\n    self.driver.attach_interface(instance, image_meta, legacy_net_info)\\n', '  File \"/op\nt/stack/nova/nova/exception.py\", line 117, in wrapped\\n    temp_level, payload)\\n', '  Fil\ne \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\\n    self.gen.next()\\n', '  Fil\ne \"/opt/stack/nova/nova/exception.py\", line 94, in wrapped\\n    return f(self, context, *a\nrgs, **kw)\\n', '  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1052, in attach\n_interface\\n    image_meta)\\n', 'TypeError: get_config() takes exactly 6 arguments (5 give\nn)\\n']", 
    "tags": [
        "libvirt"
    ], 
    "importance": "Undecided", 
    "heat": 18, 
    "link": "https://bugs.launchpad.net/nova/+bug/1212565", 
    "owner": "https://api.launchpad.net/1.0/~cyril-roelandt", 
    "id": 1212565, 
    "index": 5235, 
    "openned": "2013-08-15 07:18:48.498332+00:00", 
    "created": "2013-08-15 07:18:48.498332+00:00", 
    "title": "libvirt driver: Failed to attach new interface to VM", 
    "comments": [
        {
            "content": "The \"nova interface-attach\" command fails in nova-compute with libvirt/KVM driver due to missing arguments.\n\nRelated commit: https://review.openstack.org/#q,I63c1fb51ea637d461755b309c7464f4b4d49a4b2,n,z\n\n\nIt fails with the following response:\n$ nova interface-attach --net-id 6d2b5fb2-1f4b-4b3f-b670-93a897c3721b vm\nERROR: The server could not comply with the request since it is either malformed or otherwise incorrect. (HTTP 400) (Request-ID: req-95a70e59-a401-4e42-bdb7-6d4711ebb92a)\n\n\nError message in nova-compute log:\n2013-08-15 16:10:17.971 27780 DEBUG nova.openstack.common.rpc.amqp [-] Making synchronous call on conductor ... multicall /opt/stack/nova/nova/openstack/common/rpc/amqp.py:583\n2013-08-15 16:10:17.971 27780 DEBUG nova.openstack.common.rpc.amqp [-] MSG_ID is 82cd88f9957d45dd92e34c9f45cd7819 multicall /opt/stack/nova/nova/openstack/common/rpc/amqp.py:586\n2013-08-15 16:10:17.972 27780 DEBUG nova.openstack.common.rpc.amqp [-] UNIQUE_ID is b9ba88875ff74c09b5362565a6e4d25c. _add_unique_id /opt/stack/nova/nova/openstack/common/rpc/amqp.py:337\n\n/nova/compute/manager.py\", line 3054, in attach_interface\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp     self.driver.attach_\ninterface(instance, image_meta, legacy_net_info)\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova\n/nova/exception.py\", line 117, in wrapped\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp     temp_level, payload\n)\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python\n2.7/contextlib.py\", line 24, in __exit__\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova\n/nova/exception.py\", line 94, in wrapped\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp     return f(self, cont\next, *args, **kw)\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova\n/nova/virt/libvirt/driver.py\", line 1052, in attach_interface\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp     image_meta)\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp TypeError: get_config()\n takes exactly 6 arguments (5 given)\n2013-08-15 16:03:29.265 27780 TRACE nova.openstack.common.rpc.amqp\n2013-08-15 16:03:29.268 ERROR nova.openstack.common.rpc.common [req-95a70e59-a401-4e42-bdb\n7-6d4711ebb92a demo demo] Returning exception get_config() takes exactly 6 arguments (5 gi\nven) to caller\n2013-08-15 16:03:29.268 ERROR nova.openstack.common.rpc.common [req-95a70e59-a401-4e42-bdb\n7-6d4711ebb92a demo demo] ['Traceback (most recent call last):\\n', '  File \"/opt/stack/nov\na/nova/openstack/common/rpc/amqp.py\", line 430, in _process_data\\n    rval = self.proxy.di\nspatch(ctxt, version, method, **args)\\n', '  File \"/opt/stack/nova/nova/openstack/common/r\npc/dispatcher.py\", line 133, in dispatch\\n    return getattr(proxyobj, method)(ctxt, **kwa\nrgs)\\n', '  File \"/opt/stack/nova/nova/compute/manager.py\", line 3054, in attach_interface\n\\n    self.driver.attach_interface(instance, image_meta, legacy_net_info)\\n', '  File \"/op\nt/stack/nova/nova/exception.py\", line 117, in wrapped\\n    temp_level, payload)\\n', '  Fil\ne \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\\n    self.gen.next()\\n', '  Fil\ne \"/opt/stack/nova/nova/exception.py\", line 94, in wrapped\\n    return f(self, context, *a\nrgs, **kw)\\n', '  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1052, in attach\n_interface\\n    image_meta)\\n', 'TypeError: get_config() takes exactly 6 arguments (5 give\nn)\\n']", 
            "date_created": "2013-08-15 07:18:48.498332+00:00", 
            "author": "https://api.launchpad.net/1.0/~r-mibu"
        }, 
        {
            "content": "Fix proposed to branch: stable/grizzly\nReview: https://review.openstack.org/42280", 
            "date_created": "2013-08-16 04:31:41.077800+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This bug is in stable/grizzly.\n\nI also confirmed the same problem in master branch.", 
            "date_created": "2013-08-16 05:01:22.877936+00:00", 
            "author": "https://api.launchpad.net/1.0/~r-mibu"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/42284", 
            "date_created": "2013-08-16 05:14:10.844129+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Proposed to master https://review.openstack.org/37030", 
            "date_created": "2013-08-19 11:22:05.696107+00:00", 
            "author": "https://api.launchpad.net/1.0/~apevec"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/43261\nCommitted: http://github.com/openstack/nova/commit/873ccbb260cb85a66ca7502c477f0b749d4bb81f\nSubmitter: Jenkins\nBranch:    stable/grizzly\n\ncommit 873ccbb260cb85a66ca7502c477f0b749d4bb81f\nAuthor: Cyril Roelandt <email address hidden>\nDate:   Mon Jul 15 08:19:30 2013 +0000\n\n    libvirt: fix {attach,detach}_interface()\n    \n    * The get_config() method now takes 6 arguments, instead of 5\n      previously. This change has been introduced by commit 08f8773b.\n    \n    * LibvirtConnTestCase: add the test_attach_interface_get_config() and\n      test_detach_interface_get_config() methods to prevent future\n      failures.\n    \n    Fixes bug #1212565\n    \n    (cherry picked from commit ff4863cca3012b2060bff788456c1b98b03d46d5)\n    \n    Conflicts:\n    \tnova/tests/test_libvirt.py\n    \tnova/virt/libvirt/driver.py\n    \n    Change-Id: I4e874f59595c3afe820103a27036519df1a126ff\n", 
            "date_created": "2013-09-11 14:23:53.235675+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-09-05 15:45:54.764386+00:00"
}