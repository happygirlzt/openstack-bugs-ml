{
    "status": "Fix Released", 
    "last_updated": "2017-02-27 20:28:57.824160+00:00", 
    "description": "Description\n===========\nIab5afdf1b5b8d107ea0e5895c24d50712e7dc7b1 [1] ensured that _cleanup_failed_start is always called if we encounter VIF plugging failures in _create_domain_and_network. However this currently leads to any local instance files being removed as cleanup is called with destroy_disks=True.\n\nAs such any failures when resuming or restarting an instance will lead to these files being removed and the instance left in an unbootable state. IMHO these files should only be removed when cleaning up after errors hit while initially spawning an instance.\n\nSteps to reproduce\n==================\n- Boot an instance using local disks\n- Stop the instance\n- Start the instance, causing a timeout or other failure during plug_vifs\n- Attempt to start the instance again\n\nExpected result\n===============\nThe local instance files are left on the host if instances are rebooting or resuming.\n\nActual result\n=============\nThe local instance files are removed from the host if _cleanup_failed_start is called.\n\nEnvironment\n===========\n1. Exact version of OpenStack you are running. See the following\n   list for all releases: http://docs.openstack.org/releases/\n\n   $ pwd\n   /opt/stack/nova\n   $ git rev-parse HEAD\n   42222969a21ee28ef4a68bd5ab1ec8a12c4ad126\n\n\n2. Which hypervisor did you use?\n   (For example: Libvirt + KVM, Libvirt + XEN, Hyper-V, PowerKVM, ...)\n   What's the version of that?\n\n   Libvirt + KVM\n\n2. Which storage type did you use?\n   (For example: Ceph, LVM, GPFS, ...)\n   What's the version of that?\n\n   N/A\n\n3. Which networking type did you use?\n   (For example: nova-network, Neutron with OpenVSwitch, ...)\n\n   N/A\n\nLogs & Configs\n==============\n\n$ nova boot --image cirros-0.3.4-x86_64-uec --flavor 1 test-boot\n[..]\n$ nova stop test-boot\n$ ll ../data/nova/instances/be6cb386-e005-4fb2-8332-7e0c375ee452/\ntotal 18596\n-rw-rw-r--. 1 root  root        16699 Jan 31 09:30 console.log\n-rw-r--r--. 1 root  root     10289152 Jan 31 09:30 disk\n-rw-r--r--. 1 stack libvirtd      257 Jan 31 09:29 disk.info\n-rw-rw-r--. 1 qemu  qemu      4979632 Jan 31 09:29 kernel\n-rw-rw-r--. 1 qemu  qemu      3740163 Jan 31 09:29 ramdisk\n\nI used the following change to artificially recreate an issue plugging the VIFs :\n\n$ git diff\ndiff --git a/nova/virt/libvirt/driver.py b/nova/virt/libvirt/driver.py\nindex 33e3157..248e960 100644\n--- a/nova/virt/libvirt/driver.py\n+++ b/nova/virt/libvirt/driver.py\n@@ -5015,6 +5015,7 @@ class LibvirtDriver(driver.ComputeDriver):\n         pause = bool(events)\n         guest = None\n         try:\n+            raise exception.VirtualInterfaceCreateException()\n             with self.virtapi.wait_for_instance_event(\n                     instance, events, deadline=timeout,\n                     error_callback=self._neutron_failed_callback):\n\n$ nova start test-boot\nRequest to start server test-boot has been accepted.\n$ nova list\n+--------------------------------------+-----------+---------+------------+-------------+--------------------------------+\n| ID                                   | Name      | Status  | Task State | Power State | Networks                       |\n+--------------------------------------+-----------+---------+------------+-------------+--------------------------------+\n| be6cb386-e005-4fb2-8332-7e0c375ee452 | test-boot | SHUTOFF | -          | Shutdown    | public=172.24.4.8, 2001:db8::9 |\n+--------------------------------------+-----------+---------+------------+-------------+--------------------------------+\n$ ll ../data/nova/instances/be6cb386-e005-4fb2-8332-7e0c375ee452/\nls: cannot access '../data/nova/instances/be6cb386-e005-4fb2-8332-7e0c375ee452/': No such file or directory\n\nFuture attempts to start the instance will fail as a result :\n\n$ nova start test-boot\nRequest to start server test-boot has been accepted.\n$ vi ../logs/n-cpu.log\n[..]\n5353 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server Traceback (most recent call last):\n5354 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/server.py\", line 155, in _process_incoming\n5355 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     res = self.dispatcher.dispatch(message)\n5356 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 222, in dispatch\n5357 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return self._do_dispatch(endpoint, method, ctxt, args)\n5358 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 192, in _do_dispatch\n5359 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     result = func(ctxt, **new_args)\n5360 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception_wrapper.py\", line 75, in wrapped\n5361 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     function_name, call_dict, binary)\n5362 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n5363 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     self.force_reraise()\n5364 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n5365 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n5366 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception_wrapper.py\", line 66, in wrapped\n5367 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return f(self, context, *args, **kw)\n5368 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 188, in decorated_function\n5369 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     LOG.warning(msg, e, instance=instance)\n5370 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n5371 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     self.force_reraise()\n5372 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n5373 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n5374 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 157, in decorated_function\n5375 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n5376 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/utils.py\", line 685, in decorated_function\n5377 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n5378 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 216, in decorated_function\n5379 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     kwargs['instance'], e, sys.exc_info())\n5380 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n5381 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     self.force_reraise()\n5382 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n5383 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n5384 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 204, in decorated_function\n5385 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n5386 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 2524, in start_instance\n5387 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     self._power_on(context, instance)\n5388 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 2494, in _power_on\n5389 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     block_device_info)  \n5390 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2494, in power_on\n5391 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     self._hard_reboot(context, instance, network_info, block_device_info)\n5392 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2373, in _hard_reboot\n5393 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     block_device_info)  \n5394 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 6931, in _get_instance_disk_info\n5395 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     dk_size = int(os.path.getsize(path))\n5396 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib64/python2.7/genericpath.py\", line 57, in getsize\n5397 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return os.stat(filename).st_size\n5398 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server OSError: [Errno 2] No such file or directory: '/opt/stack/data/nova/instances/be6cb386-e005-4fb2-8332-7e0c375ee452/disk'\n5399 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server", 
    "tags": [
        "libvirt"
    ], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1660647", 
    "owner": "https://api.launchpad.net/1.0/~lyarwood", 
    "id": 1660647, 
    "index": 2028, 
    "openned": "2017-01-31 15:08:22.490031+00:00", 
    "created": "2017-01-31 15:08:22.490031+00:00", 
    "title": "_cleanup_failed_start aggressively removes local instance files when handling plug_vif failures", 
    "comments": [
        {
            "content": "Description\n===========\nIab5afdf1b5b8d107ea0e5895c24d50712e7dc7b1 [1] ensured that _cleanup_failed_start is always called if we encounter VIF plugging failures in _create_domain_and_network. However this currently leads to any local instance files being removed as cleanup is called with destroy_disks=True.\n\nAs such any failures when resuming or restarting an instance will lead to these files being removed and the instance left in an unbootable state. IMHO these files should only be removed when cleaning up after errors hit while initially spawning an instance.\n\nSteps to reproduce\n==================\n- Boot an instance using local disks\n- Stop the instance\n- Start the instance, causing a timeout or other failure during plug_vifs\n- Attempt to start the instance again\n\nExpected result\n===============\nThe local instance files are left on the host if instances are rebooting or resuming.\n\nActual result\n=============\nThe local instance files are removed from the host if _cleanup_failed_start is called.\n\nEnvironment\n===========\n1. Exact version of OpenStack you are running. See the following\n   list for all releases: http://docs.openstack.org/releases/\n\n   $ pwd\n   /opt/stack/nova\n   $ git rev-parse HEAD\n   42222969a21ee28ef4a68bd5ab1ec8a12c4ad126\n\n\n2. Which hypervisor did you use?\n   (For example: Libvirt + KVM, Libvirt + XEN, Hyper-V, PowerKVM, ...)\n   What's the version of that?\n\n   Libvirt + KVM\n\n2. Which storage type did you use?\n   (For example: Ceph, LVM, GPFS, ...)\n   What's the version of that?\n\n   N/A\n\n3. Which networking type did you use?\n   (For example: nova-network, Neutron with OpenVSwitch, ...)\n\n   N/A\n\nLogs & Configs\n==============\n\n$ nova boot --image cirros-0.3.4-x86_64-uec --flavor 1 test-boot\n[..]\n$ nova stop test-boot\n$ ll ../data/nova/instances/be6cb386-e005-4fb2-8332-7e0c375ee452/\ntotal 18596\n-rw-rw-r--. 1 root  root        16699 Jan 31 09:30 console.log\n-rw-r--r--. 1 root  root     10289152 Jan 31 09:30 disk\n-rw-r--r--. 1 stack libvirtd      257 Jan 31 09:29 disk.info\n-rw-rw-r--. 1 qemu  qemu      4979632 Jan 31 09:29 kernel\n-rw-rw-r--. 1 qemu  qemu      3740163 Jan 31 09:29 ramdisk\n\nI used the following change to artificially recreate an issue plugging the VIFs :\n\n$ git diff\ndiff --git a/nova/virt/libvirt/driver.py b/nova/virt/libvirt/driver.py\nindex 33e3157..248e960 100644\n--- a/nova/virt/libvirt/driver.py\n+++ b/nova/virt/libvirt/driver.py\n@@ -5015,6 +5015,7 @@ class LibvirtDriver(driver.ComputeDriver):\n         pause = bool(events)\n         guest = None\n         try:\n+            raise exception.VirtualInterfaceCreateException()\n             with self.virtapi.wait_for_instance_event(\n                     instance, events, deadline=timeout,\n                     error_callback=self._neutron_failed_callback):\n\n$ nova start test-boot\nRequest to start server test-boot has been accepted.\n$ nova list\n+--------------------------------------+-----------+---------+------------+-------------+--------------------------------+\n| ID                                   | Name      | Status  | Task State | Power State | Networks                       |\n+--------------------------------------+-----------+---------+------------+-------------+--------------------------------+\n| be6cb386-e005-4fb2-8332-7e0c375ee452 | test-boot | SHUTOFF | -          | Shutdown    | public=172.24.4.8, 2001:db8::9 |\n+--------------------------------------+-----------+---------+------------+-------------+--------------------------------+\n$ ll ../data/nova/instances/be6cb386-e005-4fb2-8332-7e0c375ee452/\nls: cannot access '../data/nova/instances/be6cb386-e005-4fb2-8332-7e0c375ee452/': No such file or directory\n\nFuture attempts to start the instance will fail as a result :\n\n$ nova start test-boot\nRequest to start server test-boot has been accepted.\n$ vi ../logs/n-cpu.log\n[..]\n5353 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server Traceback (most recent call last):\n5354 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/server.py\", line 155, in _process_incoming\n5355 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     res = self.dispatcher.dispatch(message)\n5356 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 222, in dispatch\n5357 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return self._do_dispatch(endpoint, method, ctxt, args)\n5358 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 192, in _do_dispatch\n5359 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     result = func(ctxt, **new_args)\n5360 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception_wrapper.py\", line 75, in wrapped\n5361 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     function_name, call_dict, binary)\n5362 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n5363 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     self.force_reraise()\n5364 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n5365 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n5366 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception_wrapper.py\", line 66, in wrapped\n5367 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return f(self, context, *args, **kw)\n5368 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 188, in decorated_function\n5369 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     LOG.warning(msg, e, instance=instance)\n5370 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n5371 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     self.force_reraise()\n5372 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n5373 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n5374 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 157, in decorated_function\n5375 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n5376 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/utils.py\", line 685, in decorated_function\n5377 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n5378 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 216, in decorated_function\n5379 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     kwargs['instance'], e, sys.exc_info())\n5380 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n5381 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     self.force_reraise()\n5382 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n5383 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n5384 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 204, in decorated_function\n5385 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n5386 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 2524, in start_instance\n5387 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     self._power_on(context, instance)\n5388 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 2494, in _power_on\n5389 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     block_device_info)  \n5390 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2494, in power_on\n5391 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     self._hard_reboot(context, instance, network_info, block_device_info)\n5392 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2373, in _hard_reboot\n5393 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     block_device_info)  \n5394 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 6931, in _get_instance_disk_info\n5395 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     dk_size = int(os.path.getsize(path))\n5396 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server   File \"/usr/lib64/python2.7/genericpath.py\", line 57, in getsize\n5397 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server     return os.stat(filename).st_size\n5398 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server OSError: [Errno 2] No such file or directory: '/opt/stack/data/nova/instances/be6cb386-e005-4fb2-8332-7e0c375ee452/disk'\n5399 2017-01-31 09:35:59.117 TRACE oslo_messaging.rpc.server", 
            "date_created": "2017-01-31 15:08:22.490031+00:00", 
            "author": "https://api.launchpad.net/1.0/~lyarwood"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/427267", 
            "date_created": "2017-01-31 16:03:24.321622+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/427267\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=67aa277b4ef623c9877b97bfd7952f0bb1d80a81\nSubmitter: Jenkins\nBranch:    master\n\ncommit 67aa277b4ef623c9877b97bfd7952f0bb1d80a81\nAuthor: Lee Yarwood <email address hidden>\nDate:   Tue Jan 31 15:26:38 2017 +0000\n\n    libvirt: Limit destroying disks during cleanup to spawn\n    \n    Iab5afdf1b5b now ensures that cleanup is always called when VIF plugging\n    errors are encountered by _create_domain_and_network. At present cleanup\n    is always called with destroy_disks=True leading to any local instance\n    files being removed from the host.\n    \n    _create_domain_and_network itself has various callers such as resume and\n    hard_reboot that assume these files will persist any such failures. As a\n    result the removal of these files will leave instances in an unbootable\n    state.\n    \n    In order to correct this an additional destroy_disks_on_failures kwarg\n    is now provided to _create_domain_and_network and passed down into\n    cleanup. This kwarg defaults to False and is only enabled when\n    _create_domain_and_network is used to spawn a new instance.\n    \n    Closes-bug: #1660647\n    Change-Id: I38c969690fedb71c5b5ec4418c1b0dd53df733ec\n", 
            "date_created": "2017-02-03 04:21:52.644515+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/newton\nReview: https://review.openstack.org/428671", 
            "date_created": "2017-02-03 09:53:46.972602+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 15.0.0.0rc1 release candidate.", 
            "date_created": "2017-02-03 19:08:22.832247+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/428671\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=9f8d15dcc1b4db9b1116d19b6af0f6cac15ff9fe\nSubmitter: Jenkins\nBranch:    stable/newton\n\ncommit 9f8d15dcc1b4db9b1116d19b6af0f6cac15ff9fe\nAuthor: Lee Yarwood <email address hidden>\nDate:   Tue Jan 31 15:26:38 2017 +0000\n\n    libvirt: Limit destroying disks during cleanup to spawn\n    \n    Iab5afdf1b5b now ensures that cleanup is always called when VIF plugging\n    errors are encountered by _create_domain_and_network. At present cleanup\n    is always called with destroy_disks=True leading to any local instance\n    files being removed from the host.\n    \n    _create_domain_and_network itself has various callers such as resume and\n    hard_reboot that assume these files will persist any such failures. As a\n    result the removal of these files will leave instances in an unbootable\n    state.\n    \n    In order to correct this an additional destroy_disks_on_failures kwarg\n    is now provided to _create_domain_and_network and passed down into\n    cleanup. This kwarg defaults to False and is only enabled when\n    _create_domain_and_network is used to spawn a new instance.\n    \n    Closes-bug: #1660647\n    Change-Id: I38c969690fedb71c5b5ec4418c1b0dd53df733ec\n    (cherry picked from commit 67aa277b4ef623c9877b97bfd7952f0bb1d80a81)\n", 
            "date_created": "2017-02-16 04:39:18.160431+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.4 release.", 
            "date_created": "2017-02-27 20:28:56.940530+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2017-02-03 04:21:50.271473+00:00"
}