{
    "status": "Fix Released", 
    "last_updated": "2013-04-04 11:06:39.281823+00:00", 
    "description": "when rescue images with kernel, the rescued instances cannot boot successfully due to missing cmdline config in libvirt.xml.rescue\n\n\nthe libvirt.xml.rescue:\n<domain type=\"kvm\">\n  <uuid>e6c7148a-9411-4a6b-92db-52bf334e14cd</uuid>\n  <name>i-00001707</name>\n  <memory>2097152</memory>\n  <vcpu>1</vcpu>\n  <os>\n    <type>hvm</type>\n    <kernel>/var/lib/nova/instances/i-00001707/kernel.rescue</kernel>\n    <initrd>/var/lib/nova/instances/i-00001707/ramdisk.rescue</initrd>\n  </os>\n  <features>\n    <acpi/>\n  </features>\n  <clock offset=\"utc\">\n    <timer name=\"pit\" tickpolicy=\"delay\"/>\n    <timer name=\"rtc\" tickpolicy=\"catchup\"/>\n  </clock>\n  <devices>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/i-00001707/disk.rescue\"/>\n      <target bus=\"virtio\" dev=\"vda\"/>\n    </disk>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/i-00001707/disk\"/>\n      <target bus=\"virtio\" dev=\"vdb\"/>\n    </disk>\n    <interface type=\"bridge\">\n      <mac address=\"fa:16:3e:f9:ca:3c\"/>\n      <model type=\"virtio\"/>\n      <source bridge=\"br2\"/>\n      <filterref filter=\"nova-instance-i-00001707-fa163ef9ca3c\">\n        <parameter name=\"IP\" value=\"10.0.0.10\"/>\n        <parameter name=\"DHCPSERVER\" value=\"10.0.0.1\"/>\n      </filterref>\n    </interface>\n    <serial type=\"file\">\n      <source path=\"/var/lib/nova/instances/i-00001707/console.log\"/>\n    </serial>\n    <serial type=\"pty\"/>\n    <input type=\"tablet\" bus=\"usb\"/>\n    <graphics type=\"vnc\" autoport=\"yes\" keymap=\"en-us\" listen=\"0.0.0.0\"/>\n  </devices>\n</domain>\n\n\nthe libvirt.xml:\n<domain type=\"kvm\">\n  <uuid>e6c7148a-9411-4a6b-92db-52bf334e14cd</uuid>\n  <name>i-00001707</name>\n  <memory>2097152</memory>\n  <vcpu>1</vcpu>\n  <os>\n    <type>hvm</type>\n    <kernel>/var/lib/nova/instances/i-00001707/kernel</kernel>\n    <initrd>/var/lib/nova/instances/i-00001707/ramdisk</initrd>\n    <cmdline>root=/dev/vda console=ttyS0</cmdline>\n  </os>\n  <features>\n    <acpi/>\n  </features>\n  <clock offset=\"utc\">\n    <timer name=\"pit\" tickpolicy=\"delay\"/>\n    <timer name=\"rtc\" tickpolicy=\"catchup\"/>\n  </clock>\n  <devices>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/i-00001707/disk\"/>\n      <target bus=\"virtio\" dev=\"vda\"/>\n    </disk>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/i-00001707/disk.local\"/>\n      <target bus=\"virtio\" dev=\"vdb\"/>\n    </disk>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/i-00001707/disk.swap\"/>\n      <target bus=\"virtio\" dev=\"vdc\"/>\n    </disk>\n    <interface type=\"bridge\">\n      <mac address=\"fa:16:3e:f9:ca:3c\"/>\n      <model type=\"virtio\"/>\n      <source bridge=\"br2\"/>\n      <filterref filter=\"nova-instance-i-00001707-fa163ef9ca3c\">\n        <parameter name=\"IP\" value=\"10.0.0.10\"/>\n        <parameter name=\"DHCPSERVER\" value=\"10.0.0.1\"/>\n      </filterref>\n    </interface>\n    <serial type=\"file\">\n      <source path=\"/var/lib/nova/instances/i-00001707/console.log\"/>\n    </serial>\n    <serial type=\"pty\"/>\n    <input type=\"tablet\" bus=\"usb\"/>\n    <graphics type=\"vnc\" autoport=\"yes\" keymap=\"en-us\" listen=\"0.0.0.0\"/>\n  </devices>\n</domain>", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1086780", 
    "owner": "https://api.launchpad.net/1.0/~heut2008", 
    "id": 1086780, 
    "index": 4515, 
    "openned": "2012-12-05 12:52:25.833820+00:00", 
    "created": "2012-12-05 12:52:25.833820+00:00", 
    "title": "libvirt: rescue for images with kernel missing cmdline config in xml", 
    "comments": [
        {
            "content": "when rescue images with kernel, the rescued instances cannot boot successfully due to missing cmdline config in libvirt.xml.rescue\n\n\nthe libvirt.xml.rescue:\n<domain type=\"kvm\">\n  <uuid>e6c7148a-9411-4a6b-92db-52bf334e14cd</uuid>\n  <name>i-00001707</name>\n  <memory>2097152</memory>\n  <vcpu>1</vcpu>\n  <os>\n    <type>hvm</type>\n    <kernel>/var/lib/nova/instances/i-00001707/kernel.rescue</kernel>\n    <initrd>/var/lib/nova/instances/i-00001707/ramdisk.rescue</initrd>\n  </os>\n  <features>\n    <acpi/>\n  </features>\n  <clock offset=\"utc\">\n    <timer name=\"pit\" tickpolicy=\"delay\"/>\n    <timer name=\"rtc\" tickpolicy=\"catchup\"/>\n  </clock>\n  <devices>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/i-00001707/disk.rescue\"/>\n      <target bus=\"virtio\" dev=\"vda\"/>\n    </disk>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/i-00001707/disk\"/>\n      <target bus=\"virtio\" dev=\"vdb\"/>\n    </disk>\n    <interface type=\"bridge\">\n      <mac address=\"fa:16:3e:f9:ca:3c\"/>\n      <model type=\"virtio\"/>\n      <source bridge=\"br2\"/>\n      <filterref filter=\"nova-instance-i-00001707-fa163ef9ca3c\">\n        <parameter name=\"IP\" value=\"10.0.0.10\"/>\n        <parameter name=\"DHCPSERVER\" value=\"10.0.0.1\"/>\n      </filterref>\n    </interface>\n    <serial type=\"file\">\n      <source path=\"/var/lib/nova/instances/i-00001707/console.log\"/>\n    </serial>\n    <serial type=\"pty\"/>\n    <input type=\"tablet\" bus=\"usb\"/>\n    <graphics type=\"vnc\" autoport=\"yes\" keymap=\"en-us\" listen=\"0.0.0.0\"/>\n  </devices>\n</domain>\n\n\nthe libvirt.xml:\n<domain type=\"kvm\">\n  <uuid>e6c7148a-9411-4a6b-92db-52bf334e14cd</uuid>\n  <name>i-00001707</name>\n  <memory>2097152</memory>\n  <vcpu>1</vcpu>\n  <os>\n    <type>hvm</type>\n    <kernel>/var/lib/nova/instances/i-00001707/kernel</kernel>\n    <initrd>/var/lib/nova/instances/i-00001707/ramdisk</initrd>\n    <cmdline>root=/dev/vda console=ttyS0</cmdline>\n  </os>\n  <features>\n    <acpi/>\n  </features>\n  <clock offset=\"utc\">\n    <timer name=\"pit\" tickpolicy=\"delay\"/>\n    <timer name=\"rtc\" tickpolicy=\"catchup\"/>\n  </clock>\n  <devices>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/i-00001707/disk\"/>\n      <target bus=\"virtio\" dev=\"vda\"/>\n    </disk>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/i-00001707/disk.local\"/>\n      <target bus=\"virtio\" dev=\"vdb\"/>\n    </disk>\n    <disk type=\"file\" device=\"disk\">\n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>\n      <source file=\"/var/lib/nova/instances/i-00001707/disk.swap\"/>\n      <target bus=\"virtio\" dev=\"vdc\"/>\n    </disk>\n    <interface type=\"bridge\">\n      <mac address=\"fa:16:3e:f9:ca:3c\"/>\n      <model type=\"virtio\"/>\n      <source bridge=\"br2\"/>\n      <filterref filter=\"nova-instance-i-00001707-fa163ef9ca3c\">\n        <parameter name=\"IP\" value=\"10.0.0.10\"/>\n        <parameter name=\"DHCPSERVER\" value=\"10.0.0.1\"/>\n      </filterref>\n    </interface>\n    <serial type=\"file\">\n      <source path=\"/var/lib/nova/instances/i-00001707/console.log\"/>\n    </serial>\n    <serial type=\"pty\"/>\n    <input type=\"tablet\" bus=\"usb\"/>\n    <graphics type=\"vnc\" autoport=\"yes\" keymap=\"en-us\" listen=\"0.0.0.0\"/>\n  </devices>\n</domain>", 
            "date_created": "2012-12-05 12:52:25.833820+00:00", 
            "author": "https://api.launchpad.net/1.0/~motokentsai"
        }, 
        {
            "content": "Looks like this is already being worked on https://review.openstack.org/#/c/17547/", 
            "date_created": "2012-12-05 21:42:30.959831+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/17547\nCommitted: http://github.com/openstack/nova/commit/3b8e122f7ddaa1382036f1f4d0c1f833f8d7deaa\nSubmitter: Jenkins\nBranch:    master\n\ncommit 3b8e122f7ddaa1382036f1f4d0c1f833f8d7deaa\nAuthor: Yaguang Tang <email address hidden>\nDate:   Thu Dec 6 00:31:27 2012 +0800\n\n    fix instance rescue without cmdline params in xml.rescue.\n    \n    fix bug #1086780\n    \n    Change-Id: I3495693b35dbde9c9da3d78208854b8ebc3f2a04\n", 
            "date_created": "2012-12-21 05:13:22.922444+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-01-09 10:25:55.830165+00:00"
}