{
    "status": "Fix Released", 
    "last_updated": "2011-09-22 13:35:00.396670+00:00", 
    "description": "I am trying to create/attach volumes using iSCSI on Xenserver. I followed the instructions here: http://docs.openstack.org/openstack-compute/admin/content/ch05s07.html#d5e579\n\nWhen I run euca-attach-volume, I see the following trace in the nova-compute logs:\n\n2011-03-29 17:13:42,040 ERROR nova.compute.manager [6N1A9AUKLB00N9VUQCL9 admin admin] instance 1: attach failed /dev/sda, removing\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 531, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi_conn.py\", line 211, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volumeops.py\", line 55, in attach_volume\n(nova.compute.manager): TRACE:     vol_rec = VolumeHelper.parse_volume_info(device_path, mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volume_utils.py\", line 165, in parse_volume_info\n(nova.compute.manager): TRACE:     (iscsi_name, iscsi_portal) = _get_target(volume_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volume_utils.py\", line 251, in _get_target\n(nova.compute.manager): TRACE:     volume_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/db/api.py\", line 711, in volume_get_by_ec2_id\n(nova.compute.manager): TRACE:     return IMPL.volume_get_by_ec2_id(context, ec2_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 368, in __getattr__\n(nova.compute.manager): TRACE:     return getattr(backend, key)\n(nova.compute.manager): TRACE: AttributeError: 'module' object has no attribute 'volume_get_by_ec2_id'\n(nova.compute.manager): TRACE:\n2011-03-29 17:13:42,040 ERROR nova.compute.manager [6N1A9AUKLB00N9VUQCL9 admin admin] instance 1: attach failed /dev/sda, removing\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 531, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi_conn.py\", line 211, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volumeops.py\", line 55, in attach_volume\n(nova.compute.manager): TRACE:     vol_rec = VolumeHelper.parse_volume_info(device_path, mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volume_utils.py\", line 165, in parse_volume_info\n(nova.compute.manager): TRACE:     (iscsi_name, iscsi_portal) = _get_target(volume_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volume_utils.py\", line 251, in _get_target\n(nova.compute.manager): TRACE:     volume_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/db/api.py\", line 711, in volume_get_by_ec2_id\n(nova.compute.manager): TRACE:     return IMPL.volume_get_by_ec2_id(context, ec2_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 368, in __getattr__\n(nova.compute.manager): TRACE:     return getattr(backend, key)\n(nova.compute.manager): TRACE: AttributeError: 'module' object has no attribute 'volume_get_by_ec2_id'\n(nova.compute.manager): TRACE:\n2011-03-29 17:13:42,077 ERROR nova.root [-] Exception during message handling\n(nova.root): TRACE: Traceback (most recent call last):\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/rpc.py\", line 192, in receive\n(nova.root): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 92, in decorated_function\n(nova.root): TRACE:     function(self, context, instance_id, *args, **kwargs)\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 544, in attach_volume\n(nova.root): TRACE:     raise exc\n(nova.root): TRACE: AttributeError: 'module' object has no attribute 'volume_get_by_ec2_id'\n(nova.root): TRACE:\n2011-03-29 17:13:42,077 ERROR nova.root [-] Exception during message handling\n(nova.root): TRACE: Traceback (most recent call last):\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/rpc.py\", line 192, in receive\n(nova.root): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 92, in decorated_function\n(nova.root): TRACE:     function(self, context, instance_id, *args, **kwargs)\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 544, in attach_volume\n(nova.root): TRACE:     raise exc\n(nova.root): TRACE: AttributeError: 'module' object has no attribute 'volume_get_by_ec2_id'\n(nova.root): TRACE:", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/745340", 
    "owner": "https://api.launchpad.net/1.0/~renukaapte", 
    "id": 745340, 
    "index": 2346, 
    "openned": "2011-03-29 22:54:17.405815+00:00", 
    "created": "2011-03-29 22:54:17.405815+00:00", 
    "title": "euca-attach-volume fails when using iSCSI on XenServer", 
    "comments": [
        {
            "content": "I am trying to create/attach volumes using iSCSI on Xenserver. I followed the instructions here: http://docs.openstack.org/openstack-compute/admin/content/ch05s07.html#d5e579\n\nWhen I run euca-attach-volume, I see the following trace in the nova-compute logs:\n\n2011-03-29 17:13:42,040 ERROR nova.compute.manager [6N1A9AUKLB00N9VUQCL9 admin admin] instance 1: attach failed /dev/sda, removing\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 531, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi_conn.py\", line 211, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volumeops.py\", line 55, in attach_volume\n(nova.compute.manager): TRACE:     vol_rec = VolumeHelper.parse_volume_info(device_path, mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volume_utils.py\", line 165, in parse_volume_info\n(nova.compute.manager): TRACE:     (iscsi_name, iscsi_portal) = _get_target(volume_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volume_utils.py\", line 251, in _get_target\n(nova.compute.manager): TRACE:     volume_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/db/api.py\", line 711, in volume_get_by_ec2_id\n(nova.compute.manager): TRACE:     return IMPL.volume_get_by_ec2_id(context, ec2_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 368, in __getattr__\n(nova.compute.manager): TRACE:     return getattr(backend, key)\n(nova.compute.manager): TRACE: AttributeError: 'module' object has no attribute 'volume_get_by_ec2_id'\n(nova.compute.manager): TRACE:\n2011-03-29 17:13:42,040 ERROR nova.compute.manager [6N1A9AUKLB00N9VUQCL9 admin admin] instance 1: attach failed /dev/sda, removing\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 531, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi_conn.py\", line 211, in attach_volume\n(nova.compute.manager): TRACE:     mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volumeops.py\", line 55, in attach_volume\n(nova.compute.manager): TRACE:     vol_rec = VolumeHelper.parse_volume_info(device_path, mountpoint)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volume_utils.py\", line 165, in parse_volume_info\n(nova.compute.manager): TRACE:     (iscsi_name, iscsi_portal) = _get_target(volume_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/virt/xenapi/volume_utils.py\", line 251, in _get_target\n(nova.compute.manager): TRACE:     volume_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/db/api.py\", line 711, in volume_get_by_ec2_id\n(nova.compute.manager): TRACE:     return IMPL.volume_get_by_ec2_id(context, ec2_id)\n(nova.compute.manager): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 368, in __getattr__\n(nova.compute.manager): TRACE:     return getattr(backend, key)\n(nova.compute.manager): TRACE: AttributeError: 'module' object has no attribute 'volume_get_by_ec2_id'\n(nova.compute.manager): TRACE:\n2011-03-29 17:13:42,077 ERROR nova.root [-] Exception during message handling\n(nova.root): TRACE: Traceback (most recent call last):\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/rpc.py\", line 192, in receive\n(nova.root): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 92, in decorated_function\n(nova.root): TRACE:     function(self, context, instance_id, *args, **kwargs)\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 544, in attach_volume\n(nova.root): TRACE:     raise exc\n(nova.root): TRACE: AttributeError: 'module' object has no attribute 'volume_get_by_ec2_id'\n(nova.root): TRACE:\n2011-03-29 17:13:42,077 ERROR nova.root [-] Exception during message handling\n(nova.root): TRACE: Traceback (most recent call last):\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/rpc.py\", line 192, in receive\n(nova.root): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 92, in decorated_function\n(nova.root): TRACE:     function(self, context, instance_id, *args, **kwargs)\n(nova.root): TRACE:   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 544, in attach_volume\n(nova.root): TRACE:     raise exc\n(nova.root): TRACE: AttributeError: 'module' object has no attribute 'volume_get_by_ec2_id'\n(nova.root): TRACE:", 
            "date_created": "2011-03-29 22:54:17.405815+00:00", 
            "author": "https://api.launchpad.net/1.0/~renukaapte"
        }, 
        {
            "content": "What version are you running ?", 
            "date_created": "2011-03-30 08:34:54.784166+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "it was tested on an old revision of nova, but it looks like the implementation of volume_get_by_ec2_id that should be in /nova/db/sqlalchemy/api.py is no longer available.\n\nThis happens in the latest nova trunk also (revno 894)", 
            "date_created": "2011-03-30 17:32:50.849854+00:00", 
            "author": "https://api.launchpad.net/1.0/~armando-migliaccio"
        }
    ], 
    "closed": "2011-09-22 13:34:59.028469+00:00"
}