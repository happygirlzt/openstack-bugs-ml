{
    "status": "Expired", 
    "last_updated": "2016-07-05 09:46:52.489373+00:00", 
    "description": "{\"build_id\": \"2014-03-05_07-31-01\", \"mirantis\": \"yes\", \"build_number\": \"235\", \"nailgun_sha\": \"f58aad317829112913f364347b14f1f0518ad371\", \"ostf_sha\": \"dc54d99ddff2f497b131ad1a42362515f2a61afa\", \"fuelmain_sha\": \"16637e2ea0ae6fe9a773aceb9d76c6e3a75f6c3b\", \"astute_sha\": \"f15f5615249c59c826ea05d26707f062c88db32a\", \"release\": \"4.1\", \"fuellib_sha\": \"73313007c0914e602246ea41fa5e8ca2dfead9f8\"}\n\nSteps to reproduce:\n1. Create env:\nCentos, multinode, 1Controller, 1 Compute, 1 Cinder, 2 Cephs, Neutron GRE, Cinder LVM, Ceph images\n2. Create Instance(from image)\n3. Create empty volume \n4. Attach volume to instance\n\nActual result:\nStatus of volume Available, volume in not attached\n\nExpected result:\nStatus of volumes should be in-use, volume is attached\n\n\n<0>Mar  5 10:46:09 node-3 <BF><179>nova-nova.compute.manager ERROR: Failed to attach volume 83653211-2ce9-4230-83e8-b6195298b934 at /dev/vdb\nTraceback (most recent call last):\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3687, in _attach_volume\n    encryption=encryption)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1087, in attach_volume\n    disk_info)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1046, in volume_driver_method\n    return method(connection_info, *args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 246, in inner\n    return f(*args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/volume.py\", line 285, in connect_volume\n    self._run_iscsiadm(iscsi_properties, (\"--rescan\",))\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/volume.py\", line 218, in _run_iscsiadm\n    check_exit_code=check_exit_code)\n  File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 177, in execute\n    return processutils.execute(*cmd, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 178, in execute\n    cmd=' '.join(cmd))\nProcessExecutionError: Unexpected error while running command.\nCommand: sudo nova-rootwrap /etc/nova/rootwrap.conf iscsiadm -m node -T iqn.2010-10.org.openstack:volume-83653211-2ce9-4230-83e8-b6195298b934 -p 192.168.1.3:3260 --rescan\nExit code: 21\nStdout: ''\nStderr: 'iscsiadm: No session found.\\n'\n<0>Mar  5 10:46:09 node-3 <BF><179>nova-nova.openstack.common.rpc.amqp ERROR: Exception during message handling\nTraceback (most recent call last):\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n    **args)\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n    result = getattr(proxyobj, method)(ctxt, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 90, in wrapped\n    payload)\n  File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 73, in wrapped\n    return f(self, context, *args, **kw)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 243, in decorated_function\n    pass\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 229, in decorated_function\n    return function(self, context, *args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 271, in decorated_function\n    e, sys.exc_info())\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 258, in decorated_function\n    return function(self, context, *args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3655, in attach_volume\n    context, instance, mountpoint)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3650, in attach_volume\n    mountpoint, instance)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3697, in _attach_volume\n    connector)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3687, in _attach_volume\n    encryption=encryption)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1087, in attach_volume\n    disk_info)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1046, in volume_driver_method\n    return method(connection_info, *args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 246, in inner\n    return f(*args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/volume.py\", line 285, in connect_volume\n    self._run_iscsiadm(iscsi_properties, (\"--rescan\",))\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/volume.py\", line 218, in _run_iscsiadm\n    check_exit_code=check_exit_code)\n  File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 177, in execute\n    return processutils.execute(*cmd, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 178, in execute\n    cmd=' '.join(cmd))\nProcessExecutionError: Unexpected error while running command.\nCommand: sudo nova-rootwrap /etc/nova/rootwrap.conf iscsiadm -m node -T iqn.2010-10.org.openstack:volume-83653211-2ce9-4230-83e8-b6195298b934 -p 192.168.1.3:3260 --rescan\nExit code: 21\nStdout: ''", 
    "tags": [
        "volumes"
    ], 
    "importance": "Undecided", 
    "heat": 28, 
    "link": "https://bugs.launchpad.net/nova/+bug/1288210", 
    "owner": "None", 
    "id": 1288210, 
    "index": 5885, 
    "openned": "2014-03-05 11:58:23.053946+00:00", 
    "created": "2014-03-05 11:58:23.053946+00:00", 
    "title": "Failed to attach volume", 
    "comments": [
        {
            "content": "{\"build_id\": \"2014-03-05_07-31-01\", \"mirantis\": \"yes\", \"build_number\": \"235\", \"nailgun_sha\": \"f58aad317829112913f364347b14f1f0518ad371\", \"ostf_sha\": \"dc54d99ddff2f497b131ad1a42362515f2a61afa\", \"fuelmain_sha\": \"16637e2ea0ae6fe9a773aceb9d76c6e3a75f6c3b\", \"astute_sha\": \"f15f5615249c59c826ea05d26707f062c88db32a\", \"release\": \"4.1\", \"fuellib_sha\": \"73313007c0914e602246ea41fa5e8ca2dfead9f8\"}\n\nSteps to reproduce:\n1. Create env:\nCentos, multinode, 1Controller, 1 Compute, 1 Cinder, 2 Cephs, Neutron GRE, Cinder LVM, Ceph images\n2. Create Instance(from image)\n3. Create empty volume \n4. Attach volume to instance\n\nActual result:\nStatus of volume Available, volume in not attached\n\nExpected result:\nStatus of volumes should be in-use, volume is attached\n\n\n<0>Mar  5 10:46:09 node-3 <BF><179>nova-nova.compute.manager ERROR: Failed to attach volume 83653211-2ce9-4230-83e8-b6195298b934 at /dev/vdb\nTraceback (most recent call last):\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3687, in _attach_volume\n    encryption=encryption)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1087, in attach_volume\n    disk_info)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1046, in volume_driver_method\n    return method(connection_info, *args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 246, in inner\n    return f(*args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/volume.py\", line 285, in connect_volume\n    self._run_iscsiadm(iscsi_properties, (\"--rescan\",))\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/volume.py\", line 218, in _run_iscsiadm\n    check_exit_code=check_exit_code)\n  File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 177, in execute\n    return processutils.execute(*cmd, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 178, in execute\n    cmd=' '.join(cmd))\nProcessExecutionError: Unexpected error while running command.\nCommand: sudo nova-rootwrap /etc/nova/rootwrap.conf iscsiadm -m node -T iqn.2010-10.org.openstack:volume-83653211-2ce9-4230-83e8-b6195298b934 -p 192.168.1.3:3260 --rescan\nExit code: 21\nStdout: ''\nStderr: 'iscsiadm: No session found.\\n'\n<0>Mar  5 10:46:09 node-3 <BF><179>nova-nova.openstack.common.rpc.amqp ERROR: Exception during message handling\nTraceback (most recent call last):\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n    **args)\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n    result = getattr(proxyobj, method)(ctxt, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 90, in wrapped\n    payload)\n  File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 73, in wrapped\n    return f(self, context, *args, **kw)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 243, in decorated_function\n    pass\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 229, in decorated_function\n    return function(self, context, *args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 271, in decorated_function\n    e, sys.exc_info())\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 258, in decorated_function\n    return function(self, context, *args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3655, in attach_volume\n    context, instance, mountpoint)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3650, in attach_volume\n    mountpoint, instance)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3697, in _attach_volume\n    connector)\n  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3687, in _attach_volume\n    encryption=encryption)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1087, in attach_volume\n    disk_info)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 1046, in volume_driver_method\n    return method(connection_info, *args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/lockutils.py\", line 246, in inner\n    return f(*args, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/volume.py\", line 285, in connect_volume\n    self._run_iscsiadm(iscsi_properties, (\"--rescan\",))\n  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/volume.py\", line 218, in _run_iscsiadm\n    check_exit_code=check_exit_code)\n  File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 177, in execute\n    return processutils.execute(*cmd, **kwargs)\n  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 178, in execute\n    cmd=' '.join(cmd))\nProcessExecutionError: Unexpected error while running command.\nCommand: sudo nova-rootwrap /etc/nova/rootwrap.conf iscsiadm -m node -T iqn.2010-10.org.openstack:volume-83653211-2ce9-4230-83e8-b6195298b934 -p 192.168.1.3:3260 --rescan\nExit code: 21\nStdout: ''", 
            "date_created": "2014-03-05 11:58:23.053946+00:00", 
            "author": "https://api.launchpad.net/1.0/~ykotko"
        }, 
        {
            "content": "", 
            "date_created": "2014-03-05 11:58:23.053946+00:00", 
            "author": "https://api.launchpad.net/1.0/~ykotko"
        }, 
        {
            "content": "Ryan, can you confirm this bug and report if it's fixable for 4.1.1?", 
            "date_created": "2014-03-13 13:42:53.890519+00:00", 
            "author": "https://api.launchpad.net/1.0/~raytrac3r"
        }, 
        {
            "content": "I can't reproduce this issue.", 
            "date_created": "2014-03-14 18:04:21.190177+00:00", 
            "author": "https://api.launchpad.net/1.0/~rmoe"
        }, 
        {
            "content": "Based on Ryan's comments marking as invalid in nova as well", 
            "date_created": "2014-03-17 19:55:27.880747+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "I'm able to reproduce this problem with RDO installed with \"packstack --allinone\" \n\nOS: CentOS 7.0.1406\nNova: 2014.2.1\n\n2015-02-12 02:26:29.131 4108 ERROR nova.virt.block_device [req-8c1bf3d1-955a-4910-99c8-293395f650df None] [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05] Driver failed to attach volume 910e1aab-fcaa-4b77-be12-a303c6216d04 at /dev/hda\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05] Traceback (most recent call last):\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]   File \"/usr/lib/python2.7/site-packages/nova/virt/block_device.py\", line 252, in attach\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]     device_type=self['device_type'], encryption=encryption)\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1380, in attach_volume\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]     conf = self._connect_volume(connection_info, disk_info)\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1327, in _connect_volume\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]     return driver.connect_volume(connection_info, disk_info)\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/lockutils.py\", line 272, in inner\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]     return f(*args, **kwargs)\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py\", line 299, in connect_volume\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]     self._run_iscsiadm(iscsi_properties, (\"--rescan\",))\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/volume.py\", line 236, in _run_iscsiadm\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]     check_exit_code=check_exit_code)\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]   File \"/usr/lib/python2.7/site-packages/nova/utils.py\", line 163, in execute\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]     return processutils.execute(*cmd, **kwargs)\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/processutils.py\", line 203, in execute\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05]     cmd=sanitized_cmd)\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05] ProcessExecutionError: Unexpected error while running command.\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05] Command: sudo nova-rootwrap /etc/nova/rootwrap.conf iscsiadm -m node -T iqn.2010-10.org.openstack:volume-910e1aab-fcaa-4b77-be12-a303c6216d04 -p 192.168.3.150:3260 --rescan\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05] Exit code: 21\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05] Stdout: u''\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05] Stderr: u'iscsiadm: No session found.\\n'\n2015-02-12 02:26:29.131 4108 TRACE nova.virt.block_device [instance: 3dc0e1ee-96a3-437c-bbe1-74454dc85e05] \n", 
            "date_created": "2015-02-12 01:58:13.590736+00:00", 
            "author": "https://api.launchpad.net/1.0/~julio-5"
        }, 
        {
            "content": "\nThis is an automated cleanup. This bug report has been closed because it\nis older than 18 months and there is no open code change to fix this.\nAfter this time it is unlikely that the circumstances which lead to\nthe observed issue can be reproduced.\n\nIf you can reproduce the bug, please:\n* reopen the bug report (set to status \"New\")\n* AND add the detailed steps to reproduce the issue (if applicable)\n* AND leave a comment \"CONFIRMED FOR: <RELEASE_NAME>\"\n  Only still supported release names are valid (LIBERTY, MITAKA, OCATA, NEWTON).\n  Valid example: CONFIRMED FOR: LIBERTY\n", 
            "date_created": "2016-07-05 09:46:51.703525+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }
    ], 
    "closed": "2016-07-05 09:46:48.684896+00:00"
}