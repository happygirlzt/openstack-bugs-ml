{
    "status": "Won't Fix", 
    "last_updated": "2014-12-03 16:28:13.424640+00:00", 
    "description": "When I lanuch the openstack-nova-compute service, the service break on updating the status.  When the service try to get the disk's size, it read a file which is not exist now, so get the Error. I moved the file '/root/folsom/iso/win7.img' to another directory before I install the openstack.\n\n\u00a0the compute.log is here.\n\n2013-11-25 18:25:52.015 9557 DEBUG nova.virt.libvirt.driver [-] Updating host stats update_status /usr/lib/python2.6/site-p     ackages/nova/virt/libvirt/driver.py:4803\n2068 2013-11-25 18:25:52.016 9557 DEBUG qpid.messaging.io.raw [-] SENT[43c5dd0]: '\\x0f\\x01\\x00\\x19\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x     00\\x04\\n\\x01\\x00\\x07\\x00\\x010\\x00\\x00\\x00\\x00\\x01\\x0f\\x00\\x00\\x1a\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\n\\x01\\x00\\x00\\x08\\x00     \\x00\\x00\\x00\\x00\\x00\\x00\\t' writeable /usr/lib/python2.6/site-packages/qpid/messaging/driver.py:480\n2013-11-25 18:25:52.054 9557 ERROR nova.openstack.common.threadgroup [-] [Errno 13] Permission denied: '/root/folsom/iso/wi     n7.img'\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/openstac     k/common/threadgroup.py\", line 117, in wait\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     x.wait()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/openstac     k/common/threadgroup.py\", line 49, in wait\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/eventlet/gree     nthread.py\", line 166, in wait\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/eventlet/even     t.py\", line 116, in wait\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/eventlet/hubs     /hub.py\", line 177, in switch\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/eventlet/gree     nthread.py\", line 192, in main\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     result = function(*args, **kwargs)\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/openstac     k/common/service.py\", line 65, in run_service\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     service.start()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/service.     py\", line 164, in start\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     self.manager.pre_start_hook()\n\u00a02013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/compute/     manager.py\", line 796, in pre_start_hook\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     self.update_available_resource(nova.context.get_ad     min_context())\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/compute/     manager.py\", line 4860, in update_available_resource\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     nodenames = set(self.driver.get_available_nodes())\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/dri     ver.py\", line 956, in get_available_nodes\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     stats = self.get_host_stats(refresh=refresh)\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4373, in get_host_stats\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return self.host_state.get_host_stats(refresh=refr     esh)\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 386, in host_state\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     self._host_state = HostState(self)\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4773, in __init__\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     self.update_status()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4824, in update_status\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     data['disk_available_least'] = _get_disk_available     _least()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4797, in _get_disk_available_least\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     disk_over_committed = (self.driver.\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4346, in get_disk_over_committed_size_total\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     self.get_instance_disk_info(i_name))\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4318, in get_instance_disk_info\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     dk_size = int(os.path.getsize(path))\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/python2.6/genericpath.py\", line 49,      in getsize\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return os.stat(filename).st_size\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup OSError: [Errno 13] Permission denied: '/root/folsom/i     so/win7.img'\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup\n\nThere are also no domains in the host. I used virsh list command, no result!", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1254667", 
    "owner": "None", 
    "id": 1254667, 
    "index": 5579, 
    "openned": "2013-11-25 10:56:58.817498+00:00", 
    "created": "2013-11-25 10:56:58.817498+00:00", 
    "title": "host state get error", 
    "comments": [
        {
            "content": "When I lanuch the openstack-nova-compute service, the service break on updating the status.  When the service try to get the disk's size, it read a file which is not exist now, so get the Error. I moved the file '/root/folsom/win7.img' to another directory before I install the openstack. \n\n the compute.log is here.\n\n2013-11-25 18:25:52.015 9557 DEBUG nova.virt.libvirt.driver [-] Updating host stats update_status /usr/lib/python2.6/site-p     ackages/nova/virt/libvirt/driver.py:4803\n2068 2013-11-25 18:25:52.016 9557 DEBUG qpid.messaging.io.raw [-] SENT[43c5dd0]: '\\x0f\\x01\\x00\\x19\\x00\\x01\\x00\\x00\\x00\\x00\\x00\\x     00\\x04\\n\\x01\\x00\\x07\\x00\\x010\\x00\\x00\\x00\\x00\\x01\\x0f\\x00\\x00\\x1a\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x02\\n\\x01\\x00\\x00\\x08\\x00     \\x00\\x00\\x00\\x00\\x00\\x00\\t' writeable /usr/lib/python2.6/site-packages/qpid/messaging/driver.py:480\n2013-11-25 18:25:52.054 9557 ERROR nova.openstack.common.threadgroup [-] [Errno 13] Permission denied: '/root/folsom/iso/wi     n7.img'\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/openstac     k/common/threadgroup.py\", line 117, in wait\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     x.wait()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/openstac     k/common/threadgroup.py\", line 49, in wait\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/eventlet/gree     nthread.py\", line 166, in wait\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/eventlet/even     t.py\", line 116, in wait\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/eventlet/hubs     /hub.py\", line 177, in switch\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()                     \n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/eventlet/gree     nthread.py\", line 192, in main\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     result = function(*args, **kwargs)\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/openstac     k/common/service.py\", line 65, in run_service\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     service.start()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/service.     py\", line 164, in start\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     self.manager.pre_start_hook()\n 2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/compute/     manager.py\", line 796, in pre_start_hook\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     self.update_available_resource(nova.context.get_ad     min_context())\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/compute/     manager.py\", line 4860, in update_available_resource\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     nodenames = set(self.driver.get_available_nodes())\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/dri     ver.py\", line 956, in get_available_nodes\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     stats = self.get_host_stats(refresh=refresh)\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4373, in get_host_stats\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return self.host_state.get_host_stats(refresh=refr     esh)\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 386, in host_state\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     self._host_state = HostState(self)\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4773, in __init__\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     self.update_status()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4824, in update_status\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     data['disk_available_least'] = _get_disk_available     _least()\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4797, in _get_disk_available_least\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     disk_over_committed = (self.driver.\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4346, in get_disk_over_committed_size_total\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     self.get_instance_disk_info(i_name))\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.6/site-packages/nova/virt/lib     virt/driver.py\", line 4318, in get_instance_disk_info\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     dk_size = int(os.path.getsize(path))\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/python2.6/genericpath.py\", line 49,      in getsize\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup     return os.stat(filename).st_size\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup OSError: [Errno 13] Permission denied: '/root/folsom/i     so/win7.img'\n2013-11-25 18:25:52.054 9557 TRACE nova.openstack.common.threadgroup", 
            "date_created": "2013-11-25 10:56:58.817498+00:00", 
            "author": "https://api.launchpad.net/1.0/~liuanaqi"
        }, 
        {
            "content": "After I trace the code, I get the reason why this error happens. \nThere is a domain in the host, but it's status is shut off. I checked this domian's block information. \n\n[root@gb31 save]# virsh domblklist win7-liuan\nTarget     Source\n------------------------------------------------\nhda        /var/lib/libvirt/images/win7-liuan.img\nhdc        /root/folsom/iso/win7.img \n\nThis file  \"/root/folsom/iso/win7.img\"  had been moved. So trigger a error!\n\nI think this error as a exception should be catched! \n", 
            "date_created": "2013-11-25 14:06:04.933938+00:00", 
            "author": "https://api.launchpad.net/1.0/~liuanaqi"
        }, 
        {
            "content": "What level of code are you on?  Is this still an issue?", 
            "date_created": "2014-01-29 15:18:15.535819+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "By the way, I marked this as incomplete just because we need more information.  If this is still an issue then please re-open the report.", 
            "date_created": "2014-01-29 15:35:45.478156+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "hi,I also met this error on openstack havana release, just as liuan (liuanaqi) said, this problem was caused by domain's blok, since I created a kvm VM manually by using virsh, which  is out of openstack control, so when I delete the domain, everything is ok!\n\nyou can use \"virsh list --all\" to see the domain name, \nthen\n       virsh undefine domain-name\n       virsh destroy  domain-name\n", 
            "date_created": "2014-06-09 12:55:38.501199+00:00", 
            "author": "https://api.launchpad.net/1.0/~leejian0612"
        }
    ], 
    "closed": "2014-12-03 16:28:11.249697+00:00"
}