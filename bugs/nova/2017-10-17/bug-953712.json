{
    "status": "Invalid", 
    "last_updated": "2012-03-13 10:38:23.201039+00:00", 
    "description": "The implementation for the --force_dhcp_release currently fails on Fedora. When trying to use this flag I'm getting the following error in network.log:\n\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/rpc/amqp.py\", line 252, in _process_data\n(nova.rpc.amqp): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 260, in wrapped\n(nova.rpc.amqp): TRACE:     return func(self, context, *args, **kwargs)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 374, in deallocate_for_instance\n(nova.rpc.amqp): TRACE:     super(FloatingIP, self).deallocate_for_instance(context, **kwargs)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 260, in wrapped\n(nova.rpc.amqp): TRACE:     return func(self, context, *args, **kwargs)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 929, in deallocate_for_instance\n(nova.rpc.amqp): TRACE:     **kwargs)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 250, in deallocate_fixed_ip\n(nova.rpc.amqp): TRACE:     address)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 1219, in deallocate_fixed_ip\n(nova.rpc.amqp): TRACE:     self.driver.release_dhcp(dev, address, vif['address'])\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/linux_net.py\", line 664, in release_dhcp\n(nova.rpc.amqp): TRACE:     utils.execute('dhcp_release', dev, address, mac_address, run_as_root=True)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/utils.py\", line 240, in execute\n(nova.rpc.amqp): TRACE:     cmd=' '.join(cmd))\n(nova.rpc.amqp): TRACE: ProcessExecutionError: Unexpected error while running command.\n(nova.rpc.amqp): TRACE: Command: sudo nova-rootwrap dhcp_release br100 192.168.0.2 fe:16:3e:20:b3:ee\n(nova.rpc.amqp): TRACE: Exit code: 1\n(nova.rpc.amqp): TRACE: Stdout: ''\n(nova.rpc.amqp): TRACE: Stderr: 'Traceback (most recent call last):\\n  File \"/usr/bin/nova-rootwrap\", line 69, in <module>\\n    env=filtermatch.get_environment(userargs))\\n  File \"/usr/lib64/python2.7/subprocess.py\", line 679, in __init__\\n    errread, errwrite)\\n  File \"/usr/lib64/python2.7/subprocess.py\", line 1228, in _execute_child\\n    raise child_exception\\nOSError: [Errno 2] No such file or directory\\n'\n\n----\n\nThe issue seems to be that we need the dnsmasq-utils package? We are essentially missing /usr/bin/dhcp_release which nova currently requires.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/953712", 
    "owner": "None", 
    "id": 953712, 
    "index": 3950, 
    "openned": "2012-03-13 04:46:54.038541+00:00", 
    "created": "2012-03-13 04:46:54.038541+00:00", 
    "title": "force_dhcp_release is currently unsupported on Fedora", 
    "comments": [
        {
            "content": "The implementation for the --force_dhcp_release currently fails on Fedora. When trying to use this flag I'm getting the following error in network.log:\n\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/rpc/amqp.py\", line 252, in _process_data\n(nova.rpc.amqp): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 260, in wrapped\n(nova.rpc.amqp): TRACE:     return func(self, context, *args, **kwargs)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 374, in deallocate_for_instance\n(nova.rpc.amqp): TRACE:     super(FloatingIP, self).deallocate_for_instance(context, **kwargs)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 260, in wrapped\n(nova.rpc.amqp): TRACE:     return func(self, context, *args, **kwargs)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 929, in deallocate_for_instance\n(nova.rpc.amqp): TRACE:     **kwargs)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 250, in deallocate_fixed_ip\n(nova.rpc.amqp): TRACE:     address)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/manager.py\", line 1219, in deallocate_fixed_ip\n(nova.rpc.amqp): TRACE:     self.driver.release_dhcp(dev, address, vif['address'])\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/network/linux_net.py\", line 664, in release_dhcp\n(nova.rpc.amqp): TRACE:     utils.execute('dhcp_release', dev, address, mac_address, run_as_root=True)\n(nova.rpc.amqp): TRACE:   File \"/usr/lib/python2.7/site-packages/nova/utils.py\", line 240, in execute\n(nova.rpc.amqp): TRACE:     cmd=' '.join(cmd))\n(nova.rpc.amqp): TRACE: ProcessExecutionError: Unexpected error while running command.\n(nova.rpc.amqp): TRACE: Command: sudo nova-rootwrap dhcp_release br100 192.168.0.2 fe:16:3e:20:b3:ee\n(nova.rpc.amqp): TRACE: Exit code: 1\n(nova.rpc.amqp): TRACE: Stdout: ''\n(nova.rpc.amqp): TRACE: Stderr: 'Traceback (most recent call last):\\n  File \"/usr/bin/nova-rootwrap\", line 69, in <module>\\n    env=filtermatch.get_environment(userargs))\\n  File \"/usr/lib64/python2.7/subprocess.py\", line 679, in __init__\\n    errread, errwrite)\\n  File \"/usr/lib64/python2.7/subprocess.py\", line 1228, in _execute_child\\n    raise child_exception\\nOSError: [Errno 2] No such file or directory\\n'\n\n----\n\nThe issue seems to be that we need the dnsmasq-utils package? We are essentially missing /usr/bin/dhcp_release which nova currently requires.", 
            "date_created": "2012-03-13 04:46:54.038541+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }, 
        {
            "content": "dhcp_release is an optional command that is part of the dnsmasq source.  Ubuntu packaged it up in dnsmasq-utils, but you could also just add it to the dnmasq package.\n\nLooks like this has been addressed, but possibly it is being installed to a different location?\n\nhttps://bugzilla.redhat.com/show_bug.cgi?id=788485", 
            "date_created": "2012-03-13 05:12:17.081477+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "This is OK in Fedora 17. Fedora 16 is lagging a little because of dnsmasq gating issues.\nI'll close this here so.\nNote it's nice to see the ENOENT error BTW, rather than the previous \"not authorized\" :)", 
            "date_created": "2012-03-13 10:38:22.453593+00:00", 
            "author": "https://api.launchpad.net/1.0/~p-draigbrady"
        }
    ], 
    "closed": "2012-03-13 10:38:13.613050+00:00"
}