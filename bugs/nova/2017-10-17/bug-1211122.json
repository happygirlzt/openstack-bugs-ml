{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 12:00:37.752795+00:00", 
    "description": "When testing support for config drive with vmware, we came across this bug (see comments in https://review.openstack.org/#/c/40029/) This bug was introduced by code in the following review - https://review.openstack.org/#/c/37964/14\n\n\n    2013-08-10 11:13:06.190 ERROR nova.virt.vmwareapi.vmops [req-fd4731e0-9c27-49f0-8c8c-ab577e032063 demo demo] [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] Creating config drive failed with error: '2012-08-10' is not in list \n    2013-08-10 11:13:06.192 ERROR nova.compute.manager [req-fd4731e0-9c27-49f0-8c8c-ab577e032063 demo demo] [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] Instance failed to spawn \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] Traceback (most recent call last): \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/compute/manager.py\", line 1353, in _spawn \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] block_device_info) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 203, in spawn \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] admin_password, network_info, block_device_info) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 427, in spawn \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] cookies) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 490, in _create_config_drive \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] e, instance=instance) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 471, in _create_config_drive \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] with configdrive.ConfigDriveBuilder(instance_md=inst_md) as cdb: \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/configdrive.py\", line 75, in __init__ \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] self.add_instance_metadata(instance_md) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/configdrive.py\", line 96, in add_instance_metadata \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] for (path, value) in instance_md.metadata_for_config_drive(): \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/api/metadata/base.py\", line 426, in metadata_for_config_drive \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] if self._check_version(HAVANA, version): \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/api/metadata/base.py\", line 344, in _check_version \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] return versions.index(requested) >= versions.index(required) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] ValueError: '2012-08-10' is not in list \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] \n    2013-08-10 11:13:06.226 DEBUG nova.compute.claims [req-fd4731e0-9c27-49f0-8c8c-ab577e032063 demo demo] [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] Aborting claim: [Claim: 512 MB memo", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 22, 
    "link": "https://bugs.launchpad.net/nova/+bug/1211122", 
    "owner": "https://api.launchpad.net/1.0/~dims-v", 
    "id": 1211122, 
    "index": 5214, 
    "openned": "2013-08-12 01:39:53.689225+00:00", 
    "created": "2013-08-12 01:39:53.689225+00:00", 
    "title": "vendor_data blueprint causes ValueError", 
    "comments": [
        {
            "content": "When testing support for config drive with vmware, we came across this bug (see comments in https://review.openstack.org/#/c/40029/) This bug was introduced by code in the following review - https://review.openstack.org/#/c/37964/14\n\n\n    2013-08-10 11:13:06.190 ERROR nova.virt.vmwareapi.vmops [req-fd4731e0-9c27-49f0-8c8c-ab577e032063 demo demo] [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] Creating config drive failed with error: '2012-08-10' is not in list \n    2013-08-10 11:13:06.192 ERROR nova.compute.manager [req-fd4731e0-9c27-49f0-8c8c-ab577e032063 demo demo] [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] Instance failed to spawn \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] Traceback (most recent call last): \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/compute/manager.py\", line 1353, in _spawn \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] block_device_info) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 203, in spawn \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] admin_password, network_info, block_device_info) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 427, in spawn \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] cookies) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 490, in _create_config_drive \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] e, instance=instance) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/vmwareapi/vmops.py\", line 471, in _create_config_drive \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] with configdrive.ConfigDriveBuilder(instance_md=inst_md) as cdb: \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/configdrive.py\", line 75, in __init__ \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] self.add_instance_metadata(instance_md) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/virt/configdrive.py\", line 96, in add_instance_metadata \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] for (path, value) in instance_md.metadata_for_config_drive(): \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/api/metadata/base.py\", line 426, in metadata_for_config_drive \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] if self._check_version(HAVANA, version): \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] File \"/opt/stack/nova/nova/api/metadata/base.py\", line 344, in _check_version \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] return versions.index(requested) >= versions.index(required) \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] ValueError: '2012-08-10' is not in list \n    2013-08-10 11:13:06.192 TRACE nova.compute.manager [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] \n    2013-08-10 11:13:06.226 DEBUG nova.compute.claims [req-fd4731e0-9c27-49f0-8c8c-ab577e032063 demo demo] [instance: 523d647a-f8c3-4578-84a2-44bd361dbd24] Aborting claim: [Claim: 512 MB memo", 
            "date_created": "2013-08-12 01:39:53.689225+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/41324", 
            "date_created": "2013-08-12 01:45:46.539237+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "thank you.\n", 
            "date_created": "2013-08-14 19:14:19.030769+00:00", 
            "author": "https://api.launchpad.net/1.0/~smoser"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/41324\nCommitted: http://github.com/openstack/nova/commit/64fe85d526c7a8f88193b41edd4067a6d44c0dc0\nSubmitter: Jenkins\nBranch:    master\n\ncommit 64fe85d526c7a8f88193b41edd4067a6d44c0dc0\nAuthor: Davanum Srinivas <email address hidden>\nDate:   Sun Aug 11 21:41:58 2013 -0400\n\n    Fix bad check for openstack versions (vendor_data/config drive)\n    \n    Looks like the lack of a test case sneaked in this bug. Added a\n    simple one that just ensures that we can get a list of all the\n    metadata information. Basic issue was that the check_version\n    was checking against ec2 versions. Changed it to check OpenStack\n    version including the 'latest'.\n    \n    Fixes bug #1211122\n    \n    Change-Id: Ifac7659467b81abcffd3f84a24292c11f2e058fc\n", 
            "date_created": "2013-08-15 13:26:53.008265+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-09-05 15:45:05.868860+00:00"
}