{
    "status": "Fix Released", 
    "last_updated": "2014-10-16 08:46:02.154472+00:00", 
    "description": "Seeing this in conductor logs when migrating a VM with a floating IP assigned:\n\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     incoming.message))\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/conductor/manager.py\", line 1019, in network_migrate_instance_start\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     migration)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/conductor/manager.py\", line 527, in network_migrate_instance_start\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     self.network_api.migrate_instance_start(context, instance, migration)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/network/api.py\", line 94, in wrapped\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     return func(self, context, *args, **kwargs)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/network/api.py\", line 543, in migrate_instance_start\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     self.network_rpcapi.migrate_instance_start(context, **args)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/network/rpcapi.py\", line 350, in migrate_instance_start\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     floating_addresses=floating_addresses)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/client.py\", line 150, in call\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     wait_for_reply=True, timeout=timeout)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/transport.py\", line 90, in _send\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     timeout=timeout)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/_drivers/amqpdriver.py\", line 409, in send\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     return self._send(target, ctxt, message, wait_for_reply, timeout)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/_drivers/amqpdriver.py\", line 402, in _send\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     raise result\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher AttributeError: 'FixedIP' object has no attribute '_sa_instance_state'", 
    "tags": [
        "icehouse-backport-potential", 
        "in-stable-icehouse", 
        "migration", 
        "nova", 
        "ops", 
        "unified-objects"
    ], 
    "importance": "High", 
    "heat": 36, 
    "link": "https://bugs.launchpad.net/nova/+bug/1334164", 
    "owner": "https://api.launchpad.net/1.0/~danms", 
    "id": 1334164, 
    "index": 1521, 
    "openned": "2014-06-25 08:54:54.176923+00:00", 
    "created": "2014-06-25 08:54:54.176923+00:00", 
    "title": "nova error migrating VMs with floating ips: 'FixedIP' object has no attribute '_sa_instance_state'", 
    "comments": [
        {
            "content": "Seeing this in conductor logs when migrating a VM with a floating IP assigned:\n\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     incoming.message))\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/conductor/manager.py\", line 1019, in network_migrate_instance_start\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     migration)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/conductor/manager.py\", line 527, in network_migrate_instance_start\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     self.network_api.migrate_instance_start(context, instance, migration)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/network/api.py\", line 94, in wrapped\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     return func(self, context, *args, **kwargs)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/network/api.py\", line 543, in migrate_instance_start\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     self.network_rpcapi.migrate_instance_start(context, **args)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/network/rpcapi.py\", line 350, in migrate_instance_start\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     floating_addresses=floating_addresses)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/client.py\", line 150, in call\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     wait_for_reply=True, timeout=timeout)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/transport.py\", line 90, in _send\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     timeout=timeout)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/_drivers/amqpdriver.py\", line 409, in send\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     return self._send(target, ctxt, message, wait_for_reply, timeout)\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/_drivers/amqpdriver.py\", line 402, in _send\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher     raise result\n2014-06-23 09:22:38.899 20314 TRACE oslo.messaging.rpc.dispatcher AttributeError: 'FixedIP' object has no attribute '_sa_instance_state'", 
            "date_created": "2014-06-25 08:54:54.176923+00:00", 
            "author": "https://api.launchpad.net/1.0/~rpodolyaka"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/102514", 
            "date_created": "2014-06-25 12:46:33.893264+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "That  fix did get past the sa_instance_state problem, but I bumped into something new.  It looks like floating_ip_update() doesn't like the SA fixed ip that's fetched here:\n\n+            updates['fixed_ip'] = db.fixed_ip_get(context, id_)\n\nI'm not sure what \"A conflicting state is already present in the identity map\" means.  Is there another way to fetch the fixed ip?\n\nTraceback:\n\nJun 25 17:30:21 10.35.0.14 nova-network 2014-06-25 17:30:21.764 4992 ERROR oslo.messaging.rpc.dispatcher [-] Exception during message handling: A conflicting state is already present in the identity map for key (<class 'nova.db.sqlalchemy.models.FixedIp'>, (3L,))\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/nova/network/floating_ips.py\", line 575, in migrate_instance_start\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/nova/objects/base.py\", line 151, in wrapper\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/nova/objects/floating_ip.py\", line 135, in save\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/nova/db/api.py\", line 386, in floating_ip_update\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 164, in wrapper\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 1024, in floating_ip_update\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/nova/openstack/common/db/sqlalchemy/models.py\", line 88, in update\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/attributes.py\", line 220, in __set__\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/attributes.py\", line 780, in set\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/attributes.py\", line 801, in fire_replace_event\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/unitofwork.py\", line 87, in set_\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1490, in _save_or_update_state\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1746, in _save_or_update_impl\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1739, in _update_impl\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/identity.py\", line 119, in add\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher AssertionError: A conflicting state is already present in the identity map for key (<class 'nova.db.sqlalchemy.models.FixedIp'>, (3L,))\n2014-06-25 17:30:21.764 4992 TRACE oslo.messaging.rpc.dispatcher \nJun 25 17:30:21 10.35.0.14 nova-network 2014-06-25 17:30:21.765 4992 ERROR oslo.messaging._drivers.common [-] Returning exception A conflicting state is already present in the identity map for key (<class 'nova.db.sqlalchemy.models.FixedIp'>, (3L,)) to caller\nJun 25 17:30:21 10.35.0.14 nova-network 2014-06-25 17:30:21.766 4992 ERROR oslo.messaging._drivers.common [-] ['Traceback (most recent call last):\\n', '  File \"/usr/lib64/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\\n', '  File \"/usr/lib64/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\\n', '  File \"/usr/lib64/python2.7/site-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\\n', '  File \"/usr/lib64/python2.7/site-packages/nova/network/floating_ips.py\", line 575, in migrate_instance_start\\n', '  File \"/usr/lib64/python2.7/site-packages/nova/objects/base.py\", line 151, in wrapper\\n', '  File \"/usr/lib64/python2.7/site-packages/nova/objects/floating_ip.py\", line 135, in save\\n', '  File \"/usr/lib64/python2.7/site-packages/nova/db/api.py\", line 386, in floating_ip_update\\n', '  File \"/usr/lib64/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 164, in wrapper\\n', '  File \"/usr/lib64/python2.7/site-packages/nova/db/sqlalchemy/api.py\", line 1024, in floating_ip_update\\n', '  File \"/usr/lib64/python2.7/site-packages/nova/openstack/common/db/sqlalchemy/models.py\", line 88, in update\\n', '  File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/attributes.py\", line 220, in __set__\\n', '  File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/attributes.py\", line 780, in set\\n', '  File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/attributes.py\", line 801, in fire_replace_event\\n', '  File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/unitofwork.py\", line 87, in set_\\n', '  File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1490, in _save_or_update_state\\n', '  File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1746, in _save_or_update_impl\\n', '  File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1739, in _update_impl\\n', '  File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/identity.py\", line 119, in add\\n', \"AssertionError: A conflicting state is already present in the identity map for key (<class 'nova.db.sqlalchemy.models.FixedIp'>, (3L,))\\n\"]\nJun 25 17:30:21 10.35.0.14 nova-network.log: /usr/lib64/python2.7/site-packages/amqp/channel.py:616: VDeprecationWarning: The auto_delete flag for exchanges has been deprecated and will be removed\nJun 25 17:30:21 10.35.0.14 nova-network.log: from py-amqp v1.5.0.\nJun 25 17:30:21 10.35.0.14 nova-network.log: /usr/lib64/python2.7/site-packages/amqp/channel.py:616: VDeprecationWarning: The auto_delete flag for exchanges has been deprecated and will be removed\nJun 25 17:30:21 10.35.0.14 nova-network.log: from py-amqp v1.5.0.\n", 
            "date_created": "2014-06-25 21:38:59.976484+00:00", 
            "author": "https://api.launchpad.net/1.0/~noelbk"
        }, 
        {
            "content": "This fix worked for me, but it seems ugly to have a special case for a field by name.  Is there a less hard-coded way to do this?\n\n    def save(self, context):\n        ...\n        if 'fixed_ip' in updates:\n            updates['fixed_ip'].save(context)\n            del(updates['fixed_ip'])\n\n", 
            "date_created": "2014-06-25 21:46:21.541585+00:00", 
            "author": "https://api.launchpad.net/1.0/~noelbk"
        }, 
        {
            "content": "Fixed in https://gerrit.mirantis.com/#/c/17107/", 
            "date_created": "2014-07-01 18:50:16.855474+00:00", 
            "author": "https://api.launchpad.net/1.0/~rpodolyaka"
        }, 
        {
            "content": "Fix released for 5.0.1, verified on iso # 88", 
            "date_created": "2014-07-03 10:04:04.525740+00:00", 
            "author": "https://api.launchpad.net/1.0/~apanchenko-8"
        }, 
        {
            "content": "Should this be in the Release Notes list of Fixed Issues?  If so, did the customer see any functional problems or is it just the log errors?", 
            "date_created": "2014-07-10 09:11:41.835251+00:00", 
            "author": "https://api.launchpad.net/1.0/~dreidellhasa"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/109310", 
            "date_created": "2014-07-24 14:47:00.575693+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/109310\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=48de2895b9a550a0944b31212349275605a4061d\nSubmitter: Jenkins\nBranch:    master\n\ncommit 48de2895b9a550a0944b31212349275605a4061d\nAuthor: Dan Smith <email address hidden>\nDate:   Thu Jul 24 07:35:27 2014 -0700\n\n    Fix FloatingIP.save() passing FixedIP object to sqlalchemy\n    \n    This prevents the FloatingIP.save() method from passing the\n    calculated FixedIP object to the sqlalchemy floating_ip_update()\n    function, which would expect it to be an SA object. It also\n    aborts any attempt to save the object with a modified fixed_ip_id\n    linkage, as associate/disassociate should be used for that.\n    \n    This also fixes a bug where FloatingIP expects the result of\n    floating_ip_update() to be a FloatingIp SA object.\n    \n    Change-Id: I065caedf4d81c8583a3b390934a1d403cf2e87bd\n    Closes-bug: #1334164\n", 
            "date_created": "2014-07-25 03:19:10.307315+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Roman Podoliaka (<email address hidden>) on branch: master\nReview: https://review.openstack.org/102514", 
            "date_created": "2014-07-25 07:30:34.621321+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/icehouse\nReview: https://review.openstack.org/112184", 
            "date_created": "2014-08-06 03:41:01.085214+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "after applying patch still getting the following error: \n\n2014-08-13 20:25:58.387 12971 ERROR nova.openstack.common.loopingcall [-] in fixed duration looping call\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall Traceback (most recent call last):\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/loopingcall.py\", line 78, in _inner\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     self.f(*self.args, **self.kw)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 4518, in wait_for_live_migration\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     migrate_data)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 88, in wrapped\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     payload)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 71, in wrapped\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return f(self, context, *args, **kw)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 303, in decorated_function\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     e, sys.exc_info())\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     six.reraise(self.type_, self.value, self.tb)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 290, in decorated_function\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return function(self, context, *args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 4618, in _post_live_migration\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     migration)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/conductor/api.py\", line 254, in network_migrate_instance_start\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     migration)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/conductor/rpcapi.py\", line 384, in network_migrate_instance_start\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     instance=instance_p, migration=migration_p)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/client.py\", line 150, in call\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     wait_for_reply=True, timeout=timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/transport.py\", line 90, in _send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     timeout=timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 412, in send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return self._send(target, ctxt, message, wait_for_reply, timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 405, in _send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     raise result\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall AttributeError: 'FixedIP' object has no attribute '_sa_instance_state'\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall Traceback (most recent call last):\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/conductor/manager.py\", line 597, in _object_dispatch\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return getattr(target, method)(context, *args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/objects/base.py\", line 151, in wrapper\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return fn(self, ctxt, *args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/objects/floating_ip.py\", line 128, in save\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     updates)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 386, in floating_ip_update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return IMPL.floating_ip_update(context, address, values)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 164, in wrapper\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return f(*args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 1024, in floating_ip_update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     float_ip_ref.update(values)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/db/sqlalchemy/models.py\", line 88, in update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     setattr(self, k, v)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 303, in __set__\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     instance_dict(instance), value, None)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 804, in set\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     value = self.fire_replace_event(state, dict_, value, old, initiator)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 824, in fire_replace_event\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     value = fn(state, value, previous, initiator or self)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/unitofwork.py\", line 85, in set_\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     newvalue_state = attributes.instance_state(newvalue)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall AttributeError: 'FixedIP' object has no attribute '_sa_instance_state'\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall Traceback (most recent call last):\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     incoming.message))\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/network/floating_ips.py\", line 575, in migrate_instance_start\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     floating_ip.save()\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/objects/base.py\", line 142, in wrapper\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     ctxt, self, fn.__name__, args, kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/conductor/rpcapi.py\", line 430, in object_action\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     objmethod=objmethod, args=args, kwargs=kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/client.py\", line 150, in call\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     wait_for_reply=True, timeout=timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/transport.py\", line 90, in _send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     timeout=timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 412, in send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return self._send(target, ctxt, message, wait_for_reply, timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 405, in _send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     raise result\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall AttributeError: 'FixedIP' object has no attribute '_sa_instance_state'\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall Traceback (most recent call last):\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/conductor/manager.py\", line 597, in _object_dispatch\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return getattr(target, method)(context, *args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/objects/base.py\", line 151, in wrapper\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return fn(self, ctxt, *args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/objects/floating_ip.py\", line 128, in save\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     updates)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 386, in floating_ip_update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return IMPL.floating_ip_update(context, address, values)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 164, in wrapper\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return f(*args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 1024, in floating_ip_update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     float_ip_ref.update(values)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/db/sqlalchemy/models.py\", line 88, in update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     setattr(self, k, v)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 303, in __set__\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     instance_dict(instance), value, None)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 804, in set\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     value = self.fire_replace_event(state, dict_, value, old, initiator)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 824, in fire_replace_event\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     value = fn(state, value, previous, initiator or self)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/unitofwork.py\", line 85, in set_\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     newvalue_state = attributes.instance_state(newvalue)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall AttributeError: 'FixedIP' object has no attribute '_sa_instance_state'\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall Traceback (most recent call last):\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     incoming.message))\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/conductor/manager.py\", line 1019, in network_migrate_instance_start\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     migration)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/conductor/manager.py\", line 527, in network_migrate_instance_start\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     self.network_api.migrate_instance_start(context, instance, migration)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/network/api.py\", line 94, in wrapped\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return func(self, context, *args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/network/api.py\", line 543, in migrate_instance_start\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     self.network_rpcapi.migrate_instance_start(context, **args)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/network/rpcapi.py\", line 350, in migrate_instance_start\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     floating_addresses=floating_addresses)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/client.py\", line 150, in call\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     wait_for_reply=True, timeout=timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/transport.py\", line 90, in _send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     timeout=timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 409, in send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return self._send(target, ctxt, message, wait_for_reply, timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 402, in _send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     raise result\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall AttributeError: 'FixedIP' object has no attribute '_sa_instance_state'\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall Traceback (most recent call last):\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/conductor/manager.py\", line 597, in _object_dispatch\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return getattr(target, method)(context, *args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/objects/base.py\", line 151, in wrapper\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return fn(self, ctxt, *args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/objects/floating_ip.py\", line 128, in save\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     updates)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 386, in floating_ip_update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return IMPL.floating_ip_update(context, address, values)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 164, in wrapper\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return f(*args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 1024, in floating_ip_update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     float_ip_ref.update(values)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/db/sqlalchemy/models.py\", line 88, in update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     setattr(self, k, v)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 303, in __set__\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     instance_dict(instance), value, None)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 804, in set\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     value = self.fire_replace_event(state, dict_, value, old, initiator)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 824, in fire_replace_event\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     value = fn(state, value, previous, initiator or self)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/unitofwork.py\", line 85, in set_\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     newvalue_state = attributes.instance_state(newvalue)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall AttributeError: 'FixedIP' object has no attribute '_sa_instance_state'\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall Traceback (most recent call last):\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     incoming.message))\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/network/floating_ips.py\", line 575, in migrate_instance_start\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     floating_ip.save()\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/objects/base.py\", line 142, in wrapper\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     ctxt, self, fn.__name__, args, kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/conductor/rpcapi.py\", line 430, in object_action\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     objmethod=objmethod, args=args, kwargs=kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/client.py\", line 150, in call\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     wait_for_reply=True, timeout=timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/transport.py\", line 90, in _send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     timeout=timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 412, in send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return self._send(target, ctxt, message, wait_for_reply, timeout)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/_drivers/amqpdriver.py\", line 405, in _send\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     raise result\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall AttributeError: 'FixedIP' object has no attribute '_sa_instance_state'\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall Traceback (most recent call last):\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/conductor/manager.py\", line 597, in _object_dispatch\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return getattr(target, method)(context, *args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/objects/base.py\", line 151, in wrapper\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return fn(self, ctxt, *args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/objects/floating_ip.py\", line 128, in save\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     updates)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 386, in floating_ip_update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return IMPL.floating_ip_update(context, address, values)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 164, in wrapper\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     return f(*args, **kwargs)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 1024, in floating_ip_update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     float_ip_ref.update(values)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/db/sqlalchemy/models.py\", line 88, in update\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     setattr(self, k, v)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 303, in __set__\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     instance_dict(instance), value, None)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 804, in set\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     value = self.fire_replace_event(state, dict_, value, old, initiator)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/attributes.py\", line 824, in fire_replace_event\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     value = fn(state, value, previous, initiator or self)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/unitofwork.py\", line 85, in set_\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall     newvalue_state = attributes.instance_state(newvalue)\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall AttributeError: 'FixedIP' object has no attribute '_sa_instance_state'\n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n2014-08-13 20:25:58.387 12971 TRACE nova.openstack.common.loopingcall \n", 
            "date_created": "2014-08-13 17:30:38.103437+00:00", 
            "author": "https://api.launchpad.net/1.0/~lev4ykaol"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/112184\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=526853ea2058a9fb650ae2f34bc0404f4438b34e\nSubmitter: Jenkins\nBranch:    stable/icehouse\n\ncommit 526853ea2058a9fb650ae2f34bc0404f4438b34e\nAuthor: Dan Smith <email address hidden>\nDate:   Thu Jul 24 07:35:27 2014 -0700\n\n    Fix FloatingIP.save() passing FixedIP object to sqlalchemy\n    \n    This prevents the FloatingIP.save() method from passing the\n    calculated FixedIP object to the sqlalchemy floating_ip_update()\n    function, which would expect it to be an SA object. It also\n    aborts any attempt to save the object with a modified fixed_ip_id\n    linkage, as associate/disassociate should be used for that.\n    \n    This also fixes a bug where FloatingIP expects the result of\n    floating_ip_update() to be a FloatingIp SA object.\n    \n    Added missing import to allow tests to work in stable/icehouse.\n    \n    Change-Id: I065caedf4d81c8583a3b390934a1d403cf2e87bd\n    Closes-bug: #1334164\n    (cherry picked from commit 48de2895b9a550a0944b31212349275605a4061d)\n", 
            "date_created": "2014-08-29 01:16:59.011971+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2014-09-05 09:48:24.079114+00:00"
}