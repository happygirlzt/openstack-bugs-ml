{
    "status": "Fix Released", 
    "last_updated": "2017-10-11 14:39:00.569335+00:00", 
    "description": "Since my upgrade from juno to kilo I have a lot of WARNING in my compute.log\n\n[root@Compute ~]# rpm -qa | grep nova\npython-nova-2015.1.1-1.el7.noarch\nopenstack-nova-common-2015.1.1-1.el7.noarch\npython-novaclient-2.23.0-1.el7.noarch\nopenstack-nova-compute-2015.1.1-1.el7.noarch\n\n[root@Compute ~]# rpm -qa | grep oslo\npython-oslo-concurrency-1.8.0-1.el7.noarch\npython-oslo-log-1.0.0-1.el7.noarch\npython-oslo-rootwrap-1.6.0-1.el7.noarch\npython-oslo-messaging-1.8.3-1.el7.noarch\npython-oslo-config-1.9.3-1.el7.noarch\npython-oslo-serialization-1.4.0-1.el7.noarch\npython-oslo-vmware-0.11.1-1.el7.noarch\npython-oslo-utils-1.4.0-1.el7.noarch\npython-oslo-middleware-1.0.0-2.el7.noarch\npython-oslo-db-1.7.1-1.el7.noarch\npython-oslo-i18n-1.5.0-3.el7.noarch\npython-oslo-context-0.2.0-5.el7.noarch\n\n\n2015-09-10 15:46:13.393 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.398 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.403 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.410 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.414 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.420 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.427 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.432 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.436 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.501 7825 WARNING oslo_messaging._drivers.amqpdriver [-] Number of call queues is greater than warning threshold: 10. There could be a leak. Increasing threshold to: 20\n2015-09-10 15:46:13.621 7825 WARNING oslo_messaging._drivers.amqpdriver [-] Number of call queues is greater than warning threshold: 20. There could be a leak. Increasing threshold to: 40\n2015-09-10 15:46:13.659 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.663 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.668 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.675 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.679 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.688 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.151 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.156 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.161 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.167 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.174 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.179 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.186 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.190 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.196 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.200 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.210 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.215 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.220 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.227 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.233 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.238 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.342 7825 WARNING oslo_messaging._drivers.amqpdriver [-] Number of call queues is greater than warning threshold: 40. There could be a leak. Increasing threshold to: 80\n2015-09-10 15:46:14.347 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.352 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.356 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.360 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.364 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.369 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.373 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.377 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.384 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.391 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.396 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.401 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local", 
    "tags": [
        "openstack-version.kilo", 
        "vmware"
    ], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1494688", 
    "owner": "https://api.launchpad.net/1.0/~rgerganov", 
    "id": 1494688, 
    "index": 7028, 
    "openned": "2015-09-11 10:05:18.921093+00:00", 
    "created": "2015-09-11 10:05:18.921093+00:00", 
    "title": "[VMWARE] Connection pool is full, discarding connection", 
    "comments": [
        {
            "content": "Since my upgrade from juno to kilo I have a lot of WARNING in my compute.log\n\n[root@Compute ~]# rpm -qa | grep nova\npython-nova-2015.1.1-1.el7.noarch\nopenstack-nova-common-2015.1.1-1.el7.noarch\npython-novaclient-2.23.0-1.el7.noarch\nopenstack-nova-compute-2015.1.1-1.el7.noarch\n\n[root@Compute ~]# rpm -qa | grep oslo\npython-oslo-concurrency-1.8.0-1.el7.noarch\npython-oslo-log-1.0.0-1.el7.noarch\npython-oslo-rootwrap-1.6.0-1.el7.noarch\npython-oslo-messaging-1.8.3-1.el7.noarch\npython-oslo-config-1.9.3-1.el7.noarch\npython-oslo-serialization-1.4.0-1.el7.noarch\npython-oslo-vmware-0.11.1-1.el7.noarch\npython-oslo-utils-1.4.0-1.el7.noarch\npython-oslo-middleware-1.0.0-2.el7.noarch\npython-oslo-db-1.7.1-1.el7.noarch\npython-oslo-i18n-1.5.0-3.el7.noarch\npython-oslo-context-0.2.0-5.el7.noarch\n\n\n2015-09-10 15:46:13.393 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.398 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.403 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.410 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.414 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.420 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.427 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.432 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.436 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.501 7825 WARNING oslo_messaging._drivers.amqpdriver [-] Number of call queues is greater than warning threshold: 10. There could be a leak. Increasing threshold to: 20\n2015-09-10 15:46:13.621 7825 WARNING oslo_messaging._drivers.amqpdriver [-] Number of call queues is greater than warning threshold: 20. There could be a leak. Increasing threshold to: 40\n2015-09-10 15:46:13.659 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.663 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.668 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.675 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.679 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:13.688 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.151 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.156 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.161 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.167 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.174 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.179 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.186 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.190 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.196 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.200 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.210 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.215 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.220 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.227 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.233 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.238 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.342 7825 WARNING oslo_messaging._drivers.amqpdriver [-] Number of call queues is greater than warning threshold: 40. There could be a leak. Increasing threshold to: 80\n2015-09-10 15:46:14.347 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.352 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.356 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.360 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.364 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.369 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.373 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.377 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.384 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.391 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.396 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n2015-09-10 15:46:14.401 7825 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local", 
            "date_created": "2015-09-11 10:05:18.921093+00:00", 
            "author": "https://api.launchpad.net/1.0/~kodokuu"
        }, 
        {
            "content": "We made the size of the connection pool configurable with this patch:\n\nhttps://github.com/openstack/oslo.vmware/commit/0fdb00522a1a6e0d9c645ac68c6dc092d6de7088\n\nThe default size is also increased to 10. The patch is included in oslo.vmware versions >= 1.20.0", 
            "date_created": "2015-10-28 10:52:12.799963+00:00", 
            "author": "https://api.launchpad.net/1.0/~rgerganov"
        }, 
        {
            "content": "Kevin - can you try with the above change to see if it helps your situation?", 
            "date_created": "2015-12-01 18:18:25.758475+00:00", 
            "author": "https://api.launchpad.net/1.0/~tjones-i"
        }, 
        {
            "content": "@< kodokuu> can you try with the above change to see if it helps your situation?", 
            "date_created": "2015-12-01 18:21:05.498453+00:00", 
            "author": "https://api.launchpad.net/1.0/~tjones-i"
        }, 
        {
            "content": "I change all files like api.py :\n\n    def __init__(self, host, server_username, server_password,\n                 api_retry_count, task_poll_interval, scheme='https',\n                 create_session=True, wsdl_loc=None, pbm_wsdl_loc=None,\n                 port=443, cacert=None, insecure=True, pool_size=150):\n\nBut always trace ==>\n\n2016-01-20 11:26:20.097 26864 WARNING requests.packages.urllib3.connectionpool [-] Connection pool is full, discarding connection: vcenter01.local\n", 
            "date_created": "2016-01-20 10:38:59.208125+00:00", 
            "author": "https://api.launchpad.net/1.0/~kodokuu"
        }, 
        {
            "content": "Hi, Radoslav Gerganov\noslo.vmware side changes does not take effect. It also needs change in Nova side, I had made a patch for this:\n\nhttps://review.openstack.org/#/c/265346/\n", 
            "date_created": "2016-02-26 06:10:24.577485+00:00", 
            "author": "https://api.launchpad.net/1.0/~hellochosen"
        }, 
        {
            "content": "Change abandoned by Dongcan Ye (<email address hidden>) on branch: master\nReview: https://review.openstack.org/265346", 
            "date_created": "2016-07-08 02:30:49.099530+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/414085", 
            "date_created": "2016-12-22 12:47:34.314234+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Automatically discovered version kilo in description. If this is incorrect, please update the description to include 'nova version: ...'", 
            "date_created": "2017-06-27 15:54:54.129378+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/414085\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=d5c29e1be5ff12045c6dd324ca73509a5213adc3\nSubmitter: Jenkins\nBranch:    master\n\ncommit d5c29e1be5ff12045c6dd324ca73509a5213adc3\nAuthor: Jay Jahns <email address hidden>\nDate:   Thu Dec 22 04:43:17 2016 -0800\n\n    Add connection pool size to vSphere settings\n    \n    In larger environments, the default value of 10 for the HTTP connection\n    pool is insufficient as Nova will begin to warn user that the pool\n    is full and begin discarding connections.\n    \n    This change adds the ability to configure the connection_pool_size in\n    Nova.  The default is 10 and the minimum value is also 10.\n    \n    Closes-Bug: #1494688\n    Co-Authored-By: <email address hidden>\n    Change-Id: I2990899b467ac86664e1b2859f8a190aba7c2905\n", 
            "date_created": "2017-10-11 14:38:59.821379+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2017-10-11 14:38:56.000320+00:00"
}