{
    "status": "Invalid", 
    "last_updated": "2015-07-08 07:07:38.999478+00:00", 
    "description": "Context and information:\n--------------------------------------\nCurrently, 404 is seen by the user when \"image-delete\" call is made via the Glance API or through the Images API of Nova for an Image in \"deleted\" status.\n\nHowever, if an Image is in \"pending_delete\" and a user with the UUID of that Image tries \"image-delete\" call from the Nova API, she gets a back a 403 which is not consistent. The user should get a 404 back.\n\nNotes:\n----------\n* The user needs to specify the UUID, name is not sufficient.\n* For \"image-show\" call the user is able to see the Image in DELETED status with the appropriate metadata for Image in \"deleted\" or \"pending_delete\" status in Glance as nova passes-in the force_show_deleted=True flag by default.\n\nFeedback needed and action to be taken:\n---------------------------------------------------------------\nNova should be able to return a 404 back to the user while issuing a \"image-delete\" call if the Image is flagged deleted in the Glance DB (deleted=True), irrespective of the Image status in \"deleted\" or \"pending_delete\".", 
    "tags": [], 
    "importance": "Low", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1446326", 
    "owner": "https://api.launchpad.net/1.0/~sbiswas7", 
    "id": 1446326, 
    "index": 1696, 
    "openned": "2015-04-20 18:01:15.369374+00:00", 
    "created": "2015-04-20 18:00:58.456442+00:00", 
    "title": "403 response from Nova when making a DELETE call for an image in pending_delete", 
    "comments": [
        {
            "content": "Context and information:\n--------------------------------------\nCurrently, 404 is seen by the user when \"image-delete\" call is made via the Glance API or through the Images API of Nova for an Image in \"deleted\" status.\n\nHowever, if an Image is in \"pending_delete\" and a user with the UUID of that Image tries \"image-delete\" call from the Nova API, she gets a back a 403 which is not consistent. The user should get a 404 back.\n\nNotes:\n----------\n* The user needs to specify the UUID, name is not sufficient.\n* For \"image-show\" call the user is able to see the Image in DELETED status with the appropriate metadata for Image in \"deleted\" or \"pending_delete\" status in Glance as nova passed in force_show_deleted flag by default.\n\nFeedback needed and action to be taken:\n---------------------------------------------------------------\nNova should be able to return a 404 back to the user while issuing a \"image-delete\" call if the Image is flagged deleted in the Glance DB (deleted=True), irrespective of the Image status in \"deleted\" or \"pending_delete\".", 
            "date_created": "2015-04-20 18:00:58.456442+00:00", 
            "author": "https://api.launchpad.net/1.0/~nikhil-komawar"
        }, 
        {
            "content": "change error code should be fine , no backward compatible issue exist", 
            "date_created": "2015-04-21 12:35:17.794725+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }, 
        {
            "content": "Hi Nikhil, it appears to me that the error code 404 or 403 - is being generated by  glance-api  irrespective of whether the call is being made through nova api or via the glance api for image-delete.\nI set the delayed_delete to True in the glance-api.conf file to simulate this.\n\nThe fix IMHO should be in the glance/v1/images.py and that should fix it for either of the scenarios. \nI plan to post a Patch set for the same. Meanwhile, please let me know if you think otherwise.\n", 
            "date_created": "2015-04-24 10:16:08.527688+00:00", 
            "author": "https://api.launchpad.net/1.0/~sbiswas7"
        }, 
        {
            "content": "Hi Sudipta,\n\nThanks for getting back on this. The proposed change path looks good.\n\nA quick note though:\nGlance does generate a 404 on deleted images however you can see the image state if nova passes in a force_show_deleted flag. That being said we may have multiple cases when an inconsistent response is being seen by the user but that's purely my speculation at this point. I haven't had chance to further dig into this but if you help test it (your fix) across both APIs, that would be awesome.\n\nThanks.", 
            "date_created": "2015-04-24 13:58:44.145592+00:00", 
            "author": "https://api.launchpad.net/1.0/~nikhil-komawar"
        }, 
        {
            "content": "It appears that nova relies completely on glance for the error code and hence the fix at one point in glance is enough to fix this bug. Marking this nova side of the fix as 'Invalid' post chatting with Nikhil on IRC.", 
            "date_created": "2015-04-24 15:06:50.196294+00:00", 
            "author": "https://api.launchpad.net/1.0/~sbiswas7"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/177326", 
            "date_created": "2015-04-24 15:57:20.511778+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Sudipta Biswas (<email address hidden>) on branch: master\nReview: https://review.openstack.org/177326\nReason: Based on Flavio's comments - i am abandoning this patch.", 
            "date_created": "2015-07-08 07:05:46.052058+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2015-04-24 15:06:08.648884+00:00"
}