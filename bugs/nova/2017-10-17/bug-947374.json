{
    "status": "Won't Fix", 
    "last_updated": "2012-03-06 20:39:45.970369+00:00", 
    "description": "Problem:\n\n\nCurrently nova-objectstore allows anoymous access to the service. This is potentially a security problem due to:\n\n1. This exposes bucket and images to any unauthenticated user with access to the nova-imagestore port as they can PUT, DELETE, GET and POST to buckets as well as images. The image contents should be protected from tampering as they are usually encrypted.\n\n2. A host could be potentially have it's disk space exhausted by a malicious client by uploading large files to a bucket anonymously.\n\n\nWorkaround:\n\n\nA workaround is to use the Glance service directly, however this is often not preferered as an S3-like interface is more compatible with existing toolsets.\n\n\nImpact:\n\n\nI believe that this should not affect the images stored in Glance, but only images stored within the nova-objectstore filesystem, but I have not fully investigated the issue.\n\n\nTesting:\n\n\n$ curl -X GET http://172.16.150.1:3333/foo/\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<ListBucketResult xmlns=\"http://doc.s3.amazonaws.com/2006-03-01\"><Name>foo</Name><MaxKeys>50000</MaxKeys><Prefix></Prefix><Marker>oneiric-server-cloudimg-amd64.img.part.02</Marker><IsTruncated>False</IsTruncated><Contents><LastModified>2011-08-11T22:13:40.000Z</LastModified><Key>natty-server-uec-amd64.img.manifest.xml</Key><Size>4590</Size></Contents><Contents><LastModified>2011-08-11T22:13:40.000Z</LastModified><Key>natty-server-uec-amd64.img.part.00</Key><Size>0</Size></Contents><Contents><LastModified>2011-08-23T00:14:13.000Z</LastModified><Key>oneiric-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml</Key><Size>2217</Size></Contents><Contents><LastModified>2011-08-23T00:14:59.000Z</LastModified><Key>oneiric-server-cloudimg-amd64-vmlinuz-virtual.part.00</Key><Size>4675376</Size></Contents><Contents><LastModified>2011-08-23T00:15:59.000Z</LastModified><Key>oneiric-server-cloudimg-amd64.img.manifest.xml</Key><Size>5238</Size></Contents><Contents><LastModified>2011-08-23T00:17:40.000Z</LastModified><Key>oneiric-server-cloudimg-amd64.img.part.00</Key><Size>10485760</Size></Contents><Contents><LastModified>2011-08-23T00:19:19.000Z</LastModified><Key>oneiric-server-cloudimg-amd64.img.part.01</Key><Size>10485760</Size></Contents><Contents><LastModified>2011-08-23T00:19:20.000Z</LastModified><Key>oneiric-server-cloudimg-amd64.img.part.02</Key><Size>0</Size></Contents></ListBucketResult>\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml\n$ curl -X DELETE http://172.16.150.1:3333/foo/natty-server-uec-amd64.img.manifest.xml\n$ curl -X DELETE http://172.16.150.1:3333/foo/natty-server-uec-amd64.img.part.00\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64-vmlinuz-virtual.part.00\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64.img.manifest.xml\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64.img.part.00\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64.img.part.01\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64.img.part.02\n$ curl -X DELETE http://172.16.150.1:3333/foo/\n$ curl -X GET http://172.16.150.1:3333/foo/", 
    "tags": [
        "canonistack"
    ], 
    "importance": "Undecided", 
    "heat": 260, 
    "link": "https://bugs.launchpad.net/nova/+bug/947374", 
    "owner": "None", 
    "id": 947374, 
    "index": 3925, 
    "openned": "2012-03-05 18:56:43.519401+00:00", 
    "created": "2012-03-05 18:56:43.519401+00:00", 
    "title": "nova-objectstore should require authentication", 
    "comments": [
        {
            "content": "Problem:\n\n\nCurrently nova-objectstore allows anoymous access to the service. This is potentially a security problem due to:\n\n1. This exposes bucket and images to any unauthenticated user with access to the nova-imagestore port as they can PUT, DELETE, GET and POST to buckets as well as images. The image contents should be protected from tampering as they are usually encrypted.\n\n2. A host could be potentially have it's disk space exhausted by a malicious client by uploading large files to a bucket anonymously.\n\n\nWorkaround:\n\n\nA workaround is to use the Glance service directly, however this is often not preferered as an S3-like interface is more compatible with existing toolsets.\n\n\nImpact:\n\n\nI believe that this should not affect the images stored in Glance, but only images stored within the nova-objectstore filesystem, but I have not fully investigated the issue.\n\n\nTesting:\n\n\n$ curl -X GET http://172.16.150.1:3333/foo/\n<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<ListBucketResult xmlns=\"http://doc.s3.amazonaws.com/2006-03-01\"><Name>foo</Name><MaxKeys>50000</MaxKeys><Prefix></Prefix><Marker>oneiric-server-cloudimg-amd64.img.part.02</Marker><IsTruncated>False</IsTruncated><Contents><LastModified>2011-08-11T22:13:40.000Z</LastModified><Key>natty-server-uec-amd64.img.manifest.xml</Key><Size>4590</Size></Contents><Contents><LastModified>2011-08-11T22:13:40.000Z</LastModified><Key>natty-server-uec-amd64.img.part.00</Key><Size>0</Size></Contents><Contents><LastModified>2011-08-23T00:14:13.000Z</LastModified><Key>oneiric-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml</Key><Size>2217</Size></Contents><Contents><LastModified>2011-08-23T00:14:59.000Z</LastModified><Key>oneiric-server-cloudimg-amd64-vmlinuz-virtual.part.00</Key><Size>4675376</Size></Contents><Contents><LastModified>2011-08-23T00:15:59.000Z</LastModified><Key>oneiric-server-cloudimg-amd64.img.manifest.xml</Key><Size>5238</Size></Contents><Contents><LastModified>2011-08-23T00:17:40.000Z</LastModified><Key>oneiric-server-cloudimg-amd64.img.part.00</Key><Size>10485760</Size></Contents><Contents><LastModified>2011-08-23T00:19:19.000Z</LastModified><Key>oneiric-server-cloudimg-amd64.img.part.01</Key><Size>10485760</Size></Contents><Contents><LastModified>2011-08-23T00:19:20.000Z</LastModified><Key>oneiric-server-cloudimg-amd64.img.part.02</Key><Size>0</Size></Contents></ListBucketResult>\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64-vmlinuz-virtual.manifest.xml\n$ curl -X DELETE http://172.16.150.1:3333/foo/natty-server-uec-amd64.img.manifest.xml\n$ curl -X DELETE http://172.16.150.1:3333/foo/natty-server-uec-amd64.img.part.00\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64-vmlinuz-virtual.part.00\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64.img.manifest.xml\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64.img.part.00\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64.img.part.01\n$ curl -X DELETE http://172.16.150.1:3333/foo/oneiric-server-cloudimg-amd64.img.part.02\n$ curl -X DELETE http://172.16.150.1:3333/foo/\n$ curl -X GET http://172.16.150.1:3333/foo/", 
            "date_created": "2012-03-05 18:56:43.519401+00:00", 
            "author": "https://api.launchpad.net/1.0/~aglenyoung"
        }, 
        {
            "content": "In my understanding nova-objectstore is not meant as a user-facing production solution but rather as a simple workaround to make EC2 image upload tools  work with Nova on small deployments, without requiring a full-fledged S3-compatible object storage backend, and where you can block direct access to it. Therefore it has quite a few shortcomings that I don't expect to be addressed, like lack on encryption or user authentication...\r\n\r\nFor production environments you currently have two options:\r\n* Use Glance (and drop usage of the EC2/S3 upload-image toolset)\r\n* Use a real S3-compatible object storage backend (Swift in S3 mode, or another S3-like implementation)\r\n\r\nI don't think I'd consider lack of authentication in nova-objectstore as a security vulnerability, but rather as a severe limitation of nova-objectstore, and one of the many reasons why it should not be used in production setups anyway.\r\n\r\nI think that's a well-known limitation of nova-objectstore, so with your permission, I think I would open this bug publicly.", 
            "date_created": "2012-03-06 13:54:53.351000+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "On Tue 06-03-2012 13:54 \u203a, Thierry Carrez wrote:\n> [...]\n> \n> I don't think I'd consider lack of authentication in nova-objectstore as\n> a security vulnerability, but rather as a severe limitation of nova-\n> objectstore, and one of the many reasons why it should not be used in\n> production setups anyway.\n> \n> I think that's a well-known limitation of nova-objectstore, so with your\n> permission, I think I would open this bug publicly.\n\nThierry, I would have to politely disagree with you that the limitations of\nnova-objectstore are well-known. However, considering all that you've said\nI'm happy to have the bug made public and possibly marked as invalid.\n\n-- \nRegards.\nAndrew Glen-Young\n", 
            "date_created": "2012-03-06 20:01:38+00:00", 
            "author": "https://api.launchpad.net/1.0/~aglenyoung"
        }
    ], 
    "closed": "2012-03-06 20:39:44.425997+00:00"
}