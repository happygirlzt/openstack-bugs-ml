{
    "status": "Fix Released", 
    "last_updated": "2013-04-04 11:03:31.609682+00:00", 
    "description": "After I resize a instance from m1.tiny to m1.small, I make a resize-revert operation. And it turned to be an error.\nThe flavor was shown as fallows:\n# nova flavor-list\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+-------------+\n| ID | Name        | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public | extra_specs |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+-------------+\n| 1  | m1.tiny     | 512                  | 0       | 0           |      | 1     | 1.0         | True      | {}          |\n| 2  | m1.small  | 2048                | 10     | 20        |      | 1     | 1.0         | True      | {}          |\n\nHere are the error log from nova-compute.log:\n2012-12-05 15:19:12 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [i\nnstance: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Starting finish_revert_migration finish_revert_migration /home/openstack/github/nova.git/nova/virt/libvirt/driver.p\ny:2937\n2012-12-05 15:19:12 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): mv /var/lib/nova/instances/instance-0000001f_resize /var/lib/nova/instances/instance-0000001f execute /home/openstack/github/nova.git/nova/utils.py:183 \n2012-12-05 15:19:12 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:12 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [i\nnstance: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Starting toXML method to_xml /home/openstack/github/nova.git/nova/virt/libvirt/driver.py:1861\n2012-12-05 15:19:12 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] CP\nU mode 'host-model' model '' was chosen get_guest_cpu_config /home/openstack/github/nova.git/nova/virt/libvirt/driver.py:1551\n2012-12-05 15:19:13 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] bl\nock_device_list [] _volume_in_mapping /home/openstack/github/nova.git/nova/virt/libvirt/driver.py:1489\n2012-12-05 15:19:13 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] bl\nock_device_list [] _volume_in_mapping /home/openstack/github/nova.git/nova/virt/libvirt/driver.py:1489\n2012-12-05 15:19:13 DEBUG nova.virt.libvirt.config [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Ge\nnerated XML <domain type=\"qemu\">\n  <uuid>c09ba1d8-3480-42ea-a012-2fb89ac933a4</uuid>                             \n  <name>instance-0000001f</name>                                                \n  <memory>2097152</memory>                                                      \n  <vcpu>1</vcpu>                                                                \n  <os>                                                                          \n    <type>hvm</type>                                                            \n    <boot dev=\"hd\"/>                                                            \n  </os>                                                                         \n  <features>                                                                    \n    <acpi/>                                                                     \n  </features>                                                                   \n  <clock offset=\"utc\"/>                                                         \n  <cpu mode=\"host-model\" match=\"exact\"/>                                        \n  <devices>                                                                     \n    <disk type=\"file\" device=\"disk\">                                            \n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>                           \n      <source file=\"/var/lib/nova/instances/instance-0000001f/disk\"/>           \n      <target bus=\"virtio\" dev=\"vda\"/>                                          \n    </disk>                                                                     \n    <disk type=\"file\" device=\"disk\">                                            \n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>                           \n      <source file=\"/var/lib/nova/instances/instance-0000001f/disk.local\"/>     \n      <target bus=\"virtio\" dev=\"vdb\"/>                                          \n    </disk>                                                                     \n    <interface type=\"bridge\">                                                   \n      <mac address=\"fa:16:3e:02:2d:cb\"/>                                        \n      <source bridge=\"br100\"/>                                                  \n      <filterref filter=\"nova-instance-instance-0000001f-fa163e022dcb\"> \n      <source bridge=\"br100\"/>                                                                                                                                    \n      <filterref filter=\"nova-instance-instance-0000001f-fa163e022dcb\">         \n        <parameter name=\"IP\" value=\"10.0.10.2\"/>                                \n        <parameter name=\"DHCPSERVER\" value=\"10.0.10.3\"/>                        \n        <parameter name=\"PROJNET\" value=\"10.0.10.0\"/>                           \n        <parameter name=\"PROJMASK\" value=\"255.255.255.128\"/>                    \n      </filterref>                                                              \n    </interface>                                                                \n    <serial type=\"file\">                                                        \n      <source path=\"/var/lib/nova/instances/instance-0000001f/console.log\"/>    \n    </serial>                                                                   \n    <serial type=\"pty\"/>                                                        \n    <input type=\"tablet\" bus=\"usb\"/>                                            \n    <graphics type=\"vnc\" autoport=\"yes\" keymap=\"en-us\" listen=\"10.120.32.145\"/> \n  </devices>                                                                    \n</domain>                                                                       \n  to_xml /home/openstack/github/nova.git/nova/virt/libvirt/config.py:66\n2012-12-05 15:19:13 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [i\nnstance: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Finished toXML method to_xml /home/openstack/github/nova.git/nova/virt/libvirt/driver.py:1865\n2012-12-05 15:19:13 INFO nova.virt.libvirt.firewall [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [\ninstance: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Called setup_basic_filtering in nwfilter\n2012-12-05 15:19:13 INFO nova.virt.libvirt.firewall [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [\ninstance: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Ensuring static filters\n2012-12-05 15:19:14 DEBUG nova.virt.firewall [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [instanc\ne: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Filters added to instance prepare_instance_filter /home/openstack/github/nova.git/nova/virt/firewall.py:187\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got semaphore \"i\nptables\" for method \"_do_refresh_provider_fw_rules\"... inner /home/openstack/github/nova.git/nova/utils.py:721\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Attempting to gr\nab file lock \"iptables\" for method \"_do_refresh_provider_fw_rules\"... inner /home/openstack/github/nova.git/nova/utils.py:725\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got file lock \"i\nptables\" for method \"_do_refresh_provider_fw_rules\"... inner /home/openstack/github/nova.git/nova/utils.py:751\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got semaphore \"i\nptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:721\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Attempting to gr\nab file lock \"iptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:725\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got file lock \"i\nptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:751\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c -t filter execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-restore -c execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c -t nat execute /home/openstack/github/nova.git/nova/utils.py:183   \n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199                                                                                                            \n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c -t nat execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-restore -c execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:14 DEBUG nova.network.linux_net [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] IPTa\nblesManager.apply completed with success _apply /home/openstack/github/nova.git/nova/network/linux_net.py:372\n2012-12-05 15:19:14 DEBUG nova.virt.firewall [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [instanc\ne: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Provider Firewall Rules refreshed prepare_instance_filter /home/openstack/github/nova.git/nova/virt/firewall.py:189\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got semaphore \"i\nptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:721\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Attempting to gr\nab file lock \"iptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:725\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got file lock \"i\nptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:751\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c -t filter execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-restore -c execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:15 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:15 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c -t nat execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:15 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:15 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-restore -c execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:15 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:15 DEBUG nova.network.linux_net [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] IPTa\nblesManager.apply completed with success _apply /home/openstack/github/nova.git/nova/network/linux_net.py:372\n2012-12-05 15:19:18 ERROR nova.compute.manager [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [insta\nnce: c09ba1d8-3480-42ea-a012-2fb89ac933a4] unable to set user and group to '0:0' on '/var/lib/nova/instances/instance-0000001f/disk.local': No such file or direct\nory. Setting instance vm_state to ERROR\n2012-12-05 15:19:18 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got semaphore \"c\nompute_resources\" for method \"update_usage\"... inner /home/openstack/github/nova.git/nova/utils.py:721\n2012-12-05 15:19:18 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got semaphore \"c\nompute_resources\" for method \"update_usage\"... inner /home/openstack/github/nova.git/nova/utils.py:721\n2012-12-05 15:19:18 7069 ERROR nova.openstack.common.rpc.amqp [-] Exception during message handling\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/openstack/common/rpc/amqp.py\", line 276, in _process_da\nta\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/openstack/common/rpc/dispatcher.py\", line 145, in dispa\ntch\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/exception.py\", line 117, in wrapped\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/exception.py\", line 117, in wrapped                    \n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/exception.py\", line 92, in wrapped\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kw)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/compute/manager.py\", line 175, in decorated_function\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     pass          \n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/compute/manager.py\", line 161, in decorated_function\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/compute/manager.py\", line 196, in decorated_function\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     kwargs['instance']['uuid'], e, sys.exc_info())\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/compute/manager.py\", line 190, in decorated_function\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/compute/manager.py\", line 1506, in finish_revert_resize\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/exception.py\", line 117, in wrapped\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/exception.py\", line 92, in wrapped\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kw)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/virt/libvirt/driver.py\", line 2946, in finish_revert_mi\ngration\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/virt/libvirt/driver.py\", line 1931, in _create_domain_a\nnd_network\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     domain = self._create_domain(xml)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/virt/libvirt/driver.py\", line 1910, in _create_domain\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     domain.createWithFlags(launch_flags)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 187, in doit\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 147, in proxy_call\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     rv = execute(f,*args,**kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 76, in tworker\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     rv = meth(*args,**kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 584, in createWithFlags\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp libvirtError: unable to set user and group to '0:0' on '/var/lib/nova/instances/instance-0000001f/di\nsk.local': No such file or directory\n\nIt seems that resize-revert still using the new flavor, not the wanted old flavor.", 
    "tags": [
        "folsom-backport-potential"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1086688", 
    "owner": "https://api.launchpad.net/1.0/~hzwangpan", 
    "id": 1086688, 
    "index": 3171, 
    "openned": "2012-12-05 07:55:10.851226+00:00", 
    "created": "2012-12-05 07:55:10.851226+00:00", 
    "title": "resize-revert fails with Failure: [libvirtError :....No such file]", 
    "comments": [
        {
            "content": "After I resize a instance from m1.tiny to m1.small, I make a resize-revert operation. And it turned to be an error.\nThe flavor was shown as fallows:\n# nova flavor-list\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+-------------+\n| ID | Name        | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public | extra_specs |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+-------------+\n| 1  | m1.tiny     | 512                  | 0       | 0           |      | 1     | 1.0         | True      | {}          |\n| 2  | m1.small  | 2048                | 10     | 20        |      | 1     | 1.0         | True      | {}          |\n\nHere are the error log from nova-compute.log:\n2012-12-05 15:19:12 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [i\nnstance: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Starting finish_revert_migration finish_revert_migration /home/openstack/github/nova.git/nova/virt/libvirt/driver.p\ny:2937\n2012-12-05 15:19:12 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): mv /var/lib/nova/instances/instance-0000001f_resize /var/lib/nova/instances/instance-0000001f execute /home/openstack/github/nova.git/nova/utils.py:183 \n2012-12-05 15:19:12 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:12 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [i\nnstance: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Starting toXML method to_xml /home/openstack/github/nova.git/nova/virt/libvirt/driver.py:1861\n2012-12-05 15:19:12 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] CP\nU mode 'host-model' model '' was chosen get_guest_cpu_config /home/openstack/github/nova.git/nova/virt/libvirt/driver.py:1551\n2012-12-05 15:19:13 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] bl\nock_device_list [] _volume_in_mapping /home/openstack/github/nova.git/nova/virt/libvirt/driver.py:1489\n2012-12-05 15:19:13 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] bl\nock_device_list [] _volume_in_mapping /home/openstack/github/nova.git/nova/virt/libvirt/driver.py:1489\n2012-12-05 15:19:13 DEBUG nova.virt.libvirt.config [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Ge\nnerated XML <domain type=\"qemu\">\n  <uuid>c09ba1d8-3480-42ea-a012-2fb89ac933a4</uuid>                             \n  <name>instance-0000001f</name>                                                \n  <memory>2097152</memory>                                                      \n  <vcpu>1</vcpu>                                                                \n  <os>                                                                          \n    <type>hvm</type>                                                            \n    <boot dev=\"hd\"/>                                                            \n  </os>                                                                         \n  <features>                                                                    \n    <acpi/>                                                                     \n  </features>                                                                   \n  <clock offset=\"utc\"/>                                                         \n  <cpu mode=\"host-model\" match=\"exact\"/>                                        \n  <devices>                                                                     \n    <disk type=\"file\" device=\"disk\">                                            \n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>                           \n      <source file=\"/var/lib/nova/instances/instance-0000001f/disk\"/>           \n      <target bus=\"virtio\" dev=\"vda\"/>                                          \n    </disk>                                                                     \n    <disk type=\"file\" device=\"disk\">                                            \n      <driver name=\"qemu\" type=\"qcow2\" cache=\"none\"/>                           \n      <source file=\"/var/lib/nova/instances/instance-0000001f/disk.local\"/>     \n      <target bus=\"virtio\" dev=\"vdb\"/>                                          \n    </disk>                                                                     \n    <interface type=\"bridge\">                                                   \n      <mac address=\"fa:16:3e:02:2d:cb\"/>                                        \n      <source bridge=\"br100\"/>                                                  \n      <filterref filter=\"nova-instance-instance-0000001f-fa163e022dcb\"> \n      <source bridge=\"br100\"/>                                                                                                                                    \n      <filterref filter=\"nova-instance-instance-0000001f-fa163e022dcb\">         \n        <parameter name=\"IP\" value=\"10.0.10.2\"/>                                \n        <parameter name=\"DHCPSERVER\" value=\"10.0.10.3\"/>                        \n        <parameter name=\"PROJNET\" value=\"10.0.10.0\"/>                           \n        <parameter name=\"PROJMASK\" value=\"255.255.255.128\"/>                    \n      </filterref>                                                              \n    </interface>                                                                \n    <serial type=\"file\">                                                        \n      <source path=\"/var/lib/nova/instances/instance-0000001f/console.log\"/>    \n    </serial>                                                                   \n    <serial type=\"pty\"/>                                                        \n    <input type=\"tablet\" bus=\"usb\"/>                                            \n    <graphics type=\"vnc\" autoport=\"yes\" keymap=\"en-us\" listen=\"10.120.32.145\"/> \n  </devices>                                                                    \n</domain>                                                                       \n  to_xml /home/openstack/github/nova.git/nova/virt/libvirt/config.py:66\n2012-12-05 15:19:13 DEBUG nova.virt.libvirt.driver [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [i\nnstance: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Finished toXML method to_xml /home/openstack/github/nova.git/nova/virt/libvirt/driver.py:1865\n2012-12-05 15:19:13 INFO nova.virt.libvirt.firewall [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [\ninstance: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Called setup_basic_filtering in nwfilter\n2012-12-05 15:19:13 INFO nova.virt.libvirt.firewall [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [\ninstance: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Ensuring static filters\n2012-12-05 15:19:14 DEBUG nova.virt.firewall [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [instanc\ne: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Filters added to instance prepare_instance_filter /home/openstack/github/nova.git/nova/virt/firewall.py:187\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got semaphore \"i\nptables\" for method \"_do_refresh_provider_fw_rules\"... inner /home/openstack/github/nova.git/nova/utils.py:721\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Attempting to gr\nab file lock \"iptables\" for method \"_do_refresh_provider_fw_rules\"... inner /home/openstack/github/nova.git/nova/utils.py:725\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got file lock \"i\nptables\" for method \"_do_refresh_provider_fw_rules\"... inner /home/openstack/github/nova.git/nova/utils.py:751\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got semaphore \"i\nptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:721\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Attempting to gr\nab file lock \"iptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:725\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got file lock \"i\nptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:751\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c -t filter execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-restore -c execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c -t nat execute /home/openstack/github/nova.git/nova/utils.py:183   \n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199                                                                                                            \n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c -t nat execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-restore -c execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:14 DEBUG nova.network.linux_net [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] IPTa\nblesManager.apply completed with success _apply /home/openstack/github/nova.git/nova/network/linux_net.py:372\n2012-12-05 15:19:14 DEBUG nova.virt.firewall [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [instanc\ne: c09ba1d8-3480-42ea-a012-2fb89ac933a4] Provider Firewall Rules refreshed prepare_instance_filter /home/openstack/github/nova.git/nova/virt/firewall.py:189\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got semaphore \"i\nptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:721\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Attempting to gr\nab file lock \"iptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:725\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got file lock \"i\nptables\" for method \"_apply\"... inner /home/openstack/github/nova.git/nova/utils.py:751\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c -t filter execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:14 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-restore -c execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:15 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:15 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c -t nat execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:15 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:15 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Running cmd (sub\nprocess): sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-restore -c execute /home/openstack/github/nova.git/nova/utils.py:183\n2012-12-05 15:19:15 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Result was 0 exe\ncute /home/openstack/github/nova.git/nova/utils.py:199\n2012-12-05 15:19:15 DEBUG nova.network.linux_net [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] IPTa\nblesManager.apply completed with success _apply /home/openstack/github/nova.git/nova/network/linux_net.py:372\n2012-12-05 15:19:18 ERROR nova.compute.manager [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] [insta\nnce: c09ba1d8-3480-42ea-a012-2fb89ac933a4] unable to set user and group to '0:0' on '/var/lib/nova/instances/instance-0000001f/disk.local': No such file or direct\nory. Setting instance vm_state to ERROR\n2012-12-05 15:19:18 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got semaphore \"c\nompute_resources\" for method \"update_usage\"... inner /home/openstack/github/nova.git/nova/utils.py:721\n2012-12-05 15:19:18 DEBUG nova.utils [req-5c6a38f8-b3ea-4e19-8b67-6e5e13ac028c f5f8d00c205741a8afb79da4d7da2ff1 49d0548301a440f2bb5374b8ceef3a73] Got semaphore \"c\nompute_resources\" for method \"update_usage\"... inner /home/openstack/github/nova.git/nova/utils.py:721\n2012-12-05 15:19:18 7069 ERROR nova.openstack.common.rpc.amqp [-] Exception during message handling\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/openstack/common/rpc/amqp.py\", line 276, in _process_da\nta\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/openstack/common/rpc/dispatcher.py\", line 145, in dispa\ntch\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/exception.py\", line 117, in wrapped\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/exception.py\", line 117, in wrapped                    \n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/exception.py\", line 92, in wrapped\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kw)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/compute/manager.py\", line 175, in decorated_function\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     pass          \n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/compute/manager.py\", line 161, in decorated_function\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/compute/manager.py\", line 196, in decorated_function\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     kwargs['instance']['uuid'], e, sys.exc_info())\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/compute/manager.py\", line 190, in decorated_function\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/compute/manager.py\", line 1506, in finish_revert_resize\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/exception.py\", line 117, in wrapped\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/exception.py\", line 92, in wrapped\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kw)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/virt/libvirt/driver.py\", line 2946, in finish_revert_mi\ngration\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     block_device_info)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/virt/libvirt/driver.py\", line 1931, in _create_domain_a\nnd_network\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     domain = self._create_domain(xml)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/home/openstack/github/nova.git/nova/virt/libvirt/driver.py\", line 1910, in _create_domain\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     domain.createWithFlags(launch_flags)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 187, in doit\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 147, in proxy_call\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     rv = execute(f,*args,**kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 76, in tworker\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     rv = meth(*args,**kwargs)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 584, in createWithFlags\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2012-12-05 15:19:18 7069 TRACE nova.openstack.common.rpc.amqp libvirtError: unable to set user and group to '0:0' on '/var/lib/nova/instances/instance-0000001f/di\nsk.local': No such file or directory\n\nIt seems that resize-revert still using the new flavor, not the wanted old flavor.", 
            "date_created": "2012-12-05 07:55:10.851226+00:00", 
            "author": "https://api.launchpad.net/1.0/~hzguanqiang"
        }, 
        {
            "content": "    def finish_revert_resize(self, context, instance, reservations=None,            \n                             migration=None, migration_id=None):                    \n            ......                                                                                    \n            instance = self._instance_update(context,                               \n                                        instance['uuid'],                           \n                                        host=migration['source_compute']) # the instance type isn't update          \n            ......                                                                  \n            old_instance_type = migration['old_instance_type_id']                   \n            instance_type = instance_types.get_instance_type(old_instance_type) \n\n     def get_guest_config(self, instance, network_info, image_meta, rescue=None, \n                         block_device_info=None):                                   \n        ......                                                \n        inst_type = instance['instance_type'] # so the instance type here is the resized one, not the original before resizing.", 
            "date_created": "2012-12-05 10:04:14.008763+00:00", 
            "author": "https://api.launchpad.net/1.0/~hzwangpan"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/17588", 
            "date_created": "2012-12-06 07:24:01.368681+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/17588\nCommitted: http://github.com/openstack/nova/commit/9eadd4fdf4a76a9ea92790a6c4aa20d0aa32ef86\nSubmitter: Jenkins\nBranch:    master\n\ncommit 9eadd4fdf4a76a9ea92790a6c4aa20d0aa32ef86\nAuthor: Wangpan <email address hidden>\nDate:   Thu Dec 6 15:13:54 2012 +0800\n\n    Fix revert resize failure with disk.local not found\n    \n    If we resize an instance from a flavor without ephemeral disk to a flavor\n    with it, it resizes OK, but if we revert this resize, the instance fail to\n    spawn with error disk.local not found.\n    The reason is that the libvirt driver get the wrong resized flavor from\n    instance, so the flavor info of instance should be updated before instance\n    spawns.\n    \n    Fixes: bug #1086688\n    \n    Change-Id: I2c54586803c60baab7f20297b309a8e6c4134d13\n", 
            "date_created": "2012-12-20 23:43:47.762460+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-01-09 10:21:57.357633+00:00"
}