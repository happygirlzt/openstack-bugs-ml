{
    "status": "Invalid", 
    "last_updated": "2017-05-01 18:38:21.811578+00:00", 
    "description": "There was a bug in tempest that caused a call to DELETE os-server-groups with a bad id. Here is the call from the tempest log:\n\n2014-06-25 12:07:03.162 25653 INFO tempest.common.rest_client [-] Request (ServerGroupTestJSON:tearDownClass): 200 DELETE http://127.0.0.1:8774/v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1944635656', u'id': u'7c6a13c1-6d8b-4314-9d16-4eb6418a2170', u'members': [], u'metadata': {}} 0.001s\n\nNormally DELETE will return 204 and in this case I would have expected 400. But the call returns 200. What can be seen in the nova log seems to indicate 400 but that is not what is actually getting sent back:\n\n127.0.0.1 - - [25/Jun/2014 12:07:03] code 400, message Bad request syntax (\"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1944635656', u'id': u'7c6a13c1-6d8b-4314-9d16-4eb6418a2170', u'members': [], u'metadata': {}} HTTP/1.1\")\n127.0.0.1 - - [25/Jun/2014 12:07:03] \"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1944635656', u'id': u'7c6a13c1-6d8b-4314-9d16-4eb6418a2170', u'members': [], u'metadata': {}} HTTP/1.1\" 400 -\n127.0.0.1 - - [25/Jun/2014 12:07:03] code 400, message Bad request syntax (\"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1366165944', u'id': u'd361d100-fc59-4393-b61b-30a2d4b27b6e', u'members': [], u'metadata': {}} HTTP/1.1\")\n127.0.0.1 - - [25/Jun/2014 12:07:03] \"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1366165944', u'id': u'd361d100-fc59-4393-b61b-30a2d4b27b6e', u'members': [], u'metadata': {}} HTTP/1.1\" 400 -\n127.0.0.1 - - [25/Jun/2014 12:07:03] code 400, message Bad request syntax (\"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1366165944', u'id': u'9f8574d7-78b9-4926-98ea-61f2da971478', u'members': [], u'metadata': {}} HTTP/1.1\")\n127.0.0.1 - - [25/Jun/2014 12:07:03] \"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1366165944', u'id': u'9f8574d7-78b9-4926-98ea-61f2da971478', u'members': [], u'metadata': {}} HTTP/1.1\" 400 -\n127.0.0.1 - - [25/Jun/2014 12:07:03] code 400, message Bad request syntax (\"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-2072440191', u'id': u'01342594-9661-47fb-8816-e816ad2cae37', u'members': [], u'metadata': {}} HTTP/1.1\")\n127.0.0.1 - - [25/Jun/2014 12:07:03] \"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-2072440191', u'id': u'01342594-9661-47fb-8816-e816ad2cae37', u'members': [], u'metadata': {}} HTTP/1.1\" 400 -\n127.0.0.1 - - [25/Jun/2014 12:07:03] code 400, message Bad request syntax (\"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'anti-affinity'], u'name': u'server-group-684827235', u'id': u'53c45946-5a0b-451e-bf24-790b1db89963', u'members': [], u'metadata': {}} HTTP/1.1\")\n127.0.0.1 - - [25/Jun/2014 12:07:03] \"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'anti-affinity'], u'name': u'server-group-684827235', u'id': u'53c45946-5a0b-451e-bf24-790b1db89963', u'members': [], u'metadata': {}} HTTP/1.1\" 400 -", 
    "tags": [
        "testing"
    ], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1334297", 
    "owner": "https://api.launchpad.net/1.0/~cyeoh-0", 
    "id": 1334297, 
    "index": 3940, 
    "openned": "2014-06-25 14:17:02.429306+00:00", 
    "created": "2014-06-25 14:17:02.429306+00:00", 
    "title": "Strange response from os-server-groups with bad parameter", 
    "comments": [
        {
            "content": "There was a bug in tempest that caused a call to DELETE os-server-groups with a bad id. Here is the call from the tempest log:\n\n2014-06-25 12:07:03.162 25653 INFO tempest.common.rest_client [-] Request (ServerGroupTestJSON:tearDownClass): 200 DELETE http://127.0.0.1:8774/v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1944635656', u'id': u'7c6a13c1-6d8b-4314-9d16-4eb6418a2170', u'members': [], u'metadata': {}} 0.001s\n\nNormally DELETE will return 204 and in this case I would have expected 400. But the call returns 200. What can be seen in the nova log seems to indicate 400 but that is not what is actually getting sent back:\n\n127.0.0.1 - - [25/Jun/2014 12:07:03] code 400, message Bad request syntax (\"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1944635656', u'id': u'7c6a13c1-6d8b-4314-9d16-4eb6418a2170', u'members': [], u'metadata': {}} HTTP/1.1\")\n127.0.0.1 - - [25/Jun/2014 12:07:03] \"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1944635656', u'id': u'7c6a13c1-6d8b-4314-9d16-4eb6418a2170', u'members': [], u'metadata': {}} HTTP/1.1\" 400 -\n127.0.0.1 - - [25/Jun/2014 12:07:03] code 400, message Bad request syntax (\"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1366165944', u'id': u'd361d100-fc59-4393-b61b-30a2d4b27b6e', u'members': [], u'metadata': {}} HTTP/1.1\")\n127.0.0.1 - - [25/Jun/2014 12:07:03] \"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1366165944', u'id': u'd361d100-fc59-4393-b61b-30a2d4b27b6e', u'members': [], u'metadata': {}} HTTP/1.1\" 400 -\n127.0.0.1 - - [25/Jun/2014 12:07:03] code 400, message Bad request syntax (\"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1366165944', u'id': u'9f8574d7-78b9-4926-98ea-61f2da971478', u'members': [], u'metadata': {}} HTTP/1.1\")\n127.0.0.1 - - [25/Jun/2014 12:07:03] \"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1366165944', u'id': u'9f8574d7-78b9-4926-98ea-61f2da971478', u'members': [], u'metadata': {}} HTTP/1.1\" 400 -\n127.0.0.1 - - [25/Jun/2014 12:07:03] code 400, message Bad request syntax (\"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-2072440191', u'id': u'01342594-9661-47fb-8816-e816ad2cae37', u'members': [], u'metadata': {}} HTTP/1.1\")\n127.0.0.1 - - [25/Jun/2014 12:07:03] \"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-2072440191', u'id': u'01342594-9661-47fb-8816-e816ad2cae37', u'members': [], u'metadata': {}} HTTP/1.1\" 400 -\n127.0.0.1 - - [25/Jun/2014 12:07:03] code 400, message Bad request syntax (\"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'anti-affinity'], u'name': u'server-group-684827235', u'id': u'53c45946-5a0b-451e-bf24-790b1db89963', u'members': [], u'metadata': {}} HTTP/1.1\")\n127.0.0.1 - - [25/Jun/2014 12:07:03] \"DELETE /v2/2bc18b72010d455a9db7cbc583e1dcfc/os-server-groups/{u'policies': [u'anti-affinity'], u'name': u'server-group-684827235', u'id': u'53c45946-5a0b-451e-bf24-790b1db89963', u'members': [], u'metadata': {}} HTTP/1.1\" 400 -", 
            "date_created": "2014-06-25 14:17:02.429306+00:00", 
            "author": "https://api.launchpad.net/1.0/~david-kranz"
        }, 
        {
            "content": "DId this happen in the gate? And if so you have a link to the original nova log file. The log data from Nova there looks a bit odd\n", 
            "date_created": "2014-06-27 05:42:23.994401+00:00", 
            "author": "https://api.launchpad.net/1.0/~cyeoh-0"
        }, 
        {
            "content": "Yes it happened in the gate. You can see it in any run before I committed the fix. The tempest bug was https://bugs.launchpad.net/bugs/1333965 and here is a log file http://logs.openstack.org/42/81842/7/check/check-tempest-dsvm-full/f61316b/logs/screen-n-api.txt.gz. The last comments in the tempest bug ticket indicate that tempest really is getting a 200.", 
            "date_created": "2014-06-27 13:09:24.669184+00:00", 
            "author": "https://api.launchpad.net/1.0/~david-kranz"
        }, 
        {
            "content": "Thanks David - I've confirmed this is a problem across all of the nova api", 
            "date_created": "2014-06-30 06:29:30.424102+00:00", 
            "author": "https://api.launchpad.net/1.0/~cyeoh-0"
        }, 
        {
            "content": "So in the end I don't think this is a Nova bug. The first line of the request to the Nova API server looks like this:\n\nDELETE /v2/f9cea8784d7245e5a8022a259bb92d90/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1646113520', u'id': u'b5316a4a-f6eb-4a7f-8b24-028b799bf6a9', u'members': [], u'metadata': {}} HTTP/1.1\n\nWhich is not a valid header. It is so badly formatted that I believe a reasonable parser implementation could not necessarily know that the client is requesting a response in HTTP/1.1 format as the uri is so corrupt. Looking from the end it can be clearly seen, but the request is definitely corrupt. BaseHTTPServer by default responds in HTTP/0.9 protocol if its not sure.\n\nSo it does return a 400, but in HTTP/0.9 protocol:\n\n<title>Error response</title>\n</head>\n<body>\n<h1>Error response</h1>\n<p>Error code 400.\n<p>Message: Bad request syntax (\"DELETE /v2/f9cea8784d7245e5a8022a259bb92d90/os-server-groups/{u'policies': [u'affinity'], u'name': u'server-group-1646113520', u'id': u'b5316a4a-f6eb-4a7f-8b24-028b799bf6a9', u'members': [], u'metadata': {}} HTTP/1.1\").\n<p>Error code explanation: 400 = Bad request syntax or unsupported method.\n</body>\n\nhttplib2 on the tempest side  made the request in HTTP/1.1 protocol, but does not appear to try to parse it in HTTP/0.9 format if it doesn't get an HTTP/1.1 header. According to RFC 1945 it should be able to do so. So technically its a tempest bug. Not sure if its worth fixing though....\n\n", 
            "date_created": "2014-06-30 11:09:57.685188+00:00", 
            "author": "https://api.launchpad.net/1.0/~cyeoh-0"
        }, 
        {
            "content": "This bug seems due to Nova side, not Tempest side at all.\nIn addition, there was not any activity for this bug over 2 years.\nSo it is nice to close this report at this time.", 
            "date_created": "2017-05-01 18:38:20.459009+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }
    ], 
    "closed": "2014-06-30 11:11:13.192891+00:00"
}