{
    "status": "Invalid", 
    "last_updated": "2016-03-09 13:39:41.267930+00:00", 
    "description": "Hi,\n\nLaunching new/first instance fails with an error, this is a  new openstack Liberty with 2 node deployment, following official documentation:\nhttp://docs.openstack.org/liberty/install-guide-rdo/launch-instance-public.html\n\n\nCommand used::\n[root@xepcloud ~]# nova boot --flavor m1.tiny --image cirros --nic net-id=8fb32974-8dcf-47c8-a42b-a890e47725f4 --security-group default --key-name mykey public-instance\n\nError::\nERROR (ClientException): Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API \nlog if possible.\n<class 'keystoneclient.exceptions.BadRequest'> (HTTP 500) (Request-ID: req-a2d56513-0c19-46e8-9a45-d63fcee17224)\n\nNote:\nCould this be related to networking config? I was not sure what IP to use for OVERLAY_INTERFACE_IP_ADDRESS, so I used mgmt IP but I have a second physical interface for public access with no ip assigned.\n\n\nnova API logs:\n\n\n2016-01-14 11:00:13.292 11528 INFO nova.osapi_compute.wsgi.server [req-c3f11e04-e83e-46c8-9f3b-7a1709f5cc5d 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] 192.168.178.90 \"GET /v2/ee13d79dc9954b458a8d0f173bd63ccb/flavors?is_public=None HTTP/1.1\" status: 200 len: 1477 time: 0.0188160\n2016-01-14 11:00:13.311 11528 INFO nova.osapi_compute.wsgi.server [req-696093c4-6513-4209-9f56-4a0ae9488a25 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] 192.168.178.90 \"GET /v2/ee13d79dc9954b458a8d0f173bd63ccb/flavors/1 HTTP/1.1\" status: 200 len: 629 time: 0.0156209\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions [req-a2d56513-0c19-46e8-9a45-d63fcee17224 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] Unexpected exception in API method\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/extensions.py\", line 478, in wrapped\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/compute/servers.py\", line 611, in create\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     **create_kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/hooks.py\", line 149, in inner\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     rv = f(*args, **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1581, in create\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     check_server_group_quota=check_server_group_quota)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1181, in _create_instance\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     auto_disk_config, reservation_id, max_count)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 955, in _validate_and_build_base_options\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     pci_request_info, requested_networks)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/neutronv2/api.py\", line 1059, in create_pci_requests_for_sriov_ports\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     neutron = get_client(context, admin=True)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/neutronv2/api.py\", line 237, in get_client\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     auth_token = _ADMIN_AUTH.get_token(_SESSION)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/auth/identity/base.py\", line 200, in get_token\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return self.get_access(session).auth_token\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/auth/identity/base.py\", line 240, in get_access\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     self.auth_ref = self.get_auth_ref(session)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/auth/identity/v2.py\", line 88, in get_auth_ref\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     authenticated=False, log=False)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/session.py\", line 501, in post\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return self.request(url, 'POST', **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/utils.py\", line 337, in inner\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/session.py\", line 401, in request\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     raise exceptions.from_response(resp, method, url)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions BadRequest: Expecting to find username or userId in passwordCredentials - the server could not comply with the request since it is either malformed or otherwise incorrect. The client is assumed to be in error. (HTTP 400) (Request-ID: req-5a787291-5ea7-42ec-8afc-c9cb2e826fa8)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions\n2016-01-14 11:00:16.151 11528 INFO nova.api.openstack.wsgi [req-a2d56513-0c19-46e8-9a45-d63fcee17224 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'keystoneclient.exceptions.BadRequest'>\n2016-01-14 11:00:16.154 11528 INFO nova.osapi_compute.wsgi.server [req-a2d56513-0c19-46e8-9a45-d63fcee17224 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] 192.168.178.90 \"POST /v2/ee13d79dc9954b458a8d0f173bd63ccb/servers HTTP/1.1\" status: 500 len: 441 time: 2.8398080\n2016-01-14 11:00:47.647 11521 INFO nova.osapi_compute.wsgi.server [req-194d248a-5394-4cf9-bd38-6292c82ed221 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] 192.168.178.90 \"GET /v2/ HTTP/1.1\" status: 200 len: 579 time: 0.6176820\n2016-01-14 11:00:48.266 11521 INFO nova.osapi_compute.wsgi.server [req-6f5d1860-e3e7-490c-b68a-98f334beba14 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] 192.168.178.90 \"GET /v2/ee13d79dc9954b458a8d0f173bd63ccb/servers/detail HTTP/1.1\" status: 200 len: 211 time: 0.4220510", 
    "tags": [
        "api"
    ], 
    "importance": "Undecided", 
    "heat": 50, 
    "link": "https://bugs.launchpad.net/nova/+bug/1534273", 
    "owner": "None", 
    "id": 1534273, 
    "index": 7233, 
    "openned": "2016-01-14 19:21:52.112370+00:00", 
    "created": "2016-01-14 19:21:52.112370+00:00", 
    "title": "Keystone configuration options for nova.conf missing from Redhat/CentOS install guide", 
    "comments": [
        {
            "content": "Hi,\n\nLaunching new/first instance fails with an error, this is a  new openstack Liberty with 2 node deployment, following official documentation:\nhttp://docs.openstack.org/liberty/install-guide-rdo/launch-instance-public.html\n\n\nCommand used::\n[root@xepcloud ~]# nova boot --flavor m1.tiny --image cirros --nic net-id=8fb32974-8dcf-47c8-a42b-a890e47725f4 --security-group default --key-name mykey public-instance\n\nError::\nERROR (ClientException): Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API \nlog if possible.\n<class 'keystoneclient.exceptions.BadRequest'> (HTTP 500) (Request-ID: req-a2d56513-0c19-46e8-9a45-d63fcee17224)\n\nNote:\nCould this be related to networking config? I was not sure what IP to use for OVERLAY_INTERFACE_IP_ADDRESS, so I used mgmt IP but I have a second physical interface for public access with no ip assigned.\n\n\nnova API logs:\n\n\n2016-01-14 11:00:13.292 11528 INFO nova.osapi_compute.wsgi.server [req-c3f11e04-e83e-46c8-9f3b-7a1709f5cc5d 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] 192.168.178.90 \"GET /v2/ee13d79dc9954b458a8d0f173bd63ccb/flavors?is_public=None HTTP/1.1\" status: 200 len: 1477 time: 0.0188160\n2016-01-14 11:00:13.311 11528 INFO nova.osapi_compute.wsgi.server [req-696093c4-6513-4209-9f56-4a0ae9488a25 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] 192.168.178.90 \"GET /v2/ee13d79dc9954b458a8d0f173bd63ccb/flavors/1 HTTP/1.1\" status: 200 len: 629 time: 0.0156209\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions [req-a2d56513-0c19-46e8-9a45-d63fcee17224 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] Unexpected exception in API method\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions Traceback (most recent call last):\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/extensions.py\", line 478, in wrapped\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return f(*args, **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/validation/__init__.py\", line 73, in wrapper\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/api/openstack/compute/servers.py\", line 611, in create\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     **create_kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/hooks.py\", line 149, in inner\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     rv = f(*args, **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1581, in create\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     check_server_group_quota=check_server_group_quota)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 1181, in _create_instance\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     auto_disk_config, reservation_id, max_count)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/compute/api.py\", line 955, in _validate_and_build_base_options\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     pci_request_info, requested_networks)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/neutronv2/api.py\", line 1059, in create_pci_requests_for_sriov_ports\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     neutron = get_client(context, admin=True)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/nova/network/neutronv2/api.py\", line 237, in get_client\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     auth_token = _ADMIN_AUTH.get_token(_SESSION)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/auth/identity/base.py\", line 200, in get_token\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return self.get_access(session).auth_token\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/auth/identity/base.py\", line 240, in get_access\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     self.auth_ref = self.get_auth_ref(session)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/auth/identity/v2.py\", line 88, in get_auth_ref\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     authenticated=False, log=False)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/session.py\", line 501, in post\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return self.request(url, 'POST', **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/utils.py\", line 337, in inner\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/site-packages/keystoneclient/session.py\", line 401, in request\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions     raise exceptions.from_response(resp, method, url)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions BadRequest: Expecting to find username or userId in passwordCredentials - the server could not comply with the request since it is either malformed or otherwise incorrect. The client is assumed to be in error. (HTTP 400) (Request-ID: req-5a787291-5ea7-42ec-8afc-c9cb2e826fa8)\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions\n2016-01-14 11:00:16.151 11528 INFO nova.api.openstack.wsgi [req-a2d56513-0c19-46e8-9a45-d63fcee17224 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'keystoneclient.exceptions.BadRequest'>\n2016-01-14 11:00:16.154 11528 INFO nova.osapi_compute.wsgi.server [req-a2d56513-0c19-46e8-9a45-d63fcee17224 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] 192.168.178.90 \"POST /v2/ee13d79dc9954b458a8d0f173bd63ccb/servers HTTP/1.1\" status: 500 len: 441 time: 2.8398080\n2016-01-14 11:00:47.647 11521 INFO nova.osapi_compute.wsgi.server [req-194d248a-5394-4cf9-bd38-6292c82ed221 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] 192.168.178.90 \"GET /v2/ HTTP/1.1\" status: 200 len: 579 time: 0.6176820\n2016-01-14 11:00:48.266 11521 INFO nova.osapi_compute.wsgi.server [req-6f5d1860-e3e7-490c-b68a-98f334beba14 7d4aa0f0645248f3b49ec2a4956a2535 ee13d79dc9954b458a8d0f173bd63ccb - - -] 192.168.178.90 \"GET /v2/ee13d79dc9954b458a8d0f173bd63ccb/servers/detail HTTP/1.1\" status: 200 len: 211 time: 0.4220510", 
            "date_created": "2016-01-14 19:21:52.112370+00:00", 
            "author": "https://api.launchpad.net/1.0/~aali0101"
        }, 
        {
            "content": "I will need to look into the \"Unexpected API Error\" part to make sure we're not missing some communication from another service in Nova that would prevent this unhelpful message from popping up. It looks like it's a problem with accessing your credentials. I found this issue posted elsewhere with one possible work around [1].\n\nI'm looking into this further to make sure there isn't a functionality issue in Nova.\n\n2016-01-14 11:00:16.143 11528 ERROR nova.api.openstack.extensions BadRequest: Expecting to find username or userId in passwordCredentials - the server could not comply with the request since it is either malformed or otherwise incorrect. The client is assumed to be in error. (HTTP 400) (Request-ID: req-5a787291-5ea7-42ec-8afc-c9cb2e826fa8)\n\n[1] https://bugzilla.redhat.com/show_bug.cgi?id=1219890\n", 
            "date_created": "2016-01-15 01:23:35.765087+00:00", 
            "author": "https://api.launchpad.net/1.0/~auggy"
        }, 
        {
            "content": "I looked into this and while Nova could revisit how it handles these \"API Errors\" I don't see any obvious functionality issues. I have however linked the openstack-manuals project because it looks like the RDO manual might be missing Keystone configuration information. This is based on the research I did including the link in the other article. If this does not apply to you or the workaround in that link does not fix your problem, then please provide that information here and I'll further research if there is an issue with Nova.", 
            "date_created": "2016-01-15 20:55:13.384106+00:00", 
            "author": "https://api.launchpad.net/1.0/~auggy"
        }, 
        {
            "content": "Please check your entire configuration thoroughly for typos or omissions. They're easy to make and often generate misleading errors.", 
            "date_created": "2016-01-19 03:56:53.324963+00:00", 
            "author": "https://api.launchpad.net/1.0/~ionosphere80"
        }, 
        {
            "content": "If you need more help, please use one of the support channels.", 
            "date_created": "2016-01-19 03:57:19.792946+00:00", 
            "author": "https://api.launchpad.net/1.0/~ionosphere80"
        }, 
        {
            "content": "The Bugzilla bug references Kilo, but this bug references Liberty. Mismatching versions of OpenStack and the installation guide could cause strange problems.", 
            "date_created": "2016-01-19 04:02:41.948834+00:00", 
            "author": "https://api.launchpad.net/1.0/~ionosphere80"
        }, 
        {
            "content": "Thank you, working on new install, close it if applicable.", 
            "date_created": "2016-02-09 21:58:24.232361+00:00", 
            "author": "https://api.launchpad.net/1.0/~aali0101"
        }, 
        {
            "content": "The document is missing this block in nova.conf\n\n[neutron]\nurl = http://controller:9696\nauth_url = http://controller:35357\nauth_plugin = password\nproject_domain_id = default\nuser_domain_id = default\nregion_name = RegionOne\nproject_name = service\nusername = neutron\npassword = neutron_pass\n\nAdding this fixed this issue for my Kilo install.", 
            "date_created": "2016-02-15 23:13:10.198821+00:00", 
            "author": "https://api.launchpad.net/1.0/~ndallamora"
        }, 
        {
            "content": "this problem exist in liberty document too. \ni added [neutron] block in nova.conf (on server) and now every thing works properly \n\n[neutron]\nurl = http://controller:9696\nauth_url = http://controller:35357\nauth_plugin = password\nproject_domain_id = default\nuser_domain_id = default\nregion_name = RegionOne\nproject_name = service\nusername = neutron\npassword = neutron_pass\n\nthanks dallamora.", 
            "date_created": "2016-02-23 07:28:28.068234+00:00", 
            "author": "https://api.launchpad.net/1.0/~iman-darabi"
        }, 
        {
            "content": "i had the same issue with a fresh install of Liberty on Ubuntu 14.04 LTS. After adding the neutron section like mentioned by Iman the error has gone.\n\n+1 for Iman", 
            "date_created": "2016-03-09 13:39:40.441740+00:00", 
            "author": "https://api.launchpad.net/1.0/~thomas-krahn"
        }
    ], 
    "closed": "2016-01-15 20:56:04.571900+00:00"
}