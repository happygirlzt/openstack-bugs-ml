{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:30:14.730136+00:00", 
    "description": "Using Cinder 802c05b. I'm getting the following errors when trying to create a volume:\n\n2012-09-06 14:00:35 ERROR cinder.openstack.common.rpc.amqp [-] Exception during message handling\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp Traceback (most recent call last):\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/openstack/common/rpc/amqp.py\", line 275, in _process_data\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/openstack/common/rpc/dispatcher.py\", line 145, in dispatch\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/volume/manager.py\", line 153, in create_volume\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     volume_ref['id'], {'status': 'error'})\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib64/python2.7/contextlib.py\", line 24, in __exit__\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     self.gen.next()\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/volume/manager.py\", line 147, in create_volume\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     model_update = self.driver.create_export(context, volume_ref)\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/volume/driver.py\", line 365, in create_export\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     volume_path)\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/volume/iscsi.py\", line 145, in create_iscsi_target\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     raise exception.NotFound()\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp NotFound: Resource could not be found.\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp\n\n-----\n\nThe issue appears to be that we no longer specify a --conf file in the iscsi driver for Cinder. The driver still appears to write out a config file but *nothing* is using it.\n\nI traced the cause down to this commit: https://github.com/openstack/cinder/commit/9785963c841aff5ea1c159da81f93c2bf62c70c6", 
    "tags": [], 
    "importance": "Critical", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1046985", 
    "owner": "https://api.launchpad.net/1.0/~dan-prince", 
    "id": 1046985, 
    "index": 80, 
    "openned": "2012-09-06 20:05:53.809497+00:00", 
    "created": "2012-09-06 18:45:57.247570+00:00", 
    "title": "iscsi volume creation fails (--conf file is not being specified)", 
    "comments": [
        {
            "content": "Using Cinder 802c05b. I'm getting the following errors when trying to create a volume:\n\n2012-09-06 14:00:35 ERROR cinder.openstack.common.rpc.amqp [-] Exception during message handling\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp Traceback (most recent call last):\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/openstack/common/rpc/amqp.py\", line 275, in _process_data\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/openstack/common/rpc/dispatcher.py\", line 145, in dispatch\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/volume/manager.py\", line 153, in create_volume\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     volume_ref['id'], {'status': 'error'})\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib64/python2.7/contextlib.py\", line 24, in __exit__\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     self.gen.next()\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/volume/manager.py\", line 147, in create_volume\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     model_update = self.driver.create_export(context, volume_ref)\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/volume/driver.py\", line 365, in create_export\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     volume_path)\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/site-packages/cinder/volume/iscsi.py\", line 145, in create_iscsi_target\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp     raise exception.NotFound()\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp NotFound: Resource could not be found.\n2012-09-06 14:00:35 TRACE cinder.openstack.common.rpc.amqp\n\n-----\n\nThe issue appears to be that we no longer specify a --conf file in the iscsi driver for Cinder. The driver still appears to write out a config file but *nothing* is using it.\n\nI trace the cause down to this commit: https://github.com/openstack/cinder/commit/9785963c841aff5ea1c159da81f93c2bf62c70c6", 
            "date_created": "2012-09-06 18:45:57.247570+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/12517", 
            "date_created": "2012-09-06 18:52:33.277383+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Now that we've merged this breaking commit to Nova it fails as well on master. Using nova-volume on Fedora 17 this is what I'm now seeing as of today (nova revision 0de7b3b) :\n\nVolumeTests\n    test_000_setUp                                              OK\n    test_001_can_create_volume                                  OK\n    test_002_can_attach_volume                                  FAIL\n    test_003_can_mount_volume                                   FAIL\n    test_004_can_write_to_volume                                OK\n    test_005_volume_is_correct_size                             FAIL\n    test_006_me_can_umount_volume                               FAIL\n    test_007_me_can_detach_volume                               ERROR\n    test_008_me_can_delete_volume                               OK\n    test_999_tearDown                                           OK", 
            "date_created": "2012-09-06 20:08:53.937578+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/12517\nCommitted: http://github.com/openstack/cinder/commit/0903603971033536751ba40df98a3c39175d3189\nSubmitter: Jenkins\nBranch:    master\n\ncommit 0903603971033536751ba40df98a3c39175d3189\nAuthor: Dan Prince <email address hidden>\nDate:   Thu Sep 6 14:50:50 2012 -0400\n\n    Specify the conf file when creating a volume.\n    \n    Updates the tgt-admin command to actually use the config file\n    we create for the volume being created.\n    \n    This fixes an issue introduced in\n    9785963c841aff5ea1c159da81f93c2bf62c70c6 which breaks iscsi\n    volume creation.\n    \n    Fixes LP Bug #1046985.\n    \n    Change-Id: I06e83c9ba351c2b4846b557a3abb170a51d506c0\n", 
            "date_created": "2012-09-06 22:47:10.483283+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/12542", 
            "date_created": "2012-09-07 03:05:02.920847+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/12542\nCommitted: http://github.com/openstack/nova/commit/0a09bf5faeb30b675fdb8f517c61166ef794bad3\nSubmitter: Jenkins\nBranch:    master\n\ncommit 0a09bf5faeb30b675fdb8f517c61166ef794bad3\nAuthor: Dan Prince <email address hidden>\nDate:   Thu Sep 6 23:03:50 2012 -0400\n\n    Specify the conf file when creating a volume.\n    \n    Updates the tgt-admin command to actually use the config file\n    we create for the volume being created.\n    \n    This fixes an issue introduced in\n    66f6a9edce3ccd624aba5d2a6bf3362901ed57f7 which breaks iscsi\n    volume creation.\n    \n    Fixes LP Bug #1046985.\n    \n    Change-Id: I58bd23ef6dd0055a329ace8e4b09d86886aa38e9\n", 
            "date_created": "2012-09-10 10:59:03.360808+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2012-09-19 06:32:38.703813+00:00"
}