{
    "status": "Expired", 
    "last_updated": "2017-08-27 04:17:59.328049+00:00", 
    "description": "After start keystone v3 configuration on ubuntu Liberty, I run server list command and get \"unexpected API Error\".\n#openstack --debug server list\nSTART with options: %s(u\"['--debug', 'server', 'list']\",)\noptions: %s(u\"Namespace(access_token_endpoint='', auth_type='', auth_url='https://192.168.0.51:5000/v3', cacert='/root/openst2.pem', client_id='', client_secret='', cloud='', debug=True, default_domain='default', deferred_help=False, domain_id='', domain_name='', endpoint='', identity_provider='', identity_provider_url='', insecure=None, interface='', log_file=None, os_compute_api_version='', os_data_processing_api_version='1.1', os_identity_api_version='3', os_image_api_version='2', os_network_api_version='2', os_object_api_version='', os_project_id=None, os_project_name=None, os_queues_api_version='1.1', os_volume_api_version='', password='***', project_domain_id='', project_domain_name='Default', project_id='', project_name='admin', protocol='', region_name='RegionOne', scope='', service_provider_endpoint='', timeout=600, timing=False, token='', trust_id='', url='', user_domain_id='', user_domain_name='Default', user_id='', username='admin', verbose_level=3, verify=None)\",)\ndefaults: %s{'auth_type': 'password', 'compute_api_version': '2', 'database_api_version': '1.0', 'api_timeout': None, 'baremetal_api_version': '1', 'cacert': None, 'image_api_use_tasks': False, 'floating_ip_source': 'neutron', 'key': None, 'interface': None, 'network_api_version': '2', 'image_format': 'qcow2', 'object_api_version': '1', 'image_api_version': '1', 'verify': True, 'identity_api_version': '2', 'volume_api_version': '1', 'cert': None, 'secgroup_source': 'neutron', 'dns_api_version': '2', 'disable_vendor_agent': {}}\ncloud cfg: %s(u\"{'auth_type': 'password', 'compute_api_version': '2', 'database_api_version': '1.0', 'data_processing_api_version': '1.1', 'network_api_version': '2', 'image_format': 'qcow2', 'object_api_version': '1', 'queues_api_version': '1.1', 'verify': True, 'timing': False, 'dns_api_version': '2', 'verbose_level': 3, 'region_name': 'RegionOne', 'api_timeout': None, 'baremetal_api_version': '1', 'image_api_version': '2', 'auth': {'username': 'admin', 'project_name': 'admin', 'tenant_name': 'admin', 'user_domain_name': 'Default', 'auth_url': 'https://192.168.0.51:5000/v3', 'password': '***', 'project_domain_name': 'Default'}, 'default_domain': 'default', 'image_api_use_tasks': False, 'floating_ip_source': 'neutron', 'key': None, 'cacert': '/root/openst2.pem', 'deferred_help': False, 'identity_api_version': '3', 'volume_api_version': '1', 'cert': None, 'secgroup_source': 'neutron', 'timeout': 600, 'debug': True, 'interface': None, 'disable_vendor_agent': {}}\",)\n%(name)s API version %(version)s, cmd group %(group)s{'version': '2', 'group': 'openstack.compute.v2', 'name': 'compute'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '2', 'group': 'openstack.network.v2', 'name': 'network'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '2', 'group': 'openstack.image.v2', 'name': 'image'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '1', 'group': 'openstack.volume.v1', 'name': 'volume'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '3', 'group': 'openstack.identity.v3', 'name': 'identity'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '1', 'group': 'openstack.object_store.v1', 'name': 'object_store'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '1.1', 'group': 'openstack.data_processing.v1', 'name': 'data_processing'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '1.1', 'group': 'openstack.messaging.v1', 'name': 'messaging'}\ncommand: %s -> %s.%s('server list', 'openstackclient.compute.v2.server', 'ListServer')\nAuth plugin password selected\nauth_type: %s('password',)\nUsing auth plugin: password\nUsing parameters {'username': 'admin', 'project_name': 'admin', 'auth_url': 'https://192.168.0.51:5000/v3', 'tenant_name': 'admin', 'user_domain_name': 'Default', 'password': '***', 'project_domain_name': 'Default'}\nGet auth_ref\nREQ: curl -g -i --cacert \"/root/openst2.pem\" -X GET https://192.168.0.51:5000/v3 -H \"Accept: application/json\" -H \"User-Agent: python-openstackclient\"\nStarting new HTTPS connection (1): 192.168.0.51\n/usr/lib/python2.7/dist-packages/urllib3/util/ssl_.py:90: InsecurePlatformWarning: A true SSLContext object is not available. This prevents urllib3 from configuring SSL appropriately and may cause certain SSL connections to fail. For more information, see https://urllib3.readthedocs.org/en/latest/security.html#insecureplatformwarning.\n  InsecurePlatformWarning\n\"GET /v3 HTTP/1.1\" 200 253\nRESP: [200] content-length: 253 vary: X-Auth-Token server: Apache connection: close date: Thu, 01 Jun 2017 02:39:04 GMT content-type: application/json x-openstack-request-id: req-38e6c560-fde4-4807-b51a-4111c4516f2a \nRESP BODY: {\"version\": {\"status\": \"stable\", \"updated\": \"2015-03-30T00:00:00Z\", \"media-types\": [{\"base\": \"application/json\", \"type\": \"application/vnd.openstack.identity-v3+json\"}], \"id\": \"v3.4\", \"links\": [{\"href\": \"https://192.168.0.51:5000/v3/\", \"rel\": \"self\"}]}}\n\nMaking authentication request to %s(u'https://192.168.0.51:5000/v3/auth/tokens',)\nResetting dropped connection: 135.252.195.2\n\"POST /v3/auth/tokens HTTP/1.1\" 201 7674\n%s(%s)('take_action', \"Namespace(all_projects=False, columns=[], flavor=None, formatter='table', host=None, image=None, instance_name=None, ip=None, ip6=None, long=False, max_width=0, name=None, project=None, project_domain=None, quote_mode='nonnumeric', reservation_id=None, status=None, user=None, user_domain=None)\")\nInstantiating compute client for VAPI Version Major: 2, Minor: 0\nInstantiating identity client: %s(<class 'keystoneclient.v3.client.Client'>,)\nsearch options: %s{'status': None, 'ip': None, 'image': None, 'host': None, 'ip6': None, 'all_tenants': False, 'flavor': None, 'reservation_id': None, 'user_id': None, 'name': None, 'tenant_id': None, 'instance_name': None}\nMaking authentication request to %s(u'https://192.168.0.51:5000/v3/auth/tokens',)\nResetting dropped connection:192.168.0.51\n\"POST /v3/auth/tokens HTTP/1.1\" 201 7674\nREQ: curl -g -i --cacert \"/root/openst2.pem\" -X GET https://192.168.0.51:8774/v2/1d7a9ffd4d8d4f37863e689a2703f3a6/servers/detail -H \"User-Agent: python-novaclient\" -H \"Accept: application/json\" -H \"X-Auth-Token: {SHA1}3f6167f205265fa6f59fbea7a51b0ebbebd0ad04\"\nStarting new HTTPS connection (1): 192.168.0.51\n\"GET /v2/1d7a9ffd4d8d4f37863e689a2703f3a6/servers/detail HTTP/1.1\" 500 193\nRESP: [500] date: Thu, 01 Jun 2017 02:39:05 GMT connection: close content-type: application/json; charset=UTF-8 content-length: 193 x-compute-request-id: req-e6ed8190-f926-4f00-8e51-1ebcce98ab7e \nRESP BODY: {\"computeFault\": {\"message\": \"Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\\n<type 'exceptions.TypeError'>\", \"code\": 500}}\n\nUnexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'> (HTTP 500) (Request-ID: req-e6ed8190-f926-4f00-8e51-1ebcce98ab7e)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/dist-packages/cliff/app.py\", line 374, in run_subcommand\n    result = cmd.run(parsed_args)\n  File \"/usr/lib/python2.7/dist-packages/cliff/display.py\", line 92, in run\n    column_names, data = self.take_action(parsed_args)\n  File \"/usr/lib/python2.7/dist-packages/openstackclient/common/utils.py\", line 46, in wrapper\n    return func(self, *args, **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/openstackclient/compute/v2/server.py\", line 787, in take_action\n    data = compute_client.servers.list(search_opts=search_opts)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/v2/servers.py\", line 608, in list\n    \"servers\")\n  File \"/usr/lib/python2.7/dist-packages/novaclient/base.py\", line 72, in _list\n    _resp, body = self.api.client.get(url)\n  File \"/usr/lib/python2.7/dist-packages/keystoneclient/adapter.py\", line 170, in get\n    return self.request(url, 'GET', **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/client.py\", line 93, in request\n    raise exceptions.from_response(resp, body, url, method)\nClientException: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'> (HTTP 500) (Request-ID: req-e6ed8190-f926-4f00-8e51-1ebcce98ab7e)\nclean_up %s: %s('ListServer', ClientException())\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/dist-packages/openstackclient/shell.py\", line 113, in run\n    ret_val = super(OpenStackShell, self).run(argv)\n  File \"/usr/lib/python2.7/dist-packages/cliff/app.py\", line 255, in run\n    result = self.run_subcommand(remainder)\n  File \"/usr/lib/python2.7/dist-packages/cliff/app.py\", line 374, in run_subcommand\n    result = cmd.run(parsed_args)\n  File \"/usr/lib/python2.7/dist-packages/cliff/display.py\", line 92, in run\n    column_names, data = self.take_action(parsed_args)\n  File \"/usr/lib/python2.7/dist-packages/openstackclient/common/utils.py\", line 46, in wrapper\n    return func(self, *args, **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/openstackclient/compute/v2/server.py\", line 787, in take_action\n    data = compute_client.servers.list(search_opts=search_opts)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/v2/servers.py\", line 608, in list\n    \"servers\")\n  File \"/usr/lib/python2.7/dist-packages/novaclient/base.py\", line 72, in _list\n    _resp, body = self.api.client.get(url)\n  File \"/usr/lib/python2.7/dist-packages/keystoneclient/adapter.py\", line 170, in get\n    return self.request(url, 'GET', **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/client.py\", line 93, in request\n    raise exceptions.from_response(resp, body, url, method)\nClientException: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'> (HTTP 500) (Request-ID: req-e6ed8190-f926-4f00-8e51-1ebcce98ab7e)\n\n=================================================================================================\nnova-api.log:\n\n2017-05-31 11:00:30.594 474935 DEBUG nova.osapi_compute.wsgi.server [-] (474935) accepted ('240.0.0.2', 37775) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n:$\n2017-06-01 02:52:59.028 474936 DEBUG iso8601.iso8601 [-] Got u'2017' for 'year' with default None to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.029 474936 DEBUG iso8601.iso8601 [-] Got u'06' for 'monthdash' with default 1 to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.029 474936 DEBUG iso8601.iso8601 [-] Got 6 for 'month' with default 6 to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.030 474936 DEBUG iso8601.iso8601 [-] Got u'01' for 'daydash' with default 1 to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.030 474936 DEBUG iso8601.iso8601 [-] Got 1 for 'day' with default 1 to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.031 474936 DEBUG iso8601.iso8601 [-] Got u'03' for 'hour' with default None to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.031 474936 DEBUG iso8601.iso8601 [-] Got u'40' for 'minute' with default None to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.032 474936 DEBUG iso8601.iso8601 [-] Got u'13' for 'second' with default None to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.034 474936 DEBUG keystonemiddleware.auth_token [-] Received request from user: user_id a30343f8d1cc454582b4908e69db5a86, project_id 1d7a9ffd4d8d4f37863e689a2703f3a6, roles admin process_request /usr/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py:759\n2017-06-01 02:52:59.036 474936 DEBUG nova.utils [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Reloading cached file /etc/nova/policy.json read_cached_file /usr/lib/python2.7/dist-packages/nova/utils.py:1525\n2017-06-01 02:52:59.041 474936 DEBUG nova.openstack.common.policy [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Reloaded policy file: /etc/nova/policy.json _load_policy_file /usr/lib/python2.7/dist-packages/nova/openstack/common/policy.py:295\n2017-06-01 02:52:59.375 474936 DEBUG routes.middleware [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Matched GET /1d7a9ffd4d8d4f37863e689a2703f3a6/limits __call__ /usr/lib/python2.7/dist-packages/routes/middleware.py:105\n2017-06-01 02:52:59.376 474936 DEBUG routes.middleware [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Route path: '/{project_id}/limits', defaults: {'action': u'index', 'controller': <nova.api.openstack.wsgi.ResourceV21 object at 0x7f5db7c92450>} __call__ /usr/lib/python2.7/dist-packages/routes/middleware.py:107\n2017-06-01 02:52:59.376 474936 DEBUG routes.middleware [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Match dict: {'action': u'index', 'controller': <nova.api.openstack.wsgi.ResourceV21 object at 0x7f5db7c92450>, 'project_id': u'1d7a9ffd4d8d4f37863e689a2703f3a6'} __call__ /usr/lib/python2.7/dist-packages/routes/middleware.py:108\n2017-06-01 02:52:59.377 474936 DEBUG nova.api.openstack.wsgi [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Calling method '<bound method LimitsController.index of <nova.api.openstack.compute.limits.LimitsController object at 0x7f5db7cf1ed0>>' _process_stack /usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py:792\n2017-06-01 02:52:59.382 474936 INFO nova.osapi_compute.wsgi.server [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] 192.168.0.51 \"GET /v2/1d7a9ffd4d8d4f37863e689a2703f3a6/limits HTTP/1.1\" status: 200 len: 701 time: 0.3726971\n2017-06-01 02:53:01.377 474981 DEBUG nova.metadata.wsgi.server [-] (474981) accepted ('192.168.0.51', 53493) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:53:01.382 474981 INFO nova.api.ec2 [-] 0.438s 192.168.0.51 OPTIONS / None:None 200 [None] text/plain text/plain\n2017-06-01 02:53:01.383 474981 INFO nova.metadata.wsgi.server [-] 192.168.0.51 \"OPTIONS / HTTP/1.0\" status: 200 len: 234 time: 0.0020192\n2017-06-01 02:53:02.364 474981 DEBUG nova.metadata.wsgi.server [-] (474981) accepted ('240.0.0.2', 58832) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:53:02.366 474981 INFO nova.api.ec2 [-] 0.263s 240.0.0.2 OPTIONS / None:None 200 [None] text/plain text/plain\n2017-06-01 02:53:02.367 474981 INFO nova.metadata.wsgi.server [-] 240.0.0.2 \"OPTIONS / HTTP/1.0\" status: 200 len: 234 time: 0.0014482\n2017-06-01 02:53:06.906 474944 DEBUG nova.osapi_compute.wsgi.server [-] (474944) accepted ('192.168.0.51', 36586) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:53:06.908 474944 DEBUG nova.api.openstack.wsgi [-] Calling method '<bound method Versions.index of <nova.api.openstack.compute.versions.Versions object at 0x7f5db8205550>>' _process_stack /usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py:792\n2017-06-01 02:53:06.912 474944 INFO nova.osapi_compute.wsgi.server [-] 192.168.0.51 \"OPTIONS / HTTP/1.0\" status: 200 len: 501 time: 0.0042901\n2017-06-01 02:53:07.146 474927 DEBUG nova.osapi_compute.wsgi.server [-] (474927) accepted ('240.0.0.2', 35045) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:53:07.148 474927 DEBUG nova.api.openstack.wsgi [-] Calling method '<bound method Versions.index of <nova.api.openstack.compute.versions.Versions object at 0x7f5db8205550>>' _process_stack /usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py:792\n2017-06-01 02:53:07.155 474927 INFO nova.osapi_compute.wsgi.server [-] 240.0.0.2 \"OPTIONS / HTTP/1.0\" status: 200 len: 501 time: 0.0043240\n~\n?ERROR                                                                                                                                                \n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 1271, in _log\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     self.handle(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 1281, in handle\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 1271, in _log\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     self.handle(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 1281, in handle\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     self.callHandlers(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 1321, in callHandlers\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     hdlr.handle(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 749, in handle\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     self.emit(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/dist-packages/oslo_log/handlers.py\", line 101, in emit\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     self.format(record))\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 724, in format\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     return fmt.format(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/dist-packages/oslo_log/formatters.py\", line 236, in format\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     return logging.Formatter.format(self, record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 464, in format\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     record.message = record.getMessage()\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 328, in getMessage\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     msg = msg % self.args\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/strategy_options.py\", line 183, in __str__\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     return \"Load(strategy=%r)\" % self.strategy\n2017-06-01 02:40:28.389 474943 ERRO Rnovd API Error:enstack.extensions TypeError: not all arguments converted during string formatting\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions\n2017-06-01 02:40:28.393 474943 INFO nova.api.openstack.wsgi [req-2720084a-4899-45bb-afe6-58500be3cccf a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'>\n2017-06-01 02:40:28.394 474943 DEBUG nova.api.openstack.wsgi [req-2720084a-4899-45bb-afe6-58500be3cccf a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'> __call__ /usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py:1175\n2017-06-01 02:40:28.395 474943 INFO nova.osapi_compute.wsgi.server [req-2720084a-4899-45bb-afe6-58500be3cccf a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] 192.168.0.51 \"GET /v2/1d7a9ffd4d8d4f37863e689a2703f3a6/os-simple-tenant-usage?start=2017-05-31T00:00:00&end=2017-06-01T23:59:59&detailed=1 HTTP/1.1\" status: 500 len: 419 time: 1.1530519\n2017-06-01 02:40:30.214 474965 DEBUG nova.metadata.wsgi.server [-] (474965) accepted ('192.168.0.51', 47646) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:40:30.215 474965 INFO nova.api.ec2 [-] 0.172s 192.168.0.51 OPTIONS / None:None 200 [None] text/plain text/plain\n2017-06-01 02:40:30.215 474965 INFO nova.metadata.wsgi.server [-] 192.168.0.51 \"OPTIONS / HTTP/1.0\" status: 200 len: 234 time: 0.0007858\n2017-06-01 02:40:30.874 474965 DEBUG nova.metadata.wsgi.server [-] (474965) accepted ('240.0.0.2', 52537) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:40:30.875 474965 INFO nova.api.ec2 [-] 0.143s 240.0.0.2 OPTIONS / None:None 200 [None] text/plain text/plain\n======================================================================\n#dpkg -l | grep nova\nii  nova-api                             2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - compute API frontend\nii  nova-cert                            2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - certificate manager\nii  nova-common                          2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - common files\nii  nova-conductor                       2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - conductor service\nii  nova-consoleauth                     2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - Console Authenticator\nii  nova-consoleproxy                    2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - NoVNC proxy\nii  nova-objectstore                     2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - object store\nii  nova-scheduler                       2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - virtual machine scheduler\nii  python-nova                          2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - libraries\nii  python-novaclient                    2:2.30.2-1~u14.04+mos5                 all          client library for OpenStack Compute API\n\nStorage is Ceph.\n===========================================================================", 
    "tags": [
        "openstack-version.liberty"
    ], 
    "importance": "Undecided", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1694873", 
    "owner": "None", 
    "id": 1694873, 
    "index": 8140, 
    "openned": "2017-06-01 02:20:03.267737+00:00", 
    "created": "2017-06-01 02:20:03.267737+00:00", 
    "title": "openstack server list report 'Unexpected API Error' under unbuntu liberty keystone v3", 
    "comments": [
        {
            "content": "After start keystone v3 configuration on ubuntu Liberty, I run server list command and get \"unexpected API Error\".\n#openstack --debug server list\nSTART with options: %s(u\"['--debug', 'server', 'list']\",)\noptions: %s(u\"Namespace(access_token_endpoint='', auth_type='', auth_url='https://192.168.0.51:5000/v3', cacert='/root/openst2.pem', client_id='', client_secret='', cloud='', debug=True, default_domain='default', deferred_help=False, domain_id='', domain_name='', endpoint='', identity_provider='', identity_provider_url='', insecure=None, interface='', log_file=None, os_compute_api_version='', os_data_processing_api_version='1.1', os_identity_api_version='3', os_image_api_version='2', os_network_api_version='2', os_object_api_version='', os_project_id=None, os_project_name=None, os_queues_api_version='1.1', os_volume_api_version='', password='***', project_domain_id='', project_domain_name='Default', project_id='', project_name='admin', protocol='', region_name='RegionOne', scope='', service_provider_endpoint='', timeout=600, timing=False, token='', trust_id='', url='', user_domain_id='', user_domain_name='Default', user_id='', username='admin', verbose_level=3, verify=None)\",)\ndefaults: %s{'auth_type': 'password', 'compute_api_version': '2', 'database_api_version': '1.0', 'api_timeout': None, 'baremetal_api_version': '1', 'cacert': None, 'image_api_use_tasks': False, 'floating_ip_source': 'neutron', 'key': None, 'interface': None, 'network_api_version': '2', 'image_format': 'qcow2', 'object_api_version': '1', 'image_api_version': '1', 'verify': True, 'identity_api_version': '2', 'volume_api_version': '1', 'cert': None, 'secgroup_source': 'neutron', 'dns_api_version': '2', 'disable_vendor_agent': {}}\ncloud cfg: %s(u\"{'auth_type': 'password', 'compute_api_version': '2', 'database_api_version': '1.0', 'data_processing_api_version': '1.1', 'network_api_version': '2', 'image_format': 'qcow2', 'object_api_version': '1', 'queues_api_version': '1.1', 'verify': True, 'timing': False, 'dns_api_version': '2', 'verbose_level': 3, 'region_name': 'RegionOne', 'api_timeout': None, 'baremetal_api_version': '1', 'image_api_version': '2', 'auth': {'username': 'admin', 'project_name': 'admin', 'tenant_name': 'admin', 'user_domain_name': 'Default', 'auth_url': 'https://192.168.0.51:5000/v3', 'password': '***', 'project_domain_name': 'Default'}, 'default_domain': 'default', 'image_api_use_tasks': False, 'floating_ip_source': 'neutron', 'key': None, 'cacert': '/root/openst2.pem', 'deferred_help': False, 'identity_api_version': '3', 'volume_api_version': '1', 'cert': None, 'secgroup_source': 'neutron', 'timeout': 600, 'debug': True, 'interface': None, 'disable_vendor_agent': {}}\",)\n%(name)s API version %(version)s, cmd group %(group)s{'version': '2', 'group': 'openstack.compute.v2', 'name': 'compute'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '2', 'group': 'openstack.network.v2', 'name': 'network'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '2', 'group': 'openstack.image.v2', 'name': 'image'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '1', 'group': 'openstack.volume.v1', 'name': 'volume'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '3', 'group': 'openstack.identity.v3', 'name': 'identity'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '1', 'group': 'openstack.object_store.v1', 'name': 'object_store'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '1.1', 'group': 'openstack.data_processing.v1', 'name': 'data_processing'}\n%(name)s API version %(version)s, cmd group %(group)s{'version': '1.1', 'group': 'openstack.messaging.v1', 'name': 'messaging'}\ncommand: %s -> %s.%s('server list', 'openstackclient.compute.v2.server', 'ListServer')\nAuth plugin password selected\nauth_type: %s('password',)\nUsing auth plugin: password\nUsing parameters {'username': 'admin', 'project_name': 'admin', 'auth_url': 'https://192.168.0.51:5000/v3', 'tenant_name': 'admin', 'user_domain_name': 'Default', 'password': '***', 'project_domain_name': 'Default'}\nGet auth_ref\nREQ: curl -g -i --cacert \"/root/openst2.pem\" -X GET https://192.168.0.51:5000/v3 -H \"Accept: application/json\" -H \"User-Agent: python-openstackclient\"\nStarting new HTTPS connection (1): 192.168.0.51\n/usr/lib/python2.7/dist-packages/urllib3/util/ssl_.py:90: InsecurePlatformWarning: A true SSLContext object is not available. This prevents urllib3 from configuring SSL appropriately and may cause certain SSL connections to fail. For more information, see https://urllib3.readthedocs.org/en/latest/security.html#insecureplatformwarning.\n  InsecurePlatformWarning\n\"GET /v3 HTTP/1.1\" 200 253\nRESP: [200] content-length: 253 vary: X-Auth-Token server: Apache connection: close date: Thu, 01 Jun 2017 02:39:04 GMT content-type: application/json x-openstack-request-id: req-38e6c560-fde4-4807-b51a-4111c4516f2a \nRESP BODY: {\"version\": {\"status\": \"stable\", \"updated\": \"2015-03-30T00:00:00Z\", \"media-types\": [{\"base\": \"application/json\", \"type\": \"application/vnd.openstack.identity-v3+json\"}], \"id\": \"v3.4\", \"links\": [{\"href\": \"https://192.168.0.51:5000/v3/\", \"rel\": \"self\"}]}}\n\nMaking authentication request to %s(u'https://192.168.0.51:5000/v3/auth/tokens',)\nResetting dropped connection: 135.252.195.2\n\"POST /v3/auth/tokens HTTP/1.1\" 201 7674\n%s(%s)('take_action', \"Namespace(all_projects=False, columns=[], flavor=None, formatter='table', host=None, image=None, instance_name=None, ip=None, ip6=None, long=False, max_width=0, name=None, project=None, project_domain=None, quote_mode='nonnumeric', reservation_id=None, status=None, user=None, user_domain=None)\")\nInstantiating compute client for VAPI Version Major: 2, Minor: 0\nInstantiating identity client: %s(<class 'keystoneclient.v3.client.Client'>,)\nsearch options: %s{'status': None, 'ip': None, 'image': None, 'host': None, 'ip6': None, 'all_tenants': False, 'flavor': None, 'reservation_id': None, 'user_id': None, 'name': None, 'tenant_id': None, 'instance_name': None}\nMaking authentication request to %s(u'https://192.168.0.51:5000/v3/auth/tokens',)\nResetting dropped connection:192.168.0.51\n\"POST /v3/auth/tokens HTTP/1.1\" 201 7674\nREQ: curl -g -i --cacert \"/root/openst2.pem\" -X GET https://192.168.0.51:8774/v2/1d7a9ffd4d8d4f37863e689a2703f3a6/servers/detail -H \"User-Agent: python-novaclient\" -H \"Accept: application/json\" -H \"X-Auth-Token: {SHA1}3f6167f205265fa6f59fbea7a51b0ebbebd0ad04\"\nStarting new HTTPS connection (1): 192.168.0.51\n\"GET /v2/1d7a9ffd4d8d4f37863e689a2703f3a6/servers/detail HTTP/1.1\" 500 193\nRESP: [500] date: Thu, 01 Jun 2017 02:39:05 GMT connection: close content-type: application/json; charset=UTF-8 content-length: 193 x-compute-request-id: req-e6ed8190-f926-4f00-8e51-1ebcce98ab7e \nRESP BODY: {\"computeFault\": {\"message\": \"Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\\n<type 'exceptions.TypeError'>\", \"code\": 500}}\n\nUnexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'> (HTTP 500) (Request-ID: req-e6ed8190-f926-4f00-8e51-1ebcce98ab7e)\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/dist-packages/cliff/app.py\", line 374, in run_subcommand\n    result = cmd.run(parsed_args)\n  File \"/usr/lib/python2.7/dist-packages/cliff/display.py\", line 92, in run\n    column_names, data = self.take_action(parsed_args)\n  File \"/usr/lib/python2.7/dist-packages/openstackclient/common/utils.py\", line 46, in wrapper\n    return func(self, *args, **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/openstackclient/compute/v2/server.py\", line 787, in take_action\n    data = compute_client.servers.list(search_opts=search_opts)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/v2/servers.py\", line 608, in list\n    \"servers\")\n  File \"/usr/lib/python2.7/dist-packages/novaclient/base.py\", line 72, in _list\n    _resp, body = self.api.client.get(url)\n  File \"/usr/lib/python2.7/dist-packages/keystoneclient/adapter.py\", line 170, in get\n    return self.request(url, 'GET', **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/client.py\", line 93, in request\n    raise exceptions.from_response(resp, body, url, method)\nClientException: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'> (HTTP 500) (Request-ID: req-e6ed8190-f926-4f00-8e51-1ebcce98ab7e)\nclean_up %s: %s('ListServer', ClientException())\nTraceback (most recent call last):\n  File \"/usr/lib/python2.7/dist-packages/openstackclient/shell.py\", line 113, in run\n    ret_val = super(OpenStackShell, self).run(argv)\n  File \"/usr/lib/python2.7/dist-packages/cliff/app.py\", line 255, in run\n    result = self.run_subcommand(remainder)\n  File \"/usr/lib/python2.7/dist-packages/cliff/app.py\", line 374, in run_subcommand\n    result = cmd.run(parsed_args)\n  File \"/usr/lib/python2.7/dist-packages/cliff/display.py\", line 92, in run\n    column_names, data = self.take_action(parsed_args)\n  File \"/usr/lib/python2.7/dist-packages/openstackclient/common/utils.py\", line 46, in wrapper\n    return func(self, *args, **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/openstackclient/compute/v2/server.py\", line 787, in take_action\n    data = compute_client.servers.list(search_opts=search_opts)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/v2/servers.py\", line 608, in list\n    \"servers\")\n  File \"/usr/lib/python2.7/dist-packages/novaclient/base.py\", line 72, in _list\n    _resp, body = self.api.client.get(url)\n  File \"/usr/lib/python2.7/dist-packages/keystoneclient/adapter.py\", line 170, in get\n    return self.request(url, 'GET', **kwargs)\n  File \"/usr/lib/python2.7/dist-packages/novaclient/client.py\", line 93, in request\n    raise exceptions.from_response(resp, body, url, method)\nClientException: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'> (HTTP 500) (Request-ID: req-e6ed8190-f926-4f00-8e51-1ebcce98ab7e)\n\n=================================================================================================\nnova-api.log:\n\n2017-05-31 11:00:30.594 474935 DEBUG nova.osapi_compute.wsgi.server [-] (474935) accepted ('240.0.0.2', 37775) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n:$\n2017-06-01 02:52:59.028 474936 DEBUG iso8601.iso8601 [-] Got u'2017' for 'year' with default None to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.029 474936 DEBUG iso8601.iso8601 [-] Got u'06' for 'monthdash' with default 1 to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.029 474936 DEBUG iso8601.iso8601 [-] Got 6 for 'month' with default 6 to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.030 474936 DEBUG iso8601.iso8601 [-] Got u'01' for 'daydash' with default 1 to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.030 474936 DEBUG iso8601.iso8601 [-] Got 1 for 'day' with default 1 to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.031 474936 DEBUG iso8601.iso8601 [-] Got u'03' for 'hour' with default None to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.031 474936 DEBUG iso8601.iso8601 [-] Got u'40' for 'minute' with default None to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.032 474936 DEBUG iso8601.iso8601 [-] Got u'13' for 'second' with default None to_int /usr/lib/python2.7/dist-packages/iso8601/iso8601.py:140\n2017-06-01 02:52:59.034 474936 DEBUG keystonemiddleware.auth_token [-] Received request from user: user_id a30343f8d1cc454582b4908e69db5a86, project_id 1d7a9ffd4d8d4f37863e689a2703f3a6, roles admin process_request /usr/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py:759\n2017-06-01 02:52:59.036 474936 DEBUG nova.utils [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Reloading cached file /etc/nova/policy.json read_cached_file /usr/lib/python2.7/dist-packages/nova/utils.py:1525\n2017-06-01 02:52:59.041 474936 DEBUG nova.openstack.common.policy [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Reloaded policy file: /etc/nova/policy.json _load_policy_file /usr/lib/python2.7/dist-packages/nova/openstack/common/policy.py:295\n2017-06-01 02:52:59.375 474936 DEBUG routes.middleware [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Matched GET /1d7a9ffd4d8d4f37863e689a2703f3a6/limits __call__ /usr/lib/python2.7/dist-packages/routes/middleware.py:105\n2017-06-01 02:52:59.376 474936 DEBUG routes.middleware [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Route path: '/{project_id}/limits', defaults: {'action': u'index', 'controller': <nova.api.openstack.wsgi.ResourceV21 object at 0x7f5db7c92450>} __call__ /usr/lib/python2.7/dist-packages/routes/middleware.py:107\n2017-06-01 02:52:59.376 474936 DEBUG routes.middleware [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Match dict: {'action': u'index', 'controller': <nova.api.openstack.wsgi.ResourceV21 object at 0x7f5db7c92450>, 'project_id': u'1d7a9ffd4d8d4f37863e689a2703f3a6'} __call__ /usr/lib/python2.7/dist-packages/routes/middleware.py:108\n2017-06-01 02:52:59.377 474936 DEBUG nova.api.openstack.wsgi [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Calling method '<bound method LimitsController.index of <nova.api.openstack.compute.limits.LimitsController object at 0x7f5db7cf1ed0>>' _process_stack /usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py:792\n2017-06-01 02:52:59.382 474936 INFO nova.osapi_compute.wsgi.server [req-e4f3d847-1991-47fd-a895-92f0e8265a5d a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] 192.168.0.51 \"GET /v2/1d7a9ffd4d8d4f37863e689a2703f3a6/limits HTTP/1.1\" status: 200 len: 701 time: 0.3726971\n2017-06-01 02:53:01.377 474981 DEBUG nova.metadata.wsgi.server [-] (474981) accepted ('192.168.0.51', 53493) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:53:01.382 474981 INFO nova.api.ec2 [-] 0.438s 192.168.0.51 OPTIONS / None:None 200 [None] text/plain text/plain\n2017-06-01 02:53:01.383 474981 INFO nova.metadata.wsgi.server [-] 192.168.0.51 \"OPTIONS / HTTP/1.0\" status: 200 len: 234 time: 0.0020192\n2017-06-01 02:53:02.364 474981 DEBUG nova.metadata.wsgi.server [-] (474981) accepted ('240.0.0.2', 58832) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:53:02.366 474981 INFO nova.api.ec2 [-] 0.263s 240.0.0.2 OPTIONS / None:None 200 [None] text/plain text/plain\n2017-06-01 02:53:02.367 474981 INFO nova.metadata.wsgi.server [-] 240.0.0.2 \"OPTIONS / HTTP/1.0\" status: 200 len: 234 time: 0.0014482\n2017-06-01 02:53:06.906 474944 DEBUG nova.osapi_compute.wsgi.server [-] (474944) accepted ('192.168.0.51', 36586) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:53:06.908 474944 DEBUG nova.api.openstack.wsgi [-] Calling method '<bound method Versions.index of <nova.api.openstack.compute.versions.Versions object at 0x7f5db8205550>>' _process_stack /usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py:792\n2017-06-01 02:53:06.912 474944 INFO nova.osapi_compute.wsgi.server [-] 192.168.0.51 \"OPTIONS / HTTP/1.0\" status: 200 len: 501 time: 0.0042901\n2017-06-01 02:53:07.146 474927 DEBUG nova.osapi_compute.wsgi.server [-] (474927) accepted ('240.0.0.2', 35045) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:53:07.148 474927 DEBUG nova.api.openstack.wsgi [-] Calling method '<bound method Versions.index of <nova.api.openstack.compute.versions.Versions object at 0x7f5db8205550>>' _process_stack /usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py:792\n2017-06-01 02:53:07.155 474927 INFO nova.osapi_compute.wsgi.server [-] 240.0.0.2 \"OPTIONS / HTTP/1.0\" status: 200 len: 501 time: 0.0043240\n~\n?ERROR                                                                                                                                                \n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 1271, in _log\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     self.handle(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 1281, in handle\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 1271, in _log\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     self.handle(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 1281, in handle\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     self.callHandlers(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 1321, in callHandlers\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     hdlr.handle(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 749, in handle\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     self.emit(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/dist-packages/oslo_log/handlers.py\", line 101, in emit\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     self.format(record))\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 724, in format\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     return fmt.format(record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/dist-packages/oslo_log/formatters.py\", line 236, in format\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     return logging.Formatter.format(self, record)\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 464, in format\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     record.message = record.getMessage()\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/logging/__init__.py\", line 328, in getMessage\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     msg = msg % self.args\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/strategy_options.py\", line 183, in __str__\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions     return \"Load(strategy=%r)\" % self.strategy\n2017-06-01 02:40:28.389 474943 ERRO Rnovd API Error:enstack.extensions TypeError: not all arguments converted during string formatting\n2017-06-01 02:40:28.389 474943 ERROR nova.api.openstack.extensions\n2017-06-01 02:40:28.393 474943 INFO nova.api.openstack.wsgi [req-2720084a-4899-45bb-afe6-58500be3cccf a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'>\n2017-06-01 02:40:28.394 474943 DEBUG nova.api.openstack.wsgi [req-2720084a-4899-45bb-afe6-58500be3cccf a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'> __call__ /usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py:1175\n2017-06-01 02:40:28.395 474943 INFO nova.osapi_compute.wsgi.server [req-2720084a-4899-45bb-afe6-58500be3cccf a30343f8d1cc454582b4908e69db5a86 1d7a9ffd4d8d4f37863e689a2703f3a6 - - -] 192.168.0.51 \"GET /v2/1d7a9ffd4d8d4f37863e689a2703f3a6/os-simple-tenant-usage?start=2017-05-31T00:00:00&end=2017-06-01T23:59:59&detailed=1 HTTP/1.1\" status: 500 len: 419 time: 1.1530519\n2017-06-01 02:40:30.214 474965 DEBUG nova.metadata.wsgi.server [-] (474965) accepted ('192.168.0.51', 47646) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:40:30.215 474965 INFO nova.api.ec2 [-] 0.172s 192.168.0.51 OPTIONS / None:None 200 [None] text/plain text/plain\n2017-06-01 02:40:30.215 474965 INFO nova.metadata.wsgi.server [-] 192.168.0.51 \"OPTIONS / HTTP/1.0\" status: 200 len: 234 time: 0.0007858\n2017-06-01 02:40:30.874 474965 DEBUG nova.metadata.wsgi.server [-] (474965) accepted ('240.0.0.2', 52537) server /usr/lib/python2.7/dist-packages/eventlet/wsgi.py:826\n2017-06-01 02:40:30.875 474965 INFO nova.api.ec2 [-] 0.143s 240.0.0.2 OPTIONS / None:None 200 [None] text/plain text/plain\n======================================================================\n#dpkg -l | grep nova\nii  nova-api                             2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - compute API frontend\nii  nova-cert                            2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - certificate manager\nii  nova-common                          2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - common files\nii  nova-conductor                       2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - conductor service\nii  nova-consoleauth                     2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - Console Authenticator\nii  nova-consoleproxy                    2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - NoVNC proxy\nii  nova-objectstore                     2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - object store\nii  nova-scheduler                       2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - virtual machine scheduler\nii  python-nova                          2:12.0.2-1~u14.04+mos21                all          OpenStack Compute - libraries\nii  python-novaclient                    2:2.30.2-1~u14.04+mos5                 all          client library for OpenStack Compute API\n\nStorage is Ceph.\n===========================================================================", 
            "date_created": "2017-06-01 02:20:03.267737+00:00", 
            "author": "https://api.launchpad.net/1.0/~liangbsh"
        }, 
        {
            "content": "not sure this is related to V3, looks like some format error about log somewhere \ndo you have full api log and this is 'liberty' so not sure it's already fixed bug or not", 
            "date_created": "2017-06-01 06:10:57.138514+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }, 
        {
            "content": "It is very strange now. I use fuel server to install this openstack env. And I have 2 controller and 7 compute.\n\nWhen i retry the command \"openstack server list\" 2 times. I would get one correct result and one failure result.\n[root@node-100 ~(keystone_admin)]#openstack server list\n+--------------------------------------+--------+--------+----------+\n| ID                                   | Name   | Status | Networks |\n+--------------------------------------+--------+--------+----------+\n| 4d605d6f-2019-46b2-b853-d402081b3ff6 | cbamsp | ERROR  |          |\n+--------------------------------------+--------+--------+----------+\n[root@node-100 ~(keystone_admin)]#openstack server list\nUnexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<type 'exceptions.TypeError'> (HTTP 500) (Request-ID: req-b1210b65-85c5-4b27-82fa-b60b9f0a2071)\n\nI paste the nova-api.log and command debug output of this issue.\nPlease see attachment file.\n", 
            "date_created": "2017-06-01 09:08:18.803560+00:00", 
            "author": "https://api.launchpad.net/1.0/~liangbsh"
        }, 
        {
            "content": "I checked the log carefully and found it seems has issue with nova.metadata.wsgi.server. If the server ip is 192.168.0.51, it would has issue. If it is 240.0.0.2, there was no issue. I don't know where is ip 240.0.0.2.", 
            "date_created": "2017-06-01 09:33:15.551297+00:00", 
            "author": "https://api.launchpad.net/1.0/~liangbsh"
        }, 
        {
            "content": "There is some issue when querying instances out of the database and it's logging something, which blows up. Are you using pymysql for the database connection? Because MySQL-python doesn't support eventlet and logging in the DB API can blow up when using eventlet.\n\nLiberty is end of life upstream at this point, so if you're working with a distribution/vendor like Mirantis you'll probably need help from their support team, otherwise I'd think you should upgrade to a newer supported release upstream like Ocata.", 
            "date_created": "2017-06-01 13:40:16.541533+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "I use mysql for database for connection.By the way, this issue only occurs after applying keystone V3 configuration. With keystone V2.0, there is no such issue. So I think this shall be one issue.", 
            "date_created": "2017-06-01 14:18:17.668390+00:00", 
            "author": "https://api.launchpad.net/1.0/~liangbsh"
        }, 
        {
            "content": "The issue is similar like this one:\nhttps://bugs.launchpad.net/nova/+bug/1253089.\n\nCan you help to confirm if the fix is included in this Liberty ?\nThanks", 
            "date_created": "2017-06-02 07:19:54.365233+00:00", 
            "author": "https://api.launchpad.net/1.0/~liangbsh"
        }, 
        {
            "content": "https://review.openstack.org/#/c/57447/ was fixed in Icehouse so it's in Liberty, so that's probably not your issue. I don't see why using keystone v3 would really have anything to do with how the internal DB API (or logging) works.", 
            "date_created": "2017-06-02 12:50:54.696188+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "By the way, what I meant about the database connection URL was, are you using MySQL-python or PyMySQL?\n\nhttps://pypi.python.org/pypi/MySQL-python\n\nhttps://pypi.python.org/pypi/PyMySQL\n\nThe latter works with eventlet, which is important if there is any logging happening in the DB API layer, which it looks like it is in this case.", 
            "date_created": "2017-06-02 12:52:22.827965+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "You can tell by looking at the [database]/connection config option in nova.conf, e.g.:\n\nhttp://logs.openstack.org/40/469740/2/check/gate-tempest-dsvm-neutron-full-ubuntu-xenial/bd1e20b/logs/etc/nova/nova.conf.txt.gz\n\nconnection = mysql+pymysql://root:secretmysql@127.0.0.1/nova?charset=utf8", 
            "date_created": "2017-06-02 12:53:24.606660+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Hi\uff0c\nMy nova.conf content like following\uff1a\n[DEFAULT]\ndebug = True\nverbose = True\nlog_dir = /var/log/nova\nuse_syslog = True\nuse_syslog_rfc_format = True\nsyslog_log_facility = LOG_LOCAL6\nuse_stderr = False\ndefault_log_levels = amqp=DEBUG,amqplib=DEBUG,boto=DEBUG,iso8601=DEBUG,keystonemiddleware=DEBUG,oslo.messaging=DEBUG,oslo_messaging=DEBUG,qpid=DEBUG,requests.packages.urllib3.connectionpool=DEBUG,requests.packages.urllib3.util.retry=DEBUG,routes.middleware=DEBUG,sqlalchemy=DEBUG,stevedore=DEBUG,suds=DEBUG,taskflow=DEBUG,urllib3.connectionpool=DEBUG,urllib3.util.retry=DEBUG,websocket=DEBUG\nnotification_driver =\nnotification_topics = notifications\nrpc_backend = nova.openstack.common.rpc.impl_kombu\namqp_durable_queues=False\nnotify_api_faults=False\nmemcached_servers=192.168.0.17:11211,192.168.0.53:11211\nstate_path=/var/lib/nova\nreport_interval=60\nquota_ram=51200\nquota_driver=nova.quota.NoopQuotaDriver\nmax_age=0\nquota_security_groups=10\nquota_cores=100\nreservation_expire=86400\nimage_service=nova.image.glance.GlanceImageService\nuse_cow_images=True\nnovncproxy_host=192.168.0.53\nuntil_refresh=0\nnovncproxy_port=6080\nquota_fixed_ips=-1\nquota_security_group_rules=20\nscheduler_driver=nova.scheduler.filter_scheduler.FilterScheduler\napi_paste_config=/etc/nova/api-paste.ini\nscheduler_use_baremetal_filters=False\nscheduler_default_filters=RetryFilter,AvailabilityZoneFilter,RamFilter,CoreFilter,DiskFilter,ComputeFilter,ComputeCapabilitiesFilter,ImagePropertiesFilter,ServerGroupAntiAffinityFilter,ServerGroupAffinityFilter\nmax_io_ops_per_host=8\nscheduler_weight_classes=nova.scheduler.weights.all_weighers\nscheduler_host_subset_size=30\nram_allocation_ratio=1.0\ndisk_allocation_ratio=1.0\nquota_floating_ips=100\nquota_key_pairs=10\nscheduler_max_attempts=3\ncpu_allocation_ratio=8.0\nmax_instances_per_host=50\nscheduler_available_filters=nova.scheduler.filters.all_filters\nlock_path=/var/lock/nova\nservice_down_time=180\ns3_listen=0.0.0.0\nquota_instances=100\nscheduler_host_manager=nova.scheduler.host_manager.HostManager\nosapi_compute_listen=192.168.0.53\nec2_listen=192.168.0.53\nenabled_apis=ec2,osapi_compute,metadata\nosapi_compute_listen_port=8774\nvolume_api_class=nova.volume.cinder.API\ndefault_floating_pool=admin_floating_net\nmetadata_listen_port=8775\nec2_workers=30\nec2_listen_port=8773\nuse_forwarded_for=False\nosapi_volume_listen=192.168.0.53\nmetadata_listen=0.0.0.0\nquota_injected_file_path_length=4096\nauth_strategy=keystone\nram_weight_multiplier=1.0\nkeystone_ec2_url=http://192.168.0.51:5000/v2.0/ec2tokens\nquota_metadata_items=1024\nosapi_compute_workers=30\nrootwrap_config=/etc/nova/rootwrap.conf\nteardown_unused_network_gateway=True\nquota_injected_files=50\nmetadata_workers=30\nquota_injected_file_content_bytes=102400\nallow_resize_to_same_host=True\nnovncproxy_base_url=http://192.168.0.53:6080/vnc_auto.html\nfping_path=/usr/bin/fping\nnetwork_api_class=nova.network.neutronv2.api.API\nsecurity_group_api=neutron\nfirewall_driver=nova.virt.firewall.NoopFirewallDriver\nvif_plugging_is_fatal=True\nvif_plugging_timeout=300\ndhcp_domain=novalocal\n[cors]\n[cors.subdomain]\n[database]\nconnection = mysql://nova:$PASSWORD@192.168.0.51/nova?read_timeout=60\nidle_timeout = 3600\n[keystone_authtoken]\nauth_uri = https://$external_IP:5000/\nsigning_dir = /tmp/keystone-signing-nova\nsigning_dirname=/tmp/keystone-signing-nova\nauth_plugin = password\nauth_url = http://192.168.0.51:35357\nusername = nova\npassword = $PASSWORD\nproject_name = services\nuser_domain_name = Default\nproject_domain_name = Default\n[matchmaker_redis]\n[matchmaker_ring]\n[oslo_concurrency]\n[oslo_messaging_amqp]\n[oslo_messaging_qpid]\n[oslo_messaging_rabbit]\nkombu_reconnect_delay = 5.0\nrabbit_hosts = 192.168.0.53:5673, 192.168.0.17:5673\nrabbit_use_ssl = False\nrabbit_userid = nova\nrabbit_password = $PASSWORD\nrabbit_virtual_host = /\nrabbit_ha_queues = True\nheartbeat_timeout_threshold = 0\nheartbeat_rate = 2\n[oslo_middleware]\n[ssl]\n[conductor]\nworkers=30\n[glance]\napi_servers=192.168.0.51:9292\n[DATABASE]\nmax_pool_size=30\nmax_retries=-1\nmax_overflow=60\n[neutron]\nservice_metadata_proxy=True\nmetadata_proxy_shared_secret=$PASSWORD\nadmin_auth_url=http://192.168.0.51:35357/v3\nextension_sync_interval=600\ntimeout=30\nauth_strategy=keystone\ndefault_tenant_id=default\nurl=http://192.168.0.51:9696\novs_bridge=br-int\nregion_name=RegionOne\nauth_plugin = password\nauth_url = http://192.168.0.51:35357\nusername = neutron\npassword = $PASSWORD\nproject_name = services\nuser_domain_name = Default\nproject_domain_name = Default\nauth_uri=https://$external_IP:5000\n[osapi_v3]\nenabled=False\n[cinder]\ncatalog_info=volume:cinder:internalURL\n==============================================\nTo change keystone V2 to V3\uff0c I make following changes:\n#diff nova.conf nova.conf.V2.default \n< auth_uri = https://$external_IP:5000/\n---\n> auth_uri = http://192.168.0.51:5000/\n570c570\n< #identity_uri = http://192.168.0.51:35357/\n---\n> identity_uri = http://192.168.0.51:35357/\n580c580\n< #admin_user = nova\n---\n> admin_user = nova\n583c583\n< #admin_password = $PASSWORD\n---\n> admin_password = $PASSWORD\n586c586\n< #admin_tenant_name = services\n---\n> admin_tenant_name = services\n588,594c588\n< auth_plugin = password\n< auth_url = http://192.168.0.51:35357\n< username = nova\n< password = $PASSWORD\n< project_name = services\n< user_domain_name = Default\n< project_domain_name = Default\n---\n> \n946c940\n< admin_auth_url=http://192.168.0.51:35357/v3\n---\n> admin_auth_url=http://192.168.0.51:35357/v2.0\n948,950c942,944\n< #admin_username=neutron\n< #admin_tenant_name=services\n< #admin_password=$PASSWORD\n---\n> admin_username=neutron\n> admin_tenant_name=services\n> admin_password=$PASSWORD\n957,964d950\n< auth_plugin = password\n< auth_url = http://192.168.0.51:35357\n< username = neutron\n< password = $PASSWORD\n< project_name = services\n< user_domain_name = Default\n< project_domain_name = Default\n< auth_uri=https://$external_IP:5000\nroot@node-100:/etc/nova# \n\nBy the way, I don't find the procedure for migration keystone V2 to V3 for ubuntu OS. I follow the procedure of centos7 to do so.", 
            "date_created": "2017-06-04 15:41:28.636193+00:00", 
            "author": "https://api.launchpad.net/1.0/~liangbsh"
        }, 
        {
            "content": "I also add many traces to debug the issue. Please see attachment nova-api.log.", 
            "date_created": "2017-06-04 15:45:54.750577+00:00", 
            "author": "https://api.launchpad.net/1.0/~liangbsh"
        }, 
        {
            "content": "you have this in conf file\nconnection = mysql://nova:$PASSWORD@192.168.0.51/nova?read_timeout=60\n\nas Matt indicated in #8 and from \nhttp://docs.sqlalchemy.org/en/latest/dialects/mysql.html#module-sqlalchemy.dialects.mysql.mysqldb\n\nmaybe worthy give a try to modify you conf string to mysql+pymysql?", 
            "date_created": "2017-06-05 08:56:37.056277+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }, 
        {
            "content": "OK.\nI will try it later.\n\nThanks very much.", 
            "date_created": "2017-06-05 09:28:17.963110+00:00", 
            "author": "https://api.launchpad.net/1.0/~liangbsh"
        }, 
        {
            "content": "I have tried the WA. But I still met issue. \"openstack server list\" always return one correct result and \"HTTP 500\" error. There may be some wrong with the environment. I have to reinstall it. When I have the chance, I will retry the procedure.\n\nThanks", 
            "date_created": "2017-06-08 01:13:54.218690+00:00", 
            "author": "https://api.launchpad.net/1.0/~liangbsh"
        }, 
        {
            "content": "Automatically discovered version liberty in description. If this is incorrect, please update the description to include 'nova version: ...'", 
            "date_created": "2017-06-27 15:59:49.768878+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "[Expired for OpenStack Compute (nova) because there has been no activity for 60 days.]", 
            "date_created": "2017-08-27 04:17:57.022963+00:00", 
            "author": "https://api.launchpad.net/1.0/~janitor"
        }
    ], 
    "closed": "2017-08-27 04:17:57.501850+00:00"
}