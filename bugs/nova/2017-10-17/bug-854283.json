{
    "status": "Fix Released", 
    "last_updated": "2012-04-05 09:31:56.069274+00:00", 
    "description": "I get the following error in /var/log/nova/nova-manage.log when running 'nova-manage db sync' on nova trunk:\n\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/migrate/versioning/util/__init__.py\", line 160, in with_engine\n(nova): TRACE:     return f(*a, **kw)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/migrate/versioning/api.py\", line 364, in _migrate\n(nova): TRACE:     schema.runchange(ver, change, changeset.step)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/migrate/versioning/schema.py\", line 83, in runchange\n(nova): TRACE:     change.run(self.engine, step)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/migrate/versioning/script/py.py\", line 140, in run\n(nova): TRACE:     script_func(engine)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/nova/db/sqlalchemy/migrate_repo/versions/047_remove_instances_fk_from_vif.py\", line 48, in upgrade\n(nova): TRACE:     migrate_engine.execute(\"ALTER TABLE migrations DROP \" \\\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1715, in execute\n(nova): TRACE:     return connection.execute(statement, *multiparams, **params)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1157, in execute\n(nova): TRACE:     params)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1253, in _execute_text\n(nova): TRACE:     return self.__execute_context(context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1268, in __execute_context\n(nova): TRACE:     context.parameters[0], context=context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1367, in _cursor_execute\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1360, in _cursor_execute\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/default.py\", line 288, in do_execute\n(nova): TRACE:     cursor.execute(statement, parameters)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/MySQLdb/cursors.py\", line 166, in execute\n(nova): TRACE:     self.errorhandler(self, exc, value)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/MySQLdb/connections.py\", line 35, in defaulterrorhandler\n(nova): TRACE:     raise errorclass, errorvalue\n(nova): TRACE: OperationalError: (OperationalError) (1025, \"Error on rename of './nova/migrations' to './nova/#sql2-272a-2b' (errno: 152)\") 'ALTER TABLE migrations DROP FOREIGN KEY `virtual_interfaces_ibfk_2`;' ()\n(nova): TRACE:", 
    "tags": [], 
    "importance": "Critical", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/854283", 
    "owner": "https://api.launchpad.net/1.0/~dan-prince", 
    "id": 854283, 
    "index": 31, 
    "openned": "2011-09-19 22:14:09.223463+00:00", 
    "created": "2011-09-19 22:14:09.223463+00:00", 
    "title": "nova-manage db sync fails on migration 047", 
    "comments": [
        {
            "content": "I get the following error in /var/log/nova/nova-manage.log when running 'nova-manage db sync' on nova trunk:\n\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/migrate/versioning/util/__init__.py\", line 160, in with_engine\n(nova): TRACE:     return f(*a, **kw)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/migrate/versioning/api.py\", line 364, in _migrate\n(nova): TRACE:     schema.runchange(ver, change, changeset.step)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/migrate/versioning/schema.py\", line 83, in runchange\n(nova): TRACE:     change.run(self.engine, step)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/migrate/versioning/script/py.py\", line 140, in run\n(nova): TRACE:     script_func(engine)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/nova/db/sqlalchemy/migrate_repo/versions/047_remove_instances_fk_from_vif.py\", line 48, in upgrade\n(nova): TRACE:     migrate_engine.execute(\"ALTER TABLE migrations DROP \" \\\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1715, in execute\n(nova): TRACE:     return connection.execute(statement, *multiparams, **params)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1157, in execute\n(nova): TRACE:     params)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1253, in _execute_text\n(nova): TRACE:     return self.__execute_context(context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1268, in __execute_context\n(nova): TRACE:     context.parameters[0], context=context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1367, in _cursor_execute\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1360, in _cursor_execute\n(nova): TRACE:     context)\n(nova): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/default.py\", line 288, in do_execute\n(nova): TRACE:     cursor.execute(statement, parameters)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/MySQLdb/cursors.py\", line 166, in execute\n(nova): TRACE:     self.errorhandler(self, exc, value)\n(nova): TRACE:   File \"/usr/lib/pymodules/python2.6/MySQLdb/connections.py\", line 35, in defaulterrorhandler\n(nova): TRACE:     raise errorclass, errorvalue\n(nova): TRACE: OperationalError: (OperationalError) (1025, \"Error on rename of './nova/migrations' to './nova/#sql2-272a-2b' (errno: 152)\") 'ALTER TABLE migrations DROP FOREIGN KEY `virtual_interfaces_ibfk_2`;' ()\n(nova): TRACE:", 
            "date_created": "2011-09-19 22:14:09.223463+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }
    ], 
    "closed": "2011-11-17 09:53:20.243843+00:00"
}