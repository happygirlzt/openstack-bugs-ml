{
    "status": "Fix Released", 
    "last_updated": "2013-12-12 13:34:19.966087+00:00", 
    "description": "nova add-fixed-ip leads to a traceback in nova-network\n2013-02-13 16:10:57.711 ERROR nova.openstack.common.rpc.amqp [req-434b8722-566c-4345-933a-5646277cd6ef demo demo] Exception during message handling2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 276, in _process_data2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 133, in dispatch2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 756, in add_fixed_ip_to_instance2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     self._allocate_fixed_ips(context, instance_id, host, [network])2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 212, in _allocate_fixed_ips\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     vpn=vpn, address=address)\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 801, in allocate_fixed_ip\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     instance_ref = self.db.instance_get(context, instance_id)\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/db/api.py\", line 593, in instance_get\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     return IMPL.instance_get(context, instance_id)\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/db/sqlalchemy/api.py\", line 137, in wrapper\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/db/sqlalchemy/api.py\", line 1520, in instance_get\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     raise exception.InstanceNotFound(instance_id=instance_id)\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp InstanceNotFound: Instance f96d5c44-6c17-46cb-8b5c-057717ce076d could not be found.\n\nthere seems to be quite a bit of mixing of instance['id'] with instance['uuid']", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1124674", 
    "owner": "https://api.launchpad.net/1.0/~vishvananda", 
    "id": 1124674, 
    "index": 3230, 
    "openned": "2013-02-14 00:12:09.683559+00:00", 
    "created": "2013-02-14 00:12:09.683559+00:00", 
    "title": "add-fixed-ip causes traceback", 
    "comments": [
        {
            "content": "nova add-fixed-ip leads to a traceback in nova-network\n2013-02-13 16:10:57.711 ERROR nova.openstack.common.rpc.amqp [req-434b8722-566c-4345-933a-5646277cd6ef demo demo] Exception during message handling2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 276, in _process_data2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 133, in dispatch2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 756, in add_fixed_ip_to_instance2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     self._allocate_fixed_ips(context, instance_id, host, [network])2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 212, in _allocate_fixed_ips\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     vpn=vpn, address=address)\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/network/manager.py\", line 801, in allocate_fixed_ip\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     instance_ref = self.db.instance_get(context, instance_id)\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/db/api.py\", line 593, in instance_get\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     return IMPL.instance_get(context, instance_id)\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/db/sqlalchemy/api.py\", line 137, in wrapper\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/db/sqlalchemy/api.py\", line 1520, in instance_get\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp     raise exception.InstanceNotFound(instance_id=instance_id)\n2013-02-13 16:10:57.711 TRACE nova.openstack.common.rpc.amqp InstanceNotFound: Instance f96d5c44-6c17-46cb-8b5c-057717ce076d could not be found.\n\nthere seems to be quite a bit of mixing of instance['id'] with instance['uuid']", 
            "date_created": "2013-02-14 00:12:09.683559+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/21927", 
            "date_created": "2013-02-14 00:16:38.773598+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Adding tempest because we should have a test case for this there as well. As Matt's building out the master missing test case list, assigning to him for now for attention.", 
            "date_created": "2013-02-14 13:48:59.296101+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/21927\nCommitted: http://github.com/openstack/nova/commit/65dbf21c91729fa20fed95e1cf69cda6421e9a45\nSubmitter: Jenkins\nBranch:    master\n\ncommit 65dbf21c91729fa20fed95e1cf69cda6421e9a45\nAuthor: Vishvananda Ishaya <email address hidden>\nDate:   Wed Feb 13 12:53:06 2013 -0800\n\n    Fix add-fixed-ip and remove-fixed-ip.\n    \n    There were various places that were passing an integer id from\n    network api to network manager. On the manager side we need the\n    uuid so this patch updates everything to send the uuid.\n    \n    Secondarily, the network info cache wasn't being properly updated\n    upon return from add-fixed-ip and remove-fixed-ip, so this\n    changes the code to update the info cache as well.\n    \n    Fixes bug 1124674\n    \n    Change-Id: I632b39eb3963998cf42c02584dc9275a8aae243d\n", 
            "date_created": "2013-02-16 01:38:36.223160+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-02-21 08:57:12.159098+00:00"
}