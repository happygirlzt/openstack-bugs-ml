{
    "status": "Fix Released", 
    "last_updated": "2014-04-17 08:52:56.460765+00:00", 
    "description": "Just saw that virt drivers now take an extra arg \"context\" on the destroy method. For some reason, it has not been added to the docker driver... The destroy method with the driver enabled currently fails with the following error:\n\n2013-10-25 23:03:20.764 ERROR nova.openstack.common.rpc.amqp [req-75ff872a-fd4d-4b63-a587-93b9fd3ede4b demo demo] Exception during message handling\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 353, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 90, in wrapped\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 73, in wrapped\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 243, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     pass\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 229, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 294, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 271, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 258, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1792, in terminate_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     do_terminate_instance(instance, bdms)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/lockutils.py\", line 246, in inner\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1784, in do_terminate_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     reservations=reservations)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/hooks.py\", line 105, in inner\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     rv = f(*args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1757, in _delete_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     user_id=user_id)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1729, in _delete_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     self._shutdown_instance(context, db_inst, bdms)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1662, in _shutdown_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     requested_networks)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1652, in _shutdown_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     context=context)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp TypeError: destroy() got an unexpected keyword argument 'context'\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp", 
    "tags": [
        "docker", 
        "nova-cpu", 
        "virt"
    ], 
    "importance": "Undecided", 
    "heat": 44, 
    "link": "https://bugs.launchpad.net/nova/+bug/1244829", 
    "owner": "https://api.launchpad.net/1.0/~samalba", 
    "id": 1244829, 
    "index": 5504, 
    "openned": "2013-10-25 23:21:24.330633+00:00", 
    "created": "2013-10-25 23:21:24.330633+00:00", 
    "title": "destroy() method broken on Docker virt driver", 
    "comments": [
        {
            "content": "Just saw that virt drivers now take an extra arg \"context\" on the destroy method. For some reason, it has not been added to the docker driver... The destroy method with the driver enabled currently fails with the following error:\n\n2013-10-25 23:03:20.764 ERROR nova.openstack.common.rpc.amqp [req-75ff872a-fd4d-4b63-a587-93b9fd3ede4b demo demo] Exception during message handling\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 353, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 90, in wrapped\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 73, in wrapped\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 243, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     pass\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 229, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 294, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 271, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 258, in decorated_function\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1792, in terminate_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     do_terminate_instance(instance, bdms)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/lockutils.py\", line 246, in inner\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1784, in do_terminate_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     reservations=reservations)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/hooks.py\", line 105, in inner\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     rv = f(*args, **kwargs)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1757, in _delete_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     user_id=user_id)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1729, in _delete_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     self._shutdown_instance(context, db_inst, bdms)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1662, in _shutdown_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     requested_networks)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 1652, in _shutdown_instance\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp     context=context)\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp TypeError: destroy() got an unexpected keyword argument 'context'\n2013-10-25 23:03:20.764 TRACE nova.openstack.common.rpc.amqp", 
            "date_created": "2013-10-25 23:21:24.330633+00:00", 
            "author": "https://api.launchpad.net/1.0/~samalba"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/53971", 
            "date_created": "2013-10-25 23:24:47.329955+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "There is a competing bug report - https://bugs.launchpad.net/nova/+bug/1244828", 
            "date_created": "2013-10-27 20:46:10.618442+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/53971\nCommitted: http://github.com/openstack/nova/commit/c0e546ace478277cc2911b1c5bef1e082b76b546\nSubmitter: Jenkins\nBranch:    master\n\ncommit c0e546ace478277cc2911b1c5bef1e082b76b546\nAuthor: Sam Alba <email address hidden>\nDate:   Fri Oct 25 16:22:32 2013 -0700\n\n    Fixes the destroy() method for the Docker virt driver\n    \n    * Added the missing \"context\" argument in nova/virt/driver.py\n    * Added the missing argument in the test_virt_drivers.destroy() as well so it\n    will make sure none of the other drivers will miss it.\n    \n    Change-Id: I083b935da95c28ad4f9879036ef2bf7c1fbbb58e\n    Closes-Bug: #1244829\n", 
            "date_created": "2013-11-03 06:23:39.034087+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-12-04 10:36:48.455749+00:00"
}