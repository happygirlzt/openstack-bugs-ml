{
    "status": "Fix Released", 
    "last_updated": "2015-10-26 16:32:56.389799+00:00", 
    "description": "Running with grizzly-stable.\n\nUnable to boot nova when the quantum plug in does not support the Floating IP Extension. \n\nThe issue is with the 'self._get_floating_ips_by_fixed_and_port'.  If the extension in quantum that supports that is not available, then this whole method throws an error (the 404 error thrown by Quantum).\n\nThe exception looks like the following.\n************************************************************\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 1317, in _delete_instance\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp project_id=project_id)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib64/python2.6/contextlib.py\", line 23, in __exit__\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp self.gen.next()\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 1290, in _delete_instance\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp self._shutdown_instance(context, instance, bdms)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 1215, in _shutdown_instance\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp network_info = self._get_instance_nw_info(context, instance)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 668, in _get_instance_nw_info\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp instance, conductor_api=self.conductor_api)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/network/quantumv2/api.py\", line 361, in get_instance_nw_info\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp result = self._get_instance_nw_info(context, instance, networks)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/network/quantumv2/api.py\", line 369, in _get_instance_nw_info\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp nw_info = self._build_network_info_model(context, instance, networks)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/network/quantumv2/ibmpowervm_api.py\", line 27, in _build_network_info_model\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp networks)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/network/quantumv2/api.py\", line 810, in _build_network_info_model\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp client, fixed_ip['ip_address'], port['id'])\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/network/quantumv2/api.py\", line 725, in _get_floating_ips_by_fixed_and_port\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp data = client.list_floatingips(fixed_ip_address=fixed_ip, port_id=port)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 107, in with_params\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp ret = self.function(instance, *args, **kwargs)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 434, in list_floatingips\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp **_params)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 996, in list\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp for r in self._pagination(collection, path, **params):\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 1009, in _pagination\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp res = self.get(path, params=params)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 982, in get\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp headers=headers, params=params)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 967, in retry_request\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp headers=headers, params=params)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 912, in do_request\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp self._handle_fault_response(status_code, replybody)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 893, in _handle_fault_response\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp exception_handler_v20(status_code, des_error_body)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 87, in exception_handler_v20\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp message=message)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp QuantumClientException: 404 Not Found\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp The resource could not be found.\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp\n************************************************************", 
    "tags": [], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1163670", 
    "owner": "https://api.launchpad.net/1.0/~arosen", 
    "id": 1163670, 
    "index": 1045, 
    "openned": "2013-04-03 03:39:06.770218+00:00", 
    "created": "2013-04-03 03:39:06.770218+00:00", 
    "title": "Cannot boot Nova as quantum throws 404 when Floating IP extension unavailable", 
    "comments": [
        {
            "content": "Running with grizzly-stable.\n\nUnable to boot nova when the quantum plug in does not support the Floating IP Extension. \n\nThe issue is with the 'self._get_floating_ips_by_fixed_and_port'.  If the extension in quantum that supports that is not available, then this whole method throws an error (the 404 error thrown by Quantum).\n\nThe exception looks like the following.\n************************************************************\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 1317, in _delete_instance\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp project_id=project_id)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib64/python2.6/contextlib.py\", line 23, in __exit__\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp self.gen.next()\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 1290, in _delete_instance\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp self._shutdown_instance(context, instance, bdms)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 1215, in _shutdown_instance\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp network_info = self._get_instance_nw_info(context, instance)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 668, in _get_instance_nw_info\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp instance, conductor_api=self.conductor_api)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/network/quantumv2/api.py\", line 361, in get_instance_nw_info\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp result = self._get_instance_nw_info(context, instance, networks)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/network/quantumv2/api.py\", line 369, in _get_instance_nw_info\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp nw_info = self._build_network_info_model(context, instance, networks)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/network/quantumv2/ibmpowervm_api.py\", line 27, in _build_network_info_model\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp networks)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/network/quantumv2/api.py\", line 810, in _build_network_info_model\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp client, fixed_ip['ip_address'], port['id'])\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/nova/network/quantumv2/api.py\", line 725, in _get_floating_ips_by_fixed_and_port\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp data = client.list_floatingips(fixed_ip_address=fixed_ip, port_id=port)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 107, in with_params\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp ret = self.function(instance, *args, **kwargs)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 434, in list_floatingips\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp **_params)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 996, in list\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp for r in self._pagination(collection, path, **params):\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 1009, in _pagination\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp res = self.get(path, params=params)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 982, in get\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp headers=headers, params=params)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 967, in retry_request\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp headers=headers, params=params)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 912, in do_request\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp self._handle_fault_response(status_code, replybody)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 893, in _handle_fault_response\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp exception_handler_v20(status_code, des_error_body)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp File \"/usr/lib/python2.6/site-packages/quantumclient/v2_0/client.py\", line 87, in exception_handler_v20\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp message=message)\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp QuantumClientException: 404 Not Found\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp The resource could not be found.\n2013-03-30 11:39:52.112 16073 TRACE nova.openstack.common.rpc.amqp\n************************************************************", 
            "date_created": "2013-04-03 03:39:06.770218+00:00", 
            "author": "https://api.launchpad.net/1.0/~neela"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/26153", 
            "date_created": "2013-04-04 22:08:07.391403+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/26153\nCommitted: http://github.com/openstack/nova/commit/c62f698ef1f1e69bd5eb3c6544ee305f96488d42\nSubmitter: Jenkins\nBranch:    master\n\ncommit c62f698ef1f1e69bd5eb3c6544ee305f96488d42\nAuthor: Aaron Rosen <email address hidden>\nDate:   Thu Apr 4 13:51:47 2013 -0700\n\n    Cannot boot vm if quantum plugin does not support L3 api\n    \n    Fixes bug 1163670\n    \n    Change-Id: I87f0b73e5040b5f9cf7d8c30aa16a2a33faca14f\n", 
            "date_created": "2013-04-07 00:31:04.538769+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This fix needs to be in grizzly as well - it is still a problem there. Will this be backported to grizzly?", 
            "date_created": "2013-04-08 16:23:54.834959+00:00", 
            "author": "https://api.launchpad.net/1.0/~neela"
        }, 
        {
            "content": "Fix proposed to branch: stable/grizzly\nReview: https://review.openstack.org/26608", 
            "date_created": "2013-04-10 13:03:54.268550+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/grizzly\nReview: https://review.openstack.org/27308", 
            "date_created": "2013-04-23 00:41:31.506024+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/27308\nCommitted: http://github.com/openstack/nova/commit/71e39dc2616ba25eb24bfc094489c36b2b3d4e80\nSubmitter: Jenkins\nBranch:    stable/grizzly\n\ncommit 71e39dc2616ba25eb24bfc094489c36b2b3d4e80\nAuthor: Aaron Rosen <email address hidden>\nDate:   Thu Apr 4 13:51:47 2013 -0700\n\n    Cannot boot vm if quantum plugin does not support L3 api\n    \n    from quantumclient.common import exceptions as qexceptions was also\n    added to nova/network/quantumv2/api.py\n    \n    Fixes bug 1163670\n    \n    Change-Id: I8afcf2753c9cec9a0dc13f866301bd1e7b3fdde2\n", 
            "date_created": "2013-04-24 06:33:29.683004+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/226274\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=e5c9b7ecc62e1b9400d20540c7d5c10982506d3a\nSubmitter: Jenkins\nBranch:    master\n\ncommit e5c9b7ecc62e1b9400d20540c7d5c10982506d3a\nAuthor: Alexey I. Froloff <email address hidden>\nDate:   Tue Sep 22 14:39:40 2015 +0300\n\n    Fix more inconsistency between Nova-Net and Neutron\n    \n    The commit c62f698ef1f1e69bd5eb3c6544ee305f96488d42 fixed one\n    incosistency between Nova-Net and Neutron, when Neutron returns 404\n    error for list_floatingip and Nova translates it into 500 computeFault.\n    However, there are two other places where list_floatingips is called.\n    \n    Move common code into private helper function, where 404 Error from\n    Neutron is gracefully handled, and use it where appropriate.\n    \n    Closes-Bug: #1498443\n    Related-Bug: #1163670\n    \n    Change-Id: I9229d882712df1ad57afbda7477fa4d72f4fd83c\n", 
            "date_created": "2015-10-26 16:32:55.654028+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-05-29 10:16:54.445312+00:00"
}