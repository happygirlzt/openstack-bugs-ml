{
    "status": "Invalid", 
    "last_updated": "2016-03-22 15:43:54.775689+00:00", 
    "description": "I am installing OpenStack using Nova, Glance and Keystone. The system mostly works (I have another bug report open but it is not linked to this problem at all).\n\nI find that whatever command I run, Nova or Glance or even an openstack one, takes a substantial number of seconds to complete, whether it works or not. This is true for 'openstack --help' so it's going to be an OpenStack issue.\n\nI ran a few commands through 'strace -T' and found the system call that is causing the delay:\n\npoll([{fd=11, events=POLLIN}], 1, 25000) = 0 (Timeout)\n\nI traced the file descriptor back to where it was created:\n\nsocket(PF_LOCAL, SOCK_STREAM|SOCK_CLOEXEC, 0) = 11\nconnect(11, {sa_family=AF_LOCAL, sun_path=@\"/tmp/dbus-CDsvziK6kt\"}, 23) = 0\nfcntl(11, F_GETFL)                      = 0x2 (flags O_RDWR)\nfcntl(11, F_SETFL, O_RDWR|O_NONBLOCK)   = 0\n\nIt then polls this FD and sends and receives a number of bits of data through it, indicating that it's all working correctly.\n\nFurther down you can see where it stops, for no apparent reason:\n\nrecvmsg(11, {msg_name(0)=NULL, msg_iov(1)=[{\"l\\3\\1\\1H\\0\\0\\0\\3\\0\\0\\0u\\0\\0\\0\\6\\1s\\0\\6\\0\\0\\0:1.182\\0\\0\"..., 2048}], msg_controllen=0, msg_flags=MSG_CMSG_CLOEXEC}, MSG_CMSG_CLOEXEC) = 208\nwrite(12, \"\\1\\0\\0\\0\\0\\0\\0\\0\", 8)        = 8\nrecvmsg(11, 0x7ffddb6d0cb0, MSG_CMSG_CLOEXEC) = -1 EAGAIN (Resource temporarily unavailable)\nsendmsg(11, {msg_name(0)=NULL, msg_iov(2)=[{\"l\\1\\0\\1 \\0\\0\\0\\3\\0\\0\\0\\210\\0\\0\\0\\1\\1o\\0\\25\\0\\0\\0/org/fre\"..., 152}, {\"\\27\\0\\0\\0org.freedesktop.secrets\\0\\0\\0\\0\\0\", 32}], msg_controllen=0, msg_flags=0}, MSG_NOSIGNAL) = 184\npoll([{fd=11, events=POLLIN}], 1, 25000) = 0 (Timeout)\n\nI can consistently repeat this. \n\nFind attached the strace file for this.\n\nI am running:\nOpenStack v1.7.0 (even generating this caused the delay).\nNova v2.30.1\nGlance v1.1.0\n\nI installed it all via pkg-add:\n\nglance/trusty-updates,now 2:11.0.1-0ubuntu1~cloud0 all [installed]\nglance-api/trusty-updates,now 2:11.0.1-0ubuntu1~cloud0 all [installed,automatic]\nglance-common/trusty-updates,now 2:11.0.1-0ubuntu1~cloud0 all [installed,automatic]\nglance-registry/trusty-updates,now 2:11.0.1-0ubuntu1~cloud0 all [installed,automatic]\nnova-api/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\nnova-cert/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\nnova-common/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed,automatic]\nnova-conductor/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\nnova-consoleauth/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\nnova-novncproxy/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\nnova-scheduler/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\npython-glance/trusty-updates,now 2:11.0.1-0ubuntu1~cloud0 all [installed,automatic]\npython-glance-store/trusty-updates,now 0.9.1-1ubuntu1~cloud0 all [installed,automatic]\npython-glanceclient/trusty-updates,now 1:1.1.0-0ubuntu1~cloud0 all [installed]\npython-nova/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed,automatic]\npython-novaclient/trusty-updates,now 2:2.30.1-1~cloud0 all [installed]\npython-openstackclient/trusty-updates,now 1.7.0-1~cloud0 all [installed]\n\n\n|\\/|artin", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1558699", 
    "owner": "None", 
    "id": 1558699, 
    "index": 7378, 
    "openned": "2016-03-17 17:32:11.525823+00:00", 
    "created": "2016-03-17 17:32:11.525823+00:00", 
    "title": "25 second timeout while polling the machine-id file/dev/urandom", 
    "comments": [
        {
            "content": "I am installing OpenStack using Nova, Glance and Keystone. The system mostly works (I have another bug report open but it is not linked to this problem at all).\n\nI find that whatever command I run, Nova or Glance or even an openstack one, takes a substantial number of seconds to complete, whether it works or not. This is true for 'openstack --help' so it's going to be an OpenStack issue.\n\nI ran a few commands through 'strace -T' and found the system call that is causing the delay:\n\npoll([{fd=11, events=POLLIN}], 1, 25000) = 0 (Timeout)\n\nI traced the file descriptor back to where it was created:\n\nsocket(PF_LOCAL, SOCK_STREAM|SOCK_CLOEXEC, 0) = 11\nconnect(11, {sa_family=AF_LOCAL, sun_path=@\"/tmp/dbus-CDsvziK6kt\"}, 23) = 0\nfcntl(11, F_GETFL)                      = 0x2 (flags O_RDWR)\nfcntl(11, F_SETFL, O_RDWR|O_NONBLOCK)   = 0\n\nIt then polls this FD and sends and receives a number of bits of data through it, indicating that it's all working correctly.\n\nFurther down you can see where it stops, for no apparent reason:\n\nrecvmsg(11, {msg_name(0)=NULL, msg_iov(1)=[{\"l\\3\\1\\1H\\0\\0\\0\\3\\0\\0\\0u\\0\\0\\0\\6\\1s\\0\\6\\0\\0\\0:1.182\\0\\0\"..., 2048}], msg_controllen=0, msg_flags=MSG_CMSG_CLOEXEC}, MSG_CMSG_CLOEXEC) = 208\nwrite(12, \"\\1\\0\\0\\0\\0\\0\\0\\0\", 8)        = 8\nrecvmsg(11, 0x7ffddb6d0cb0, MSG_CMSG_CLOEXEC) = -1 EAGAIN (Resource temporarily unavailable)\nsendmsg(11, {msg_name(0)=NULL, msg_iov(2)=[{\"l\\1\\0\\1 \\0\\0\\0\\3\\0\\0\\0\\210\\0\\0\\0\\1\\1o\\0\\25\\0\\0\\0/org/fre\"..., 152}, {\"\\27\\0\\0\\0org.freedesktop.secrets\\0\\0\\0\\0\\0\", 32}], msg_controllen=0, msg_flags=0}, MSG_NOSIGNAL) = 184\npoll([{fd=11, events=POLLIN}], 1, 25000) = 0 (Timeout)\n\nI can consistently repeat this. \n\nFind attached the strace file for this.\n\nI am running:\nOpenStack v1.7.0 (even generating this caused the delay).\nNova v2.30.1\nGlance v1.1.0\n\nI installed it all via pkg-add:\n\nglance/trusty-updates,now 2:11.0.1-0ubuntu1~cloud0 all [installed]\nglance-api/trusty-updates,now 2:11.0.1-0ubuntu1~cloud0 all [installed,automatic]\nglance-common/trusty-updates,now 2:11.0.1-0ubuntu1~cloud0 all [installed,automatic]\nglance-registry/trusty-updates,now 2:11.0.1-0ubuntu1~cloud0 all [installed,automatic]\nnova-api/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\nnova-cert/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\nnova-common/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed,automatic]\nnova-conductor/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\nnova-consoleauth/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\nnova-novncproxy/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\nnova-scheduler/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed]\npython-glance/trusty-updates,now 2:11.0.1-0ubuntu1~cloud0 all [installed,automatic]\npython-glance-store/trusty-updates,now 0.9.1-1ubuntu1~cloud0 all [installed,automatic]\npython-glanceclient/trusty-updates,now 1:1.1.0-0ubuntu1~cloud0 all [installed]\npython-nova/trusty-updates,now 2:12.0.1-0ubuntu1~cloud0 all [installed,automatic]\npython-novaclient/trusty-updates,now 2:2.30.1-1~cloud0 all [installed]\npython-openstackclient/trusty-updates,now 1.7.0-1~cloud0 all [installed]\n\n\n|\\/|artin", 
            "date_created": "2016-03-17 17:32:11.525823+00:00", 
            "author": "https://api.launchpad.net/1.0/~wardmw"
        }, 
        {
            "content": "Attachment contains the outpu of 'strace openstack --help' \n\nSearch through it for 'Timeout' and you will come to the place where the timeout happens, every time.\n", 
            "date_created": "2016-03-17 17:35:33.969602+00:00", 
            "author": "https://api.launchpad.net/1.0/~wardmw"
        }, 
        {
            "content": "As much as I love looking at strace output, is there something more specific you can point to here that indicates this is a bug in nova?  For example, what commands are you running with the openstack CLI?  Just --help?\n\nDo you have the same problem with python-novaclient, e.g. nova --help?", 
            "date_created": "2016-03-21 20:23:21.486623+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Seems to be an issue with checking keyring on your system.", 
            "date_created": "2016-03-21 20:26:05.531983+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Hi Matt,\n\nThe delay happens with every command I have installed for Openstack, but specifically 'openstack -h', 'nova -help' and 'neutron -h' all fail with the same delay.\n\nFollowing your comment about keyrings I was able to track down the issue to the fact that I have been running the various nova/openstack/neutron/etc commands from a sudo root session and it seems that the keyring API does not allow the root user to access a keyring directory created in my login user's .cache subdirectory. This makes no sense to me as for the last 20 years, on every unix system I have used, I have been able to access any file on local file systems as the root user so I didn't even start to look at this side of things.\n\nThanks for the pointer and for your time.", 
            "date_created": "2016-03-22 15:43:54.304749+00:00", 
            "author": "https://api.launchpad.net/1.0/~wardmw"
        }
    ], 
    "closed": "2016-03-21 20:26:13.781983+00:00"
}