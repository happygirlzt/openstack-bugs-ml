{
    "status": "Invalid", 
    "last_updated": "2016-11-25 19:23:21.168107+00:00", 
    "description": "Description\n===========\n\nIssuing a migrate (not live migrate) on a guest can get it to be scheduled on the same host.\n\nSome hypervisor allows resize on the same host, but not libvirt.  Anyhow, by definition, migrate should be scheduled on a different host.\n\nSteps to reproduce\n==================\n\n1) Boot a guest\n2) Migrate the guest\n\nExpected result\n===============\n\nThe guest should be re-scheduled on a different host.\n\nActual result\n=============\n\nIt's possible for the guest to be migrated to the same host as where it is currently running.\n\nEnvironment\n===========\n\ncommit 7188bd01ec0264f6efee1ee5014a9edf71a57e5b\nMerge: 2249898 6a85a98\nAuthor: Jenkins <email address hidden>\nDate:   Fri Nov 25 16:57:47 2016 +0000\n\n    Merge \"libvirt: prepare domain XML update for serial ports\"\n\nLogs & Configs\n==============\n\n2016-11-25 12:41:33.240 ERROR oslo_messaging.rpc.server [req-9d87c551-563d-4443-8a62-784a2a5a5670 admin demo] Exception during message handling\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server Traceback (most recent call last):\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/server.py\", line 155, in _process_incoming\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     res = self.dispatcher.dispatch(message)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 225, in dispatch\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     return self._do_dispatch(endpoint, method, ctxt, args)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 195, in _do_dispatch\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     result = func(ctxt, **new_args)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception_wrapper.py\", line 75, in wrapped\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     function_name, call_dict, binary)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     self.force_reraise()\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception_wrapper.py\", line 66, in wrapped\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     return f(self, context, *args, **kw)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 188, in decorated_function\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     LOG.warning(msg, e, instance=instance)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     self.force_reraise()\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 157, in decorated_function\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/utils.py\", line 664, in decorated_function\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 216, in decorated_function\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     kwargs['instance'], e, sys.exc_info())\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     self.force_reraise()\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 204, in decorated_function\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 3724, in prep_resize\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     filter_properties)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 3775, in _reschedule_resize_or_reraise\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     six.reraise(*exc_info)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 3713, in prep_resize\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     node, clean_shutdown)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 3652, in _prep_resize\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     instance_id=instance.uuid, host=self.host)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server UnableToMigrateToSelf: Unable to migrate instance (25ee00f2-fa5b-4cc4-bceb-486a95979d43) to current host (IronPass-2).", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1644891", 
    "owner": "None", 
    "id": 1644891, 
    "index": 7824, 
    "openned": "2016-11-25 18:27:02.150609+00:00", 
    "created": "2016-11-25 18:27:02.150609+00:00", 
    "title": "Guest shouldn't be migrated to same host", 
    "comments": [
        {
            "content": "Description\n===========\n\nIssuing a migrate (not live migrate) on a guest can get it to be scheduled on the same host.\n\nSome hypervisor allows resize on the same host, but not libvirt.  Anyhow, by definition, migrate should be scheduled on a different host.\n\nSteps to reproduce\n==================\n\n1) Boot a guest\n2) Migrate the guest\n\nExpected result\n===============\n\nThe guest should be re-scheduled on a different host.\n\nActual result\n=============\n\nIt's possible for the guest to be migrated to the same host as where it is currently running.\n\nEnvironment\n===========\n\ncommit 7188bd01ec0264f6efee1ee5014a9edf71a57e5b\nMerge: 2249898 6a85a98\nAuthor: Jenkins <email address hidden>\nDate:   Fri Nov 25 16:57:47 2016 +0000\n\n    Merge \"libvirt: prepare domain XML update for serial ports\"\n\nLogs & Configs\n==============\n\n2016-11-25 12:41:33.240 ERROR oslo_messaging.rpc.server [req-9d87c551-563d-4443-8a62-784a2a5a5670 admin demo] Exception during message handling\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server Traceback (most recent call last):\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/server.py\", line 155, in _process_incoming\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     res = self.dispatcher.dispatch(message)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 225, in dispatch\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     return self._do_dispatch(endpoint, method, ctxt, args)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 195, in _do_dispatch\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     result = func(ctxt, **new_args)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception_wrapper.py\", line 75, in wrapped\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     function_name, call_dict, binary)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     self.force_reraise()\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/exception_wrapper.py\", line 66, in wrapped\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     return f(self, context, *args, **kw)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 188, in decorated_function\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     LOG.warning(msg, e, instance=instance)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     self.force_reraise()\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 157, in decorated_function\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/utils.py\", line 664, in decorated_function\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 216, in decorated_function\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     kwargs['instance'], e, sys.exc_info())\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     self.force_reraise()\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     six.reraise(self.type_, self.value, self.tb)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 204, in decorated_function\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     return function(self, context, *args, **kwargs)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 3724, in prep_resize\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     filter_properties)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 3775, in _reschedule_resize_or_reraise\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     six.reraise(*exc_info)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 3713, in prep_resize\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     node, clean_shutdown)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server   File \"/opt/stack/nova/nova/compute/manager.py\", line 3652, in _prep_resize\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server     instance_id=instance.uuid, host=self.host)\n2016-11-25 12:41:33.240 TRACE oslo_messaging.rpc.server UnableToMigrateToSelf: Unable to migrate instance (25ee00f2-fa5b-4cc4-bceb-486a95979d43) to current host (IronPass-2).", 
            "date_created": "2016-11-25 18:27:02.150609+00:00", 
            "author": "https://api.launchpad.net/1.0/~ludovic-beliveau"
        }, 
        {
            "content": "Issue is with devstack default config.", 
            "date_created": "2016-11-25 19:23:20.614318+00:00", 
            "author": "https://api.launchpad.net/1.0/~ludovic-beliveau"
        }
    ], 
    "closed": "2016-11-25 19:23:00.167745+00:00"
}