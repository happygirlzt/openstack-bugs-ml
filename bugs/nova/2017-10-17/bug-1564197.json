{
    "status": "Expired", 
    "last_updated": "2016-06-18 04:18:30.857362+00:00", 
    "description": "Currently, when live migrate instances, if user didn't provide live_migration_inbound_addr, nova will default use destination hostname as the migration destination for operations such as copy disks.\n\nThe translation of hostname to IP is actually depend on the under layer OS or DNS services, for example, we have to add Our hosts to /etc/hosts in Linux to make it work.\n\nAs it is not hard for nova to get the actual IP of destination node, we can really use the IP directly for the migration operations.\n\n\u00a02016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Acquired semaphore \"neutron_admin_auth_token_lock\"\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Releasing semaphore \"neutron_admin_auth_token_lock\"\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: REQ: curl -g -i --insecure -X GET https://network.localdomain.com:8020/v2.0/ports.json?network_id=84e366d8-0666-4535-ab6a-84083d437fe3&device_owner=network%3Adhcp -H \"User-Agent: python-neutronclient\" -H \"Accept: application/json\" -H \"X-Auth-Token: {SHA1}7450fe17d1687d3de24555c18d4444bffc1ac5bb\"\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: RESP: [200] date: Wed, 30 Mar 2016 08:53:25 GMT connection: close content-type: application/json; charset=UTF-8 content-length: 912 x-openstack-request-id: req-e5cf52c1-8fbe-4ac4-bf86-1b2c9e027187\nRESP BODY: {\"ports\": [{\"status\": \"ACTIVE\", \"binding:host_id\": \"13EB9F4A-1DD2-11B2-9C27-000000821800\", \"allowed_address_pairs\": [], \"extra_dhcp_opts\": [], \"dns_assignment\": [{\"hostname\": \"host-172-28-12-13\", \"ip_address\": \"172.28.12.13\", \"fqdn\": \"host-172-28-12-13.openstacklocal.\"}], \"device_owner\": \"network:dhcp\", \"binding:profile\": {}, \"fixed_ips\": [{\"subnet_id\": \"6fc84713-11aa-4466-bdd7-c6e3a57b80a3\", \"ip_address\": \"172.28.12.13\"}], \"id\": \"4d8f409f-0757-47fa-a121-5739a06ce826\", \"security_groups\": [], \"device_id\": \"dhcp3935b1d9-07ab-53ad-8236-cb16c36bf22d-84e366d8-0666-4535-ab6a-84083d437fe3\", \"name\": \"\", \"admin_state_up\": true, \"network_id\": \"84e366d8-0666-4535-ab6a-84083d437fe3\", \"dns_name\": \"\", \"binding:vif_details\": {\"port_filter\": true, \"ovs_hybrid_plug\": true}, \"binding:vnic_type\": \"normal\", \"binding:vif_type\": \"ovs\", \"tenant_id\": \"5d4054a226234b0180033ef6b74b5719\", \"mac_address\": \"fa:16:3e:5a:7d:3d\"}]}\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Updating instance_info_cache with network_info: [VIF({'profile': {}, 'ovs_interfaceid': u'ef95f1d6-ca21-4eec-a46b-01eba583de59', 'preserve_on_delete': False, 'network': Network({'bridge': 'br-int', 'subnets': [Subnet({'ips': [FixedIP({'meta': {}, 'version': 4, 'type': 'fixed', 'floating_ips': [], 'address': u'172.28.12.21'})], 'version': 4, 'meta': {'dhcp_server': u'172.28.12.13'}, 'dns': [IP({'meta': {}, 'version': 4, 'type': 'dns', 'address': u'172.28.11.34'})], 'routes': [], 'cidr': u'172.28.0.0/20', 'gateway': IP({'meta': {}, 'version': 4, 'type': 'gateway', 'address': u'172.28.0.1'})})], 'meta': {'injected': False, 'tenant_id': u'5d4054a226234b0180033ef6b74b5719'}, 'id': u'84e366d8-0666-4535-ab6a-84083d437fe3', 'label': u'internal_base'}), 'devname': u'tapef95f1d6-ca', 'vnic_type': u'normal', 'qbh_params': None, 'meta': {}, 'details': {u'port_filter': True, u'ovs_hybrid_plug': True}, 'address': u'fa:16:3e:13:a9:8f', 'active': True, 'type': u'ovs', 'id': u'ef95f1d6-ca21-4eec-a46b-01eba583de59', 'qbg_params': None})]\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Releasing semaphore \"refresh_cache-6fac2a74-619c-4021-ab49-e406a3171897\"\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Updated the network info_cache for instance\n2016-03-30T16:53:26+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Running periodic task ComputeManager._reclaim_queued_deletes\n2016-03-30T16:53:26+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: CONF.reclaim_instance_interval <= 0, skipping...\n2016-03-30T16:53:27+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Running periodic task ComputeManager._instance_usage_audit\n2016-03-30T16:53:29+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Running periodic task ComputeManager._sync_scheduler_instance_info\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Starting monitoring of live migration\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Increasing downtime to 46ms after 0 sec elapsed time\n\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Live Migration failure: operation failed: Failed to connect to remote libvirt URI qemu+tcp://13EB9F4A-1DD2-11B2-9C27-000000821800/system: Unable to resolve address '13EB9F4A-1DD2-11B2-9C27-000000821800' service '16509': Name or service not known\n\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Migration operation thread notification\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Migration running for 0 secs, memory 100% remaining; (bytes processed=0, remaining=0, total=0)\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: VM running on src, migration failed\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Fixed incorrect job type to be 4\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Migration operation has aborted\n2016-03-30T16:54:00+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Live migration monitoring is all done\n\nAs seen in above Error Log, the host 13EB9F4A-1DD2-11B2-9C27-000000821800 cannot be retrieved if we didn't add it to /etc/host.\n\nWe can simply pass the destination host IP in migrate data.", 
    "tags": [
        "live-migration"
    ], 
    "importance": "Undecided", 
    "heat": 12, 
    "link": "https://bugs.launchpad.net/nova/+bug/1564197", 
    "owner": "None", 
    "id": 1564197, 
    "index": 7396, 
    "openned": "2016-03-31 02:34:35.073495+00:00", 
    "created": "2016-03-31 02:34:35.073495+00:00", 
    "title": "Nova should have the ability to retrieve host IP when live migrating", 
    "comments": [
        {
            "content": "Currently, when live migrate instances, if user didn't provide live_migration_inbound_addr, nova will default use destination hostname as the migration destination for operations such as copy disks.\n\nThe translation of hostname to IP is actually depend on the under layer OS, for example, we have to add Our hosts to /etc/hosts in Linux to make it work.\n\nAs it is not hard for nova to get the actual IP of destination node, we can really use the IP directly for the migration operations.\n\n 2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Acquired semaphore \"neutron_admin_auth_token_lock\"\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Releasing semaphore \"neutron_admin_auth_token_lock\"\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: REQ: curl -g -i --insecure -X GET https://network.localdomain.com:8020/v2.0/ports.json?network_id=84e366d8-0666-4535-ab6a-84083d437fe3&device_owner=network%3Adhcp -H \"User-Agent: python-neutronclient\" -H \"Accept: application/json\" -H \"X-Auth-Token: {SHA1}7450fe17d1687d3de24555c18d4444bffc1ac5bb\"\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: RESP: [200] date: Wed, 30 Mar 2016 08:53:25 GMT connection: close content-type: application/json; charset=UTF-8 content-length: 912 x-openstack-request-id: req-e5cf52c1-8fbe-4ac4-bf86-1b2c9e027187\nRESP BODY: {\"ports\": [{\"status\": \"ACTIVE\", \"binding:host_id\": \"13EB9F4A-1DD2-11B2-9C27-000000821800\", \"allowed_address_pairs\": [], \"extra_dhcp_opts\": [], \"dns_assignment\": [{\"hostname\": \"host-172-28-12-13\", \"ip_address\": \"172.28.12.13\", \"fqdn\": \"host-172-28-12-13.openstacklocal.\"}], \"device_owner\": \"network:dhcp\", \"binding:profile\": {}, \"fixed_ips\": [{\"subnet_id\": \"6fc84713-11aa-4466-bdd7-c6e3a57b80a3\", \"ip_address\": \"172.28.12.13\"}], \"id\": \"4d8f409f-0757-47fa-a121-5739a06ce826\", \"security_groups\": [], \"device_id\": \"dhcp3935b1d9-07ab-53ad-8236-cb16c36bf22d-84e366d8-0666-4535-ab6a-84083d437fe3\", \"name\": \"\", \"admin_state_up\": true, \"network_id\": \"84e366d8-0666-4535-ab6a-84083d437fe3\", \"dns_name\": \"\", \"binding:vif_details\": {\"port_filter\": true, \"ovs_hybrid_plug\": true}, \"binding:vnic_type\": \"normal\", \"binding:vif_type\": \"ovs\", \"tenant_id\": \"5d4054a226234b0180033ef6b74b5719\", \"mac_address\": \"fa:16:3e:5a:7d:3d\"}]}\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Updating instance_info_cache with network_info: [VIF({'profile': {}, 'ovs_interfaceid': u'ef95f1d6-ca21-4eec-a46b-01eba583de59', 'preserve_on_delete': False, 'network': Network({'bridge': 'br-int', 'subnets': [Subnet({'ips': [FixedIP({'meta': {}, 'version': 4, 'type': 'fixed', 'floating_ips': [], 'address': u'172.28.12.21'})], 'version': 4, 'meta': {'dhcp_server': u'172.28.12.13'}, 'dns': [IP({'meta': {}, 'version': 4, 'type': 'dns', 'address': u'172.28.11.34'})], 'routes': [], 'cidr': u'172.28.0.0/20', 'gateway': IP({'meta': {}, 'version': 4, 'type': 'gateway', 'address': u'172.28.0.1'})})], 'meta': {'injected': False, 'tenant_id': u'5d4054a226234b0180033ef6b74b5719'}, 'id': u'84e366d8-0666-4535-ab6a-84083d437fe3', 'label': u'internal_base'}), 'devname': u'tapef95f1d6-ca', 'vnic_type': u'normal', 'qbh_params': None, 'meta': {}, 'details': {u'port_filter': True, u'ovs_hybrid_plug': True}, 'address': u'fa:16:3e:13:a9:8f', 'active': True, 'type': u'ovs', 'id': u'ef95f1d6-ca21-4eec-a46b-01eba583de59', 'qbg_params': None})]\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Releasing semaphore \"refresh_cache-6fac2a74-619c-4021-ab49-e406a3171897\"\n2016-03-30T16:53:25+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Updated the network info_cache for instance\n2016-03-30T16:53:26+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Running periodic task ComputeManager._reclaim_queued_deletes\n2016-03-30T16:53:26+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: CONF.reclaim_instance_interval <= 0, skipping...\n2016-03-30T16:53:27+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Running periodic task ComputeManager._instance_usage_audit\n2016-03-30T16:53:29+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Running periodic task ComputeManager._sync_scheduler_instance_info\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Starting monitoring of live migration\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Increasing downtime to 46ms after 0 sec elapsed time\n\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Live Migration failure: operation failed: Failed to connect to remote libvirt URI qemu+tcp://13EB9F4A-1DD2-11B2-9C27-000000821800/system: Unable to resolve address '13EB9F4A-1DD2-11B2-9C27-000000821800' service '16509': Name or service not known\n\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Migration operation thread notification\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Migration running for 0 secs, memory 100% remaining; (bytes processed=0, remaining=0, total=0)\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: VM running on src, migration failed\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Fixed incorrect job type to be 4\n2016-03-30T16:53:59+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Migration operation has aborted\n2016-03-30T16:54:00+08:00 13CC40D2-1DD2-11B2-9C27-000000821800 nova-compute: Live migration monitoring is all done\n\nAs seen in above Error Log, the host 13EB9F4A-1DD2-11B2-9C27-000000821800 cannot be retrieved if we didn't add it to /etc/host.\n\nWe can simply pass the destination host IP in migrate data.", 
            "date_created": "2016-03-31 02:34:35.073495+00:00", 
            "author": "https://api.launchpad.net/1.0/~zhengzhenyu"
        }, 
        {
            "content": "As talked with Zhenyu Zheng  in #openstack-nova, he's going to leave a comment here how to solve this, as he hasn't time right now to work on that himself.", 
            "date_created": "2016-04-18 10:58:04.175445+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "I'm not convinced that it's an issue for us to say that either have DNS working, or specify this manually in systems. I feel like Nova acting as a DNS replacement is a bad model. ", 
            "date_created": "2016-04-18 18:50:27.712025+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "[Expired for OpenStack Compute (nova) because there has been no activity for 60 days.]", 
            "date_created": "2016-06-18 04:18:27.915458+00:00", 
            "author": "https://api.launchpad.net/1.0/~janitor"
        }
    ], 
    "closed": "2016-06-18 04:18:28.557159+00:00"
}