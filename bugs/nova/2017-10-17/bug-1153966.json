{
    "status": "Fix Released", 
    "last_updated": "2013-04-04 12:48:53.335366+00:00", 
    "description": "When attaching a volume the next error is occurred:\n\n2013-03-11 21:43:29.921 ERROR cinder.openstack.common.rpc.common [req-946e0c80-f48a-431d-8848-997d993f4fce 4353ebfbc4764cd1882c0f336f73ae72 be2150f90f034291b2bbfcd72d7e4884] Returning exception an integer is required to caller\n2013-03-11 21:43:29.921 ERROR cinder.openstack.common.rpc.common [req-946e0c80-f48a-431d-8848-997d993f4fce 4353ebfbc4764cd1882c0f336f73ae72 be2150f90f034291b2bbfcd72d7e4884] ['Traceback (most recent call last):\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\openstack\\\\common\\\\rpc\\\\amqp.py\", line 430, in _process_data\\n    rval = self.proxy.dispatch(ctxt, version, method, **args)\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\openstack\\\\common\\\\rpc\\\\dispatcher.py\", line 133, in dispatch\\n    return getattr(proxyobj, method)(ctxt, **kwargs)\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\volume\\\\manager.py\", line 536, in attach_volume\\n    return do_attach()\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\openstack\\\\common\\\\lockutils.py\", line 214, in inner\\n    with lock:\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\openstack\\\\common\\\\lockutils.py\", line 82, in __enter__\\n    self.trylock()\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\openstack\\\\common\\\\lockutils.py\", line 109, in trylock\\n    msvcrt.locking(self.lockfile, msvcrt.LK_NBLCK, 1)\\n', 'TypeError: an integer is required\\n']\n2013-03-11 21:43:32.229 ERROR cinder.openstack.common.rpc.amqp [req-c4c420ae-df17-4009-aae3-bc6a7e9729b4 4353ebfbc4764cd1882c0f336f73ae72 be2150f90f034291b2bbfcd72d7e4884] Exception during message handling\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\openstack\\common\\rpc\\amqp.py\", line 430, in _process_data\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\openstack\\common\\rpc\\dispatcher.py\", line 133, in dispatch\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\volume\\manager.py\", line 536, in attach_volume\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     return do_attach()\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\openstack\\common\\lockutils.py\", line 214, in inner\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     with lock:\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\openstack\\common\\lockutils.py\", line 82, in __enter__\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     self.trylock()\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\openstack\\common\\lockutils.py\", line 109, in trylock\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     msvcrt.locking(self.lockfile, msvcrt.LK_NBLCK, 1)\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp TypeError: an integer is required", 
    "tags": [
        "drivers"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1153966", 
    "owner": "https://api.launchpad.net/1.0/~pednape", 
    "id": 1153966, 
    "index": 3275, 
    "openned": "2013-03-25 16:41:12.927349+00:00", 
    "created": "2013-03-12 08:51:57.474240+00:00", 
    "title": "Fix locking issues in Windows", 
    "comments": [
        {
            "content": "When attaching a volume the next error is occurred:\n\n2013-03-11 21:43:29.921 ERROR cinder.openstack.common.rpc.common [req-946e0c80-f48a-431d-8848-997d993f4fce 4353ebfbc4764cd1882c0f336f73ae72 be2150f90f034291b2bbfcd72d7e4884] Returning exception an integer is required to caller\n2013-03-11 21:43:29.921 ERROR cinder.openstack.common.rpc.common [req-946e0c80-f48a-431d-8848-997d993f4fce 4353ebfbc4764cd1882c0f336f73ae72 be2150f90f034291b2bbfcd72d7e4884] ['Traceback (most recent call last):\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\openstack\\\\common\\\\rpc\\\\amqp.py\", line 430, in _process_data\\n    rval = self.proxy.dispatch(ctxt, version, method, **args)\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\openstack\\\\common\\\\rpc\\\\dispatcher.py\", line 133, in dispatch\\n    return getattr(proxyobj, method)(ctxt, **kwargs)\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\volume\\\\manager.py\", line 536, in attach_volume\\n    return do_attach()\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\openstack\\\\common\\\\lockutils.py\", line 214, in inner\\n    with lock:\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\openstack\\\\common\\\\lockutils.py\", line 82, in __enter__\\n    self.trylock()\\n', '  File \"C:\\\\dev\\\\openstack\\\\cinder\\\\cinder\\\\openstack\\\\common\\\\lockutils.py\", line 109, in trylock\\n    msvcrt.locking(self.lockfile, msvcrt.LK_NBLCK, 1)\\n', 'TypeError: an integer is required\\n']\n2013-03-11 21:43:32.229 ERROR cinder.openstack.common.rpc.amqp [req-c4c420ae-df17-4009-aae3-bc6a7e9729b4 4353ebfbc4764cd1882c0f336f73ae72 be2150f90f034291b2bbfcd72d7e4884] Exception during message handling\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\openstack\\common\\rpc\\amqp.py\", line 430, in _process_data\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\openstack\\common\\rpc\\dispatcher.py\", line 133, in dispatch\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\volume\\manager.py\", line 536, in attach_volume\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     return do_attach()\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\openstack\\common\\lockutils.py\", line 214, in inner\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     with lock:\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\openstack\\common\\lockutils.py\", line 82, in __enter__\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     self.trylock()\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp   File \"C:\\dev\\openstack\\cinder\\cinder\\openstack\\common\\lockutils.py\", line 109, in trylock\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp     msvcrt.locking(self.lockfile, msvcrt.LK_NBLCK, 1)\n2013-03-11 21:43:32.229 236 TRACE cinder.openstack.common.rpc.amqp TypeError: an integer is required", 
            "date_created": "2013-03-12 08:51:57.474240+00:00", 
            "author": "https://api.launchpad.net/1.0/~pednape"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/24156", 
            "date_created": "2013-03-12 10:16:23.048468+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "http://docs.python.org/2/library/msvcrt.html\n\nThe docs for msvcrt.locking() say that:\n\n\"Lock part of a file based on file descriptor fd from the C runtime.\"\n\nWe need to use fileno() for a file descriptor opened with open()", 
            "date_created": "2013-03-12 10:50:06.064563+00:00", 
            "author": "https://api.launchpad.net/1.0/~alexpilotti"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/24162", 
            "date_created": "2013-03-12 11:28:12.767261+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/24162\nCommitted: http://github.com/openstack/oslo-incubator/commit/21925b63af87c36be97eec5b212e06477471bb1e\nSubmitter: Jenkins\nBranch:    master\n\ncommit 21925b63af87c36be97eec5b212e06477471bb1e\nAuthor: Pedro Navarro Perez <email address hidden>\nDate:   Tue Mar 12 04:24:51 2013 -0700\n\n    Fix locking issues in Windows\n    \n    The Windows Storage Cinder plugin through\n    the Windows Locks implementation\n    of the InterProcessLock fails in\n    attaching/detaching operations.\n    \n    Change-Id: I682205592e152b3222e04ca3221d25594d134dd9\n    Fixes: bug #1153966\n", 
            "date_created": "2013-03-12 14:11:41.734850+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "In nova master: https://review.openstack.org/#/c/25167/1\r\nIn nova grizzly-rc2: https://review.openstack.org/#/c/25277/", 
            "date_created": "2013-03-25 16:42:12.993378+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }
    ], 
    "closed": "2013-03-26 13:05:09.726577+00:00"
}