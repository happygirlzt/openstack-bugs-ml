{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:42:40.498473+00:00", 
    "description": "From a tempest test test_create_image_specify_name_over_256_chars when creating an image with \na name which is too long it causes a stacktrace in the logs because the exception from glance is \nnot caught. Though the end result is ok as the uncaught exception is still a 400 Bad Request.\n\nx-openstack-request-id: req-b9f7a737-6692-4d02-8101-cecce2f5b341\n\n400 Bad Request\n\nImage name too long: 269\n\n\n\n2013-04-16 17:10:37    ERROR [glanceclient.common.http] Request returned failure status.\n2013-04-16 17:10:37    ERROR [nova.api.openstack] Caught error: 400 Bad Request\nImage name too long: 269\n    (HTTP 400)\nTraceback (most recent call last):\n  File \"/srv/compile/openstack/nova/nova/api/openstack/__init__.py\", line 81, in __call__\n    return req.get_response(self.application)   \n  File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1296, in send\n    application, catch_exc_info=False)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1260, in call_application\n    app_iter = application(self.environ, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n    return resp(environ, start_response)\n  File \"/opt/stack/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 451, in __call__\n    return self.app(env, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n    return resp(environ, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n    return resp(environ, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n    response = self.app(environ, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n    return resp(environ, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n    resp = self.call_func(req, *args, **self.kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n    return self.func(req, *args, **kwargs)\n  File \"/srv/compile/openstack/nova/nova/api/openstack/wsgi.py\", line 899, in __call__\n    content_type, body, accept)\n  File \"/srv/compile/openstack/nova/nova/api/openstack/wsgi.py\", line 951, in _process_stack\n    action_result = self.dispatch(meth, request, action_args)\n  File \"/srv/compile/openstack/nova/nova/api/openstack/wsgi.py\", line 1030, in dispatch\n    return method(req=request, **action_args)   \n  File \"/srv/compile/openstack/nova/nova/api/openstack/common.py\", line 448, in inner\n    return f(*args, **kwargs)\n  File \"/srv/compile/openstack/nova/nova/api/openstack/compute/servers.py\", line 1365, in _action_create_image\n    extra_properties=props)\n  File \"/srv/compile/openstack/nova/nova/compute/api.py\", line 167, in wrapped\n    return func(self, context, target, *args, **kwargs)\n  File \"/srv/compile/openstack/nova/nova/compute/api.py\", line 138, in inner\n    return f(self, context, instance, *args, **kw)\n  File \"/srv/compile/openstack/nova/nova/compute/api.py\", line 1505, in snapshot\n    'snapshot', extra_properties=extra_properties)\n  File \"/srv/compile/openstack/nova/nova/compute/api.py\", line 1579, in _create_image\n    return self.image_service.create(context, sent_meta)\n  File \"/srv/compile/openstack/nova/nova/image/glance.py\", line 295, in create\n    context, 1, 'create', **sent_service_image_meta)\n  File \"/srv/compile/openstack/nova/nova/image/glance.py\", line 182, in call\n    return getattr(client.images, method)(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/glanceclient/v1/images.py\", line 250, in create\n    'POST', '/v1/images', headers=hdrs, body=image_data)\n  File \"/usr/local/lib/python2.7/dist-packages/glanceclient/common/http.py\", line 244, in raw_request\n    return self._http_request(url, method, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/glanceclient/common/http.py\", line 205, in _http_request\n    raise exc.from_response(resp, body_str)\nHTTPBadRequest: 400 Bad Request\nImage name too long: 269\n    (HTTP 400)\n2013-04-16 17:10:37     INFO [nova.api.openstack] http://192.168.1.18:8774/v2/9c238a60c19b45608c2a82f4687f266d/servers/9610fcd1-c29d-4b48-960a-062583e5e086/action returned with HTTP 400\n2013-04-16 17:10:37    DEBUG [nova.api.openstack.wsgi] Returning 400 to user: The server could not comply with the request since it is either malformed or otherwise incorrect.\n2013-04-16 17:10:37     INFO [nova.osapi_compute.wsgi.server] 192.168.1.18 \"POST /v2/9c238a60c19b45608c2a82f4687f266d/servers/9610fcd1-c29d-4b48-960a-062583e5e086/action HTTP/1.1\" status: 400 len: 338 time: 0.1240311", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1169560", 
    "owner": "https://api.launchpad.net/1.0/~cyeoh-0", 
    "id": 1169560, 
    "index": 3359, 
    "openned": "2013-04-16 13:21:25.739469+00:00", 
    "created": "2013-04-16 13:21:25.739469+00:00", 
    "title": "image creation causes stacktrace", 
    "comments": [
        {
            "content": "From a tempest test test_create_image_specify_name_over_256_chars when creating an image with \na name which is too long it causes a stacktrace in the logs because the exception from glance is \nnot caught. Though the end result is ok as the uncaught exception is still a 400 Bad Request.\n\nx-openstack-request-id: req-b9f7a737-6692-4d02-8101-cecce2f5b341\n\n400 Bad Request\n\nImage name too long: 269\n\n\n\n2013-04-16 17:10:37    ERROR [glanceclient.common.http] Request returned failure status.\n2013-04-16 17:10:37    ERROR [nova.api.openstack] Caught error: 400 Bad Request\nImage name too long: 269\n    (HTTP 400)\nTraceback (most recent call last):\n  File \"/srv/compile/openstack/nova/nova/api/openstack/__init__.py\", line 81, in __call__\n    return req.get_response(self.application)   \n  File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1296, in send\n    application, catch_exc_info=False)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1260, in call_application\n    app_iter = application(self.environ, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n    return resp(environ, start_response)\n  File \"/opt/stack/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 451, in __call__\n    return self.app(env, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n    return resp(environ, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n    return resp(environ, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n    response = self.app(environ, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n    return resp(environ, start_response)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n    resp = self.call_func(req, *args, **self.kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n    return self.func(req, *args, **kwargs)\n  File \"/srv/compile/openstack/nova/nova/api/openstack/wsgi.py\", line 899, in __call__\n    content_type, body, accept)\n  File \"/srv/compile/openstack/nova/nova/api/openstack/wsgi.py\", line 951, in _process_stack\n    action_result = self.dispatch(meth, request, action_args)\n  File \"/srv/compile/openstack/nova/nova/api/openstack/wsgi.py\", line 1030, in dispatch\n    return method(req=request, **action_args)   \n  File \"/srv/compile/openstack/nova/nova/api/openstack/common.py\", line 448, in inner\n    return f(*args, **kwargs)\n  File \"/srv/compile/openstack/nova/nova/api/openstack/compute/servers.py\", line 1365, in _action_create_image\n    extra_properties=props)\n  File \"/srv/compile/openstack/nova/nova/compute/api.py\", line 167, in wrapped\n    return func(self, context, target, *args, **kwargs)\n  File \"/srv/compile/openstack/nova/nova/compute/api.py\", line 138, in inner\n    return f(self, context, instance, *args, **kw)\n  File \"/srv/compile/openstack/nova/nova/compute/api.py\", line 1505, in snapshot\n    'snapshot', extra_properties=extra_properties)\n  File \"/srv/compile/openstack/nova/nova/compute/api.py\", line 1579, in _create_image\n    return self.image_service.create(context, sent_meta)\n  File \"/srv/compile/openstack/nova/nova/image/glance.py\", line 295, in create\n    context, 1, 'create', **sent_service_image_meta)\n  File \"/srv/compile/openstack/nova/nova/image/glance.py\", line 182, in call\n    return getattr(client.images, method)(*args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/glanceclient/v1/images.py\", line 250, in create\n    'POST', '/v1/images', headers=hdrs, body=image_data)\n  File \"/usr/local/lib/python2.7/dist-packages/glanceclient/common/http.py\", line 244, in raw_request\n    return self._http_request(url, method, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/glanceclient/common/http.py\", line 205, in _http_request\n    raise exc.from_response(resp, body_str)\nHTTPBadRequest: 400 Bad Request\nImage name too long: 269\n    (HTTP 400)\n2013-04-16 17:10:37     INFO [nova.api.openstack] http://192.168.1.18:8774/v2/9c238a60c19b45608c2a82f4687f266d/servers/9610fcd1-c29d-4b48-960a-062583e5e086/action returned with HTTP 400\n2013-04-16 17:10:37    DEBUG [nova.api.openstack.wsgi] Returning 400 to user: The server could not comply with the request since it is either malformed or otherwise incorrect.\n2013-04-16 17:10:37     INFO [nova.osapi_compute.wsgi.server] 192.168.1.18 \"POST /v2/9c238a60c19b45608c2a82f4687f266d/servers/9610fcd1-c29d-4b48-960a-062583e5e086/action HTTP/1.1\" status: 400 len: 338 time: 0.1240311", 
            "date_created": "2013-04-16 13:21:25.739469+00:00", 
            "author": "https://api.launchpad.net/1.0/~cyeoh-0"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/26999", 
            "date_created": "2013-04-16 13:35:17.411774+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/26999\nCommitted: http://github.com/openstack/nova/commit/09c7fc3b694ab401d42c9e59b17e24bbe4383588\nSubmitter: Jenkins\nBranch:    master\n\ncommit 09c7fc3b694ab401d42c9e59b17e24bbe4383588\nAuthor: Chris Yeoh <email address hidden>\nDate:   Tue Apr 16 23:01:26 2013 +0930\n\n    Catch glance image create exceptions\n    \n    Catch exception from glance when image creation fails because the\n    requested name is too long. Currently the exception is not caught\n    in the api which results in an 400 Bad Request correctly being\n    returned, but also leaving a traceback in the logs. Correctly catching\n    the exception and explicitly raising an HTTPBadRequest removes\n    the production of the traceback.\n    \n    Fixes bug #1169560\n    \n    Change-Id: I511da79cb0b1b4578bf43f0819b2ac64fb6e5fb3\n", 
            "date_created": "2013-05-01 14:20:46.777787+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/grizzly\nReview: https://review.openstack.org/27953", 
            "date_created": "2013-05-01 20:08:05.515309+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/27953\nCommitted: http://github.com/openstack/nova/commit/a313b12aecd32c203055f59024f3df8d05116554\nSubmitter: Jenkins\nBranch:    stable/grizzly\n\ncommit a313b12aecd32c203055f59024f3df8d05116554\nAuthor: Chris Yeoh <email address hidden>\nDate:   Tue Apr 16 23:01:26 2013 +0930\n\n    Catch glance image create exceptions\n    \n    Catch exception from glance when image creation fails because the\n    requested name is too long. Currently the exception is not caught\n    in the api which results in an 400 Bad Request correctly being\n    returned, but also leaving a traceback in the logs. Correctly catching\n    the exception and explicitly raising an HTTPBadRequest removes\n    the production of the traceback.\n    \n    Fixes bug #1169560\n    \n    Change-Id: I511da79cb0b1b4578bf43f0819b2ac64fb6e5fb3\n    (cherry picked from commit 09c7fc3b694ab401d42c9e59b17e24bbe4383588)\n", 
            "date_created": "2013-05-02 18:21:34.292967+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-05-29 10:26:16.730678+00:00"
}