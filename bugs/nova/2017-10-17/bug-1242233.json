{
    "status": "Opinion", 
    "last_updated": "2014-07-10 01:29:06.249833+00:00", 
    "description": "\nWith following configuration:\nlibvirt_images_type=lvm\nlibvirt_images_volume_group=stack-volumes\nallow_resize_to_same_host = True\n\nliugya@liugya-ubuntu:~$ nova flavor-list\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| ID | Name      | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| 1  | m1.tiny   | 512       | 1    | 0         |      | 1     | 1.0         | True      |\n| 2  | m1.small  | 2048      | 20   | 0         |      | 1     | 1.0         | True      |\n| 3  | m1.medium | 4096      | 40   | 0         |      | 2     | 1.0         | True      |\n| 4  | m1.large  | 8192      | 80   | 0         |      | 4     | 1.0         | True      |\n| 42 | m1.nano   | 64        | 0    | 0         |      | 1     | 1.0         | True      |\n| 5  | m1.xlarge | 16384     | 160  | 0         |      | 8     | 1.0         | True      |\n| 6  | m1.test   | 256       | 1    | 0         |      | 2     | 1.0         | True      |\n| 84 | m1.micro  | 128       | 0    | 0         |      | 1     | 1.0         | True      |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n\n1) Create a VM based on flavor 1\n2) resize to flavor 6\n3) resize revert the VM, compute report error\n\n2013-10-20 10:19:15.677 DEBUG amqp [-] Channel open from (pid=21759) _open_ok /usr/local/lib/python2.7/dist-packages/amqp-1.0.12-py2.7.egg/amqp/channel.py:420\n2013-10-20 10:19:15.678 ERROR nova.openstack.common.rpc.amqp [req-2bb3187b-6555-4c6c-826d-0917c91aba97 admin admin] Exception during message handling\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 354, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 90, in wrapped\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 73, in wrapped\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 244, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     pass\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 230, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 295, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 272, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 259, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 2827, in finish_revert_resize\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     block_device_info, power_on)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 4608, in finish_revert_migration\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     block_device_info, power_on)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3224, in _create_domain_and_network\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     domain = self._create_domain(xml, instance=instance, power_on=power_on)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3164, in _create_domain\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     domain.XMLDesc(0))\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3159, in _create_domain\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     domain.createWithFlags(launch_flags)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 179, in doit\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 139, in proxy_call\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     rv = execute(f,*args,**kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 77, in tworker\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     rv = meth(*args,**kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 581, in createWithFlags\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp libvirtError: Unable to allow access for disk path /dev/stack-volumes/instance-00000025_disk: No such file or directory\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp", 
    "tags": [
        "compute", 
        "libvirt", 
        "lvm"
    ], 
    "importance": "Medium", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1242233", 
    "owner": "https://api.launchpad.net/1.0/~jay-lau-513", 
    "id": 1242233, 
    "index": 3671, 
    "openned": "2013-10-20 02:22:43.858226+00:00", 
    "created": "2013-10-20 02:22:43.858226+00:00", 
    "title": "nova resize revert will be failed when using lvm", 
    "comments": [
        {
            "content": "\nWith following configuration:\nlibvirt_images_type=lvm\nlibvirt_images_volume_group=stack-volumes\nallow_resize_to_same_host = True\n\nliugya@liugya-ubuntu:~$ nova flavor-list\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| ID | Name      | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor | Is_Public |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n| 1  | m1.tiny   | 512       | 1    | 0         |      | 1     | 1.0         | True      |\n| 2  | m1.small  | 2048      | 20   | 0         |      | 1     | 1.0         | True      |\n| 3  | m1.medium | 4096      | 40   | 0         |      | 2     | 1.0         | True      |\n| 4  | m1.large  | 8192      | 80   | 0         |      | 4     | 1.0         | True      |\n| 42 | m1.nano   | 64        | 0    | 0         |      | 1     | 1.0         | True      |\n| 5  | m1.xlarge | 16384     | 160  | 0         |      | 8     | 1.0         | True      |\n| 6  | m1.test   | 256       | 1    | 0         |      | 2     | 1.0         | True      |\n| 84 | m1.micro  | 128       | 0    | 0         |      | 1     | 1.0         | True      |\n+----+-----------+-----------+------+-----------+------+-------+-------------+-----------+\n\n1) Create a VM based on flavor 1\n2) resize to flavor 6\n3) resize revert the VM, compute report error\n\n2013-10-20 10:19:15.677 DEBUG amqp [-] Channel open from (pid=21759) _open_ok /usr/local/lib/python2.7/dist-packages/amqp-1.0.12-py2.7.egg/amqp/channel.py:420\n2013-10-20 10:19:15.678 ERROR nova.openstack.common.rpc.amqp [req-2bb3187b-6555-4c6c-826d-0917c91aba97 admin admin] Exception during message handling\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 354, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 90, in wrapped\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/exception.py\", line 73, in wrapped\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 244, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     pass\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 230, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 295, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 272, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 259, in decorated_function\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/compute/manager.py\", line 2827, in finish_revert_resize\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     block_device_info, power_on)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 4608, in finish_revert_migration\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     block_device_info, power_on)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3224, in _create_domain_and_network\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     domain = self._create_domain(xml, instance=instance, power_on=power_on)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3164, in _create_domain\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     domain.XMLDesc(0))\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 3159, in _create_domain\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     domain.createWithFlags(launch_flags)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 179, in doit\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 139, in proxy_call\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     rv = execute(f,*args,**kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 77, in tworker\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     rv = meth(*args,**kwargs)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 581, in createWithFlags\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp libvirtError: Unable to allow access for disk path /dev/stack-volumes/instance-00000025_disk: No such file or directory\n2013-10-20 10:19:15.678 TRACE nova.openstack.common.rpc.amqp", 
            "date_created": "2013-10-20 02:22:43.858226+00:00", 
            "author": "https://api.launchpad.net/1.0/~jay-lau-513"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/52807", 
            "date_created": "2013-10-20 04:42:39.380295+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "see discussion at https://review.openstack.org/#/c/52807/", 
            "date_created": "2014-07-10 01:29:00.089536+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }
    ], 
    "closed": "2014-07-10 01:29:04.331964+00:00"
}