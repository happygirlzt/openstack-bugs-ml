{
    "status": "Invalid", 
    "last_updated": "2015-06-11 08:07:05.651233+00:00", 
    "description": "libvirt: thrown NotImplementedError when running \"nova root-password\"\n\nAs we all know, the command \u201cnova root-password\u201d is used to change the root password for a server,\nbut libvirt driver does not support this feature at present.\n\nThe following is the description of the error:\n\n1. run \"nova root-password\" on controler.\n\n2. returning 501 error. nova-api log:\n\n2015-06-05 14:34:11.588 3993 INFO nova.api.openstack.wsgi [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 None] HTTP exception thrown: Unable to set password on instance\n2015-06-05 14:34:11.589 3993 DEBUG nova.api.openstack.wsgi [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 None] Returning 501 to user: Unable to set password on instance _call_ /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:1217\n2015-06-05 14:34:11.591 3993 INFO nova.osapi_compute.wsgi.server [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 None] 172.40.0.2 \"POST /v\n2/8e3d0869585d486daf23865ebc85449b/servers/12d57f28-8d00-47d3-876c-ebdba7145ddf/action HTTP/1.1\" status: 501 len: 282 time: 3.0169549\n\n3. thrown NotImplementedError. nova-compute log:\n\n2015-06-05 14:34:10.654 13446 WARNING nova.compute.manager [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 None] [instance: 12d57f28-8d00-\n47d3-876c-ebdba7145ddf] set_admin_password is not implemented by this driver or guest instance.\n2015-06-05 14:34:11.532 13446 ERROR oslo.messaging.rpc.dispatcher [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 ] Exception during messa\nge handling: set_admin_password is not implemented by this driver or guest instance.\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispat\ncher.py\", line 133, in _dispatch_and_reply\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher incoming.message))\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispat\ncher.py\", line 176, in _dispatch\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher return self._do_dispatch(endpoint, method, ctxt, args)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispat\ncher.py\", line 122, in _do_dispatch\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher result = getattr(endpoint, method)(ctxt, **new_args)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 403, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line\n88, in wrapped\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher payload)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/openstack/common/exc\nutils.py\", line 68, in _exit_\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher six.reraise(self.type_, self.value, self.tb)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line\n71, in wrapped\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher return f(self, context, *args, **kw)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 284, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/openstack/common/exc\nutils.py\", line 68, in _exit_\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher six.reraise(self.type_, self.value, self.tb)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 270, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 337, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 313, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/openstack/common/exc\nutils.py\", line 68, in _exit_\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher six.reraise(self.type_, self.value, self.tb)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 300, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 2919, in set_admin_password\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher NotImplementedError: set_admin_password is not implemented by this\ndriver or guest instance.\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher\n2015-06-05 14:34:11.579 13446 ERROR oslo.messaging._drivers.common [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 ] Returning exception s\net_admin_password is not implemented by this driver or guest instance. to caller\n2015-06-05 14:34:11.579 13446 ERROR oslo.messaging._drivers.common [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 ] ['Traceback (most rec\nent call last):\\n', ' File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\\n\nincoming.message))\\n', ' File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\\n r\neturn self._do_dispatch(endpoint, method, ctxt, args)\\n', ' File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\n\", line 122, in _do_dispatch\\n result = getattr(endpoint, method)(ctxt, **new_args)\\n', ' File \"/usr/lib/python2.6/site-packages\n/nova/compute/manager.py\", line 403, in decorated_function\\n', ' File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 88\n, in wrapped\\n payload)\\n', ' File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in _exit_\\n\nsix.reraise(self.type_, self.value, self.tb)\\n', ' File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 71, in wrappe\nd\\n return f(self, context, *args, **kw)\\n', ' File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 284, in dec\norated_function\\n', ' File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in _exit_\\n six.rera\nise(self.type_, self.value, self.tb)\\n', ' File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 270, in decorated_\nfunction\\n', ' File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 337, in decorated_function\\n', ' File \"/usr/l\nib/python2.6/site-packages/nova/compute/manager.py\", line 313, in decorated_function\\n', ' File \"/usr/lib/python2.6/site-packages/n\nova/openstack/common/excutils.py\", line 68, in _exit\\n six.reraise(self.type, self.value, self.tb)\\n', ' File \"/usr/lib/pyth\non2.6/site-packages/nova/compute/manager.py\", line 300, in decorated_function\\n', ' File \"/usr/lib/python2.6/site-packages/nova/com\npute/manager.py\", line 2919, in set_admin_password\\n', 'NotImplementedError: set_admin_password is not implemented by this driver or\nguest instance.\\n']\n\n4.Here is the code.\n\u00a0\u00a0\u00a0nova/compute/manager.py   ComputeManager.set_admin_password()\n\n\u00a0\u00a0\u00a0\u00a0def set_admin_password(self, context, instance, new_pass):\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"\"\"Set the root/admin password for an instance on this host.\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0This is generally only called by API password resets after an\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0image has been built.\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0@param context: Nova auth context.\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0@param instance: Nova instance object.\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0@param new_pass: The admin password for the instance.\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\"\"\"\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0context = context.elevated()\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0if new_pass is None:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0# Generate a random password\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0new_pass = utils.generate_password()\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0current_power_state = self._get_power_state(context, instance)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0expected_state = power_state.RUNNING\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0if current_power_state != expected_state:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance.task_state = None\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance.save(expected_task_state=task_states.UPDATING_PASSWORD)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0_msg = _('instance %s is not running') % instance.uuid\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0raise exception.InstancePasswordSetFailed(\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance=instance.uuid, reason=_msg)\n\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0try:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0self.driver.set_admin_password(instance, new_pass)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0LOG.info(_LI(\"Root password set\"), instance=instance)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance.task_state = None\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance.save(\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0expected_task_state=task_states.UPDATING_PASSWORD)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0except NotImplementedError:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0LOG.warning(_LW('set_admin_password is not implemented '\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'by this driver or guest instance.'),\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance=instance)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance.task_state = None\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance.save(\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0expected_task_state=task_states.UPDATING_PASSWORD)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0raise NotImplementedError(_('set_admin_password is not '\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'implemented by this driver or guest '\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0'instance.'))\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0except exception.UnexpectedTaskStateError:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0# interrupted by another (most likely delete) task\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0# do not retry\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0raise\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0except Exception:\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0# Catch all here because this could be anything.\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0LOG.exception(_LE('set_admin_password failed'),\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance=instance)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0self._set_instance_obj_error_state(context, instance)\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0# We create a new exception here so that we won't\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0# potentially reveal password information to the\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0# API caller.  The real exception is logged above\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0_msg = _('error setting admin password')\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0raise exception.InstancePasswordSetFailed(\n\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0\u00a0instance=instance.uuid, reason=_msg)", 
    "tags": [
        "libvirt"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1462239", 
    "owner": "None", 
    "id": 1462239, 
    "index": 6856, 
    "openned": "2015-06-05 08:05:05.520596+00:00", 
    "created": "2015-06-05 08:05:05.520596+00:00", 
    "title": "libvirt: thrown NotImplementedError when running 'nova root-password'", 
    "comments": [
        {
            "content": "libvirt: thrown NotImplementedError when running \"nova root-password\"\n\nAs we all know, the command \u201cnova root-password\u201d is used to change the root password for a server,\nbut libvirt driver does not support this function at present.\n\nThe following is the description of the error:\n\n1. run \"nova root-password\" on controler.\n\n2. return 501 error. nova-api log:\n\n2015-06-05 14:34:11.588 3993 INFO nova.api.openstack.wsgi [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 None] HTTP exception thrown: Unable to set password on instance\n2015-06-05 14:34:11.589 3993 DEBUG nova.api.openstack.wsgi [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 None] Returning 501 to user: Unable to set password on instance _call_ /usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py:1217\n2015-06-05 14:34:11.591 3993 INFO nova.osapi_compute.wsgi.server [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 None] 172.40.0.2 \"POST /v\n2/8e3d0869585d486daf23865ebc85449b/servers/12d57f28-8d00-47d3-876c-ebdba7145ddf/action HTTP/1.1\" status: 501 len: 282 time: 3.0169549\n\n3. thrown NotImplementedError. nova-compute log: \n\n2015-06-05 14:34:10.654 13446 WARNING nova.compute.manager [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 None] [instance: 12d57f28-8d00-\n47d3-876c-ebdba7145ddf] set_admin_password is not implemented by this driver or guest instance.\n2015-06-05 14:34:11.532 13446 ERROR oslo.messaging.rpc.dispatcher [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 ] Exception during messa\nge handling: set_admin_password is not implemented by this driver or guest instance.\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispat\ncher.py\", line 133, in _dispatch_and_reply\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher incoming.message))\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispat\ncher.py\", line 176, in _dispatch\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher return self._do_dispatch(endpoint, method, ctxt, args)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispat\ncher.py\", line 122, in _do_dispatch\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher result = getattr(endpoint, method)(ctxt, **new_args)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 403, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line\n88, in wrapped\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher payload)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/openstack/common/exc\nutils.py\", line 68, in _exit_\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher six.reraise(self.type_, self.value, self.tb)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line\n71, in wrapped\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher return f(self, context, *args, **kw)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 284, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/openstack/common/exc\nutils.py\", line 68, in _exit_\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher six.reraise(self.type_, self.value, self.tb)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 270, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 337, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 313, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/openstack/common/exc\nutils.py\", line 68, in _exit_\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher six.reraise(self.type_, self.value, self.tb)\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 300, in decorated_function\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\",\nline 2919, in set_admin_password\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher NotImplementedError: set_admin_password is not implemented by this\ndriver or guest instance.\n2015-06-05 14:34:11.532 13446 TRACE oslo.messaging.rpc.dispatcher\n2015-06-05 14:34:11.579 13446 ERROR oslo.messaging._drivers.common [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 ] Returning exception s\net_admin_password is not implemented by this driver or guest instance. to caller\n2015-06-05 14:34:11.579 13446 ERROR oslo.messaging._drivers.common [req-0dc1e6b2-e700-4dfb-a388-c3ddbc0db7e3 ] ['Traceback (most rec\nent call last):\\n', ' File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\\n \nincoming.message))\\n', ' File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\\n r\neturn self._do_dispatch(endpoint, method, ctxt, args)\\n', ' File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\n\", line 122, in _do_dispatch\\n result = getattr(endpoint, method)(ctxt, **new_args)\\n', ' File \"/usr/lib/python2.6/site-packages\n/nova/compute/manager.py\", line 403, in decorated_function\\n', ' File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 88\n, in wrapped\\n payload)\\n', ' File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in _exit_\\n \nsix.reraise(self.type_, self.value, self.tb)\\n', ' File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 71, in wrappe\nd\\n return f(self, context, *args, **kw)\\n', ' File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 284, in dec\norated_function\\n', ' File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in _exit_\\n six.rera\nise(self.type_, self.value, self.tb)\\n', ' File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 270, in decorated_\nfunction\\n', ' File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 337, in decorated_function\\n', ' File \"/usr/l\nib/python2.6/site-packages/nova/compute/manager.py\", line 313, in decorated_function\\n', ' File \"/usr/lib/python2.6/site-packages/n\nova/openstack/common/excutils.py\", line 68, in _exit\\n six.reraise(self.type, self.value, self.tb)\\n', ' File \"/usr/lib/pyth\non2.6/site-packages/nova/compute/manager.py\", line 300, in decorated_function\\n', ' File \"/usr/lib/python2.6/site-packages/nova/com\npute/manager.py\", line 2919, in set_admin_password\\n', 'NotImplementedError: set_admin_password is not implemented by this driver or\nguest instance.\\n']\n\n\n4.Here is the code.\n   nova/compute/manager.py   ComputeManager.set_admin_password()\n\n    def set_admin_password(self, context, instance, new_pass):\n        \"\"\"Set the root/admin password for an instance on this host.\n\n        This is generally only called by API password resets after an\n        image has been built.\n\n        @param context: Nova auth context.\n        @param instance: Nova instance object.\n        @param new_pass: The admin password for the instance.\n        \"\"\"\n\n        context = context.elevated()\n        if new_pass is None:\n            # Generate a random password\n            new_pass = utils.generate_password()\n\n        current_power_state = self._get_power_state(context, instance)\n        expected_state = power_state.RUNNING\n\n        if current_power_state != expected_state:\n            instance.task_state = None\n            instance.save(expected_task_state=task_states.UPDATING_PASSWORD)\n            _msg = _('instance %s is not running') % instance.uuid\n            raise exception.InstancePasswordSetFailed(\n                instance=instance.uuid, reason=_msg)\n\n        try:\n            self.driver.set_admin_password(instance, new_pass)\n            LOG.info(_LI(\"Root password set\"), instance=instance)\n            instance.task_state = None\n            instance.save(\n                expected_task_state=task_states.UPDATING_PASSWORD)\n        except NotImplementedError:\n            LOG.warning(_LW('set_admin_password is not implemented '\n                            'by this driver or guest instance.'),\n                        instance=instance)\n            instance.task_state = None\n            instance.save(\n                expected_task_state=task_states.UPDATING_PASSWORD)\n            raise NotImplementedError(_('set_admin_password is not '\n                                        'implemented by this driver or guest '\n                                        'instance.'))\n        except exception.UnexpectedTaskStateError:\n            # interrupted by another (most likely delete) task\n            # do not retry\n            raise\n        except Exception:\n            # Catch all here because this could be anything.\n            LOG.exception(_LE('set_admin_password failed'),\n                          instance=instance)\n            self._set_instance_obj_error_state(context, instance)\n            # We create a new exception here so that we won't\n            # potentially reveal password information to the\n            # API caller.  The real exception is logged above\n            _msg = _('error setting admin password')\n            raise exception.InstancePasswordSetFailed(\n                instance=instance.uuid, reason=_msg)", 
            "date_created": "2015-06-05 08:05:05.520596+00:00", 
            "author": "https://api.launchpad.net/1.0/~javaloveme"
        }, 
        {
            "content": "There's work in progress for this, by Sahid:\n\nhttps://review.openstack.org/#/q/status:open+project:openstack/nova+branch:master+topic:bp/libvirt-set-admin-password,n,z\n\n\nlibvirt and QEMU already has support for it:\n\n    http://libvirt.org/git/?p=libvirt.git;a=commit;h=9bcadfa", 
            "date_created": "2015-06-08 09:21:50.462312+00:00", 
            "author": "https://api.launchpad.net/1.0/~kashyapc"
        }, 
        {
            "content": "@javeme (javaloveme):\n\nThanks for reporting this issue. There is a blueprint which intents \nto implement that [1]. To avoid redundant work on the same task I'll\nclose this issue. Feel free to offer the assignee of the blueprint your\nassistance. \n\n[1] https://blueprints.launchpad.net/nova/+spec/libvirt-set-admin-password", 
            "date_created": "2015-06-11 08:07:04.832177+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }
    ], 
    "closed": "2015-06-11 08:06:43.607524+00:00"
}