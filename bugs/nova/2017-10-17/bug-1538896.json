{
    "status": "Fix Released", 
    "last_updated": "2017-06-16 12:14:45.051650+00:00", 
    "description": "Reproducible on latest master.\n\nTried to show deleted flavor then it raises 500 error.\n\nSteps to reproduce:\n\n1. Create flavor\n$ nova flavor-create m2.test 10 1200 12 8\n\n2. Delete flavor\n$ nova flavor-delete 10\n\n3. Show deleted flavor\n$ nova flavor-show 10\n\nERROR (ClientException): Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible. <class 'webob.exc.HTTPNotFound'> (HTTP 500) (Request-ID: req-4f77f74c-2234-4beb-9875-157364bdd964)\n\nNova api logs:\n---------------------\n\n from (pid=31454) _http_log_response /usr/local/lib/python2.7/dist-packages/keystoneauth1/session.py:254\n2016-01-27 15:28:14.067 DEBUG nova.api.openstack.wsgi [req-15b4f90e-332b-4e96-b839-8cd931605e42 admin demo] Calling method '<bound method FlavorExtraSpecsController.index of <nova.api.openstack.compute.flavors_extraspecs.FlavorExtraSpecsController object at 0x7ff02f22cad0>>' from (pid=31454) _process_stack /opt/stack/nova/nova/api/openstack/wsgi.py:699\n2016-01-27 15:28:14.082 ERROR nova.api.openstack.extensions [req-15b4f90e-332b-4e96-b839-8cd931605e42 admin demo] Unexpected exception in API method\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions Traceback (most recent call last):\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/extensions.py\", line 478, in wrapped\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions     return f(*args, **kwargs)\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/compute/flavors_extraspecs.py\", line 60, in index\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions     return self._get_extra_specs(context, flavor_id)\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/compute/flavors_extraspecs.py\", line 39, in _get_extra_specs\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions     flavor = common.get_flavor(context, flavor_id)\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/common.py\", line 543, in get_flavor\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions     raise exc.HTTPNotFound(explanation=error.format_message())\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions HTTPNotFound: Flavor 122 could not be found.\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions\n2016-01-27 15:28:14.085 INFO nova.api.openstack.wsgi [req-15b4f90e-332b-4e96-b839-8cd931605e42 admin demo] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'webob.exc.HTTPNotFound'>\n2016-01-27 15:28:14.086 DEBUG nova.api.openstack.wsgi [req-15b4f90e-332b-4e96-b839-8cd931605e42 admin demo] Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'webob.exc.HTTPNotFound'> from (pid=31454) __call__ /opt/stack/nova/nova/api/openstack/wsgi.py:1070\n2016-01-27 15:28:14.097 INFO nova.osapi_compute.wsgi.server [req-15b4f90e-332b-4e96-b839-8cd931605e42 admin demo] 10.69.4.177 \"GET /v2.1/982e2fc081364cf889d959b27d4bd510/flavors/122/os-extra_specs HTTP/1.1\" status: 500 len: 499 time: 0.1559708", 
    "tags": [
        "api"
    ], 
    "importance": "High", 
    "heat": 14, 
    "link": "https://bugs.launchpad.net/nova/+bug/1538896", 
    "owner": "https://api.launchpad.net/1.0/~bhagyashri-shewale", 
    "id": 1538896, 
    "index": 1872, 
    "openned": "2016-01-28 05:40:57.827119+00:00", 
    "created": "2016-01-28 05:40:57.827119+00:00", 
    "title": "nova flavor-show <id> raises 500 error if flavor is deleted", 
    "comments": [
        {
            "content": "Reproducible on latest master.\n\nTried to show deleted flavor then it raises 500 error.\n\nSteps to reproduce:\n\n1. Create flavor\n$ nova flavor-create m2.test 10 1200 12 8\n\n2. Delete flavor\n$ nova flavor-delete 10\n\n3. Show deleted flavor\n$ nova flavor-show 10\n\nERROR (ClientException): Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible. <class 'webob.exc.HTTPNotFound'> (HTTP 500) (Request-ID: req-4f77f74c-2234-4beb-9875-157364bdd964)\n\nNova api logs:\n---------------------\n\n from (pid=31454) _http_log_response /usr/local/lib/python2.7/dist-packages/keystoneauth1/session.py:254\n2016-01-27 15:28:14.067 DEBUG nova.api.openstack.wsgi [req-15b4f90e-332b-4e96-b839-8cd931605e42 admin demo] Calling method '<bound method FlavorExtraSpecsController.index of <nova.api.openstack.compute.flavors_extraspecs.FlavorExtraSpecsController object at 0x7ff02f22cad0>>' from (pid=31454) _process_stack /opt/stack/nova/nova/api/openstack/wsgi.py:699\n2016-01-27 15:28:14.082 ERROR nova.api.openstack.extensions [req-15b4f90e-332b-4e96-b839-8cd931605e42 admin demo] Unexpected exception in API method\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions Traceback (most recent call last):\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/extensions.py\", line 478, in wrapped\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions     return f(*args, **kwargs)\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/compute/flavors_extraspecs.py\", line 60, in index\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions     return self._get_extra_specs(context, flavor_id)\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/compute/flavors_extraspecs.py\", line 39, in _get_extra_specs\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions     flavor = common.get_flavor(context, flavor_id)\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/common.py\", line 543, in get_flavor\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions     raise exc.HTTPNotFound(explanation=error.format_message())\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions HTTPNotFound: Flavor 122 could not be found.\n2016-01-27 15:28:14.082 TRACE nova.api.openstack.extensions\n2016-01-27 15:28:14.085 INFO nova.api.openstack.wsgi [req-15b4f90e-332b-4e96-b839-8cd931605e42 admin demo] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'webob.exc.HTTPNotFound'>\n2016-01-27 15:28:14.086 DEBUG nova.api.openstack.wsgi [req-15b4f90e-332b-4e96-b839-8cd931605e42 admin demo] Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'webob.exc.HTTPNotFound'> from (pid=31454) __call__ /opt/stack/nova/nova/api/openstack/wsgi.py:1070\n2016-01-27 15:28:14.097 INFO nova.osapi_compute.wsgi.server [req-15b4f90e-332b-4e96-b839-8cd931605e42 admin demo] 10.69.4.177 \"GET /v2.1/982e2fc081364cf889d959b27d4bd510/flavors/122/os-extra_specs HTTP/1.1\" status: 500 len: 499 time: 0.1559708", 
            "date_created": "2016-01-28 05:40:57.827119+00:00", 
            "author": "https://api.launchpad.net/1.0/~abhishek-kekane"
        }, 
        {
            "content": "I was able to reproduce this, stack trace pasted below from nova logs:\n\n2016-02-04 23:49:50.052 DEBUG nova.api.openstack.wsgi [req-314f0442-98f4-4cd6-8cc1-3b75fb09ed3f admin admin] Calling method '<bound method FlavorExtraSpecsController.index of <nova.api.openstack.compute.flavors_extraspecs.FlavorExtraSpecsController object at 0x7ff5c513d690>>' from (pid=27806) _process_stack /opt/stack/nova/nova/api/openstack/wsgi.py:699\n2016-02-04 23:49:50.064 ERROR nova.api.openstack.extensions [req-314f0442-98f4-4cd6-8cc1-3b75fb09ed3f admin admin] Unexpected exception in API method\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions Traceback (most recent call last):\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/extensions.py\", line 478, in wrapped\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions     return f(*args, **kwargs)\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/compute/flavors_extraspecs.py\", line 60, in index\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions     return self._get_extra_specs(context, flavor_id)\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/compute/flavors_extraspecs.py\", line 39, in _get_extra_specs\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions     flavor = common.get_flavor(context, flavor_id)\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions   File \"/opt/stack/nova/nova/api/openstack/common.py\", line 543, in get_flavor\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions     raise exc.HTTPNotFound(explanation=error.format_message())\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions HTTPNotFound: Flavor 10 could not be found.\n2016-02-04 23:49:50.064 TRACE nova.api.openstack.extensions \n2016-02-04 23:49:50.065 INFO nova.api.openstack.wsgi [req-314f0442-98f4-4cd6-8cc1-3b75fb09ed3f admin admin] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'webob.exc.HTTPNotFound'>\n2016-02-04 23:49:50.065 DEBUG nova.api.openstack.wsgi [req-314f0442-98f4-4cd6-8cc1-3b75fb09ed3f admin admin] Returning 500 to user: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'webob.exc.HTTPNotFound'> from (pid=27806) __call__ /opt/stack/nova/nova/api/openstack/wsgi.py:1070\n2016-02-04 23:49:50.066 INFO nova.osapi_compute.wsgi.server [req-314f0442-98f4-4cd6-8cc1-3b75fb09ed3f admin admin] 10.42.0.53 \"GET /v2.1/9f087ae0a9784a1a925d8cc428d0b151/flavors/10/os-extra_specs HTTP/1.1\" status: 500 len: 499 time: 0.1468120\n", 
            "date_created": "2016-02-05 04:52:17.303529+00:00", 
            "author": "https://api.launchpad.net/1.0/~auggy"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/279413", 
            "date_created": "2016-02-12 08:03:49.110626+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/279413\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=4184f985011ddcca08ae695bb9793794037a0b04\nSubmitter: Jenkins\nBranch:    master\n\ncommit 4184f985011ddcca08ae695bb9793794037a0b04\nAuthor: bhagyashris <email address hidden>\nDate:   Thu Feb 4 01:21:49 2016 -0800\n\n    Fix 500 error for showing deleted flavor details\n    \n    Displaying deleted flavor details throws 500 internal server error.\n    Added 404 HttpNotFound status code in \"@extension.expected_errors\".\n    \n    APIImpact: Return 404 status code for list extra specs\n    for a deleted flavor.\n    \n    Closes-Bug: #1538896\n    \n    Change-Id: Iba33296c28c3c3d6ba60052fe434107ac9c00c61\n", 
            "date_created": "2016-02-15 11:41:21.475177+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 13.0.0.0b3 development milestone.", 
            "date_created": "2016-03-03 16:19:56.371961+00:00", 
            "author": "https://api.launchpad.net/1.0/~doug-hellmann"
        }, 
        {
            "content": "Fix proposed to branch: stable/liberty\nReview: https://review.openstack.org/343109", 
            "date_created": "2016-07-15 22:57:44.286131+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Why can we get the deleted flavor, but fail to get its extra-specs?", 
            "date_created": "2016-07-20 08:18:52.626194+00:00", 
            "author": "https://api.launchpad.net/1.0/~fuguangping"
        }, 
        {
            "content": "Change abandoned by Matt Riedemann (<email address hidden>) on branch: stable/liberty\nReview: https://review.openstack.org/343109\nReason: Sorry, gonna have to carry this out of tree for liberty, we're locking down for liberty-eol.", 
            "date_created": "2016-11-11 22:11:28.416899+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2016-02-15 11:41:17.714881+00:00"
}