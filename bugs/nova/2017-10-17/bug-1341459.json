{
    "status": "Fix Released", 
    "last_updated": "2014-10-16 08:53:15.185477+00:00", 
    "description": "libvirt support swap volume. But if the new volume is larger than the old one, the block device isn't resized. The instance can't see the extra space.\n\n\n\n$ nova show vm3\n+--------------------------------------+----------------------------------------------------------------+\n| Property                             | Value                                                          |\n+--------------------------------------+----------------------------------------------------------------+\n| OS-DCF:diskConfig                    | AUTO                                                           |\n| OS-EXT-AZ:availability_zone          | nova                                                           |\n| OS-EXT-SRV-ATTR:host                 | os3                                                            |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | os3                                                            |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000039                                              |\n| OS-EXT-STS:power_state               | 1                                                              |\n| OS-EXT-STS:task_state                | -                                                              |\n| OS-EXT-STS:vm_state                  | active                                                         |\n| OS-SRV-USG:launched_at               | 2014-07-14T01:43:31.000000                                     |\n| OS-SRV-USG:terminated_at             | -                                                              |\n| accessIPv4                           |                                                                |\n| accessIPv6                           |                                                                |\n| config_drive                         |                                                                |\n| created                              | 2014-07-14T01:43:23Z                                           |\n| flavor                               | m1.nano (42)                                                   |\n| hostId                               | c8e8cab21e9e22dbc3779fd171e77f44940ba1c81161dc114ba4ad85       |\n| id                                   | ccda09b7-6c50-40b0-ba7c-0c5c3f0cbb7e                           |\n| image                                | cirros-0.3.2-x86_64-uec (da82a342-aeac-407a-bf9d-cf28bf68dc6b) |\n| key_name                             | -                                                              |\n| metadata                             | {}                                                             |\n| name                                 | vm3                                                            |\n| net1 network                         | 10.0.0.66                                                      |\n| os-extended-volumes:volumes_attached | [{\"id\": \"756d0869-2ef2-4537-90c8-66df9657135f\"}]               |\n| progress                             | 0                                                              |\n| security_groups                      | sg1, default                                                   |\n| status                               | ACTIVE                                                         |\n| tenant_id                            | fdbb1e8f23eb40c89f3a677e2621b95c                               |\n| updated                              | 2014-07-14T06:34:57Z                                           |\n| user_id                              | 158d3c971e244f479593c86ff751bf8f                               |\n+--------------------------------------+----------------------------------------------------------------+\n\n\n$ cinder  list\n+--------------------------------------+-----------+------+------+-------------+----------+--------------------------------------+\n|                  ID                  |   Status  | Name | Size | Volume Type | Bootable |             Attached to              |\n+--------------------------------------+-----------+------+------+-------------+----------+--------------------------------------+\n| 13097504-5b0c-4581-b1a5-9e05f616b89d | available | vol3 |  2   |     None    |  false   |                                      |\n| 756d0869-2ef2-4537-90c8-66df9657135f |   in-use  | vol1 |  1   |     None    |  false   | ccda09b7-6c50-40b0-ba7c-0c5c3f0cbb7e |\n| f0da7609-486d-49b1-bdf3-029bcbe56268 | available | vol2 |  1   |     None    |  false   |                                      |\n+--------------------------------------+-----------+------+------+-------------+----------+--------------------------------------+\n\n\n\nThen login guest OS:\n\n$ sudo fdisk -l\n\n.....\n\nDisk /dev/vdc: 1073 MB, 1073741824 bytes\n9 heads, 8 sectors/track, 29127 cylinders, total 2097152 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk identifier: 0xd6091017\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/vdc1            2048     2097151     1047552   83  Linux\n\n\n\nSwap the volume to larger one.\n$ nova volume-update vm3 756d0869-2ef2-4537-90c8-66df9657135f 13097504-5b0c-4581-b1a5-9e05f616b89d\n\n\nvm3 attached with the vol3\n$ cinder list\n+--------------------------------------+-----------+------+------+-------------+----------+--------------------------------------+\n|                  ID                  |   Status  | Name | Size | Volume Type | Bootable |             Attached to              |\n+--------------------------------------+-----------+------+------+-------------+----------+--------------------------------------+\n| 13097504-5b0c-4581-b1a5-9e05f616b89d |   in-use  | vol3 |  2   |     None    |  false   | ccda09b7-6c50-40b0-ba7c-0c5c3f0cbb7e |\n| 756d0869-2ef2-4537-90c8-66df9657135f | available | vol1 |  1   |     None    |  false   |                                      |\n| f0da7609-486d-49b1-bdf3-029bcbe56268 | available | vol2 |  1   |     None    |  false   |                                      |\n+--------------------------------------+-----------+------+------+-------------+----------+--------------------------------------+\n\n\n\nCheck the guest again:\n\n$ sudo fdisk -l\n\n....\n\nDisk /dev/vdc: 1073 MB, 1073741824 bytes\n9 heads, 8 sectors/track, 29127 cylinders, total 2097152 sectors\nUnits = sectors of 1 * 512 = 512 bytes\nSector size (logical/physical): 512 bytes / 512 bytes\nI/O size (minimum/optimal): 512 bytes / 512 bytes\nDisk identifier: 0xd6091017\n\n   Device Boot      Start         End      Blocks   Id  System\n/dev/vdc1            2048     2097151     1047552   83  Linux\n\n\nThe device size isn't changed.", 
    "tags": [
        "libvirt"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1341459", 
    "owner": "https://api.launchpad.net/1.0/~xuhj", 
    "id": 1341459, 
    "index": 6264, 
    "openned": "2014-07-14 07:18:25.014280+00:00", 
    "created": "2014-07-14 07:18:25.014280+00:00", 
    "title": "block device isn't resized after swap to larger volume", 
    "comments": [
        {
            "content": "libvirt support swap volume. But if the new volume is larger than the old one, the block device isn't resized. The instance can't see the extra space.", 
            "date_created": "2014-07-14 07:18:25.014280+00:00", 
            "author": "https://api.launchpad.net/1.0/~xuhj"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/106698", 
            "date_created": "2014-07-14 07:23:31.106935+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/106698\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=916aec717c2c1a6096e2f1884e4ad81a30ae70e6\nSubmitter: Jenkins\nBranch:    master\n\ncommit 916aec717c2c1a6096e2f1884e4ad81a30ae70e6\nAuthor: He Jie Xu <email address hidden>\nDate:   Mon Jul 14 15:18:46 2014 +0800\n\n    Resize block device after swap to larger volume\n    \n    After swap to larger volume, instance's block device should be\n    resized. Otherwise, the guest can't utilize the extra space.\n    \n    This patch make the libvirt driver resize block device after mirror\n    the volume. And add new parameter 'resize_to' to virt driver, that\n    is used to indicate the new size.\n    \n    Change-Id: Ib4d65e8812c7d3c28100155124218c75a94e16e7\n    Closes-Bug: #1341459\n", 
            "date_created": "2014-08-14 13:28:24.981269+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2014-09-05 09:54:24.893402+00:00"
}