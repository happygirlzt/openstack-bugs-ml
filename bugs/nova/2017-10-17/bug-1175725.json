{
    "status": "Fix Released", 
    "last_updated": "2014-03-21 11:29:09.666072+00:00", 
    "description": "Here is the stack trace:\n\n2013-05-02 10:58:26.246 ERROR nova.virt.hyperv.vmops [req-99f87ed2-98fe-4b75-a5b4-87c3d95b49de 6e15c99a64f34d9eb420e8dc751317e8 0384a4eb1bc54bf9b70f49c145015ad7] 'ip6s'\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops Traceback (most recent call last):\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\virt\\hyperv\\vmops.py\", line 179, in spawn\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops     admin_password)\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\virt\\hyperv\\vmops.py\", line 231, in _create_config_drive\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops     extra_md=extra_md)\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\api\\metadata\\base.py\", line 146, in __init__\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops     cfg = netutils.get_injected_network_template(network_info)\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\virt\\netutils.py\", line 94, in get_injected_network_template\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops     address_v6 = mapping['ip6s'][0]['ip']\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops KeyError: 'ip6s'\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops\n2013-05-02 10:58:39.397 ERROR nova.compute.manager [req-99f87ed2-98fe-4b75-a5b4-87c3d95b49de 6e15c99a64f34d9eb420e8dc751317e8 0384a4eb1bc54bf9b70f49c145015ad7] [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81] Instance failed to spawn\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81] Traceback (most recent call last):\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\compute\\manager.py\", line 1109, in _spawn\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]     block_device_info)\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\virt\\hyperv\\driver.py\", line 57, in spawn\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]     admin_password, network_info, block_device_info)\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\virt\\hyperv\\vmops.py\", line 187, in spawn\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]     raise vmutils.HyperVException(_('Spawn instance failed'))\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81] HyperVException: Spawn instance failed\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]\n2013-05-02 10:58:46.740 ERROR nova.compute.manager [req-99f87ed2-98fe-4b75-a5b4-87c3d95b49de 6e15c99a64f34d9eb420e8dc751317e8 0384a4eb1bc54bf9b70f49c145015ad7] [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81] Error: ['Traceback (most recent call last):\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\site-packages\\\\nova\\\\compute\\\\manager.py\", line 846, in _run_instance\\n    set_access_ip=set_access_ip)\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\site-packages\\\\nova\\\\compute\\\\manager.py\", line 1113, in _spawn\\n    LOG.exception(_(\\'Instance failed to spawn\\'), instance=instance)\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\contextlib.py\", line 24, in __exit__\\n    self.gen.next()\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\site-packages\\\\nova\\\\compute\\\\manager.py\", line 1109, in _spawn\\n    block_device_info)\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\site-packages\\\\nova\\\\virt\\\\hyperv\\\\driver.py\", line 57, in spawn\\n    admin_password, network_info, block_device_info)\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\site-packages\\\\nova\\\\virt\\\\hyperv\\\\vmops.py\", line 187, in spawn\\n    raise vmutils.HyperVException(_(\\'Spawn instance failed\\'))\\n', 'HyperVException: Spawn instance failed\\n']", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1175725", 
    "owner": "https://api.launchpad.net/1.0/~dperaza", 
    "id": 1175725, 
    "index": 4890, 
    "openned": "2013-05-02 18:47:05.833286+00:00", 
    "created": "2013-05-02 18:47:05.833286+00:00", 
    "title": "Spawn instance failed  when use_ipv6=true in nova.conf and network does not contain IPv6 ", 
    "comments": [
        {
            "content": "Here is the stack trace:\n\n2013-05-02 10:58:26.246 ERROR nova.virt.hyperv.vmops [req-99f87ed2-98fe-4b75-a5b4-87c3d95b49de 6e15c99a64f34d9eb420e8dc751317e8 0384a4eb1bc54bf9b70f49c145015ad7] 'ip6s'\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops Traceback (most recent call last):\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\virt\\hyperv\\vmops.py\", line 179, in spawn\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops     admin_password)\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\virt\\hyperv\\vmops.py\", line 231, in _create_config_drive\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops     extra_md=extra_md)\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\api\\metadata\\base.py\", line 146, in __init__\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops     cfg = netutils.get_injected_network_template(network_info)\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\virt\\netutils.py\", line 94, in get_injected_network_template\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops     address_v6 = mapping['ip6s'][0]['ip']\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops KeyError: 'ip6s'\n2013-05-02 10:58:26.246 3768 TRACE nova.virt.hyperv.vmops\n2013-05-02 10:58:39.397 ERROR nova.compute.manager [req-99f87ed2-98fe-4b75-a5b4-87c3d95b49de 6e15c99a64f34d9eb420e8dc751317e8 0384a4eb1bc54bf9b70f49c145015ad7] [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81] Instance failed to spawn\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81] Traceback (most recent call last):\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\compute\\manager.py\", line 1109, in _spawn\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]     block_device_info)\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\virt\\hyperv\\driver.py\", line 57, in spawn\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]     admin_password, network_info, block_device_info)\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]   File \"C:\\Program Files (x86)\\Python27\\lib\\site-packages\\nova\\virt\\hyperv\\vmops.py\", line 187, in spawn\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]     raise vmutils.HyperVException(_('Spawn instance failed'))\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81] HyperVException: Spawn instance failed\n2013-05-02 10:58:39.397 3768 TRACE nova.compute.manager [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81]\n2013-05-02 10:58:46.740 ERROR nova.compute.manager [req-99f87ed2-98fe-4b75-a5b4-87c3d95b49de 6e15c99a64f34d9eb420e8dc751317e8 0384a4eb1bc54bf9b70f49c145015ad7] [instance: 7b0ac2da-2d0e-484b-b5a3-09a150b71a81] Error: ['Traceback (most recent call last):\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\site-packages\\\\nova\\\\compute\\\\manager.py\", line 846, in _run_instance\\n    set_access_ip=set_access_ip)\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\site-packages\\\\nova\\\\compute\\\\manager.py\", line 1113, in _spawn\\n    LOG.exception(_(\\'Instance failed to spawn\\'), instance=instance)\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\contextlib.py\", line 24, in __exit__\\n    self.gen.next()\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\site-packages\\\\nova\\\\compute\\\\manager.py\", line 1109, in _spawn\\n    block_device_info)\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\site-packages\\\\nova\\\\virt\\\\hyperv\\\\driver.py\", line 57, in spawn\\n    admin_password, network_info, block_device_info)\\n', '  File \"C:\\\\Program Files (x86)\\\\Python27\\\\lib\\\\site-packages\\\\nova\\\\virt\\\\hyperv\\\\vmops.py\", line 187, in spawn\\n    raise vmutils.HyperVException(_(\\'Spawn instance failed\\'))\\n', 'HyperVException: Spawn instance failed\\n']", 
            "date_created": "2013-05-02 18:47:05.833286+00:00", 
            "author": "https://api.launchpad.net/1.0/~dperaza"
        }, 
        {
            "content": "Usecase:\n\nCloud configured with IPV6 support in mind, so the use_ipv6 flag is set on all nova.conf. Quantum admin configures with only IPV4 first. All spawns will fail on this code. \n\nDo we need to be more proactive here checking that network info does contain ipv6 to set?", 
            "date_created": "2013-05-02 18:52:42.003443+00:00", 
            "author": "https://api.launchpad.net/1.0/~dperaza"
        }, 
        {
            "content": "Added to wrong project switching to nova", 
            "date_created": "2013-05-02 19:06:54.979887+00:00", 
            "author": "https://api.launchpad.net/1.0/~dperaza"
        }, 
        {
            "content": "propose this change: https://review.openstack.org/#/c/28073\n\nNot sure why it does not show here, probably because I created in keystone first by mistake and then switched here", 
            "date_created": "2013-05-02 19:12:23.185505+00:00", 
            "author": "https://api.launchpad.net/1.0/~dperaza"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/28073\nCommitted: http://github.com/openstack/nova/commit/005b9950ac84bf3ae06c24ee018f192064060428\nSubmitter: Jenkins\nBranch:    master\n\ncommit 005b9950ac84bf3ae06c24ee018f192064060428\nAuthor: David Peraza <email address hidden>\nDate:   Thu May 2 18:59:30 2013 +0000\n\n    Being more defensive around the use_ipv6 config option\n    \n    fixes bug 1175725\n    \n    Will allow for the flag to be set to filter out ipv6 if\n    configured but will not add ipv6 to template if ipv6 is not\n    configured in quantum. This will allow spwan to continue\n    working in the case where ipv6 is not configured but flag\n    use_ipv6 is set in nova.\n    \n    Change-Id: I26ebdff81efcdeff827521cec247d2c443a5e0ad\n", 
            "date_created": "2013-05-04 04:20:19.124639+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "grizzly-backport-potential", 
            "date_created": "2013-05-06 14:04:17.555794+00:00", 
            "author": "https://api.launchpad.net/1.0/~dperaza"
        }, 
        {
            "content": "Fix proposed to branch: stable/grizzly\nReview: https://review.openstack.org/28302", 
            "date_created": "2013-05-06 14:12:51.843302+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-05-29 10:22:11.533252+00:00"
}