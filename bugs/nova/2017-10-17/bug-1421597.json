{
    "status": "Invalid", 
    "last_updated": "2015-02-17 08:46:01.238366+00:00", 
    "description": "I started to install Openstack Juno yesterday,  I'm on Ubuntu 14.04.1 \nKeystone and Glance services are working,  now I have an error with the 'nova-api' service. \n\nWhen I launch the service manually by 'nova-api' command, all is working. \nBut when I launch 'service nova-api start' , after some seconds, the service stopped with the following log error :  \n\n\nTRACE nova Traceback (most recent call last):\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/bin/nova-api\", line 10, in <module>\n2015-02-13 10:54:12.188 3658 TRACE nova     sys.exit(main())\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/cmd/api.py\", line 55, in main\n2015-02-13 10:54:12.188 3658 TRACE nova     server = service.WSGIService(api, use_ssl=should_use_ssl)\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 331, in __init__\n2015-02-13 10:54:12.188 3658 TRACE nova     self.manager = self._get_manager()\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 383, in _get_manager\n2015-02-13 10:54:12.188 3658 TRACE nova     return manager_class()\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/api/manager.py\", line 30, in __init__\n2015-02-13 10:54:12.188 3658 TRACE nova     self.network_driver.metadata_accept()\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/network/linux_net.py\", line 666, in metada    ta_accept\n2015-02-13 10:54:12.188 3658 TRACE nova     iptables_manager.apply()\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/network/linux_net.py\", line 434, in apply\n2015-02-13 10:54:12.188 3658 TRACE nova     self._apply()\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/lockutils.py\", line 272,     in inner\n2015-02-13 10:54:12.188 3658 TRACE nova     return f(*args, **kwargs)\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/network/linux_net.py\", line 454, in _apply\n2015-02-13 10:54:12.188 3658 TRACE nova     attempts=5)\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/network/linux_net.py\", line 1228, in _exec    ute\n2015-02-13 10:54:12.188 3658 TRACE nova     return utils.execute(*cmd, **kwargs)\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/utils.py\", line 163, in execute\n2015-02-13 10:54:12.188 3658 TRACE nova     return processutils.execute(*cmd, **kwargs)\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/processutils.py\", line 20    3, in execute\n2015-02-13 10:54:12.188 3658 TRACE nova     cmd=sanitized_cmd)\n2015-02-13 10:54:12.188 3658 TRACE nova ProcessExecutionError: Unexpected error while running command.\n2015-02-13 10:54:12.188 3658 TRACE nova Command: sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c\n2015-02-13 10:54:12.188 3658 TRACE nova Exit code: 1\n2015-02-13 10:54:12.188 3658 TRACE nova Stdout: u''\n2015-02-13 10:54:12.188 3658 TRACE nova Stderr: u'sudo: no tty present and no askpass program specified\n\n\nI tried to add some arguments in '/etc/nova/nova.conf' \n(like 'root_helper = sudo nova-rootwrap /etc/nova/rootwrap.conf'),  I checked the '/etc/sudoers.d/nova_sudoers',  but each time I get this error. \n\nIf I start the service manually just by 'nova-api' command, I'm able to retrieve the image list, for example.  \nJust the service should be misconfigured, but I don't know why, I followed the documentation (12-02-2015).", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1421597", 
    "owner": "None", 
    "id": 1421597, 
    "index": 6705, 
    "openned": "2015-02-13 10:11:38.091102+00:00", 
    "created": "2015-02-13 10:11:38.091102+00:00", 
    "title": "nova-api stopped 'sudo: no tty present and no askpass program specified'", 
    "comments": [
        {
            "content": "I started to install Openstack Juno yesterday,  I'm on Ubuntu 14.04.1 \nKeystone and Glance services are working,  now I have an error with the 'nova-api' service. \n\nWhen I launch the service manually by 'nova-api' command, all is working. \nBut when I launch 'service nova-api start' , after some seconds, the service stopped with the following log error :  \n\n\nTRACE nova Traceback (most recent call last):\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/bin/nova-api\", line 10, in <module>\n2015-02-13 10:54:12.188 3658 TRACE nova     sys.exit(main())\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/cmd/api.py\", line 55, in main\n2015-02-13 10:54:12.188 3658 TRACE nova     server = service.WSGIService(api, use_ssl=should_use_ssl)\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 331, in __init__\n2015-02-13 10:54:12.188 3658 TRACE nova     self.manager = self._get_manager()\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/service.py\", line 383, in _get_manager\n2015-02-13 10:54:12.188 3658 TRACE nova     return manager_class()\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/api/manager.py\", line 30, in __init__\n2015-02-13 10:54:12.188 3658 TRACE nova     self.network_driver.metadata_accept()\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/network/linux_net.py\", line 666, in metada    ta_accept\n2015-02-13 10:54:12.188 3658 TRACE nova     iptables_manager.apply()\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/network/linux_net.py\", line 434, in apply\n2015-02-13 10:54:12.188 3658 TRACE nova     self._apply()\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/lockutils.py\", line 272,     in inner\n2015-02-13 10:54:12.188 3658 TRACE nova     return f(*args, **kwargs)\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/network/linux_net.py\", line 454, in _apply\n2015-02-13 10:54:12.188 3658 TRACE nova     attempts=5)\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/network/linux_net.py\", line 1228, in _exec    ute\n2015-02-13 10:54:12.188 3658 TRACE nova     return utils.execute(*cmd, **kwargs)\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/utils.py\", line 163, in execute\n2015-02-13 10:54:12.188 3658 TRACE nova     return processutils.execute(*cmd, **kwargs)\n2015-02-13 10:54:12.188 3658 TRACE nova   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/processutils.py\", line 20    3, in execute\n2015-02-13 10:54:12.188 3658 TRACE nova     cmd=sanitized_cmd)\n2015-02-13 10:54:12.188 3658 TRACE nova ProcessExecutionError: Unexpected error while running command.\n2015-02-13 10:54:12.188 3658 TRACE nova Command: sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c\n2015-02-13 10:54:12.188 3658 TRACE nova Exit code: 1\n2015-02-13 10:54:12.188 3658 TRACE nova Stdout: u''\n2015-02-13 10:54:12.188 3658 TRACE nova Stderr: u'sudo: no tty present and no askpass program specified\n\n\nI tried to add some arguments in '/etc/nova/nova.conf' \n(like 'root_helper = sudo nova-rootwrap /etc/nova/rootwrap.conf'),  I checked the '/etc/sudoers.d/nova_sudoers',  but each time I get this error. \n\nIf I start the service manually just by 'nova-api' command, I'm able to retrieve the image list, for example.  \nJust the service should be misconfigured, but I don't know why, I followed the documentation (12-02-2015).", 
            "date_created": "2015-02-13 10:11:38.091102+00:00", 
            "author": "https://api.launchpad.net/1.0/~jeanbapt37"
        }, 
        {
            "content": "What user does the service run under? can you login as that user and run \n\n\"sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c\"?", 
            "date_created": "2015-02-13 11:19:23.190343+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "With my Ubuntu user  (which is in sudoers), the command \"sudo nova-rootwrap /etc/nova/rootwrap.conf iptables-save -c\" returns the correct ouput, without error.   (Return code is 0). \n\nI think the service run under the Nova user, and I can't login with this account...   (because it's a service account). ", 
            "date_created": "2015-02-13 13:09:28.287031+00:00", 
            "author": "https://api.launchpad.net/1.0/~jeanbapt37"
        }, 
        {
            "content": "I installed a new fresh install of Ubuntu 14.04, and I compare with my real platform. \r\n\r\nIn fact, it was olders entries of /etc/sudoers.d/nova-rootwrap  (maybe installed by an old Devstack setup). \r\nI've correct the file and it works fine ! \r\n\r\nFor information, the good line in /etc/sudoers.d/nova-rootwrap : \r\nnova ALL=(root) NOPASSWD: /usr/local/bin/nova-rootwrap /etc/nova/rootwrap.conf *", 
            "date_created": "2015-02-17 08:45:56.275096+00:00", 
            "author": "https://api.launchpad.net/1.0/~jeanbapt37"
        }
    ], 
    "closed": "2015-02-17 08:45:57.879105+00:00"
}