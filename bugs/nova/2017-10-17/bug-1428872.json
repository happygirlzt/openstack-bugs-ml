{
    "status": "Confirmed", 
    "last_updated": "2016-07-12 21:23:30.011664+00:00", 
    "description": "we are using Mirantis 6.0 \nwe are trying to find a physical CPU information  from Nova compute host . e are using nova hypervisor-show command.\n\nwhen i tried running the nova hypervisor-show <compute_node> \n\nits show me correct info cpu_arch , cpu_info_features and cores ... but its show its only one sockets where as we are using 2 CPU .( see details from compute node below)\n\n\n \n\n\nwe are trying to find physical CPU details from Nova-compute host blade , \n\nHere is what nova shows \n\nroot@node-9:~# nova hypervisor-show node-12\n+---------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Property                  | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n+---------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| cpu_info_arch             | x86_64                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |\n| cpu_info_features         | [\"ssse3\", \"pge\", \"avx\", \"clflush\", \"sep\", \"syscall\", \"vme\", \"dtes64\", \"invpcid\", \"msr\", \"sse\", \"xsave\", \"vmx\", \"erms\", \"xtpr\", \"cmov\", \"tsc\", \"smep\", \"pbe\", \"est\", \"pat\", \"monitor\", \"smx\", \"lm\", \"abm\", \"nx\", \"fxsr\", \"tm\", \"sse4.1\", \"pae\", \"sse4.2\", \"pclmuldq\", \"acpi\", \"fma\", \"tsc-deadline\", \"popcnt\", \"mmx\", \"osxsave\", \"cx8\", \"mce\", \"mtrr\", \"rdtscp\", \"ht\", \"dca\", \"lahf_lm\", \"pdcm\", \"mca\", \"pdpe1gb\", \"apic\", \"fsgsbase\", \"f16c\", \"pse\", \"ds\", \"pni\", \"tm2\", \"avx2\", \"aes\", \"sse2\", \"ss\", \"bmi1\", \"bmi2\", \"pcid\", \"de\", \"fpu\", \"cx16\", \"pse36\", \"ds_cpl\", \"movbe\", \"rdrand\", \"x2apic\"] |\n| cpu_info_model            | SandyBridge                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n| cpu_info_topology_cores   | 12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |\n| cpu_info_topology_sockets | 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| cpu_info_topology_threads 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| cpu_info_vendor           | Intel          \n`\n\nIn reality it is 2 CPU as below , here is output from nova-compute host\n\n\nroot@node-16:~# lscpu\nArchitecture:          x86_64\nCPU op-mode(s):        32-bit, 64-bit\nByte Order:            Little Endian\nCPU(s):                48\nOn-line CPU(s) list:   0-47\nThread(s) per core:    2\nCore(s) per socket:    12\nSocket(s):             2\nNUMA node(s):          2\nVendor ID:             GenuineIntel\nCPU family:            6\nModel:                 63\nStepping:              2\nCPU MHz:               2500.093\nBogoMIPS:              5001.17\nVirtualization:        VT-x\nL1d cache:             32K\nL1i cache:             32K\nL2 cache:              256K\nL3 cache:              30720K\nNUMA node0 CPU(s):     0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46\nNUMA node1 CPU(s):     1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47", 
    "tags": [], 
    "importance": "Low", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1428872", 
    "owner": "None", 
    "id": 1428872, 
    "index": 1585, 
    "openned": "2015-03-05 22:10:37.131785+00:00", 
    "created": "2015-03-05 22:10:04.847390+00:00", 
    "title": "Nova CPU details  socket not correct", 
    "comments": [
        {
            "content": "we are using Mirantis 6.0 \nwe are trying to find a physical CPU information  from Nova compute host . e are using nova hypervisor-show command.\n\nwhen i tried running the nova hypervisor-show <compute_node> \n\nits show me correct info cpu_arch , cpu_info_features and cores ... but its show its only one sockets where as we are using 2 CPU .( see details from compute node below)\n\n\n \n\n\nwe are trying to find physical CPU details from Nova-compute host blade , \n\nHere is what nova shows \n\nroot@node-9:~# nova hypervisor-show node-12\n+---------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Property                  | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n+---------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| cpu_info_arch             | x86_64                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |\n| cpu_info_features         | [\"ssse3\", \"pge\", \"avx\", \"clflush\", \"sep\", \"syscall\", \"vme\", \"dtes64\", \"invpcid\", \"msr\", \"sse\", \"xsave\", \"vmx\", \"erms\", \"xtpr\", \"cmov\", \"tsc\", \"smep\", \"pbe\", \"est\", \"pat\", \"monitor\", \"smx\", \"lm\", \"abm\", \"nx\", \"fxsr\", \"tm\", \"sse4.1\", \"pae\", \"sse4.2\", \"pclmuldq\", \"acpi\", \"fma\", \"tsc-deadline\", \"popcnt\", \"mmx\", \"osxsave\", \"cx8\", \"mce\", \"mtrr\", \"rdtscp\", \"ht\", \"dca\", \"lahf_lm\", \"pdcm\", \"mca\", \"pdpe1gb\", \"apic\", \"fsgsbase\", \"f16c\", \"pse\", \"ds\", \"pni\", \"tm2\", \"avx2\", \"aes\", \"sse2\", \"ss\", \"bmi1\", \"bmi2\", \"pcid\", \"de\", \"fpu\", \"cx16\", \"pse36\", \"ds_cpl\", \"movbe\", \"rdrand\", \"x2apic\"] |\n| cpu_info_model            | SandyBridge                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n| cpu_info_topology_cores   | 12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |\n| cpu_info_topology_sockets | 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| cpu_info_topology_threads 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\n| cpu_info_vendor           | Intel          \n`\n\nIn reality it is 2 CPU as below , here is output from nova-compute host\n\n\nroot@node-16:~# lscpu\nArchitecture:          x86_64\nCPU op-mode(s):        32-bit, 64-bit\nByte Order:            Little Endian\nCPU(s):                48\nOn-line CPU(s) list:   0-47\nThread(s) per core:    2\nCore(s) per socket:    12\nSocket(s):             2\nNUMA node(s):          2\nVendor ID:             GenuineIntel\nCPU family:            6\nModel:                 63\nStepping:              2\nCPU MHz:               2500.093\nBogoMIPS:              5001.17\nVirtualization:        VT-x\nL1d cache:             32K\nL1i cache:             32K\nL2 cache:              256K\nL3 cache:              30720K\nNUMA node0 CPU(s):     0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46\nNUMA node1 CPU(s):     1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47", 
            "date_created": "2015-03-05 22:10:04.847390+00:00", 
            "author": "https://api.launchpad.net/1.0/~amol-chobe"
        }, 
        {
            "content": "Amol,\n\nSince this is an upstream bug, removing MOS.\n\nthanks,\ndims", 
            "date_created": "2015-03-06 12:25:46.032072+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "usually, nova takes libvirt as compute driver, so could you help to verify if the libvirt driver output directly?\nyou could run \"virsh nodeinfo\" as belows\n\npark@park-ThinkPad-T420:~$ virsh nodeinfo\nCPU model:           x86_64\nCPU(s):              4\nCPU frequency:       2601 MHz\nCPU socket(s):       1\nCore(s) per socket:  2\nThread(s) per core:  2\nNUMA cell(s):        1\nMemory size:         8056668 KiB\n\n\nBTW, I could NOT reproduce this issue on my laptop\npark@park-ThinkPad-T420:~$ lscpu\nArchitecture:          x86_64\nCPU op-mode(s):        32-bit, 64-bit\nByte Order:            Little Endian\nCPU(s):                4\nOn-line CPU(s) list:   0-3\nThread(s) per core:    2\nCore(s) per socket:    2\nSocket(s):             1\nNUMA node(s):          1\nVendor ID:             GenuineIntel\nCPU family:            6\nModel:                 42\nStepping:              7\nCPU MHz:               800.000\nBogoMIPS:              5183.62\nVirtualization:        VT-x\nL1d cache:             32K\nL1i cache:             32K\nL2 cache:              256K\nL3 cache:              3072K\nNUMA node0 CPU(s):     0-3\npark@park-ThinkPad-T420:~$ nova hypervisor-show 1\n+---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Property                  | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |\n+---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| cpu_info_arch             | x86_64                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\n| cpu_info_features         | [\"ssse3\", \"pge\", \"avx\", \"clflush\", \"sep\", \"syscall\", \"vme\", \"dtes64\", \"tsc\", \"xsave\", \"vmx\", \"xtpr\", \"cmov\", \"pcid\", \"est\", \"pat\", \"monitor\", \"smx\", \"lm\", \"msr\", \"nx\", \"fxsr\", \"tm\", \"sse4.1\", \"pae\", \"sse4.2\", \"pclmuldq\", \"acpi\", \"tsc-deadline\", \"mmx\", \"osxsave\", \"cx8\", \"mce\", \"mtrr\", \"rdtscp\", \"ht\", \"pse\", \"lahf_lm\", \"pdcm\", \"mca\", \"apic\", \"sse\", \"ds\", \"pni\", \"tm2\", \"aes\", \"sse2\", \"ss\", \"pbe\", \"de\", \"fpu\", \"cx16\", \"pse36\", \"ds_cpl\", \"popcnt\", \"x2apic\"] |\n| cpu_info_model            | SandyBridge                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n| cpu_info_topology_cores   | 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n| cpu_info_topology_sockets | 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\n| cpu_info_topology_threads | 2 ", 
            "date_created": "2015-03-09 07:49:09.821872+00:00", 
            "author": "https://api.launchpad.net/1.0/~jianlonghei"
        }, 
        {
            "content": "Thanks ...\r\n\r\nThe virsh nodeinfo show CPUS(s) as 48 ... so that could be issue ...\r\nIs there any setting in libvirt that I need to change ?\r\n\r\nThx,\r\nAmol\r\n\r\n\r\nroot@node-16:~# virsh nodeinfo\r\nCPU model:           x86_64\r\nCPU(s):              48  \r\nCPU frequency:       2500 MHz\r\nCPU socket(s):       1\r\nCore(s) per socket:  12\r\nThread(s) per core:  2\r\nNUMA cell(s):        2\r\nMemory size:         131793936 KiB\r\n\r\n\r\n\r\n-----Original Message-----\r\nFrom: <email address hidden> [mailto:<email address hidden>] On Behalf Of Park\r\nSent: Monday, March 09, 2015 3:49 AM\r\nTo: Amol Chobe\r\nSubject: [Bug 1428872] Re: Nova CPU details socket not correct\r\n\r\nusually, nova takes libvirt as compute driver, so could you help to verify if the libvirt driver output directly?\r\nyou could run \"virsh nodeinfo\" as belows\r\n\r\npark@park-ThinkPad-T420:~$ virsh nodeinfo\r\nCPU model:           x86_64\r\nCPU(s):              4\r\nCPU frequency:       2601 MHz\r\nCPU socket(s):       1\r\nCore(s) per socket:  2\r\nThread(s) per core:  2\r\nNUMA cell(s):        1\r\nMemory size:         8056668 KiB\r\n\r\n\r\nBTW, I could NOT reproduce this issue on my laptop park@park-ThinkPad-T420:~$ lscpu\r\nArchitecture:          x86_64\r\nCPU op-mode(s):        32-bit, 64-bit\r\nByte Order:            Little Endian\r\nCPU(s):                4\r\nOn-line CPU(s) list:   0-3\r\nThread(s) per core:    2\r\nCore(s) per socket:    2\r\nSocket(s):             1\r\nNUMA node(s):          1\r\nVendor ID:             GenuineIntel\r\nCPU family:            6\r\nModel:                 42\r\nStepping:              7\r\nCPU MHz:               800.000\r\nBogoMIPS:              5183.62\r\nVirtualization:        VT-x\r\nL1d cache:             32K\r\nL1i cache:             32K\r\nL2 cache:              256K\r\nL3 cache:              3072K\r\nNUMA node0 CPU(s):     0-3\r\npark@park-ThinkPad-T420:~$ nova hypervisor-show 1\r\n+---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n| Property                  | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                    |\r\n+---------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n| cpu_info_arch             | x86_64                                                                                                                                                                                                                                                                                                                                                                                                                                                                   |\r\n| cpu_info_features         | [\"ssse3\", \"pge\", \"avx\", \"clflush\", \"sep\", \"syscall\", \"vme\", \"dtes64\", \"tsc\", \"xsave\", \"vmx\", \"xtpr\", \"cmov\", \"pcid\", \"est\", \"pat\", \"monitor\", \"smx\", \"lm\", \"msr\", \"nx\", \"fxsr\", \"tm\", \"sse4.1\", \"pae\", \"sse4.2\", \"pclmuldq\", \"acpi\", \"tsc-deadline\", \"mmx\", \"osxsave\", \"cx8\", \"mce\", \"mtrr\", \"rdtscp\", \"ht\", \"pse\", \"lahf_lm\", \"pdcm\", \"mca\", \"apic\", \"sse\", \"ds\", \"pni\", \"tm2\", \"aes\", \"sse2\", \"ss\", \"pbe\", \"de\", \"fpu\", \"cx16\", \"pse36\", \"ds_cpl\", \"popcnt\", \"x2apic\"] |\r\n| cpu_info_model            | SandyBridge                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\r\n| cpu_info_topology_cores   | 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\r\n| cpu_info_topology_sockets | 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\r\n| cpu_info_topology_threads | 2\r\n\r\n--\r\nYou received this bug notification because you are subscribed to the bug report.\r\nhttps://bugs.launchpad.net/bugs/1428872\r\n\r\nTitle:\r\n  Nova CPU details  socket not correct\r\n\r\nStatus in OpenStack Compute (Nova):\r\n  Confirmed\r\n\r\nBug description:\r\n  we are using Mirantis 6.0\r\n  we are trying to find a physical CPU information  from Nova compute host . e are using nova hypervisor-show command.\r\n\r\n  when i tried running the nova hypervisor-show <compute_node>\r\n\r\n  its show me correct info cpu_arch , cpu_info_features and cores ...\r\n  but its show its only one sockets where as we are using 2 CPU .( see\r\n  details from compute node below)\r\n\r\n  \r\n   \r\n\r\n  \r\n  we are trying to find physical CPU details from Nova-compute host blade , \r\n\r\n  Here is what nova shows\r\n\r\n  root@node-9:~# nova hypervisor-show node-12\r\n  +---------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n  | Property                  | Value                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\r\n  +---------------------------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\r\n  | cpu_info_arch             | x86_64                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             |\r\n  | cpu_info_features         | [\"ssse3\", \"pge\", \"avx\", \"clflush\", \"sep\", \"syscall\", \"vme\", \"dtes64\", \"invpcid\", \"msr\", \"sse\", \"xsave\", \"vmx\", \"erms\", \"xtpr\", \"cmov\", \"tsc\", \"smep\", \"pbe\", \"est\", \"pat\", \"monitor\", \"smx\", \"lm\", \"abm\", \"nx\", \"fxsr\", \"tm\", \"sse4.1\", \"pae\", \"sse4.2\", \"pclmuldq\", \"acpi\", \"fma\", \"tsc-deadline\", \"popcnt\", \"mmx\", \"osxsave\", \"cx8\", \"mce\", \"mtrr\", \"rdtscp\", \"ht\", \"dca\", \"lahf_lm\", \"pdcm\", \"mca\", \"pdpe1gb\", \"apic\", \"fsgsbase\", \"f16c\", \"pse\", \"ds\", \"pni\", \"tm2\", \"avx2\", \"aes\", \"sse2\", \"ss\", \"bmi1\", \"bmi2\", \"pcid\", \"de\", \"fpu\", \"cx16\", \"pse36\", \"ds_cpl\", \"movbe\", \"rdrand\", \"x2apic\"] |\r\n  | cpu_info_model            | SandyBridge                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        |\r\n  | cpu_info_topology_cores   | 12                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 |\r\n  | cpu_info_topology_sockets | 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\r\n  | cpu_info_topology_threads 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  |\r\n  | cpu_info_vendor           | Intel          \r\n  `\r\n\r\n  In reality it is 2 CPU as below , here is output from nova-compute\r\n  host\r\n\r\n  \r\n  root@node-16:~# lscpu\r\n  Architecture:          x86_64\r\n  CPU op-mode(s):        32-bit, 64-bit\r\n  Byte Order:            Little Endian\r\n  CPU(s):                48\r\n  On-line CPU(s) list:   0-47\r\n  Thread(s) per core:    2\r\n  Core(s) per socket:    12\r\n  Socket(s):             2\r\n  NUMA node(s):          2\r\n  Vendor ID:             GenuineIntel\r\n  CPU family:            6\r\n  Model:                 63\r\n  Stepping:              2\r\n  CPU MHz:               2500.093\r\n  BogoMIPS:              5001.17\r\n  Virtualization:        VT-x\r\n  L1d cache:             32K\r\n  L1i cache:             32K\r\n  L2 cache:              256K\r\n  L3 cache:              30720K\r\n  NUMA node0 CPU(s):     0,2,4,6,8,10,12,14,16,18,20,22,24,26,28,30,32,34,36,38,40,42,44,46\r\n  NUMA node1 CPU(s):     1,3,5,7,9,11,13,15,17,19,21,23,25,27,29,31,33,35,37,39,41,43,45,47\r\n\r\nTo manage notifications about this bug go to:\r\nhttps://bugs.launchpad.net/nova/+bug/1428872/+subscriptions\r\n", 
            "date_created": "2015-03-09 13:10:14+00:00", 
            "author": "https://api.launchpad.net/1.0/~amol-chobe"
        }, 
        {
            "content": "sorry I am NOT familiar with libvirt neither...\n\nbut from your virsh nodeinfo output, nova stays consistant with virsh, so I don't think this is a nova bug...\n\nI am going to close this bug, please feel free to reopen it if any problem", 
            "date_created": "2015-03-10 02:29:43.511101+00:00", 
            "author": "https://api.launchpad.net/1.0/~jianlonghei"
        }, 
        {
            "content": "I think this is a valid problem. Nova hypervisor show reports:\n| cpu_info_topology_cores | 12 |\n| cpu_info_topology_sockets | 1 |\n| cpu_info_topology_threads 2 |\nIf you multiple these number together you get 24 cpus on the host, in the other hand virsh nodeinfon reports \nCPU(s): 48\n\nThis is because the compute host has two NUMA node each with 24 cpus. Current there is no way to determine how many NUMA nodes the hypervisor has from the output of the nova hypervisor-show.\n\nTo solve this either the cpu_info_topology_sockets in the hypervisor-show shall contain the value of nr_of_numa_nodes * socket_per_numa_node or the hypervisor-show shall have an extra value that tells the number of NUMA nodes on the host.", 
            "date_created": "2016-07-07 08:32:36.124989+00:00", 
            "author": "https://api.launchpad.net/1.0/~balazs-gibizer"
        }, 
        {
            "content": "There are no open reviews for this bug report since a long time.\nAnd it was moved to invalid by last assignee. The bug was moved to New state later.\n\nTo signal that to other contributors which might provide patches for\nthis bug, I'm removing the assignee.\n\nFeel free to add yourself as assignee and push a review for it.", 
            "date_created": "2016-07-08 20:41:10.070562+00:00", 
            "author": "https://api.launchpad.net/1.0/~sujitha-neti"
        }
    ]
}