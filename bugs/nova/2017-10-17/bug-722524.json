{
    "status": "Invalid", 
    "last_updated": "2011-06-29 12:25:35.345433+00:00", 
    "description": "2011-02-21 12:38:41,773 INFO nova.virt.libvirt_conn [-] instance instance-00000022: deleting instance files /var/lib/nova/instances/instance-00000022\n2011-02-21 12:38:41,779 ERROR nova.exception [-] Uncaught exception\n(nova.exception): TRACE: Traceback (most recent call last):\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/exception.py\", line 116, in _wrap\n(nova.exception): TRACE:     return f(*args, **kw)\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/compute/manager.py\", line 92, in decorated_function\n(nova.exception): TRACE:     function(self, context, instance_id, *args, **kwargs)\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/compute/manager.py\", line 271, in terminate_instance\n(nova.exception): TRACE:     self.db.instance_destroy(context, instance_id)\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/db/api.py\", line 330, in instance_destroy\n(nova.exception): TRACE:     return IMPL.instance_destroy(context, instance_id)\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/db/sqlalchemy/api.py\", line 108, in wrapper\n(nova.exception): TRACE:     return f(*args, **kwargs)\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/db/sqlalchemy/api.py\", line 677, in instance_destroy\n(nova.exception): TRACE:     'at': datetime.datetime.utcnow()})\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/orm/session.py\", line 735, in execute\n(nova.exception): TRACE:     clause, params or {})\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1157, in execute\n(nova.exception): TRACE:     params)\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1237, in _execute_clauseelement\n(nova.exception): TRACE:     return self.__execute_context(context)\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1268, in __execute_context\n(nova.exception): TRACE:     context.parameters[0], context=context)\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1367, in _cursor_execute\n(nova.exception): TRACE:     context)\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1360, in _cursor_execute\n(nova.exception): TRACE:     context)\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/default.py\", line 288, in do_execute\n(nova.exception): TRACE:     cursor.execute(statement, parameters)\n(nova.exception): TRACE: ProgrammingError: (ProgrammingError) column \"deleted\" is of type boolean but expression is of type integer\n(nova.exception): TRACE: LINE 1: update instances set deleted=1,deleted_at='2011-02-21T09:38:...\n(nova.exception): TRACE:                                      ^\n(nova.exception): TRACE: HINT:  You will need to rewrite or cast the expression.\n(nova.exception): TRACE:  'update instances set deleted=1,deleted_at=%(at)s where id=%(id)s' {'at': datetime.datetime(2011, 2, 21, 9, 38, 41, 775427), 'id': 34}\n\nI tried to change nova/nova/db/sqlalchemy/api.py to 'deleted=true' (lines 674, 679) and it works ok with PostgreSQL backend.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 18, 
    "link": "https://bugs.launchpad.net/nova/+bug/722524", 
    "owner": "None", 
    "id": 722524, 
    "index": 3307, 
    "openned": "2011-02-21 10:14:17.038998+00:00", 
    "created": "2011-02-21 10:14:17.038998+00:00", 
    "title": "euca-terminate-instances fails with PostgreSQL backend", 
    "comments": [
        {
            "content": "2011-02-21 12:38:41,773 INFO nova.virt.libvirt_conn [-] instance instance-00000022: deleting instance files /var/lib/nova/instances/instance-00000022\n2011-02-21 12:38:41,779 ERROR nova.exception [-] Uncaught exception\n(nova.exception): TRACE: Traceback (most recent call last):\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/exception.py\", line 116, in _wrap\n(nova.exception): TRACE:     return f(*args, **kw)\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/compute/manager.py\", line 92, in decorated_function\n(nova.exception): TRACE:     function(self, context, instance_id, *args, **kwargs)\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/compute/manager.py\", line 271, in terminate_instance\n(nova.exception): TRACE:     self.db.instance_destroy(context, instance_id)\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/db/api.py\", line 330, in instance_destroy\n(nova.exception): TRACE:     return IMPL.instance_destroy(context, instance_id)\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/db/sqlalchemy/api.py\", line 108, in wrapper\n(nova.exception): TRACE:     return f(*args, **kwargs)\n(nova.exception): TRACE:   File \"/home/anekrasov/openstack/nova/nova/db/sqlalchemy/api.py\", line 677, in instance_destroy\n(nova.exception): TRACE:     'at': datetime.datetime.utcnow()})\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/orm/session.py\", line 735, in execute\n(nova.exception): TRACE:     clause, params or {})\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1157, in execute\n(nova.exception): TRACE:     params)\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1237, in _execute_clauseelement\n(nova.exception): TRACE:     return self.__execute_context(context)\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1268, in __execute_context\n(nova.exception): TRACE:     context.parameters[0], context=context)\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1367, in _cursor_execute\n(nova.exception): TRACE:     context)\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/base.py\", line 1360, in _cursor_execute\n(nova.exception): TRACE:     context)\n(nova.exception): TRACE:   File \"/usr/lib/python2.6/dist-packages/sqlalchemy/engine/default.py\", line 288, in do_execute\n(nova.exception): TRACE:     cursor.execute(statement, parameters)\n(nova.exception): TRACE: ProgrammingError: (ProgrammingError) column \"deleted\" is of type boolean but expression is of type integer\n(nova.exception): TRACE: LINE 1: update instances set deleted=1,deleted_at='2011-02-21T09:38:...\n(nova.exception): TRACE:                                      ^\n(nova.exception): TRACE: HINT:  You will need to rewrite or cast the expression.\n(nova.exception): TRACE:  'update instances set deleted=1,deleted_at=%(at)s where id=%(id)s' {'at': datetime.datetime(2011, 2, 21, 9, 38, 41, 775427), 'id': 34}\n\nI tried to change nova/nova/db/sqlalchemy/api.py to 'deleted=true' (lines 674, 679) and it works ok with PostgreSQL backend.", 
            "date_created": "2011-02-21 10:14:17.038998+00:00", 
            "author": "https://api.launchpad.net/1.0/~lxndr-nkrsv"
        }, 
        {
            "content": "Is this still an issue now that more queries are using SQLAlchemy, through the fix to bug 722979 ?", 
            "date_created": "2011-03-30 09:53:05.114089+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "Closing due to lack of reply from OP. Please reopen if you can confirm that the problem was not fixed yet.", 
            "date_created": "2011-06-29 12:25:33.831441+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }
    ], 
    "closed": "2011-06-29 12:25:34.488627+00:00"
}