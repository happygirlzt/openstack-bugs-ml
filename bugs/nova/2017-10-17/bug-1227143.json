{
    "status": "Expired", 
    "last_updated": "2016-07-05 09:43:45.571402+00:00", 
    "description": "Hi,\nI try to launch 45 instances in parallel :\nnova boot --image ${image_id} --flavor ${flavor_id} --nic net-id=${net_id} --num-instances 45 jordan-internet\n\nSometimes, nova fails to get the IP address of one or 2 instances :\n>nova list\n+--------------------------------------+------------------------------------------------------+--------+------------+-------------+------------------------+\n| ID                                   | Name                                                 | Status | Task State | Power State | Networks               |\n+--------------------------------------+------------------------------------------------------+--------+------------+-------------+------------------------+\n| 31d9c78b-1d03-46a8-98eb-47143679e1c8 | jordan-internet-31d9c78b-1d03-46a8-98eb-47143679e1c8 | ACTIVE | None       | Running     | internet=194.2.202.177 |\n| 3301a06c-60c0-48a7-97b1-4ee292ccf294 | jordan-internet-3301a06c-60c0-48a7-97b1-4ee292ccf294 | ACTIVE | None       | Running     | internet=194.2.202.193 |\n| 357b3366-4918-4d09-8c52-4ce5a1c02156 | jordan-internet-357b3366-4918-4d09-8c52-4ce5a1c02156 | ACTIVE | None       | Running     |                        |\n| 35af1894-cb5d-4797-a0aa-88df32436351 | jordan-internet-35af1894-cb5d-4797-a0aa-88df32436351 | ACTIVE | None       | Running     | internet=194.2.202.171 |\n| 2a5afa62-68c1-4343-ba40-7fb0021d2a23 | jordan-internet-2a5afa62-68c1-4343-ba40-7fb0021d2a23 | ACTIVE | None       | Running     | internet=194.2.202.153 |\n| 30d14347-f260-4f6f-a55a-d2e5549f84e1 | jordan-internet-30d14347-f260-4f6f-a55a-d2e5549f84e1 | ACTIVE | None       | Running     | internet=194.2.202.188 |\n| 318a9c90-3573-4ba2-a73a-d65a3d79a2b2 | jordan-internet-318a9c90-3573-4ba2-a73a-d65a3d79a2b2 | ACTIVE | None       | Running     | internet=194.2.202.176 |\n\n>nova show 357b3366-4918-4d09-8c52-4ce5a1c02156\n+-------------------------------------+-------------------------------------------------------------------+\n| Property                            | Value                                                             |\n+-------------------------------------+-------------------------------------------------------------------+\n| status                              | ACTIVE                                                            |\n| updated                             | 2013-09-18T13:21:49Z                                              |\n| OS-EXT-STS:task_state               | None                                                              |\n| OS-EXT-SRV-ATTR:host                | d-ocnclc-0001                                                     |\n| key_name                            | jordan                                                            |\n| image                               | Ubuntu precise 12.04.2 LTS (cecc8e4c-e689-40f9-80de-9a43219c9c0b) |\n| hostId                              | bf54cba4f3fdc7b0b8c1b1872de977c770fb332c2d395e7acd370a4b          |\n| OS-EXT-STS:vm_state                 | active                                                            |\n| OS-EXT-SRV-ATTR:instance_name       | instance-00004ab6                                                 |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | d-ocnclc-0001.adm.dev1.val.cw-labs.net                            |\n| flavor                              | m1.small (6)                                                      |\n| id                                  | 357b3366-4918-4d09-8c52-4ce5a1c02156                              |\n| security_groups                     | [{u'name': u'default'}]                                           |\n| user_id                             | bbdcffe9d3944c35bcf6a875b6d3d235                                  |\n| name                                | jordan-internet-357b3366-4918-4d09-8c52-4ce5a1c02156              |\n| created                             | 2013-09-18T13:18:22Z                                              |\n| tenant_id                           | 462d7cbd479f499fa75ad9f14571d553                                  |\n| OS-DCF:diskConfig                   | MANUAL                                                            |\n| metadata                            | {}                                                                |\n| accessIPv4                          |                                                                   |\n| accessIPv6                          |                                                                   |\n| progress                            | 0                                                                 |\n| OS-EXT-STS:power_state              | 1                                                                 |\n| OS-EXT-AZ:availability_zone         | alpha1.val                                                        |\n| config_drive                        |                                                                   |\n+-------------------------------------+-------------------------------------------------------------------+\n\n\nWhat's weird is that nova interfast-list is \"correct\" :\njordan@jpi-octo:~$ nova interface-list 357b3366-4918-4d09-8c52-4ce5a1c02156\n+------------+--------------------------------------+--------------------------------------+---------------+-------------------+\n| Port State | Port ID                              | Net ID                               | IP addresses  | MAC Addr          |\n+------------+--------------------------------------+--------------------------------------+---------------+-------------------+\n| ACTIVE     | d5b85cae-623e-4e77-a09a-3c057af6b4c7 | 7b07d545-53da-4897-abbd-dfe142db0fc2 | 194.2.202.181 | fa:16:3e:2f:9b:51 |\n+------------+--------------------------------------+--------------------------------------+---------------+-------------------+\n\nAnd quantum port-show is also 'correct' :\njordan@jpi-octo:~$ quantum port-show d5b85cae-623e-4e77-a09a-3c057af6b4c7\n+----------------------+--------------------------------------------------------------------------------------+\n| Field                | Value                                                                                |\n+----------------------+--------------------------------------------------------------------------------------+\n| admin_state_up       | True                                                                                 |\n| binding:capabilities | {\"port_filter\": true}                                                                |\n| binding:vif_type     | ovs                                                                                  |\n| device_id            | 357b3366-4918-4d09-8c52-4ce5a1c02156                                                 |\n| device_owner         | compute:None                                                                         |\n| fixed_ips            | {\"subnet_id\": \"32ce548d-dd26-48f9-b7a0-78ea69f4750c\", \"ip_address\": \"194.2.202.181\"} |\n| id                   | d5b85cae-623e-4e77-a09a-3c057af6b4c7                                                 |\n| mac_address          | fa:16:3e:2f:9b:51                                                                    |\n| name                 |                                                                                      |\n| network_id           | 7b07d545-53da-4897-abbd-dfe142db0fc2                                                 |\n| security_groups      | 865ca78f-d712-4828-8ec8-b53f7c3f5523                                                 |\n| status               | ACTIVE                                                                               |\n| tenant_id            | 462d7cbd479f499fa75ad9f14571d553                                                     |\n+----------------------+--------------------------------------------------------------------------------------+\n\nSo the problem lies in the SQL column 'network_info' of the table nova.instance_info. For a problematic instance, this column remains set as '[]' whereas for a 'correct' instance, the column contains some useful JSON data related to network\n\nI cannot reproduce this issue when I launch let's say 5 instances in parallel or if I launch 45 instances one after another.\n\nAny help would be very much appreciated. I don't fully understand what does compute/utils.py::get_nw_info_for_instance() nor network/quantumv2/api.py::_build_network_info_model() and network/quantumv2/api.py::allocate_for_instance() :(\n\nThanks,\nJordan\n\nSetup :\nGrizzly 2013.1.3\nNova-api with osapi_compute_workers=10\nQuantum with openvswitch-plugin", 
    "tags": [
        "network", 
        "neutron"
    ], 
    "importance": "Undecided", 
    "heat": 20, 
    "link": "https://bugs.launchpad.net/nova/+bug/1227143", 
    "owner": "None", 
    "id": 1227143, 
    "index": 5365, 
    "openned": "2013-09-18 14:03:42.955047+00:00", 
    "created": "2013-09-18 14:03:42.955047+00:00", 
    "title": "InstanceInfoCache is not always updated with concurrent instance creation", 
    "comments": [
        {
            "content": "Hi,\nI try to launch 45 instances in parallel :\nnova boot --image ${image_id} --flavor ${flavor_id} --nic net-id=${net_id} --num-instances 45 jordan-internet\n\nSometimes, nova fails to get the IP address of one or 2 instances :\n>nova list\n+--------------------------------------+------------------------------------------------------+--------+------------+-------------+------------------------+\n| ID                                   | Name                                                 | Status | Task State | Power State | Networks               |\n+--------------------------------------+------------------------------------------------------+--------+------------+-------------+------------------------+\n| 31d9c78b-1d03-46a8-98eb-47143679e1c8 | jordan-internet-31d9c78b-1d03-46a8-98eb-47143679e1c8 | ACTIVE | None       | Running     | internet=194.2.202.177 |\n| 3301a06c-60c0-48a7-97b1-4ee292ccf294 | jordan-internet-3301a06c-60c0-48a7-97b1-4ee292ccf294 | ACTIVE | None       | Running     | internet=194.2.202.193 |\n| 357b3366-4918-4d09-8c52-4ce5a1c02156 | jordan-internet-357b3366-4918-4d09-8c52-4ce5a1c02156 | ACTIVE | None       | Running     |                        |\n| 35af1894-cb5d-4797-a0aa-88df32436351 | jordan-internet-35af1894-cb5d-4797-a0aa-88df32436351 | ACTIVE | None       | Running     | internet=194.2.202.171 |\n| 2a5afa62-68c1-4343-ba40-7fb0021d2a23 | jordan-internet-2a5afa62-68c1-4343-ba40-7fb0021d2a23 | ACTIVE | None       | Running     | internet=194.2.202.153 |\n| 30d14347-f260-4f6f-a55a-d2e5549f84e1 | jordan-internet-30d14347-f260-4f6f-a55a-d2e5549f84e1 | ACTIVE | None       | Running     | internet=194.2.202.188 |\n| 318a9c90-3573-4ba2-a73a-d65a3d79a2b2 | jordan-internet-318a9c90-3573-4ba2-a73a-d65a3d79a2b2 | ACTIVE | None       | Running     | internet=194.2.202.176 |\n\n>nova show 357b3366-4918-4d09-8c52-4ce5a1c02156\n+-------------------------------------+-------------------------------------------------------------------+\n| Property                            | Value                                                             |\n+-------------------------------------+-------------------------------------------------------------------+\n| status                              | ACTIVE                                                            |\n| updated                             | 2013-09-18T13:21:49Z                                              |\n| OS-EXT-STS:task_state               | None                                                              |\n| OS-EXT-SRV-ATTR:host                | d-ocnclc-0001                                                     |\n| key_name                            | jordan                                                            |\n| image                               | Ubuntu precise 12.04.2 LTS (cecc8e4c-e689-40f9-80de-9a43219c9c0b) |\n| hostId                              | bf54cba4f3fdc7b0b8c1b1872de977c770fb332c2d395e7acd370a4b          |\n| OS-EXT-STS:vm_state                 | active                                                            |\n| OS-EXT-SRV-ATTR:instance_name       | instance-00004ab6                                                 |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | d-ocnclc-0001.adm.dev1.val.cw-labs.net                            |\n| flavor                              | m1.small (6)                                                      |\n| id                                  | 357b3366-4918-4d09-8c52-4ce5a1c02156                              |\n| security_groups                     | [{u'name': u'default'}]                                           |\n| user_id                             | bbdcffe9d3944c35bcf6a875b6d3d235                                  |\n| name                                | jordan-internet-357b3366-4918-4d09-8c52-4ce5a1c02156              |\n| created                             | 2013-09-18T13:18:22Z                                              |\n| tenant_id                           | 462d7cbd479f499fa75ad9f14571d553                                  |\n| OS-DCF:diskConfig                   | MANUAL                                                            |\n| metadata                            | {}                                                                |\n| accessIPv4                          |                                                                   |\n| accessIPv6                          |                                                                   |\n| progress                            | 0                                                                 |\n| OS-EXT-STS:power_state              | 1                                                                 |\n| OS-EXT-AZ:availability_zone         | alpha1.val                                                        |\n| config_drive                        |                                                                   |\n+-------------------------------------+-------------------------------------------------------------------+\n\n\nWhat's weird is that nova interfast-list is \"correct\" :\njordan@jpi-octo:~$ nova interface-list 357b3366-4918-4d09-8c52-4ce5a1c02156\n+------------+--------------------------------------+--------------------------------------+---------------+-------------------+\n| Port State | Port ID                              | Net ID                               | IP addresses  | MAC Addr          |\n+------------+--------------------------------------+--------------------------------------+---------------+-------------------+\n| ACTIVE     | d5b85cae-623e-4e77-a09a-3c057af6b4c7 | 7b07d545-53da-4897-abbd-dfe142db0fc2 | 194.2.202.181 | fa:16:3e:2f:9b:51 |\n+------------+--------------------------------------+--------------------------------------+---------------+-------------------+\n\nAnd quantum port-show is also 'correct' :\njordan@jpi-octo:~$ quantum port-show d5b85cae-623e-4e77-a09a-3c057af6b4c7\n+----------------------+--------------------------------------------------------------------------------------+\n| Field                | Value                                                                                |\n+----------------------+--------------------------------------------------------------------------------------+\n| admin_state_up       | True                                                                                 |\n| binding:capabilities | {\"port_filter\": true}                                                                |\n| binding:vif_type     | ovs                                                                                  |\n| device_id            | 357b3366-4918-4d09-8c52-4ce5a1c02156                                                 |\n| device_owner         | compute:None                                                                         |\n| fixed_ips            | {\"subnet_id\": \"32ce548d-dd26-48f9-b7a0-78ea69f4750c\", \"ip_address\": \"194.2.202.181\"} |\n| id                   | d5b85cae-623e-4e77-a09a-3c057af6b4c7                                                 |\n| mac_address          | fa:16:3e:2f:9b:51                                                                    |\n| name                 |                                                                                      |\n| network_id           | 7b07d545-53da-4897-abbd-dfe142db0fc2                                                 |\n| security_groups      | 865ca78f-d712-4828-8ec8-b53f7c3f5523                                                 |\n| status               | ACTIVE                                                                               |\n| tenant_id            | 462d7cbd479f499fa75ad9f14571d553                                                     |\n+----------------------+--------------------------------------------------------------------------------------+\n\nSo the problem lies in the SQL column 'network_info' of the table nova.instance_info. For a problematic instance, this column remains set as '[]' whereas for a 'correct' instance, the column contains some useful JSON data related to network\n\nI cannot reproduce this issue when I launch let's say 5 instances in parallel or if I launch 45 instances one after another.\n\nAny help would be very much appreciated. I don't fully understand what does compute/utils.py::get_nw_info_for_instance() nor network/quantumv2/api.py::_build_network_info_model() and network/quantumv2/api.py::allocate_for_instance() :(\n\nThanks,\nJordan\n\nSetup :\nGrizzly 2013.1.3\nNova-api with osapi_compute_workers=10\nQuantum with openvswitch-plugin", 
            "date_created": "2013-09-18 14:03:42.955047+00:00", 
            "author": "https://api.launchpad.net/1.0/~jordan-pittier"
        }, 
        {
            "content": "All nova does to generate the initial blob of json with \"good\" network info in it is call out to the Neutron API. It does a few different calls and if one of those fails the whole process fails. Two additional pieces of information would be helpful:\n\n1. At the time of creation nova-compute logs from the host the instance launched on\n2. Logs from the neutron server at the same time period\n\n", 
            "date_created": "2014-02-12 02:28:49.520749+00:00", 
            "author": "https://api.launchpad.net/1.0/~geekinutah"
        }, 
        {
            "content": "I think this bug is the same as https://bugs.launchpad.net/nova/+bug/1254320\r\n", 
            "date_created": "2014-03-05 06:21:44.683243+00:00", 
            "author": "https://api.launchpad.net/1.0/~kexiaodong"
        }, 
        {
            "content": "\nThis is an automated cleanup. This bug report has been closed because it\nis older than 18 months and there is no open code change to fix this.\nAfter this time it is unlikely that the circumstances which lead to\nthe observed issue can be reproduced.\n\nIf you can reproduce the bug, please:\n* reopen the bug report (set to status \"New\")\n* AND add the detailed steps to reproduce the issue (if applicable)\n* AND leave a comment \"CONFIRMED FOR: <RELEASE_NAME>\"\n  Only still supported release names are valid (LIBERTY, MITAKA, OCATA, NEWTON).\n  Valid example: CONFIRMED FOR: LIBERTY\n", 
            "date_created": "2016-07-05 09:43:45.067080+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }
    ], 
    "closed": "2016-07-05 09:43:42.980883+00:00"
}