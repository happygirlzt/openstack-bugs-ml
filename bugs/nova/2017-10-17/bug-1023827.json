{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:25:51.582874+00:00", 
    "description": "Openstack Compute (nova) Essex with last updates.\nWe have 3 compute nodes in our openstack infrastructure named : opstack87 opstack88 opstack89\n(opstack87 is our controller node too)\nThe default scheduler options are used, that is :\nscheduler_topic=\"scheduler\"\nscheduler_manager = nova.scheduler.manager.SchedulerManager\ndefault_schedule_zone=<None>\nnode_availability_zone=\"nova\" \nscheduler_host_manager=\"nova.scheduler.host_manager.HostManager\"\nreserved_host_memory_mb=512\nscheduler_driver=\"nova.scheduler.multi.MultiScheduler\"\ncompute_scheduler_driver=\"nova.scheduler.filter_scheduler.FilterScheduler\"\nscheduler_available_filters=\"nova.scheduler.filters.standard_filters\"\nscheduler_default_filters=\"AvailabilityZoneFilter,RamFilter,ComputeFilter\"\nleast_cost_functions=\"nova.scheduler.least_cost.compute_fill_first_cost_fn\"\ncompute_fill_first_cost_fn_weight=1.0\n\nWe execute the following nova boot command :\nroot@opstack87:~# nova boot --flavor 1 --image 1f00e541-7a7d-43ab-a4cf-342802f3bca4 gauthier\n\nwith the following result :\n+-------------------------------------+----------------------------------------------------------+\n|               Property              |                          Value                           |\n+-------------------------------------+----------------------------------------------------------+\n| OS-DCF:diskConfig                   | MANUAL                                                   |\n| OS-EXT-SRV-ATTR:host                | opstack90                                                |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | None                                                     |\n| OS-EXT-SRV-ATTR:instance_name       | instance-00000171                                        |\n| OS-EXT-STS:power_state              | 0                                                        |\n| OS-EXT-STS:task_state               | scheduling                                               |\n| OS-EXT-STS:vm_state                 | building                                                 |\n| accessIPv4                          |                                                          |\n| accessIPv6                          |                                                          |\n| adminPass                           | 8rk7BmD2e3HZ                                             |\n| config_drive                        |                                                          |\n| created                             | 2012-07-12T09:28:00Z                                     |\n| flavor                              | m1.tiny                                                  |\n| hostId                              | 43b17ba609cacafbdb8961f6d5e8028d0564d640f689b4aad613a349 |\n| id                                  | 3cfc6768-d618-4891-b9c2-a08b7ca0910e                     |\n| image                               | ubuntu_with_cosacs                                       |\n| key_name                            |                                                          |\n| metadata                            | {}                                                       |\n| name                                | gauthier                                                 |\n| progress                            | 0                                                        |\n| status                              | BUILD                                                    |\n| tenant_id                           | a41b71ec474b4f9da53d0f6c0e044f48                         |\n| updated                             | 2012-07-12T09:28:02Z                                     |\n| user_id                             | 2d6944752cba4942a17cf25365c14bf3                         |\n+-------------------------------------+----------------------------------------------------------+\nroot@opstack87:~#\n\nroot@opstack87:~# nova list\n+--------------------------------------+----------+--------+-------------------+\n|                  ID                  |   Name   | Status |      Networks     |\n+--------------------------------------+----------+--------+-------------------+\n| 3cfc6768-d618-4891-b9c2-a08b7ca0910e | gauthier | ACTIVE | private=10.0.21.3 |\n+--------------------------------------+----------+--------+-------------------+\nroot@opstack87:~#\n\nflavor =1 is the m1.tiny flavor with 512MB memory\nroot@opstack87:~# nova flavor-list\n+----+-----------+-----------+------+-----------+------+-------+-------------+\n| ID |    Name   | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor |\n+----+-----------+-----------+------+-----------+------+-------+-------------+\n| 1  | m1.tiny   | 512       | 0    | 0         |      | 1     | 1.0         |\n| 2  | m1.small  | 2048      | 10   | 20        |      | 1     | 1.0         |\n| 3  | m1.medium | 4096      | 10   | 40        |      | 2     | 1.0         |\n| 4  | m1.large  | 8192      | 10   | 80        |      | 4     | 1.0         |\n| 5  | m1.xlarge | 16384     | 10   | 160       |      | 8     | 1.0         |\n+----+-----------+-----------+------+-----------+------+-------+-------------+\n\n\nThe scheduler log file shows the following trace :\n2012-07-12 11:28:02 DEBUG nova.rpc.amqp [-] received {u'_context_roles': [u'admin'], u'_context_request_id': u'req-5f214e16-8af1-4620-a78b-1bfe29498a67', u'_context_read_deleted': u'no', u'args': {u'request_spec': {u'num_instances': 1, u'block_device_mapping': [], u'image': {u'status': u'active', u'name': u'ubuntu_with_cosacs', u'deleted': False, u'container_format': u'ovf', u'created_at': u'2012-05-21 13:37:45', u'disk_format': u'qcow2', u'updated_at': u'2012-05-21 13:46:36', u'properties': {}, u'min_ram': u'0', u'checksum': u'546e1633a950427d3d7fa35106b632fe', u'min_disk': u'0', u'is_public': True, u'deleted_at': None, u'id': u'1f00e541-7a7d-43ab-a4cf-342802f3bca4', u'size': 1385365504}, u'instance_type': {u'root_gb': 0, u'name': u'm1.tiny', u'flavorid': u'1', u'deleted': False, u'created_at': None, u'ephemeral_gb': 0, u'updated_at': None, u'memory_mb': 512, u'vcpus': 1, u'extra_specs': {}, u'swap': 0, u'rxtx_factor': 1.0, u'deleted_at': None, u'vcpu_weight': None, u'id': 2}, u'instance_properties': {u'vm_state': u'building', u'availability_zone': None, u'launch_time': u'2012-07-12T09:28:00Z', u'ephemeral_gb': 0, u'instance_type_id': 2, u'user_data': u'', u'vm_mode': None, u'reservation_id': u'r-4gz82x4e', u'root_device_name': None, u'display_name': u'gauthier', u'uuid': u'3cfc6768-d618-4891-b9c2-a08b7ca0910e', u'display_description': u'gauthier', u'key_data': None, u'power_state': 0, u'progress': 0, u'project_id': u'a41b71ec474b4f9da53d0f6c0e044f48', u'metadata': {}, u'ramdisk_id': u'', u'access_ip_v6': None, u'access_ip_v4': None, u'kernel_id': u'', u'key_name': None, u'user_id': u'2d6944752cba4942a17cf25365c14bf3', u'config_drive_id': u'', u'root_gb': 0, u'locked': False, u'launch_index': 0, u'memory_mb': 512, u'vcpus': 1, u'image_ref': u'1f00e541-7a7d-43ab-a4cf-342802f3bca4', u'architecture': None, u'auto_disk_config': None, u'os_type': None, u'config_drive': u''}, u'security_group': [u'default']}, u'is_first_time': True, u'filter_properties': {u'scheduler_hints': {}}, u'topic': u'compute', u'admin_password': '<SANITIZED>', u'injected_files': [], u'requested_networks': None}, u'_context_auth_token': '<SANITIZED>', u'_context_is_admin': True, u'_context_project_id': u'a41b71ec474b4f9da53d0f6c0e044f48', u'_context_timestamp': u'2012-07-12T09:28:00.644495', u'_context_user_id': u'2d6944752cba4942a17cf25365c14bf3', u'method': u'run_instance', u'_context_remote_address': u'172.31.70.87'} from (pid=23457) _safe_log /usr/lib/python2.7/dist-packages/nova/rpc/common.py:160\n2012-07-12 11:28:02 DEBUG nova.rpc.amqp [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] unpacked context: {'user_id': u'2d6944752cba4942a17cf25365c14bf3', 'roles': [u'admin'], 'timestamp': '2012-07-12T09:28:00.644495', 'auth_token': '<SANITIZED>', 'remote_address': u'172.31.70.87', 'is_admin': True, 'request_id': u'req-5f214e16-8af1-4620-a78b-1bfe29498a67', 'project_id': u'a41b71ec474b4f9da53d0f6c0e044f48', 'read_deleted': u'no'} from (pid=23457) _safe_log /usr/lib/python2.7/dist-packages/nova/rpc/common.py:160\n2012-07-12 11:28:02 DEBUG nova.scheduler.filter_scheduler [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Attempting to build 1 instance(s) from (pid=23457) schedule_run_instance /usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py:65\n2012-07-12 11:28:02 DEBUG nova.scheduler.host_manager [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Host filter passes for opstack90 from (pid=23457) passes_filters /usr/lib/python2.7/dist-packages/nova/scheduler/host_manager.py:163\n2012-07-12 11:28:02 DEBUG nova.scheduler.host_manager [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Host filter passes for opstack88 from (pid=23457) passes_filters /usr/lib/python2.7/dist-packages/nova/scheduler/host_manager.py:163\n2012-07-12 11:28:02 DEBUG nova.scheduler.host_manager [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Host filter passes for opstack87 from (pid=23457) passes_filters /usr/lib/python2.7/dist-packages/nova/scheduler/host_manager.py:163\n2012-07-12 11:28:02 DEBUG nova.scheduler.filter_scheduler [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Filtered [host 'opstack90': free_ram_mb:17448 free_disk_mb:22528, host 'opstack88': free_ram_mb:7473 free_disk_mb:67584, host 'opstack87': free_ram_mb:11496 free_disk_mb:151552] from (pid=23457) _schedule /usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py:199\n2012-07-12 11:28:02 DEBUG nova.scheduler.filter_scheduler [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Weighted <nova.scheduler.least_cost.WeightedHost object at 0x39b5fd0> from (pid=23457) _schedule /usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py:209\n2012-07-12 11:28:02 DEBUG nova.rpc.amqp [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Making asynchronous cast on compute.opstack90... from (pid=23457) cast /usr/lib/python2.7/dist-packages/nova/rpc/amqp.py:351\n2012-07-12 11:28:02 DEBUG nova.scheduler.driver [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Casted 'run_instance' to compute 'opstack90' from (pid=23457) cast_to_compute_host /usr/lib/python2.7/dist-packages/nova/scheduler/driver.py:80\n\n\nThe 3 compute nodes passe the filters. The free ram (MB) for each host is :\nopstack87 : 11496\nopstack88 :  7473\nopstack90 : 17448\n\nThe default cost function \"nova.scheduler.least_cost.compute_fill_first_cost_fn\" returns the free ram for each host and this free ram is the corresponding host cost.\nThus, the lowest cost is 7473 (opstack88) and the highest cost is 17448 (opstack90).\nThe host opstack88 must be the winner (according code comments and documentation) because it has the lower cost.\nBut in fact, the winner is opstack90 (see log above) which has the highest cost.\n\nRegards.", 
    "tags": [
        "scheduler"
    ], 
    "importance": "High", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1023827", 
    "owner": "https://api.launchpad.net/1.0/~sdague", 
    "id": 1023827, 
    "index": 728, 
    "openned": "2012-07-12 10:06:17.400061+00:00", 
    "created": "2012-07-12 10:06:17.400061+00:00", 
    "title": "Server not instanciated on the expected physical host ", 
    "comments": [
        {
            "content": "Openstack Compute (nova) Essex with last updates.\nWe have 3 compute nodes in our openstack infrastructure named : opstack87 opstack88 opstack89\n(opstack87 is our controller node too)\nThe default scheduler options are used, that is :\nscheduler_topic=\"scheduler\"\nscheduler_manager = nova.scheduler.manager.SchedulerManager\ndefault_schedule_zone=<None>\nnode_availability_zone=\"nova\" \nscheduler_host_manager=\"nova.scheduler.host_manager.HostManager\"\nreserved_host_memory_mb=512\nscheduler_driver=\"nova.scheduler.multi.MultiScheduler\"\ncompute_scheduler_driver=\"nova.scheduler.filter_scheduler.FilterScheduler\"\nscheduler_available_filters=\"nova.scheduler.filters.standard_filters\"\nscheduler_default_filters=\"AvailabilityZoneFilter,RamFilter,ComputeFilter\"\nleast_cost_functions=\"nova.scheduler.least_cost.compute_fill_first_cost_fn\"\ncompute_fill_first_cost_fn_weight=1.0\n\nWe execute the following nova boot command :\nroot@opstack87:~# nova boot --flavor 1 --image 1f00e541-7a7d-43ab-a4cf-342802f3bca4 gauthier\n\nwith the following result :\n+-------------------------------------+----------------------------------------------------------+\n|               Property              |                          Value                           |\n+-------------------------------------+----------------------------------------------------------+\n| OS-DCF:diskConfig                   | MANUAL                                                   |\n| OS-EXT-SRV-ATTR:host                | opstack90                                                |\n| OS-EXT-SRV-ATTR:hypervisor_hostname | None                                                     |\n| OS-EXT-SRV-ATTR:instance_name       | instance-00000171                                        |\n| OS-EXT-STS:power_state              | 0                                                        |\n| OS-EXT-STS:task_state               | scheduling                                               |\n| OS-EXT-STS:vm_state                 | building                                                 |\n| accessIPv4                          |                                                          |\n| accessIPv6                          |                                                          |\n| adminPass                           | 8rk7BmD2e3HZ                                             |\n| config_drive                        |                                                          |\n| created                             | 2012-07-12T09:28:00Z                                     |\n| flavor                              | m1.tiny                                                  |\n| hostId                              | 43b17ba609cacafbdb8961f6d5e8028d0564d640f689b4aad613a349 |\n| id                                  | 3cfc6768-d618-4891-b9c2-a08b7ca0910e                     |\n| image                               | ubuntu_with_cosacs                                       |\n| key_name                            |                                                          |\n| metadata                            | {}                                                       |\n| name                                | gauthier                                                 |\n| progress                            | 0                                                        |\n| status                              | BUILD                                                    |\n| tenant_id                           | a41b71ec474b4f9da53d0f6c0e044f48                         |\n| updated                             | 2012-07-12T09:28:02Z                                     |\n| user_id                             | 2d6944752cba4942a17cf25365c14bf3                         |\n+-------------------------------------+----------------------------------------------------------+\nroot@opstack87:~#\n\nroot@opstack87:~# nova list\n+--------------------------------------+----------+--------+-------------------+\n|                  ID                  |   Name   | Status |      Networks     |\n+--------------------------------------+----------+--------+-------------------+\n| 3cfc6768-d618-4891-b9c2-a08b7ca0910e | gauthier | ACTIVE | private=10.0.21.3 |\n+--------------------------------------+----------+--------+-------------------+\nroot@opstack87:~#\n\nflavor =1 is the m1.tiny flavor with 512MB memory\nroot@opstack87:~# nova flavor-list\n+----+-----------+-----------+------+-----------+------+-------+-------------+\n| ID |    Name   | Memory_MB | Disk | Ephemeral | Swap | VCPUs | RXTX_Factor |\n+----+-----------+-----------+------+-----------+------+-------+-------------+\n| 1  | m1.tiny   | 512       | 0    | 0         |      | 1     | 1.0         |\n| 2  | m1.small  | 2048      | 10   | 20        |      | 1     | 1.0         |\n| 3  | m1.medium | 4096      | 10   | 40        |      | 2     | 1.0         |\n| 4  | m1.large  | 8192      | 10   | 80        |      | 4     | 1.0         |\n| 5  | m1.xlarge | 16384     | 10   | 160       |      | 8     | 1.0         |\n+----+-----------+-----------+------+-----------+------+-------+-------------+\n\n\nThe scheduler log file shows the following trace :\n2012-07-12 11:28:02 DEBUG nova.rpc.amqp [-] received {u'_context_roles': [u'admin'], u'_context_request_id': u'req-5f214e16-8af1-4620-a78b-1bfe29498a67', u'_context_read_deleted': u'no', u'args': {u'request_spec': {u'num_instances': 1, u'block_device_mapping': [], u'image': {u'status': u'active', u'name': u'ubuntu_with_cosacs', u'deleted': False, u'container_format': u'ovf', u'created_at': u'2012-05-21 13:37:45', u'disk_format': u'qcow2', u'updated_at': u'2012-05-21 13:46:36', u'properties': {}, u'min_ram': u'0', u'checksum': u'546e1633a950427d3d7fa35106b632fe', u'min_disk': u'0', u'is_public': True, u'deleted_at': None, u'id': u'1f00e541-7a7d-43ab-a4cf-342802f3bca4', u'size': 1385365504}, u'instance_type': {u'root_gb': 0, u'name': u'm1.tiny', u'flavorid': u'1', u'deleted': False, u'created_at': None, u'ephemeral_gb': 0, u'updated_at': None, u'memory_mb': 512, u'vcpus': 1, u'extra_specs': {}, u'swap': 0, u'rxtx_factor': 1.0, u'deleted_at': None, u'vcpu_weight': None, u'id': 2}, u'instance_properties': {u'vm_state': u'building', u'availability_zone': None, u'launch_time': u'2012-07-12T09:28:00Z', u'ephemeral_gb': 0, u'instance_type_id': 2, u'user_data': u'', u'vm_mode': None, u'reservation_id': u'r-4gz82x4e', u'root_device_name': None, u'display_name': u'gauthier', u'uuid': u'3cfc6768-d618-4891-b9c2-a08b7ca0910e', u'display_description': u'gauthier', u'key_data': None, u'power_state': 0, u'progress': 0, u'project_id': u'a41b71ec474b4f9da53d0f6c0e044f48', u'metadata': {}, u'ramdisk_id': u'', u'access_ip_v6': None, u'access_ip_v4': None, u'kernel_id': u'', u'key_name': None, u'user_id': u'2d6944752cba4942a17cf25365c14bf3', u'config_drive_id': u'', u'root_gb': 0, u'locked': False, u'launch_index': 0, u'memory_mb': 512, u'vcpus': 1, u'image_ref': u'1f00e541-7a7d-43ab-a4cf-342802f3bca4', u'architecture': None, u'auto_disk_config': None, u'os_type': None, u'config_drive': u''}, u'security_group': [u'default']}, u'is_first_time': True, u'filter_properties': {u'scheduler_hints': {}}, u'topic': u'compute', u'admin_password': '<SANITIZED>', u'injected_files': [], u'requested_networks': None}, u'_context_auth_token': '<SANITIZED>', u'_context_is_admin': True, u'_context_project_id': u'a41b71ec474b4f9da53d0f6c0e044f48', u'_context_timestamp': u'2012-07-12T09:28:00.644495', u'_context_user_id': u'2d6944752cba4942a17cf25365c14bf3', u'method': u'run_instance', u'_context_remote_address': u'172.31.70.87'} from (pid=23457) _safe_log /usr/lib/python2.7/dist-packages/nova/rpc/common.py:160\n2012-07-12 11:28:02 DEBUG nova.rpc.amqp [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] unpacked context: {'user_id': u'2d6944752cba4942a17cf25365c14bf3', 'roles': [u'admin'], 'timestamp': '2012-07-12T09:28:00.644495', 'auth_token': '<SANITIZED>', 'remote_address': u'172.31.70.87', 'is_admin': True, 'request_id': u'req-5f214e16-8af1-4620-a78b-1bfe29498a67', 'project_id': u'a41b71ec474b4f9da53d0f6c0e044f48', 'read_deleted': u'no'} from (pid=23457) _safe_log /usr/lib/python2.7/dist-packages/nova/rpc/common.py:160\n2012-07-12 11:28:02 DEBUG nova.scheduler.filter_scheduler [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Attempting to build 1 instance(s) from (pid=23457) schedule_run_instance /usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py:65\n2012-07-12 11:28:02 DEBUG nova.scheduler.host_manager [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Host filter passes for opstack90 from (pid=23457) passes_filters /usr/lib/python2.7/dist-packages/nova/scheduler/host_manager.py:163\n2012-07-12 11:28:02 DEBUG nova.scheduler.host_manager [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Host filter passes for opstack88 from (pid=23457) passes_filters /usr/lib/python2.7/dist-packages/nova/scheduler/host_manager.py:163\n2012-07-12 11:28:02 DEBUG nova.scheduler.host_manager [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Host filter passes for opstack87 from (pid=23457) passes_filters /usr/lib/python2.7/dist-packages/nova/scheduler/host_manager.py:163\n2012-07-12 11:28:02 DEBUG nova.scheduler.filter_scheduler [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Filtered [host 'opstack90': free_ram_mb:17448 free_disk_mb:22528, host 'opstack88': free_ram_mb:7473 free_disk_mb:67584, host 'opstack87': free_ram_mb:11496 free_disk_mb:151552] from (pid=23457) _schedule /usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py:199\n2012-07-12 11:28:02 DEBUG nova.scheduler.filter_scheduler [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Weighted <nova.scheduler.least_cost.WeightedHost object at 0x39b5fd0> from (pid=23457) _schedule /usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py:209\n2012-07-12 11:28:02 DEBUG nova.rpc.amqp [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Making asynchronous cast on compute.opstack90... from (pid=23457) cast /usr/lib/python2.7/dist-packages/nova/rpc/amqp.py:351\n2012-07-12 11:28:02 DEBUG nova.scheduler.driver [req-5f214e16-8af1-4620-a78b-1bfe29498a67 2d6944752cba4942a17cf25365c14bf3 a41b71ec474b4f9da53d0f6c0e044f48] Casted 'run_instance' to compute 'opstack90' from (pid=23457) cast_to_compute_host /usr/lib/python2.7/dist-packages/nova/scheduler/driver.py:80\n\n\nThe 3 compute nodes passe the filters. The free ram (MB) for each host is :\nopstack87 : 11496\nopstack88 :  7473\nopstack90 : 17448\n\nThe default cost function \"nova.scheduler.least_cost.compute_fill_first_cost_fn\" returns the free ram for each host and this free ram is the corresponding host cost.\nThus, the lowest cost is 7473 (opstack88) and the highest cost is 17448 (opstack90).\nThe host opstack88 must be the winner (according code comments and documentation) because it has the lower cost.\nBut in fact, the winner is opstack90 (see log above) which has the highest cost.\n\nRegards.", 
            "date_created": "2012-07-12 10:06:17.400061+00:00", 
            "author": "https://api.launchpad.net/1.0/~michel-gauthier"
        }, 
        {
            "content": "The default for compute_fill_first_cost_fn_weight is actually -1.0. Did you explicitly set it to 1.0 (which would make this a bug), or leave it at the defaults, which would make this defined behavior?", 
            "date_created": "2012-07-17 17:42:51.537689+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "Sorry, the default for compute_fill_first_cost_fn_weight is actually -1.0 in our installation.\nThus, the result is correct, this is not a bug.\nThe code comments into compute_fill_first_cost_fn (\"\"\"More free ram = higher weight. So servers will less free\n    ram will be preferred.\"\"\") led us into error.\n\nMichel Gauthier", 
            "date_created": "2012-07-18 15:37:08.767249+00:00", 
            "author": "https://api.launchpad.net/1.0/~michel-gauthier"
        }, 
        {
            "content": "Confirmed that it's not a bug, will update code comments to be less confusing.", 
            "date_created": "2012-07-24 18:11:33.959463+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/10240", 
            "date_created": "2012-07-24 18:18:13.078827+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/10240\nCommitted: http://github.com/openstack/nova/commit/c3ff5c5e932509a56bddab625513dc1663b0f1df\nSubmitter: Jenkins\nBranch:    master\n\ncommit c3ff5c5e932509a56bddab625513dc1663b0f1df\nAuthor: Sean Dague <email address hidden>\nDate:   Tue Jul 24 14:14:48 2012 -0400\n\n    update compute_fill_first_cost_fn docstring\n    \n    The default value for weight of the compute_fill_first_cost_fn is\n    actually -1.0, which means it does exactly the opposite of what\n    the function docstring says it does. Update the docstring to\n    warn people of this fact.\n    \n    Issue reported via bug #1023827 which was closed as won't fix\n    but the docs should be clearer. Updated based on feedback.\n    \n    Change-Id: I56acde254c932a8e66f941aaeb7304665500610f\n", 
            "date_created": "2012-07-26 17:43:43.448058+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2012-08-16 07:33:26.653867+00:00"
}