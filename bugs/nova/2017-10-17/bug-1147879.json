{
    "status": "Fix Released", 
    "last_updated": "2013-04-04 11:23:48.254843+00:00", 
    "description": "The problem is sqlalchemy doesn't recognize the type BigInt\n\nStep to reproduce this issue:\n\nRun the unit tests,\n\n$./run_tests.sh api\n\nThen check the logs,\n\n$head -100 subunit.log \ntime: 2013-03-05 21:47:33.002802Z\ntest: nova.tests.api.ec2.test_cinder_cloud.CinderCloudTestCase.test_create_snapshot\ntime: 2013-03-05 21:47:34.087936Z\ntags: worker-1\nsuccessful: nova.tests.api.ec2.test_cinder_cloud.CinderCloudTestCase.test_create_snapshot [ multipart\nContent-Type: text/plain;charset=utf8\npythonlogging:'nova'\n2A1\nLoading network driver 'nova.network.linux_net'\nStarting conductor node (version 2013.1)\nLoading compute driver 'nova.virt.fake.FakeDriver'\nStarting compute node (version 2013.1)\nUpdating host status\nAuditing locally available compute resources\nFree ram (MB): 7680\nFree disk (GB): 1028\nFree VCPUS: 1\nCompute_service record created for 07698146867b4ee98105daf0c0b6a9b3:fake-mini\nStarting scheduler node (version 2013.1)\nLoading network driver 'nova.network.linux_net'\nStarting network node (version 2013.1)\nCreate volume of 1 GB\ncreating volume 2a22fa5a-07d3-4dbc-95d5-704645348577\nCreate snapshot of volume vol-00000001\ndeleting volume 2a22fa5a-07d3-4dbc-95d5-704645348577\n0\nContent-Type: text/plain;charset=utf8\nstderr\nAC5\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'bw_in'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'bw_out'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'last_ctr_in'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'last_ctr_out'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_reads'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_read_bytes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_writes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_write_bytes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_reads'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_read_bytes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_writes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_write_bytes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/sql/expression.py:1927: SAWarning: The IN-predicate on \"instances.uuid\" was invoked with an empty sequence. This results in a contradiction, which nonetheless can be expensive to evaluate.  Consider alternative strategies for improved performance.\n  return self._in_impl(operators.in_op, operators.notin_op, other)\n0\nContent-Type: text/plain;charset=utf8\nstdout\n0\n]\n\n\nThe same problem happens while running tests with other tools like nosetests\n\n$ nosetests\n\nnosetests nova/tests/api/test_auth.py\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'bw_in'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'bw_out'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'last_ctr_in'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'last_ctr_out'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_reads'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_read_bytes'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_writes'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_write_bytes'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_reads'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_read_bytes'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_writes'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_write_bytes'\n  default, primary_key))\n..........\n----------------------------------------------------------------------\nRan 10 tests in 1.493s\n\nOK\n\n\nSince the warnings are in stderr, some editor plugins (like pyunit) to run unit tests in place, are not working.", 
    "tags": [
        "db", 
        "low-hanging-fruit"
    ], 
    "importance": "Low", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1147879", 
    "owner": "https://api.launchpad.net/1.0/~kaushikc", 
    "id": 1147879, 
    "index": 799, 
    "openned": "2013-03-05 22:22:43.715139+00:00", 
    "created": "2013-03-05 22:22:43.715139+00:00", 
    "title": "Use of BIGINT column type affects testing with sqlite", 
    "comments": [
        {
            "content": "The problem is sqlalchemy doesn't recognize the type BigInt\n\nStep to reproduce this issue:\n\nRun the unit tests,\n\n$./run_tests.sh api\n\nThen check the logs,\n\n$head -100 subunit.log \ntime: 2013-03-05 21:47:33.002802Z\ntest: nova.tests.api.ec2.test_cinder_cloud.CinderCloudTestCase.test_create_snapshot\ntime: 2013-03-05 21:47:34.087936Z\ntags: worker-1\nsuccessful: nova.tests.api.ec2.test_cinder_cloud.CinderCloudTestCase.test_create_snapshot [ multipart\nContent-Type: text/plain;charset=utf8\npythonlogging:'nova'\n2A1\nLoading network driver 'nova.network.linux_net'\nStarting conductor node (version 2013.1)\nLoading compute driver 'nova.virt.fake.FakeDriver'\nStarting compute node (version 2013.1)\nUpdating host status\nAuditing locally available compute resources\nFree ram (MB): 7680\nFree disk (GB): 1028\nFree VCPUS: 1\nCompute_service record created for 07698146867b4ee98105daf0c0b6a9b3:fake-mini\nStarting scheduler node (version 2013.1)\nLoading network driver 'nova.network.linux_net'\nStarting network node (version 2013.1)\nCreate volume of 1 GB\ncreating volume 2a22fa5a-07d3-4dbc-95d5-704645348577\nCreate snapshot of volume vol-00000001\ndeleting volume 2a22fa5a-07d3-4dbc-95d5-704645348577\n0\nContent-Type: text/plain;charset=utf8\nstderr\nAC5\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'bw_in'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'bw_out'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'last_ctr_in'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'last_ctr_out'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_reads'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_read_bytes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_writes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_write_bytes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_reads'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_read_bytes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_writes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_write_bytes'\n  default, primary_key))\n/home/kaushikc/code/nova/.venv/local/lib/python2.7/site-packages/sqlalchemy/sql/expression.py:1927: SAWarning: The IN-predicate on \"instances.uuid\" was invoked with an empty sequence. This results in a contradiction, which nonetheless can be expensive to evaluate.  Consider alternative strategies for improved performance.\n  return self._in_impl(operators.in_op, operators.notin_op, other)\n0\nContent-Type: text/plain;charset=utf8\nstdout\n0\n]\n\n\nThe same problem happens while running tests with other tools like nosetests\n\n$ nosetests\n\nnosetests nova/tests/api/test_auth.py\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'bw_in'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'bw_out'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'last_ctr_in'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'last_ctr_out'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_reads'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_read_bytes'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_writes'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'tot_write_bytes'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_reads'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_read_bytes'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_writes'\n  default, primary_key))\n/usr/local/lib/python2.7/dist-packages/sqlalchemy/dialects/sqlite/base.py:723: SAWarning: Did not recognize type 'BIGINT' of column 'curr_write_bytes'\n  default, primary_key))\n..........\n----------------------------------------------------------------------\nRan 10 tests in 1.493s\n\nOK\n\n\nSince the warnings are in stderr, some editor plugins (like pyunit) to run unit tests in place, are not working.", 
            "date_created": "2013-03-05 22:22:43.715139+00:00", 
            "author": "https://api.launchpad.net/1.0/~kaushikc"
        }, 
        {
            "content": " I'm fairly sure that sqla is just converting these to INT  type, which in sqlite can accommodate up to 8 bytes already. I don't think the tests are adversely affected, it's just the warning gives the impression something is wrong when it isn't. This is really an issue in sqla, but it would be nice to not see those warnings all the  time.", 
            "date_created": "2013-03-07 10:19:52.869306+00:00", 
            "author": "https://api.launchpad.net/1.0/~devananda"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/23883", 
            "date_created": "2013-03-08 01:29:04.304161+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/23883\nCommitted: http://github.com/openstack/nova/commit/4ed4c848b66bc5fdd42e05c8b8c726ace2c25704\nSubmitter: Jenkins\nBranch:    master\n\ncommit 4ed4c848b66bc5fdd42e05c8b8c726ace2c25704\nAuthor: Kaushik Chandrashekar <email address hidden>\nDate:   Thu Mar 7 19:17:00 2013 -0600\n\n    Compile BigInteger to INTEGER for sqlite\n    \n    Ensure BigInteger does not map to BIGINT for an auto-created\n    sqlite registry DB, as this type is not supported by sqlite.\n    \n    Refactoring a test to use generic unsupported column type\n    \n    Fixes bug 1147879\n    \n    Change-Id: I590c798dd470def286802bc6e00bb4b621332b8d\n", 
            "date_created": "2013-03-12 21:58:47.667353+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-03-20 16:16:03.831631+00:00"
}