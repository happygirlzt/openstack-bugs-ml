{
    "status": "Invalid", 
    "last_updated": "2016-03-29 09:14:51.953946+00:00", 
    "description": "Migration an in-use volume from lvm to ceph failed:\n\n2016-03-22 17:28:38.610 28985 ERROR oslo_messaging.rpc.dispatcher [req-f35c694e-3d7e-42c2-9135-691b36e84eaa 5650304261d74dbe8a4f7848661f95a6 55bbe36a87af48c0af04c9204a49a854 - - -] Exception during message handling: Swap only supports host devices\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     executor_callback))\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     executor_callback)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 8840, in swap_volume\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     new_volume_id)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     payload)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 379, in decorated_function\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     LOG.warning(msg, e, instance_uuid=instance_uuid)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 350, in decorated_function\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 407, in decorated_function\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 395, in decorated_function\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 6010, in swap_volume\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     new_volume_id)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5969, in _swap_volume\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     self.volume_api.unreserve_volume(context, new_volume_id)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5950, in _swap_volume\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     resize_to)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1233, in swap_volume\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     \n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher NotImplementedError: Swap only supports host devices\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher", 
    "tags": [
        "ceph", 
        "live-migration", 
        "needs-attention"
    ], 
    "importance": "Undecided", 
    "heat": 12, 
    "link": "https://bugs.launchpad.net/nova/+bug/1560469", 
    "owner": "None", 
    "id": 1560469, 
    "index": 7383, 
    "openned": "2016-03-22 12:26:25.966936+00:00", 
    "created": "2016-03-22 12:26:25.966936+00:00", 
    "title": "Migration in-use volume from lvm to ceph failed", 
    "comments": [
        {
            "content": "Migration an in-use volume from lvm to ceph failed:\n\n2016-03-22 17:28:38.610 28985 ERROR oslo_messaging.rpc.dispatcher [req-f35c694e-3d7e-42c2-9135-691b36e84eaa 5650304261d74dbe8a4f7848661f95a6 55bbe36a87af48c0af04c9204a49a854 - - -] Exception during message handling: Swap only supports host devices\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     executor_callback))\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     executor_callback)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 8840, in swap_volume\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     new_volume_id)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 88, in wrapped\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     payload)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/exception.py\", line 71, in wrapped\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 379, in decorated_function\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     LOG.warning(msg, e, instance_uuid=instance_uuid)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 350, in decorated_function\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 407, in decorated_function\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 395, in decorated_function\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 6010, in swap_volume\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     new_volume_id)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5969, in _swap_volume\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     self.volume_api.unreserve_volume(context, new_volume_id)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 5950, in _swap_volume\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     resize_to)\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1233, in swap_volume\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher     \n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher NotImplementedError: Swap only supports host devices\n2016-03-22 17:28:38.610 28985 TRACE oslo_messaging.rpc.dispatcher", 
            "date_created": "2016-03-22 12:26:25.966936+00:00", 
            "author": "https://api.launchpad.net/1.0/~gu-weiwei"
        }, 
        {
            "content": "Yes, this fails, as mentioned in Jon Bernard's patch ( https://review.openstack.org/#/c/187270/24//COMMIT_MSG ) but this is not a Cinder bug, the problem lies on the nova side of things.", 
            "date_created": "2016-03-23 10:42:49.573970+00:00", 
            "author": "https://api.launchpad.net/1.0/~gorka"
        }, 
        {
            "content": "I don't have an environment where I can attempt to reproduce this, it would be great if someone who knows more could take a look.", 
            "date_created": "2016-03-25 18:15:24.695432+00:00", 
            "author": "https://api.launchpad.net/1.0/~auggy"
        }, 
        {
            "content": "Not sure it's a bug ? Is it rather something that we don't support yet ?", 
            "date_created": "2016-03-29 09:00:54.737036+00:00", 
            "author": "https://api.launchpad.net/1.0/~sylvain-bauza"
        }, 
        {
            "content": "Okay, I think I understand better now the problem. So, thanks to https://review.openstack.org/#/c/187270/ we now have a better way to handle fd-based \"attachments\" but that leaves some cases (basically in-use volumes to Ceph) unresolved.\n\nReally not sure it's a bug, it's for the moment a known limitation that can be workarounded by detaching the volume and attaching again. Resolving that seems involving more than just a piece of Nova code and should probably be discussed with the os-brick maintainers.\n\nFor the moment, tagging the bug report as Invalid, but I'm all up for discussing that with more oriented Cinder folks to see how we could move forward. If that's more than just a bugfix, it should be at least discussed in a blueprint IMHO.\n\n", 
            "date_created": "2016-03-29 09:14:39.681903+00:00", 
            "author": "https://api.launchpad.net/1.0/~sylvain-bauza"
        }
    ], 
    "closed": "2016-03-29 09:01:03.459375+00:00"
}