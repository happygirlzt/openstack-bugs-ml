{
    "status": "Fix Released", 
    "last_updated": "2012-04-05 09:48:30.937985+00:00", 
    "description": "Using the latest nova Essex builds I'm getting errors when trying to perform a revert resize operation.\n\nThis results in the revert resize operation failing. The instance is then in an unsusable state and is un-pingable, etc.\n\nThe following stack trace shows up in the nova-compute log for the host machine the instance was migrated to:\n\n2011-12-06 11:04:05,552 ERROR nova.rpc [-] Exception during message handling\n(nova.rpc): TRACE: Traceback (most recent call last):\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/impl_kombu.py\", line 620, in _process_data\n(nova.rpc): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 115, in wrapped\n(nova.rpc): TRACE:     return f(*args, **kw)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 116, in decorated_function\n(nova.rpc): TRACE:     function(self, context, instance_uuid, *args, **kwargs)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1005, in finish_revert_resize\n(nova.rpc): TRACE:     self.driver.finish_revert_migration(instance_ref)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi_conn.py\", line 209, in finish_revert_migration\n(nova.rpc): TRACE:     self._vmops.finish_revert_migration(instance)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 140, in finish_revert_migration\n(nova.rpc): TRACE:     VMHelper.set_vm_name_label(self._session, vm_ref, name_label)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vm_utils.py\", line 786, in set_vm_name_label\n(nova.rpc): TRACE:     session.call_xenapi(\"VM.set_name_label\", vm_ref, name_label)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi_conn.py\", line 493, in call_xenapi\n(nova.rpc): TRACE:     return tpool.execute(f, *args)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 76, in tworker\n(nova.rpc): TRACE:     rv = meth(*args,**kwargs)\n(nova.rpc): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/XenAPI.py\", line 229, in __call__\n(nova.rpc): TRACE:     return self.__send(self.__name, args)\n(nova.rpc): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/XenAPI.py\", line 133, in xenapi_request\n(nova.rpc): TRACE:     result = _parse_result(getattr(self, methodname)(*full_params))\n(nova.rpc): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/XenAPI.py\", line 203, in _parse_result\n(nova.rpc): TRACE:     raise Failure(result['ErrorDescription'])\n(nova.rpc): TRACE: Failure: ['FIELD_TYPE_ERROR', 'self']\n(nova.rpc): TRACE:", 
    "tags": [], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/900849", 
    "owner": "https://api.launchpad.net/1.0/~dan-prince", 
    "id": 900849, 
    "index": 534, 
    "openned": "2011-12-06 17:09:15.525342+00:00", 
    "created": "2011-12-06 17:09:15.525342+00:00", 
    "title": "revert resize fails with Failure: ['FIELD_TYPE_ERROR', 'self']", 
    "comments": [
        {
            "content": "Using the latest nova Essex builds I'm getting errors when trying to perform a revert resize operation.\n\nThis results in the revert resize operation failing. The instance is then in an unsusable state and is un-pingable, etc.\n\nThe following stack trace shows up in the nova-compute log for the host machine the instance was migrated to:\n\n2011-12-06 11:04:05,552 ERROR nova.rpc [-] Exception during message handling\n(nova.rpc): TRACE: Traceback (most recent call last):\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/rpc/impl_kombu.py\", line 620, in _process_data\n(nova.rpc): TRACE:     rval = node_func(context=ctxt, **node_args)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 115, in wrapped\n(nova.rpc): TRACE:     return f(*args, **kw)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 116, in decorated_function\n(nova.rpc): TRACE:     function(self, context, instance_uuid, *args, **kwargs)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1005, in finish_revert_resize\n(nova.rpc): TRACE:     self.driver.finish_revert_migration(instance_ref)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi_conn.py\", line 209, in finish_revert_migration\n(nova.rpc): TRACE:     self._vmops.finish_revert_migration(instance)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vmops.py\", line 140, in finish_revert_migration\n(nova.rpc): TRACE:     VMHelper.set_vm_name_label(self._session, vm_ref, name_label)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi/vm_utils.py\", line 786, in set_vm_name_label\n(nova.rpc): TRACE:     session.call_xenapi(\"VM.set_name_label\", vm_ref, name_label)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/nova/virt/xenapi_conn.py\", line 493, in call_xenapi\n(nova.rpc): TRACE:     return tpool.execute(f, *args)\n(nova.rpc): TRACE:   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 76, in tworker\n(nova.rpc): TRACE:     rv = meth(*args,**kwargs)\n(nova.rpc): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/XenAPI.py\", line 229, in __call__\n(nova.rpc): TRACE:     return self.__send(self.__name, args)\n(nova.rpc): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/XenAPI.py\", line 133, in xenapi_request\n(nova.rpc): TRACE:     result = _parse_result(getattr(self, methodname)(*full_params))\n(nova.rpc): TRACE:   File \"/usr/local/lib/python2.7/dist-packages/XenAPI.py\", line 203, in _parse_result\n(nova.rpc): TRACE:     raise Failure(result['ErrorDescription'])\n(nova.rpc): TRACE: Failure: ['FIELD_TYPE_ERROR', 'self']\n(nova.rpc): TRACE:", 
            "date_created": "2011-12-06 17:09:15.525342+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/2108\nCommitted: http://github.com/openstack/nova/commit/882b1e475de1ef71d7d3f0b50a58f91569905a75\nSubmitter: Jenkins\nBranch:    master\n\n status fixcommitted\n done\n\ncommit 882b1e475de1ef71d7d3f0b50a58f91569905a75\nAuthor: Dan Prince <email address hidden>\nDate:   Tue Dec 6 13:49:51 2011 -0500\n\n    Update compute manager so that finish_revert_resize runs on the source\n    compute host. Fixes bug #900849.\n    \n    Change-Id: I838604a5c623a3970ce36cdb3d12279812eb8401\n", 
            "date_created": "2011-12-06 19:14:04+00:00", 
            "author": "https://api.launchpad.net/1.0/~openstack-gerrit"
        }
    ], 
    "closed": "2011-12-14 09:54:02.342400+00:00"
}