{
    "status": "Fix Released", 
    "last_updated": "2016-01-25 14:31:35.412343+00:00", 
    "description": "Ran into this problem in check-tempest-devstack-vm-neutron\n\n Traceback (most recent call last):\n   File \"tempest/scenario/test_snapshot_pattern.py\", line 74, in test_snapshot_pattern\n     self._set_floating_ip_to_server(server, fip_for_server)\n   File \"tempest/scenario/test_snapshot_pattern.py\", line 62, in _set_floating_ip_to_server\n     server.add_floating_ip(floating_ip)\n   File \"/opt/stack/new/python-novaclient/novaclient/v1_1/servers.py\", line 108, in add_floating_ip\n     self.manager.add_floating_ip(self, address, fixed_address)\n   File \"/opt/stack/new/python-novaclient/novaclient/v1_1/servers.py\", line 465, in add_floating_ip\n     self._action('addFloatingIp', server, {'address': address})\n   File \"/opt/stack/new/python-novaclient/novaclient/v1_1/servers.py\", line 993, in _action\n     return self.api.client.post(url, body=body)\n   File \"/opt/stack/new/python-novaclient/novaclient/client.py\", line 234, in post\n     return self._cs_request(url, 'POST', **kwargs)\n   File \"/opt/stack/new/python-novaclient/novaclient/client.py\", line 213, in _cs_request\n     **kwargs)\n   File \"/opt/stack/new/python-novaclient/novaclient/client.py\", line 195, in _time_request\n     resp, body = self.request(url, method, **kwargs)\n   File \"/opt/stack/new/python-novaclient/novaclient/client.py\", line 189, in request\n     raise exceptions.from_response(resp, body, url, method)\n BadRequest: No nw_info cache associated with instance (HTTP 400) (Request-ID: req-9fea0363-4532-4ad1-af89-114cff68bd89)\n\nFull console logs here: http://logs.openstack.org/27/55327/3/check/check-tempest-devstack-vm-neutron/8d26d3c/console.html", 
    "tags": [
        "in-stable-kilo", 
        "kilo-backport-potential", 
        "network"
    ], 
    "importance": "Medium", 
    "heat": 160, 
    "link": "https://bugs.launchpad.net/nova/+bug/1249065", 
    "owner": "https://api.launchpad.net/1.0/~mriedem", 
    "id": 1249065, 
    "index": 3693, 
    "openned": "2013-11-07 19:11:02.519810+00:00", 
    "created": "2013-11-07 19:11:02.519810+00:00", 
    "title": "Nova throws 400 when attempting to add floating ip (instance.info_cache.network_info is empty)", 
    "comments": [
        {
            "content": "Ran into this problem in check-tempest-devstack-vm-neutron\n\n2013-11-07 17:57:43.563 | \n2013-11-07 17:57:43.563 | Traceback (most recent call last):\n2013-11-07 17:57:43.563 |   File \"tempest/scenario/test_snapshot_pattern.py\", line 74, in test_snapshot_pattern\n2013-11-07 17:57:43.563 |     self._set_floating_ip_to_server(server, fip_for_server)\n2013-11-07 17:57:43.563 |   File \"tempest/scenario/test_snapshot_pattern.py\", line 62, in _set_floating_ip_to_server\n2013-11-07 17:57:43.564 |     server.add_floating_ip(floating_ip)\n2013-11-07 17:57:43.564 |   File \"/opt/stack/new/python-novaclient/novaclient/v1_1/servers.py\", line 108, in add_floating_ip\n2013-11-07 17:57:43.564 |     self.manager.add_floating_ip(self, address, fixed_address)\n2013-11-07 17:57:43.564 |   File \"/opt/stack/new/python-novaclient/novaclient/v1_1/servers.py\", line 465, in add_floating_ip\n2013-11-07 17:57:43.564 |     self._action('addFloatingIp', server, {'address': address})\n2013-11-07 17:57:43.564 |   File \"/opt/stack/new/python-novaclient/novaclient/v1_1/servers.py\", line 993, in _action\n2013-11-07 17:57:43.565 |     return self.api.client.post(url, body=body)\n2013-11-07 17:57:43.565 |   File \"/opt/stack/new/python-novaclient/novaclient/client.py\", line 234, in post\n2013-11-07 17:57:43.565 |     return self._cs_request(url, 'POST', **kwargs)\n2013-11-07 17:57:43.565 |   File \"/opt/stack/new/python-novaclient/novaclient/client.py\", line 213, in _cs_request\n2013-11-07 17:57:43.565 |     **kwargs)\n2013-11-07 17:57:43.565 |   File \"/opt/stack/new/python-novaclient/novaclient/client.py\", line 195, in _time_request\n2013-11-07 17:57:43.566 |     resp, body = self.request(url, method, **kwargs)\n2013-11-07 17:57:43.566 |   File \"/opt/stack/new/python-novaclient/novaclient/client.py\", line 189, in request\n2013-11-07 17:57:43.566 |     raise exceptions.from_response(resp, body, url, method)\n2013-11-07 17:57:43.566 | BadRequest: No nw_info cache associated with instance (HTTP 400) (Request-ID: req-9fea0363-4532-4ad1-af89-114cff68bd89)\n\nFull console logs here: http://logs.openstack.org/27/55327/3/check/check-tempest-devstack-vm-neutron/8d26d3c/console.html", 
            "date_created": "2013-11-07 19:11:02.519810+00:00", 
            "author": "https://api.launchpad.net/1.0/~luisg-8"
        }, 
        {
            "content": "Ran into another stack trace in the same test case:\n\n2013-11-11 18:44:12.913 | Traceback (most recent call last):\n2013-11-11 18:44:12.914 |   File \"tempest/scenario/test_snapshot_pattern.py\", line 90, in test_snapshot_pattern\n2013-11-11 18:44:12.914 |     self._check_timestamp(fip_for_snapshot.ip)\n2013-11-11 18:44:12.914 |   File \"tempest/scenario/test_snapshot_pattern.py\", line 52, in _check_timestamp\n2013-11-11 18:44:12.915 |     ssh_client = self._ssh_to_server(server_or_ip)\n2013-11-11 18:44:12.915 |   File \"tempest/scenario/test_snapshot_pattern.py\", line 43, in _ssh_to_server\n2013-11-11 18:44:12.915 |     linux_client = self.get_remote_client(server_or_ip)\n2013-11-11 18:44:12.915 |   File \"tempest/scenario/manager.py\", line 466, in get_remote_client\n2013-11-11 18:44:12.916 |     return RemoteClient(ip, username, pkey=private_key)\n2013-11-11 18:44:12.916 |   File \"tempest/common/utils/linux/remote_client.py\", line 47, in __init__\n2013-11-11 18:44:12.917 |     if not self.ssh_client.test_connection_auth():\n2013-11-11 18:44:12.917 |   File \"tempest/common/ssh.py\", line 148, in test_connection_auth\n2013-11-11 18:44:12.918 |     connection = self._get_ssh_connection()\n2013-11-11 18:44:12.918 |   File \"tempest/common/ssh.py\", line 76, in _get_ssh_connection\n2013-11-11 18:44:12.918 |     password=self.password)\n2013-11-11 18:44:12.918 | SSHTimeout: Connection to the 172.24.4.229 via SSH timed out.\n2013-11-11 18:44:12.919 | User: cirros, Password: None", 
            "date_created": "2013-11-11 23:29:04.942627+00:00", 
            "author": "https://api.launchpad.net/1.0/~luisg-8"
        }, 
        {
            "content": "logstash query: filename:\"logs/screen-n-api.txt\" AND message:\"No nw_info cache associated with instance\"", 
            "date_created": "2013-11-13 02:46:39.084676+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "This only happens when using neutron", 
            "date_created": "2013-11-14 23:05:11.709515+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "This can be an issue within nova/network/neutronv2/api.py\n\nI'll take this on myself for traging.", 
            "date_created": "2013-11-15 11:43:11.428122+00:00", 
            "author": "https://api.launchpad.net/1.0/~salvatore-orlando"
        }, 
        {
            "content": "http://logstash.openstack.org/#eyJmaWVsZHMiOiBbXSwgInNlYXJjaCI6ICJtZXNzYWdlOlwiTm8gbndfaW5mbyBjYWNoZSBhc3NvY2lhdGVkIHdpdGggaW5zdGFuY2VcIiBBTkQgZmlsZW5hbWU6XCJsb2dzL3NjcmVlbi1uLWFwaS50eHRcIlxuIiwgInRpbWVmcmFtZSI6ICI2MDQ4MDAiLCAiZ3JhcGhtb2RlIjogImNvdW50IiwgIm9mZnNldCI6IDB9", 
            "date_created": "2013-11-18 20:35:06.890602+00:00", 
            "author": "https://api.launchpad.net/1.0/~anteaya"
        }, 
        {
            "content": "This is caused by the cache not being updated here: http://codepad.org/RhoXf936 ", 
            "date_created": "2013-11-21 15:30:47.184933+00:00", 
            "author": "https://api.launchpad.net/1.0/~arosen"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/57711", 
            "date_created": "2013-11-21 16:23:29.543215+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/57921", 
            "date_created": "2013-11-22 13:40:51.049249+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Setting to critical because this is destabilizing the gate", 
            "date_created": "2013-11-23 01:10:46.201845+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "https://review.openstack.org/#/c/57711/ is still open for review/approval, 57921 has been abandoned.", 
            "date_created": "2013-11-24 21:04:49.982603+00:00", 
            "author": "https://api.launchpad.net/1.0/~anteaya"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/57711\nCommitted: http://github.com/openstack/nova/commit/4c03383f21bc13caf3fed4db5aa1317d37758d5c\nSubmitter: Jenkins\nBranch:    master\n\ncommit 4c03383f21bc13caf3fed4db5aa1317d37758d5c\nAuthor: Aaron Rosen <email address hidden>\nDate:   Thu Nov 21 07:57:44 2013 -0800\n\n    Do not hide exception in update_instance_cache_with_nw_info\n    \n    From time to time an exception is raised in this method causing\n    the nw_info cache not to be saved. If this occurs we should raise\n    as this error will cause later errors to occur. For example, one\n    won't be able to associate a floatingip with the instance as there\n    is no nw_info found in this table. In addition, the fixed_ips on\n    the instance won't be returned via the api.\n    \n    This patch also stubs out update_instance_cache_with_nw_info in a\n    few tests where an exception was being raised previously but went\n    unnoticed as it was not reraised but now is.\n    \n    Related-Bug: #1252849\n    Related-Bug: #1249065\n    \n    Change-Id: Ic860f72210ba736e11c10df21c4cb7625e9c0928\n", 
            "date_created": "2013-11-26 21:12:16.829505+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "SSH timeout from comment 1 is tracked in bug 1249116", 
            "date_created": "2013-12-12 19:32:27.799735+00:00", 
            "author": "https://api.launchpad.net/1.0/~apevec"
        }, 
        {
            "content": "test_rescued_vm_associate_dissociate_floating_ip test case also triggers this issue.\n", 
            "date_created": "2014-02-01 20:36:22.972473+00:00", 
            "author": "https://api.launchpad.net/1.0/~afazekas"
        }, 
        {
            "content": "only 4 hits in last 14 days,  dropping down from critical status.", 
            "date_created": "2014-02-11 23:17:35.887599+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "http://logs.openstack.org/06/62206/3/gate/gate-tempest-dsvm-neutron-pg-isolated/68fc504/console.html\n\nI think we're missing backprots to stable.", 
            "date_created": "2014-02-12 17:43:28.427519+00:00", 
            "author": "https://api.launchpad.net/1.0/~fungi"
        }, 
        {
            "content": "Whoops here's the backport that I believe fixes this issue: https://review.openstack.org/73202", 
            "date_created": "2014-02-13 08:49:03.500647+00:00", 
            "author": "https://api.launchpad.net/1.0/~arosen"
        }, 
        {
            "content": "Related fix proposed to branch: stable/havana\nReview: https://review.openstack.org/73202", 
            "date_created": "2014-02-13 08:49:04.643931+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Re-adding neutron as this only happens in nova+neutron.  If this is really just a nova being silly problem please feel free to mark as invalid/remove neutron", 
            "date_created": "2014-03-13 23:43:20.821583+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/80427", 
            "date_created": "2014-03-14 00:16:27.267055+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/80427\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=a798282be785a673ef200063ba114c91b9cad683\nSubmitter: Jenkins\nBranch:    master\n\ncommit a798282be785a673ef200063ba114c91b9cad683\nAuthor: Dan Smith <email address hidden>\nDate:   Thu Mar 13 17:14:53 2014 -0700\n\n    Make sure instance saves network_info when we go ACTIVE\n    \n    This makes sure that when we do a save() on our instance during\n    creation, that we don't save the empty network_info we created\n    earlier over a potentially-full one built during the process.\n    This may happen since we wrap the networkinfo in the async helper.\n    This also moves the network_info.wait() out from under a conditional\n    which could cover up other issues leading to a case where it is\n    None (which shouldn't be possible). If we didn't call wait(),\n    then saving it wouldn't be productive or correct.\n    \n    Change-Id: I9bd8dd0dce9e17cd128c7495acd52aa82119c57c\n    Related-bug: 1249065\n", 
            "date_created": "2014-03-17 20:43:25.688092+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/73202\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=53acc09fb9b3ffe7c69bdc484c8cf56032182e28\nSubmitter: Jenkins\nBranch:    stable/havana\n\ncommit 53acc09fb9b3ffe7c69bdc484c8cf56032182e28\nAuthor: Aaron Rosen <email address hidden>\nDate:   Thu Nov 21 07:57:44 2013 -0800\n\n    Do not hide exception in update_instance_cache_with_nw_info\n    \n    From time to time an exception is raised in this method causing\n    the nw_info cache not to be saved. If this occurs we should raise\n    as this error will cause later errors to occur. For example, one\n    won't be able to associate a floatingip with the instance as there\n    is no nw_info found in this table. In addition, the fixed_ips on\n    the instance won't be returned via the api.\n    \n    This patch also stubs out update_instance_cache_with_nw_info in a\n    few tests where an exception was being raised previously but went\n    unnoticed as it was not reraised but now is.\n    \n    Related-Bug: #1252849\n    Related-Bug: #1249065\n    \n    Change-Id: Ic860f72210ba736e11c10df21c4cb7625e9c0928\n    (cherry picked from commit 4c03383f21bc13caf3fed4db5aa1317d37758d5c)\n", 
            "date_created": "2014-03-25 00:50:51.399629+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Looks like neutron can be removed from the bug as everything seem to be fixed on nova side", 
            "date_created": "2014-06-08 07:27:00.478543+00:00", 
            "author": "https://api.launchpad.net/1.0/~enikanorov"
        }, 
        {
            "content": "Hello Support,\n\nI have the same issue while associating a IP address to a instance.\n\ncould you please provide what is the fix. its quite urgent that i am stuck ..\n\ni have followed the link http://docs.openstack.org/icehouse/install-guide/install/zypper/content/launch-instance-neutron.html\n to install openstack icehouse with nova ...can you help .\n\nBR.\nRushi.", 
            "date_created": "2014-12-19 23:45:27.767105+00:00", 
            "author": "https://api.launchpad.net/1.0/~murthy-nsm"
        }, 
        {
            "content": "2015-01-19 14:44:56.738 DEBUG nova.api.openstack.wsgi [req-e07c9571-e408-4cb0-b17f-74da537029c0 TestSnapshotPattern-1814883997 TestSnapshotPattern-1557289366] Returning 400 to user: No nw_info cache associated with instance __call__ /opt/stack/new/nova/nova/api/openstack/wsgi.py:1159\n\nI saw the above message in nova-network setup with the master branch installed at '2015-01-16 03:17:09.406'.\nThe Log does not have stack trace.\nI do not see similar message with nova-network in the past week on logstash.", 
            "date_created": "2015-01-19 15:19:11.352089+00:00", 
            "author": "https://api.launchpad.net/1.0/~afazekas"
        }, 
        {
            "content": "I'm hitting this too, intermittently, on Icehouse\n\n/var/log/nova/nova-api.log:2015-02-23 14:51:05.866 5072 INFO nova.api.openstack.wsgi [req-bccfea1b-1bba-4e79-ab11-2906d9cd0b8a b3c2566d88a44dc0948c569147e861a2 f88f2cc107914b90a86820252a71c270] HTTP exception thrown: No nw_info cache associated with instance\n", 
            "date_created": "2015-02-23 20:00:16.818181+00:00", 
            "author": "https://api.launchpad.net/1.0/~george-iii-silvis"
        }, 
        {
            "content": "Just hit this bug as well with Icehouse:\n\nException: 400 Bad Request No nw_info cache associated with instance\n", 
            "date_created": "2015-04-03 03:26:42.506349+00:00", 
            "author": "https://api.launchpad.net/1.0/~fifieldt"
        }, 
        {
            "content": "This is still happening in the gate apparently:\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiTm8gbndfaW5mbyBjYWNoZSBhc3NvY2lhdGVkIHdpdGggaW5zdGFuY2VcIiBBTkQgdGFnczpcInNjcmVlbi1uLWFwaS50eHRcIiIsImZpZWxkcyI6W10sIm9mZnNldCI6MCwidGltZWZyYW1lIjoiNjA0ODAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTQyODQzODY3NDE2NCwibW9kZSI6IiIsImFuYWx5emVfZmllbGQiOiIifQ==", 
            "date_created": "2015-04-07 20:32:23.919713+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/171390", 
            "date_created": "2015-04-07 21:29:52.769795+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/171391", 
            "date_created": "2015-04-07 21:29:59.492353+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "I dig into this case http://logs.openstack.org/18/170118/5/check/check-tempest-dsvm-multinode-full/5f871c2/logs/screen-n-net.txt.gz#_2015-04-24_09_30_55_207\n\nI think there is race between allocate fixed ip for instance and the dhcpbridge script.\n\nThe fixed ip allocation begin from here\n\n2015-04-24 09:30:55.055 DEBUG nova.network.manager [req-543f9791-de80-40e3-90af-90a8ff30bb40 TestShelveInstance-2072004359 TestShelveInstance-310454229] [instance: c0d42ce0-c38d-4ed3-ad05-352c57ae96e5] Networks retrieved for instance: |[{'bridge': u'br100', 'multi_host': True, 'should_create_bridge': True, 'bridge_interface': u'br_flat', 'tenant_id': None, 'label': u'private', 'id': 'f17001ac-a843-4bc3-923f-44f9800f7aaf'}]| allocate_for_instance /opt/stack/new/nova/nova/network/manager.py:486\n\n\nAnd end at here:\n2015-04-24 09:30:55.396 DEBUG nova.network.manager [req-543f9791-de80-40e3-90af-90a8ff30bb40 TestShelveInstance-2072004359 TestShelveInstance-310454229] Built network info: |[]| get_instance_nw_info /opt/stack/new/nova/nova/network/manager.py:650\n\nThe end show the network info is empty. But there isn't any error at here. So the problem is the fixed ip allocated, but at the end it's disapeared.\n\nAnd there is log between the beginning and the end:\n2015-04-24 09:30:55.207 DEBUG nova.network.manager [req-36fe2852-902d-48b0-935f-f75f7ca68b37 None None] Released IP |10.1.0.7| release_fixed_ip \n\nThis 'release_fixed_ip' is only can be triggered by dhcpbridge script\nhttps://github.com/openstack/nova/blob/master/nova/cmd/dhcpbridge.py#L67\n\nThe dhcpbridge script will called by dnsmasq.\n\nSo the thing is when the middle of allocated ip, the dhcpbridge release same ip which used by previous instance at same time.\n", 
            "date_created": "2015-04-26 06:08:56.512678+00:00", 
            "author": "https://api.launchpad.net/1.0/~xuhj"
        }, 
        {
            "content": "There is a log above: \n\n2015-04-24 09:30:50.695 WARNING nova.network.manager [req-946bbdde-ecbd-4a32-9bd8-454d947d0ccf None None] IP |10.1.0.7| leased that isn't allocated\n\nseems we didn't check whether it's allocated = True in the release function of dhcp_release?", 
            "date_created": "2015-04-27 15:41:26.740397+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }, 
        {
            "content": "OK, that might explain the problem in nova-network, but this also shows up in neutron jobs:\n\nhttp://goo.gl/Dk6iXS\n\nhttp://logs.openstack.org/14/173114/5/check/check-tempest-dsvm-neutron-full/e903e8f/logs/screen-n-api.txt.gz#_2015-04-21_00_40_59_830", 
            "date_created": "2015-04-28 18:05:34.238418+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "jichenjc:\n\nmessage:\"leased that isn't allocated\" AND tags:\"screen-n-net.txt\"\n\nhappens quite a lot actually:\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwibGVhc2VkIHRoYXQgaXNuJ3QgYWxsb2NhdGVkXCIgQU5EIHRhZ3M6XCJzY3JlZW4tbi1uZXQudHh0XCIiLCJmaWVsZHMiOltdLCJvZmZzZXQiOjAsInRpbWVmcmFtZSI6IjYwNDgwMCIsImdyYXBobW9kZSI6ImNvdW50IiwidGltZSI6eyJ1c2VyX2ludGVydmFsIjowfSwic3RhbXAiOjE0MzAyNDcyODUyMDgsIm1vZGUiOiIiLCJhbmFseXplX2ZpZWxkIjoiIn0=\n\n2210 hits in 7 days, 88% successful runs though.", 
            "date_created": "2015-04-28 18:56:33.591238+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Similar with:\n\nmessage:\"released that was not leased\" AND tags:\"screen-n-net.txt\"\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwicmVsZWFzZWQgdGhhdCB3YXMgbm90IGxlYXNlZFwiIEFORCB0YWdzOlwic2NyZWVuLW4tbmV0LnR4dFwiIiwiZmllbGRzIjpbXSwib2Zmc2V0IjowLCJ0aW1lZnJhbWUiOiI2MDQ4MDAiLCJncmFwaG1vZGUiOiJjb3VudCIsInRpbWUiOnsidXNlcl9pbnRlcnZhbCI6MH0sInN0YW1wIjoxNDMwMjQ3NDA3ODI4LCJtb2RlIjoiIiwiYW5hbHl6ZV9maWVsZCI6IiJ9\n\n4021 hits in 7 days, 86% successful runs though.", 
            "date_created": "2015-04-28 18:58:09.900040+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "ok, then this 'WARNING' is really confusing ... \nsame IP was released right above the log which contains error info as Alex said\nand it's a warning ,so I thought it might be related..\n\nlet me read more about logs you added from #32", 
            "date_created": "2015-04-28 19:11:20.947545+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/181035\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=c13f42e36cddd820b475ffecf1f3a9e894d0cc04\nSubmitter: Jenkins\nBranch:    master\n\ncommit c13f42e36cddd820b475ffecf1f3a9e894d0cc04\nAuthor: Dan Smith <email address hidden>\nDate:   Thu May 7 08:42:49 2015 -0700\n\n    Log the actual instance.info_cache when empty in floating ip associate\n    \n    This attempts to add some enlightenment to the case where we try to\n    associate a floating ip for an instance and hit the case where there\n    is no info_cache. We need to know if it's actually None, or empty.\n    \n    Related-Bug: #1249065\n    \n    Change-Id: Ic0051d1d520f800d845b7006b5b95be5d8edf7c9\n", 
            "date_created": "2015-05-08 15:36:50.393433+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Got 1 hit in 7 days with the new logging:\n\nhttp://logs.openstack.org/69/190169/3/check/check-tempest-dsvm-full-glusterfs-nv/eecdc4e/logs/screen-n-api.txt.gz#_2015-06-11_14_40_45_576\n\nThe instance.info_cache is not None, but it's network_info attribute is empty:\n\n2015-06-11 14:40:45.576 WARNING nova.api.openstack.compute.contrib.floating_ips [req-b21b23d2-fc5b-4520-84e8-596f994f7873 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Info cache is InstanceInfoCache(created_at=2015-06-11T14:39:49Z,deleted=False,deleted_at=None,instance_uuid=a12ee0d4-5747-4e40-9d22-d956afcbe490,network_info=NetworkModel(),updated_at=None) during associate", 
            "date_created": "2015-06-16 16:28:20.299291+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Change abandoned by Matt Riedemann (<email address hidden>) on branch: master\nReview: https://review.openstack.org/171391\nReason: The instance.info_cache is not None, but the network_info attribute inside it is empty:\n\nhttp://logs.openstack.org/69/190169/3/check/check-tempest-dsvm-full-glusterfs-nv/eecdc4e/logs/screen-n-api.txt.gz#_2015-06-11_14_40_45_576\n\nThe instance.info_cache is not None, but it's network_info attribute is empty:\n\n2015-06-11 14:40:45.576 WARNING nova.api.openstack.compute.contrib.floating_ips [req-b21b23d2-fc5b-4520-84e8-596f994f7873 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Info cache is InstanceInfoCache(created_at=2015-06-11T14:39:49Z,deleted=False,deleted_at=None,instance_uuid=a12ee0d4-5747-4e40-9d22-d956afcbe490,network_info=NetworkModel(),updated_at=None) during associate", 
            "date_created": "2015-06-16 16:30:52.386843+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Matt Riedemann (<email address hidden>) on branch: master\nReview: https://review.openstack.org/171390\nReason: The instance.info_cache is not None, but the network_info attribute inside it is empty:\nhttp://logs.openstack.org/69/190169/3/check/check-tempest-dsvm-full-glusterfs-nv/eecdc4e/logs/screen-n-api.txt.gz#_2015-06-11_14_40_45_576\nThe instance.info_cache is not None, but it's network_info attribute is empty:\n2015-06-11 14:40:45.576 WARNING nova.api.openstack.compute.contrib.floating_ips [req-b21b23d2-fc5b-4520-84e8-596f994f7873 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Info cache is InstanceInfoCache(created_at=2015-06-11T14:39:49Z,deleted=False,deleted_at=None,instance_uuid=a12ee0d4-5747-4e40-9d22-d956afcbe490,network_info=NetworkModel(),updated_at=None) during associate", 
            "date_created": "2015-06-16 16:31:02.545111+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "I see this in the compute logs for the instance that failed:\n\nhttp://logs.openstack.org/69/190169/3/check/check-tempest-dsvm-full-glusterfs-nv/eecdc4e/logs/screen-n-cpu.txt.gz#_2015-06-11_14_39_50_212\n\n2015-06-11 14:39:50.212 INFO nova.virt.libvirt.driver [req-3a2c66ac-1348-46b4-9add-8d5d3ef10a33 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Using config drive\n2015-06-11 14:39:50.482 16662 DEBUG oslo_concurrency.lockutils [-] Acquired semaphore \"refresh_cache-a12ee0d4-5747-4e40-9d22-d956afcbe490\" lock /usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py:391\n2015-06-11 14:39:50.482 16662 DEBUG nova.network.base_api [-] Updating cache with info: [] update_instance_cache_with_nw_info /opt/stack/new/nova/nova/network/base_api.py:42\n2015-06-11 14:39:50.494 16662 DEBUG oslo_concurrency.lockutils [-] Releasing semaphore \"refresh_cache-a12ee0d4-5747-4e40-9d22-d956afcbe490\" lock /usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py:404\n\nThe instance uuid is a12ee0d4-5747-4e40-9d22-d956afcbe490.\n\nThis is a nova-network job so something is coming back as [] from _get_instance_nw_info.", 
            "date_created": "2015-06-16 16:37:04.970768+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Looking in the nova-network logs, a network is never allocated/built properly for the instance:\n\nhttp://logs.openstack.org/69/190169/3/check/check-tempest-dsvm-full-glusterfs-nv/eecdc4e/logs/screen-n-net.txt.gz#_2015-06-11_14_39_50_479\n\nThere are 9 calls to refresh the nw_info and they are always empty, e.g.:\n\n2015-06-11 14:39:50.443 DEBUG nova.network.manager [req-3a2c66ac-1348-46b4-9add-8d5d3ef10a33 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Get instance network info get_instance_nw_info /opt/stack/new/nova/nova/network/manager.py:588\n2015-06-11 14:39:50.478 DEBUG nova.network.manager [req-3a2c66ac-1348-46b4-9add-8d5d3ef10a33 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] Built network info: |[]| get_instance_nw_info /opt/stack/new/nova/nova/network/manager.py:650", 
            "date_created": "2015-06-16 16:40:59.929818+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "We see that a fixed_ip is allocated for the instance here:\n\nhttp://logs.openstack.org/69/190169/3/check/check-tempest-dsvm-full-glusterfs-nv/eecdc4e/logs/screen-n-net.txt.gz#_2015-06-11_14_39_50_442\n\n2015-06-11 14:39:50.442 DEBUG nova.network.manager [req-3a2c66ac-1348-46b4-9add-8d5d3ef10a33 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Allocated fixed ip 10.1.0.2 on network f816e349-5d47-4229-af2b-357301adf78e allocate_fixed_ip /opt/stack/new/nova/nova/network/manager.py:954\n\nI'm wondering if we're hitting some DB race and getting an exception but it's ignored?\n\nhttp://git.openstack.org/cgit/openstack/nova/tree/nova/network/manager.py#n590", 
            "date_created": "2015-06-16 16:45:01.665534+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "The fixed IP is being associated with the instance here:\n\n2015-06-11 14:39:49.991 DEBUG nova.network.manager [req-3a2c66ac-1348-46b4-9add-8d5d3ef10a33 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Associating instance with fixed IP from pool in network 1 on subnet 10.1.0.0/20. allocate_fixed_ip /opt/stack/new/nova/nova/network/manager.py:895\n2015-06-11 14:39:50.002 DEBUG nova.network.manager [req-47d26fed-b6cd-4971-8f01-eff886f4b728 None None] Released IP |10.1.0.2| release_fixed_ip /opt/stack/new/nova/nova/network/manager.py:1089\n2015-06-11 14:39:50.027 WARNING nova.network.manager [req-47d26fed-b6cd-4971-8f01-eff886f4b728 None None] IP 10.1.0.2 released that was not leased\n\nThis is logged before we leave the allocate_fixed_ip method:\n\n2015-06-11 14:39:50.442 DEBUG nova.network.manager [req-3a2c66ac-1348-46b4-9add-8d5d3ef10a33 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Allocated fixed ip 10.1.0.2 on network f816e349-5d47-4229-af2b-357301adf78e allocate_fixed_ip /opt/stack/new/nova/nova/network/manager.py:954\n2015-06-11 14:39:50.443 DEBUG nova.network.manager [req-3a2c66ac-1348-46b4-9add-8d5d3ef10a33 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Get instance network info get_instance_nw_info /opt/stack/new/nova/nova/network/manager.py:588\n2015-06-11 14:39:50.478 DEBUG nova.network.manager [req-3a2c66ac-1348-46b4-9add-8d5d3ef10a33 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] Built network info: |[]| get_instance_nw_info /opt/stack/new/nova/nova/network/manager.py:650\n2015-06-11 14:39:50.479 INFO nova.network.manager [req-3a2c66ac-1348-46b4-9add-8d5d3ef10a33 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Allocated network: '[]' for instance\n\nSo the fixed IP was 10.1.0.2 and noting the warning that it's released before it was leased.  That was for a different request though:\n\nreq-47d26fed-b6cd-4971-8f01-eff886f4b728\n\nThat's for instance: f493b6ed-65b6-4d55-a32c-a92b549309f2\n\nThe network for that instance is being torn down at the same time that the failed instance network allocation is coming up:\n\n2015-06-11 14:39:41.594 INFO nova.network.manager [req-dbbefbd1-9d0b-453c-ad82-8a5de66be512 ServerMetadataNegativeTestJSON-592398845 ServerMetadataNegativeTestJSON-211084830] [instance: f493b6ed-65b6-4d55-a32c-a92b549309f2] Network deallocated for instance (fixed ips: '['10.1.0.2']')\n2015-06-11 14:39:42.806 DEBUG nova.network.manager [req-59280c49-b125-474a-beed-da3d5024c427 None None] Released IP |10.1.0.2| release_fixed_ip /opt/stack/new/nova/nova/network/manager.py:1089\n2015-06-11 14:39:47.565 DEBUG nova.network.manager [req-c2f3e01f-1992-48e6-9010-306ea4333cef None None] Leased IP |10.1.0.2| lease_fixed_ip /opt/stack/new/nova/nova/network/manager.py:1074\n2015-06-11 14:39:47.577 WARNING nova.network.manager [req-c2f3e01f-1992-48e6-9010-306ea4333cef None None] IP 10.1.0.2 leased that is not associated\n\nSo it seems that when we get here:\n\nhttp://logs.openstack.org/69/190169/3/check/check-tempest-dsvm-full-glusterfs-nv/eecdc4e/logs/screen-n-net.txt.gz#_2015-06-11_14_39_50_442\n\n2015-06-11 14:39:50.442 DEBUG nova.network.manager [req-3a2c66ac-1348-46b4-9add-8d5d3ef10a33 ServerRescueTestJSON-360939495 ServerRescueTestJSON-1539944143] [instance: a12ee0d4-5747-4e40-9d22-d956afcbe490] Allocated fixed ip 10.1.0.2 on network f816e349-5d47-4229-af2b-357301adf78e allocate_fixed_ip /opt/stack/new/nova/nova/network/manager.py:954\n\nThat fixed IP might be bogus?", 
            "date_created": "2015-06-16 17:52:34.874211+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/192348", 
            "date_created": "2015-06-16 18:26:58.413819+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "With the logging added in https://review.openstack.org/#/c/192348/ we see the race.\n\n1. The fixed IP is associated to an instance here (leased and allocated are False at this point):\n\nhttp://logs.openstack.org/42/175742/10/check/check-tempest-dsvm-nova-v21-full/2850b02/logs/screen-n-net.txt.gz#_2015-06-23_05_10_55_382\n\n2015-06-23 05:10:55.382 DEBUG nova.network.manager [req-8dc15314-f79e-489a-a454-7167007017e0 ServerRescueTestJSON-1209960414 ServerRescueTestJSON-118037235] [instance: 75316103-db05-4a9f-8967-c2a1f0325e2d] Associated instance with fixed IP: FixedIP(address=10.1.0.5,allocated=False,created_at=2015-06-23T04:58:34Z,default_route=<?>,deleted=False,deleted_at=None,floating_ips=<?>,host=None,id=6,instance=<?>,instance_uuid=75316103-db05-4a9f-8967-c2a1f0325e2d,leased=False,network=<?>,network_id=1,reserved=False,updated_at=2015-06-23T05:09:51Z,virtual_interface=<?>,virtual_interface_id=None) allocate_fixed_ip /opt/stack/new/nova/nova/network/manager.py:908\n\n2. Then via the dhcp-agent callback the fixed IP is released from a previous instance:\n\nhttp://logs.openstack.org/42/175742/10/check/check-tempest-dsvm-nova-v21-full/2850b02/logs/screen-n-net.txt.gz#_2015-06-23_05_10_55_459\n\n2015-06-23 05:10:55.459 WARNING nova.network.manager [req-23a38a9f-b465-4b39-bb95-4044e1639636 None None] [instance: 75316103-db05-4a9f-8967-c2a1f0325e2d] IP 10.1.0.5 released that was not leased\n\nSince the fixed_ip.allocated value is False at that point, it thinks it's OK to disassociate the fixed IP, which leads to:\n\n3. get_instance_nw_info() doesn't find any associated fixed IP for the new instance:\n\nhttp://logs.openstack.org/42/175742/10/check/check-tempest-dsvm-nova-v21-full/2850b02/logs/screen-n-net.txt.gz#_2015-06-23_05_10_55_731\n\n2015-06-23 05:10:55.731 DEBUG nova.network.manager [req-8dc15314-f79e-489a-a454-7167007017e0 ServerRescueTestJSON-1209960414 ServerRescueTestJSON-118037235] [instance: 75316103-db05-4a9f-8967-c2a1f0325e2d] Found 0 fixed IPs associated to the instance in the database. get_instance_nw_info /opt/stack/new/nova/nova/network/manager.py:598\n\nAnd the nw info cache isn't built and we fail.", 
            "date_created": "2015-06-23 16:45:16.120047+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "There is a tactical fix here which doesn't completely solve the race but might help, and is backportable:\n\nhttps://review.openstack.org/#/c/194815/\n\nThis should be the long term fix for the race:\n\nhttps://review.openstack.org/#/c/194843/", 
            "date_created": "2015-06-23 22:09:43.365805+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Fix proposed to branch: stable/kilo\nReview: https://review.openstack.org/195190", 
            "date_created": "2015-06-24 16:47:05.989611+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/195190\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=2b5fe5db0da7356527f076a2db9822506299ecfe\nSubmitter: Jenkins\nBranch:    stable/kilo\n\ncommit 2b5fe5db0da7356527f076a2db9822506299ecfe\nAuthor: Matt Riedemann <email address hidden>\nDate:   Tue Jun 23 13:49:42 2015 -0700\n\n    Reduce window for allocate_fixed_ip / release_fixed_ip race in nova-net\n    \n    There is a race during allocate_fixed_ip where a new instance, B, is\n    associated with a fixed IP, X, which was previously associated with\n    instance A that is being deallocated.\n    \n    Between the time that instance A is associated with fixed IP X and the\n    time that it's VIF is allocated, and fip.allocated = True in the DB, the\n    dhcpagent callback hits release_fixed_ip for the fixed IP X from when\n    instance A was deallocating.\n    \n    release_fixed_ip checks to see if the instance is allocated and if not\n    it disassociates the instance, which was associated with new instance B.\n    \n    This leads to get_instance_nw_info() not building anything since there\n    are no fixed IPs associated with instance A in the database, so\n    eventually anything needing to do networking with instance A, like\n    assocating a floating IP, fails.\n    \n    To narrow the race, we do the VIF allocation before associating the\n    fixed IP to the new instance. This does not completely fix the bug, but\n    it's a tactical change that we can backport to stable branches while\n    working on the longer-term fix which is going to involve network RPC API\n    changes to release_fixed_ip().\n    \n    Note that test_vpn_allocate_fixed_ip_no_network_id is removed since it\n    no longer works and arguably was testing the DB API in the wrong place,\n    so a new test is added to test_db_api for the same coverage.\n    \n    Partial-Bug: #1249065\n    \n    Change-Id: I8cf5483982085da57ee470fa2753b0d0aebc12b3\n    (cherry picked from commit 3736c120cbeacbc4349efbda99e279cddfb5f09e)\n", 
            "date_created": "2015-06-24 19:23:31.526364+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Another related fix for the full race fix so the DB is updated atomically so that when the instance is associated it's also marked as allocated:\n\nhttps://review.openstack.org/#/c/197135/", 
            "date_created": "2015-06-30 15:18:47.027510+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "I just hit this again on master:\n\nhttp://logs.openstack.org/23/197223/1/check/check-tempest-dsvm-full-ceph/bd59580/logs/screen-n-net.txt.gz#_2015-06-30_20_41_13_227\n\nWe need some more debug logging in the release_fixed_ip method.", 
            "date_created": "2015-07-01 13:45:15.339516+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/197608\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=fd471b2fc1fee6e859ee3657b53548a61c0f3a1e\nSubmitter: Jenkins\nBranch:    master\n\ncommit fd471b2fc1fee6e859ee3657b53548a61c0f3a1e\nAuthor: Matt Riedemann <email address hidden>\nDate:   Wed Jul 1 06:56:32 2015 -0700\n\n    n-net: add more debug logging to release_fixed_ip\n    \n    Despite commit 8c7690221294d6d7f2db84491fec8d81ef358cac we're still\n    seeing this race in the gate so add more debug logging in the\n    release_fixed_ip method to get a better idea of what's going on.\n    \n    Related-Bug: #1249065\n    \n    Change-Id: I9eda6cadf8aa31576bedf10c71c41fe1a3d4d629\n", 
            "date_created": "2015-09-02 06:37:30.392932+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/197135\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=73a68abb28b9ad5f4e9dee2781cdc5203bcb5937\nSubmitter: Jenkins\nBranch:    master\n\ncommit 73a68abb28b9ad5f4e9dee2781cdc5203bcb5937\nAuthor: Ryan Rossiter <email address hidden>\nDate:   Mon Jun 29 13:19:07 2015 +0000\n\n    Set vif and allocated when associating fixed ip\n    \n    Follow on to changes I84fa2f0926f719bff33ac43b39e161a4eb412f44 and\n    I8cf5483982085da57ee470fa2753b0d0aebc12b3.\n    \n    This change removes a race when associating fixed IPs and pools.\n    Originally, the fixed IPs were associated, and\n    \"virtual_interface_id\" was updated and saved to the DB at a later time.\n    This value is now sent into associate(_pool) and are tunneled down\n    to the DB on associate, so now the value is saved to the DB at\n    association.\n    \n    Change-Id: Ic37d96deba3a5ef51594733cc16091173a9655a4\n    Closes-Bug: #1249065\n", 
            "date_created": "2015-09-11 13:44:56.345344+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "While testing our current Kilo cloud, we're seeing a lot of occasions of this in the following tempest tests:\n\ntempest.api.compute.floating_ips.test_floating_ips_actions_negative.FloatingIPsNegativeTestJSON.test_associate_nonexistent_floating_ip[id-595fa616-1a71-4670-9614-46564ac49a4c,negative,network]\n\ntempest.api.compute.floating_ips.test_floating_ips_actions.FloatingIPsTestJSON.test_associate_already_associated_floating_ip[id-6edef4b2-aaf1-4abc-bbe3-993e2561e0fe,network]\n\ntempest.api.compute.floating_ips.test_floating_ips_actions.FloatingIPsTestJSON.test_associate_disassociate_floating_ip[id-307efa27-dc6f-48a0-8cd2-162ce3ef0b52,network]\n\ntempest.api.compute.servers.test_server_rescue.ServerRescueTestJSON.test_rescued_vm_associate_dissociate_floating_ip[id-4842e0cf-e87d-4d9d-b61f-f4791da3cacc]\n\ntempest.scenario.test_shelve_instance.TestShelveInstance.test_shelve_instance[compute,id-1164e700-0af0-4a4c-8792-35909a88743c,image,network]\ntempest.scenario.test_shelve_instance.TestShelveInstance.test_shelve_volume_backed_instance[compute,id-c1b6318c-b9da-490b-9c67-9339b627271f,image,network,volume]\n\ntempest.scenario.test_minimum_basic.TestMinimumBasicScenario.test_minimum_basic_scenario[compute,id-bdbb5441-9204-419d-a225-b4fdbfb1a1a8,image,network,volume]\n\ntempest.scenario.test_snapshot_pattern.TestSnapshotPattern.test_snapshot_pattern[compute,id-608e604b-1d63-4a82-8e3e-91bc665c90b4,image,network]\n\ntempest.scenario.test_volume_boot_pattern.TestVolumeBootPattern.test_volume_boot_pattern[compute,id-557cd2c2-4eb8-4dce-98be-f86765ff311b,image,smoke,volume]\n\ntempest.scenario.test_volume_boot_pattern.TestVolumeBootPatternV2.test_volume_boot_pattern[compute,id-557cd2c2-4eb8-4dce-98be-f86765ff311b,image,smoke,volume]\n\nThe error messages are always very similar:\n\n    Traceback (most recent call last):\n      File \"/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/tempest/test.py\", line 113, in wrapper\n        return f(self, *func_args, **func_kwargs)\n      File \"/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/tempest/scenario/test_volume_boot_pattern.py\", line 117, in test_volume_boot_pattern\n        ip_instance_1st = self.get_server_or_ip(instance_1st)\n      File \"/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/tempest/scenario/manager.py\", line 657, in get_server_or_ip\n        ip = self.create_floating_ip(server)['ip']\n      File \"/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/tempest/scenario/manager.py\", line 625, in create_floating_ip\n        floating_ip['ip'], thing['id'])\n      File \"/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/tempest_lib/services/compute/floating_ips_client.py\", line 75, in associate_floating_ip_to_server\n        resp, body = self.post(url, post_body)\n      File \"/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/tempest_lib/common/rest_client.py\", line 259, in post\n        return self.request('POST', url, extra_headers, headers, body)\n      File \"/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/tempest_lib/common/rest_client.py\", line 640, in request\n        resp, resp_body)\n      File \"/home/ubuntu/virtualenv/local/lib/python2.7/site-packages/tempest_lib/common/rest_client.py\", line 698, in _error_checker\n        raise exceptions.BadRequest(resp_body, resp=resp)\n    BadRequest: Bad request\n    Details: {u'message': u'No nw_info cache associated with instance', u'code': 400}", 
            "date_created": "2016-01-25 14:31:34.201834+00:00", 
            "author": "https://api.launchpad.net/1.0/~martin-loschwitz"
        }
    ], 
    "closed": "2015-07-28 09:08:10.229821+00:00"
}