{
    "status": "Invalid", 
    "last_updated": "2014-05-23 07:24:06.575017+00:00", 
    "description": "Unable to boot more than ~117 VMs.\nThe VMs remain in Build/Scheduling state and do not goto active state.\n\n| f367e216-decf-43c0-a5fe-26af0796235b | vm_one1-f367e216-decf-43c0-a5fe-26af0796235b | BUILD  | scheduling | NOSTATE     |          |\n| f374c766-c715-4d39-97da-5baa47bd16b5 | vm_one1-f374c766-c715-4d39-97da-5baa47bd16b5 | BUILD  | scheduling | NOSTATE     |          |\n| f391ce75-20fc-4bc1-93b0-0ff716eff044 | vm_one1-f391ce75-20fc-4bc1-93b0-0ff716eff044 | BUILD  | scheduling | NOSTATE     |          |\n| f3e06663-b7b8-4933-a499-88d64dede80a | vm_one1-f3e06663-b7b8-4933-a499-88d64dede80a | BUILD  | scheduling | NOSTATE     |          |\n| f3fb6f81-c1b7-4f8a-a27a-062a5af775de | vm_one1-f3fb6f81-c1b7-4f8a-a27a-062a5af775de | BUILD  | scheduling | NOSTATE     |          |\n| f442ea70-fd60-42b1-aa61-782a1c5a21d9 | vm_one1-f442ea70-fd60-42b1-aa61-782a1c5a21d9 | BUILD  | scheduling | NOSTATE     |          |\n| f4a2adae-fa84-4004-bfb8-40664a1fe29c | vm_one1-f4a2adae-fa84-4004-bfb8-40664a1fe29c | BUILD  | scheduling | NOSTATE     |          |\n\n\nHere is what I am doing:\nI am creating VMs in a batch of 5 and providing a delay of 90 secs for each of the batch operation.\n\nHowever I am seeing this issue only when I connect around 200 compute nodes to controller. If I reduce the number of Compute nodes to around 80 I m able to spawn more than 1000 VMs.\n\nSo on the outset it looks like, the number of compute nodes connected to controller is playing a role in how many VMs can booted.\n\nAlso pls. note that all the VMs being booted are part of single tenant.\n\nBelow are the details of the setup on which the issue was observed:\n1. Server Config: 32CPU,32GB RAM,Ubuntu 12.04 LTS Server.\n2. Number of Compute nodes connected to Controller: 200.\nFollowing error msgs are being observed in the log files:\n\nfound that inside the log says Operational error /Too many connections.\n\nnova.servicegroup.drivers.db [-] model server went away\u201d\n\u201c2014-05-13 18:22:13.035 16245 ERROR nova.servicegroup.drivers.db [-] Recovered model server connection!\u201d", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 28, 
    "link": "https://bugs.launchpad.net/nova/+bug/1319263", 
    "owner": "None", 
    "id": 1319263, 
    "index": 6112, 
    "openned": "2014-05-15 02:14:30.759417+00:00", 
    "created": "2014-05-14 06:35:34.065976+00:00", 
    "title": "ICE-HOUSE-GA:Nova conductor and Nova scheduler not stable when 200 compute connected to the  controller.", 
    "comments": [
        {
            "content": "while having 200 CN's connected with controller, nova-api, nova-conductor,nova-scheduler are unstable.\n\nsetup:\ncontroller with 200 CN's\nServer Config: 32CPU,32GB RAM,Ubuntu 12.04 LTS Server.\n \nfound that inside the log says Operational error /Too many connections.\n\nnova.servicegroup.drivers.db [-] model server went away\u201d\n\u201c2014-05-13 18:22:13.035 16245 ERROR nova.servicegroup.drivers.db [-] Recovered model server connection!\u201d", 
            "date_created": "2014-05-14 06:35:34.065976+00:00", 
            "author": "https://api.launchpad.net/1.0/~thalabathy-v"
        }, 
        {
            "content": "Again, provide more details in order to replicate this issue. The little details don't seem to be enough to classify this as a bug or a misconfiguration.", 
            "date_created": "2014-05-15 02:15:40.389542+00:00", 
            "author": "https://api.launchpad.net/1.0/~smaffulli"
        }, 
        {
            "content": "2014-05-17 06:50:38.738 21037 ERROR nova.servicegroup.drivers.db [-] model server went away\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db Traceback (most recent call last):\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/nova/servicegroup/drivers/db.py\", line 95, in _report_state\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     service.service_ref, state_catalog)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/nova/conductor/api.py\", line 218, in service_update\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return self._manager.service_update(context, service, values)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/nova/utils.py\", line 966, in wrapper\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return func(*args, **kwargs)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/oslo/messaging/rpc/server.py\", line 139, in inner\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return func(*args, **kwargs)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/nova/conductor/manager.py\", line 491, in service_update\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     svc = self.db.service_update(context, service['id'], values)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 148, in service_update\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return IMPL.service_update(context, service_id, values)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 146, in wrapper\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return f(*args, **kwargs)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 532, in service_update\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     with_compute_node=False, session=session)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 437, in _service_get\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     result = query.first()\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2282, in first\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     ret = list(self[0:1])\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2149, in __getitem__\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return list(res)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2353, in __iter__\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return self._execute_and_instances(context)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2366, in _execute_and_instances\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     close_with_result=True)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/query.py\", line 2357, in _connection_from_session\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     **kw)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/session.py\", line 799, in connection\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     close_with_result=close_with_result)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/session.py\", line 803, in _connection_for_bind\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return self.transaction._connection_for_bind(engine)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/orm/session.py\", line 299, in _connection_for_bind\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     conn = bind.contextual_connect()\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/base.py\", line 1661, in contextual_connect\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     self.pool.connect(),\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/pool.py\", line 272, in connect\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return _ConnectionFairy(self).checkout()\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/pool.py\", line 431, in __init__\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     rec = self._connection_record = pool._do_get()\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/pool.py\", line 772, in _do_get\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return self._create_connection()\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/pool.py\", line 225, in _create_connection\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return _ConnectionRecord(self)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/pool.py\", line 318, in __init__\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     self.connection = self.__connect()\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/pool.py\", line 379, in __connect\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     connection = self.__pool._creator()\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/strategies.py\", line 80, in connect\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return dialect.connect(*cargs, **cparams)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/sqlalchemy/engine/default.py\", line 283, in connect\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return self.dbapi.connect(*cargs, **cparams)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/MySQLdb/__init__.py\", line 81, in Connect\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     return Connection(*args, **kwargs)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db   File \"/usr/lib/python2.7/dist-packages/MySQLdb/connections.py\", line 187, in __init__\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db     super(Connection, self).__init__(*args, **kwargs2)\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db OperationalError: (OperationalError) (1040, 'Too many connections') None None\n2014-05-17 06:50:38.738 21037 TRACE nova.servicegroup.drivers.db \n2014-05-17 06:50:48.754 21037 ERROR nova.servicegroup.drivers.db [-] Recovered model server connection!\n2014-05-17 06:51:49.038 21045 ERROR nova.servicegroup.drivers.db [-] model server went away\n2014-05-17 06:51:49.038 21045 TRACE nova.servicegroup.drivers.db Traceback (most recent call last):", 
            "date_created": "2014-05-19 02:37:48.880406+00:00", 
            "author": "https://api.launchpad.net/1.0/~thalabathy-v"
        }, 
        {
            "content": "", 
            "date_created": "2014-05-19 02:39:12.569642+00:00", 
            "author": "https://api.launchpad.net/1.0/~thalabathy-v"
        }, 
        {
            "content": "Although its hard to tell just from the logs it looks like something is falling over when trying to connect to the database.", 
            "date_created": "2014-05-21 03:33:25.770285+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "Marking as Invalid since this is a MySQL mis-configuration error by the user rather than a Nova bug", 
            "date_created": "2014-05-23 07:24:06.005638+00:00", 
            "author": "https://api.launchpad.net/1.0/~philip-day"
        }
    ], 
    "closed": "2014-05-23 07:23:23.534299+00:00"
}