{
    "status": "Fix Released", 
    "last_updated": "2016-07-14 13:02:07.912393+00:00", 
    "description": "Seen in a recent CI job run in the experimental queue for the live migration job:\n\nhttp://logs.openstack.org/03/315703/1/experimental/gate-tempest-dsvm-multinode-live-migration/97e6c2a/logs/screen-n-cpu.txt.gz?level=TRACE\n\n2016-06-06 14:25:27.274 20342 ERROR nova.virt.libvirt.driver [req-1fdc0391-9baf-4e86-a528-123f1bbc5812 tempest-LiveBlockMigrationTestJSON-557430341 tempest-LiveBlockMigrationTestJSON-557430341] [instance: 33c87d9e-6475-4142-9f90-d035c4b4d691] Live Migration failure: migrateToURI3() got an unexpected keyword argument 'bandwidth'\n2016-06-06 14:25:27.275 20342 DEBUG nova.virt.libvirt.driver [req-1fdc0391-9baf-4e86-a528-123f1bbc5812 tempest-LiveBlockMigrationTestJSON-557430341 tempest-LiveBlockMigrationTestJSON-557430341] [instance: 33c87d9e-6475-4142-9f90-d035c4b4d691] Migration operation thread notification thread_finished /opt/stack/new/nova/nova/virt/libvirt/driver.py:6226\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 457, in fire_timers\n    timer()\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/timer.py\", line 58, in __call__\n    cb(*args, **kw)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 168, in _do_send\n    waiter.switch(result)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 214, in main\n    result = function(*args, **kwargs)\n  File \"/opt/stack/new/nova/nova/utils.py\", line 1053, in context_wrapper\n    return func(*args, **kwargs)\n  File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 5755, in _live_migration_operation\n    instance=instance)\n  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 221, in __exit__\n    self.force_reraise()\n  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 197, in force_reraise\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 5751, in _live_migration_operation\n    bandwidth=CONF.libvirt.live_migration_bandwidth)\n  File \"/opt/stack/new/nova/nova/virt/libvirt/guest.py\", line 526, in migrate\n    flags=flags, bandwidth=bandwidth)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 186, in doit\n    result = proxy_call(self._autowrap, f, *args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 144, in proxy_call\n    rv = execute(f, *args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 125, in execute\n    six.reraise(c, e, tb)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 83, in tworker\n    rv = meth(*args, **kwargs)\nTypeError: migrateToURI3() got an unexpected keyword argument 'bandwidth'", 
    "tags": [
        "libvirt", 
        "live-migration"
    ], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1589548", 
    "owner": "https://api.launchpad.net/1.0/~mriedem", 
    "id": 1589548, 
    "index": 1931, 
    "openned": "2016-06-06 15:11:50.512103+00:00", 
    "created": "2016-06-06 15:11:50.512103+00:00", 
    "title": "Live Migration failure: migrateToURI3() got an unexpected keyword argument 'bandwidth'", 
    "comments": [
        {
            "content": "Seen in a recent CI job run in the experimental queue for the live migration job:\n\nhttp://logs.openstack.org/03/315703/1/experimental/gate-tempest-dsvm-multinode-live-migration/97e6c2a/logs/screen-n-cpu.txt.gz?level=TRACE\n\n2016-06-06 14:25:27.274 20342 ERROR nova.virt.libvirt.driver [req-1fdc0391-9baf-4e86-a528-123f1bbc5812 tempest-LiveBlockMigrationTestJSON-557430341 tempest-LiveBlockMigrationTestJSON-557430341] [instance: 33c87d9e-6475-4142-9f90-d035c4b4d691] Live Migration failure: migrateToURI3() got an unexpected keyword argument 'bandwidth'\n2016-06-06 14:25:27.275 20342 DEBUG nova.virt.libvirt.driver [req-1fdc0391-9baf-4e86-a528-123f1bbc5812 tempest-LiveBlockMigrationTestJSON-557430341 tempest-LiveBlockMigrationTestJSON-557430341] [instance: 33c87d9e-6475-4142-9f90-d035c4b4d691] Migration operation thread notification thread_finished /opt/stack/new/nova/nova/virt/libvirt/driver.py:6226\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 457, in fire_timers\n    timer()\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/timer.py\", line 58, in __call__\n    cb(*args, **kw)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 168, in _do_send\n    waiter.switch(result)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 214, in main\n    result = function(*args, **kwargs)\n  File \"/opt/stack/new/nova/nova/utils.py\", line 1053, in context_wrapper\n    return func(*args, **kwargs)\n  File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 5755, in _live_migration_operation\n    instance=instance)\n  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 221, in __exit__\n    self.force_reraise()\n  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 197, in force_reraise\n    six.reraise(self.type_, self.value, self.tb)\n  File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 5751, in _live_migration_operation\n    bandwidth=CONF.libvirt.live_migration_bandwidth)\n  File \"/opt/stack/new/nova/nova/virt/libvirt/guest.py\", line 526, in migrate\n    flags=flags, bandwidth=bandwidth)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 186, in doit\n    result = proxy_call(self._autowrap, f, *args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 144, in proxy_call\n    rv = execute(f, *args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 125, in execute\n    six.reraise(c, e, tb)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 83, in tworker\n    rv = meth(*args, **kwargs)\nTypeError: migrateToURI3() got an unexpected keyword argument 'bandwidth'", 
            "date_created": "2016-06-06 15:11:50.512103+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/325204\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=0a6985a93f34e0038c21e985212038da5ea4ed8a\nSubmitter: Jenkins\nBranch:    master\n\ncommit 0a6985a93f34e0038c21e985212038da5ea4ed8a\nAuthor: Pawel Koniszewski <email address hidden>\nDate:   Fri Jun 3 12:14:32 2016 +0200\n\n    [libvirt] Incorrect parameters passed to migrateToURI3\n    \n    migrateToURI3 does not take 'bandwidth' argument so we shouldn't try\n    to pass it. Actually it results with exception when libvirt>=1.2.17\n    is used.\n    \n    Note the bandwidth parameter is already in the params list via the call\n    from the libvirt driver in Nova so we don't have to check to see if it's\n    already in 'params'. However, this is ugly and leaks libvirt API info\n    out of the Guest object. That will be refactored and cleaned up in a\n    follow-on change.\n    \n    Closes-Bug: #1589548\n    \n    Change-Id: Ieea2d955c763655e2b2abfb99fccb1a4c7169794\n", 
            "date_created": "2016-06-06 20:54:57.123434+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.0.0b2 development milestone.", 
            "date_created": "2016-07-14 13:02:07.334124+00:00", 
            "author": "https://api.launchpad.net/1.0/~doug-hellmann"
        }
    ], 
    "closed": "2016-06-06 20:54:55.381081+00:00"
}