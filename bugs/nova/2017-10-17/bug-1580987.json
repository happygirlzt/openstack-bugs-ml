{
    "status": "Fix Released", 
    "last_updated": "2016-06-02 19:32:24.009338+00:00", 
    "description": "Recent ironic job runs (like https://review.openstack.org/#/c/314917/) fail with the following traceback:\n\n2016-05-12 10:19:51.730 | ironic_tempest_plugin.tests.scenario.test_baremetal_basic_ops.BaremetalBasicOps.test_baremetal_server_ops[baremetal,compute,id-549173a5-38ec-42bb-b0e2-c8b9f4a08943,image,network]\n2016-05-12 10:19:51.731 | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n2016-05-12 10:19:51.731 | \n2016-05-12 10:19:51.731 | Captured traceback:\n2016-05-12 10:19:51.731 | ~~~~~~~~~~~~~~~~~~~\n2016-05-12 10:19:51.731 |     Traceback (most recent call last):\n2016-05-12 10:19:51.731 |       File \"tempest/test.py\", line 113, in wrapper\n2016-05-12 10:19:51.731 |         return f(self, *func_args, **func_kwargs)\n2016-05-12 10:19:51.731 |       File \"/opt/stack/new/ironic/ironic_tempest_plugin/tests/scenario/test_baremetal_basic_ops.py\", line 113, in test_baremetal_server_ops\n2016-05-12 10:19:51.732 |         self.boot_instance()\n2016-05-12 10:19:51.732 |       File \"/opt/stack/new/ironic/ironic_tempest_plugin/tests/scenario/baremetal_manager.py\", line 164, in boot_instance\n2016-05-12 10:19:51.732 |         interval=30)\n2016-05-12 10:19:51.732 |       File \"/opt/stack/new/ironic/ironic_tempest_plugin/tests/scenario/baremetal_manager.py\", line 94, in wait_provisioning_state\n2016-05-12 10:19:51.732 |         target_states=state, timeout=timeout, interval=interval)\n2016-05-12 10:19:51.732 |       File \"/opt/stack/new/ironic/ironic_tempest_plugin/tests/scenario/baremetal_manager.py\", line 89, in _node_state_timeout\n2016-05-12 10:19:51.733 |         raise lib_exc.TimeoutException(msg)\n2016-05-12 10:19:51.733 |     tempest.lib.exceptions.TimeoutException: Request timed out\n2016-05-12 10:19:51.733 |     Details: Timed out waiting for node 92f193e8-9955-4335-b4cf-f24804bf5d07 to reach provision_state state(s) ['active']\n\nin n-cpu there is the following:\n\n2016-05-04 21:44:02.548 25779 ERROR nova.virt.ironic.driver [req-d8ace69f-f1f2-4901-bb4d-8975bc660cf2 tempest-BaremetalBasicOps-1503755723 tempest-BaremetalBasicOps-529747769] Error deploying instance 96a56107-9e09-42a2-a287-66e0305aeed4 on baremetal node 0c8fd6b5-0a02-44f3-a637-0b3e1e174732.\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [req-d8ace69f-f1f2-4901-bb4d-8975bc660cf2 tempest-BaremetalBasicOps-1503755723 tempest-BaremetalBasicOps-529747769] [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] Instance failed to spawn\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] Traceback (most recent call last):\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 2041, in _build_resources\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     yield resources\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1887, in _build_and_run_instance\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     block_device_info=block_device_info)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/virt/ironic/driver.py\", line 781, in spawn\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     'node': node_uuid})\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     self.force_reraise()\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     six.reraise(self.type_, self.value, self.tb)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/virt/ironic/driver.py\", line 773, in spawn\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     timer.start(interval=CONF.ironic.api_retry_interval).wait()\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 121, in wait\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     return hubs.get_hub().switch()\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 294, in switch\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     return self.greenlet.switch()\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_service/loopingcall.py\", line 136, in _run_loop\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     result = func(*self.args, **self.kw)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/virt/ironic/driver.py\", line 382, in _wait_for_active\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     instance.refresh()\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_versionedobjects/base.py\", line 207, in wrapper\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     ctxt, self, fn.__name__, args, kwargs)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/conductor/rpcapi.py\", line 241, in object_action\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     objmethod=objmethod, args=args, kwargs=kwargs)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/client.py\", line 158, in call\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     retry=self.retry)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/transport.py\", line 90, in _send\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     timeout=timeout, retry=retry)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 470, in send\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     retry=retry)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 461, in _send\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     raise result\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] OrphanedObjectError_Remote: Cannot call obj_load_attr on orphaned Instance object\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] Traceback (most recent call last):\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/conductor/manager.py\", line 85, in _object_dispatch\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     return getattr(target, method)(*args, **kwargs)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_versionedobjects/base.py\", line 223, in wrapper\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     return fn(self, *args, **kwargs)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/objects/instance.py\", line 760, in refresh\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     elif self[field] != current[field]:\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_versionedobjects/base.py\", line 724, in __getitem__\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     return getattr(self, name)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_versionedobjects/base.py\", line 67, in getter\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     self.obj_load_attr(name)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/objects/instance.py\", line 932, in obj_load_attr\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     objtype=self.obj_name())\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] OrphanedObjectError: Cannot call obj_load_attr on orphaned Instance object\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]\n\nSeems to be happening after https://review.openstack.org/#/c/312750/ was merged.", 
    "tags": [], 
    "importance": "High", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1580987", 
    "owner": "https://api.launchpad.net/1.0/~jim-rollenhagen", 
    "id": 1580987, 
    "index": 1925, 
    "openned": "2016-05-12 11:31:23.398612+00:00", 
    "created": "2016-05-12 11:31:23.398612+00:00", 
    "title": "'Cannot call obj_load_attr on orphaned Instance object' in baremetal_basic_ops", 
    "comments": [
        {
            "content": "Recent ironic job runs (like https://review.openstack.org/#/c/314917/) fail with the following traceback:\n\n2016-05-12 10:19:51.730 | ironic_tempest_plugin.tests.scenario.test_baremetal_basic_ops.BaremetalBasicOps.test_baremetal_server_ops[baremetal,compute,id-549173a5-38ec-42bb-b0e2-c8b9f4a08943,image,network]\n2016-05-12 10:19:51.731 | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------\n2016-05-12 10:19:51.731 | \n2016-05-12 10:19:51.731 | Captured traceback:\n2016-05-12 10:19:51.731 | ~~~~~~~~~~~~~~~~~~~\n2016-05-12 10:19:51.731 |     Traceback (most recent call last):\n2016-05-12 10:19:51.731 |       File \"tempest/test.py\", line 113, in wrapper\n2016-05-12 10:19:51.731 |         return f(self, *func_args, **func_kwargs)\n2016-05-12 10:19:51.731 |       File \"/opt/stack/new/ironic/ironic_tempest_plugin/tests/scenario/test_baremetal_basic_ops.py\", line 113, in test_baremetal_server_ops\n2016-05-12 10:19:51.732 |         self.boot_instance()\n2016-05-12 10:19:51.732 |       File \"/opt/stack/new/ironic/ironic_tempest_plugin/tests/scenario/baremetal_manager.py\", line 164, in boot_instance\n2016-05-12 10:19:51.732 |         interval=30)\n2016-05-12 10:19:51.732 |       File \"/opt/stack/new/ironic/ironic_tempest_plugin/tests/scenario/baremetal_manager.py\", line 94, in wait_provisioning_state\n2016-05-12 10:19:51.732 |         target_states=state, timeout=timeout, interval=interval)\n2016-05-12 10:19:51.732 |       File \"/opt/stack/new/ironic/ironic_tempest_plugin/tests/scenario/baremetal_manager.py\", line 89, in _node_state_timeout\n2016-05-12 10:19:51.733 |         raise lib_exc.TimeoutException(msg)\n2016-05-12 10:19:51.733 |     tempest.lib.exceptions.TimeoutException: Request timed out\n2016-05-12 10:19:51.733 |     Details: Timed out waiting for node 92f193e8-9955-4335-b4cf-f24804bf5d07 to reach provision_state state(s) ['active']\n\nin n-cpu there is the following:\n\n2016-05-04 21:44:02.548 25779 ERROR nova.virt.ironic.driver [req-d8ace69f-f1f2-4901-bb4d-8975bc660cf2 tempest-BaremetalBasicOps-1503755723 tempest-BaremetalBasicOps-529747769] Error deploying instance 96a56107-9e09-42a2-a287-66e0305aeed4 on baremetal node 0c8fd6b5-0a02-44f3-a637-0b3e1e174732.\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [req-d8ace69f-f1f2-4901-bb4d-8975bc660cf2 tempest-BaremetalBasicOps-1503755723 tempest-BaremetalBasicOps-529747769] [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] Instance failed to spawn\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] Traceback (most recent call last):\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 2041, in _build_resources\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     yield resources\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1887, in _build_and_run_instance\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     block_device_info=block_device_info)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/virt/ironic/driver.py\", line 781, in spawn\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     'node': node_uuid})\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     self.force_reraise()\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     six.reraise(self.type_, self.value, self.tb)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/virt/ironic/driver.py\", line 773, in spawn\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     timer.start(interval=CONF.ironic.api_retry_interval).wait()\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 121, in wait\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     return hubs.get_hub().switch()\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 294, in switch\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     return self.greenlet.switch()\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_service/loopingcall.py\", line 136, in _run_loop\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     result = func(*self.args, **self.kw)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/virt/ironic/driver.py\", line 382, in _wait_for_active\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     instance.refresh()\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_versionedobjects/base.py\", line 207, in wrapper\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     ctxt, self, fn.__name__, args, kwargs)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/conductor/rpcapi.py\", line 241, in object_action\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     objmethod=objmethod, args=args, kwargs=kwargs)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/client.py\", line 158, in call\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     retry=self.retry)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/transport.py\", line 90, in _send\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     timeout=timeout, retry=retry)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 470, in send\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     retry=retry)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 461, in _send\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     raise result\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] OrphanedObjectError_Remote: Cannot call obj_load_attr on orphaned Instance object\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] Traceback (most recent call last):\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/conductor/manager.py\", line 85, in _object_dispatch\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     return getattr(target, method)(*args, **kwargs)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_versionedobjects/base.py\", line 223, in wrapper\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     return fn(self, *args, **kwargs)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/objects/instance.py\", line 760, in refresh\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     elif self[field] != current[field]:\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_versionedobjects/base.py\", line 724, in __getitem__\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     return getattr(self, name)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_versionedobjects/base.py\", line 67, in getter\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     self.obj_load_attr(name)\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]   File \"/opt/stack/new/nova/nova/objects/instance.py\", line 932, in obj_load_attr\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]     objtype=self.obj_name())\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] OrphanedObjectError: Cannot call obj_load_attr on orphaned Instance object\n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4] \n2016-05-04 21:44:02.549 25779 ERROR nova.compute.manager [instance: 96a56107-9e09-42a2-a287-66e0305aeed4]\n\nSeems to be happening after https://review.openstack.org/#/c/312750/ was merged.", 
            "date_created": "2016-05-12 11:31:23.398612+00:00", 
            "author": "https://api.launchpad.net/1.0/~vdrok"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/315495", 
            "date_created": "2016-05-12 11:35:49.334900+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "The non-voting ironic job even failed in the original change but we didn't notice because it's non-voting:\n\nhttp://logs.openstack.org/50/312750/5/check/gate-tempest-dsvm-ironic-pxe_ipa-nv/a3d58f4/logs/screen-n-cpu.txt.gz?level=TRACE\n\nIt scares me that this broke ironic - do we know why? Seems like a bug in ironic because in Nova we should just be lazy-loading instance.keypairs, and if that's not in the instance_extra table we'd just return a KeyPairList with a single KeyPair object that has the key_name set from the instance field.", 
            "date_created": "2016-05-12 14:15:07.059919+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Change abandoned by Jim Rollenhagen (<email address hidden>) on branch: master\nReview: https://review.openstack.org/315491\nReason: This isn't necessary", 
            "date_created": "2016-05-12 15:37:50.369163+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/315495\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=fa3453fcc1bc7061f9e39d872bdda6a6944ccaad\nSubmitter: Jenkins\nBranch:    master\n\ncommit fa3453fcc1bc7061f9e39d872bdda6a6944ccaad\nAuthor: Jim Rollenhagen <email address hidden>\nDate:   Thu May 12 07:32:27 2016 -0400\n\n    Eager load keypairs in instance metadata\n    \n    In the review for e83842b80b73c451f78a4bb9e7bd5dfcebdefcab it was\n    pointed out that keypairs should be added to the eager load list for\n    get_metadata_for_instance_id. Due to a lack of a proper context in a\n    thread in the ironic driver, this actually totally broke ironic.\n    The context problem is being fixed elsewhere, but this should be\n    eager-loaded to minimize DB queries anyway.\n    \n    Change-Id: I67b4665bdebd45c66983c6a556d20f367fa7fbdf\n    Closes-Bug: #1580987\n", 
            "date_created": "2016-05-12 20:45:45.271083+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.0.0b1 development milestone.", 
            "date_created": "2016-06-02 19:32:23.446856+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }
    ], 
    "closed": "2016-05-12 20:45:42.517023+00:00"
}