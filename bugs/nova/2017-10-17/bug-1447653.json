{
    "status": "Fix Released", 
    "last_updated": "2015-10-15 08:50:58.096097+00:00", 
    "description": "Currently, the subject created for the x509 certificate is too long, resulting in exceptions and failing to create the keypair. ( https://github.com/openstack/nova/blob/master/nova/crypto.py#L370 )\n\nBug detected during novaclient functional tests for commit: https://review.openstack.org/#/c/136458/\n\nLogs: http://logs.openstack.org/58/136458/24/check/check-novaclient-dsvm-functional/ae7b130/logs/screen-n-api.txt.gz#_2015-04-23_09_23_16_289", 
    "tags": [
        "kilo-backport-potential"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1447653", 
    "owner": "https://api.launchpad.net/1.0/~cbelu", 
    "id": 1447653, 
    "index": 4235, 
    "openned": "2015-04-23 15:03:03.822412+00:00", 
    "created": "2015-04-23 15:03:03.822412+00:00", 
    "title": "x509 keypair cannot be created if the given subject is too long", 
    "comments": [
        {
            "content": "Currently, the subject created for the x509 certificate is too long, resulting in exceptions and failing to create the keypair. ( https://github.com/openstack/nova/blob/master/nova/crypto.py#L370 )\n\nBug detected during novaclient functional tests for commit: https://review.openstack.org/#/c/136458/\n\nLogs: http://logs.openstack.org/58/136458/24/check/check-novaclient-dsvm-functional/ae7b130/logs/screen-n-api.txt.gz#_2015-04-23_09_23_16_289", 
            "date_created": "2015-04-23 15:03:03.822412+00:00", 
            "author": "https://api.launchpad.net/1.0/~cbelu"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/176817", 
            "date_created": "2015-04-23 15:25:30.098849+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Here is the error from the test:\n\nhttp://logs.openstack.org/58/136458/24/check/check-novaclient-dsvm-functional/ae7b130/logs/screen-n-api.txt.gz?level=TRACE#_2015-04-23_09_23_16_289\n\n2015-04-23 09:23:16.289 ERROR nova.api.openstack.extensions [req-8eee9b8c-0f46-4ddf-a8b7-79a92c134a1e admin admin] Unexpected exception in API method\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions Traceback (most recent call last):\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/openstack/extensions.py\", line 471, in wrapped\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     return f(*args, **kwargs)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/validation/__init__.py\", line 58, in wrapper\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     return func(*args, **kwargs)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/openstack/compute/plugins/v3/keypairs.py\", line 73, in create\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     return self._create(req, body, type=True)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/api/openstack/compute/plugins/v3/keypairs.py\", line 109, in _create\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     context, context.user_id, name, key_type)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/exception.py\", line 88, in wrapped\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     payload)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     six.reraise(self.type_, self.value, self.tb)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/exception.py\", line 71, in wrapped\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     return f(self, context, *args, **kw)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/compute/api.py\", line 3783, in create_key_pair\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     context, user_id, key_type)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/compute/api.py\", line 3807, in _generate_key_pair\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     return crypto.generate_winrm_x509_cert(user_id, context.project_id)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/crypto.py\", line 383, in generate_winrm_x509_cert\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     '-extensions', 'v3_req_client')\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/opt/stack/new/nova/nova/utils.py\", line 206, in execute\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     return processutils.execute(*cmd, **kwargs)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions   File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/processutils.py\", line 233, in execute\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions     cmd=sanitized_cmd)\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions ProcessExecutionError: Unexpected error while running command.\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions Command: openssl req -x509 -nodes -days 3650 -config /tmp/tmp4oZkbJ/temp.conf -newkey rsa:2048 -outform PEM -keyout /tmp/tmp4oZkbJ/temp.key -subj /CN=a5cfb57bdee94c9995f5f7cd610d479a-775f4bce4d9945388b9cad58b91385f8 -extensions v3_req_client\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions Exit code: 1\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions Stdout: u''\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions Stderr: u\"Generating a 2048 bit RSA private key\\n................................................+++\\n...+++\\nwriting new private key to '/tmp/tmp4oZkbJ/temp.key'\\n-----\\nproblems making Certificate Request\\n139736680101536:error:0D07A097:asn1 encoding routines:ASN1_mbstring_ncopy:string too long:a_mbstr.c:154:maxsize=64\\n\"\n2015-04-23 09:23:16.289 13567 TRACE nova.api.openstack.extensions ", 
            "date_created": "2015-04-24 17:18:01.418653+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/176817\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=f88edaa6fc80e0c38727469ca69f0016de23db18\nSubmitter: Jenkins\nBranch:    master\n\ncommit f88edaa6fc80e0c38727469ca69f0016de23db18\nAuthor: Claudiu Belu <email address hidden>\nDate:   Thu Apr 23 08:20:21 2015 -0700\n\n    Fixes X509 keypair creation failure\n    \n    Currently, the Subject created for the X509 certificate\n    is too long, resulting in exceptions and failing to\n    create the keypair.\n    \n    This change shortens the Subject.\n    Unit test added to prove the issue's existence.\n    \n    Issue found by: Andrey Kurilin\n    \n    Co-authored-by: Andrey Kurilin <email address hidden>\n    \n    Change-Id: I7885c120ce81a22d416f806779bf9a12092d5040\n    Closes-Bug: #1447653\n", 
            "date_created": "2015-04-29 19:05:45.794880+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2015-06-24 12:17:47.569354+00:00"
}