{
    "status": "Fix Released", 
    "last_updated": "2015-04-30 09:18:43.379201+00:00", 
    "description": "Logstash query:\nmessage:\"'block_device_mapping_v2' was unexpected\"\n\nLogstash URL:\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiJ2Jsb2NrX2RldmljZV9tYXBwaW5nX3YyJyB3YXMgdW5leHBlY3RlZFwiIiwiZmllbGRzIjpbXSwib2Zmc2V0IjowLCJ0aW1lZnJhbWUiOiIxNzI4MDAiLCJncmFwaG1vZGUiOiJjb3VudCIsInRpbWUiOnsidXNlcl9pbnRlcnZhbCI6MH0sInN0YW1wIjoxNDIxNjk0Nzk2MDE3fQ==\n\nExample traceback\n2015-01-19 18:58:52.035 | nova.tests.unit.api.openstack.compute.contrib.test_block_device_mapping_v1.BlockDeviceMappingTestV21.test_create_instance_both_bdm_formats\n2015-01-19 18:58:52.035 | ------------------------------------------------------------------------------------------------------------------------------------------\n2015-01-19 18:58:52.035 | \n2015-01-19 18:58:52.035 | Captured traceback:\n2015-01-19 18:58:52.035 | ~~~~~~~~~~~~~~~~~~~\n2015-01-19 18:58:52.035 |     Traceback (most recent call last):\n2015-01-19 18:58:52.036 |       File \"nova/tests/unit/api/openstack/compute/contrib/test_block_device_mapping_v1.py\", line 337, in test_create_instance_both_bdm_formats\n2015-01-19 18:58:52.036 |         self.assertRaises(exc.HTTPBadRequest, self._test_create, params)\n2015-01-19 18:58:52.036 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 420, in assertRaises\n2015-01-19 18:58:52.036 |         self.assertThat(our_callable, matcher)\n2015-01-19 18:58:52.036 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 431, in assertThat\n2015-01-19 18:58:52.036 |         mismatch_error = self._matchHelper(matchee, matcher, message, verbose)\n2015-01-19 18:58:52.036 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 481, in _matchHelper\n2015-01-19 18:58:52.036 |         mismatch = matcher.match(matchee)\n2015-01-19 18:58:52.036 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_exception.py\", line 108, in match\n2015-01-19 18:58:52.036 |         mismatch = self.exception_matcher.match(exc_info)\n2015-01-19 18:58:52.036 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_higherorder.py\", line 62, in match\n2015-01-19 18:58:52.036 |         mismatch = matcher.match(matchee)\n2015-01-19 18:58:52.037 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 412, in match\n2015-01-19 18:58:52.037 |         reraise(*matchee)\n2015-01-19 18:58:52.037 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_exception.py\", line 101, in match\n2015-01-19 18:58:52.037 |         result = matchee()\n2015-01-19 18:58:52.037 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 965, in __call__\n2015-01-19 18:58:52.037 |         return self._callable_object(*self._args, **self._kwargs)\n2015-01-19 18:58:52.037 |       File \"nova/tests/unit/api/openstack/compute/contrib/test_block_device_mapping_v1.py\", line 95, in _test_create\n2015-01-19 18:58:52.037 |         self.controller.create(req, body=body).obj['server']\n2015-01-19 18:58:52.037 |       File \"nova/api/openstack/extensions.py\", line 428, in wrapped\n2015-01-19 18:58:52.037 |         return f(*args, **kwargs)\n2015-01-19 18:58:52.037 |       File \"nova/api/validation/__init__.py\", line 56, in wrapper\n2015-01-19 18:58:52.038 |         schema_validator.validate(kwargs['body'])\n2015-01-19 18:58:52.038 |       File \"nova/api/validation/validators.py\", line 114, in validate\n2015-01-19 18:58:52.038 |         raise exception.ValidationError(detail=detail)\n2015-01-19 18:58:52.038 |     ValidationError: Invalid input for field/attribute server. Value: {'name': 'server_test', 'imageRef': '76fa36fc-c930-4bf3-8c8a-ea2a2420deb6', 'block_device_mapping': [{'device_name': 'foo'}], 'block_device_mapping_v2': [{'source_type': 'volume', 'uuid': 'fake_vol'}], 'flavorRef': 'http://localhost/123/flavors/3', 'metadata': {'open': 'stack', 'hello': 'world'}}. Additional properties are not allowed ('block_device_mapping_v2' was unexpected)", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1412547", 
    "owner": "https://api.launchpad.net/1.0/~dims-v", 
    "id": 1412547, 
    "index": 4135, 
    "openned": "2015-01-19 19:16:56.767941+00:00", 
    "created": "2015-01-19 19:16:56.767941+00:00", 
    "title": "Additional properties are not allowed ('block_device_mapping_v2' was unexpected)", 
    "comments": [
        {
            "content": "Logstash query:\nmessage:\"'block_device_mapping_v2' was unexpected\"\n\nLogstash URL:\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiJ2Jsb2NrX2RldmljZV9tYXBwaW5nX3YyJyB3YXMgdW5leHBlY3RlZFwiIiwiZmllbGRzIjpbXSwib2Zmc2V0IjowLCJ0aW1lZnJhbWUiOiIxNzI4MDAiLCJncmFwaG1vZGUiOiJjb3VudCIsInRpbWUiOnsidXNlcl9pbnRlcnZhbCI6MH0sInN0YW1wIjoxNDIxNjk0Nzk2MDE3fQ==\n\nExample traceback\n2015-01-19 18:58:52.035 | nova.tests.unit.api.openstack.compute.contrib.test_block_device_mapping_v1.BlockDeviceMappingTestV21.test_create_instance_both_bdm_formats\n2015-01-19 18:58:52.035 | ------------------------------------------------------------------------------------------------------------------------------------------\n2015-01-19 18:58:52.035 | \n2015-01-19 18:58:52.035 | Captured traceback:\n2015-01-19 18:58:52.035 | ~~~~~~~~~~~~~~~~~~~\n2015-01-19 18:58:52.035 |     Traceback (most recent call last):\n2015-01-19 18:58:52.036 |       File \"nova/tests/unit/api/openstack/compute/contrib/test_block_device_mapping_v1.py\", line 337, in test_create_instance_both_bdm_formats\n2015-01-19 18:58:52.036 |         self.assertRaises(exc.HTTPBadRequest, self._test_create, params)\n2015-01-19 18:58:52.036 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 420, in assertRaises\n2015-01-19 18:58:52.036 |         self.assertThat(our_callable, matcher)\n2015-01-19 18:58:52.036 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 431, in assertThat\n2015-01-19 18:58:52.036 |         mismatch_error = self._matchHelper(matchee, matcher, message, verbose)\n2015-01-19 18:58:52.036 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 481, in _matchHelper\n2015-01-19 18:58:52.036 |         mismatch = matcher.match(matchee)\n2015-01-19 18:58:52.036 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_exception.py\", line 108, in match\n2015-01-19 18:58:52.036 |         mismatch = self.exception_matcher.match(exc_info)\n2015-01-19 18:58:52.036 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_higherorder.py\", line 62, in match\n2015-01-19 18:58:52.036 |         mismatch = matcher.match(matchee)\n2015-01-19 18:58:52.037 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 412, in match\n2015-01-19 18:58:52.037 |         reraise(*matchee)\n2015-01-19 18:58:52.037 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/matchers/_exception.py\", line 101, in match\n2015-01-19 18:58:52.037 |         result = matchee()\n2015-01-19 18:58:52.037 |       File \"/home/jenkins/workspace/gate-nova-python27/.tox/py27/local/lib/python2.7/site-packages/testtools/testcase.py\", line 965, in __call__\n2015-01-19 18:58:52.037 |         return self._callable_object(*self._args, **self._kwargs)\n2015-01-19 18:58:52.037 |       File \"nova/tests/unit/api/openstack/compute/contrib/test_block_device_mapping_v1.py\", line 95, in _test_create\n2015-01-19 18:58:52.037 |         self.controller.create(req, body=body).obj['server']\n2015-01-19 18:58:52.037 |       File \"nova/api/openstack/extensions.py\", line 428, in wrapped\n2015-01-19 18:58:52.037 |         return f(*args, **kwargs)\n2015-01-19 18:58:52.037 |       File \"nova/api/validation/__init__.py\", line 56, in wrapper\n2015-01-19 18:58:52.038 |         schema_validator.validate(kwargs['body'])\n2015-01-19 18:58:52.038 |       File \"nova/api/validation/validators.py\", line 114, in validate\n2015-01-19 18:58:52.038 |         raise exception.ValidationError(detail=detail)\n2015-01-19 18:58:52.038 |     ValidationError: Invalid input for field/attribute server. Value: {'name': 'server_test', 'imageRef': '76fa36fc-c930-4bf3-8c8a-ea2a2420deb6', 'block_device_mapping': [{'device_name': 'foo'}], 'block_device_mapping_v2': [{'source_type': 'volume', 'uuid': 'fake_vol'}], 'flavorRef': 'http://localhost/123/flavors/3', 'metadata': {'open': 'stack', 'hello': 'world'}}. Additional properties are not allowed ('block_device_mapping_v2' was unexpected)", 
            "date_created": "2015-01-19 19:16:56.767941+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/148346", 
            "date_created": "2015-01-19 19:39:24.924079+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/148346\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=abd6d880bcff18d0a6dcef28121c00d7d172e496\nSubmitter: Jenkins\nBranch:    master\n\ncommit abd6d880bcff18d0a6dcef28121c00d7d172e496\nAuthor: Davanum Srinivas <email address hidden>\nDate:   Mon Jan 19 14:36:53 2015 -0500\n\n    Fix py27 gate failure - test_create_instance_both_bdm_formats\n    \n    Intermittent failure, depending on how the extensions get loaded.\n    The specific check for HTTPBadRequest is for the exception being\n    thrown here:\n    https://github.com/openstack/nova/blob/master/nova/api/openstack/compute/plugins/v3/block_device_mapping_v1.py#L53\n    \n    To be able to reach this piece of code, both the extensions\n    'os-block-device-mapping' and 'os-block-device-mapping-v1'\n    need to be activated. To be sure this happens all the time\n    we create a both_controllers with an empty blacklist and\n    use that for this test.\n    \n    Closes-Bug: #1412547\n    Change-Id: I284cc9f053909359a8de1a0bd85f61fbfbc98af0\n", 
            "date_created": "2015-01-20 02:46:27.933996+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2015-02-05 20:20:48.146486+00:00"
}