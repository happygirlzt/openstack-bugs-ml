{
    "status": "Won't Fix", 
    "last_updated": "2014-11-19 19:12:23.139544+00:00", 
    "description": "Using Essex 2012.1.3\n\n1) Created fixed ip network 192.168.7.0/24\nThis created an entry in both fixed_ips and networks.\n \n2) deleted using nova-manage network delete 192.168.7.0/27\n \n3)  again created the same network \n \n4) When I launch a VM, I am seeing \"Network 1 not found \" error.  \nIn the database, nova->networks table, there is no network entry with id =1 and all the entries in fixed_ips for network id=1 are set to deleted=\"t\".\n\n\nI had to manually delete network and  all the entries in fixed_ips in the database. After that I had to recreate the network. Then, it worked.", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1086464", 
    "owner": "https://api.launchpad.net/1.0/~raildo", 
    "id": 1086464, 
    "index": 3169, 
    "openned": "2012-12-04 16:42:51.666684+00:00", 
    "created": "2012-12-04 16:42:51.666684+00:00", 
    "title": "Deleted fixed network causes vm failure", 
    "comments": [
        {
            "content": "Using Essex 2012.1.3\n\n1) Created fixed ip network 192.168.7.0/24\nThis created an entry in both fixed_ips and networks.\n \n2) deleted using nova-manage network delete 192.168.7.0/27\n \n3)  again created the same network \n \n4) When I launch a VM, I am seeing \"Network 1 not found \" error.  \nIn the database, nova->networks table, there is no network entry with id =1 and all the entries in fixed_ips for network id=1 are set to deleted=\"t\".\n\n\nI had to manually delete network and  all the entries in fixed_ips in the database. After that I had to recreate the network. Then, it worked.", 
            "date_created": "2012-12-04 16:42:51.666684+00:00", 
            "author": "https://api.launchpad.net/1.0/~jaybeltur"
        }, 
        {
            "content": "Though deleting the fixed network, sets the deleted flag in fixed_ips table to 't', lauching of VM fails because mapping cache does not get cleared. Launching throws this error.\n2012-12-04 15:24:58 ERROR nova.compute.manager [req-77dd564a-3a5a-4c5c-8c33-5d5a8feb57ee 7e47b69879624465a81e1adad43dbcd2 ccb0ab914f6e49f2923632ce3b810447] [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50] Instance failed to spawn\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50] Traceback (most recent call last):\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 617, in _spawn\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]     self._legacy_nw_info(network_info), block_device_info)\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 114, in wrapped\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]     return f(*args, **kw)\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 918, in spawn\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]     block_device_info=block_device_info)\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 1527, in to_xml\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]     rescue, block_device_info)\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 1410, in _prepare_xml_info\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]     nics.append(self.vif_driver.plug(instance, network, mapping))\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/vif.py\", line 100, in plug\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]     return self._get_configurations(network, mapping)\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/vif.py\", line 70, in _get_configurations\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]     'ip_address': mapping['ips'][0]['ip'],\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50] IndexError: list index out of range\n2012-12-04 15:24:58 TRACE nova.compute.manager [instance: 4a1efa1f-c526-4d25-841c-e4d893379b50]\n2012-12-04 15:24:58 ERROR nova.utils [req-77dd564a-3a5a-4c5c-8c33-5d5a8feb57ee 7e47b69879624465a81e1adad43dbcd2 ccb0ab914f6e49f2923632ce3b810447] Original exception being dropped\n2012-12-04 15:24:58 TRACE nova.utils Traceback (most recent call last):\n2012-12-04 15:24:58 TRACE nova.utils   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 454, in _run_instance\n2012-12-04 15:24:58 TRACE nova.utils     injected_files, admin_password)\n2012-12-04 15:24:58 TRACE nova.utils   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 617, in _spawn\n2012-12-04 15:24:58 TRACE nova.utils     self._legacy_nw_info(network_info), block_device_info)\n2012-12-04 15:24:58 TRACE nova.utils   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 114, in wrapped\n2012-12-04 15:24:58 TRACE nova.utils     return f(*args, **kw)\n2012-12-04 15:24:58 TRACE nova.utils   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 918, in spawn\n2012-12-04 15:24:58 TRACE nova.utils     block_device_info=block_device_info)\n2012-12-04 15:24:58 TRACE nova.utils   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 1527, in to_xml\n2012-12-04 15:24:58 TRACE nova.utils     rescue, block_device_info)\n2012-12-04 15:24:58 TRACE nova.utils   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/connection.py\", line 1410, in _prepare_xml_info\n2012-12-04 15:24:58 TRACE nova.utils     nics.append(self.vif_driver.plug(instance, network, mapping))\n2012-12-04 15:24:58 TRACE nova.utils   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/vif.py\", line 100, in plug\n2012-12-04 15:24:58 TRACE nova.utils     return self._get_configurations(network, mapping)\n2012-12-04 15:24:58 TRACE nova.utils   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/vif.py\", line 70, in _get_configurations\n2012-12-04 15:24:58 TRACE nova.utils     'ip_address': mapping['ips'][0]['ip'],\n2012-12-04 15:24:58 TRACE nova.utils IndexError: list index out of range\n2012-12-04 15:24:58 TRACE nova.utils\n2012-12-04 15:24:58 ERROR nova.rpc.amqp [req-77dd564a-3a5a-4c5c-8c33-5d5a8feb57ee 7e47b69879624465a81e1adad43dbcd2 ccb0ab914f6e49f2923632ce3b810447] Exception during message handling\n\n\nOnly way to clear cache is to restart nova-network . Then, launching a VM works fine.\n\nDeleting a fixed network seems to require restart of nova-network.\n", 
            "date_created": "2012-12-04 21:41:36.111979+00:00", 
            "author": "https://api.launchpad.net/1.0/~jaybeltur"
        }, 
        {
            "content": "I'm trying to simulate the bug and I create a network using nova-manage,  deleted and created again. when i going to launch a VM, it worked fine.\n\nThe proper way is using the new-manage to create a network or should be done differently? If yes, how else should I do to simulate this error?", 
            "date_created": "2013-10-08 14:05:32.411095+00:00", 
            "author": "https://api.launchpad.net/1.0/~raildo"
        }, 
        {
            "content": "I tried to simulate this bug and I'm fail,but this bug occurred in an older version (Essex 2012.1.3). At this time, the packages Nova and Neutron were together, today they are separated. I think that after such separation, the error no longer occurs, and this bug should be finalized. One would look better and make sure that it can close this bug?", 
            "date_created": "2013-10-14 12:38:50.860163+00:00", 
            "author": "https://api.launchpad.net/1.0/~raildo"
        }, 
        {
            "content": "Essex is not supported anymore.", 
            "date_created": "2014-11-19 19:12:15.512186+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }
    ], 
    "closed": "2014-11-19 19:12:20.593965+00:00"
}