{
    "status": "Won't Fix", 
    "last_updated": "2017-09-27 17:07:23.291217+00:00", 
    "description": "This shows up quite often in the cells jobs but it's not contributing to overall failures (from what I can tell) but we should get the ugly trace cleaned up:\n\nhttp://logs.openstack.org/58/175458/3/check/check-tempest-dsvm-cells/ce91d7e/logs/screen-n-cell-child.txt.gz?level=TRACE#_2015-04-24_15_28_53_498\n\n2015-04-24 15:28:53.498 ERROR nova.cells.messaging [req-6918b2e1-899d-49ff-a42e-b0c84e61b7ff AuthorizationTestJSON-1347876921 AuthorizationTestJSON-1581495686] Error processing message locally\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging Traceback (most recent call last):\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/cells/messaging.py\", line 200, in _process_locally\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     resp_value = self.msg_runner._process_message_locally(self)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/cells/messaging.py\", line 1285, in _process_message_locally\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return fn(message, **message.method_kwargs)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/cells/messaging.py\", line 698, in run_compute_api_method\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return fn(message.ctxt, *args, **method_info['method_kwargs'])\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/compute/api.py\", line 226, in wrapped\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return func(self, context, target, *args, **kwargs)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/compute/api.py\", line 215, in inner\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return function(self, context, instance, *args, **kwargs)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/compute/api.py\", line 196, in inner\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return f(self, context, instance, *args, **kw)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/compute/api.py\", line 3150, in delete_instance_metadata\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     instance.delete_metadata_key(key)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/objects/base.py\", line 208, in wrapper\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return fn(self, *args, **kwargs)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/objects/instance.py\", line 1058, in delete_metadata_key\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     del self.metadata[key]\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging KeyError: u'meta1'\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging \n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiRXJyb3IgcHJvY2Vzc2luZyBtZXNzYWdlIGxvY2FsbHlcIiBBTkQgbWVzc2FnZTpcImRlbGV0ZV9tZXRhZGF0YV9rZXlcIiBBTkQgbWVzc2FnZTpcIktleUVycm9yXCIgQU5EIHRhZ3M6XCJzY3JlZW4tbi1jZWxsLWNoaWxkLnR4dFwiIiwiZmllbGRzIjpbXSwib2Zmc2V0IjowLCJ0aW1lZnJhbWUiOiI2MDQ4MDAiLCJncmFwaG1vZGUiOiJjb3VudCIsInRpbWUiOnsidXNlcl9pbnRlcnZhbCI6MH0sInN0YW1wIjoxNDI5OTA3ODIzMTAzfQ==", 
    "tags": [
        "cells"
    ], 
    "importance": "Low", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1448302", 
    "owner": "None", 
    "id": 1448302, 
    "index": 1707, 
    "openned": "2015-04-24 20:46:06.569080+00:00", 
    "created": "2015-04-24 20:46:06.569080+00:00", 
    "title": "cells: intermittent KeyError when deleting instance metadata", 
    "comments": [
        {
            "content": "This shows up quite often in the cells jobs but it's not contributing to overall failures (from what I can tell) but we should get the ugly trace cleaned up:\n\nhttp://logs.openstack.org/58/175458/3/check/check-tempest-dsvm-cells/ce91d7e/logs/screen-n-cell-child.txt.gz?level=TRACE#_2015-04-24_15_28_53_498\n\n2015-04-24 15:28:53.498 ERROR nova.cells.messaging [req-6918b2e1-899d-49ff-a42e-b0c84e61b7ff AuthorizationTestJSON-1347876921 AuthorizationTestJSON-1581495686] Error processing message locally\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging Traceback (most recent call last):\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/cells/messaging.py\", line 200, in _process_locally\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     resp_value = self.msg_runner._process_message_locally(self)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/cells/messaging.py\", line 1285, in _process_message_locally\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return fn(message, **message.method_kwargs)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/cells/messaging.py\", line 698, in run_compute_api_method\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return fn(message.ctxt, *args, **method_info['method_kwargs'])\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/compute/api.py\", line 226, in wrapped\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return func(self, context, target, *args, **kwargs)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/compute/api.py\", line 215, in inner\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return function(self, context, instance, *args, **kwargs)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/compute/api.py\", line 196, in inner\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return f(self, context, instance, *args, **kw)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/compute/api.py\", line 3150, in delete_instance_metadata\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     instance.delete_metadata_key(key)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/objects/base.py\", line 208, in wrapper\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     return fn(self, *args, **kwargs)\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging   File \"/opt/stack/new/nova/nova/objects/instance.py\", line 1058, in delete_metadata_key\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging     del self.metadata[key]\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging KeyError: u'meta1'\n2015-04-24 15:28:53.498 32510 TRACE nova.cells.messaging \n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwiRXJyb3IgcHJvY2Vzc2luZyBtZXNzYWdlIGxvY2FsbHlcIiBBTkQgbWVzc2FnZTpcImRlbGV0ZV9tZXRhZGF0YV9rZXlcIiBBTkQgbWVzc2FnZTpcIktleUVycm9yXCIgQU5EIHRhZ3M6XCJzY3JlZW4tbi1jZWxsLWNoaWxkLnR4dFwiIiwiZmllbGRzIjpbXSwib2Zmc2V0IjowLCJ0aW1lZnJhbWUiOiI2MDQ4MDAiLCJncmFwaG1vZGUiOiJjb3VudCIsInRpbWUiOnsidXNlcl9pbnRlcnZhbCI6MH0sInN0YW1wIjoxNDI5OTA3ODIzMTAzfQ==", 
            "date_created": "2015-04-24 20:46:06.569080+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "There are a bunch of tests in tempest that use that same meta1 test key value, but it looks like this specific trace is from a test in here:\n\nhttp://git.openstack.org/cgit/openstack/tempest/tree/tempest/api/compute/test_authorization.py\n\nThese look like mostly negative tests so that's probably why the traces in the logs aren't affecting things.", 
            "date_created": "2015-04-24 21:42:19.338661+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "e.g. http://git.openstack.org/cgit/openstack/tempest/tree/tempest/api/compute/test_authorization.py#n394\n", 
            "date_created": "2015-04-24 21:43:26.854987+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "This is a latent race bug with cells v1, which is deprecated, so we're not going to focus on fixing this.", 
            "date_created": "2017-09-27 17:07:22.081967+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }
    ], 
    "closed": "2017-09-27 17:07:08.155886+00:00"
}