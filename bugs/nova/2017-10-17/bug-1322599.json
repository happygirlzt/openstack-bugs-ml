{
    "status": "Invalid", 
    "last_updated": "2014-09-11 15:22:01.082580+00:00", 
    "description": "baremetal-node-create fails with HTTP 500 as pm_password we pass is bigger than allowed; DB schema reports VARCHAR255\n\ntrace is as follows:\n\nnova.openstack.common.db.sqlalchemy.session   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/nova/openstack/common/db/sqlalchemy/session.py\", line 439, in _wrap\nnova.openstack.common.db.sqlalchemy.session     return f(self, *args, **kwargs)\nnova.openstack.common.db.sqlalchemy.session   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/nova/openstack/common/db/sqlalchemy/session.py\", line 705, in flush\nnova.openstack.common.db.sqlalchemy.session     return super(Session, self).flush(*args, **kwargs)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1824, in flush\nnova.openstack.common.db.sqlalchemy.session     self._flush(objects)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1942, in _flush\nnova.openstack.common.db.sqlalchemy.session     transaction.rollback(_capture_exception=True)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/util/langhelpers.py\", line 58, in __exit__\nnova.openstack.common.db.sqlalchemy.session     compat.reraise(exc_type, exc_value, exc_tb)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1906, in _flush\nnova.openstack.common.db.sqlalchemy.session     flush_context.execute()\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/unitofwork.py\", line 372, in execute\nnova.openstack.common.db.sqlalchemy.session     rec.execute(self)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/unitofwork.py\", line 525, in execute\nnova.openstack.common.db.sqlalchemy.session     uow\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/persistence.py\", line 64, in save_obj\nnova.openstack.common.db.sqlalchemy.session     table, insert)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/persistence.py\", line 569, in _emit_insert_statements\nnova.openstack.common.db.sqlalchemy.session     execute(statement, params)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 662, in execute\nnova.openstack.common.db.sqlalchemy.session     params)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 761, in _execute_clauseelement\nnova.openstack.common.db.sqlalchemy.session     compiled_sql, distilled_params\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 874, in _execute_context\nnova.openstack.common.db.sqlalchemy.session     context)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1024, in _handle_dbapi_exception\nnova.openstack.common.db.sqlalchemy.session     exc_info\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/util/compat.py\", line 196, in raise_from_cause\nnova.openstack.common.db.sqlalchemy.session     reraise(type(exception), exception, tb=exc_tb)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 867, in _execute_context\nnova.openstack.common.db.sqlalchemy.session     context)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/default.py\", line 324, in do_execute\nnova.openstack.common.db.sqlalchemy.session     cursor.execute(statement, parameters)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/MySQLdb/cursors.py\", line 174, in execute\nnova.openstack.common.db.sqlalchemy.session     self.errorhandler(self, exc, value)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/MySQLdb/connections.py\", line 36, in defaulterrorhandler\nnova.openstack.common.db.sqlalchemy.session     raise errorclass, errorvalue\nnova.openstack.common.db.sqlalchemy.session DataError: (DataError) (1406, \"Data too long for column 'pm_password' at row 1\") 'INSERT INTO bm_nodes (created_at, updated_at, deleted_at, deleted, uuid, service_host, instance_uuid, instance_na\nme, cpus, memory_mb, local_gb, preserve_ephemeral, pm_address, pm_user, pm_password, task_state, terminal_port, image_path, pxe_config_path, deploy_key, root_mb, swap_mb, ephemeral_mb)", 
    "tags": [
        "baremetal"
    ], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1322599", 
    "owner": "None", 
    "id": 1322599, 
    "index": 6136, 
    "openned": "2014-05-23 13:06:48.190790+00:00", 
    "created": "2014-05-23 12:25:45.690649+00:00", 
    "title": "nova baremetal-node-create fails with HTTP 500", 
    "comments": [
        {
            "content": "baremetal-node-create fails with HTTP 500 as pm_password we pass is bigger than allowed; DB schema reports VARCHAR255\n\ntrace is as follows:\n\nnova.openstack.common.db.sqlalchemy.session   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/nova/openstack/common/db/sqlalchemy/session.py\", line 439, in _wrap\nnova.openstack.common.db.sqlalchemy.session     return f(self, *args, **kwargs)\nnova.openstack.common.db.sqlalchemy.session   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/nova/openstack/common/db/sqlalchemy/session.py\", line 705, in flush\nnova.openstack.common.db.sqlalchemy.session     return super(Session, self).flush(*args, **kwargs)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1824, in flush\nnova.openstack.common.db.sqlalchemy.session     self._flush(objects)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1942, in _flush\nnova.openstack.common.db.sqlalchemy.session     transaction.rollback(_capture_exception=True)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/util/langhelpers.py\", line 58, in __exit__\nnova.openstack.common.db.sqlalchemy.session     compat.reraise(exc_type, exc_value, exc_tb)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/session.py\", line 1906, in _flush\nnova.openstack.common.db.sqlalchemy.session     flush_context.execute()\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/unitofwork.py\", line 372, in execute\nnova.openstack.common.db.sqlalchemy.session     rec.execute(self)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/unitofwork.py\", line 525, in execute\nnova.openstack.common.db.sqlalchemy.session     uow\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/persistence.py\", line 64, in save_obj\nnova.openstack.common.db.sqlalchemy.session     table, insert)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/orm/persistence.py\", line 569, in _emit_insert_statements\nnova.openstack.common.db.sqlalchemy.session     execute(statement, params)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 662, in execute\nnova.openstack.common.db.sqlalchemy.session     params)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 761, in _execute_clauseelement\nnova.openstack.common.db.sqlalchemy.session     compiled_sql, distilled_params\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 874, in _execute_context\nnova.openstack.common.db.sqlalchemy.session     context)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 1024, in _handle_dbapi_exception\nnova.openstack.common.db.sqlalchemy.session     exc_info\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/util/compat.py\", line 196, in raise_from_cause\nnova.openstack.common.db.sqlalchemy.session     reraise(type(exception), exception, tb=exc_tb)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/base.py\", line 867, in _execute_context\nnova.openstack.common.db.sqlalchemy.session     context)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/sqlalchemy/engine/default.py\", line 324, in do_execute\nnova.openstack.common.db.sqlalchemy.session     cursor.execute(statement, parameters)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/MySQLdb/cursors.py\", line 174, in execute\nnova.openstack.common.db.sqlalchemy.session     self.errorhandler(self, exc, value)\nnova.openstack.common.db.sqlalchemy.session   File \"/usr/lib64/python2.7/site-packages/MySQLdb/connections.py\", line 36, in defaulterrorhandler\nnova.openstack.common.db.sqlalchemy.session     raise errorclass, errorvalue\nnova.openstack.common.db.sqlalchemy.session DataError: (DataError) (1406, \"Data too long for column 'pm_password' at row 1\") 'INSERT INTO bm_nodes (created_at, updated_at, deleted_at, deleted, uuid, service_host, instance_uuid, instance_na\nme, cpus, memory_mb, local_gb, preserve_ephemeral, pm_address, pm_user, pm_password, task_state, terminal_port, image_path, pxe_config_path, deploy_key, root_mb, swap_mb, ephemeral_mb)", 
            "date_created": "2014-05-23 12:25:45.690649+00:00", 
            "author": "https://api.launchpad.net/1.0/~gfidente"
        }, 
        {
            "content": "I'm trying to revert If26b648dee95abc5aa0bf80d3111265b00141b6d and see if things work", 
            "date_created": "2014-05-23 12:52:46.592315+00:00", 
            "author": "https://api.launchpad.net/1.0/~gfidente"
        }, 
        {
            "content": "Reverting fixed the issue. The change If26b648dee95abc5aa0bf80d3111265b00141b6d inherits from oslo-incubator \"a584166 Make TRADITIONAL the default SQL mode\".\n\nWith TRADITIONAL mode off, we were truncating pm_password to 255, now it is raising an error.\n\nI think though we should *not* paste the rsa key in pm_password, virtual_power_driver expects the key to be a file configured by: virtual_power_host_key", 
            "date_created": "2014-05-23 13:16:38.626767+00:00", 
            "author": "https://api.launchpad.net/1.0/~gfidente"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/95181", 
            "date_created": "2014-05-23 14:56:34.462743+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/95445", 
            "date_created": "2014-05-26 07:46:08.947998+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/95445\nCommitted: https://git.openstack.org/cgit/openstack/tripleo-incubator/commit/?id=b14981502e9c72be7623ed1920163deebdda4337\nSubmitter: Jenkins\nBranch:    master\n\ncommit b14981502e9c72be7623ed1920163deebdda4337\nAuthor: Steve Kowalik <email address hidden>\nDate:   Mon May 26 17:43:08 2014 +1000\n\n    Clamp pm_password to 255 for nova-bm nodes\n    \n    Due to nova If26b648dee95abc5aa0bf80d3111265b00141b6d, pm_password\n    is now enforced to be 255 characters, so clamp pm_password to 255\n    characters before creating the node.\n    \n    Change-Id: Id5c489eb7d6ef555c588207e7f5ba34a55d33000\n    Closes-Bug: #1322599\n", 
            "date_created": "2014-05-29 04:14:51.280976+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2014-09-11 15:21:58.086772+00:00"
}