{
    "status": "Fix Released", 
    "last_updated": "2015-04-30 09:23:25.452263+00:00", 
    "description": "It is not possible to boot the image that was created with nova image-create from a volume backed instance.\n\nSteps to reproduce:\nstack@stack:~/devstack$ nova boot --flavor 100 --block-device source=image,id=70b5a8e8-846f-40dc-a52d-558d37dfc7f1,dest=volume,bootindex=0,size=1 volume-backed\n+--------------------------------------+-------------------------------------------------+\n| Property                             | Value                                           |\n+--------------------------------------+-------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                          |\n| OS-EXT-AZ:availability_zone          | nova                                            |\n| OS-EXT-SRV-ATTR:host                 | -                                               |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | -                                               |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000017                               |\n| OS-EXT-STS:power_state               | 0                                               |\n| OS-EXT-STS:task_state                | scheduling                                      |\n| OS-EXT-STS:vm_state                  | building                                        |\n| OS-SRV-USG:launched_at               | -                                               |\n| OS-SRV-USG:terminated_at             | -                                               |\n| accessIPv4                           |                                                 |\n| accessIPv6                           |                                                 |\n| adminPass                            | wvUa22QCTaoR                                    |\n| config_drive                         |                                                 |\n| created                              | 2014-10-15T15:07:39Z                            |\n| flavor                               | install-test (100)                              |\n| hostId                               |                                                 |\n| id                                   | 9ad985f6-5e76-4545-9702-0b8a6058ef57            |\n| image                                | Attempt to boot from volume - no image supplied |\n| key_name                             | -                                               |\n| metadata                             | {}                                              |\n| name                                 | volume-backed                                   |\n| os-extended-volumes:volumes_attached | []                                              |\n| progress                             | 0                                               |\n| security_groups                      | default                                         |\n| status                               | BUILD                                           |\n| tenant_id                            | 89dda4659c7e403392e9bcfc14ca6c80                |\n| updated                              | 2014-10-15T15:07:39Z                            |\n| user_id                              | 4c9283c1cbc54d688e2dda83fbc4aa11                |\n+--------------------------------------+-------------------------------------------------+\n\n\nstack@stack:~/devstack$ nova show 9ad985f6-5e76-4545-9702-0b8a6058ef57\n+--------------------------------------+----------------------------------------------------------+\n| Property                             | Value                                                    |\n+--------------------------------------+----------------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                                   |\n| OS-EXT-AZ:availability_zone          | nova                                                     |\n| OS-EXT-SRV-ATTR:host                 | stack                                                    |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | stack                                                    |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000017                                        |\n| OS-EXT-STS:power_state               | 1                                                        |\n| OS-EXT-STS:task_state                | -                                                        |\n| OS-EXT-STS:vm_state                  | active                                                   |\n| OS-SRV-USG:launched_at               | 2014-10-15T15:07:47.000000                               |\n| OS-SRV-USG:terminated_at             | -                                                        |\n| accessIPv4                           |                                                          |\n| accessIPv6                           |                                                          |\n| config_drive                         |                                                          |\n| created                              | 2014-10-15T15:07:39Z                                     |\n| flavor                               | install-test (100)                                       |\n| hostId                               | 337fdcb2bd1ee3ad5bbe5e498310984745f473c82ef41b7276d1b449 |\n| id                                   | 9ad985f6-5e76-4545-9702-0b8a6058ef57                     |\n| image                                | Attempt to boot from volume - no image supplied          |\n| key_name                             | -                                                        |\n| metadata                             | {}                                                       |\n| name                                 | volume-backed                                            |\n| os-extended-volumes:volumes_attached | [{\"id\": \"fdcc1414-a42e-42f7-803e-d40f8b872787\"}]         |\n| private network                      | 10.0.0.2                                                 |\n| progress                             | 0                                                        |\n| security_groups                      | default                                                  |\n| status                               | ACTIVE                                                   |\n| tenant_id                            | 89dda4659c7e403392e9bcfc14ca6c80                         |\n| updated                              | 2014-10-15T15:07:47Z                                     |\n| user_id                              | 4c9283c1cbc54d688e2dda83fbc4aa11                         |\n+--------------------------------------+----------------------------------------------------------+\nstack@stack:~/devstack$ nova image-create 9ad985f6-5e76-4545-9702-0b8a6058ef57 image-from-volume-backed\nstack@stack:~/devstack$ nova image-show image-from-volume-backed\n+-------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Property                      | Value                                                                                                                                                                                                                                                                                                              |\n+-------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| OS-EXT-IMG-SIZE:size          | 0                                                                                                                                                                                                                                                                                                                  |\n| created                       | 2014-10-15T15:10:40Z                                                                                                                                                                                                                                                                                               |\n| id                            | c0283b1b-e567-48ce-b784-0ff1ce8245bb                                                                                                                                                                                                                                                                               |\n| metadata bdm_v2               | True                                                                                                                                                                                                                                                                                                               |\n| metadata block_device_mapping | [{\"guest_format\": null, \"boot_index\": 0, \"no_device\": null, \"image_id\": null, \"snapshot_id\": \"ed729800-36ab-4ba1-89c2-36f99bd398a9\", \"disk_bus\": \"virtio\", \"volume_size\": null, \"source_type\": \"snapshot\", \"device_type\": \"disk\", \"volume_id\": null, \"destination_type\": \"volume\", \"delete_on_termination\": null}] |\n| metadata checksum             | 4eada48c2843d2a262c814ddc92ecf2c                                                                                                                                                                                                                                                                                   |\n| metadata container_format     | ami                                                                                                                                                                                                                                                                                                                |\n| metadata disk_format          | ami                                                                                                                                                                                                                                                                                                                |\n| metadata image_id             | 70b5a8e8-846f-40dc-a52d-558d37dfc7f1                                                                                                                                                                                                                                                                               |\n| metadata image_name           | cirros-0.3.2-x86_64-uec                                                                                                                                                                                                                                                                                            |\n| metadata kernel_id            | 3d8e1ae1-7e24-45d8-9064-adfcf18d1b80                                                                                                                                                                                                                                                                               |\n| metadata min_disk             | 0                                                                                                                                                                                                                                                                                                                  |\n| metadata min_ram              | 0                                                                                                                                                                                                                                                                                                                  |\n| metadata ramdisk_id           | 5634fe26-f909-4c88-a455-e6e44fa8ee56                                                                                                                                                                                                                                                                               |\n| metadata root_device_name     | /dev/vda                                                                                                                                                                                                                                                                                                           |\n| metadata size                 | 25165824                                                                                                                                                                                                                                                                                                           |\n| minDisk                       | 0                                                                                                                                                                                                                                                                                                                  |\n| minRam                        | 0                                                                                                                                                                                                                                                                                                                  |\n| name                          | image-from-volume-backed                                                                                                                                                                                                                                                                                           |\n| progress                      | 100                                                                                                                                                                                                                                                                                                                |\n| status                        | ACTIVE                                                                                                                                                                                                                                                                                                             |\n| updated                       | 2014-10-15T15:10:40Z                                                                                                                                                                                                                                                                                               |\n+-------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\nstack@stack:~/devstack$ nova boot --flavor 100 --block-device source=image,id=c0283b1b-e567-48ce-b784-0ff1ce8245bb,dest=volume,bootindex=0,size=1 volume-backed-from-snap-image\nERROR (BadRequest): Block Device Mapping is Invalid: Boot sequence for the instance and image/block device mapping combination is not valid. (HTTP 400) (Request-ID: req-87ae0d82-65dc-4b7b-ac99-88f70b7fe32c)\n\nIt seems that it is only a validation problem on API level as the same image can be booted with --image parameter.", 
    "tags": [], 
    "importance": "Low", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1381598", 
    "owner": "https://api.launchpad.net/1.0/~balazs-gibizer", 
    "id": 1381598, 
    "index": 1425, 
    "openned": "2014-10-15 15:24:57.147674+00:00", 
    "created": "2014-10-15 15:24:57.147674+00:00", 
    "title": "boot from image created with nova image-create from a volume backed instance is rejected", 
    "comments": [
        {
            "content": "It is not possible to boot the image that was created with nova image-create from a volume backed instance.\n\nSteps to reproduce:\nstack@stack:~/devstack$ nova boot --flavor 100 --block-device source=image,id=70b5a8e8-846f-40dc-a52d-558d37dfc7f1,dest=volume,bootindex=0,size=1 volume-backed\n+--------------------------------------+-------------------------------------------------+\n| Property                             | Value                                           |\n+--------------------------------------+-------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                          |\n| OS-EXT-AZ:availability_zone          | nova                                            |\n| OS-EXT-SRV-ATTR:host                 | -                                               |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | -                                               |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000017                               |\n| OS-EXT-STS:power_state               | 0                                               |\n| OS-EXT-STS:task_state                | scheduling                                      |\n| OS-EXT-STS:vm_state                  | building                                        |\n| OS-SRV-USG:launched_at               | -                                               |\n| OS-SRV-USG:terminated_at             | -                                               |\n| accessIPv4                           |                                                 |\n| accessIPv6                           |                                                 |\n| adminPass                            | wvUa22QCTaoR                                    |\n| config_drive                         |                                                 |\n| created                              | 2014-10-15T15:07:39Z                            |\n| flavor                               | install-test (100)                              |\n| hostId                               |                                                 |\n| id                                   | 9ad985f6-5e76-4545-9702-0b8a6058ef57            |\n| image                                | Attempt to boot from volume - no image supplied |\n| key_name                             | -                                               |\n| metadata                             | {}                                              |\n| name                                 | volume-backed                                   |\n| os-extended-volumes:volumes_attached | []                                              |\n| progress                             | 0                                               |\n| security_groups                      | default                                         |\n| status                               | BUILD                                           |\n| tenant_id                            | 89dda4659c7e403392e9bcfc14ca6c80                |\n| updated                              | 2014-10-15T15:07:39Z                            |\n| user_id                              | 4c9283c1cbc54d688e2dda83fbc4aa11                |\n+--------------------------------------+-------------------------------------------------+\n\n\nstack@stack:~/devstack$ nova show 9ad985f6-5e76-4545-9702-0b8a6058ef57\n+--------------------------------------+----------------------------------------------------------+\n| Property                             | Value                                                    |\n+--------------------------------------+----------------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                                   |\n| OS-EXT-AZ:availability_zone          | nova                                                     |\n| OS-EXT-SRV-ATTR:host                 | stack                                                    |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | stack                                                    |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000017                                        |\n| OS-EXT-STS:power_state               | 1                                                        |\n| OS-EXT-STS:task_state                | -                                                        |\n| OS-EXT-STS:vm_state                  | active                                                   |\n| OS-SRV-USG:launched_at               | 2014-10-15T15:07:47.000000                               |\n| OS-SRV-USG:terminated_at             | -                                                        |\n| accessIPv4                           |                                                          |\n| accessIPv6                           |                                                          |\n| config_drive                         |                                                          |\n| created                              | 2014-10-15T15:07:39Z                                     |\n| flavor                               | install-test (100)                                       |\n| hostId                               | 337fdcb2bd1ee3ad5bbe5e498310984745f473c82ef41b7276d1b449 |\n| id                                   | 9ad985f6-5e76-4545-9702-0b8a6058ef57                     |\n| image                                | Attempt to boot from volume - no image supplied          |\n| key_name                             | -                                                        |\n| metadata                             | {}                                                       |\n| name                                 | volume-backed                                            |\n| os-extended-volumes:volumes_attached | [{\"id\": \"fdcc1414-a42e-42f7-803e-d40f8b872787\"}]         |\n| private network                      | 10.0.0.2                                                 |\n| progress                             | 0                                                        |\n| security_groups                      | default                                                  |\n| status                               | ACTIVE                                                   |\n| tenant_id                            | 89dda4659c7e403392e9bcfc14ca6c80                         |\n| updated                              | 2014-10-15T15:07:47Z                                     |\n| user_id                              | 4c9283c1cbc54d688e2dda83fbc4aa11                         |\n+--------------------------------------+----------------------------------------------------------+\nstack@stack:~/devstack$ nova image-create 9ad985f6-5e76-4545-9702-0b8a6058ef57 image-from-volume-backed\nstack@stack:~/devstack$ nova image-show image-from-volume-backed\n+-------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| Property                      | Value                                                                                                                                                                                                                                                                                                              |\n+-------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n| OS-EXT-IMG-SIZE:size          | 0                                                                                                                                                                                                                                                                                                                  |\n| created                       | 2014-10-15T15:10:40Z                                                                                                                                                                                                                                                                                               |\n| id                            | c0283b1b-e567-48ce-b784-0ff1ce8245bb                                                                                                                                                                                                                                                                               |\n| metadata bdm_v2               | True                                                                                                                                                                                                                                                                                                               |\n| metadata block_device_mapping | [{\"guest_format\": null, \"boot_index\": 0, \"no_device\": null, \"image_id\": null, \"snapshot_id\": \"ed729800-36ab-4ba1-89c2-36f99bd398a9\", \"disk_bus\": \"virtio\", \"volume_size\": null, \"source_type\": \"snapshot\", \"device_type\": \"disk\", \"volume_id\": null, \"destination_type\": \"volume\", \"delete_on_termination\": null}] |\n| metadata checksum             | 4eada48c2843d2a262c814ddc92ecf2c                                                                                                                                                                                                                                                                                   |\n| metadata container_format     | ami                                                                                                                                                                                                                                                                                                                |\n| metadata disk_format          | ami                                                                                                                                                                                                                                                                                                                |\n| metadata image_id             | 70b5a8e8-846f-40dc-a52d-558d37dfc7f1                                                                                                                                                                                                                                                                               |\n| metadata image_name           | cirros-0.3.2-x86_64-uec                                                                                                                                                                                                                                                                                            |\n| metadata kernel_id            | 3d8e1ae1-7e24-45d8-9064-adfcf18d1b80                                                                                                                                                                                                                                                                               |\n| metadata min_disk             | 0                                                                                                                                                                                                                                                                                                                  |\n| metadata min_ram              | 0                                                                                                                                                                                                                                                                                                                  |\n| metadata ramdisk_id           | 5634fe26-f909-4c88-a455-e6e44fa8ee56                                                                                                                                                                                                                                                                               |\n| metadata root_device_name     | /dev/vda                                                                                                                                                                                                                                                                                                           |\n| metadata size                 | 25165824                                                                                                                                                                                                                                                                                                           |\n| minDisk                       | 0                                                                                                                                                                                                                                                                                                                  |\n| minRam                        | 0                                                                                                                                                                                                                                                                                                                  |\n| name                          | image-from-volume-backed                                                                                                                                                                                                                                                                                           |\n| progress                      | 100                                                                                                                                                                                                                                                                                                                |\n| status                        | ACTIVE                                                                                                                                                                                                                                                                                                             |\n| updated                       | 2014-10-15T15:10:40Z                                                                                                                                                                                                                                                                                               |\n+-------------------------------+--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+\n\nstack@stack:~/devstack$ nova boot --flavor 100 --block-device source=image,id=c0283b1b-e567-48ce-b784-0ff1ce8245bb,dest=volume,bootindex=0,size=1 volume-backed-from-snap-image\nERROR (BadRequest): Block Device Mapping is Invalid: Boot sequence for the instance and image/block device mapping combination is not valid. (HTTP 400) (Request-ID: req-87ae0d82-65dc-4b7b-ac99-88f70b7fe32c)\n\nIt seems that it is only a validation problem on API level as the same image can be booted with --image parameter.", 
            "date_created": "2014-10-15 15:24:57.147674+00:00", 
            "author": "https://api.launchpad.net/1.0/~balazs-gibizer"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/128891", 
            "date_created": "2014-10-16 11:44:13.091044+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/128891\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=48fca2fa32bf9f8cf2bba035fc3ad6fd9170e6f4\nSubmitter: Jenkins\nBranch:    master\n\ncommit 48fca2fa32bf9f8cf2bba035fc3ad6fd9170e6f4\nAuthor: Balazs Gibizer <email address hidden>\nDate:   Wed Oct 15 16:58:55 2014 +0200\n\n    Fix bdm transformation for volume backed servers\n    \n    When volume backed server is snapshoted with nova image-create\n    then the image is created with a proper bdm. However when this\n    image is booted with image->volume bdm the two bdms are not\n    merged properly and the server cannot be booted as it gets two\n    boot_index = 0 device\n    \n    This patch solves the issue by removing the unnecessary device\n    from the mapping.\n    \n    Closes-bug: #1381598\n    \n    Change-Id: I170e80d35fe8a8d906370a507148351926763a13\n", 
            "date_created": "2015-02-06 14:27:01.207090+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2015-03-20 07:39:54.569745+00:00"
}