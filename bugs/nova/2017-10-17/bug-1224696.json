{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 12:10:01.803331+00:00", 
    "description": "On xenapi, we have observed instance builds successfully passing resource tracker claims, but then failing on dom0 due to out of memory errors.\n\n['HOST_NOT_ENOUGH_FREE_MEMORY', '8662286336', '8652775424']\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/compute/manager.py\", line 1043, in _build_instance\n    set_access_ip=set_access_ip)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/compute/manager.py\", line 1248, in _spawn\n    LOG.exception(_('Instance failed to spawn'), instance=instance)\n  File \"/usr/lib/python2.6/contextlib.py\", line 23, in __exit__\n    self.gen.next()\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/compute/manager.py\", line 1244, in _spawn\n    block_device_info)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/driver.py\", line 177, in spawn\n    admin_password, network_info, block_device_info)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 594, in spawn\n    undo_mgr.rollback_and_reraise(msg=msg, instance=instance)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/utils.py\", line 974, in rollback_and_reraise\n    self._rollback()\n  File \"/usr/lib/python2.6/contextlib.py\", line 23, in __exit__\n    self.gen.next()\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 589, in spawn\n    boot_instance_step(undo_mgr, vm_ref)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 220, in inner\n    rv = f(*args, **kwargs)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 536, in boot_instance_step\n    admin_password, image_meta)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 801, in _boot_new_instance\n    self._start(instance, vm_ref)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 397, in _start\n    False, False)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/driver.py\", line 723, in call_xenapi\n    return session.xenapi_request(method, args)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/XenAPI.py\", line 133, in xenapi_request\n    result = _parse_result(getattr(self, methodname)(*full_params))\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/XenAPI.py\", line 203, in _parse_result\n    raise Failure(result['ErrorDescription'])", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1224696", 
    "owner": "https://api.launchpad.net/1.0/~belliott", 
    "id": 1224696, 
    "index": 5350, 
    "openned": "2013-09-12 21:30:34.058633+00:00", 
    "created": "2013-09-12 21:30:34.058633+00:00", 
    "title": "xenapi out of memory errors", 
    "comments": [
        {
            "content": "On xenapi, we have observed instance builds successfully passing resource tracker claims, but then failing on dom0 due to out of memory errors.\n\n['HOST_NOT_ENOUGH_FREE_MEMORY', '8662286336', '8652775424']\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/compute/manager.py\", line 1043, in _build_instance\n    set_access_ip=set_access_ip)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/compute/manager.py\", line 1248, in _spawn\n    LOG.exception(_('Instance failed to spawn'), instance=instance)\n  File \"/usr/lib/python2.6/contextlib.py\", line 23, in __exit__\n    self.gen.next()\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/compute/manager.py\", line 1244, in _spawn\n    block_device_info)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/driver.py\", line 177, in spawn\n    admin_password, network_info, block_device_info)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 594, in spawn\n    undo_mgr.rollback_and_reraise(msg=msg, instance=instance)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/utils.py\", line 974, in rollback_and_reraise\n    self._rollback()\n  File \"/usr/lib/python2.6/contextlib.py\", line 23, in __exit__\n    self.gen.next()\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 589, in spawn\n    boot_instance_step(undo_mgr, vm_ref)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 220, in inner\n    rv = f(*args, **kwargs)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 536, in boot_instance_step\n    admin_password, image_meta)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 801, in _boot_new_instance\n    self._start(instance, vm_ref)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/vmops.py\", line 397, in _start\n    False, False)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/nova/virt/xenapi/driver.py\", line 723, in call_xenapi\n    return session.xenapi_request(method, args)\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/XenAPI.py\", line 133, in xenapi_request\n    result = _parse_result(getattr(self, methodname)(*full_params))\n  File \"/opt/rackstack/264.37/nova/lib/python2.6/site-packages/XenAPI.py\", line 203, in _parse_result\n    raise Failure(result['ErrorDescription'])", 
            "date_created": "2013-09-12 21:30:34.058633+00:00", 
            "author": "https://api.launchpad.net/1.0/~belliott"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/35380\nCommitted: http://github.com/openstack/nova/commit/7524194b2f1dd0ab159933d5ffab1cab461f5e6f\nSubmitter: Jenkins\nBranch:    master\n\ncommit 7524194b2f1dd0ab159933d5ffab1cab461f5e6f\nAuthor: Brian Elliott <email address hidden>\nDate:   Sun Jun 30 16:34:25 2013 +0000\n\n    xenapi: Add per-instance memory overhead values\n    \n    Add calculation of per-instance memory virtualization overhead to\n    xenapi driver.\n    \n    bug 1224696\n    \n    Change-Id: I7f638751af0051a7006677b5fb3c9d9b9ef57da9\n", 
            "date_created": "2013-09-16 16:37:05.323419+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-10-03 08:01:42.753054+00:00"
}