{
    "status": "Invalid", 
    "last_updated": "2016-02-17 16:32:10.286612+00:00", 
    "description": "Greetings,\n\nWhen trying to use nova live-migration we do have this trace on the compute node logs (nova-compute.log)\nThe Vm stays in \"MIGRATING\" state, the VM is still up on the originating node, and never moves.\n\nVERSION IN USE: ( KILO v1 )\n\nroot@compute2:~# dpkg -l | grep nova\nii  nova-common                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - common files\nii  nova-compute                        1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node base\nii  nova-compute-kvm                    1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node (KVM)\nii  nova-compute-libvirt                1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node libvirt support\nii  python-nova                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute Python libraries\nii  python-novaclient                   1:2.22.0-0ubuntu1~cloud0              all          client library for OpenStack Compute API\n\nCMD:\n\nnova migrate-live 6b91ffb3-bf84-48e9-b07d-99603c89055c compute4\n\nLOGS (/var/log/nova/nova-compute.log):\n\n2016-01-18 09:55:46.160 18571 ERROR oslo_messaging.rpc.dispatcher [req-fae37d19-0867-4796-9df3-b08be2120d15 ad8ac2392f41482e887c6b44402a641d dfcd0863f170402689d89771da0ea3ff - - -] Exception during message handling: 'module' object has no attribute 'spawn'\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     executor_callback))\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     executor_callback)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 6668, in live_migration\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     migrate_data=migrate_data)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 88, in wrapped\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     payload)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 71, in wrapped\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 355, in decorated_function\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 343, in decorated_function\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 5237, in live_migration\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     block_migration, migrate_data)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 5330, in live_migration\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     utils.spawn(self._live_migration, context, instance, dest,\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher AttributeError: 'module' object has no attribute 'spawn'\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher\n\nCMD:\n\nnova host-evacuate-live compute8\n\nLOGS (/var/log/nova/nova-compute.log):\n\n2016-01-18 10:17:09.807 14122 ERROR oslo_messaging.rpc.dispatcher [req-53f79708-4c7c-4405-a116-ed605fc255a4 ad8ac2392f41482e887c6b44402a641d dfcd0863f170402689d89771da0ea3ff - - -] Exception during message handling: 'module' object has no attribute 'spawn'\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     executor_callback))\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     executor_callback)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 6668, in live_migration\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     migrate_data=migrate_data)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 88, in wrapped\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     payload)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 71, in wrapped\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 355, in decorated_function\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 343, in decorated_function\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 5237, in live_migration\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     block_migration, migrate_data)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 5330, in live_migration\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     utils.spawn(self._live_migration, context, instance, dest,\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher AttributeError: 'module' object has no attribute 'spawn'\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher\n\nIs there something we did wrong ?\n\n[VM is still up and running, only state stuck in MIGRATING; had to nova reset-state --active vMs.]\n\nThanks in advance for your help.", 
    "tags": [
        "ceph", 
        "live-migration", 
        "needs-attention"
    ], 
    "importance": "Low", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1535346", 
    "owner": "None", 
    "id": 1535346, 
    "index": 1927, 
    "openned": "2016-01-18 15:20:39.383435+00:00", 
    "created": "2016-01-18 15:20:39.383435+00:00", 
    "title": "Direct Snapshot in Ceph patch causes nova live-migration to break", 
    "comments": [
        {
            "content": "Greetings,\n\nWhen trying to use nova live-migration we do have this trace on the compute node logs (nova-compute.log)\nThe Vm stays in \"MIGRATING\" state, the VM is still up on the originating node, and never moves.\n\nVERSION IN USE: ( KILO v1 )\n\nroot@compute2:~# dpkg -l | grep nova\nii  nova-common                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - common files\nii  nova-compute                        1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node base\nii  nova-compute-kvm                    1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node (KVM)\nii  nova-compute-libvirt                1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node libvirt support\nii  python-nova                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute Python libraries\nii  python-novaclient                   1:2.22.0-0ubuntu1~cloud0              all          client library for OpenStack Compute API\n\n\nCMD: \n\nnova migrate-live 6b91ffb3-bf84-48e9-b07d-99603c89055c compute4.prod.cloud.gtcomm.net\n\nLOGS (/var/log/nova/nova-compute.log):\n\n2016-01-18 09:55:46.160 18571 ERROR oslo_messaging.rpc.dispatcher [req-fae37d19-0867-4796-9df3-b08be2120d15 ad8ac2392f41482e887c6b44402a641d dfcd0863f170402689d89771da0ea3ff - - -] Exception during message handling: 'module' object has no attribute 'spawn'\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     executor_callback))\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     executor_callback)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 6668, in live_migration\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     migrate_data=migrate_data)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 88, in wrapped\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     payload)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 71, in wrapped\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 355, in decorated_function\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 343, in decorated_function\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 5237, in live_migration\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     block_migration, migrate_data)\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 5330, in live_migration\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher     utils.spawn(self._live_migration, context, instance, dest,\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher AttributeError: 'module' object has no attribute 'spawn'\n2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher \n\n\nCMD: \n\nnova host-evacuate-live compute8\n\nLOGS (/var/log/nova/nova-compute.log):\n\n2016-01-18 10:17:09.807 14122 ERROR oslo_messaging.rpc.dispatcher [req-53f79708-4c7c-4405-a116-ed605fc255a4 ad8ac2392f41482e887c6b44402a641d dfcd0863f170402689d89771da0ea3ff - - -] Exception during message handling: 'module' object has no attribute 'spawn'\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher Traceback (most recent call last):\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     executor_callback))\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     executor_callback)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     result = func(ctxt, **new_args)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 6668, in live_migration\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     migrate_data=migrate_data)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 88, in wrapped\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     payload)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 71, in wrapped\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 355, in decorated_function\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     kwargs['instance'], e, sys.exc_info())\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 343, in decorated_function\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 5237, in live_migration\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     block_migration, migrate_data)\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher   File \"/usr/lib/python2.7/dist-packages/nova/virt/libvirt/driver.py\", line 5330, in live_migration\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher     utils.spawn(self._live_migration, context, instance, dest,\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher AttributeError: 'module' object has no attribute 'spawn'\n2016-01-18 10:17:09.807 14122 TRACE oslo_messaging.rpc.dispatcher \n\nIs there something we did wrong ?\n\n[VM is still up and running, only state stuck in MIGRATING; had to nova reset-state --active vMs.]\n\nThanks in advance for your help.", 
            "date_created": "2016-01-18 15:20:39.383435+00:00", 
            "author": "https://api.launchpad.net/1.0/~dbayle"
        }, 
        {
            "content": "@David:\n\nBug skimming\n------------\nDo both of your compute nodes have the Kilo version installed?\nOr have you a mixed setup with a node with Juno code? The message\n\n    2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher\n    AttributeError: 'module' object has no attribute 'spawn'\n\nmakes me believe that you lack the commit 48a62170 [1]. This got only\nintroduced in Kilo:\n\n    $ git tag  --contains 48a62170065386cea6004c090fb5273ed9ec8d2b\n\nI need the output of ``dpkg -l | grep nova`` also from your nodes\n\"compute4\" and \"compute8\", thus I'm setting this report to \"Incomplete\".\nAfter you provided this information, please switch it back to \"New\".\n\nReferences\n----------\n[1] \"Ensure to store context in thread local after spawn/spawn_n\"\nhttps://github.com/openstack/nova/commit/48a62170065386cea6004c090fb5273ed9ec8d2b", 
            "date_created": "2016-01-25 11:33:32.925129+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "> Do both of your compute nodes have the Kilo version installed?\n\nYes\n\n> Or have you a mixed setup with a node with Juno code? \n\nNo\n\n> The message\n>    2016-01-18 09:55:46.160 18571 TRACE oslo_messaging.rpc.dispatcher\n>    AttributeError: 'module' object has no attribute 'spawn'\n>\n>makes me believe that you lack the commit 48a62170 [1]. This got only\n>introduced in Kilo:\n>\n>    $ git tag --contains 48a62170065386cea6004c090fb5273ed9ec8d2b\n>\n> I need the output of ``dpkg -l | grep nova`` also from your nodes\n> \"compute4\" and \"compute8\", thus I'm setting this report to \"Incomplete\".\n> After you provided this information, please switch it back to \"New\".\n\nThank you for your help, here are the package version asked: \n\nPROD>> root@compute4:~# dpkg -l | grep nova\nii  nova-common                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - common files\nii  nova-compute                        1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node base\nii  nova-compute-kvm                    1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node (KVM)\nii  nova-compute-libvirt                1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node libvirt support\nii  python-nova                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute Python libraries\nii  python-novaclient                   1:2.22.0-0ubuntu1~cloud0              all          client library for OpenStack Compute API\n\nPROD>> root@compute8:~# dpkg -l | grep nova\nii  nova-common                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - common files\nii  nova-compute                        1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node base\nii  nova-compute-kvm                    1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node (KVM)\nii  nova-compute-libvirt                1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node libvirt support\nii  python-nova                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute Python libraries\nii  python-novaclient                   1:2.22.0-0ubuntu1~cloud0              all          client library for OpenStack Compute API", 
            "date_created": "2016-01-29 12:26:16.871098+00:00", 
            "author": "https://api.launchpad.net/1.0/~dbayle"
        }, 
        {
            "content": "@David:\n\nThe kilo version \"2015.1.0-0ubuntu1\" you have installed does not have \nthe commit [1], I checked the deliverable \"nova_2015.1.0.orig.tar.gz\" \nfrom [2]. This change is available in the follow up version \n\"2015.1.1-0ubuntu1\" [3] (please notice the increment of the patch level).\n\nI still think there could be a mismatch of Nova versions. Could you\nplease also add the version details of the Nova services on your\ncompute node (conductor, scheduler, api, ...)?\n\nFor the sake of completeness, it looks like the latest Kilo release\nof the Ubuntu packages are shipped with version \"2015.1.2-0ubuntu1\" [4].\n\nReferences\n==========\n[1] \"Ensure to store context in thread local after spawn/spawn_n\"\nhttps://github.com/openstack/nova/commit/48a62170065386cea6004c090fb5273ed9ec8d2b\n[2] https://launchpad.net/ubuntu/+source/nova/1:2015.1.0-0ubuntu1\n[3] https://launchpad.net/ubuntu/+source/nova/1:2015.1.1-0ubuntu1\n[4] https://launchpad.net/ubuntu/+source/nova/1:2015.1.2-0ubuntu1", 
            "date_created": "2016-02-08 18:13:40.199843+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "Greetings,\n\nWe are trying to run each exact same version on our infrastrcture, here is the detail for the controller node which is I suppose, what you'are asking since I've already provided the versions for computer nodes.\n\nAlso please note that we are sure that it had worked in the past with this actual setup (as we documented it).\n(but we can't remember of any change that would brake the live migrate)\n\nHere are all versions of nova for controller and computes:\n\nroot@controller:~# dpkg -l | grep nova\nii  nova-api                             1:2015.1.0-0ubuntu1.1~cloud0          all          OpenStack Compute - API frontend\nii  nova-cert                            1:2015.1.0-0ubuntu1.1~cloud0          all          OpenStack Compute - certificate management\nii  nova-common                          1:2015.1.0-0ubuntu1.1~cloud0          all          OpenStack Compute - common files\nii  nova-conductor                       1:2015.1.0-0ubuntu1.1~cloud0          all          OpenStack Compute - conductor service\nrc  nova-consoleauth                     1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - Console Authenticator\nii  nova-novncproxy                      1:2015.1.0-0ubuntu1.1~cloud0          all          OpenStack Compute - NoVNC proxy\nii  nova-scheduler                       1:2015.1.0-0ubuntu1.1~cloud0          all          OpenStack Compute - virtual machine scheduler\nii  python-nova                          1:2015.1.0-0ubuntu1.1~cloud0          all          OpenStack Compute Python libraries\nii  python-novaclient                    1:2.22.0-0ubuntu1~cloud0              all          client library for OpenStack Compute API\n\n\nroot@compute4:~# dpkg -l | grep nova\nii  nova-common                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - common files\nii  nova-compute                        1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node base\nii  nova-compute-kvm                    1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node (KVM)\nii  nova-compute-libvirt                1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node libvirt support\nii  python-nova                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute Python libraries\nii  python-novaclient                   1:2.22.0-0ubuntu1~cloud0              all          client library for OpenStack Compute API\n\n\nroot@compute8:~# dpkg -l | grep nova\nii  nova-common                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - common files\nii  nova-compute                        1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node base\nii  nova-compute-kvm                    1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node (KVM)\nii  nova-compute-libvirt                1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute - compute node libvirt support\nii  python-nova                         1:2015.1.0-0ubuntu1~cloud0            all          OpenStack Compute Python libraries\nii  python-novaclient                   1:2.22.0-0ubuntu1~cloud0              all          client library for OpenStack Compute API\n\n\nUpgrading is not an option for now, also we are conviced that it was working when we first went into production.\n\nThank you in advance for the help provided.", 
            "date_created": "2016-02-09 16:31:41.593917+00:00", 
            "author": "https://api.launchpad.net/1.0/~dbayle"
        }, 
        {
            "content": "Hi everyone this is getting critical since the new QEMU vulnerability, we need to move our production VMs to one compute and update the other computes.\n\nhttp://www.ubuntu.com/usn/usn-2891-1/\n\nCan you please help us ?\n\nThanks in advance.", 
            "date_created": "2016-02-15 14:59:50.135872+00:00", 
            "author": "https://api.launchpad.net/1.0/~dbayle"
        }, 
        {
            "content": "Greetings guys,\n\nWe found the main reason of that bug.\n\nIt is coming from the only patch we applied on our setup which is regarding doing snapshot directly into ceph backend.\n\nWhen reverting back form that patch, live-migrate is working again after a nova-compute restart.\n\nAs we know you wanted to bring this feature into Mitaka : it would be interesting to take a look a this raise condition: \n\nDirect Snapshot in Ceph patch + Kilo = live-migrate brake.\n\nPATCH: https://review.openstack.org/#/c/205282/\n\nhttp://www.sebastien-han.fr/blog/2015/10/05/openstack-nova-snapshots-on-ceph-rbd/", 
            "date_created": "2016-02-16 15:55:33.344781+00:00", 
            "author": "https://api.launchpad.net/1.0/~dbayle"
        }, 
        {
            "content": "I have not personally reproduced this because I don't have a system with Ceph set up, however the information provided is sufficient that someone with more knowledge can verify.", 
            "date_created": "2016-02-16 18:13:13.823573+00:00", 
            "author": "https://api.launchpad.net/1.0/~auggy"
        }, 
        {
            "content": "Setting this as high because the bug says that reverting the patch which is now in Mitaka fixed their issue. So we may have pushed in a regression. ", 
            "date_created": "2016-02-17 16:10:00.366264+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "It is unclear if this is an issue with any version of upstream code, or it was a bad interaction on the backport for the folks that built this. \n\nMarking as incomplete to see if there is a Mitaka reproduce.", 
            "date_created": "2016-02-17 16:12:28.973027+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "Umm, this bug is saying they are running a kilo cloud, but the ceph direct snapshot patch is not released yet, it landed in mitaka.\n\nThe patch floated in gerrit for a few releases, so what version of the patch was actually picked up and backported to this kilo environment?  What errors are in the  compute logs when things fail?\n\nBecause of this:\n\n\"AttributeError: 'module' object has no attribute 'spawn'\"\n\nI'm assuming that whoever backported the patch to kilo didn't do it correctly, or used a version that wasn't approved for kilo. If you're going to backport large changes like this out of tree, be sure to run unit tests on it before pushing it to production.", 
            "date_created": "2016-02-17 16:14:55.889566+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Given the clearly invalid python in the stack trace that mriedem pointed  out, marking as Invalid. ", 
            "date_created": "2016-02-17 16:32:00.476579+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }
    ], 
    "closed": "2016-02-17 16:31:28.954801+00:00"
}