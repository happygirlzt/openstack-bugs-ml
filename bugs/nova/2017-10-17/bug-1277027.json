{
    "status": "Fix Released", 
    "last_updated": "2014-04-17 09:08:00.547577+00:00", 
    "description": "I couldn't find an existing bug for this, apologies if it's a dupe, looks like a nova bug:\n\n\nhttps://review.openstack.org/#/c/70717/\nhttp://logs.openstack.org/17/70717/1/gate/gate-tempest-dsvm-full/9adaf90/console.html\n\n2014-02-06 08:04:16.350 | 2014-02-06 07:48:25,729 Response Body: {\"server\": {\"status\": \"ERROR\", \"os-access-ips:access_ip_v6\": \"\", \"updated\": \"2014-02-06T07:48:25Z\", \"os-access-ips:access_ip_v4\": \"\", \"addresses\": {}, \"links\": [{\"href\": \"http://127.0.0.1:8774/v3/servers/1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd\", \"rel\": \"self\"}, {\"href\": \"http://127.0.0.1:8774/servers/1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd\", \"rel\": \"bookmark\"}], \"os-extended-status:task_state\": null, \"key_name\": null, \"image\": {\"id\": \"7e649e07-3cea-4d95-90b2-2bbea7fce698\", \"links\": [{\"href\": \"http://23.253.79.233:9292/images/7e649e07-3cea-4d95-90b2-2bbea7fce698\", \"rel\": \"bookmark\"}]}, \"os-pci:pci_devices\": [], \"os-extended-availability-zone:availability_zone\": \"nova\", \"os-extended-status:power_state\": 0, \"os-config-drive:config_drive\": \"\", \"host_id\": \"10f0dc42e72572ed6d30e8dc32b41edc1d41a3dacda6571c5aeabe6e\", \"flavor\": {\"id\": \"42\", \"links\": [{\"href\": \"http://127.0.0.1:8774/flavors/42\", \"rel\": \"bookmark\"}]}, \"id\": \"1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd\", \"security_groups\": [{\"name\": \"default\"}], \"user_id\": \"f2262ed0a64c43359867456cfbccc153\", \"name\": \"ServersAdminV3Test-instance-1705049062\", \"created\": \"2014-02-06T07:48:21Z\", \"tenant_id\": \"8e932e11471a469e85a30195b2198f63\", \"os-extended-status:vm_state\": \"error\", \"os-server-usage:launched_at\": null, \"os-extended-volumes:volumes_attached\": [], \"os-server-usage:terminated_at\": null, \"os-extended-status:locked_by\": null, \"fault\": {\"message\": \"No valid host was found. \", \"code\": 500, \"created\": \"2014-02-06T07:48:25Z\"}, \"metadata\": {}}}\n2014-02-06 08:04:16.350 | }}}\n2014-02-06 08:04:16.350 | \n2014-02-06 08:04:16.350 | Traceback (most recent call last):\n2014-02-06 08:04:16.350 |   File \"tempest/api/compute/v3/admin/test_servers.py\", line 85, in test_admin_delete_servers_of_others\n2014-02-06 08:04:16.350 |     self.servers_client.wait_for_server_termination(server['id'])\n2014-02-06 08:04:16.351 |   File \"tempest/services/compute/v3/json/servers_client.py\", line 179, in wait_for_server_termination\n2014-02-06 08:04:16.351 |     raise exceptions.BuildErrorException(server_id=server_id)\n2014-02-06 08:04:16.351 | BuildErrorException: Server 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd failed to build and is in ERROR status\n2014-02-06 08:04:16.351 | \n2014-02-06 08:04:16.351 | \n2014-02-06 08:04:16.351 | ======================================================================\n2014-02-06 08:04:16.351 | FAIL: process-returncode\n2014-02-06 08:04:16.351 | process-returncode\n2014-02-06 08:04:16.351 | ----------------------------------------------------------------------\n2014-02-06 08:04:16.352 | _StringException: Binary content:\n2014-02-06 08:04:16.352 |   traceback (test/plain; charset=\"utf8\")\n2014-02-06 08:04:16.352 | \n2014-02-06 08:04:16.352 | \n2014-02-06 08:04:16.352 | ----------------------------------------------------------------------\n2014-02-06 08:04:16.352 | Ran 2101 tests in 2350.793s\n2014-02-06 08:04:16.353 | \n2014-02-06 08:04:16.353 | FAILED (failures=2, skipped=130)\n2014-02-06 08:04:16.353 | ERROR: InvocationError: '/bin/bash tools/pretty_tox.sh (?!.*\\\\[.*\\\\bslow\\\\b.*\\\\])(^tempest\\\\.(api|scenario|thirdparty|cli)) --concurrency=2'\n2014-02-06 08:04:16.354 | ___________________________________ summary ____________________________________\n2014-02-06 08:04:16.354 | ERROR:   full: commands failed\n2014-02-06 08:04:16.463 | Checking logs...\n2014-02-06 08:04:16.562 | Log File: n-net\n2014-02-06 08:04:16.562 | 2014-02-06 07:34:40.598 30086 ERROR oslo.messaging._executors.base [-] Exception during message handling\n2014-02-06 08:04:16.562 | \n2014-02-06 08:04:16.563 | 2014-02-06 07:34:40.601 30086 ERROR oslo.messaging._drivers.common [-] Returning exception Instance fcfcbace-c4dd-4214-957f-b01e0b47fcf4 could not be found.\n2014-02-06 08:04:16.563 | \n2014-02-06 08:04:16.563 | 2014-02-06 07:34:40.601 30086 ERROR oslo.messaging._drivers.common [-] ['Traceback (most recent call last):\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/_executors/base.py\", line 36, in _dispatch\\n    incoming.reply(self.callback(incoming.ctxt, incoming.message))\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/dispatcher.py\", line 134, in __call__\\n    return self._dispatch(endpoint, method, ctxt, args)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/dispatcher.py\", line 104, in _dispatch\\n    result = getattr(endpoint, method)(ctxt, **new_args)\\n', '  File \"/opt/stack/new/nova/nova/network/floating_ips.py\", line 117, in allocate_for_instance\\n    **kwargs)\\n', '  File \"/opt/stack/new/nova/nova/network/manager.py\", line 521, in allocate_for_instance\\n    host)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/server.py\", line 153, in inner\\n    return func(*args, **kwargs)\\n', '  File \"/opt/stack/new/nova/nova/network/manager.py\", line 579, in get_instance_nw_info\\n    instance_uuid, use_slave=use_slave)\\n', '  File \"/opt/stack/new/nova/nova/objects/base.py\", line 110, in wrapper\\n    args, kwargs)\\n', '  File \"/opt/stack/new/nova/nova/conductor/rpcapi.py\", line 470, in object_class_action\\n    objver=objver, args=args, kwargs=kwargs)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/client.py\", line 150, in call\\n    wait_for_reply=True, timeout=timeout)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/transport.py\", line 87, in _send\\n    timeout=timeout)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/_drivers/amqpdriver.py\", line 390, in send\\n    return self._send(target, ctxt, message, wait_for_reply, timeout)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/_drivers/amqpdriver.py\", line 383, in _send\\n    raise result\\n', 'InstanceNotFound_Remote: Instance fcfcbace-c4dd-4214-957f-b01e0b47fcf4 could not be found.\\nTraceback (most recent call last):\\n\\n  File \"/opt/stack/new/nova/nova/conductor/manager.py\", line 572, in _object_dispatch\\n    return getattr(target, method)(context, *args, **kwargs)\\n\\n  File \"/opt/stack/new/nova/nova/objects/base.py\", line 112, in wrapper\\n    result = fn(cls, context, *args, **kwargs)\\n\\n  File \"/opt/stack/new/nova/nova/objects/virtual_interface.py\", line 98, in get_by_instance_uuid\\n    use_slave=use_slave)\\n\\n  File \"/opt/stack/new/nova/nova/db/api.py\", line 594, in virtual_interface_get_by_instance\\n    use_slave=use_slave)\\n\\n  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 128, in wrapper\\n    return f(*args, **kwargs)\\n\\n  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 140, in wrapper\\n    instance_get_by_uuid(context, instance_uuid)\\n\\n  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 128, in wrapper\\n    return f(*args, **kwargs)\\n\\n  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 1701, in instance_get_by_uuid\\n    columns_to_join=columns_to_join, use_slave=use_slave)\\n\\n  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 1713, in _instance_get_by_uuid\\n    raise exception.InstanceNotFound(instance_id=uuid)\\n\\nInstanceNotFound: Instance fcfcbace-c4dd-4214-957f-b01e0b47fcf4 could not be found.\\n\\n']\n2014-02-06 08:04:16.564 | \n2014-02-06 08:04:16.957 | Log File: n-cond\n2014-02-06 08:04:16.957 | 2014-02-06 07:35:54.076 30662 ERROR oslo.messaging._executors.base [-] Exception during message handling\n2014-02-06 08:04:16.957 | \n2014-02-06 08:04:16.958 | 2014-02-06 07:35:54.077 30662 ERROR oslo.messaging._drivers.common [-] Returning exception Unexpected task state: expecting [u'scheduling', None] but the actual state is deleting to caller\n2014-02-06 08:04:16.958 | \n2014-02-06 08:04:16.958 | 2014-02-06 07:35:54.077 30662 ERROR oslo.messaging._drivers.common [-] ['Traceback (most recent call last):\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/_executors/base.py\", line 36, in _dispatch\\n    incoming.reply(self.callback(incoming.ctxt, incoming.message))\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/dispatcher.py\", line 134, in __call__\\n    return self._dispatch(endpoint, method, ctxt, args)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/dispatcher.py\", line 104, in _dispatch\\n    result = getattr(endpoint, method)(ctxt, **new_args)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/server.py\", line 153, in inner\\n    return func(*args, **kwargs)\\n', '  File \"/opt/stack/new/nova/nova/conductor/manager.py\", line 129, in instance_update\\n    context, instance_uuid, updates)\\n', '  File \"/opt/stack/new/nova/nova/db/api.py\", line 740, in instance_update_and_get_original\\n    columns_to_join=columns_to_join)\\n', '  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 128, in wrapper\\n    return f(*args, **kwargs)\\n', '  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 2215, in instance_update_and_get_original\\n    columns_to_join=columns_to_join)\\n', '  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 2263, in _instance_update\\n    actual=actual_state, expected=expected)\\n', \"UnexpectedDeletingTaskStateError: Unexpected task state: expecting [u'scheduling', None] but the actual state is deleting\\n\"]\n2014-02-06 08:04:16.958 | \n2014-02-06 08:04:17.064 | 2014-02-06 07:40:36.034 30669 ERROR oslo.messaging._executors.base [-] Exception during message handling", 
    "tags": [
        "testing"
    ], 
    "importance": "Undecided", 
    "heat": 14, 
    "link": "https://bugs.launchpad.net/nova/+bug/1277027", 
    "owner": "None", 
    "id": 1277027, 
    "index": 5795, 
    "openned": "2014-02-06 11:16:35.690853+00:00", 
    "created": "2014-02-06 11:16:23.225490+00:00", 
    "title": "test_admin_delete_servers_of_others failure due to unexpected task state", 
    "comments": [
        {
            "content": "I couldn't find an existing bug for this, apologies if it's a dupe, looks like a nova bug:\n\n\nhttps://review.openstack.org/#/c/70717/\nhttp://logs.openstack.org/17/70717/1/gate/gate-tempest-dsvm-full/9adaf90/console.html\n\n2014-02-06 08:04:16.350 | 2014-02-06 07:48:25,729 Response Body: {\"server\": {\"status\": \"ERROR\", \"os-access-ips:access_ip_v6\": \"\", \"updated\": \"2014-02-06T07:48:25Z\", \"os-access-ips:access_ip_v4\": \"\", \"addresses\": {}, \"links\": [{\"href\": \"http://127.0.0.1:8774/v3/servers/1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd\", \"rel\": \"self\"}, {\"href\": \"http://127.0.0.1:8774/servers/1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd\", \"rel\": \"bookmark\"}], \"os-extended-status:task_state\": null, \"key_name\": null, \"image\": {\"id\": \"7e649e07-3cea-4d95-90b2-2bbea7fce698\", \"links\": [{\"href\": \"http://23.253.79.233:9292/images/7e649e07-3cea-4d95-90b2-2bbea7fce698\", \"rel\": \"bookmark\"}]}, \"os-pci:pci_devices\": [], \"os-extended-availability-zone:availability_zone\": \"nova\", \"os-extended-status:power_state\": 0, \"os-config-drive:config_drive\": \"\", \"host_id\": \"10f0dc42e72572ed6d30e8dc32b41edc1d41a3dacda6571c5aeabe6e\", \"flavor\": {\"id\": \"42\", \"links\": [{\"href\": \"http://127.0.0.1:8774/flavors/42\", \"rel\": \"bookmark\"}]}, \"id\": \"1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd\", \"security_groups\": [{\"name\": \"default\"}], \"user_id\": \"f2262ed0a64c43359867456cfbccc153\", \"name\": \"ServersAdminV3Test-instance-1705049062\", \"created\": \"2014-02-06T07:48:21Z\", \"tenant_id\": \"8e932e11471a469e85a30195b2198f63\", \"os-extended-status:vm_state\": \"error\", \"os-server-usage:launched_at\": null, \"os-extended-volumes:volumes_attached\": [], \"os-server-usage:terminated_at\": null, \"os-extended-status:locked_by\": null, \"fault\": {\"message\": \"No valid host was found. \", \"code\": 500, \"created\": \"2014-02-06T07:48:25Z\"}, \"metadata\": {}}}\n2014-02-06 08:04:16.350 | }}}\n2014-02-06 08:04:16.350 | \n2014-02-06 08:04:16.350 | Traceback (most recent call last):\n2014-02-06 08:04:16.350 |   File \"tempest/api/compute/v3/admin/test_servers.py\", line 85, in test_admin_delete_servers_of_others\n2014-02-06 08:04:16.350 |     self.servers_client.wait_for_server_termination(server['id'])\n2014-02-06 08:04:16.351 |   File \"tempest/services/compute/v3/json/servers_client.py\", line 179, in wait_for_server_termination\n2014-02-06 08:04:16.351 |     raise exceptions.BuildErrorException(server_id=server_id)\n2014-02-06 08:04:16.351 | BuildErrorException: Server 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd failed to build and is in ERROR status\n2014-02-06 08:04:16.351 | \n2014-02-06 08:04:16.351 | \n2014-02-06 08:04:16.351 | ======================================================================\n2014-02-06 08:04:16.351 | FAIL: process-returncode\n2014-02-06 08:04:16.351 | process-returncode\n2014-02-06 08:04:16.351 | ----------------------------------------------------------------------\n2014-02-06 08:04:16.352 | _StringException: Binary content:\n2014-02-06 08:04:16.352 |   traceback (test/plain; charset=\"utf8\")\n2014-02-06 08:04:16.352 | \n2014-02-06 08:04:16.352 | \n2014-02-06 08:04:16.352 | ----------------------------------------------------------------------\n2014-02-06 08:04:16.352 | Ran 2101 tests in 2350.793s\n2014-02-06 08:04:16.353 | \n2014-02-06 08:04:16.353 | FAILED (failures=2, skipped=130)\n2014-02-06 08:04:16.353 | ERROR: InvocationError: '/bin/bash tools/pretty_tox.sh (?!.*\\\\[.*\\\\bslow\\\\b.*\\\\])(^tempest\\\\.(api|scenario|thirdparty|cli)) --concurrency=2'\n2014-02-06 08:04:16.354 | ___________________________________ summary ____________________________________\n2014-02-06 08:04:16.354 | ERROR:   full: commands failed\n2014-02-06 08:04:16.463 | Checking logs...\n2014-02-06 08:04:16.562 | Log File: n-net\n2014-02-06 08:04:16.562 | 2014-02-06 07:34:40.598 30086 ERROR oslo.messaging._executors.base [-] Exception during message handling\n2014-02-06 08:04:16.562 | \n2014-02-06 08:04:16.563 | 2014-02-06 07:34:40.601 30086 ERROR oslo.messaging._drivers.common [-] Returning exception Instance fcfcbace-c4dd-4214-957f-b01e0b47fcf4 could not be found.\n2014-02-06 08:04:16.563 | \n2014-02-06 08:04:16.563 | 2014-02-06 07:34:40.601 30086 ERROR oslo.messaging._drivers.common [-] ['Traceback (most recent call last):\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/_executors/base.py\", line 36, in _dispatch\\n    incoming.reply(self.callback(incoming.ctxt, incoming.message))\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/dispatcher.py\", line 134, in __call__\\n    return self._dispatch(endpoint, method, ctxt, args)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/dispatcher.py\", line 104, in _dispatch\\n    result = getattr(endpoint, method)(ctxt, **new_args)\\n', '  File \"/opt/stack/new/nova/nova/network/floating_ips.py\", line 117, in allocate_for_instance\\n    **kwargs)\\n', '  File \"/opt/stack/new/nova/nova/network/manager.py\", line 521, in allocate_for_instance\\n    host)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/server.py\", line 153, in inner\\n    return func(*args, **kwargs)\\n', '  File \"/opt/stack/new/nova/nova/network/manager.py\", line 579, in get_instance_nw_info\\n    instance_uuid, use_slave=use_slave)\\n', '  File \"/opt/stack/new/nova/nova/objects/base.py\", line 110, in wrapper\\n    args, kwargs)\\n', '  File \"/opt/stack/new/nova/nova/conductor/rpcapi.py\", line 470, in object_class_action\\n    objver=objver, args=args, kwargs=kwargs)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/client.py\", line 150, in call\\n    wait_for_reply=True, timeout=timeout)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/transport.py\", line 87, in _send\\n    timeout=timeout)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/_drivers/amqpdriver.py\", line 390, in send\\n    return self._send(target, ctxt, message, wait_for_reply, timeout)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/_drivers/amqpdriver.py\", line 383, in _send\\n    raise result\\n', 'InstanceNotFound_Remote: Instance fcfcbace-c4dd-4214-957f-b01e0b47fcf4 could not be found.\\nTraceback (most recent call last):\\n\\n  File \"/opt/stack/new/nova/nova/conductor/manager.py\", line 572, in _object_dispatch\\n    return getattr(target, method)(context, *args, **kwargs)\\n\\n  File \"/opt/stack/new/nova/nova/objects/base.py\", line 112, in wrapper\\n    result = fn(cls, context, *args, **kwargs)\\n\\n  File \"/opt/stack/new/nova/nova/objects/virtual_interface.py\", line 98, in get_by_instance_uuid\\n    use_slave=use_slave)\\n\\n  File \"/opt/stack/new/nova/nova/db/api.py\", line 594, in virtual_interface_get_by_instance\\n    use_slave=use_slave)\\n\\n  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 128, in wrapper\\n    return f(*args, **kwargs)\\n\\n  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 140, in wrapper\\n    instance_get_by_uuid(context, instance_uuid)\\n\\n  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 128, in wrapper\\n    return f(*args, **kwargs)\\n\\n  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 1701, in instance_get_by_uuid\\n    columns_to_join=columns_to_join, use_slave=use_slave)\\n\\n  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 1713, in _instance_get_by_uuid\\n    raise exception.InstanceNotFound(instance_id=uuid)\\n\\nInstanceNotFound: Instance fcfcbace-c4dd-4214-957f-b01e0b47fcf4 could not be found.\\n\\n']\n2014-02-06 08:04:16.564 | \n2014-02-06 08:04:16.957 | Log File: n-cond\n2014-02-06 08:04:16.957 | 2014-02-06 07:35:54.076 30662 ERROR oslo.messaging._executors.base [-] Exception during message handling\n2014-02-06 08:04:16.957 | \n2014-02-06 08:04:16.958 | 2014-02-06 07:35:54.077 30662 ERROR oslo.messaging._drivers.common [-] Returning exception Unexpected task state: expecting [u'scheduling', None] but the actual state is deleting to caller\n2014-02-06 08:04:16.958 | \n2014-02-06 08:04:16.958 | 2014-02-06 07:35:54.077 30662 ERROR oslo.messaging._drivers.common [-] ['Traceback (most recent call last):\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/_executors/base.py\", line 36, in _dispatch\\n    incoming.reply(self.callback(incoming.ctxt, incoming.message))\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/dispatcher.py\", line 134, in __call__\\n    return self._dispatch(endpoint, method, ctxt, args)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/dispatcher.py\", line 104, in _dispatch\\n    result = getattr(endpoint, method)(ctxt, **new_args)\\n', '  File \"/opt/stack/new/oslo.messaging/oslo/messaging/rpc/server.py\", line 153, in inner\\n    return func(*args, **kwargs)\\n', '  File \"/opt/stack/new/nova/nova/conductor/manager.py\", line 129, in instance_update\\n    context, instance_uuid, updates)\\n', '  File \"/opt/stack/new/nova/nova/db/api.py\", line 740, in instance_update_and_get_original\\n    columns_to_join=columns_to_join)\\n', '  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 128, in wrapper\\n    return f(*args, **kwargs)\\n', '  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 2215, in instance_update_and_get_original\\n    columns_to_join=columns_to_join)\\n', '  File \"/opt/stack/new/nova/nova/db/sqlalchemy/api.py\", line 2263, in _instance_update\\n    actual=actual_state, expected=expected)\\n', \"UnexpectedDeletingTaskStateError: Unexpected task state: expecting [u'scheduling', None] but the actual state is deleting\\n\"]\n2014-02-06 08:04:16.958 | \n2014-02-06 08:04:17.064 | 2014-02-06 07:40:36.034 30669 ERROR oslo.messaging._executors.base [-] Exception during message handling", 
            "date_created": "2014-02-06 11:16:23.225490+00:00", 
            "author": "https://api.launchpad.net/1.0/~shardy"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/71709", 
            "date_created": "2014-02-07 01:47:11.849224+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "I think https://bugs.launchpad.net/tempest/+bug/1061167 is also related to this bug.", 
            "date_created": "2014-02-07 02:03:33.193169+00:00", 
            "author": "https://api.launchpad.net/1.0/~igawa"
        }, 
        {
            "content": "Assigning to Igawa who submitted the patch.", 
            "date_created": "2014-02-07 13:56:05.334008+00:00", 
            "author": "https://api.launchpad.net/1.0/~johngarbutt"
        }, 
        {
            "content": "its a tempest issue I guess, but it affects our gate.", 
            "date_created": "2014-02-07 13:58:40.712858+00:00", 
            "author": "https://api.launchpad.net/1.0/~johngarbutt"
        }, 
        {
            "content": "The error in the scheduler log is here:\n\nhttp://logs.openstack.org/17/70717/1/gate/gate-tempest-dsvm-full/9adaf90/logs/screen-n-sch.txt.gz#_2014-02-06_07_48_25_557\n\nThe error in the compute log is here:\n\nhttp://logs.openstack.org/17/70717/1/gate/gate-tempest-dsvm-full/9adaf90/logs/screen-n-cpu.txt.gz#_2014-02-06_07_48_25_544\n\n2014-02-06 07:48:25.544 ERROR nova.compute.manager [req-87a44fcf-fc65-4d3f-8c09-56553d895159 ServersAdminV3Test-929511318 ServersAdminV3Test-156703162] [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd] Error: [Errno 2] No such file or directory: '/opt/stack/data/nova/instances/1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd/libvirt.xml'\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd] Traceback (most recent call last):\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1059, in _build_instance\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]     set_access_ip=set_access_ip)\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 351, in decorated_function\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]     return function(self, context, *args, **kwargs)\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1467, in _spawn\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]     LOG.exception(_('Instance failed to spawn'), instance=instance)\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]   File \"/opt/stack/new/nova/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]     six.reraise(self.type_, self.value, self.tb)\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1464, in _spawn\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]     block_device_info)\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 2209, in spawn\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]     write_to_disk=True)\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]   File \"/opt/stack/new/nova/nova/virt/libvirt/driver.py\", line 3306, in to_xml\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]     libvirt_utils.write_to_file(xml_path, xml)\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]   File \"/opt/stack/new/nova/nova/virt/libvirt/utils.py\", line 505, in write_to_file\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd]     with open(path, 'w') as f:\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd] IOError: [Errno 2] No such file or directory: '/opt/stack/data/nova/instances/1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd/libvirt.xml'\n2014-02-06 07:48:25.544 30045 TRACE nova.compute.manager [instance: 1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd] \n\nThe test in tempest is buggy in that it's trying to delete a server before it's active, so yeah it's going to fail to schedule since it's deleted while building and you're going to get an error.\n\nHow is this a nova bug?", 
            "date_created": "2014-02-07 20:41:20.111422+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "The server must be always delete-able (unless it is lock-ed).\nOne of the reason of removing the whitebox tests was, the servers become always delectable.", 
            "date_created": "2014-02-17 08:03:57.045551+00:00", 
            "author": "https://api.launchpad.net/1.0/~afazekas"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/74944", 
            "date_created": "2014-02-20 06:47:24.058936+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "I investigated http://logs.openstack.org/17/70717/1/gate/gate-tempest-dsvm-full/9adaf90/logs/\n\nThe scenario is the following:\n\n07:48:22.016 (nova-cpu) Starting instance...\n07:48:22.245 (nova-api) receives \"DELETE a server\" request\n07:48:24.599 (nova-cpu) Deleting instance files /opt/stack/data/nova/instances/1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd\n07:48:24.602 (nova-cpu) Deletion of /opt/stack/data/nova/instances/1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd complete\n07:48:24.630 (nova-cpu) Instance failed to spawn: IOError: [Errno 2] No such file or directory: '/opt/stack/data/nova/instances/1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd/libvirt.xml'\n07:48:25.633 (nova-api) receives \"GET a server\" request\n07:48:25.728 (nova-api) returns \"ERROR\" server status due to 07:48:24.630 server creation error.\n07:48:25,729 (tempest) The test failed because of detecting \"ERROR\" server status.\n\nSo this problem is because both \"create a server\" and \"delete a server\" run at the same time.", 
            "date_created": "2014-02-20 10:29:09.561407+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "To solve this problem, one idea is changing the semaphore of a server deletion to \"<server_id>\" from \"<server_id>.delete\".\nThat would serialize server operations.", 
            "date_created": "2014-02-20 10:35:26.269336+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "This bug has been fixed already.\n\nWhen this problem happens, the semaphore names of \"create a server\" and \"delete a server\" are different like the following:\n\n* 07:48:22.012 (nova-cpu) Got semaphore \"1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd\" lock\n* 07:48:22.013 (nova-cpu) Got semaphore / lock \"do_run_instance\"\n* 07:48:22.016 (nova-cpu) Starting instance...\n* 07:48:22.442 (nova-cpu) Got semaphore \"1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd.delete\" lock\n* 07:48:22.442 (nova-cpu) Got semaphore / lock \"do_terminate_instance\"\n* 07:48:24.599 (nova-cpu) Deleting instance files /opt/stack/data/nova/instances/1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd\n\nThe one of \"create a server\" is \"1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd\",\nand the one of \"delete a server\" is \"1cbd2e01-d2f3-45a0-baee-1d16df3dc7fd.delete\".\n\nSo the difference made race condition and this problem happened.\n\nhttps://review.openstack.org/#/c/71363/ has fixed this problem already.", 
            "date_created": "2014-02-21 05:56:54.762985+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "This is not a tempest bug.", 
            "date_created": "2014-02-21 21:57:07.044600+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }
    ], 
    "closed": "2014-03-05 13:12:31.356374+00:00"
}