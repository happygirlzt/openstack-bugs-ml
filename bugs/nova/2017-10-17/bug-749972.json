{
    "status": "Fix Released", 
    "last_updated": "2012-06-19 16:20:28.995812+00:00", 
    "description": "Using the following image:\n\twget http://uec-images.ubuntu.com/lucid/current/lucid-server-uec-amd64.tar.gz\n\tuec-publish-tarball lucid-server-uec-amd64.tar.gz mybucket\n\nI can list the images with the EC2 API with no trouble.  But when I try the same thing with the Openstack API (using the openstack.compute wrapper library) it blows up.  I traced through the openstack.compute API client, and it appears to be sending the right request per the OpenStack Compute DevGuide 3/1/11 (DRAFT) section 4.5.1.   \n\n\t'http://192.168.200.50:8774/v1.0/images', 'GET', <<Authentication stuff>>\n\t\tor\n\t'http://192.168.200.50:8774/v1.1/images', 'GET', <<Authentication stuff>>\n\t(or the same with /images/detail).\n\nI get back a HTTP 500 internal server error.  In the nova-api log, I see that the cause of that is nova/api/openstack/views/images.py blowing up in the build function where it's trying to set \"name\": image_obj[\"name\"].  \n\nHere's the stack trace:\n-------------------------------------------------------------\n2011-04-04 11:54:51,520 DEBUG routes.middleware [-] Matched GET /images from (pid=4135) __call__ /usr/lib/pymodules/python2.6/routes/middleware.py:100\n2011-04-04 11:54:51,521 DEBUG routes.middleware [-] Route path: '/images', defaults: {'action': u'index', 'controller': <nova.api.openstack.images.ControllerV10 object at 0x2d61550>} from (pid=4135) __call__ /usr/lib/pymodules/python2.6/routes/middleware.py:102\n2011-04-04 11:54:51,521 DEBUG routes.middleware [-] Match dict: {'action': u'index', 'controller': <nova.api.openstack.images.ControllerV10 object at 0x2d61550>} from (pid=4135) __call__ /usr/lib/pymodules/python2.6/routes/middleware.py:103\n2011-04-04 11:54:51,522 ERROR nova.api.openstack [-] Caught error: 'name'\n(nova.api.openstack): TRACE: Traceback (most recent call last):\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/api/openstack/__init__.py\", line 58, in __call__\n(nova.api.openstack): TRACE:     return req.get_response(self.application)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/request.py\", line 919, in get_response\n(nova.api.openstack): TRACE:     application, catch_exc_info=False)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/request.py\", line 887, in call_application\n(nova.api.openstack): TRACE:     app_iter = application(self.environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/routes/middleware.py\", line 131, in __call__\n(nova.api.openstack): TRACE:     response = self.app(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 147, in __call__\n(nova.api.openstack): TRACE:     resp = self.call_func(req, *args, **self.kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 208, in call_func\n(nova.api.openstack): TRACE:     return self.func(req, *args, **kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/wsgi.py\", line 354, in __call__\n(nova.api.openstack): TRACE:     result = method(**arg_dict)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/api/openstack/images.py\", line 68, in index\n(nova.api.openstack): TRACE:     return dict(images=[builder(image, detail=False) for image in images])\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/api/openstack/views/images.py\", line 64, in build\n(nova.api.openstack): TRACE:     \"name\": image_obj[\"name\"],\n(nova.api.openstack): TRACE: KeyError: 'name'", 
    "tags": [], 
    "importance": "Critical", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/749972", 
    "owner": "https://api.launchpad.net/1.0/~blamar", 
    "id": 749972, 
    "index": 16, 
    "openned": "2011-04-04 06:10:23.082699+00:00", 
    "created": "2011-04-04 06:10:23.082699+00:00", 
    "title": "List images through Openstack API returns HTTP 500", 
    "comments": [
        {
            "content": "Using the following image:\n\twget http://uec-images.ubuntu.com/lucid/current/lucid-server-uec-amd64.tar.gz\n\tuec-publish-tarball lucid-server-uec-amd64.tar.gz mybucket\n\nI can list the images with the EC2 API with no trouble.  But when I try the same thing with the Openstack API (using the openstack.compute wrapper library) it blows up.  I traced through the openstack.compute API client, and it appears to be sending the right request per the OpenStack Compute DevGuide 3/1/11 (DRAFT) section 4.5.1.   \n\n\t'http://192.168.200.50:8774/v1.0/images', 'GET', <<Authentication stuff>>\n\t\tor\n\t'http://192.168.200.50:8774/v1.1/images', 'GET', <<Authentication stuff>>\n\t(or the same with /images/detail).\n\nI get back a HTTP 500 internal server error.  In the nova-api log, I see that the cause of that is nova/api/openstack/views/images.py blowing up in the build function where it's trying to set \"name\": image_obj[\"name\"].  \n\nHere's the stack trace:\n-------------------------------------------------------------\n2011-04-04 11:54:51,520 DEBUG routes.middleware [-] Matched GET /images from (pid=4135) __call__ /usr/lib/pymodules/python2.6/routes/middleware.py:100\n2011-04-04 11:54:51,521 DEBUG routes.middleware [-] Route path: '/images', defaults: {'action': u'index', 'controller': <nova.api.openstack.images.ControllerV10 object at 0x2d61550>} from (pid=4135) __call__ /usr/lib/pymodules/python2.6/routes/middleware.py:102\n2011-04-04 11:54:51,521 DEBUG routes.middleware [-] Match dict: {'action': u'index', 'controller': <nova.api.openstack.images.ControllerV10 object at 0x2d61550>} from (pid=4135) __call__ /usr/lib/pymodules/python2.6/routes/middleware.py:103\n2011-04-04 11:54:51,522 ERROR nova.api.openstack [-] Caught error: 'name'\n(nova.api.openstack): TRACE: Traceback (most recent call last):\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/api/openstack/__init__.py\", line 58, in __call__\n(nova.api.openstack): TRACE:     return req.get_response(self.application)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/request.py\", line 919, in get_response\n(nova.api.openstack): TRACE:     application, catch_exc_info=False)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/request.py\", line 887, in call_application\n(nova.api.openstack): TRACE:     app_iter = application(self.environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/routes/middleware.py\", line 131, in __call__\n(nova.api.openstack): TRACE:     response = self.app(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 159, in __call__\n(nova.api.openstack): TRACE:     return resp(environ, start_response)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 147, in __call__\n(nova.api.openstack): TRACE:     resp = self.call_func(req, *args, **self.kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/webob/dec.py\", line 208, in call_func\n(nova.api.openstack): TRACE:     return self.func(req, *args, **kwargs)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/wsgi.py\", line 354, in __call__\n(nova.api.openstack): TRACE:     result = method(**arg_dict)\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/api/openstack/images.py\", line 68, in index\n(nova.api.openstack): TRACE:     return dict(images=[builder(image, detail=False) for image in images])\n(nova.api.openstack): TRACE:   File \"/usr/lib/pymodules/python2.6/nova/api/openstack/views/images.py\", line 64, in build\n(nova.api.openstack): TRACE:     \"name\": image_obj[\"name\"],\n(nova.api.openstack): TRACE: KeyError: 'name'", 
            "date_created": "2011-04-04 06:10:23.082699+00:00", 
            "author": "https://api.launchpad.net/1.0/~jeffjapan"
        }, 
        {
            "content": "Confirmed with python-novaclient:\r\n\r\n$ nova image-list\r\n'name' (HTTP 500)", 
            "date_created": "2011-04-04 12:34:05.825843+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "While I cannot reproduce with the latest glance, and returning an image without a name is unhelpful to the user (and in my mind a slightly large/more pressing issue) I realize that the API shouldn't 'blow up' when encountering an image without a name! :)\n\nI should have a fix ready in a minute after checking to make sure other values aren't suffering from the assumption that they should...exist?", 
            "date_created": "2011-04-04 14:00:02.296704+00:00", 
            "author": "https://api.launchpad.net/1.0/~blamar"
        }, 
        {
            "content": "facing the same issue ...How to get the fix?", 
            "date_created": "2012-06-19 05:02:19.918620+00:00", 
            "author": "https://api.launchpad.net/1.0/~p-rathor"
        }, 
        {
            "content": "The only answer here is to upgrade to Diablo or Essex.", 
            "date_created": "2012-06-19 16:20:28.012739+00:00", 
            "author": "https://api.launchpad.net/1.0/~bcwaldon"
        }
    ], 
    "closed": "2011-04-15 08:32:57.740005+00:00"
}