{
    "status": "Invalid", 
    "last_updated": "2014-01-08 01:36:35.849541+00:00", 
    "description": "Tested on RHEL6.5 with havana release openstack-nova-compute-2013.2.1-1.el6.noarch. \nInstalled openstack via packstack allinone. Have not configured neutron for external access. Using the default network.\n\nSteps to reproduce:\n\n1. Create a f19 glance image. \n2. Boot an instance with the above image.\n\nFails with the following in nova/compute.log:\n\n\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]   File \"/usr/lib/python2.6/site-packages/nova/network/linux_net.py\", line 1280, in create_ovs_vif_port\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]     run_as_root=True)\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 177, in execute\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]     return processutils.execute(*cmd, **kwargs)\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 178, in execute\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]     cmd=' '.join(cmd))\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] ProcessExecutionError: Unexpected error while running command.\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] Command: sudo nova-rootwrap /etc/nova/rootwrap.conf ovs-vsctl -- --may-exist add-port br-int qvoab718ad4-cb -- set Interface qvoab718ad4-cb external-ids:iface-id=ab718ad4-cb35-4736-b57b-d4c2b002cb36 external-ids:iface-status=active external-ids:attached-mac=fa:16:3e:f1:ae:df external-ids:vm-uuid=787f6b8d-2851-41d2-9a2d-d7b5701c546f\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] Exit code: 1\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] Stdout: ''\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] Stderr: '2014-01-07T15:36:50Z|00002|reconnect|WARN|unix:/var/run/openvswitch/db.sock: connection attempt failed (Connection refused)\\novs-vsctl: unix:/var/run/openvswitch/db.sock: database connection failed (Connection refused)\\n'\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] \n\n\nNOTE: This was a working setup. Have booted instances before with the same image. No config changes have been made that could explain the failure.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1266827", 
    "owner": "None", 
    "id": 1266827, 
    "index": 5709, 
    "openned": "2014-01-07 15:48:59.733478+00:00", 
    "created": "2014-01-07 15:48:59.733478+00:00", 
    "title": "Instances fail to boot with error: /var/run/openvswitch/db.sock: connection attempt failed", 
    "comments": [
        {
            "content": "Tested on RHEL6.5 with havana release openstack-nova-compute-2013.2.1-1.el6.noarch. \nInstalled openstack via packstack allinone. Have not configured neutron for external access. Using the default network.\n\nSteps to reproduce:\n\n1. Create a f19 glance image. \n2. Boot an instance with the above image.\n\nFails with the following in nova/compute.log:\n\n\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]   File \"/usr/lib/python2.6/site-packages/nova/network/linux_net.py\", line 1280, in create_ovs_vif_port\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]     run_as_root=True)\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 177, in execute\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]     return processutils.execute(*cmd, **kwargs)\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 178, in execute\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f]     cmd=' '.join(cmd))\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] ProcessExecutionError: Unexpected error while running command.\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] Command: sudo nova-rootwrap /etc/nova/rootwrap.conf ovs-vsctl -- --may-exist add-port br-int qvoab718ad4-cb -- set Interface qvoab718ad4-cb external-ids:iface-id=ab718ad4-cb35-4736-b57b-d4c2b002cb36 external-ids:iface-status=active external-ids:attached-mac=fa:16:3e:f1:ae:df external-ids:vm-uuid=787f6b8d-2851-41d2-9a2d-d7b5701c546f\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] Exit code: 1\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] Stdout: ''\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] Stderr: '2014-01-07T15:36:50Z|00002|reconnect|WARN|unix:/var/run/openvswitch/db.sock: connection attempt failed (Connection refused)\\novs-vsctl: unix:/var/run/openvswitch/db.sock: database connection failed (Connection refused)\\n'\n2014-01-07 21:07:10.245 32545 TRACE nova.compute.manager [instance: 787f6b8d-2851-41d2-9a2d-d7b5701c546f] \n\n\nNOTE: This was a working setup. Have booted instances before with the same image. No config changes have been made that could explain the failure.", 
            "date_created": "2014-01-07 15:48:59.733478+00:00", 
            "author": "https://api.launchpad.net/1.0/~smanjara"
        }, 
        {
            "content": "As a workaround tried the following which worked: \n\n1. rm -rf  /var/run/openvswitch/db.sock\n2. service openvswitch restart\n\n", 
            "date_created": "2014-01-07 16:01:51.298630+00:00", 
            "author": "https://api.launchpad.net/1.0/~smanjara"
        }, 
        {
            "content": "As a workaround tried the following and it worked:\n\n1. rm -rf  /var/run/openvswitch/db.sock\n2. service openvswitch restart", 
            "date_created": "2014-01-07 18:36:07.279295+00:00", 
            "author": "https://api.launchpad.net/1.0/~smanjara"
        }, 
        {
            "content": "this is either a f19 issue or a openvswitch issue as we don't set/use/maintain the unix:/var/run/openvswitch/db.sock parameter anywhere in the nova code base and hence have no \"cleanup\" code for clearing up that file. ", 
            "date_created": "2014-01-08 01:36:24.457131+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }
    ], 
    "closed": "2014-01-08 01:36:33.035542+00:00"
}