{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 12:14:57.080279+00:00", 
    "description": "When unshelving a shelved server, the server cannot be changed to 'Active' forever:\n\n$ nova list\n+--------------------------------------+------+-------------------+------------+-------------+------------------+\n| ID                                   | Name | Status            | Task State | Power State | Networks         |\n+--------------------------------------+------+-------------------+------------+-------------+------------------+\n| 919234d1-4a3d-4c26-bddd-77d004f7d41e | vm01 | SHELVED_OFFLOADED | unshelving | Shutdown    | private=10.0.0.3 |\n+--------------------------------------+------+-------------------+------------+-------------+------------------+\n\nand nova-scheduler outputs the following error messages:\n\n2013-10-01 17:22:55.456 ERROR nova.openstack.common.rpc.amqp [req-51700174-fc3a-48f4-8962-8f54d6f30164 admin demo] Exception during message handling\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/common.py\", line 439, in inner\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     return catch_client_exception(exceptions, func, *args, **kwargs)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/common.py\", line 420, in catch_client_exception\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     return func(*args, **kwargs)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/scheduler/manager.py\", line 298, in select_destinations\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     filter_properties)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/scheduler/filter_scheduler.py\", line 144, in select_destinations\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     filter_properties, instance_uuids)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/scheduler/filter_scheduler.py\", line 288, in _schedule\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     scheduler_hints = filter_properties.get('scheduler_hints') or {}\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp AttributeError: 'list' object has no attribute 'get'", 
    "tags": [
        "compute"
    ], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1233563", 
    "owner": "https://api.launchpad.net/1.0/~oomichi", 
    "id": 1233563, 
    "index": 1258, 
    "openned": "2013-10-01 08:55:15.658116+00:00", 
    "created": "2013-10-01 08:55:15.658116+00:00", 
    "title": "unshelve feature does not work", 
    "comments": [
        {
            "content": "When unshelving a shelved server, the server cannot be changed to 'Active' forever:\n\n$ nova list\n+--------------------------------------+------+-------------------+------------+-------------+------------------+\n| ID                                   | Name | Status            | Task State | Power State | Networks         |\n+--------------------------------------+------+-------------------+------------+-------------+------------------+\n| 919234d1-4a3d-4c26-bddd-77d004f7d41e | vm01 | SHELVED_OFFLOADED | unshelving | Shutdown    | private=10.0.0.3 |\n+--------------------------------------+------+-------------------+------------+-------------+------------------+\n\nand nova-scheduler outputs the following error messages:\n\n2013-10-01 17:22:55.456 ERROR nova.openstack.common.rpc.amqp [req-51700174-fc3a-48f4-8962-8f54d6f30164 admin demo] Exception during message handling\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/common.py\", line 439, in inner\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     return catch_client_exception(exceptions, func, *args, **kwargs)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/openstack/common/rpc/common.py\", line 420, in catch_client_exception\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     return func(*args, **kwargs)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/scheduler/manager.py\", line 298, in select_destinations\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     filter_properties)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/scheduler/filter_scheduler.py\", line 144, in select_destinations\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     filter_properties, instance_uuids)\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/nova/nova/scheduler/filter_scheduler.py\", line 288, in _schedule\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp     scheduler_hints = filter_properties.get('scheduler_hints') or {}\n2013-10-01 17:22:55.456 TRACE nova.openstack.common.rpc.amqp AttributeError: 'list' object has no attribute 'get'", 
            "date_created": "2013-10-01 08:55:15.658116+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "review in progress: https://review.openstack.org/#/c/49117/\n", 
            "date_created": "2013-10-01 09:07:56.095072+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/49117\nCommitted: http://github.com/openstack/nova/commit/ef3fbe99af498a40555b44f9ef0fcf6b88eb5d30\nSubmitter: Jenkins\nBranch:    master\n\ncommit ef3fbe99af498a40555b44f9ef0fcf6b88eb5d30\nAuthor: Ken'ichi Ohmichi <email address hidden>\nDate:   Tue Oct 1 17:10:50 2013 +0900\n\n    Fix filter_properties of unshelve API\n    \n    When unshelving a shelved server, nova-scheduler fails because nova-conductor\n    of current unshelve feature passes an empty list as filter_properties, and\n    nova-scheduler handles it as a dict.\n    \n    To fix the problem, this patch changes the filter_properties to an empty dict.\n    \n    Closes-Bug: #1233563\n    \n    Change-Id: I2c7a2a743a8142af0be0a182067f3295980aa997\n", 
            "date_created": "2013-10-05 16:15:28.493609+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: milestone-proposed\nReview: https://review.openstack.org/50934", 
            "date_created": "2013-10-10 14:20:36.251850+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/50934\nCommitted: http://github.com/openstack/nova/commit/18dac4c853818b363d75e89f25e1e206fb744c8c\nSubmitter: Jenkins\nBranch:    milestone-proposed\n\ncommit 18dac4c853818b363d75e89f25e1e206fb744c8c\nAuthor: Ken'ichi Ohmichi <email address hidden>\nDate:   Tue Oct 1 17:10:50 2013 +0900\n\n    Fix filter_properties of unshelve API\n    \n    When unshelving a shelved server, nova-scheduler fails because nova-conductor\n    of current unshelve feature passes an empty list as filter_properties, and\n    nova-scheduler handles it as a dict.\n    \n    To fix the problem, this patch changes the filter_properties to an empty dict.\n    \n    Closes-Bug: #1233563\n    \n    Change-Id: I2c7a2a743a8142af0be0a182067f3295980aa997\n    (cherry picked from commit ef3fbe99af498a40555b44f9ef0fcf6b88eb5d30)\n", 
            "date_created": "2013-10-10 22:13:52.975902+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-10-10 22:13:50.587666+00:00"
}