{
    "status": "Fix Released", 
    "last_updated": "2015-04-01 15:32:16.713843+00:00", 
    "description": "OS: Ubuntu 12.04\nKernel: 3.8.0-37-generic \nlibvirt: 0.9.8-2ubuntu17.18\n\n2014-04-11 16:35:03.980 12081 AUDIT nova.service [-] Starting compute node (version 2014.2)\n2014-04-11 16:35:04.004 12081 DEBUG nova.virt.libvirt.driver [-] Connecting to libvirt: qemu:///system _get_new_connection /opt/stack/nova/nova/virt/libvirt/driver.py:670\n2014-04-11 16:35:18.664 WARNING nova.virt.libvirt.driver [req-6e97f1b4-a832-4521-881d-c91196220556 None None] Cannot update service status on host: Router,since it is not registered.\n2014-04-11 16:35:18.664 12081 DEBUG nova.virt.libvirt.driver [-] Registering for lifecycle events <nova.virt.libvirt.driver.LibvirtDriver object at 0x2b5ce10> _get_new_connection /opt/stack/nova/nova/virt/libvirt/driver.p\ny:686\n2014-04-11 16:35:19.145 12081 DEBUG nova.virt.libvirt.driver [-] Registering for connection events: <nova.virt.libvirt.driver.LibvirtDriver object at 0x2b5ce10> _get_new_connection /opt/stack/nova/nova/virt/libvirt/driver\n.py:698\n2014-04-11 16:35:19.145 12081 DEBUG nova.virt.libvirt.driver [-] The version of python-libvirt does not support registerCloseCallback or is too old: virConnect instance has no attribute 'registerCloseCallback' _get_new_co\nnnection /opt/stack/nova/nova/virt/libvirt/driver.py:708\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 346, in fire_timers\n    timer()\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/timer.py\", line 56, in __call__\n    cb(*args, **kw)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 163, in _do_send\n    waiter.switch(result)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 194, in main\n    result = function(*args, **kwargs)\n  File \"/opt/stack/nova/nova/openstack/common/service.py\", line 490, in run_service\n    service.start()\n  File \"/opt/stack/nova/nova/service.py\", line 163, in start\n    self.manager.init_host()\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 1051, in init_host\n    self.driver.init_host(host=self.host)\n  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 656, in init_host\n    self._do_quality_warnings()\n  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 639, in _do_quality_warnings\n    caps = self.get_host_capabilities()\n  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2842, in get_host_capabilities\n    xmlstr = self._conn.getCapabilities()\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 179, in doit\n    result = proxy_call(self._autowrap, f, *args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 139, in proxy_call\n    rv = execute(f,*args,**kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 77, in tworker\n    rv = meth(*args,**kwargs)\n  File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 2236, in getCapabilities\n    if ret is None: raise libvirtError ('virConnectGetCapabilities() failed', conn=self)\nlibvirtError: End of file while reading data: Input/output error\n2014-04-11 16:35:50.023 12081 ERROR nova.openstack.common.threadgroup [-] End of file while reading data: Input/output error\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/openstack/common/threadgroup.py\", line 125, in wait\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     x.wait()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/openstack/common/threadgroup.py\", line 47, in wait\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 168, in wait\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 116, in wait\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 187, in switch\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 194, in main\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     result = function(*args, **kwargs)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/openstack/common/service.py\", line 490, in run_service\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     service.start()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/service.py\", line 163, in start\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     self.manager.init_host()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/compute/manager.py\", line 1051, in init_host\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     self.driver.init_host(host=self.host)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 656, in init_host\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     self._do_quality_warnings()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 639, in _do_quality_warnings\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     caps = self.get_host_capabilities()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2842, in get_host_capabilities\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     xmlstr = self._conn.getCapabilities()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 179, in doit\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 139, in proxy_call\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     rv = execute(f,*args,**kwargs)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 77, in tworker\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     rv = meth(*args,**kwargs)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 2236, in getCapabilities\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     if ret is None: raise libvirtError ('virConnectGetCapabilities() failed', conn=self)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup libvirtError: End of file while reading data: Input/output error\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup", 
    "tags": [
        "libvirt"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1306432", 
    "owner": "None", 
    "id": 1306432, 
    "index": 6006, 
    "openned": "2014-04-11 07:50:20.510018+00:00", 
    "created": "2014-04-11 07:50:20.510018+00:00", 
    "title": "n-cpu with devstack is down caused by libvirt io error sometimes", 
    "comments": [
        {
            "content": "OS: Ubuntu 12.04\nKernel: 3.8.0-37-generic \nlibvirt: 0.9.8-2ubuntu17.18\n\n2014-04-11 16:35:03.980 12081 AUDIT nova.service [-] Starting compute node (version 2014.2)\n2014-04-11 16:35:04.004 12081 DEBUG nova.virt.libvirt.driver [-] Connecting to libvirt: qemu:///system _get_new_connection /opt/stack/nova/nova/virt/libvirt/driver.py:670\n2014-04-11 16:35:18.664 WARNING nova.virt.libvirt.driver [req-6e97f1b4-a832-4521-881d-c91196220556 None None] Cannot update service status on host: Router,since it is not registered.\n2014-04-11 16:35:18.664 12081 DEBUG nova.virt.libvirt.driver [-] Registering for lifecycle events <nova.virt.libvirt.driver.LibvirtDriver object at 0x2b5ce10> _get_new_connection /opt/stack/nova/nova/virt/libvirt/driver.p\ny:686\n2014-04-11 16:35:19.145 12081 DEBUG nova.virt.libvirt.driver [-] Registering for connection events: <nova.virt.libvirt.driver.LibvirtDriver object at 0x2b5ce10> _get_new_connection /opt/stack/nova/nova/virt/libvirt/driver\n.py:698\n2014-04-11 16:35:19.145 12081 DEBUG nova.virt.libvirt.driver [-] The version of python-libvirt does not support registerCloseCallback or is too old: virConnect instance has no attribute 'registerCloseCallback' _get_new_co\nnnection /opt/stack/nova/nova/virt/libvirt/driver.py:708\nTraceback (most recent call last):\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 346, in fire_timers\n    timer()\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/timer.py\", line 56, in __call__\n    cb(*args, **kw)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 163, in _do_send\n    waiter.switch(result)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 194, in main\n    result = function(*args, **kwargs)\n  File \"/opt/stack/nova/nova/openstack/common/service.py\", line 490, in run_service\n    service.start()\n  File \"/opt/stack/nova/nova/service.py\", line 163, in start\n    self.manager.init_host()\n  File \"/opt/stack/nova/nova/compute/manager.py\", line 1051, in init_host\n    self.driver.init_host(host=self.host)\n  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 656, in init_host\n    self._do_quality_warnings()\n  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 639, in _do_quality_warnings\n    caps = self.get_host_capabilities()\n  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2842, in get_host_capabilities\n    xmlstr = self._conn.getCapabilities()\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 179, in doit\n    result = proxy_call(self._autowrap, f, *args, **kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 139, in proxy_call\n    rv = execute(f,*args,**kwargs)\n  File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 77, in tworker\n    rv = meth(*args,**kwargs)\n  File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 2236, in getCapabilities\n    if ret is None: raise libvirtError ('virConnectGetCapabilities() failed', conn=self)\nlibvirtError: End of file while reading data: Input/output error\n2014-04-11 16:35:50.023 12081 ERROR nova.openstack.common.threadgroup [-] End of file while reading data: Input/output error\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/openstack/common/threadgroup.py\", line 125, in wait\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     x.wait()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/openstack/common/threadgroup.py\", line 47, in wait\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 168, in wait\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/event.py\", line 116, in wait\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/hubs/hub.py\", line 187, in switch\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/greenthread.py\", line 194, in main\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     result = function(*args, **kwargs)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/openstack/common/service.py\", line 490, in run_service\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     service.start()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/service.py\", line 163, in start\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     self.manager.init_host()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/compute/manager.py\", line 1051, in init_host\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     self.driver.init_host(host=self.host)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 656, in init_host\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     self._do_quality_warnings()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 639, in _do_quality_warnings\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     caps = self.get_host_capabilities()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2842, in get_host_capabilities\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     xmlstr = self._conn.getCapabilities()\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 179, in doit\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 139, in proxy_call\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     rv = execute(f,*args,**kwargs)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/local/lib/python2.7/dist-packages/eventlet/tpool.py\", line 77, in tworker\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     rv = meth(*args,**kwargs)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 2236, in getCapabilities\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup     if ret is None: raise libvirtError ('virConnectGetCapabilities() failed', conn=self)\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup libvirtError: End of file while reading data: Input/output error\n2014-04-11 16:35:50.023 12081 TRACE nova.openstack.common.threadgroup", 
            "date_created": "2014-04-11 07:50:20.510018+00:00", 
            "author": "https://api.launchpad.net/1.0/~fujioka-yuuichi-d"
        }, 
        {
            "content": "Can you elaborate a bit more on the circumstances in which this happens?", 
            "date_created": "2014-04-15 21:14:13.085787+00:00", 
            "author": "https://api.launchpad.net/1.0/~sross-7"
        }, 
        {
            "content": "Facing the same issue. Can you please tell me the work around for this.", 
            "date_created": "2014-06-17 04:27:06.372174+00:00", 
            "author": "https://api.launchpad.net/1.0/~sachi-gupta"
        }, 
        {
            "content": "We have had significant issues with libvirt: 0.9.8 and are now testing against the version in ubuntu 14.04", 
            "date_created": "2014-12-03 16:32:10.663930+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "this sounds like a libvirt bug", 
            "date_created": "2014-12-03 16:32:32.868348+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "we added retry logic around this", 
            "date_created": "2015-04-01 15:32:16.189357+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }
    ], 
    "closed": "2015-04-01 15:32:07.840016+00:00"
}