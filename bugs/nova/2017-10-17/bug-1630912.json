{
    "status": "Invalid", 
    "last_updated": "2016-11-07 10:41:36.012695+00:00", 
    "description": "Happens randowmly:\n\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [req-50d2dc6d-072e-423e-9de0-096ba307411f admin demo] [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4] Instance failed to spawn\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4] Traceback (most recent call last):\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2078, in _build_resources\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     yield resources\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1920, in _build_and_run_instance\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     block_device_info=block_device_info)\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2571, in spawn\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     admin_pass=admin_password)\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2960, in _create_image\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     image_id=disk_images['kernel_id'])\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 218, in cache\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     *args, **kwargs)\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 504, in create_image\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     prepare_template(target=base, *args, **kwargs)\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 264, in inner\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     do_log=False, semaphores=semaphores, delay=delay):\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/usr/lib/python2.7/contextlib.py\", line 17, in __enter__\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     return self.gen.next()\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 216, in lock\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     ext_lock.acquire(delay=delay)\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/usr/local/lib/python2.7/dist-packages/fasteners/process_lock.py\", line 151, in acquire\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     self._do_open()\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/usr/local/lib/python2.7/dist-packages/fasteners/process_lock.py\", line 123, in _do_open\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     self.lockfile = open(self.path, 'a')\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4] IOError: [Errno 13] Permission denied: '/opt/stack/data/nova/instances/locks/nova-273d5645757056cdd056de4cfe9f121b9eee6ae3'\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 20, 
    "link": "https://bugs.launchpad.net/nova/+bug/1630912", 
    "owner": "None", 
    "id": 1630912, 
    "index": 7737, 
    "openned": "2016-10-06 09:26:54.170467+00:00", 
    "created": "2016-10-06 09:26:54.170467+00:00", 
    "title": "stable/newton: unable to spin up a kvm instance", 
    "comments": [
        {
            "content": "Happens randowmly:\n\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [req-50d2dc6d-072e-423e-9de0-096ba307411f admin demo] [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4] Instance failed to spawn\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4] Traceback (most recent call last):\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/compute/manager.py\", line 2078, in _build_resources\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     yield resources\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1920, in _build_and_run_instance\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     block_device_info=block_device_info)\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2571, in spawn\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     admin_pass=admin_password)\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 2960, in _create_image\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     image_id=disk_images['kernel_id'])\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 218, in cache\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     *args, **kwargs)\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/opt/stack/nova/nova/virt/libvirt/imagebackend.py\", line 504, in create_image\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     prepare_template(target=base, *args, **kwargs)\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 264, in inner\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     do_log=False, semaphores=semaphores, delay=delay):\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/usr/lib/python2.7/contextlib.py\", line 17, in __enter__\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     return self.gen.next()\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 216, in lock\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     ext_lock.acquire(delay=delay)\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/usr/local/lib/python2.7/dist-packages/fasteners/process_lock.py\", line 151, in acquire\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     self._do_open()\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]   File \"/usr/local/lib/python2.7/dist-packages/fasteners/process_lock.py\", line 123, in _do_open\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]     self.lockfile = open(self.path, 'a')\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4] IOError: [Errno 13] Permission denied: '/opt/stack/data/nova/instances/locks/nova-273d5645757056cdd056de4cfe9f121b9eee6ae3'\n2016-10-06 20:22:18.100 1931 ERROR nova.compute.manager [instance: 04709c94-0ba3-4312-ad1c-5739e5600bf4]", 
            "date_created": "2016-10-06 09:26:54.170467+00:00", 
            "author": "https://api.launchpad.net/1.0/~garyk"
        }, 
        {
            "content": "So this is getting EPERM trying to open a lock file. The lock file is for the entry in the image cache, so potentially shared amongst many instances. The specific failure is because we can't open it for append. I'm going to assume there are no bugs in the locking libraries. Immediate causes of the failure that I can think of could be:\n\n* We don't have write access to /opt/stack/data/nova/instances/locks/\n\nHow is this directory created?\nIs there any potential race during creation, e.g. create as root then chown?\nIs it potentially created somewhere which gives it root ownership if it runs first?\nAre we on NFS with messed up uids between different nodes?\n\n* /opt/stack/data/nova/instances/locks/nova-273d5645757056cdd056de4cfe9f121b9eee6ae3 exists, and is owned by another user\n\nIs there a potential chown race?\nAre we on NFS with messed up uids between different nodes?\n\n* The filesystem is weird\n\nIs append mode permitted?\nIs NFS translating us to the nobody user or similar?\n\nThat's a bit of a brain dump. I'd need to know more about the setup, I think. Could you please include:\n\n* nova.conf\n* A description of the storage configuration\n* The exact api call executed which resulted in failure", 
            "date_created": "2016-10-06 10:06:00.117480+00:00", 
            "author": "https://api.launchpad.net/1.0/~mbooth-9"
        }, 
        {
            "content": "Hi,\n\nThis issue was due to permission issue of the folder /opt/stack/data/nova/instances/locks.It was owned by 'root' user when I faced this issue.\nI changed the owner of that folder and currently issue is not seen. I'm able to spin the instance on KVM without any issue.\n\nHence closing this bug.", 
            "date_created": "2016-11-04 12:35:44.276809+00:00", 
            "author": "https://api.launchpad.net/1.0/~sujai"
        }
    ], 
    "closed": "2016-11-07 10:41:33.407788+00:00"
}