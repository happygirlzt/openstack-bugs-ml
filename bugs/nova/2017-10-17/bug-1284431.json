{
    "status": "Invalid", 
    "last_updated": "2016-04-19 14:40:59.702154+00:00", 
    "description": "We had to reboot the control node for ci-overcloud, after that, and ensuring it was online again properly...\n\n+------------------+-------------------------------------------------+----------+---------+-------+--------------------------\n| Binary           | Host                                            | Zone     | Status  | State | Updated_at               \n+------------------+-------------------------------------------------+----------+---------+-------+--------------------------\n| nova-conductor   | ci-overcloud-notcompute0-gxezgcvv4v2q           | internal | enabled | down  | 2014-02-24T19:42:26.00000\n| nova-cert        | ci-overcloud-notcompute0-gxezgcvv4v2q           | internal | enabled | down  | 2014-02-24T19:42:18.00000\n| nova-scheduler   | ci-overcloud-notcompute0-gxezgcvv4v2q           | internal | enabled | down  | 2014-02-24T19:42:26.00000\n| nova-consoleauth | ci-overcloud-notcompute0-gxezgcvv4v2q           | internal | enabled | down  | 2014-02-24T19:42:18.00000\n| nova-compute     | ci-overcloud-novacompute4-5aywwwqlmtv3          | nova     | enabled | down  | 2014-02-25T02:07:37.00000\n| nova-compute     | ci-overcloud-novacompute7-mosbehy6ikhz          | nova     | enabled | down  | 2014-02-25T02:07:44.00000\n| nova-compute     | ci-overcloud-novacompute0-vidddfuaauhw          | nova     | enabled | down  | 2014-02-25T02:07:36.00000\n| nova-compute     | ci-overcloud-novacompute6-6fnuizd4n4gv          | nova     | enabled | down  | 2014-02-25T02:07:36.00000\n| nova-compute     | ci-overcloud-novacompute1-4q2dbhdklrkq          | nova     | enabled | down  | 2014-02-25T02:07:43.00000\n| nova-compute     | ci-overcloud-novacompute5-y27zvc4o5fps          | nova     | enabled | down  | 2014-02-25T02:07:36.00000\n| nova-compute     | ci-overcloud-novacompute3-sxibwe5v5gpw          | nova     | enabled | down  | 2014-02-25T02:08:40.00000\n| nova-compute     | ci-overcloud-novacompute8-4qu2kxq4e6pb          | nova     | enabled | down  | 2014-02-25T02:08:41.00000\n| nova-compute     | ci-overcloud-novacompute2-tvsutghnaofq          | nova     | enabled | down  | 2014-02-25T02:07:36.00000\n| nova-compute     | ci-overcloud-novacompute9-qt7sqeqcexjh          | nova     | enabled | down  | 2014-02-25T02:08:45.00000\n| nova-scheduler   | ci-overcloud-notcompute0-gxezgcvv4v2q.novalocal | internal | enabled | up    | 2014-02-25T03:24:53.00000\n| nova-conductor   | ci-overcloud-notcompute0-gxezgcvv4v2q.novalocal | internal | enabled | up    | 2014-02-25T03:24:59.00000\n| nova-consoleauth | ci-overcloud-notcompute0-gxezgcvv4v2q.novalocal | internal | enabled | up    | 2014-02-25T03:24:53.00000\n| nova-cert        | ci-overcloud-notcompute0-gxezgcvv4v2q.novalocal | internal | enabled | up    | 2014-02-25T03:24:51.00000\n+------------------+-------------------------------------------------+----------+---------+-------+--------------------------", 
    "tags": [
        "compute"
    ], 
    "importance": "Undecided", 
    "heat": 16, 
    "link": "https://bugs.launchpad.net/nova/+bug/1284431", 
    "owner": "None", 
    "id": 1284431, 
    "index": 5862, 
    "openned": "2014-02-25 03:24:43.478662+00:00", 
    "created": "2014-02-25 03:24:22.187174+00:00", 
    "title": "nova-compute doesn't reconnect properly after control plane outage", 
    "comments": [
        {
            "content": "We had to reboot the control node for ci-overcloud, after that, and ensuring it was online again properly...\n\n+------------------+-------------------------------------------------+----------+---------+-------+--------------------------\n| Binary           | Host                                            | Zone     | Status  | State | Updated_at               \n+------------------+-------------------------------------------------+----------+---------+-------+--------------------------\n| nova-conductor   | ci-overcloud-notcompute0-gxezgcvv4v2q           | internal | enabled | down  | 2014-02-24T19:42:26.00000\n| nova-cert        | ci-overcloud-notcompute0-gxezgcvv4v2q           | internal | enabled | down  | 2014-02-24T19:42:18.00000\n| nova-scheduler   | ci-overcloud-notcompute0-gxezgcvv4v2q           | internal | enabled | down  | 2014-02-24T19:42:26.00000\n| nova-consoleauth | ci-overcloud-notcompute0-gxezgcvv4v2q           | internal | enabled | down  | 2014-02-24T19:42:18.00000\n| nova-compute     | ci-overcloud-novacompute4-5aywwwqlmtv3          | nova     | enabled | down  | 2014-02-25T02:07:37.00000\n| nova-compute     | ci-overcloud-novacompute7-mosbehy6ikhz          | nova     | enabled | down  | 2014-02-25T02:07:44.00000\n| nova-compute     | ci-overcloud-novacompute0-vidddfuaauhw          | nova     | enabled | down  | 2014-02-25T02:07:36.00000\n| nova-compute     | ci-overcloud-novacompute6-6fnuizd4n4gv          | nova     | enabled | down  | 2014-02-25T02:07:36.00000\n| nova-compute     | ci-overcloud-novacompute1-4q2dbhdklrkq          | nova     | enabled | down  | 2014-02-25T02:07:43.00000\n| nova-compute     | ci-overcloud-novacompute5-y27zvc4o5fps          | nova     | enabled | down  | 2014-02-25T02:07:36.00000\n| nova-compute     | ci-overcloud-novacompute3-sxibwe5v5gpw          | nova     | enabled | down  | 2014-02-25T02:08:40.00000\n| nova-compute     | ci-overcloud-novacompute8-4qu2kxq4e6pb          | nova     | enabled | down  | 2014-02-25T02:08:41.00000\n| nova-compute     | ci-overcloud-novacompute2-tvsutghnaofq          | nova     | enabled | down  | 2014-02-25T02:07:36.00000\n| nova-compute     | ci-overcloud-novacompute9-qt7sqeqcexjh          | nova     | enabled | down  | 2014-02-25T02:08:45.00000\n| nova-scheduler   | ci-overcloud-notcompute0-gxezgcvv4v2q.novalocal | internal | enabled | up    | 2014-02-25T03:24:53.00000\n| nova-conductor   | ci-overcloud-notcompute0-gxezgcvv4v2q.novalocal | internal | enabled | up    | 2014-02-25T03:24:59.00000\n| nova-consoleauth | ci-overcloud-notcompute0-gxezgcvv4v2q.novalocal | internal | enabled | up    | 2014-02-25T03:24:53.00000\n| nova-cert        | ci-overcloud-notcompute0-gxezgcvv4v2q.novalocal | internal | enabled | up    | 2014-02-25T03:24:51.00000\n+------------------+-------------------------------------------------+----------+---------+-------+--------------------------", 
            "date_created": "2014-02-25 03:24:22.187174+00:00", 
            "author": "https://api.launchpad.net/1.0/~lifeless"
        }, 
        {
            "content": "could we have some logs from nova-compute, what did it fail on when it came up?", 
            "date_created": "2014-02-26 16:57:44.521539+00:00", 
            "author": "https://api.launchpad.net/1.0/~johngarbutt"
        }, 
        {
            "content": "periodic task seems to fail reporting the status:\n\nnova.openstack.common.periodic_task Traceback (most recent call last):\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/nova/openstack/common/periodic_task.py\", line 198, in run_periodic_tasks\nnova.openstack.common.periodic_task     task(self, context)\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/nova/compute/manager.py\", line 4997, in _heal_instance_info_cache\nnova.openstack.common.periodic_task     context, self.host, expected_attrs=[], use_slave=True)\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/nova/objects/base.py\", line 151, in wrapper\nnova.openstack.common.periodic_task     args, kwargs)\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/nova/conductor/rpcapi.py\", line 344, in object_class_action\nnova.openstack.common.periodic_task     objver=objver, args=args, kwargs=kwargs)\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/rpc/client.py\", line 150, in call\nnova.openstack.common.periodic_task     wait_for_reply=True, timeout=timeout)\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/transport.py\", line 90, in _send\nnova.openstack.common.periodic_task     timeout=timeout)\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/_drivers/amqpdriver.py\", line 412, in send\nnova.openstack.common.periodic_task     return self._send(target, ctxt, message, wait_for_reply, timeout)\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/_drivers/amqpdriver.py\", line 403, in _send\nnova.openstack.common.periodic_task     result = self._waiter.wait(msg_id, timeout)\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/_drivers/amqpdriver.py\", line 280, in wait\nnova.openstack.common.periodic_task     reply, ending, trylock = self._poll_queue(msg_id, timeout)\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/_drivers/amqpdriver.py\", line 220, in _poll_queue\nnova.openstack.common.periodic_task     message = self.waiters.get(msg_id, timeout)\nnova.openstack.common.periodic_task   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/_drivers/amqpdriver.py\", line 126, in get\nnova.openstack.common.periodic_task     'to message ID %s' % msg_id)\nnova.openstack.common.periodic_task MessagingTimeout: Timed out waiting for a reply to message ID fd733e68c2da4e4b8175a0df442cc897\n", 
            "date_created": "2014-07-23 11:03:52.193815+00:00", 
            "author": "https://api.launchpad.net/1.0/~gfidente"
        }, 
        {
            "content": "this starts to happen despite the oslo.messaging apparently being reconnected:\n\noslo.messaging._drivers.impl_rabbit [-] Failed to publish message to topic 'conductor': Socket closed\noslo.messaging._drivers.impl_rabbit Traceback (most recent call last):\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_rabbit.py\", line 622, in ensure\noslo.messaging._drivers.impl_rabbit     return method(*args, **kwargs)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_rabbit.py\", line 718, in _publish\noslo.messaging._drivers.impl_rabbit     publisher = cls(self.conf, self.channel, topic, **kwargs)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_rabbit.py\", line 379, in __init__\noslo.messaging._drivers.impl_rabbit     **options)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_rabbit.py\", line 326, in __init__\noslo.messaging._drivers.impl_rabbit     self.reconnect(channel)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_rabbit.py\", line 334, in reconnect\noslo.messaging._drivers.impl_rabbit     routing_key=self.routing_key)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/kombu/messaging.py\", line 85, in __init__\noslo.messaging._drivers.impl_rabbit     self.revive(self._channel)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/kombu/messaging.py\", line 218, in revive\noslo.messaging._drivers.impl_rabbit     self.declare()\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/kombu/messaging.py\", line 105, in declare\noslo.messaging._drivers.impl_rabbit     self.exchange.declare()\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/kombu/entity.py\", line 166, in declare\noslo.messaging._drivers.impl_rabbit     nowait=nowait, passive=passive,\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/amqp/channel.py\", line 620, in exchange_declare\noslo.messaging._drivers.impl_rabbit     (40, 11),  # Channel.exchange_declare_ok\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/amqp/abstract_channel.py\", line 67, in wait\noslo.messaging._drivers.impl_rabbit     self.channel_id, allowed_methods)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/amqp/connection.py\", line 237, in _wait_method\noslo.messaging._drivers.impl_rabbit     self.method_reader.read_method()\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/nova/lib/python2.7/site-packages/amqp/method_framing.py\", line 189, in read_method\noslo.messaging._drivers.impl_rabbit     raise m\noslo.messaging._drivers.impl_rabbit IOError: Socket closed\n\noslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on 192.0.2.29:5672\noslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\noslo.messaging._drivers.impl_rabbit [-] Connected to AMQP server on 192.0.2.29:5672\noslo.messaging._drivers.impl_rabbit [-] Failed to publish message to topic 'q-plugin': Socket closed\noslo.messaging._drivers.impl_rabbit Traceback (most recent call last):\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_rabbit.py\", line 622, in ensure\noslo.messaging._drivers.impl_rabbit     return method(*args, **kwargs)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_rabbit.py\", line 718, in _publish\noslo.messaging._drivers.impl_rabbit     publisher = cls(self.conf, self.channel, topic, **kwargs)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_rabbit.py\", line 379, in __init__\noslo.messaging._drivers.impl_rabbit     **options)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_rabbit.py\", line 326, in __init__\noslo.messaging._drivers.impl_rabbit     self.reconnect(channel)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_rabbit.py\", line 334, in reconnect\noslo.messaging._drivers.impl_rabbit     routing_key=self.routing_key)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/kombu/messaging.py\", line 85, in __init__\noslo.messaging._drivers.impl_rabbit     self.revive(self._channel)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/kombu/messaging.py\", line 218, in revive\noslo.messaging._drivers.impl_rabbit     self.declare()\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/kombu/messaging.py\", line 105, in declare\noslo.messaging._drivers.impl_rabbit     self.exchange.declare()\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/kombu/entity.py\", line 166, in declare\noslo.messaging._drivers.impl_rabbit     nowait=nowait, passive=passive,\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/amqp/channel.py\", line 620, in exchange_declare\noslo.messaging._drivers.impl_rabbit     (40, 11),  # Channel.exchange_declare_ok\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/amqp/abstract_channel.py\", line 67, in wait\noslo.messaging._drivers.impl_rabbit     self.channel_id, allowed_methods)\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/amqp/connection.py\", line 237, in _wait_method\noslo.messaging._drivers.impl_rabbit     self.method_reader.read_method()\noslo.messaging._drivers.impl_rabbit   File \"/opt/stack/venvs/openstack/lib/python2.7/site-packages/amqp/method_framing.py\", line 189, in read_method\noslo.messaging._drivers.impl_rabbit     raise m\noslo.messaging._drivers.impl_rabbit IOError: Socket closed\noslo.messaging._drivers.impl_rabbit\noslo.messaging._drivers.impl_rabbit [-] Reconnecting to AMQP server on 192.0.2.29:5672\noslo.messaging._drivers.impl_rabbit [-] Delaying reconnect for 1.0 seconds...\noslo.messaging._drivers.impl_rabbit [-] Connected to AMQP server on 192.0.2.29:5672\n", 
            "date_created": "2014-07-23 11:07:23.526777+00:00", 
            "author": "https://api.launchpad.net/1.0/~gfidente"
        }, 
        {
            "content": "nova conductor was silently failing; it printed a large amount of identical messages:\n\noslo.messaging._drivers.impl_rabbit [-] Connected to AMQP server on 192.0.2.29:5672\n\nand only then the hypervisors were seen up again", 
            "date_created": "2014-07-23 11:28:55.146816+00:00", 
            "author": "https://api.launchpad.net/1.0/~gfidente"
        }, 
        {
            "content": "^^ in the previous comment I missed to say that I _restarted_ nova-conductor for that to happen", 
            "date_created": "2014-07-23 11:29:38.207676+00:00", 
            "author": "https://api.launchpad.net/1.0/~gfidente"
        }, 
        {
            "content": "My understanding from the Ops meetups is this is all about rabbit and oslo.messaging", 
            "date_created": "2015-04-01 13:05:15.225654+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "This should be fixed since oslo.messaging 1.5.0", 
            "date_created": "2015-04-17 09:14:08.862469+00:00", 
            "author": "https://api.launchpad.net/1.0/~sileht"
        }
    ], 
    "closed": "2015-04-01 13:05:19.938042+00:00"
}