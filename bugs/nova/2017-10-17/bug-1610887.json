{
    "status": "Invalid", 
    "last_updated": "2016-08-11 14:32:13.812057+00:00", 
    "description": "I'm unable to launch instance using nova boot command.\nI'm running openstack liberty on Ubuntu Server 14 VMs on virtual box in a multi-node set-up. Following official docs for liberty on ubuntu.\nBelow are command and error details, nova-api.log and nova-compute.log lines and my nova.conf contenets.\n\nCommand and Error;\nroot@controller:~# nova boot --flavor m1.tiny --image cirros --nic net-id=aaa59963-a3b2-4c37-b691-5a0369b6ffde \\\n> --security-group default --key-name mykey vm1\nERROR (ClientException): Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'keystoneclient.exceptions.BadRequest'> (HTTP 500) (Request-ID: req-91af2d4b-8948-476e-b87a-00c34598dde7)\n\n\nError log in 'Nova-api.log' file;\n\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions     return self.request(url, 'POST', **kwargs)\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/dist-packages/keystoneclient/utils.py\", line 337, in inner\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/dist-packages/keystoneclient/session.py\", line 401, in request\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions     raise exceptions.from_response(resp, method, url)\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions BadRequest: Expecting to find username or userId in passwordCredentials - the server could not comply with the request since it is either malformed or otherwise incorrect. The client is assumed to be in error. (HTTP 400) (Request-ID: req-3265697b-246a-4596-8e35-348e4f36a671)\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions\n2016-08-08 12:30:41.291 4992 INFO nova.api.openstack.wsgi [req-91af2d4b-8948-476e-b87a-00c34598dde7 fd2b20887e9847bf80d84ee31e47aec9 61544fe6c61040cc98ba2c636cb0f889 - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'keystoneclient.exceptions.BadRequest'>\n2016-08-08 12:30:41.322 4992 INFO nova.osapi_compute.wsgi.server [req-91af2d4b-8948-476e-b87a-00c34598dde7 fd2b20887e9847bf80d84ee31e47aec9 61544fe6c61040cc98ba2c636cb0f889 - - -] 10.1.1.21 \"POST /v2/61544fe6c61040cc98ba2c636cb0f889/servers HTTP/1.1\" status: 500 len: 441 time: 2.0076089\n\n\nError in nova-compute.log on compute noce;\n2016-08-08 11:41:25.074 1581 ERROR oslo.messaging._drivers.impl_rabbit [req-cddbd2fb-f356-4d84-823b-a9703fc70751 - - - - -] AMQP server on controller:5672 is unreachable: timed out. Trying again in 2 seconds.\n\n\nBelow is my /etc/nova/nova.conf file on controller;\n[DEFAULT]\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlogdir=/var/log/nova\nstate_path=/var/lib/nova\nlock_path=/var/lock/nova\nforce_dhcp_release=True\nlibvirt_use_virtio_for_bridges=True\n#verbose=True\nec2_private_dns_show_ip=True\napi_paste_config=/etc/nova/api-paste.ini\n#enabled_apis=ec2,osapi_compute,metadata\n\nrpc_backend = rabbit\n\nauth_strategy = keystone\n\nmy_ip = <controller IP>\n\nnetwork_api_class = nova.network.neutronv2.api.API\nsecurity_group_api = neutron\nlinuxnet_interface_driver = nova.network.linux_net.NeutronLinuxBridgeInterfaceDriver\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\n\nenabled_apis=osapi_compute,metadata\n\nverbose = True\n\n[database]\nconnection = mysql+pymysql://nova:nova@controller/nova\n\n\n[oslo_messaging_rabbit]\nrabbit_host = controller\nrabbit_userid = openstack\nrabbit_password = <pwd>\n\n\n[keystone_authtoken]\nauth_uri = http://controller:5000\n#identity_url = http://controller:35357\nauth_host = controller\nauth_port = 35357\nauth_protocol = http\n#auth_plugin = password\nadmin_tenant_name = service\nadmin_user = nova\nadmin_password = <pwd>\n#auth_plugin = password\n#project_domain_id = default\n#user_domain_id = default\n#project_name = service\n#username = nova\n#password = nova\n\n[vnc]\nvncserver_listen = $my_ip\nvncserver_proxyclient_address = $my_ip\n\n[glance]\nhost = controller\n\n[oslo_concurrency]\nlock_path = /var/lib/nova/tmp\n\n[neutron]\n#identity_url = http://controller:35357\nurl = http://controller:9696\n#auth_strategy = keystone\nauth_host = controller\nauth_port = 35357\nauth_protocol = http\n#auth_plugin = password\n#project_domain_id = default\n#user_domain_id = default\nauth_region = RegionOne\nadmin_tenant_name = service\nadmin_user = neutron\nadmin_password = <pwd>\n#url = http://controller:9696\n\nservice_metadata_proxy = True\nmetadata_proxy_shared_secret = <METADATA_SECRET>", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1610887", 
    "owner": "None", 
    "id": 1610887, 
    "index": 7633, 
    "openned": "2016-08-08 08:23:49.337200+00:00", 
    "created": "2016-08-08 08:23:49.337200+00:00", 
    "title": "Error while launching instance. ERROR (ClientException): Unexpected API Error. ", 
    "comments": [
        {
            "content": "I'm unable to launch instance using nova boot command.\nI'm running openstack liberty on Ubuntu Server 14 VMs on virtual box in a multi-node set-up. Following official docs for liberty on ubuntu.\nBelow are command and error details, nova-api.log and nova-compute.log lines and my nova.conf contenets.\n\nCommand and Error;\nroot@controller:~# nova boot --flavor m1.tiny --image cirros --nic net-id=aaa59963-a3b2-4c37-b691-5a0369b6ffde \\\n> --security-group default --key-name mykey vm1\nERROR (ClientException): Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'keystoneclient.exceptions.BadRequest'> (HTTP 500) (Request-ID: req-91af2d4b-8948-476e-b87a-00c34598dde7)\n\n\nError log in 'Nova-api.log' file;\n\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions     return self.request(url, 'POST', **kwargs)\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/dist-packages/keystoneclient/utils.py\", line 337, in inner\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions     return func(*args, **kwargs)\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions   File \"/usr/lib/python2.7/dist-packages/keystoneclient/session.py\", line 401, in request\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions     raise exceptions.from_response(resp, method, url)\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions BadRequest: Expecting to find username or userId in passwordCredentials - the server could not comply with the request since it is either malformed or otherwise incorrect. The client is assumed to be in error. (HTTP 400) (Request-ID: req-3265697b-246a-4596-8e35-348e4f36a671)\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions\n2016-08-08 12:30:41.291 4992 INFO nova.api.openstack.wsgi [req-91af2d4b-8948-476e-b87a-00c34598dde7 fd2b20887e9847bf80d84ee31e47aec9 61544fe6c61040cc98ba2c636cb0f889 - - -] HTTP exception thrown: Unexpected API Error. Please report this at http://bugs.launchpad.net/nova/ and attach the Nova API log if possible.\n<class 'keystoneclient.exceptions.BadRequest'>\n2016-08-08 12:30:41.322 4992 INFO nova.osapi_compute.wsgi.server [req-91af2d4b-8948-476e-b87a-00c34598dde7 fd2b20887e9847bf80d84ee31e47aec9 61544fe6c61040cc98ba2c636cb0f889 - - -] 10.1.1.21 \"POST /v2/61544fe6c61040cc98ba2c636cb0f889/servers HTTP/1.1\" status: 500 len: 441 time: 2.0076089\n\n\nError in nova-compute.log on compute noce;\n2016-08-08 11:41:25.074 1581 ERROR oslo.messaging._drivers.impl_rabbit [req-cddbd2fb-f356-4d84-823b-a9703fc70751 - - - - -] AMQP server on controller:5672 is unreachable: timed out. Trying again in 2 seconds.\n\n\nBelow is my /etc/nova/nova.conf file on controller;\n[DEFAULT]\ndhcpbridge_flagfile=/etc/nova/nova.conf\ndhcpbridge=/usr/bin/nova-dhcpbridge\nlogdir=/var/log/nova\nstate_path=/var/lib/nova\nlock_path=/var/lock/nova\nforce_dhcp_release=True\nlibvirt_use_virtio_for_bridges=True\n#verbose=True\nec2_private_dns_show_ip=True\napi_paste_config=/etc/nova/api-paste.ini\n#enabled_apis=ec2,osapi_compute,metadata\n\nrpc_backend = rabbit\n\nauth_strategy = keystone\n\nmy_ip = <controller IP>\n\nnetwork_api_class = nova.network.neutronv2.api.API\nsecurity_group_api = neutron\nlinuxnet_interface_driver = nova.network.linux_net.NeutronLinuxBridgeInterfaceDriver\nfirewall_driver = nova.virt.firewall.NoopFirewallDriver\n\nenabled_apis=osapi_compute,metadata\n\nverbose = True\n\n[database]\nconnection = mysql+pymysql://nova:nova@controller/nova\n\n\n[oslo_messaging_rabbit]\nrabbit_host = controller\nrabbit_userid = openstack\nrabbit_password = <pwd>\n\n\n[keystone_authtoken]\nauth_uri = http://controller:5000\n#identity_url = http://controller:35357\nauth_host = controller\nauth_port = 35357\nauth_protocol = http\n#auth_plugin = password\nadmin_tenant_name = service\nadmin_user = nova\nadmin_password = <pwd>\n#auth_plugin = password\n#project_domain_id = default\n#user_domain_id = default\n#project_name = service\n#username = nova\n#password = nova\n\n[vnc]\nvncserver_listen = $my_ip\nvncserver_proxyclient_address = $my_ip\n\n[glance]\nhost = controller\n\n[oslo_concurrency]\nlock_path = /var/lib/nova/tmp\n\n[neutron]\n#identity_url = http://controller:35357\nurl = http://controller:9696\n#auth_strategy = keystone\nauth_host = controller\nauth_port = 35357\nauth_protocol = http\n#auth_plugin = password\n#project_domain_id = default\n#user_domain_id = default\nauth_region = RegionOne\nadmin_tenant_name = service\nadmin_user = neutron\nadmin_password = <pwd>\n#url = http://controller:9696\n\nservice_metadata_proxy = True\nmetadata_proxy_shared_secret = <METADATA_SECRET>", 
            "date_created": "2016-08-08 08:23:49.337200+00:00", 
            "author": "https://api.launchpad.net/1.0/~sameerlowlekar"
        }, 
        {
            "content": "seems your nova has some issue in communicating with keystone\n\n2016-08-08 12:30:41.195 4992 ERROR nova.api.openstack.extensions BadRequest: Expecting to find username or userId in passwordCredentials - the server could not comply with the request since it is either malformed or otherwise incorrect. The client is assumed to be in error. (HTTP 400) (Request-ID: req-3265697b-246a-4596-8e35-348e4f36a671)\n\nIMHO it's a internal error as openstack component has issue in communicating with each other\nguess you need fix it first (also compute logs shows you have issue in connect to amqp as well)\n\nthis is what I used not sure it's helpful \n\n[keystone_authtoken]\nauth_plugin = v3password\nauth_url = https://9.60.29.98:5000/v3\nusername = nova\nproject_name = service\nuser_domain_id = default\nproject_domain_id = default\ncafile = /data/PKIcerts/certs/cacert.pem\npassword = xxxx\n", 
            "date_created": "2016-08-08 15:11:12.644240+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }, 
        {
            "content": "Appreciate your response jichenjc.\nRegarding error on compute log; sorry if my questions are na\u00efve.\n\nShould my compute node also have rabbitmq installed?\nI can see on controller this command ; (lsof -i :5672|grep 'compute_node_ip') shows connection established with compute\n\nTime sync check. Can you please let me know chrony.conf details to verify on compute node, mine has details as below\nserver 0.debian.pool.ntp.org iburst\nserver 1.debian.pool.ntp.org iburst\nserver 2.debian.pool.ntp.org iburst\nserver 3.debian.pool.ntp.org iburst\n\nAlso, my nova service-list commands shows all running i.e. nova compute running fine on compute node.\n\nCan see following error on neutron-server.log as well; same as what i can see in my compute log\n\n2016-08-09 10:02:20.936 1136 ERROR oslo.messaging._drivers.impl_rabbit [req-a9f471d1-37d0-450d-99f6-1e71fd9b1c46 - - - - -] AMQP server on controller:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 2 seconds.\n2016-08-09 10:02:22.979 1136 ERROR oslo.messaging._drivers.impl_rabbit [req-a9f471d1-37d0-450d-99f6-1e71fd9b1c46 - - - - -] AMQP server on controller:5672 is unreachable: [Errno 111] ECONNREFUSED. Trying again in 2 seconds.\n\nAppreciate any inputs that can help me resolve issue.\n", 
            "date_created": "2016-08-09 08:31:33.310765+00:00", 
            "author": "https://api.launchpad.net/1.0/~sameerlowlekar"
        }, 
        {
            "content": "Unfortunately we don't have the capacity to resolve support requests here.\nThe issue you describe is most probably a configuration issue where Nova\ncannot communicate/authenticate with Keystone. The manuals [1] should give you\nenough information how to solve this. There is also a mailing list [2] where\nOpenStack users help each other and there's also a forum [3].\n\nReferences:\n[1] http://docs.openstack.org/liberty/install-guide-ubuntu/nova-controller-install.html#install-and-configure-components\n[2] https://wiki.openstack.org/wiki/Mailing_Lists#General_List\n[3] https://ask.openstack.org/", 
            "date_created": "2016-08-09 13:02:16.483938+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "yes, I think it's currently out of nova scope and need refer to general info before developer jump in", 
            "date_created": "2016-08-09 13:21:17.625894+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }, 
        {
            "content": "Yeah, this seems basic deployment issue and we need to avoid digging into this kind of issue before getting enough information.\n\nI am feeling current requirement of bug report seems a little overkill and hard burden for developers of Nova. It is nice to have some basic deployment checking tool and ask it to run on envs before reporting.", 
            "date_created": "2016-08-10 23:14:36.290943+00:00", 
            "author": "https://api.launchpad.net/1.0/~oomichi"
        }, 
        {
            "content": "Thanks for all your comments.\nI've posted this query now on https://ask.openstack.org/ \nHoping for responses there.", 
            "date_created": "2016-08-11 14:32:13.157267+00:00", 
            "author": "https://api.launchpad.net/1.0/~sameerlowlekar"
        }
    ], 
    "closed": "2016-08-09 13:02:23.893538+00:00"
}