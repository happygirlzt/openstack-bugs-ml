{
    "status": "In Progress", 
    "last_updated": "2017-08-01 10:02:40.884547+00:00", 
    "description": "Openstack version:\nFrom git.\nstack@devstack1-hp:~/nova$ git log -n 3\ncommit 996c2f6f0543fa40fe34ca940bd56d8fd3f2e0f7\nMerge: 4cf44ea e55d335\nAuthor: Jenkins <email address hidden>\nDate:   Fri Nov 27 19:34:45 2015 +0000\n\n    Merge \"NFS setup for live-migration job\"\n\nTest steps:\n1. Create an encrypted volume in Cinder.\n2. Attach it to an VM.\n3. Migrate the volume to another backend storage.\n\nExpected result:\nMigration succeeds.\n\nActual result:\nFailed to rebase the device. \n\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    self.volume_api.unreserve_volume(context, new_volume_id)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 197, in __exit__\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    six.reraise(self.type_, self.value, self.tb)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 4797, in _swap_volume\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    resize_to)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1209, in swap_volume\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    self._disconnect_volume(old_connection_info, disk_dev)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1068, in _disconnect_volume\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    driver.disconnect_volume(connection_info, disk_dev)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/nova/nova/virt/libvirt/volume/iscsi.py\", line 93, in disconnect_volume\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    self.connector.disconnect_volume(connection_info['data'], None)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 254, in inner\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    return f(*args, **kwargs)\n\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 254, in inner\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    return f(*args, **kwargs)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/os-brick/os_brick/initiator/connector.py\", line 743, in disconnect_volume\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    self._disconnect_volume_iscsi(props)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/os-brick/os_brick/initiator/connector.py\", line 764, in _disconnect_volume_iscsi\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    self._linuxscsi.wait_for_volume_removal(host_device)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/os-brick/os_brick/utils.py\", line 54, in _wrapper\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    return r.call(f, *args, **kwargs)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/retrying.py\", line 212, in call\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    raise attempt.get()\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/retrying.py\", line 247, in get\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    six.reraise(self.value[0], self.value[1], self.value[2])\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/retrying.py\", line 200, in call\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    attempt = Attempt(fn(*args, **kwargs), attempt_number, False)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/os-brick/os_brick/initiator/linuxscsi.py\", line 82, in wait_for_volume_removal\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    volume_path=volume_path)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00mVolumePathNotRemoved: Volume path /dev/disk/by-path/ip-10.0.2.15:3260-iscsi-iqn.2010-10.org.openstack:volume-f6dcb40c-0477-43a9-8a58-4dd27deb0580-lun-1 was not removed in time.\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m\n\nAnalysis:\nAs this is a encrypted volume, it needs to detach encryptors.", 
    "tags": [
        "encryption", 
        "migration", 
        "volumes"
    ], 
    "importance": "High", 
    "heat": 8, 
    "link": "https://bugs.launchpad.net/nova/+bug/1522233", 
    "owner": "https://api.launchpad.net/1.0/~lisali", 
    "id": 1522233, 
    "index": 1846, 
    "openned": "2015-12-03 03:00:56.693401+00:00", 
    "created": "2015-12-03 03:00:56.693401+00:00", 
    "title": "Failed to migrate encrypted volume", 
    "comments": [
        {
            "content": "Openstack version:\nFrom git.\nstack@devstack1-hp:~/nova$ git log -n 3\ncommit 996c2f6f0543fa40fe34ca940bd56d8fd3f2e0f7\nMerge: 4cf44ea e55d335\nAuthor: Jenkins <email address hidden>\nDate:   Fri Nov 27 19:34:45 2015 +0000\n\n    Merge \"NFS setup for live-migration job\"\n\nTest steps:\n1. Create an encrypted volume in Cinder.\n2. Attach it to an VM.\n3. Migrate the volume to another backend storage.\n\nExpected result:\nMigration succeeds.\n\nActual result:\nFailed to rebase the device. \n\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    self.volume_api.unreserve_volume(context, new_volume_id)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 197, in __exit__\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    six.reraise(self.type_, self.value, self.tb)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 4797, in _swap_volume\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    resize_to)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1209, in swap_volume\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    self._disconnect_volume(old_connection_info, disk_dev)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/nova/nova/virt/libvirt/driver.py\", line 1068, in _disconnect_volume\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    driver.disconnect_volume(connection_info, disk_dev)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/nova/nova/virt/libvirt/volume/iscsi.py\", line 93, in disconnect_volume\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    self.connector.disconnect_volume(connection_info['data'], None)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 254, in inner\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    return f(*args, **kwargs)\n\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py\", line 254, in inner\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    return f(*args, **kwargs)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/os-brick/os_brick/initiator/connector.py\", line 743, in disconnect_volume\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    self._disconnect_volume_iscsi(props)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/os-brick/os_brick/initiator/connector.py\", line 764, in _disconnect_volume_iscsi\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    self._linuxscsi.wait_for_volume_removal(host_device)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/os-brick/os_brick/utils.py\", line 54, in _wrapper\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    return r.call(f, *args, **kwargs)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/retrying.py\", line 212, in call\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    raise attempt.get()\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/retrying.py\", line 247, in get\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    six.reraise(self.value[0], self.value[1], self.value[2])\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/usr/local/lib/python2.7/dist-packages/retrying.py\", line 200, in call\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    attempt = Attempt(fn(*args, **kwargs), attempt_number, False)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m  File \"/opt/stack/os-brick/os_brick/initiator/linuxscsi.py\", line 82, in wait_for_volume_removal\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m    volume_path=volume_path)\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00mVolumePathNotRemoved: Volume path /dev/disk/by-path/ip-10.0.2.15:3260-iscsi-iqn.2010-10.org.openstack:volume-f6dcb40c-0477-43a9-8a58-4dd27deb0580-lun-1 was not removed in time.\n^[[01;31m2015-12-03 02:30:30.155 TRACE oslo_messaging.rpc.dispatcher ^[[01;35m^[[00m\n\nAnalysis:\nAs this is a encrypted volume, it needs to detach encryptors.", 
            "date_created": "2015-12-03 03:00:56.693401+00:00", 
            "author": "https://api.launchpad.net/1.0/~lisali"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/252809", 
            "date_created": "2015-12-03 08:05:43.031738+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Volume migration to another backend is not related to nova's live migration functionality", 
            "date_created": "2016-01-20 20:23:50.427653+00:00", 
            "author": "https://api.launchpad.net/1.0/~pawel-koniszewski"
        }, 
        {
            "content": "Change abandoned by Sean Dague (<email address hidden>) on branch: master\nReview: https://review.openstack.org/252809\nReason: This review is > 4 weeks without comment, and is not mergable in it's current state. We are abandoning this for now. Feel free to reactivate the review by pressing the restore button and leaving a 'recheck' comment to get fresh test results.", 
            "date_created": "2017-08-01 10:02:40.351647+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ]
}