{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 12:08:06.463614+00:00", 
    "description": "http://logs.openstack.org/19/46219/6/check/gate-tempest-devstack-vm-postgres-full/f2a8775/logs/screen-n-api.txt.gz#_2013-09-17_19_17_28_163\n\n2013-09-17 19:17:28.163 ERROR nova.api.openstack [req-8a9da02a-d0dd-4122-9387-3c353c1f61f9 AvailabilityZoneAdminTestJSON420684138-user AvailabilityZoneAdminTestJSON328161858-tenant] Caught error: 'nova'\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack Traceback (most recent call last):\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/__init__.py\", line 119, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return req.get_response(self.application)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1296, in send\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     application, catch_exc_info=False)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1260, in call_application\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 545, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return self.app(env, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 912, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     content_type, body, accept)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 971, in _process_stack\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 1052, in dispatch\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return method(req=request, **action_args)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/compute/contrib/availability_zone.py\", line 158, in detail\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return self._describe_availability_zones_verbose(context)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/compute/contrib/availability_zone.py\", line 127, in _describe_availability_zones_verbose\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     for host in zone_hosts[zone]:\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack KeyError: 'nova'\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack \n2013-09-17 19:17:28.166 INFO nova.api.openstack [req-8a9da02a-d0dd-4122-9387-3c353c1f61f9 AvailabilityZoneAdminTestJSON420684138-user AvailabilityZoneAdminTestJSON328161858-tenant] http://127.0.0.1:8774/v2/401a55fcac9346e9a4651fa4998cf37e/os-availability-zone/detail returned with HTTP 500\n2013-09-17 19:17:28.166 DEBUG nova.api.openstack.wsgi [req-8a9da02a-d0dd-4122-9387-3c353c1f61f9 AvailabilityZoneAdminTestJSON420684138-user AvailabilityZoneAdminTestJSON328161858-tenant] Returning 500 to user: The server has either erred or is incapable of performing the requested operation. __call__ /opt/stack/new/nova/nova/api/openstack/wsgi.py:1198\n2013-09-17 19:17:28.171 INFO nova.osapi_compute.wsgi.server [req-8a9da02a-d0dd-4122-9387-3c353c1f61f9 AvailabilityZoneAdminTestJSON420684138-user AvailabilityZoneAdminTestJSON328161858-tenant] 127.0.0.1 \"GET /v2/401a55fcac9346e9a4651fa4998cf37e/os-availability-zone/detail HTTP/1.1\" status: 500 len: 354 time: 0.0626421\n\n2013-09-17 19:17:28.190 INFO nova.osapi_compute.wsgi.server [req-65257847-14d1-436b-a8c4-8f549c2237e3 FlavorsAdminTestXML1399969679-user FlavorsAdminTestXML1439560052-tenant] 127.0.0.1 \"DELETE /v2/23b96b3d3887414e98826e0076812b6c/flavors/1365744031 HTTP/1.1\" status: 202 len: 204 time: 0.0436058\n\n\nFrom http://logs.openstack.org/19/46219/6/check/gate-tempest-devstack-vm-postgres-full/f2a8775/testr_results.html.gz", 
    "tags": [], 
    "importance": "High", 
    "heat": 22, 
    "link": "https://bugs.launchpad.net/nova/+bug/1226791", 
    "owner": "https://api.launchpad.net/1.0/~dims-v", 
    "id": 1226791, 
    "index": 1235, 
    "openned": "2013-09-17 19:56:13.844609+00:00", 
    "created": "2013-09-17 19:56:13.844609+00:00", 
    "title": "GET os-availability-zone/detail  returns  500", 
    "comments": [
        {
            "content": "http://logs.openstack.org/19/46219/6/check/gate-tempest-devstack-vm-postgres-full/f2a8775/logs/screen-n-api.txt.gz#_2013-09-17_19_17_28_163\n\n2013-09-17 19:17:28.163 ERROR nova.api.openstack [req-8a9da02a-d0dd-4122-9387-3c353c1f61f9 AvailabilityZoneAdminTestJSON420684138-user AvailabilityZoneAdminTestJSON328161858-tenant] Caught error: 'nova'\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack Traceback (most recent call last):\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/__init__.py\", line 119, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return req.get_response(self.application)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1296, in send\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     application, catch_exc_info=False)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1260, in call_application\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/python-keystoneclient/keystoneclient/middleware/auth_token.py\", line 545, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return self.app(env, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 912, in __call__\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     content_type, body, accept)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 971, in _process_stack\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/wsgi.py\", line 1052, in dispatch\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return method(req=request, **action_args)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/compute/contrib/availability_zone.py\", line 158, in detail\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     return self._describe_availability_zones_verbose(context)\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack   File \"/opt/stack/new/nova/nova/api/openstack/compute/contrib/availability_zone.py\", line 127, in _describe_availability_zones_verbose\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack     for host in zone_hosts[zone]:\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack KeyError: 'nova'\n2013-09-17 19:17:28.163 20963 TRACE nova.api.openstack \n2013-09-17 19:17:28.166 INFO nova.api.openstack [req-8a9da02a-d0dd-4122-9387-3c353c1f61f9 AvailabilityZoneAdminTestJSON420684138-user AvailabilityZoneAdminTestJSON328161858-tenant] http://127.0.0.1:8774/v2/401a55fcac9346e9a4651fa4998cf37e/os-availability-zone/detail returned with HTTP 500\n2013-09-17 19:17:28.166 DEBUG nova.api.openstack.wsgi [req-8a9da02a-d0dd-4122-9387-3c353c1f61f9 AvailabilityZoneAdminTestJSON420684138-user AvailabilityZoneAdminTestJSON328161858-tenant] Returning 500 to user: The server has either erred or is incapable of performing the requested operation. __call__ /opt/stack/new/nova/nova/api/openstack/wsgi.py:1198\n2013-09-17 19:17:28.171 INFO nova.osapi_compute.wsgi.server [req-8a9da02a-d0dd-4122-9387-3c353c1f61f9 AvailabilityZoneAdminTestJSON420684138-user AvailabilityZoneAdminTestJSON328161858-tenant] 127.0.0.1 \"GET /v2/401a55fcac9346e9a4651fa4998cf37e/os-availability-zone/detail HTTP/1.1\" status: 500 len: 354 time: 0.0626421\n\n2013-09-17 19:17:28.190 INFO nova.osapi_compute.wsgi.server [req-65257847-14d1-436b-a8c4-8f549c2237e3 FlavorsAdminTestXML1399969679-user FlavorsAdminTestXML1439560052-tenant] 127.0.0.1 \"DELETE /v2/23b96b3d3887414e98826e0076812b6c/flavors/1365744031 HTTP/1.1\" status: 202 len: 204 time: 0.0436058\n\n\nFrom http://logs.openstack.org/19/46219/6/check/gate-tempest-devstack-vm-postgres-full/f2a8775/testr_results.html.gz", 
            "date_created": "2013-09-17 19:56:13.844609+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "logstash query: \"KeyError: 'nova'\" AND @fields.filename:\"logs/screen-n-api.txt\" AND @fields.build_status:\"FAILURE\" AND \"_describe_availability_zones_verbose\"", 
            "date_created": "2013-09-17 19:58:29.218061+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "Marking as critical since we are seeing this as a transient failure in tempest runs.", 
            "date_created": "2013-09-18 17:33:12.278596+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/47250", 
            "date_created": "2013-09-18 20:50:07.127292+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/47250\nCommitted: http://github.com/openstack/nova/commit/d1d1515a610bee2c78e8275b63b09a0301dd9206\nSubmitter: Jenkins\nBranch:    master\n\ncommit d1d1515a610bee2c78e8275b63b09a0301dd9206\nAuthor: Davanum Srinivas <email address hidden>\nDate:   Wed Sep 18 16:46:35 2013 -0400\n\n    Fix for os-availability-zone/detail returning 500\n    \n    if there are no enabled_services, then zone_hosts is very likely\n    to be empty, which means zone_hosts['nova'] will fail. So let's\n    use get with a default of empty array to cover this case. Added\n    a fix/test for v3 API as well.\n    \n    Fixes LP# 1226791\n    \n    Change-Id: I602c96242291fd9a4bdf67af6445aa935ec7f7e3\n", 
            "date_created": "2013-09-20 18:33:20.329653+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-10-03 07:48:59.603795+00:00"
}