{
    "status": "Fix Released", 
    "last_updated": "2014-10-16 08:31:43.115963+00:00", 
    "description": "When an nova.objects.fields:IPAddress or subclass is passed to a fixed_ip object associate method the following traceback occurs:\n\n\nTraceback (most recent call last):\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/eventlet/queue.py\", line 107, in switch\n    self.greenlet.switch(value)\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/eventlet/greenthread.py\", line 194, in main\n    result = function(*args, **kwargs)\n  File \"/home/alaski/dev/nova/nova/compute/manager.py\", line 1547, in _allocate_network_async\n    dhcp_options=dhcp_options)\n  File \"/home/alaski/dev/nova/nova/network/api.py\", line 46, in wrapped\n    return func(self, context, *args, **kwargs)\n  File \"/home/alaski/dev/nova/nova/network/base_api.py\", line 59, in wrapper\n    res = f(self, context, *args, **kwargs)\n  File \"/home/alaski/dev/nova/nova/network/api.py\", line 253, in allocate_for_instance\n    nw_info = self.network_rpcapi.allocate_for_instance(context, **args)\n  File \"/home/alaski/dev/nova/nova/network/rpcapi.py\", line 175, in allocate_for_instance\n    macs=jsonutils.to_primitive(macs))\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/oslo/messaging/rpc/client.py\", line 150, in call\n    wait_for_reply=True, timeout=timeout)\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/oslo/messaging/transport.py\", line 87, in _send\n    timeout=timeout)\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_fake.py\", line 146, in send\n    return self._send(target, ctxt, message, wait_for_reply, timeout)\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_fake.py\", line 136, in _send\n    raise failure\nInterfaceError: (InterfaceError) Error binding parameter 2 - probably unsupported type. u'SELECT fixed_ips.created_at AS fixed_ips_created_at, fixed_ips.updated_at AS fixed_ips_updated_at, fixed_ips.deleted_at AS fixed_ips_deleted_at, fixed_ips.deleted AS fixed_ips_deleted, fixed_ips.id AS fixed_ips_id, fixed_ips.address AS fixed_ips_address, fixed_ips.network_id AS fixed_ips_network_id, fixed_ips.virtual_interface_id AS fixed_ips_virtual_interface_id, fixed_ips.instance_uuid AS fixed_ips_instance_uuid, fixed_ips.allocated AS fixed_ips_allocated, fixed_ips.leased AS fixed_ips_leased, fixed_ips.reserved AS fixed_ips_reserved, fixed_ips.host AS fixed_ips_host \\nFROM fixed_ips \\nWHERE fixed_ips.deleted = ? AND (fixed_ips.network_id = ? OR fixed_ips.network_id IS NULL) AND fixed_ips.reserved = 1 AND fixed_ips.address = ?\\n LIMIT ? OFFSET ?' (0, 1, IPAddress('10.0.0.2'), 1, 0)", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1317668", 
    "owner": "https://api.launchpad.net/1.0/~alaski", 
    "id": 1317668, 
    "index": 6104, 
    "openned": "2014-05-08 21:30:27.174526+00:00", 
    "created": "2014-05-08 21:30:27.174526+00:00", 
    "title": "fixed_ip object associate method doesn't handle an IPAddress object field", 
    "comments": [
        {
            "content": "When an nova.objects.fields:IPAddress or subclass is passed to a fixed_ip object associate method the following traceback occurs:\n\n\nTraceback (most recent call last):\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/eventlet/queue.py\", line 107, in switch\n    self.greenlet.switch(value)\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/eventlet/greenthread.py\", line 194, in main\n    result = function(*args, **kwargs)\n  File \"/home/alaski/dev/nova/nova/compute/manager.py\", line 1547, in _allocate_network_async\n    dhcp_options=dhcp_options)\n  File \"/home/alaski/dev/nova/nova/network/api.py\", line 46, in wrapped\n    return func(self, context, *args, **kwargs)\n  File \"/home/alaski/dev/nova/nova/network/base_api.py\", line 59, in wrapper\n    res = f(self, context, *args, **kwargs)\n  File \"/home/alaski/dev/nova/nova/network/api.py\", line 253, in allocate_for_instance\n    nw_info = self.network_rpcapi.allocate_for_instance(context, **args)\n  File \"/home/alaski/dev/nova/nova/network/rpcapi.py\", line 175, in allocate_for_instance\n    macs=jsonutils.to_primitive(macs))\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/oslo/messaging/rpc/client.py\", line 150, in call\n    wait_for_reply=True, timeout=timeout)\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/oslo/messaging/transport.py\", line 87, in _send\n    timeout=timeout)\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_fake.py\", line 146, in send\n    return self._send(target, ctxt, message, wait_for_reply, timeout)\n  File \"/home/alaski/dev/nova/.tox/py27/local/lib/python2.7/site-packages/oslo/messaging/_drivers/impl_fake.py\", line 136, in _send\n    raise failure\nInterfaceError: (InterfaceError) Error binding parameter 2 - probably unsupported type. u'SELECT fixed_ips.created_at AS fixed_ips_created_at, fixed_ips.updated_at AS fixed_ips_updated_at, fixed_ips.deleted_at AS fixed_ips_deleted_at, fixed_ips.deleted AS fixed_ips_deleted, fixed_ips.id AS fixed_ips_id, fixed_ips.address AS fixed_ips_address, fixed_ips.network_id AS fixed_ips_network_id, fixed_ips.virtual_interface_id AS fixed_ips_virtual_interface_id, fixed_ips.instance_uuid AS fixed_ips_instance_uuid, fixed_ips.allocated AS fixed_ips_allocated, fixed_ips.leased AS fixed_ips_leased, fixed_ips.reserved AS fixed_ips_reserved, fixed_ips.host AS fixed_ips_host \\nFROM fixed_ips \\nWHERE fixed_ips.deleted = ? AND (fixed_ips.network_id = ? OR fixed_ips.network_id IS NULL) AND fixed_ips.reserved = 1 AND fixed_ips.address = ?\\n LIMIT ? OFFSET ?' (0, 1, IPAddress('10.0.0.2'), 1, 0)", 
            "date_created": "2014-05-08 21:30:27.174526+00:00", 
            "author": "https://api.launchpad.net/1.0/~alaski"
        }, 
        {
            "content": "I should add that this is triggered when allocate_fixed_ip in network manager is called with a vpn network.  This occurs during the CloudPipe api samples tests but isn't triggered until after the instance is created so the error is silently ignored.", 
            "date_created": "2014-05-08 21:33:33.221787+00:00", 
            "author": "https://api.launchpad.net/1.0/~alaski"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/92927\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=5268c1136ed09346d13b28b42626c0b302e3abb2\nSubmitter: Jenkins\nBranch:    master\n\ncommit 5268c1136ed09346d13b28b42626c0b302e3abb2\nAuthor: Andrew Laski <email address hidden>\nDate:   Thu May 8 18:27:05 2014 -0400\n\n    Convert address to str in fixed_ip_obj.associate\n    \n    A caller of associate may pass in a netaddr.IPAddress argument which\n    will currently fail when it gets to sqlalchemy.  Following the\n    convention of other methods the netaddr.IPAddress will be cast to a\n    string.\n    \n    Change-Id: I67c1876b447217b37104660ba87ed967f477b863\n    Closes-bug: 1317668\n", 
            "date_created": "2014-05-17 23:01:54.395473+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2014-06-11 13:48:58.394257+00:00"
}