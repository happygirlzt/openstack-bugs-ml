{
    "status": "Fix Released", 
    "last_updated": "2017-05-30 19:07:15.400323+00:00", 
    "description": "This results in failures in inject_data from nova/virt/disk/api.py\neven if no real data is injected:\n\n2017-03-03 15:11:55.707 48683 ERROR nova.virt.libvirt.driver [req-f6f3df11-35b0-44c2-a1c4-52548504a1b5 fd33deabe809466a8dcd517bdf882e6b e4046b10f1074f06bd5d474ddfce09bc - - -] [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5] Error injecting data into image 082f0243-cd99-4312-a27a-86b8cd3688d2 ()\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [req-f6f3df11-35b0-44c2-a1c4-52548504a1b5 fd33deabe809466a8dcd517bdf882e6b e4046b10f1074f06bd5d474ddfce09bc - - -] [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5] Instance failed to spawn\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5] Traceback (most recent call last):\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2078, in _build_resources\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     yield resources\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 1920, in _build_and_run_instance\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     block_device_info=block_device_info)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2624, in spawn\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     admin_pass=admin_password)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 3028, in _create_image\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     fallback_from_host)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 3137, in _create_and_inject_local_root\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     files)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2977, in _inject_data\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     instance=instance)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     self.force_reraise()\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     six.reraise(self.type_, self.value, self.tb)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2968, in _inject_data\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     disk_api.inject_data(injection_image.get_model(self._conn),\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/imagebackend.py\", line 395, in get_model\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     raise NotImplementedError()\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5] NotImplementedError\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]\n\nlibvirt.virt_type              = parallels\nlibvirt.images_type            = ploop\nlibvirt.inject_partition       = -1", 
    "tags": [
        "libvirt", 
        "parallels"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1670642", 
    "owner": "https://api.launchpad.net/1.0/~eantyshev", 
    "id": 1670642, 
    "index": 4773, 
    "openned": "2017-03-07 11:03:13.922310+00:00", 
    "created": "2017-03-07 11:03:13.922310+00:00", 
    "title": "get_model method missing for Ploop image", 
    "comments": [
        {
            "content": "This results in failures in inject_data from nova/virt/disk/api.py\neven if no real data is injected:\n\n2017-03-03 15:11:55.707 48683 ERROR nova.virt.libvirt.driver [req-f6f3df11-35b0-44c2-a1c4-52548504a1b5 fd33deabe809466a8dcd517bdf882e6b e4046b10f1074f06bd5d474ddfce09bc - - -] [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5] Error injecting data into image 082f0243-cd99-4312-a27a-86b8cd3688d2 ()\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [req-f6f3df11-35b0-44c2-a1c4-52548504a1b5 fd33deabe809466a8dcd517bdf882e6b e4046b10f1074f06bd5d474ddfce09bc - - -] [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5] Instance failed to spawn\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5] Traceback (most recent call last):\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2078, in _build_resources\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     yield resources\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 1920, in _build_and_run_instance\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     block_device_info=block_device_info)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2624, in spawn\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     admin_pass=admin_password)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 3028, in _create_image\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     fallback_from_host)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 3137, in _create_and_inject_local_root\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     files)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2977, in _inject_data\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     instance=instance)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     self.force_reraise()\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     six.reraise(self.type_, self.value, self.tb)\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2968, in _inject_data\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     disk_api.inject_data(injection_image.get_model(self._conn),\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/imagebackend.py\", line 395, in get_model\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]     raise NotImplementedError()\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5] NotImplementedError\n2017-03-03 15:11:55.708 48683 ERROR nova.compute.manager [instance: 99aaeae0-e611-424e-bbd6-8d83ef37caf5]\n\nlibvirt.virt_type              = parallels\nlibvirt.images_type            = ploop\nlibvirt.inject_partition       = -1", 
            "date_created": "2017-03-07 11:03:13.922310+00:00", 
            "author": "https://api.launchpad.net/1.0/~eantyshev"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/441989\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=d629d4e42c04756444a79e9ac15f3f2192c47b52\nSubmitter: Jenkins\nBranch:    master\n\ncommit d629d4e42c04756444a79e9ac15f3f2192c47b52\nAuthor: Evgeny Antyshev <email address hidden>\nDate:   Mon Mar 6 14:27:06 2017 +0000\n\n    get_model method missing for Ploop image\n    \n    Image.get_model is called in partition injection code,\n    and now inject partition attempt fails unconditionally.\n    This patch makes use of disk/api.py inject_data failure tolerance:\n    it doesn't fail unless injected data is mandatory.\n    \n    Closes-Bug: 1670642\n    Change-Id: I6c68693be818219f78d6fcda019b867066396b29\n", 
            "date_created": "2017-03-20 13:33:45.467554+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/ocata\nReview: https://review.openstack.org/447626", 
            "date_created": "2017-03-20 17:59:25.270134+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/447626\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=914aa032f2031625512e1bcebf312fe9fff4d3fa\nSubmitter: Jenkins\nBranch:    stable/ocata\n\ncommit 914aa032f2031625512e1bcebf312fe9fff4d3fa\nAuthor: Evgeny Antyshev <email address hidden>\nDate:   Mon Mar 6 14:27:06 2017 +0000\n\n    get_model method missing for Ploop image\n    \n    Image.get_model is called in partition injection code,\n    and now inject partition attempt fails unconditionally.\n    This patch makes use of disk/api.py inject_data failure tolerance:\n    it doesn't fail unless injected data is mandatory.\n    \n    Closes-Bug: 1670642\n    Change-Id: I6c68693be818219f78d6fcda019b867066396b29\n    (cherry picked from commit d629d4e42c04756444a79e9ac15f3f2192c47b52)\n", 
            "date_created": "2017-03-21 06:34:41.648873+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/448142", 
            "date_created": "2017-03-21 14:59:43.887971+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 15.0.2 release.", 
            "date_created": "2017-03-22 10:15:10.686829+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 16.0.0.0b1 development milestone.", 
            "date_created": "2017-04-14 09:23:16.840701+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/448142\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=e289fe9eb66a4984c7bb9dc72f5aff83003fe390\nSubmitter: Jenkins\nBranch:    master\n\ncommit e289fe9eb66a4984c7bb9dc72f5aff83003fe390\nAuthor: Matt Riedemann <email address hidden>\nDate:   Tue Mar 21 10:57:35 2017 -0400\n\n    libvirt: mark some Image backend methods as abstract\n    \n    Change I6c68693be818219f78d6fcda019b867066396b29 shows us\n    that we should be marking Image methods as abstract if they\n    actually are required to be implemented by a subclass. Since\n    the Image class itself is an ABC, let's take advantage and\n    mark some of the other required methods in the base class\n    as abstract methods so we don't hit this same issue again with\n    a new backend.\n    \n    Change-Id: Id5129e48d1ec3b23b552b066916a968c02953988\n    Related-Bug: #1670642\n", 
            "date_created": "2017-05-30 19:07:14.717306+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2017-03-20 13:33:43.466896+00:00"
}