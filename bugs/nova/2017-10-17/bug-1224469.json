{
    "status": "Fix Released", 
    "last_updated": "2014-04-17 09:14:58.550644+00:00", 
    "description": "When attempting to boot an instance with a block device with source=image,dest=volume and there is no volume size specified - nova compute will error out:\n\n[ndipanov@localhost devstack]$ nova boot --flavor 1 --block-device bootindex=0,source=image,dest=volume,id=42ccba7f-914b-4e3d-8387-b7b30d96a7a5,type=cdrom,bus=ide testimgvol\n\nin nova compute logs:\n\nERROR nova.compute.manager [req-a7200578-8bf4-4791-a5bf-449c473d41b6 demo demo] [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d] Error: Invalid input received: Invalid input received: Volume size None must be an integer and greater than 0\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d] Traceback (most recent call last):\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1038, in _build_instance\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     context, instance, bdms)\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1403, in _prep_block_device\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     instance=instance)\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1386, in _prep_block_device\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     self._await_block_device_map_created))\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/virt/block_device.py\", line 283, in attach_block_devices\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     block_device_mapping)\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/virt/block_device.py\", line 236, in attach\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     '', '', image_id=self.image_id)\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/volume/cinder.py\", line 309, in create\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     raise exception.InvalidInput(reason=e.message)\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d] InvalidInput: Invalid input received: Invalid input received: Volume size None must be an integer and greater than 0\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d] \n\nWe should disallow empty or default the volume size if not specified.", 
    "tags": [
        "volumes"
    ], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1224469", 
    "owner": "https://api.launchpad.net/1.0/~ndipanov", 
    "id": 1224469, 
    "index": 3583, 
    "openned": "2013-09-12 13:11:12.421926+00:00", 
    "created": "2013-09-12 13:11:12.421926+00:00", 
    "title": "if volume size is None for image bdms nova compute throws an exception", 
    "comments": [
        {
            "content": "When attempting to boot an instance with a block device with source=image,dest=volume and there is no volume size specified - nova compute will error out:\n\n[ndipanov@localhost devstack]$ nova boot --flavor 1 --block-device bootindex=0,source=image,dest=volume,id=42ccba7f-914b-4e3d-8387-b7b30d96a7a5,type=cdrom,bus=ide testimgvol\n\nin nova compute logs:\n\nERROR nova.compute.manager [req-a7200578-8bf4-4791-a5bf-449c473d41b6 demo demo] [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d] Error: Invalid input received: Invalid input received: Volume size None must be an integer and greater than 0\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d] Traceback (most recent call last):\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1038, in _build_instance\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     context, instance, bdms)\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1403, in _prep_block_device\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     instance=instance)\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/compute/manager.py\", line 1386, in _prep_block_device\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     self._await_block_device_map_created))\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/virt/block_device.py\", line 283, in attach_block_devices\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     block_device_mapping)\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/virt/block_device.py\", line 236, in attach\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     '', '', image_id=self.image_id)\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]   File \"/opt/stack/nova/nova/volume/cinder.py\", line 309, in create\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d]     raise exception.InvalidInput(reason=e.message)\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d] InvalidInput: Invalid input received: Invalid input received: Volume size None must be an integer and greater than 0\n2013-09-12 09:20:15.362 TRACE nova.compute.manager [instance: 8edd2e9e-4b4d-44ac-92f1-bea38cd5320d] \n\nWe should disallow empty or default the volume size if not specified.", 
            "date_created": "2013-09-12 13:11:12.421926+00:00", 
            "author": "https://api.launchpad.net/1.0/~ndipanov"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/81862", 
            "date_created": "2014-03-20 17:48:14.099504+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/81862\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=bf1149d8bdf98219d5b95e762e8ec9e59bbaf487\nSubmitter: Jenkins\nBranch:    master\n\ncommit bf1149d8bdf98219d5b95e762e8ec9e59bbaf487\nAuthor: Nikola Dipanov <email address hidden>\nDate:   Thu Mar 20 18:43:02 2014 +0100\n\n    Don't allow empty or 0 volume size for images\n    \n    When specifying the block device that has source_type 'image' and\n    destination_type 'volume', we should confirm that the volume size is\n    specified, as Cinder won't be able to guess it, and will reject the\n    request, thus erroring out the instance.\n    \n    Closes-bug:#1224469\n    Change-Id: I87ece3be1a5e9d6b229717f8025ce542707007c4\n", 
            "date_created": "2014-03-21 15:52:39.185673+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2014-03-31 19:06:25.196580+00:00"
}