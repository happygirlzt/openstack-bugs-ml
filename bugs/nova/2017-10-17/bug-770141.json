{
    "status": "Invalid", 
    "last_updated": "2011-09-15 16:10:04.009157+00:00", 
    "description": "Hi,\n\nI do not understand why I have this error message. \nIs this a configuration or use error, or also a bug? I don't know.\n\nThe error is (original code) :\n============================\n2011-04-24 16:19:31,967 DEBUG nova.rpc [-] Initing the Adapter Consumer for compute from (pid=3107) __init__ /home/openstack/nova/nova/rpc.py:148\n2011-04-24 16:20:32,316 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 16:20:32,316 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 16:21:10,578 DEBUG nova.rpc [-] received {u'_context_request_id': u'TMAD3ND8FJBE7W44485V', u'_context_read_deleted': False, u'args': {u'instance_id': 14, u'injected_files': [], u'availability_zone': None}, u'_context_is_admin': True, u'_context_timestamp': u'2011-04-24T14:21:10Z', u'_context_user': u'client1', u'method': u'run_instance', u'_context_project': u'appli1', u'_context_remote_address': None} from (pid=3107) _receive /home/openstack/nova/nova/rpc.py:167\n2011-04-24 16:21:10,578 DEBUG nova.rpc [-] unpacked context: {'timestamp': u'2011-04-24T14:21:10Z', 'remote_address': None, 'project': u'appli1', 'is_admin': True, 'user': u'client1', 'request_id': u'TMAD3ND8FJBE7W44485V', 'read_deleted': False} from (pid=3107) _unpack_context /home/openstack/nova/nova/rpc.py:331\n2011-04-24 16:21:13,649 AUDIT nova.compute.manager [TMAD3ND8FJBE7W44485V client1 appli1] instance 14: starting...\n2011-04-24 16:21:13,773 DEBUG nova.rpc [-] Making asynchronous call on network.6Cloud01 ... from (pid=3107) call /home/openstack/nova/nova/rpc.py:350\n2011-04-24 16:21:13,773 DEBUG nova.rpc [-] MSG_ID is 97b27c0938d443998093108cdcee354a from (pid=3107) call /home/openstack/nova/nova/rpc.py:353\n2011-04-24 16:21:14,245 DEBUG nova.virt.xenapi.vm_utils [-] Detected KERNEL_RAMDISK format for image 5, instance 14 from (pid=3107) log_disk_format /home/openstack/nova/nova/virt/xenapi/vm_utils.py:494\n2011-04-24 16:21:14,488 DEBUG nova.virt.xenapi.vm_utils [-] Size for image 5:4099360 from (pid=3107) _fetch_image_glance_disk /home/openstack/nova/nova/virt/xenapi/vm_utils.py:442\n2011-04-24 16:21:15,595 DEBUG nova.virt.xenapi.vm_utils [-] Created VDI OpaqueRef:6d15d8cb-b89d-01b9-efed-56b7bd355807 (Glance image 5, 4099360, False) on OpaqueRef:506f6691-e685-d001-c84d-d9e900c78e36. from (pid=3107) create_vdi /home/openstack/nova/nova/virt/xenapi/vm_utils.py:277\n2011-04-24 16:21:15,596 ERROR nova.compute.manager [TMAD3ND8FJBE7W44485V client1 appli1] Instance '14' failed to spawn. Is virtualization enabled in the BIOS?\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/compute/manager.py\", line 234, in run_instance\n(nova.compute.manager): TRACE:     self.driver.spawn(instance_ref)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi_conn.py\", line 188, in spawn\n(nova.compute.manager): TRACE:     self._vmops.spawn(instance)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vmops.py\", line 117, in spawn\n(nova.compute.manager): TRACE:     vdi_uuid = self._create_disk(instance)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vmops.py\", line 113, in _create_disk\n(nova.compute.manager): TRACE:     instance.image_id, user, project, disk_image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 382, in fetch_image\n(nova.compute.manager): TRACE:     access, image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 537, in _fetch_image_glance\n(nova.compute.manager): TRACE:     session, instance_id, image, access, image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 452, in _fetch_image_glance_disk\n(nova.compute.manager): TRACE:     lambda dev:\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 908, in with_vdi_attached_here\n(nova.compute.manager): TRACE:     this_vm_ref = get_this_vm_ref(session)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 989, in get_this_vm_ref\n(nova.compute.manager): TRACE:     return session.get_xenapi().VM.get_by_uuid(get_this_vm_uuid())\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 984, in get_this_vm_uuid\n(nova.compute.manager): TRACE:     with file('/sys/hypervisor/uuid') as f:\n(nova.compute.manager): TRACE: IOError: [Errno 2] No such file or directory: '/sys/hypervisor/uuid'\n(nova.compute.manager): TRACE: \n2011-04-24 16:21:35,374 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 16:21:35,375 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 16:21:38,124 INFO nova.compute.manager [-] Found instance 'instance-0000000e' in DB but no VM. State=8, so setting state to shutoff.\n2011-04-24 16:21:38,124 INFO nova.compute.manager [-] DB/VM state mismatch. Changing state from '8' to '5'\n2011-04-24 16:22:38,462 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 16:22:38,462 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 16:22:41,209 INFO nova.compute.manager [-] Found instance 'instance-0000000e' in DB but no VM. State=5, so setting state to shutoff.\n\n\nAn other error with modified code : \n=================================\n(change code in file \"vm_utils.py\" and remplace this line \"with file('/sys/hypervisor/uuid') as f:\" by \n\"with file('/tsys/hypervisor/uuid') as f:\" after created local directory \"/tsys\" and recopied uuid from xensever in local)\n\n2011-04-24 23:22:21,561 AUDIT nova.compute.manager [YLNPS1L-9EK9TP181TI3 client1 appli1] instance 15: starting...\n2011-04-24 23:22:21,659 DEBUG nova.rpc [-] Making asynchronous call on network.6Cloud01 ... from (pid=2295) call /home/openstack/nova/nova/rpc.py:350\n2011-04-24 23:22:21,660 DEBUG nova.rpc [-] MSG_ID is 5ca2b06a8d41496d97cdee61d93590ad from (pid=2295) call /home/openstack/nova/nova/rpc.py:353\n2011-04-24 23:22:22,075 DEBUG nova.virt.xenapi.vm_utils [-] Detected KERNEL_RAMDISK format for image 5, instance 15 from (pid=2295) log_disk_format /home/openstack/nova/nova/virt/xenapi/vm_utils.py:494\n2011-04-24 23:22:22,359 DEBUG nova.virt.xenapi.vm_utils [-] Size for image 5:4099360 from (pid=2295) _fetch_image_glance_disk /home/openstack/nova/nova/virt/xenapi/vm_utils.py:442\n2011-04-24 23:22:23,514 DEBUG nova.virt.xenapi.vm_utils [-] Created VDI OpaqueRef:a657cbd0-9b53-781c-0fc3-a39d55660b35 (Glance image 5, 4099360, False) on OpaqueRef:506f6691-e685-d001-c84d-d9e900c78e36. from (pid=2295) create_vdi /home/openstack/nova/nova/virt/xenapi/vm_utils.py:277\n2011-04-24 23:22:23,565 DEBUG nova.virt.xenapi.vm_utils [-] Creating VBD for VDI OpaqueRef:a657cbd0-9b53-781c-0fc3-a39d55660b35 ...  from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:922\n2011-04-24 23:22:23,623 DEBUG nova.virt.xenapi.vm_utils [-] Creating VBD for VDI OpaqueRef:a657cbd0-9b53-781c-0fc3-a39d55660b35 done. from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:924\n2011-04-24 23:22:23,623 DEBUG nova.virt.xenapi.vm_utils [-] Plugging VBD OpaqueRef:02352066-27e6-7c1b-f034-c13172b5fe61 ...  from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:926\n2011-04-24 23:22:25,569 DEBUG nova.virt.xenapi.vm_utils [-] Plugging VBD OpaqueRef:02352066-27e6-7c1b-f034-c13172b5fe61 done. from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:928\n2011-04-24 23:22:25,624 DEBUG nova.virt.xenapi.vm_utils [-] VBD OpaqueRef:02352066-27e6-7c1b-f034-c13172b5fe61 plugged as xvda from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:930\n2011-04-24 23:22:26,573 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 23:22:26,573 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 23:22:29,278 INFO nova.compute.manager [-] Found instance 'instance-0000000f' in DB but no VM. State=0, so assuming spawn is in progress.\n2011-04-24 23:22:35,646 DEBUG nova.virt.xenapi.vm_utils [-] Destroying VBD for VDI OpaqueRef:a657cbd0-9b53-781c-0fc3-a39d55660b35 ...  from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:942\n2011-04-24 23:22:37,510 DEBUG nova.virt.xenapi.vm_utils [-] VBD.unplug successful first time. from (pid=2295) vbd_unplug_with_retry /home/openstack/nova/nova/virt/xenapi/vm_utils.py:957\n2011-04-24 23:22:37,556 DEBUG nova.virt.xenapi.vm_utils [-] Destroying VBD for VDI OpaqueRef:a657cbd0-9b53-781c-0fc3-a39d55660b35 done. from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:945\n2011-04-24 23:22:37,556 ERROR nova.compute.manager [YLNPS1L-9EK9TP181TI3 client1 appli1] Instance '15' failed to spawn. Is virtualization enabled in the BIOS?\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/compute/manager.py\", line 234, in run_instance\n(nova.compute.manager): TRACE:     self.driver.spawn(instance_ref)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi_conn.py\", line 188, in spawn\n(nova.compute.manager): TRACE:     self._vmops.spawn(instance)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vmops.py\", line 117, in spawn\n(nova.compute.manager): TRACE:     vdi_uuid = self._create_disk(instance)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vmops.py\", line 113, in _create_disk\n(nova.compute.manager): TRACE:     instance.image_id, user, project, disk_image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 382, in fetch_image\n(nova.compute.manager): TRACE:     access, image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 537, in _fetch_image_glance\n(nova.compute.manager): TRACE:     session, instance_id, image, access, image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 452, in _fetch_image_glance_disk\n(nova.compute.manager): TRACE:     lambda dev:\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 939, in with_vdi_attached_here\n(nova.compute.manager): TRACE:     _wait_for_device(dev)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 904, in _wait_for_device\n(nova.compute.manager): TRACE:     raise StorageError(_('Timeout waiting for device %s to be created') % dev)\n(nova.compute.manager): TRACE: StorageError: Timeout waiting for device xvda to be created\n(nova.compute.manager): TRACE: \n2011-04-24 23:23:29,558 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 23:23:29,558 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 23:23:32,049 INFO nova.compute.manager [-] Found instance 'instance-0000000f' in DB but no VM. State=8, so setting state to shutoff.\n2011-04-24 23:23:32,050 INFO nova.compute.manager [-] DB/VM state mismatch. Changing state from '8' to '5'\n2011-04-24 23:24:32,372 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 23:24:32,373 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 23:24:34,892 INFO nova.compute.manager [-] Found instance 'instance-0000000f' in DB but no VM. State=5, so setting state to shutoff.\n2011-04-24 23:25:35,177 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n\n\nWe can see more details (https://answers.launchpad.net/nova/+question/153853) and also a extract (see below) of local storage via XenCenter\n\nThank you for your help.\n\nRegards,\n\n\n[root@xenserver-01 ~]# xe vdi-list <CR> # extract\nuuid ( RO)                : 08e969f9-4178-46d1-b02a-a9341c9bc87d\n          name-label ( RW): Glance image 2\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\n\nuuid ( RO)                : c821a620-da0b-4f39-a4a2-5f2ff7f085e2\n          name-label ( RW): Glance image 2\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 8bb394a5-a959-4d7e-8518-dcb00f596074\n          name-label ( RW): Glance image 4\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 8388608\n            sharable ( RO): false\n           read-only ( RO): false\n\n\nuuid ( RO)                : fa05d438-117b-4f92-a1a4-a3c9908a067a\n          name-label ( RW): Glance image 2\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\n\nuuid ( RO)                : 71cbf264-c022-408b-9030-040870738885\n          name-label ( RW): Glance image 1\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 6291456\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 86178586-f3dc-424c-aefe-2725d3d4b4af\n          name-label ( RW): Glance image 5\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 1f1e9c9f-7d2c-466c-99bb-314e1dc1e5bb\n          name-label ( RW): Glance image 2\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 08ef59b9-8061-4cd3-91d7-d952bb8e3f29\n          name-label ( RW): 0\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 6442450944\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 17dd4ae9-7c9e-4225-85eb-d0192c1ece80\n          name-label ( RW): Glance image 5\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\n\nuuid ( RO)                : 24c6fd90-57eb-47c3-b290-d1bab2dc89ee\n          name-label ( RW): Glance image 5\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 32c6a12e-4d87-4ad4-951e-3b1f1a557be9\n          name-label ( RW): Glance image 5\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false", 
    "tags": [
        "compute", 
        "xenapi"
    ], 
    "importance": "Undecided", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/770141", 
    "owner": "None", 
    "id": 770141, 
    "index": 3398, 
    "openned": "2011-04-25 07:32:23.077997+00:00", 
    "created": "2011-04-25 07:32:23.077997+00:00", 
    "title": "xenapi create_vdi error", 
    "comments": [
        {
            "content": "Hi,\n\nI do not understand why I have this error message. \nIs this a configuration or use error, or also a bug? I don't know.\n\nThe error is (original code) :\n============================\n2011-04-24 16:19:31,967 DEBUG nova.rpc [-] Initing the Adapter Consumer for compute from (pid=3107) __init__ /home/openstack/nova/nova/rpc.py:148\n2011-04-24 16:20:32,316 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 16:20:32,316 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 16:21:10,578 DEBUG nova.rpc [-] received {u'_context_request_id': u'TMAD3ND8FJBE7W44485V', u'_context_read_deleted': False, u'args': {u'instance_id': 14, u'injected_files': [], u'availability_zone': None}, u'_context_is_admin': True, u'_context_timestamp': u'2011-04-24T14:21:10Z', u'_context_user': u'client1', u'method': u'run_instance', u'_context_project': u'appli1', u'_context_remote_address': None} from (pid=3107) _receive /home/openstack/nova/nova/rpc.py:167\n2011-04-24 16:21:10,578 DEBUG nova.rpc [-] unpacked context: {'timestamp': u'2011-04-24T14:21:10Z', 'remote_address': None, 'project': u'appli1', 'is_admin': True, 'user': u'client1', 'request_id': u'TMAD3ND8FJBE7W44485V', 'read_deleted': False} from (pid=3107) _unpack_context /home/openstack/nova/nova/rpc.py:331\n2011-04-24 16:21:13,649 AUDIT nova.compute.manager [TMAD3ND8FJBE7W44485V client1 appli1] instance 14: starting...\n2011-04-24 16:21:13,773 DEBUG nova.rpc [-] Making asynchronous call on network.6Cloud01 ... from (pid=3107) call /home/openstack/nova/nova/rpc.py:350\n2011-04-24 16:21:13,773 DEBUG nova.rpc [-] MSG_ID is 97b27c0938d443998093108cdcee354a from (pid=3107) call /home/openstack/nova/nova/rpc.py:353\n2011-04-24 16:21:14,245 DEBUG nova.virt.xenapi.vm_utils [-] Detected KERNEL_RAMDISK format for image 5, instance 14 from (pid=3107) log_disk_format /home/openstack/nova/nova/virt/xenapi/vm_utils.py:494\n2011-04-24 16:21:14,488 DEBUG nova.virt.xenapi.vm_utils [-] Size for image 5:4099360 from (pid=3107) _fetch_image_glance_disk /home/openstack/nova/nova/virt/xenapi/vm_utils.py:442\n2011-04-24 16:21:15,595 DEBUG nova.virt.xenapi.vm_utils [-] Created VDI OpaqueRef:6d15d8cb-b89d-01b9-efed-56b7bd355807 (Glance image 5, 4099360, False) on OpaqueRef:506f6691-e685-d001-c84d-d9e900c78e36. from (pid=3107) create_vdi /home/openstack/nova/nova/virt/xenapi/vm_utils.py:277\n2011-04-24 16:21:15,596 ERROR nova.compute.manager [TMAD3ND8FJBE7W44485V client1 appli1] Instance '14' failed to spawn. Is virtualization enabled in the BIOS?\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/compute/manager.py\", line 234, in run_instance\n(nova.compute.manager): TRACE:     self.driver.spawn(instance_ref)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi_conn.py\", line 188, in spawn\n(nova.compute.manager): TRACE:     self._vmops.spawn(instance)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vmops.py\", line 117, in spawn\n(nova.compute.manager): TRACE:     vdi_uuid = self._create_disk(instance)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vmops.py\", line 113, in _create_disk\n(nova.compute.manager): TRACE:     instance.image_id, user, project, disk_image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 382, in fetch_image\n(nova.compute.manager): TRACE:     access, image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 537, in _fetch_image_glance\n(nova.compute.manager): TRACE:     session, instance_id, image, access, image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 452, in _fetch_image_glance_disk\n(nova.compute.manager): TRACE:     lambda dev:\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 908, in with_vdi_attached_here\n(nova.compute.manager): TRACE:     this_vm_ref = get_this_vm_ref(session)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 989, in get_this_vm_ref\n(nova.compute.manager): TRACE:     return session.get_xenapi().VM.get_by_uuid(get_this_vm_uuid())\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 984, in get_this_vm_uuid\n(nova.compute.manager): TRACE:     with file('/sys/hypervisor/uuid') as f:\n(nova.compute.manager): TRACE: IOError: [Errno 2] No such file or directory: '/sys/hypervisor/uuid'\n(nova.compute.manager): TRACE: \n2011-04-24 16:21:35,374 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 16:21:35,375 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 16:21:38,124 INFO nova.compute.manager [-] Found instance 'instance-0000000e' in DB but no VM. State=8, so setting state to shutoff.\n2011-04-24 16:21:38,124 INFO nova.compute.manager [-] DB/VM state mismatch. Changing state from '8' to '5'\n2011-04-24 16:22:38,462 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 16:22:38,462 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 16:22:41,209 INFO nova.compute.manager [-] Found instance 'instance-0000000e' in DB but no VM. State=5, so setting state to shutoff.\n\n\nAn other error with modified code : \n=================================\n(change code in file \"vm_utils.py\" and remplace this line \"with file('/sys/hypervisor/uuid') as f:\" by \n\"with file('/tsys/hypervisor/uuid') as f:\" after created local directory \"/tsys\" and recopied uuid from xensever in local)\n\n2011-04-24 23:22:21,561 AUDIT nova.compute.manager [YLNPS1L-9EK9TP181TI3 client1 appli1] instance 15: starting...\n2011-04-24 23:22:21,659 DEBUG nova.rpc [-] Making asynchronous call on network.6Cloud01 ... from (pid=2295) call /home/openstack/nova/nova/rpc.py:350\n2011-04-24 23:22:21,660 DEBUG nova.rpc [-] MSG_ID is 5ca2b06a8d41496d97cdee61d93590ad from (pid=2295) call /home/openstack/nova/nova/rpc.py:353\n2011-04-24 23:22:22,075 DEBUG nova.virt.xenapi.vm_utils [-] Detected KERNEL_RAMDISK format for image 5, instance 15 from (pid=2295) log_disk_format /home/openstack/nova/nova/virt/xenapi/vm_utils.py:494\n2011-04-24 23:22:22,359 DEBUG nova.virt.xenapi.vm_utils [-] Size for image 5:4099360 from (pid=2295) _fetch_image_glance_disk /home/openstack/nova/nova/virt/xenapi/vm_utils.py:442\n2011-04-24 23:22:23,514 DEBUG nova.virt.xenapi.vm_utils [-] Created VDI OpaqueRef:a657cbd0-9b53-781c-0fc3-a39d55660b35 (Glance image 5, 4099360, False) on OpaqueRef:506f6691-e685-d001-c84d-d9e900c78e36. from (pid=2295) create_vdi /home/openstack/nova/nova/virt/xenapi/vm_utils.py:277\n2011-04-24 23:22:23,565 DEBUG nova.virt.xenapi.vm_utils [-] Creating VBD for VDI OpaqueRef:a657cbd0-9b53-781c-0fc3-a39d55660b35 ...  from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:922\n2011-04-24 23:22:23,623 DEBUG nova.virt.xenapi.vm_utils [-] Creating VBD for VDI OpaqueRef:a657cbd0-9b53-781c-0fc3-a39d55660b35 done. from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:924\n2011-04-24 23:22:23,623 DEBUG nova.virt.xenapi.vm_utils [-] Plugging VBD OpaqueRef:02352066-27e6-7c1b-f034-c13172b5fe61 ...  from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:926\n2011-04-24 23:22:25,569 DEBUG nova.virt.xenapi.vm_utils [-] Plugging VBD OpaqueRef:02352066-27e6-7c1b-f034-c13172b5fe61 done. from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:928\n2011-04-24 23:22:25,624 DEBUG nova.virt.xenapi.vm_utils [-] VBD OpaqueRef:02352066-27e6-7c1b-f034-c13172b5fe61 plugged as xvda from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:930\n2011-04-24 23:22:26,573 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 23:22:26,573 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 23:22:29,278 INFO nova.compute.manager [-] Found instance 'instance-0000000f' in DB but no VM. State=0, so assuming spawn is in progress.\n2011-04-24 23:22:35,646 DEBUG nova.virt.xenapi.vm_utils [-] Destroying VBD for VDI OpaqueRef:a657cbd0-9b53-781c-0fc3-a39d55660b35 ...  from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:942\n2011-04-24 23:22:37,510 DEBUG nova.virt.xenapi.vm_utils [-] VBD.unplug successful first time. from (pid=2295) vbd_unplug_with_retry /home/openstack/nova/nova/virt/xenapi/vm_utils.py:957\n2011-04-24 23:22:37,556 DEBUG nova.virt.xenapi.vm_utils [-] Destroying VBD for VDI OpaqueRef:a657cbd0-9b53-781c-0fc3-a39d55660b35 done. from (pid=2295) with_vdi_attached_here /home/openstack/nova/nova/virt/xenapi/vm_utils.py:945\n2011-04-24 23:22:37,556 ERROR nova.compute.manager [YLNPS1L-9EK9TP181TI3 client1 appli1] Instance '15' failed to spawn. Is virtualization enabled in the BIOS?\n(nova.compute.manager): TRACE: Traceback (most recent call last):\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/compute/manager.py\", line 234, in run_instance\n(nova.compute.manager): TRACE:     self.driver.spawn(instance_ref)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi_conn.py\", line 188, in spawn\n(nova.compute.manager): TRACE:     self._vmops.spawn(instance)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vmops.py\", line 117, in spawn\n(nova.compute.manager): TRACE:     vdi_uuid = self._create_disk(instance)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vmops.py\", line 113, in _create_disk\n(nova.compute.manager): TRACE:     instance.image_id, user, project, disk_image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 382, in fetch_image\n(nova.compute.manager): TRACE:     access, image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 537, in _fetch_image_glance\n(nova.compute.manager): TRACE:     session, instance_id, image, access, image_type)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 452, in _fetch_image_glance_disk\n(nova.compute.manager): TRACE:     lambda dev:\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 939, in with_vdi_attached_here\n(nova.compute.manager): TRACE:     _wait_for_device(dev)\n(nova.compute.manager): TRACE:   File \"/home/openstack/nova/nova/virt/xenapi/vm_utils.py\", line 904, in _wait_for_device\n(nova.compute.manager): TRACE:     raise StorageError(_('Timeout waiting for device %s to be created') % dev)\n(nova.compute.manager): TRACE: StorageError: Timeout waiting for device xvda to be created\n(nova.compute.manager): TRACE: \n2011-04-24 23:23:29,558 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 23:23:29,558 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 23:23:32,049 INFO nova.compute.manager [-] Found instance 'instance-0000000f' in DB but no VM. State=8, so setting state to shutoff.\n2011-04-24 23:23:32,050 INFO nova.compute.manager [-] DB/VM state mismatch. Changing state from '8' to '5'\n2011-04-24 23:24:32,372 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n2011-04-24 23:24:32,373 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenapi power_state -> |1|\n2011-04-24 23:24:34,892 INFO nova.compute.manager [-] Found instance 'instance-0000000f' in DB but no VM. State=5, so setting state to shutoff.\n2011-04-24 23:25:35,177 INFO nova.virt.xenapi.vm_utils [-] (VM_UTILS) xenserver vm state -> |Running|\n\n\nWe can see more details (https://answers.launchpad.net/nova/+question/153853) and also a extract (see below) of local storage via XenCenter\n\nThank you for your help.\n\nRegards,\n\n\n[root@xenserver-01 ~]# xe vdi-list <CR> # extract\nuuid ( RO)                : 08e969f9-4178-46d1-b02a-a9341c9bc87d\n          name-label ( RW): Glance image 2\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\n\nuuid ( RO)                : c821a620-da0b-4f39-a4a2-5f2ff7f085e2\n          name-label ( RW): Glance image 2\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 8bb394a5-a959-4d7e-8518-dcb00f596074\n          name-label ( RW): Glance image 4\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 8388608\n            sharable ( RO): false\n           read-only ( RO): false\n\n\nuuid ( RO)                : fa05d438-117b-4f92-a1a4-a3c9908a067a\n          name-label ( RW): Glance image 2\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\n\nuuid ( RO)                : 71cbf264-c022-408b-9030-040870738885\n          name-label ( RW): Glance image 1\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 6291456\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 86178586-f3dc-424c-aefe-2725d3d4b4af\n          name-label ( RW): Glance image 5\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 1f1e9c9f-7d2c-466c-99bb-314e1dc1e5bb\n          name-label ( RW): Glance image 2\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 08ef59b9-8061-4cd3-91d7-d952bb8e3f29\n          name-label ( RW): 0\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 6442450944\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 17dd4ae9-7c9e-4225-85eb-d0192c1ece80\n          name-label ( RW): Glance image 5\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\n\nuuid ( RO)                : 24c6fd90-57eb-47c3-b290-d1bab2dc89ee\n          name-label ( RW): Glance image 5\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false\n\nuuid ( RO)                : 32c6a12e-4d87-4ad4-951e-3b1f1a557be9\n          name-label ( RW): Glance image 5\n    name-description ( RW):\n             sr-uuid ( RO): 7ed9b60c-367f-6c25-3ef7-dd492acd8996\n        virtual-size ( RO): 4194304\n            sharable ( RO): false\n           read-only ( RO): false", 
            "date_created": "2011-04-25 07:32:23.077997+00:00", 
            "author": "https://api.launchpad.net/1.0/~laurent-borensky"
        }, 
        {
            "content": "", 
            "date_created": "2011-04-25 07:32:23.077997+00:00", 
            "author": "https://api.launchpad.net/1.0/~laurent-borensky"
        }, 
        {
            "content": "Hi Laurent,\n\nI think this may be a configuration issue. The current nova xenapi code requires that nova-compute be run inside a VM on the actual XenServer host machine it is controlling. If you do this then you should automatically have the /sys/hypervisor/uuid file available for nova-compute to read.\n\nThe nova xenapi plugins (which get installed on the XenServer itself) use this to create and mount a VDI device in the nova-compute VM where the raw image data can be written.\n\nHope this helps.\n\nDan", 
            "date_created": "2011-04-25 16:45:23.411034+00:00", 
            "author": "https://api.launchpad.net/1.0/~dan-prince"
        }, 
        {
            "content": "@Laurent: does the explanation answer your problem ?", 
            "date_created": "2011-06-29 12:34:41.037342+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "I'll assume it does solve your issue -- If not please reopen the bug by setting its status back to New.", 
            "date_created": "2011-07-25 15:14:01.948382+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }
    ], 
    "closed": "2011-07-26 09:41:23.582456+00:00"
}