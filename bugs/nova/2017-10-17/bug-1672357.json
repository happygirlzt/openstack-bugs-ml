{
    "status": "Expired", 
    "last_updated": "2017-06-17 04:17:44.785642+00:00", 
    "description": "I have recently installed a new Openstackcloud.\nOne controller and two nova nodes. When I tried to launch a new instance I got an error. \nI could only launch instance on the controller node, but not on the two nova nodes.\n\nThe error message I got was:\n==> nova/nova-compute.log <==\n2017-03-13 09:18:37.738 780 INFO oslo.privsep.daemon [req-ad1726ad-ce87-4bda-a359-25f68d7aa0be - - - - -] Running privsep helper: ['sudo', 'nova-rootwrap', '/etc/nova/rootwrap.conf', 'privsep-helper', '--config-file', '/etc/nova/nova.conf', '--config-file', '/etc/nova/nova-compute.conf', '--privsep_context', 'os_brick.privileged.default', '--privsep_sock_path', '/tmp/tmpcWGEib/privsep.sock']\n\n==> auth.log <==\nMar 13 09:18:37 nova1 sudo: pam_unix(sudo:auth): auth could not identify password for [nova]\nMar 13 09:18:37 nova1 sudo:     nova : command not allowed ; TTY=unknown ; PWD=/var/lib/nova ; USER=root ; COMMAND=/usr/local/bin/nova-rootwrap /etc/nova/rootwrap.conf privsep-helper --config-file /etc/nova/nova.conf --config-file /etc/nova/nova-compute.conf --privsep_context os_brick.privileged.default --privsep_sock_path /tmp/tmpcWGEib/privsep.sock\n\n==> nova/nova-compute.log <==\n2017-03-13 09:18:37.772 780 CRITICAL oslo.privsep.daemon [req-ad1726ad-ce87-4bda-a359-25f68d7aa0be - - - - -] privsep helper command exited non-zero (1)\n2017-03-13 09:18:37.777 780 WARNING oslo.privsep.daemon [-] privsep log: sudo: no tty present and no askpass program specified\n2017-03-13 09:18:37.794 780 ERROR nova.compute.manager [req-ad1726ad-ce87-4bda-a359-25f68d7aa0be - - - - -] [instance: 7842db94-82bb-4b48-8dbe-6e7b33ee4b12] Instance failed block device setup\n2017-03-13 09:18:37.794 780 ERROR nova.compute.manager [instance: 7842db94-82bb-4b48-8dbe-6e7b33ee4b12] Traceback (most recent call last):\n2017-03-13 09:18:37.794 780 ERROR nova.compute.manager [instance: 7842db94-82bb-4b48-8dbe-6e7b33ee4b12]   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1582, in _prep_block_device\n2017-03-13 09:18:37.794 780 ERROR nova.compute.manager [instance: 7842db94-82bb-4b48-8dbe-6e7b33ee4b12]     wait_func=self._await_block_device_map_created)\n\n\nAfter some investigation I had to change a couple of thing to get it to work.\n\n1.) Add the following line to sudoer\nnova ALL = (root) NOPASSWD: /usr/local/bin/nova-rootwrap /etc/nova/rootwrap.conf *\nAccording to the manual, it should be /usr/bin/nova-rootwrap. But that didn't work either.\n\n2.) Change owner on directory /var/lib/nova/instance to nova:nova. For some reason it is registered as root:root. \nFor some reason most directory in /var/lib/nova has owner root:root.\n\nI have follow the installation manual for Openstack newton.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1672357", 
    "owner": "None", 
    "id": 1672357, 
    "index": 7991, 
    "openned": "2017-03-13 12:21:34.469821+00:00", 
    "created": "2017-03-13 12:21:34.469821+00:00", 
    "title": "[Newton][Nova] When deploying an instance. Get the following error:  sudo: pam_unix(sudo:auth): auth could not identify password for [nova]sudo: pam_unix(sudo:auth): auth could not identify password for [nova]", 
    "comments": [
        {
            "content": "I have recently installed a new Openstackcloud.\nOne controller and two nova nodes. When I tried to launch a new instance I got an error. \nI could only launch instance on the controller node, but not on the two nova nodes.\n\nThe error message I got was:\n==> nova/nova-compute.log <==\n2017-03-13 09:18:37.738 780 INFO oslo.privsep.daemon [req-ad1726ad-ce87-4bda-a359-25f68d7aa0be - - - - -] Running privsep helper: ['sudo', 'nova-rootwrap', '/etc/nova/rootwrap.conf', 'privsep-helper', '--config-file', '/etc/nova/nova.conf', '--config-file', '/etc/nova/nova-compute.conf', '--privsep_context', 'os_brick.privileged.default', '--privsep_sock_path', '/tmp/tmpcWGEib/privsep.sock']\n\n==> auth.log <==\nMar 13 09:18:37 nova1 sudo: pam_unix(sudo:auth): auth could not identify password for [nova]\nMar 13 09:18:37 nova1 sudo:     nova : command not allowed ; TTY=unknown ; PWD=/var/lib/nova ; USER=root ; COMMAND=/usr/local/bin/nova-rootwrap /etc/nova/rootwrap.conf privsep-helper --config-file /etc/nova/nova.conf --config-file /etc/nova/nova-compute.conf --privsep_context os_brick.privileged.default --privsep_sock_path /tmp/tmpcWGEib/privsep.sock\n\n==> nova/nova-compute.log <==\n2017-03-13 09:18:37.772 780 CRITICAL oslo.privsep.daemon [req-ad1726ad-ce87-4bda-a359-25f68d7aa0be - - - - -] privsep helper command exited non-zero (1)\n2017-03-13 09:18:37.777 780 WARNING oslo.privsep.daemon [-] privsep log: sudo: no tty present and no askpass program specified\n2017-03-13 09:18:37.794 780 ERROR nova.compute.manager [req-ad1726ad-ce87-4bda-a359-25f68d7aa0be - - - - -] [instance: 7842db94-82bb-4b48-8dbe-6e7b33ee4b12] Instance failed block device setup\n2017-03-13 09:18:37.794 780 ERROR nova.compute.manager [instance: 7842db94-82bb-4b48-8dbe-6e7b33ee4b12] Traceback (most recent call last):\n2017-03-13 09:18:37.794 780 ERROR nova.compute.manager [instance: 7842db94-82bb-4b48-8dbe-6e7b33ee4b12]   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1582, in _prep_block_device\n2017-03-13 09:18:37.794 780 ERROR nova.compute.manager [instance: 7842db94-82bb-4b48-8dbe-6e7b33ee4b12]     wait_func=self._await_block_device_map_created)\n\n\nAfter some investigation I had to change a couple of thing to get it to work.\n\n1.) Add the following line to sudoer\nnova ALL = (root) NOPASSWD: /usr/local/bin/nova-rootwrap /etc/nova/rootwrap.conf *\nAccording to the manual, it should be /usr/bin/nova-rootwrap. But that didn't work either.\n\n2.) Change owner on directory /var/lib/nova/instance to nova:nova. For some reason it is registered as root:root. \nFor some reason most directory in /var/lib/nova has owner root:root.\n\nI have follow the installation manual for Openstack newton.", 
            "date_created": "2017-03-13 12:21:34.469821+00:00", 
            "author": "https://api.launchpad.net/1.0/~viah01"
        }, 
        {
            "content": "On what Linux distro with what packages were you trying to install? It looks like a packaging issue here.", 
            "date_created": "2017-04-17 13:06:49.682394+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "[Expired for OpenStack Compute (nova) because there has been no activity for 60 days.]", 
            "date_created": "2017-06-17 04:17:42.070947+00:00", 
            "author": "https://api.launchpad.net/1.0/~janitor"
        }
    ], 
    "closed": "2017-06-17 04:17:42.360732+00:00"
}