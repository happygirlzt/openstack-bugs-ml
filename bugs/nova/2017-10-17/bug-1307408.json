{
    "status": "Fix Released", 
    "last_updated": "2014-10-16 08:27:49.234917+00:00", 
    "description": "If Claim is not successful, compute manager triggers a call to destroy instance.\nDestroy fails since the compute node (cluster) is set only after claim is successful.\n\nThis issue occurs when multiple parallel nova boot operations are triggered simultaneously.\n\nSnippet from nova-compute.log\n2014-04-06 22:48:52.454 \u001b[00;32mDEBUG nova.compute.utils [\u001b[01;36mreq-0663cdf1-9969-446a-af08-299f18366394 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00;32mInsufficient compute resources: Free memory 975.00 MB < requested 2000 MB.\u001b[00m \u001b[00;33mfrom (pid=9041) notify_about_instance_usage /opt/stack/nova/nova/compute/utils.py:336\u001b[00m\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00mTraceback (most recent call last):\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1289, in _build_instance\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m    with rt.instance_claim(context, instance, limits):\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m  File \"/opt/stack/nova/nova/openstack/common/lockutils.py\", line 249, in inner\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m    return f(*args, **kwargs)\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m  File \"/opt/stack/nova/nova/compute/resource_tracker.py\", line 122, in instance_claim\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m    overhead=overhead, limits=limits)\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m  File \"/opt/stack/nova/nova/compute/claims.py\", line 95, in __init__\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m    self._claim_test(resources, limits)\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m  File \"/opt/stack/nova/nova/compute/claims.py\", line 148, in _claim_test\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m    \"; \".join(reasons))\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00mComputeResourcesUnavailable: Insufficient compute resources: Free memory 975.00 MB < requested 2000 MB.\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m\n2014-04-06 22:48:52.455 \u001b[00;32mDEBUG nova.compute.manager [\u001b[01;36mreq-0663cdf1-9969-446a-af08-299f18366394 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00;32mClean up resource before rescheduling.\u001b[00m \u001b[00;33mfrom (pid=9041) _reschedule_or_error /opt/stack/nova/nova/compute/manager.py:1401\u001b[00m\n2014-04-06 22:48:52.455 \u001b[01;36mAUDIT nova.compute.manager [\u001b[01;36mreq-0663cdf1-9969-446a-af08-299f18366394 \u001b[00;36mdemo demo\u001b[01;36m] \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[01;36mTerminating instance\u001b[00m\n2014-04-06 22:48:52.544 \u001b[00;32mDEBUG nova.network.api [\u001b[01;36mreq-8cf2f302-42af-46e2-b745-fa30902c3319 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m\u001b[00;32mUpdating cache with info: []\u001b[00m \u001b[00;33mfrom (pid=9041) update_instance_cache_with_nw_info /opt/stack/nova/nova/network/api.py:74\u001b[00m\n2014-04-06 22:48:52.555 \u001b[00;32mDEBUG nova.objects.instance [\u001b[01;36mreq-0663cdf1-9969-446a-af08-299f18366394 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m\u001b[00;32mLazy-loading `system_metadata' on Instance uuid b22186ec-9f05-4f7d-a0d6-2276baeb6572\u001b[00m \u001b[00;33mfrom (pid=9041) obj_load_attr /opt/stack/nova/nova/objects/instance.py:519\u001b[00m\n2014-04-06 22:48:52.563 \u001b[00;32mDEBUG nova.compute.manager [\u001b[01;36mreq-8cf2f302-42af-46e2-b745-fa30902c3319 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00;32mDeallocating network for instance\u001b[00m \u001b[00;33mfrom (pid=9041) _deallocate_network /opt/stack/nova/nova/compute/manager.py:1784\u001b[00m\n2014-04-06 22:48:52.593 \u001b[01;31mERROR nova.compute.manager [\u001b[01;36mreq-8cf2f302-42af-46e2-b745-fa30902c3319 \u001b[00;36mdemo demo\u001b[01;31m] \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[01;31mError: Insufficient compute resources: Free memory 975.00 MB < requested 2000 MB.\u001b[00m\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00mTraceback (most recent call last):\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1289, in _build_instance\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    with rt.instance_claim(context, instance, limits):\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/openstack/common/lockutils.py\", line 249, in inner\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    return f(*args, **kwargs)\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/resource_tracker.py\", line 122, in instance_claim\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    overhead=overhead, limits=limits)\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/claims.py\", line 95, in __init__\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    self._claim_test(resources, limits)\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/claims.py\", line 148, in _claim_test\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    \"; \".join(reasons))\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00mComputeResourcesUnavailable: Insufficient compute resources: Free memory 975.00 MB < requested 2000 MB.\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m\n2014-04-06 22:48:52.664 \u001b[00;32mDEBUG nova.compute.utils [\u001b[01;36mreq-8cf2f302-42af-46e2-b745-fa30902c3319 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00;32mThe resource None does not exist\u001b[00m \u001b[00;33mfrom (pid=9041) notify_about_instance_usage /opt/stack/nova/nova/compute/utils.py:336\u001b[00m\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00mTraceback (most recent call last):\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1202, in _run_instance\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    instance, image_meta, legacy_bdm_in_spec)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1366, in _build_instance\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    filter_properties, bdms, legacy_bdm_in_spec)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1412, in _reschedule_or_error\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    self._log_original_error(exc_info, instance_uuid)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 68, in __exit__\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    six.reraise(self.type_, self.value, self.tb)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1407, in _reschedule_or_error\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    bdms, requested_networks)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 2136, in _shutdown_instance\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    requested_networks)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 68, in __exit__\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    six.reraise(self.type_, self.value, self.tb)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 2126, in _shutdown_instance\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    block_device_info)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 656, in destroy\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    _vmops = self._get_vmops_for_compute_node(instance['node'])\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 544, in _get_vmops_for_compute_node\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    resource = self._get_resource_for_node(nodename)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 536, in _get_resource_for_node\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    raise exception.NotFound(msg)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00mNotFound: The resource None does not exist", 
    "tags": [
        "vmware"
    ], 
    "importance": "High", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1307408", 
    "owner": "https://api.launchpad.net/1.0/~sagar-r-nikam", 
    "id": 1307408, 
    "index": 1475, 
    "openned": "2014-04-14 09:59:32.510441+00:00", 
    "created": "2014-04-14 09:59:32.510441+00:00", 
    "title": "VMWare - Destroy fails when Claim is not successful", 
    "comments": [
        {
            "content": "If Claim is not successful, compute manager triggers a call to destroy instance.\nDestroy fails since the compute node (cluster) is set only after claim is successful.\n\nThis issue occurs when multiple parallel nova boot operations are triggered simultaneously.\n\nSnippet from nova-compute.log\n2014-04-06 22:48:52.454 \u001b[00;32mDEBUG nova.compute.utils [\u001b[01;36mreq-0663cdf1-9969-446a-af08-299f18366394 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00;32mInsufficient compute resources: Free memory 975.00 MB < requested 2000 MB.\u001b[00m \u001b[00;33mfrom (pid=9041) notify_about_instance_usage /opt/stack/nova/nova/compute/utils.py:336\u001b[00m\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00mTraceback (most recent call last):\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1289, in _build_instance\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m    with rt.instance_claim(context, instance, limits):\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m  File \"/opt/stack/nova/nova/openstack/common/lockutils.py\", line 249, in inner\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m    return f(*args, **kwargs)\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m  File \"/opt/stack/nova/nova/compute/resource_tracker.py\", line 122, in instance_claim\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m    overhead=overhead, limits=limits)\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m  File \"/opt/stack/nova/nova/compute/claims.py\", line 95, in __init__\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m    self._claim_test(resources, limits)\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m  File \"/opt/stack/nova/nova/compute/claims.py\", line 148, in _claim_test\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m    \"; \".join(reasons))\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00mComputeResourcesUnavailable: Insufficient compute resources: Free memory 975.00 MB < requested 2000 MB.\n\u001b[00;32m2014-04-06 22:48:52.454 TRACE nova.compute.utils \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00m\n2014-04-06 22:48:52.455 \u001b[00;32mDEBUG nova.compute.manager [\u001b[01;36mreq-0663cdf1-9969-446a-af08-299f18366394 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[00;32mClean up resource before rescheduling.\u001b[00m \u001b[00;33mfrom (pid=9041) _reschedule_or_error /opt/stack/nova/nova/compute/manager.py:1401\u001b[00m\n2014-04-06 22:48:52.455 \u001b[01;36mAUDIT nova.compute.manager [\u001b[01;36mreq-0663cdf1-9969-446a-af08-299f18366394 \u001b[00;36mdemo demo\u001b[01;36m] \u001b[01;35m[instance: b22186ec-9f05-4f7d-a0d6-2276baeb6572] \u001b[01;36mTerminating instance\u001b[00m\n2014-04-06 22:48:52.544 \u001b[00;32mDEBUG nova.network.api [\u001b[01;36mreq-8cf2f302-42af-46e2-b745-fa30902c3319 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m\u001b[00;32mUpdating cache with info: []\u001b[00m \u001b[00;33mfrom (pid=9041) update_instance_cache_with_nw_info /opt/stack/nova/nova/network/api.py:74\u001b[00m\n2014-04-06 22:48:52.555 \u001b[00;32mDEBUG nova.objects.instance [\u001b[01;36mreq-0663cdf1-9969-446a-af08-299f18366394 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m\u001b[00;32mLazy-loading `system_metadata' on Instance uuid b22186ec-9f05-4f7d-a0d6-2276baeb6572\u001b[00m \u001b[00;33mfrom (pid=9041) obj_load_attr /opt/stack/nova/nova/objects/instance.py:519\u001b[00m\n2014-04-06 22:48:52.563 \u001b[00;32mDEBUG nova.compute.manager [\u001b[01;36mreq-8cf2f302-42af-46e2-b745-fa30902c3319 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00;32mDeallocating network for instance\u001b[00m \u001b[00;33mfrom (pid=9041) _deallocate_network /opt/stack/nova/nova/compute/manager.py:1784\u001b[00m\n2014-04-06 22:48:52.593 \u001b[01;31mERROR nova.compute.manager [\u001b[01;36mreq-8cf2f302-42af-46e2-b745-fa30902c3319 \u001b[00;36mdemo demo\u001b[01;31m] \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[01;31mError: Insufficient compute resources: Free memory 975.00 MB < requested 2000 MB.\u001b[00m\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00mTraceback (most recent call last):\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1289, in _build_instance\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    with rt.instance_claim(context, instance, limits):\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/openstack/common/lockutils.py\", line 249, in inner\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    return f(*args, **kwargs)\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/resource_tracker.py\", line 122, in instance_claim\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    overhead=overhead, limits=limits)\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/claims.py\", line 95, in __init__\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    self._claim_test(resources, limits)\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/claims.py\", line 148, in _claim_test\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    \"; \".join(reasons))\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00mComputeResourcesUnavailable: Insufficient compute resources: Free memory 975.00 MB < requested 2000 MB.\n\u001b[01;31m2014-04-06 22:48:52.593 TRACE nova.compute.manager \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m\n2014-04-06 22:48:52.664 \u001b[00;32mDEBUG nova.compute.utils [\u001b[01;36mreq-8cf2f302-42af-46e2-b745-fa30902c3319 \u001b[00;36mdemo demo\u001b[00;32m] \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00;32mThe resource None does not exist\u001b[00m \u001b[00;33mfrom (pid=9041) notify_about_instance_usage /opt/stack/nova/nova/compute/utils.py:336\u001b[00m\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00mTraceback (most recent call last):\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1202, in _run_instance\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    instance, image_meta, legacy_bdm_in_spec)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1366, in _build_instance\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    filter_properties, bdms, legacy_bdm_in_spec)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1412, in _reschedule_or_error\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    self._log_original_error(exc_info, instance_uuid)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 68, in __exit__\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    six.reraise(self.type_, self.value, self.tb)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 1407, in _reschedule_or_error\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    bdms, requested_networks)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 2136, in _shutdown_instance\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    requested_networks)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/openstack/common/excutils.py\", line 68, in __exit__\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    six.reraise(self.type_, self.value, self.tb)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/compute/manager.py\", line 2126, in _shutdown_instance\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    block_device_info)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 656, in destroy\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    _vmops = self._get_vmops_for_compute_node(instance['node'])\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 544, in _get_vmops_for_compute_node\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    resource = self._get_resource_for_node(nodename)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m  File \"/opt/stack/nova/nova/virt/vmwareapi/driver.py\", line 536, in _get_resource_for_node\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00m    raise exception.NotFound(msg)\n\u001b[00;32m2014-04-06 22:48:52.664 TRACE nova.compute.utils \u001b[01;35m[instance: 1deeb6c0-ed7f-4f5a-bdcc-97765803d18b] \u001b[00mNotFound: The resource None does not exist", 
            "date_created": "2014-04-14 09:59:32.510441+00:00", 
            "author": "https://api.launchpad.net/1.0/~sagar-r-nikam"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/87894", 
            "date_created": "2014-04-16 09:49:17.940672+00:00", 
            "author": "https://api.launchpad.net/1.0/~openstack-gerrit"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/87894\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=aadfffaaa69c6a8939f6c88cfbaeb026c7604163\nSubmitter: Jenkins\nBranch:    master\n\ncommit aadfffaaa69c6a8939f6c88cfbaeb026c7604163\nAuthor: Sagar Ratnakara Nikam <email address hidden>\nDate:   Wed Apr 16 14:29:51 2014 +0530\n\n    VMWare - Check for compute node before triggering destroy\n    \n    While booting an instance, if Claim on that compute node is not successful\n    compute manager triggers a call to destroy instance. Destroy fails since the\n    compute node (Cluster/ESX host) is set only after claim is successful.\n    Hence the check for node is made before destroy, to ensure that exception\n    does not get thrown. This ensures that the instance gets rescheduled\n    Closes-Bug: #1307408\n    \n    Change-Id: Iaaf931e9c1e6cf046497e2c64952f92e802ad4be\n", 
            "date_created": "2014-04-24 14:53:46.682542+00:00", 
            "author": "https://api.launchpad.net/1.0/~openstack-gerrit"
        }, 
        {
            "content": "Fix proposed to branch: stable/icehouse\nReview: https://review.openstack.org/92135", 
            "date_created": "2014-05-05 15:04:58.439563+00:00", 
            "author": "https://api.launchpad.net/1.0/~openstack-gerrit"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/92135\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=422decdc7eeb1a170ebff3197f9115e58f4f89b4\nSubmitter: Jenkins\nBranch:    stable/icehouse\n\ncommit 422decdc7eeb1a170ebff3197f9115e58f4f89b4\nAuthor: Sagar Ratnakara Nikam <email address hidden>\nDate:   Wed Apr 16 14:29:51 2014 +0530\n\n    VMWare - Check for compute node before triggering destroy\n    \n    While booting an instance, if Claim on that compute node is not successful\n    compute manager triggers a call to destroy instance. Destroy fails since the\n    compute node (Cluster/ESX host) is set only after claim is successful.\n    Hence the check for node is made before destroy, to ensure that exception\n    does not get thrown. This ensures that the instance gets rescheduled\n    Closes-Bug: #1307408\n    \n    Change-Id: Iaaf931e9c1e6cf046497e2c64952f92e802ad4be\n    (cherry picked from commit aadfffaaa69c6a8939f6c88cfbaeb026c7604163)\n", 
            "date_created": "2014-05-31 22:11:15.615859+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2014-06-11 13:42:20.317302+00:00"
}