{
    "status": "Invalid", 
    "last_updated": "2016-01-26 05:06:58.286981+00:00", 
    "description": "[Impact]\n\n\u00a0* cpu features list which is being sent to libvirt,\n\u00a0when creating a domain or calling compareCPU, must contain only\n\u00a0unique entries. Multiple issues arise when we are updating the\n\u00a0features attribute in LibvirtConfigCPU class (for example during\n\u00a0migration).\n\n[Test Case]\n\n* A two node openstack havana on ubuntu 14.04. Migrating a instance to other node.\n\n - Migrate the instance\n - Observe /var/log/nova/compute.log and /var/log/libvirt.log.\n - /var/log/libvirtd.log: 2014-03-27 18:23:17.141+0000: 2659: error : virCPUDefParseXML:413 : XML error: CPU feature `wdt' specified more than once.\n\n[Regression Potential]\n\n * Same fix for 1303536 applied to Icehouse. \n\n\u00a0* Fix is running in a big production without any problem.\n\n\u00a0* A regression would continue to cause nova not to start (as is happening\n\u00a0\u00a0\u00a0today with this bug) under described conditions.\n\n[Other Info]\n\n--------------------------------------------\nOriginal Description (Clone of a Fedora Bug)\n--------------------------------------------\n\nRestarting openstack-nova-compute serivce fails with:\n\n\u00a0\u00a0libvirtError: internal error: CPU feature `avx' specified more than once\n\nVersion\n---------\n\n\u00a0\u00a0\u00a0\u00a0$ rpm -q openstack-nova libvirt qemu-system-x86\n\u00a0\u00a0\u00a0\u00a0openstack-nova-2014.1-0.4.b1.fc21.noarch\n\u00a0\u00a0\u00a0\u00a0libvirt-1.1.3.2-1.fc20.x86_64\n\u00a0\u00a0\u00a0\u00a0qemu-system-x86-1.6.1-3.fc20.x86_64\n\nTest env\n----------\n\nA two node OpenStack RDO set-up configured manually on two Fedora 20\nVMs:\n\n\u00a0\u00a0- Controller node: Nova, Keystone, Cinder, Glance, Neutron (using Open\n\u00a0\u00a0\u00a0\u00a0vSwitch plugin and GRE tunneling).\n\n\u00a0\u00a0- Compute node: Nova (nova-compute), Neutron (openvswitch-agent)\n\nHow reproducible: Consistently.\n\nSteps to Reproduce\n------------------\n\n\u00a0\u00a0\u00a0\u00a0$ systemctl restart openstack-nova-compute\n\nObserve /var/log/nova/compute.log\n\nActual results\n--------------\n\n$ tail -f /var/log/nova/compute.log\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 187, in doit\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 147, in proxy_call\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     rv = execute(f,*args,**kwargs)\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 76, in tworker\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     rv = meth(*args,**kwargs)\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 3622, in baselineCPU\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     if ret is None: raise libvirtError ('virConnectBaselineCPU() failed', conn=self)\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup libvirtError: internal error: CPU feature `avx' specified more than once\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup\n\nExpected results\n----------------\n\nCompute service should start successfully.\n\nAdditional info\n---------------\n\nStatus of openstack-nova-compute service\n\n$ systemctl status openstack-nova-compute\nopenstack-nova-compute.service - OpenStack Nova Compute Server\n\u00a0\u00a0\u00a0Loaded: loaded (/usr/lib/systemd/system/openstack-nova-compute.service; enabled)\n\u00a0\u00a0\u00a0Active: inactive (dead) since Tue 2014-01-08 07:00:07 EST; 13min ago\n\u00a0\u00a0Process: 1529 ExecStart=/usr/bin/nova-compute --logfile /var/log/nova/compute.log (code=exited, status=0/SUCCESS)\n\u00a0Main PID: 1529 (code=exited, status=0/SUCCESS)\n\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/pyth...in doit\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     result = proxy_ca...kwargs)\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/pyth...xy_call\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     rv = execute(f,*a...kwargs)\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/pyth...tworker\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     rv = meth(*args,**kwargs)\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/py...lineCPU\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     if ret is None: r...n=self)\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup libvirtError: interna...an once\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup\n\n[reply] [\u2212]\nPrivate\nComment 1 Kashyap Chamarthy 2014-01-08 09:21:17 EST\n\nMore contextual trace from compute.log:\n\n[. . .]\n2014-12-10 22:12:38.789 1429 TRACE nova.virt.libvirt.driver\n2014-12-10 22:12:39.319 1429 ERROR nova.openstack.common.threadgroup [-] internal error: CPU feature `avx' specified more than once\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/threadgroup.py\", line 117, in wait\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     x.wait()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/threadgroup.py\", line 49, in wait\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 168, in wait\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/event.py\", line 116, in wait\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 187, in switch\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 194, in main\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     result = function(*args, **kwargs)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/service.py\", line 448, in run_service\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     service.start()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/service.py\", line 164, in start\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     self.manager.pre_start_hook()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 822, in pre_start_hook\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     self.update_available_resource(nova.context.get_admin_context())\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 4971, in update_available_resource\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     nodenames = set(self.driver.get_available_nodes())\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/driver.py\", line 980, in get_available_nodes\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     stats = self.get_host_stats(refresh=refresh)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4569, in get_host_stats\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     return self.host_state.get_host_stats(refresh=refresh)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 429, in host_state\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     self._host_state = HostState(self)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4960, in __init__\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     self.update_status()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4999, in update_status\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     self.driver.get_instance_capabilities()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 3702, in get_instance_capabilities\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     caps = self.get_host_capabilities()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2742, in get_host_capabilities\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     libvirt.VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 187, in doit\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 147, in proxy_call\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     rv = execute(f,*args,**kwargs)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 76, in tworker\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     rv = meth(*args,**kwargs)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 3622, in baselineCPU\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     if ret is None: raise libvirtError ('virConnectBaselineCPU() failed', conn=self)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup libvirtError: internal error: CPU feature `avx' specified more than once\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup\n2014-12-10 22:12:58.904 1467 WARNING nova.virt.libvirt.driver [req-88723bba-e677-4956-9b70-1f7fe66dbff7 None None] Cannot update service status on host: node2-compute,due to an unexpected exception.\n[. . .]", 
    "tags": [
        "libvirt", 
        "libvirt1x", 
        "verification-done"
    ], 
    "importance": "Undecided", 
    "heat": 34, 
    "link": "https://bugs.launchpad.net/nova/+bug/1267191", 
    "owner": "None", 
    "id": 1267191, 
    "index": 5718, 
    "openned": "2014-01-08 17:38:14.038835+00:00", 
    "created": "2014-01-08 17:38:14.038835+00:00", 
    "title": "openstack-nova-compute service fails with - libvirtError: internal error: CPU feature `avx' specified more than once", 
    "comments": [
        {
            "content": "Description of problem\n---------------------------\n\nRestarting openstack-nova-compute serivce fails with:\n\n  libvirtError: internal error: CPU feature `avx' specified more than once\n\nVersion\n---------\n\n    $ rpm -q openstack-nova libvirt qemu-system-x86\n    openstack-nova-2014.1-0.4.b1.fc21.noarch\n    libvirt-1.1.3.2-1.fc20.x86_64\n    qemu-system-x86-1.6.1-3.fc20.x86_64\n\n\nTest env\n----------\n\nA two node OpenStack RDO set-up configured manually on two Fedora 20\nVMs:\n\n  - Controller node: Nova, Keystone, Cinder, Glance, Neutron (using Open\n    vSwitch plugin and GRE tunneling).\n\n  - Compute node: Nova (nova-compute), Neutron (openvswitch-agent)\n\n\nHow reproducible: Consistently.\n\n\nSteps to Reproduce\n------------------\n\n    $ systemctl restart openstack-nova-compute\n\nObserve /var/log/nova/compute.log\n\n\nActual results \n--------------\n\n\n$ tail -f /var/log/nova/compute.log\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 187, in doit\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 147, in proxy_call\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     rv = execute(f,*args,**kwargs)\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 76, in tworker\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     rv = meth(*args,**kwargs)\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 3622, in baselineCPU\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     if ret is None: raise libvirtError ('virConnectBaselineCPU() failed', conn=self)\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup libvirtError: internal error: CPU feature `avx' specified more than once\n2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup \n\n\nExpected results\n----------------\n\nCompute service should start successfully.\n\nAdditional info\n---------------\n\nStatus of openstack-nova-compute service\n\n$ systemctl status openstack-nova-compute\nopenstack-nova-compute.service - OpenStack Nova Compute Server\n   Loaded: loaded (/usr/lib/systemd/system/openstack-nova-compute.service; enabled)\n   Active: inactive (dead) since Tue 2014-01-08 07:00:07 EST; 13min ago\n  Process: 1529 ExecStart=/usr/bin/nova-compute --logfile /var/log/nova/compute.log (code=exited, status=0/SUCCESS)\n Main PID: 1529 (code=exited, status=0/SUCCESS)\n\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/pyth...in doit\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     result = proxy_ca...kwargs)\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/pyth...xy_call\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     rv = execute(f,*a...kwargs)\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/pyth...tworker\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     rv = meth(*args,**kwargs)\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/py...lineCPU\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup     if ret is None: r...n=self)\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup libvirtError: interna...an once\nJan 07 07:00:07 node2-compute nova-compute[1529]: 2014-01-08 07:00:07.200 1529 TRACE nova.openstack.common.threadgroup\n\n[reply] [\u2212]\nPrivate\nComment 1 Kashyap Chamarthy 2014-01-08 09:21:17 EST\n\nMore contextual trace from compute.log:\n\n[. . .]\n2014-12-10 22:12:38.789 1429 TRACE nova.virt.libvirt.driver \n2014-12-10 22:12:39.319 1429 ERROR nova.openstack.common.threadgroup [-] internal error: CPU feature `avx' specified more than once\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup Traceback (most recent call last):\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/threadgroup.py\", line 117, in wait\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     x.wait()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/threadgroup.py\", line 49, in wait\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     return self.thread.wait()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 168, in wait\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     return self._exit_event.wait()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/event.py\", line 116, in wait\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     return hubs.get_hub().switch()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/hubs/hub.py\", line 187, in switch\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     return self.greenlet.switch()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/greenthread.py\", line 194, in main\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     result = function(*args, **kwargs)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/service.py\", line 448, in run_service\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     service.start()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/service.py\", line 164, in start\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     self.manager.pre_start_hook()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 822, in pre_start_hook\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     self.update_available_resource(nova.context.get_admin_context())\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 4971, in update_available_resource\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     nodenames = set(self.driver.get_available_nodes())\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/driver.py\", line 980, in get_available_nodes\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     stats = self.get_host_stats(refresh=refresh)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4569, in get_host_stats\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     return self.host_state.get_host_stats(refresh=refresh)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 429, in host_state\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     self._host_state = HostState(self)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4960, in __init__\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     self.update_status()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 4999, in update_status\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     self.driver.get_instance_capabilities()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 3702, in get_instance_capabilities\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     caps = self.get_host_capabilities()\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 2742, in get_host_capabilities\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     libvirt.VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 187, in doit\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 147, in proxy_call\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     rv = execute(f,*args,**kwargs)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib/python2.7/site-packages/eventlet/tpool.py\", line 76, in tworker\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     rv = meth(*args,**kwargs)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 3622, in baselineCPU\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup     if ret is None: raise libvirtError ('virConnectBaselineCPU() failed', conn=self)\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup libvirtError: internal error: CPU feature `avx' specified more than once\n2014-12-10 22:12:39.319 1429 TRACE nova.openstack.common.threadgroup \n2014-12-10 22:12:58.904 1467 WARNING nova.virt.libvirt.driver [req-88723bba-e677-4956-9b70-1f7fe66dbff7 None None] Cannot update service status on host: node2-compute,due to an unexpected exception.\n[. . .]", 
            "date_created": "2014-01-08 17:38:14.038835+00:00", 
            "author": "https://api.launchpad.net/1.0/~kashyapc"
        }, 
        {
            "content": "This is a clone of -- Fedora/RDO related bug -- https://bugzilla.redhat.com/show_bug.cgi?id=1049391", 
            "date_created": "2014-01-08 18:06:59.384613+00:00", 
            "author": "https://api.launchpad.net/1.0/~kashyapc"
        }, 
        {
            "content": "With a stock Fedora 20 environment and using devstack with the latest upstream OpenStack components, I see something very similar, basically the same error with a different CPU flag. See the paste here:\n\nhttp://paste.openstack.org/show/61278/", 
            "date_created": "2014-01-15 22:14:23.468648+00:00", 
            "author": "https://api.launchpad.net/1.0/~mestery"
        }, 
        {
            "content": "As pastebins expire, posting the actual error & CPU flag Kyle is seeing:\n\n[. . .]\n2014-01-15 09:33:56.530 20957 TRACE nova.openstack.common.threadgroup   File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 3622, in baselineCPU\n2014-01-15 09:33:56.530 20957 TRACE nova.openstack.common.threadgroup     if ret is None: raise libvirtError ('virConnectBaselineCPU() failed', conn=self)\n2014-01-15 09:33:56.530 20957 TRACE nova.openstack.common.threadgroup libvirtError: internal error: CPU feature `tsc-deadline' specified more than once\n2014-01-15 09:33:56.530 20957 TRACE nova.openstack.common.threadgroup \n[. . .]\n\nAlso, in the referenced downstream bug, another reporter (Attila Fazekas) mentioned a different CPU flag:\n\n[. . .]\n  File \"/usr/lib64/python2.7/site-packages/libvirt.py\", line 3622, in baselineCPU\n    if ret is None: raise libvirtError ('virConnectBaselineCPU() failed', conn=self)\nlibvirt.libvirtError: internal error: CPU feature `rdtscp' specified more than once\n[. . .]\n", 
            "date_created": "2014-01-16 08:01:17.828007+00:00", 
            "author": "https://api.launchpad.net/1.0/~kashyapc"
        }, 
        {
            "content": "Could you please also post: /proc/cpuinfo  and virsh capabilities\n\nThanks.", 
            "date_created": "2014-01-16 15:15:39.352028+00:00", 
            "author": "https://api.launchpad.net/1.0/~vladik-romanovsky"
        }, 
        {
            "content": "https://bugzilla.redhat.com/show_bug.cgi?id=1049391#c11 points at a possible libvirtd bug ", 
            "date_created": "2014-01-17 19:25:45.564954+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "@Vladic, I should note that I was running in an Nested Virtualization (KVM on KVM, Intel) environment.\n\nHere we go, from Compute host (which is a guest-hypervisor, running Fedora 20):\n\n1. /proc/cpuinfo:\n\n    $ cat /proc/cpuinfo  | head -25\nprocessor       : 0\nvendor_id       : GenuineIntel\ncpu family      : 6\nmodel           : 42\nmodel name      : Intel Xeon E312xx (Sandy Bridge)\nstepping        : 1\nmicrocode       : 0x1\ncpu MHz         : 1864.644\ncache size      : 4096 KB\nphysical id     : 0\nsiblings        : 1\ncore id         : 0\ncpu cores       : 1\napicid          : 0\ninitial apicid  : 0\nfpu             : yes\nfpu_exception   : yes\ncpuid level     : 13\nwp              : yes\nflags           : fpu vme de pse tsc msr pae mce cx8 apic sep mtrr pge mca cmov pat pse36 clflush mmx fxsr sse sse2 ss syscall nx pdpe1gb rdtscp lm constant_tsc rep_good nopl pni pclmulqdq vmx ssse3 cx16 pcid sse4_1 sse4_2 x2apic popcnt aes hypervisor lahf_lm\nbogomips        : 3729.28\nclflush size    : 64\ncache_alignment : 64\naddress sizes   : 40 bits physical, 48 bits virtual\n-------------\n\n2. And, capabilities of driver (libvirt/KVM):\n\n    $ virsh capabilities\n<capabilities>\n\n  <host>\n    <uuid>26eededc-a845-48e8-998d-86bb14a89bbf</uuid>\n    <cpu>\n      <arch>x86_64</arch>\n      <model>Westmere</model>\n      <vendor>Intel</vendor>\n      <topology sockets='20' cores='1' threads='1'/>\n      <feature name='rdtscp'/>\n      <feature name='pdpe1gb'/>\n      <feature name='hypervisor'/>\n      <feature name='x2apic'/>\n      <feature name='pcid'/>\n      <feature name='vmx'/>\n      <feature name='pclmuldq'/>\n      <feature name='ss'/>\n      <feature name='vme'/>\n    </cpu>\n    <power_management>\n      <suspend_disk/>\n      <suspend_hybrid/>\n    </power_management>\n    <migration_features>\n      <live/>\n      <uri_transports>\n        <uri_transport>tcp</uri_transport>\n      </uri_transports>\n    </migration_features>\n    <topology>\n      <cells num='1'>\n        <cell id='0'>\n          <memory unit='KiB'>19092304</memory>\n          <cpus num='20'>\n            <cpu id='0' socket_id='0' core_id='0' siblings='0'/>\n            <cpu id='1' socket_id='1' core_id='0' siblings='1'/>\n            <cpu id='2' socket_id='2' core_id='0' siblings='2'/>\n            <cpu id='3' socket_id='3' core_id='0' siblings='3'/>\n            <cpu id='4' socket_id='4' core_id='0' siblings='4'/>\n            <cpu id='5' socket_id='5' core_id='0' siblings='5'/>\n            <cpu id='6' socket_id='6' core_id='0' siblings='6'/>\n            <cpu id='7' socket_id='7' core_id='0' siblings='7'/>\n            <cpu id='8' socket_id='8' core_id='0' siblings='8'/>\n            <cpu id='9' socket_id='9' core_id='0' siblings='9'/>\n            <cpu id='10' socket_id='10' core_id='0' siblings='10'/>\n            <cpu id='11' socket_id='11' core_id='0' siblings='11'/>\n            <cpu id='12' socket_id='12' core_id='0' siblings='12'/>\n            <cpu id='13' socket_id='13' core_id='0' siblings='13'/>\n            <cpu id='14' socket_id='14' core_id='0' siblings='14'/>\n            <cpu id='15' socket_id='15' core_id='0' siblings='15'/>\n            <cpu id='16' socket_id='16' core_id='0' siblings='16'/>\n            <cpu id='17' socket_id='17' core_id='0' siblings='17'/>\n            <cpu id='18' socket_id='18' core_id='0' siblings='18'/>\n            <cpu id='19' socket_id='19' core_id='0' siblings='19'/>\n          </cpus>\n        </cell>\n      </cells>\n    </topology>\n    <secmodel>\n      <model>selinux</model>\n      <doi>0</doi>\n    </secmodel>\n    <secmodel>\n      <model>dac</model>\n      <doi>0</doi>\n    </secmodel>\n  </host>\n\n  <guest>\n    <os_type>hvm</os_type>\n    <arch name='i686'>\n      <wordsize>32</wordsize>\n      <emulator>/usr/bin/qemu-system-i386</emulator>\n      <machine canonical='pc-i440fx-1.6' maxCpus='255'>pc</machine>\n      <machine maxCpus='255'>pc-q35-1.4</machine>\n      <machine maxCpus='255'>pc-q35-1.5</machine>\n      <machine canonical='pc-q35-1.6' maxCpus='255'>q35</machine>\n      <machine maxCpus='1'>isapc</machine>\n      <machine maxCpus='255'>pc-0.10</machine>\n      <machine maxCpus='255'>pc-0.11</machine>\n      <machine maxCpus='255'>pc-0.12</machine>\n      <machine maxCpus='255'>pc-0.13</machine>\n      <machine maxCpus='255'>pc-0.14</machine>\n      <machine maxCpus='255'>pc-0.15</machine>\n      <machine maxCpus='255'>pc-1.0</machine>\n      <machine maxCpus='255'>pc-1.1</machine>\n      <machine maxCpus='255'>pc-1.2</machine>\n      <machine maxCpus='255'>pc-1.3</machine>\n      <machine maxCpus='255'>pc-i440fx-1.4</machine>\n      <machine maxCpus='255'>pc-i440fx-1.5</machine>\n      <machine maxCpus='1'>none</machine>\n      <domain type='qemu'>\n      </domain>\n      <domain type='kvm'>\n        <emulator>/usr/bin/qemu-kvm</emulator>\n        <machine canonical='pc-i440fx-1.6' maxCpus='255'>pc</machine>\n        <machine maxCpus='255'>pc-q35-1.4</machine>\n        <machine maxCpus='255'>pc-q35-1.5</machine>\n        <machine canonical='pc-q35-1.6' maxCpus='255'>q35</machine>\n        <machine maxCpus='1'>isapc</machine>\n        <machine maxCpus='255'>pc-0.10</machine>\n        <machine maxCpus='255'>pc-0.11</machine>\n        <machine maxCpus='255'>pc-0.12</machine>\n        <machine maxCpus='255'>pc-0.13</machine>\n        <machine maxCpus='255'>pc-0.14</machine>\n        <machine maxCpus='255'>pc-0.15</machine>\n        <machine maxCpus='255'>pc-1.0</machine>\n        <machine maxCpus='255'>pc-1.1</machine>\n        <machine maxCpus='255'>pc-1.2</machine>\n        <machine maxCpus='255'>pc-1.3</machine>\n        <machine maxCpus='255'>pc-i440fx-1.4</machine>\n        <machine maxCpus='255'>pc-i440fx-1.5</machine>\n        <machine maxCpus='1'>none</machine>\n      </domain>\n    </arch>\n    <features>\n      <cpuselection/>\n      <deviceboot/>\n      <acpi default='on' toggle='yes'/>\n      <apic default='on' toggle='no'/>\n      <pae/>\n      <nonpae/>\n    </features>\n  </guest>\n\n  <guest>\n    <os_type>hvm</os_type>\n    <arch name='x86_64'>\n      <wordsize>64</wordsize>\n      <emulator>/usr/bin/qemu-system-x86_64</emulator>\n      <machine canonical='pc-i440fx-1.6' maxCpus='255'>pc</machine>\n      <machine maxCpus='255'>pc-q35-1.4</machine>\n      <machine maxCpus='255'>pc-q35-1.5</machine>\n      <machine canonical='pc-q35-1.6' maxCpus='255'>q35</machine>\n      <machine maxCpus='1'>isapc</machine>\n      <machine maxCpus='255'>pc-0.10</machine>\n      <machine maxCpus='255'>pc-0.11</machine>\n      <machine maxCpus='255'>pc-0.12</machine>\n      <machine maxCpus='255'>pc-0.13</machine>\n      <machine maxCpus='255'>pc-0.14</machine>\n      <machine maxCpus='255'>pc-0.15</machine>\n      <machine maxCpus='255'>pc-1.0</machine>\n      <machine maxCpus='255'>pc-1.1</machine>\n      <machine maxCpus='255'>pc-1.2</machine>\n      <machine maxCpus='255'>pc-1.3</machine>\n      <machine maxCpus='255'>pc-i440fx-1.4</machine>\n      <machine maxCpus='255'>pc-i440fx-1.5</machine>\n      <machine maxCpus='1'>none</machine>\n      <domain type='qemu'>\n      </domain>\n      <domain type='kvm'>\n        <emulator>/usr/bin/qemu-kvm</emulator>\n        <machine canonical='pc-i440fx-1.6' maxCpus='255'>pc</machine>\n        <machine maxCpus='255'>pc-q35-1.4</machine>\n        <machine maxCpus='255'>pc-q35-1.5</machine>\n        <machine canonical='pc-q35-1.6' maxCpus='255'>q35</machine>\n        <machine maxCpus='1'>isapc</machine>\n        <machine maxCpus='255'>pc-0.10</machine>\n        <machine maxCpus='255'>pc-0.11</machine>\n        <machine maxCpus='255'>pc-0.12</machine>\n        <machine maxCpus='255'>pc-0.13</machine>\n        <machine maxCpus='255'>pc-0.14</machine>\n        <machine maxCpus='255'>pc-0.15</machine>\n        <machine maxCpus='255'>pc-1.0</machine>\n        <machine maxCpus='255'>pc-1.1</machine>\n        <machine maxCpus='255'>pc-1.2</machine>\n        <machine maxCpus='255'>pc-1.3</machine>\n        <machine maxCpus='255'>pc-i440fx-1.4</machine>\n        <machine maxCpus='255'>pc-i440fx-1.5</machine>\n        <machine maxCpus='1'>none</machine>\n      </domain>\n    </arch>\n    <features>\n      <cpuselection/>\n      <deviceboot/>\n      <acpi default='on' toggle='yes'/>\n      <apic default='on' toggle='no'/>\n    </features>\n  </guest>\n\n</capabilities>\n\n\n\n", 
            "date_created": "2014-01-23 15:15:56.732366+00:00", 
            "author": "https://api.launchpad.net/1.0/~kashyapc"
        }, 
        {
            "content": "Also, a Libvirt developer on the downstream bug (mentioned above & here):\n\n  https://bugzilla.redhat.com/show_bug.cgi?id=1049391#c11\n\nsays:\n\n  \"this is apparently a bug in libvirtd code that handles VIR_CONNECT_BASELINE_CPU_EXPAND_FEATURES.\"", 
            "date_created": "2014-01-23 15:22:48.155926+00:00", 
            "author": "https://api.launchpad.net/1.0/~kashyapc"
        }, 
        {
            "content": "Update:\n\ntl;dr -- Fix for this (libvirt bug) is committed in upstream; available from this libvirt version of Fedora -- libvirt-1.1.3.3-4.fc20\n\nUpstream libvirt bug fix -- https://www.redhat.com/archives/libvir-list/2014-January/msg01314.html\n\nTest\n-----\n\n1. Stop all OpenStack services (on both Controller and Compute nodes)\n\n    $ openstack-service stop   \n\n2. Update to libvirt RPMs, version -- libvirt-1.1.3.3-4.fc20\n\n3. Restart Libvirt on Compute node:\n\n    $ systemctl restart libvirtd\n\n4. Restart OpenStack Nova compute (it should come up successfully)\n\n    $ systemctl status openstack-nova-compute -l\nopenstack-nova-compute.service - OpenStack Nova Compute Server\n   Loaded: loaded (/usr/lib/systemd/system/openstack-nova-compute.service; enabled)\n   Active: active (running) since Tue 2014-01-28 06:50:10 EST; 2s ago\n Main PID: 2482 (nova-compute)\n   CGroup: /system.slice/openstack-nova-compute.service\n           \u2514\u25002482 /usr/bin/python /usr/bin/nova-compute --logfile /var/log/nova/compute.log\n\nJan 28 06:50:10 node2-compute systemd[1]: Started OpenStack Nova Compute Server.$ openstack-service stop   \n\nJan 28 06:50:10 node2-compute systemd[1]: Started OpenStack Nova Compute Server.", 
            "date_created": "2014-02-03 11:19:33.686704+00:00", 
            "author": "https://api.launchpad.net/1.0/~kashyapc"
        }, 
        {
            "content": "Hmm, just wondering. . .\n\nIdeally, these kind of bugs  under the hood technologies that affect OpenStack could be closed as reason  -- \"CLOSED, UPSTREAM\"\n\nBut, closing it as \"Fix Committed\" is a misleading -- as there's no actual fix committed in openstack-nova. \n\nSo, closing it as \"Invalid, Not a bug\" (technically, this is right -- as it's not a Nova bug; but a bug in libvirt that _affected_ Nova).\n", 
            "date_created": "2014-02-03 16:44:27.287425+00:00", 
            "author": "https://api.launchpad.net/1.0/~kashyapc"
        }, 
        {
            "content": "Here goes my SRU proposal:\n\nnova (1:2014.1.1-0ubuntu2) trusty; urgency=high\n\n  * Cherry picked two fixes from upstream.\n    - [2cebfd2] libvirt: convert cpu features attribute from list to a set (LP: #1267191)\n    - [b86a0e5] Fixes rdb backend image size (LP: #1219658)\n\nI've created a hotfix from 1:2014.1.1-0ubuntu1 (already in -proposed) for some other uses. \n\nSince I'm creating 1 fix for 2 bugs, please take a look at url bellow for debdiff:\n\nhttps://bugs.launchpad.net/nova/+bug/1219658 ", 
            "date_created": "2014-06-26 13:56:56.382858+00:00", 
            "author": "https://api.launchpad.net/1.0/~inaddy"
        }, 
        {
            "content": "Hello Kashyap, or anyone else affected,\n\nAccepted nova into trusty-proposed. The package will build now and be available at http://launchpad.net/ubuntu/+source/nova/1:2014.1.1-0ubuntu2 in a few hours, and then in the -proposed repository.\n\nPlease help us by testing this new package.  See https://wiki.ubuntu.com/Testing/EnableProposed for documentation how to enable and use -proposed.  Your feedback will aid us getting this update out to other Ubuntu users.\n\nIf this package fixes the bug for you, please add a comment to this bug, mentioning the version of the package you tested, and change the tag from verification-needed to verification-done. If it does not fix the bug for you, please add a comment stating that, and change the tag to verification-failed.  In either case, details of your testing will help us make a better decision.\n\nFurther information regarding the verification process can be found at https://wiki.ubuntu.com/QATeam/PerformingSRUVerification .  Thank you in advance!", 
            "date_created": "2014-07-29 16:10:19.794239+00:00", 
            "author": "https://api.launchpad.net/1.0/~arges"
        }, 
        {
            "content": "Changed this to verification-done because since this SRU proposal this has been running in a big server farm without any issues or regressions.", 
            "date_created": "2014-08-06 17:50:41.293642+00:00", 
            "author": "https://api.launchpad.net/1.0/~inaddy"
        }, 
        {
            "content": "The verification of the Stable Release Update for nova has completed successfully and the package has now been released to -updates.  Subsequently, the Ubuntu Stable Release Updates Team is being unsubscribed and will not receive messages about this bug report.  In the event that you encounter a regression using the package from -updates please report a new bug using ubuntu-bug and tag the bug report regression-update so we can easily find any regressions.", 
            "date_created": "2014-08-06 19:22:13.481910+00:00", 
            "author": "https://api.launchpad.net/1.0/~kitterman"
        }, 
        {
            "content": "This bug was fixed in the package nova - 1:2014.1.1-0ubuntu2\n\n---------------\nnova (1:2014.1.1-0ubuntu2) trusty; urgency=high\n\n  * Cherry picked two fixes from upstream.\n    - [2cebfd2] libvirt: convert cpu features attribute from list to a set (LP: #1267191)\n    - [b86a0e5] Fixes rdb backend image size (LP: #1219658)\n -- Rafael David Tinoco <email address hidden>   Wed, 25 Jun 2014 12:56:15 -0300", 
            "date_created": "2014-08-06 19:27:23.506407+00:00", 
            "author": "https://api.launchpad.net/1.0/~janitor"
        }
    ], 
    "closed": "2014-02-03 16:44:31.676990+00:00"
}