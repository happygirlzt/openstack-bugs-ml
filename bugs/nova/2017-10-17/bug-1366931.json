{
    "status": "Invalid", 
    "last_updated": "2016-04-11 08:09:46.737136+00:00", 
    "description": "http://logs.openstack.org/41/116741/5/gate/gate-grenade-dsvm/7064ee5/logs/old/screen-n-cpu.txt.gz?level=TRACE#_2014-09-07_02_27_10_408\n\nLibvirt stacktrace in n-cpu:\n\n\u00a0Traceback (most recent call last):\n\u00a0\u00a0\u00a0File \"/opt/stack/old/nova/nova/compute/manager.py\", line 1329, in _build_instance\n\u00a0\u00a0\u00a0\u00a0\u00a0set_access_ip=set_access_ip)\n\u00a0\u00a0\u00a0File \"/opt/stack/old/nova/nova/compute/manager.py\", line 393, in decorated_function\n\u00a0\u00a0\u00a0\u00a0\u00a0return function(self, context, *args, **kwargs)\n\u00a0\u00a0\u00a0File \"/opt/stack/old/nova/nova/compute/manager.py\", line 1741, in _spawn\n\u00a0\u00a0\u00a0\u00a0\u00a0LOG.exception(_('Instance failed to spawn'), instance=instance)\n\u00a0\u00a0\u00a0File \"/opt/stack/old/nova/nova/openstack/common/excutils.py\", line 68, in __exit__\n\u00a0\u00a0\u00a0\u00a0\u00a0six.reraise(self.type_, self.value, self.tb)\n\u00a0\u00a0\u00a0File \"/opt/stack/old/nova/nova/compute/manager.py\", line 1738, in _spawn\n\u00a0\u00a0\u00a0\u00a0\u00a0block_device_info)\n\u00a0\u00a0\u00a0File \"/opt/stack/old/nova/nova/virt/libvirt/driver.py\", line 2286, in spawn\n\u00a0\u00a0\u00a0\u00a0\u00a0block_device_info)\n\u00a0\u00a0\u00a0File \"/opt/stack/old/nova/nova/virt/libvirt/driver.py\", line 3686, in _create_domain_and_network\n\u00a0\u00a0\u00a0\u00a0\u00a0power_on=power_on)\n\u00a0\u00a0\u00a0File \"/opt/stack/old/nova/nova/virt/libvirt/driver.py\", line 3588, in _create_domain\n\u00a0\u00a0\u00a0\u00a0\u00a0domain.XMLDesc(0))\n\u00a0\u00a0\u00a0File \"/opt/stack/old/nova/nova/openstack/common/excutils.py\", line 68, in __exit__\n\u00a0\u00a0\u00a0\u00a0\u00a0six.reraise(self.type_, self.value, self.tb)\n\u00a0\u00a0\u00a0File \"/opt/stack/old/nova/nova/virt/libvirt/driver.py\", line 3583, in _create_domain\n\u00a0\u00a0\u00a0\u00a0\u00a0domain.createWithFlags(launch_flags)\n\u00a0\u00a0\u00a0File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 179, in doit\n\u00a0\u00a0\u00a0\u00a0\u00a0result = proxy_call(self._autowrap, f, *args, **kwargs)\n\u00a0\u00a0\u00a0File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 139, in proxy_call\n\u00a0\u00a0\u00a0\u00a0\u00a0rv = execute(f,*args,**kwargs)\n\u00a0\u00a0\u00a0File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 77, in tworker\n\u00a0\u00a0\u00a0\u00a0\u00a0rv = meth(*args,**kwargs)\n\u00a0\u00a0\u00a0File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 896, in createWithFlags\n\u00a0\u00a0\u00a0\u00a0\u00a0if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n\u00a0libvirtError: internal error: process exited while connecting to monitor: Cannot set up guest memory 'pc.ram': Cannot allocate memory\n\nquery: message:\"Cannot set up guest memory 'pc.ram': Cannot allocate memory\" AND tags:\"screen-n-cpu.txt\"  AND  tags:\"multiline\"", 
    "tags": [], 
    "importance": "High", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1366931", 
    "owner": "https://api.launchpad.net/1.0/~treinish", 
    "id": 1366931, 
    "index": 1600, 
    "openned": "2014-09-08 18:57:50.129735+00:00", 
    "created": "2014-09-08 18:57:50.129735+00:00", 
    "title": "libvirtError: internal error: process exited while connecting to monitor: Cannot set up guest memory 'pc.ram': Cannot allocate memory", 
    "comments": [
        {
            "content": "http://logs.openstack.org/41/116741/5/gate/gate-grenade-dsvm/7064ee5/logs/old/screen-n-cpu.txt.gz?level=TRACE#_2014-09-07_02_27_10_408\n\nLibvirt stacktrace in n-cpu:\n\n Traceback (most recent call last):\n   File \"/opt/stack/old/nova/nova/compute/manager.py\", line 1329, in _build_instance\n     set_access_ip=set_access_ip)\n   File \"/opt/stack/old/nova/nova/compute/manager.py\", line 393, in decorated_function\n     return function(self, context, *args, **kwargs)\n   File \"/opt/stack/old/nova/nova/compute/manager.py\", line 1741, in _spawn\n     LOG.exception(_('Instance failed to spawn'), instance=instance)\n   File \"/opt/stack/old/nova/nova/openstack/common/excutils.py\", line 68, in __exit__\n     six.reraise(self.type_, self.value, self.tb)\n   File \"/opt/stack/old/nova/nova/compute/manager.py\", line 1738, in _spawn\n     block_device_info)\n   File \"/opt/stack/old/nova/nova/virt/libvirt/driver.py\", line 2286, in spawn\n     block_device_info)\n   File \"/opt/stack/old/nova/nova/virt/libvirt/driver.py\", line 3686, in _create_domain_and_network\n     power_on=power_on)\n   File \"/opt/stack/old/nova/nova/virt/libvirt/driver.py\", line 3588, in _create_domain\n     domain.XMLDesc(0))\n   File \"/opt/stack/old/nova/nova/openstack/common/excutils.py\", line 68, in __exit__\n     six.reraise(self.type_, self.value, self.tb)\n   File \"/opt/stack/old/nova/nova/virt/libvirt/driver.py\", line 3583, in _create_domain\n     domain.createWithFlags(launch_flags)\n   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 179, in doit\n     result = proxy_call(self._autowrap, f, *args, **kwargs)\n   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 139, in proxy_call\n     rv = execute(f,*args,**kwargs)\n   File \"/usr/lib/python2.7/dist-packages/eventlet/tpool.py\", line 77, in tworker\n     rv = meth(*args,**kwargs)\n   File \"/usr/lib/python2.7/dist-packages/libvirt.py\", line 896, in createWithFlags\n     if ret == -1: raise libvirtError ('virDomainCreateWithFlags() failed', dom=self)\n libvirtError: internal error: process exited while connecting to monitor: Cannot set up guest memory 'pc.ram': Cannot allocate memory \n\n\n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                                                                                                                                                                                             \n~                                                                            \n\nquery: message:\"Cannot set up guest memory 'pc.ram': Cannot allocate memory\" AND tags:\"screen-n-cpu.txt\"  AND  tags:\"multiline\"", 
            "date_created": "2014-09-08 18:57:50.129735+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "http://logstash.openstack.org/#eyJzZWFyY2giOiJtZXNzYWdlOlwibGlidmlydEVycm9yOiBpbnRlcm5hbCBlcnJvcjogcHJvY2VzcyBleGl0ZWQgd2hpbGUgY29ubmVjdGluZyB0byBtb25pdG9yOiBDYW5ub3Qgc2V0IHVwIGd1ZXN0IG1lbW9yeSAncGMucmFtJzogQ2Fubm90IGFsbG9jYXRlIG1lbW9yeVwiIEFORCB0YWdzOlwic2NyZWVuLW4tY3B1LnR4dFwiIiwiZmllbGRzIjpbXSwib2Zmc2V0IjowLCJ0aW1lZnJhbWUiOiI2MDQ4MDAiLCJncmFwaG1vZGUiOiJjb3VudCIsInRpbWUiOnsidXNlcl9pbnRlcnZhbCI6MH0sInN0YW1wIjoxNDEwMjAyMjkxNzQyfQ==\n\n18 hits in 7 days, check and gate, grenade jobs also (icehouse side), all failures.\n\nThe name of the instance when this fails is TelemetryNotificationAPITestJSON so it appears related to ceilometer hitting the nova API too hard and causing out of memory (but there are other related bugs for out of memory, I think related to neutron).\n\nCan we rate limit ceilometer hitting the nova API in test?  For Tempest runs we have disabled rate limiting for the nova v2 API since Havana.", 
            "date_created": "2014-09-08 18:59:55.348343+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "I don't think this is just ceilometer related, some other hits for this bug hit the oom-killer such as in check-tempest-dsvm-neutron-full", 
            "date_created": "2014-09-08 19:02:52.589537+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "Yeah saw that myself, removing ceilometer.", 
            "date_created": "2014-09-08 19:22:55.187648+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Sounds like when we hit this there are too many nova-api processes, like 24 on an 8 CPU VM and that's without running the nova-metadata-api service.\n\nWe changed nova-api/metadata-api/conductor workers to be equal to the number of CPUs in Icehouse by default.  The same has been done for trove api/conductor, glance api/registry and cinder volume API in Juno.", 
            "date_created": "2014-09-08 19:24:26.231526+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/119894", 
            "date_created": "2014-09-08 20:00:38.327881+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Matthew Treinish (<email address hidden>) on branch: master\nReview: https://review.openstack.org/119894", 
            "date_created": "2014-09-26 20:18:05.301671+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "We haven't been seeing this in the gate anymore since we turned down the number of workers in devstack, should we mark this closed?", 
            "date_created": "2014-10-15 21:44:13.199939+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Looks like this was an out of memory issue and not something wrong with nova per se.", 
            "date_created": "2014-10-16 16:41:11.964503+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "If compute node memory  is insufficient , it will occur the error.   Oneday, we can use CGroup  to provider fix resource for Libvirt.", 
            "date_created": "2016-04-11 08:09:45.952018+00:00", 
            "author": "https://api.launchpad.net/1.0/~multi-task"
        }
    ], 
    "closed": "2014-10-16 16:40:46.667644+00:00"
}