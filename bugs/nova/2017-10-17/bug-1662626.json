{
    "status": "Fix Released", 
    "last_updated": "2017-10-13 04:41:23.234269+00:00", 
    "description": "A live-migration stress test was working fine when suddenly a VM stopped migrating. It failed with this error:\n\nERROR nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Error from libvirt during undefine. Code=42 Error=Domain not found: no domain with matching uuid '62034d78-3144-4efd-9c2c-8a792aed3d6b' (instance-00000431)\n\nThe full stack trace:\n\n2017-02-05 02:33:41.787 19770 INFO nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Migration running for 240 secs, memory 9% remaining; (bytes processed=15198240264, remaining=1680875520, total=17314955264)\n2017-02-05 02:33:45.795 19770 INFO nova.compute.manager [req-abff9c69-5f82-4ed6-af8a-fd1dc81a72a6 - - - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] VM Paused (Lifecycle Event)\n2017-02-05 02:33:45.870 19770 INFO nova.compute.manager [req-abff9c69-5f82-4ed6-af8a-fd1dc81a72a6 - - - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] During sync_power_state the instance has a pending task (migrating). Skip.\n2017-02-05 02:33:45.883 19770 INFO nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Migration operation has completed\n2017-02-05 02:33:45.884 19770 INFO nova.compute.manager [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] _post_live_migration() is started..\n2017-02-05 02:33:46.156 19770 INFO os_vif [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] Successfully unplugged vif VIFBridge(active=True,address=fa:16:3e:a2:90:55,bridge_name='brq476ab6ba-b3',has_traffic_filtering=True,id=98d476b3-0ead-4adb-ad54-1dff63edcd65,network=Network(476ab6ba-b32e-409e-9711-9412e8475ea0),plugin='linux_bridge',port_profile=<?>,preserve_on_delete=True,vif_name='tap98d476b3-0e')\n2017-02-05 02:33:46.189 19770 INFO nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Deleting instance files /var/lib/nova/instances/62034d78-3144-4efd-9c2c-8a792aed3d6b_del\n2017-02-05 02:33:46.195 19770 INFO nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Deletion of /var/lib/nova/instances/62034d78-3144-4efd-9c2c-8a792aed3d6b_del complete\n\n2017-02-05 02:33:46.334 19770 ERROR nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Error from libvirt during undefine. Code=42 Error=Domain not found: no domain with matching uuid '62034d78-3144-4efd-9c2c-8a792aed3d6b' (instance-00000431)\n\n2017-02-05 02:33:46.363 19770 WARNING nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Error monitoring migration: Domain not found: no domain with matching uuid '62034d78-3144-4efd-9c2c-8a792aed3d6b' (instance-00000431)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Traceback (most recent call last):\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 6345, in _live_migration\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     finish_event, disk_paths)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 6255, in _live_migration_monitor\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     migrate_data)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/exception_wrapper.py\", line 75, in wrapped\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     function_name, call_dict, binary)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/exception_wrapper.py\", line 66, in wrapped\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     return f(self, context, *args, **kw)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 216, in decorated_function\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     kwargs['instance'], e, sys.exc_info())\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 204, in decorated_function\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     return function(self, context, *args, **kwargs)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 5470, in _post_live_migration\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     destroy_vifs=destroy_vifs)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 976, in cleanup\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self._undefine_domain(instance)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 874, in _undefine_domain\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     {'errcode': errcode, 'e': e}, instance=instance)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 868, in _undefine_domain\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     guest.delete_configuration()\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/guest.py\", line 266, in delete_configuration\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self._domain.undefine()\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 186, in doit\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 144, in proxy_call\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     rv = execute(f, *args, **kwargs)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 125, in execute\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(c, e, tb)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 83, in tworker\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     rv = meth(*args, **kwargs)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/libvirt.py\", line 2701, in undefine\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     if ret == -1: raise libvirtError ('virDomainUndefine() failed', dom=self)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] libvirtError: Domain not found: no domain with matching uuid '62034d78-3144-4efd-9c2c-8a792aed3d6b' (instance-00000431)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Live migration failed.\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Traceback (most recent call last):\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 5261, in _do_live_migration\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     block_migration, migrate_data)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 5775, in live_migration\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     migrate_data)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 6345, in _live_migration\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     finish_event, disk_paths)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 6255, in _live_migration_monitor\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     migrate_data)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/exception_wrapper.py\", line 75, in wrapped\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     function_name, call_dict, binary)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/exception_wrapper.py\", line 66, in wrapped\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     return f(self, context, *args, **kw)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 216, in decorated_function\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     kwargs['instance'], e, sys.exc_info())\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 204, in decorated_function\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     return function(self, context, *args, **kwargs)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 5470, in _post_live_migration\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     destroy_vifs=destroy_vifs)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 976, in cleanup\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self._undefine_domain(instance)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 874, in _undefine_domain\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     {'errcode': errcode, 'e': e}, instance=instance)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 868, in _undefine_domain\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     guest.delete_configuration()\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/guest.py\", line 266, in delete_configuration\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self._domain.undefine()\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 186, in doit\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 144, in proxy_call\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     rv = execute(f, *args, **kwargs)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 125, in execute\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(c, e, tb)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 83, in tworker\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     rv = meth(*args, **kwargs)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/libvirt.py\", line 2701, in undefine\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     if ret == -1: raise libvirtError ('virDomainUndefine() failed', dom=self)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] libvirtError: Domain not found: no domain with matching uuid '62034d78-3144-4efd-9c2c-8a792aed3d6b' (instance-00000431)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]", 
    "tags": [
        "libvirt", 
        "live-migration"
    ], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1662626", 
    "owner": "https://api.launchpad.net/1.0/~johngarbutt", 
    "id": 1662626, 
    "index": 4751, 
    "openned": "2017-02-07 18:39:35.013784+00:00", 
    "created": "2017-02-07 18:39:35.013784+00:00", 
    "title": "live-migrate left in migrating as domain not found", 
    "comments": [
        {
            "content": "A live-migration stress test was working fine when suddenly a VM stopped migrating. It failed with this error:\n\nERROR nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Error from libvirt during undefine. Code=42 Error=Domain not found: no domain with matching uuid '62034d78-3144-4efd-9c2c-8a792aed3d6b' (instance-00000431)\n\nThe full stack trace:\n\n2017-02-05 02:33:45.795 19770 INFO nova.compute.manager [req-abff9c69-5f82-4ed6-af8a-fd1dc81a72a6 - - - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] VM Paused (Lifecycle Event)\n2017-02-05 02:33:45.870 19770 INFO nova.compute.manager [req-abff9c69-5f82-4ed6-af8a-fd1dc81a72a6 - - - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] During sync_power_state the instance has a pending task (migrating). Skip.\n2017-02-05 02:33:45.883 19770 INFO nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Migration operation has completed\n2017-02-05 02:33:45.884 19770 INFO nova.compute.manager [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] _post_live_migration() is started..\n2017-02-05 02:33:46.156 19770 INFO os_vif [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] Successfully unplugged vif VIFBridge(active=True,address=fa:16:3e:a2:90:55,bridge_name='brq476ab6ba-b3',has_traffic_filtering=True,id=98d476b3-0ead-4adb-ad54-1dff63edcd65,network=Network(476ab6ba-b32e-409e-9711-9412e8475ea0),plugin='linux_bridge',port_profile=<?>,preserve_on_delete=True,vif_name='tap98d476b3-0e')\n2017-02-05 02:33:46.189 19770 INFO nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Deleting instance files /var/lib/nova/instances/62034d78-3144-4efd-9c2c-8a792aed3d6b_del\n2017-02-05 02:33:46.195 19770 INFO nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Deletion of /var/lib/nova/instances/62034d78-3144-4efd-9c2c-8a792aed3d6b_del complete\n2017-02-05 02:33:46.334 19770 ERROR nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Error from libvirt during undefine. Code=42 Error=Domain not found: no domain with matching uuid '62034d78-3144-4efd-9c2c-8a792aed3d6b' (instance-00000431)\n2017-02-05 02:33:46.363 19770 WARNING nova.virt.libvirt.driver [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Error monitoring migration: Domain not found: no domain with matching uuid '62034d78-3144-4efd-9c2c-8a792aed3d6b' (instance-00000431)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Traceback (most recent call last):\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 6345, in _live_migration\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     finish_event, disk_paths)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 6255, in _live_migration_monitor\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     migrate_data)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/exception_wrapper.py\", line 75, in wrapped\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     function_name, call_dict, binary)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/exception_wrapper.py\", line 66, in wrapped\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     return f(self, context, *args, **kw)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 216, in decorated_function\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     kwargs['instance'], e, sys.exc_info())\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 204, in decorated_function\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     return function(self, context, *args, **kwargs)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 5470, in _post_live_migration\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     destroy_vifs=destroy_vifs)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 976, in cleanup\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self._undefine_domain(instance)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 874, in _undefine_domain\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     {'errcode': errcode, 'e': e}, instance=instance)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 868, in _undefine_domain\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     guest.delete_configuration()\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/guest.py\", line 266, in delete_configuration\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self._domain.undefine()\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 186, in doit\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 144, in proxy_call\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     rv = execute(f, *args, **kwargs)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 125, in execute\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(c, e, tb)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 83, in tworker\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     rv = meth(*args, **kwargs)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/libvirt.py\", line 2701, in undefine\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     if ret == -1: raise libvirtError ('virDomainUndefine() failed', dom=self)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] libvirtError: Domain not found: no domain with matching uuid '62034d78-3144-4efd-9c2c-8a792aed3d6b' (instance-00000431)\n2017-02-05 02:33:46.363 19770 ERROR nova.virt.libvirt.driver [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] \n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [req-df91ac40-820f-4aa9-945b-b2fce73461f8 29c0371e35f84fdaa033f2dbfe2c042c 669472610b194bfa9bf03f50f86d725a - - -] [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Live migration failed.\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] Traceback (most recent call last):\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 5261, in _do_live_migration\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     block_migration, migrate_data)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 5775, in live_migration\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     migrate_data)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 6345, in _live_migration\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     finish_event, disk_paths)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 6255, in _live_migration_monitor\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     migrate_data)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/exception_wrapper.py\", line 75, in wrapped\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     function_name, call_dict, binary)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/exception_wrapper.py\", line 66, in wrapped\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     return f(self, context, *args, **kw)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 216, in decorated_function\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     kwargs['instance'], e, sys.exc_info())\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 204, in decorated_function\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     return function(self, context, *args, **kwargs)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/compute/manager.py\", line 5470, in _post_live_migration\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     destroy_vifs=destroy_vifs)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 976, in cleanup\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self._undefine_domain(instance)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 874, in _undefine_domain\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     {'errcode': errcode, 'e': e}, instance=instance)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 220, in __exit__\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self.force_reraise()\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/oslo_utils/excutils.py\", line 196, in force_reraise\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(self.type_, self.value, self.tb)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 868, in _undefine_domain\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     guest.delete_configuration()\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/nova/virt/libvirt/guest.py\", line 266, in delete_configuration\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     self._domain.undefine()\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 186, in doit\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     result = proxy_call(self._autowrap, f, *args, **kwargs)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 144, in proxy_call\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     rv = execute(f, *args, **kwargs)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 125, in execute\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     six.reraise(c, e, tb)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/eventlet/tpool.py\", line 83, in tworker\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     rv = meth(*args, **kwargs)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]   File \"/openstack/venvs/nova-14.0.4/lib/python2.7/site-packages/libvirt.py\", line 2701, in undefine\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]     if ret == -1: raise libvirtError ('virDomainUndefine() failed', dom=self)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b] libvirtError: Domain not found: no domain with matching uuid '62034d78-3144-4efd-9c2c-8a792aed3d6b' (instance-00000431)\n2017-02-05 02:33:46.364 19770 ERROR nova.compute.manager [instance: 62034d78-3144-4efd-9c2c-8a792aed3d6b]", 
            "date_created": "2017-02-07 18:39:35.013784+00:00", 
            "author": "https://api.launchpad.net/1.0/~johngarbutt"
        }, 
        {
            "content": "Still digging on the details with this bug. Looking at if we keep seeing the same thing several times.", 
            "date_created": "2017-02-07 18:40:22.734309+00:00", 
            "author": "https://api.launchpad.net/1.0/~johngarbutt"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/430400", 
            "date_created": "2017-02-07 19:00:35.572135+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Related fix proposed to branch: master\nReview: https://review.openstack.org/430404", 
            "date_created": "2017-02-07 19:15:12.184716+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "So there are kind of two problems here, a race in undefine domain that leads to occasional live-migration failures when you run lots and lots of live-migrations.\n\nOn top of that, when errors happen in that part of the code, we don't set the instance to the error state, so the instance just stays in the migrating state.", 
            "date_created": "2017-02-08 11:53:35.992417+00:00", 
            "author": "https://api.launchpad.net/1.0/~johngarbutt"
        }, 
        {
            "content": "Is this really an ocata release candidate potential bug? It sounds pretty latent and something we can backport to stable/ocata after 15.0.0 is released. Or was this the result of a regression in Ocata itself?", 
            "date_created": "2017-02-14 21:17:55.174864+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/430400\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=b706155888d740841d745c52aae543cf82fab0bc\nSubmitter: Jenkins\nBranch:    master\n\ncommit b706155888d740841d745c52aae543cf82fab0bc\nAuthor: John Garbutt <email address hidden>\nDate:   Tue Feb 7 18:55:26 2017 +0000\n\n    Stop _undefine_domain erroring if domain not found\n    \n    During live-migration stress testing we are seeing the following log:\n    Error from libvirt during undefine. Code=42 Error=Domain not found\n    \n    There appears to be a race while trying to undefine the domain, and\n    something else is possibly also doing some kind of clean up. While this\n    does paper over that race, it stops otherwise completed live-migrations\n    from failing. It also matches similar error handling done for when\n    deleting the domain.\n    \n    The next part of the bug fix is to ensure if we have any similar\n    unexpected errors during this later phase of the live-migration we don't\n    leave the instance stuck in the migrating state, it should move to an\n    ERROR state. This is covered in a follow on patch.\n    \n    Partial-Bug: #1662626\n    \n    Change-Id: I23ed9819061bfa436b12180110666c5b8c3e0f70\n", 
            "date_created": "2017-02-25 04:09:03.427058+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/430404\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=b56f8fc2d1392f4675a5baae0977e4817a362159\nSubmitter: Jenkins\nBranch:    master\n\ncommit b56f8fc2d1392f4675a5baae0977e4817a362159\nAuthor: John Garbutt <email address hidden>\nDate:   Tue Feb 7 19:12:50 2017 +0000\n\n    Stop failed live-migrates getting stuck migrating\n    \n    When there are failures in driver.cleanup, we are seeing live-migrations\n    that get stuck in the live-migrating state. While there has been a patch\n    to stop the cause listed in the bug this closes, there are other\n    failures (such as a token timeout when talking to cinder or neutron)\n    that could trigger this same failure mode.\n    \n    When we hit an error this late in live-migration, it should be a very\n    rare event, so its best to just put the instance and migration into an\n    error state, and help alert both the operator and API user to the\n    failure that has occurred.\n    \n    Closes-Bug: #1662626\n    \n    Change-Id: Idfdce9e7dd8106af01db0358ada15737cb846395\n", 
            "date_created": "2017-03-27 13:30:32.676176+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 16.0.0.0b1 development milestone.", 
            "date_created": "2017-04-14 09:24:17.926342+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/ocata\nReview: https://review.openstack.org/457023", 
            "date_created": "2017-04-15 18:58:46.787595+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/457023\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=012fa9353ff18d3d52120fd42a2ec25dbc5a02b7\nSubmitter: Jenkins\nBranch:    stable/ocata\n\ncommit 012fa9353ff18d3d52120fd42a2ec25dbc5a02b7\nAuthor: John Garbutt <email address hidden>\nDate:   Tue Feb 7 19:12:50 2017 +0000\n\n    Stop failed live-migrates getting stuck migrating\n    \n    When there are failures in driver.cleanup, we are seeing live-migrations\n    that get stuck in the live-migrating state. While there has been a patch\n    to stop the cause listed in the bug this closes, there are other\n    failures (such as a token timeout when talking to cinder or neutron)\n    that could trigger this same failure mode.\n    \n    When we hit an error this late in live-migration, it should be a very\n    rare event, so its best to just put the instance and migration into an\n    error state, and help alert both the operator and API user to the\n    failure that has occurred.\n    \n    Closes-Bug: #1662626\n    \n    Change-Id: Idfdce9e7dd8106af01db0358ada15737cb846395\n    (cherry picked from commit b56f8fc2d1392f4675a5baae0977e4817a362159)\n", 
            "date_created": "2017-04-25 21:21:55.822487+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 15.0.4 release.", 
            "date_created": "2017-05-08 22:10:21.130073+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/newton\nReview: https://review.openstack.org/470387", 
            "date_created": "2017-06-02 18:12:16.449268+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/mitaka\nReview: https://review.openstack.org/476278", 
            "date_created": "2017-06-21 21:55:09.985173+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Joshua Hesketh (<email address hidden>) on branch: stable/mitaka\nReview: https://review.openstack.org/476278\nReason: This branch (stable/mitaka) is at End Of Life", 
            "date_created": "2017-07-05 08:38:11.571710+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/470387\nCommitted: https://git.openstack.org/cgit/openstack/nova/commit/?id=017e853b950ddc10dab4ebab37e64cece40f274f\nSubmitter: Jenkins\nBranch:    stable/newton\n\ncommit 017e853b950ddc10dab4ebab37e64cece40f274f\nAuthor: John Garbutt <email address hidden>\nDate:   Tue Feb 7 19:12:50 2017 +0000\n\n    Stop failed live-migrates getting stuck migrating\n    \n    When there are failures in driver.cleanup, we are seeing live-migrations\n    that get stuck in the live-migrating state. While there has been a patch\n    to stop the cause listed in the bug this closes, there are other\n    failures (such as a token timeout when talking to cinder or neutron)\n    that could trigger this same failure mode.\n    \n    When we hit an error this late in live-migration, it should be a very\n    rare event, so its best to just put the instance and migration into an\n    error state, and help alert both the operator and API user to the\n    failure that has occurred.\n    \n    For backport into Newton, 'migrate_instance_start' had to be patched\n    in the unit test (nova/tests/unit/compute/test_compute.py).\n    \n    Closes-Bug: #1662626\n    \n    Change-Id: Idfdce9e7dd8106af01db0358ada15737cb846395\n    (cherry picked from commit b56f8fc2d1392f4675a5baae0977e4817a362159)\n    (cherry picked from commit 012fa9353ff18d3d52120fd42a2ec25dbc5a02b7)\n", 
            "date_created": "2017-08-12 01:22:28.047477+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "This issue was fixed in the openstack/nova 14.0.8 release.", 
            "date_created": "2017-08-28 09:55:20.288477+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/ocata\nReview: https://review.openstack.org/508640", 
            "date_created": "2017-09-30 01:25:22.658213+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: stable/newton\nReview: https://review.openstack.org/508641", 
            "date_created": "2017-09-30 01:26:11.630760+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Liping Mao (<email address hidden>) on branch: stable/ocata\nReview: https://review.openstack.org/508640", 
            "date_created": "2017-10-13 04:41:08.175232+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Liping Mao (<email address hidden>) on branch: stable/newton\nReview: https://review.openstack.org/508641", 
            "date_created": "2017-10-13 04:41:22.605227+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2017-03-27 13:30:29.197178+00:00"
}