{
    "status": "In Progress", 
    "last_updated": "2017-07-31 11:41:50.694415+00:00", 
    "description": "When a different process say neutron sends an exception to nova that Exception is not handled by nova and the error message is not relayed correctly to the cli.\n\nFor example;  \nI tried the following command failed due to a restriction:\n\n\"nova interface-attach vm --net <net-id>\n\nExpected Result:\nWhat was expected when this command failed was an error message as follows \" VM with ports belonging to subnets across enter prises is not allowed in VSP\"\n\nActual Result:\nHowever, instead this message was relayed back to the cli \"ERROR (ClientException): The server has either erred or is incapable of performing the requested operation. (HTTP 500) (Request-ID: req-fd69f004-591c-4ea8-b7b6-088a74cbe518)\"\n\nNova-api logs:\n\nThe ERROR seen on nova-api is as follows:\n2015-08-05 23:30:42.116 INFO oslo_messaging._drivers.impl_rabbit [req-fd69f004-591c-4ea8-b7b6-088a74cbe518 admin admin] Connected to AMQP server on 10.31.101.215:5672\n2015-08-05 23:30:43.035 ERROR nova.api.openstack [req-fd69f004-591c-4ea8-b7b6-088a74cbe518 admin admin] Caught error: Remote error: BadRequest Bad request: VM with ports belonging to subnets across enter prises is not allowed in VSP\n[u'Traceback (most recent call last):\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\\n    executor_callback))\\n', u'  File \"/usr/\nlocal/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\\n    executor_callback)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\",\n line 130, in _do_dispatch\\n    result = func(ctxt, **new_args)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 6602, in attach_interface\\n    port_id, requested_ip)\\n', u'  File \"/opt/stack\n/nova/nova/compute/manager.py\", line 443, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/exception.py\", line 88, in wrapped\\n    payload)\\n'\n, u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/exception.py\", line 71, in wrapped\\n    retur\nn f(self, context, *args, **kw)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 327, in decorated_function\\n    LOG.warning(msg, e, instance_uuid=instance_uuid)\\n', u'  File \"/usr/local/lib/\npython2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 298, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 355, in decorated_function\\n    kwargs[\\'instance\\'], e, sys.exc_info())\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 343, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 5024, in attach_interface\\n    context, instance, port_id, network_id, requested_ip)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 705, in allocate_port_for_instance\\n    requested_networks=requested_networks)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 577, in allocate_for_instance\\n    self._delete_ports(neutron, instance, created_port_ids)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 569, in allocate_for_instance\\n    security_group_ids, available_macs, dhcp_opts)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 331, in _create_port\\n    network_id, instance=instance)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 304, in _create_port\\n    port_id = port_client.create_port(port_req_body)[\\'port\\'][\\'id\\']\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 102, in with_params\\n    ret = self.function(instance, *args, **kwargs)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 544, in create_port\\n    return self.post(self.ports_path, body=body)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 298, in post\\n    headers=headers, params=params)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 211, in do_request\\n    self._handle_fault_response(status_code, replybody)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 185, in _handle_fault_response\\n    exception_handler_v20(status_code, des_error_body)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 70, in exception_handler_v20\\n    status_code=status_code)\\n', u'BadRequest: Bad request: VM with ports belonging to subnets across enterprises is not allowed in VSP\\n'].\n2015-08-05 23:30:43.035 TRACE nova.api.openstack Traceback (most recent call last):\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 125, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return req.get_response(self.application)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1317, in send\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     application, catch_exc_info=False)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1281, in call_application\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py\", line 634, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return self._call_app(env, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py\", line 554, in _call_app\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return self._app(env, _fake_start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/routes/middleware.py\", line 136, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 756, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     content_type, body, accept)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 821, in _process_stack\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 911, in dispatch\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return method(req=request, **action_args)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/contrib/attach_interfaces.py\", line 122, in create\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     instance, network_id, port_id, req_ip)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 230, in wrapped\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return func(self, context, target, *args, **kwargs)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 219, in inner\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return function(self, context, instance, *args, **kwargs)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 200, in inner\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return f(self, context, instance, *args, **kw)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 3108, in attach_interface\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     requested_ip=requested_ip)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/rpcapi.py\", line 355, in attach_interface\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     port_id=port_id, requested_ip=requested_ip)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/client.py\", line 156, in call\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     retry=self.retry)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/transport.py\", line 90, in _send\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     timeout=timeout, retry=retry)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 350, in send\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     retry=retry)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 341, in _send\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     raise result\n2015-08-05 23:30:43.035 TRACE nova.api.openstack RemoteError: Remote error: BadRequest Bad request: VM with ports belonging to subnets across enterprises is not allowed in VSP\n2015-08-05 23:30:43.035 TRACE nova.api.openstack [u'Traceback (most recent call last):\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\\n    executor_callback))\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\\n    executor_callback)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\\n    result = func(ctxt, **new_args)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 6602, in attach_interface\\n    port_id, requested_ip)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 443, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/exception.py\", line 88, in wrapped\\n    payload)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/exception.py\", line 71, in wrapped\\n    return f(self, context, *args, **kw)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 327, in decorated_function\\n    LOG.warning(msg, e, instance_uuid=instance_uuid)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 298, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 355, in decorated_function\\n    kwargs[\\'instance\\'], e, sys.exc_info())\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 343, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 5024, in attach_interface\\n    context, instance, port_id, network_id, requested_ip)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 705, in allocate_port_for_instance\\n    requested_networks=requested_networks)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 577, in allocate_for_instance\\n    self._delete_ports(neutron, instance, created_port_ids)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 569, in allocate_for_instance\\n    security_group_ids, available_macs, dhcp_opts)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 331, in _create_port\\n    network_id, instance=instance)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 304, in _create_port\\n    port_id = port_client.create_port(port_req_body)[\\'port\\'][\\'id\\']\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 102, in with_params\\n    ret = self.function(instance, *args, **kwargs)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 544, in create_port\\n    return self.post(self.ports_path, body=body)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 298, in post\\n    headers=headers, params=params)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 211, in do_request\\n    self._handle_fault_response(status_code, replybody)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 185, in _handle_fault_response\\n    exception_handler_v20(status_code, des_error_body)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 70, in exception_handler_v20\\n    status_code=status_code)\\n', u'BadRequest: Bad request: VM with ports belonging to subnets across enterprises is not allowed in VSP\\n'].", 
    "tags": [
        "api", 
        "low-hanging-fruit", 
        "network"
    ], 
    "importance": "Low", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1481977", 
    "owner": "https://api.launchpad.net/1.0/~sdague", 
    "id": 1481977, 
    "index": 1801, 
    "openned": "2015-08-05 23:50:06.850237+00:00", 
    "created": "2015-08-05 23:50:06.850237+00:00", 
    "title": "Nova cannot handle BadRequest or a Vendor Specific Exceptions", 
    "comments": [
        {
            "content": "When a different process say neutron sends an exception to nova that Exception is not handled by nova and the error message is not relayed correctly to the cli.\n\nFor example;  \nI tried the following command failed due to a restriction:\n\n\"nova interface-attach vm --net <net-id>\n\nExpected Result:\nWhat was expected when this command failed was an error message as follows \" VM with ports belonging to subnets across enter prises is not allowed in VSP\"\n\nActual Result:\nHowever, instead this message was relayed back to the cli \"ERROR (ClientException): The server has either erred or is incapable of performing the requested operation. (HTTP 500) (Request-ID: req-fd69f004-591c-4ea8-b7b6-088a74cbe518)\"\n\nNova-api logs:\n\nThe ERROR seen on nova-api is as follows:\n2015-08-05 23:30:42.116 INFO oslo_messaging._drivers.impl_rabbit [req-fd69f004-591c-4ea8-b7b6-088a74cbe518 admin admin] Connected to AMQP server on 10.31.101.215:5672\n2015-08-05 23:30:43.035 ERROR nova.api.openstack [req-fd69f004-591c-4ea8-b7b6-088a74cbe518 admin admin] Caught error: Remote error: BadRequest Bad request: VM with ports belonging to subnets across enter prises is not allowed in VSP\n[u'Traceback (most recent call last):\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\\n    executor_callback))\\n', u'  File \"/usr/\nlocal/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\\n    executor_callback)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\",\n line 130, in _do_dispatch\\n    result = func(ctxt, **new_args)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 6602, in attach_interface\\n    port_id, requested_ip)\\n', u'  File \"/opt/stack\n/nova/nova/compute/manager.py\", line 443, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/exception.py\", line 88, in wrapped\\n    payload)\\n'\n, u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/exception.py\", line 71, in wrapped\\n    retur\nn f(self, context, *args, **kw)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 327, in decorated_function\\n    LOG.warning(msg, e, instance_uuid=instance_uuid)\\n', u'  File \"/usr/local/lib/\npython2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 298, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 355, in decorated_function\\n    kwargs[\\'instance\\'], e, sys.exc_info())\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 343, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 5024, in attach_interface\\n    context, instance, port_id, network_id, requested_ip)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 705, in allocate_port_for_instance\\n    requested_networks=requested_networks)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 577, in allocate_for_instance\\n    self._delete_ports(neutron, instance, created_port_ids)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 569, in allocate_for_instance\\n    security_group_ids, available_macs, dhcp_opts)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 331, in _create_port\\n    network_id, instance=instance)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 304, in _create_port\\n    port_id = port_client.create_port(port_req_body)[\\'port\\'][\\'id\\']\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 102, in with_params\\n    ret = self.function(instance, *args, **kwargs)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 544, in create_port\\n    return self.post(self.ports_path, body=body)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 298, in post\\n    headers=headers, params=params)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 211, in do_request\\n    self._handle_fault_response(status_code, replybody)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 185, in _handle_fault_response\\n    exception_handler_v20(status_code, des_error_body)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 70, in exception_handler_v20\\n    status_code=status_code)\\n', u'BadRequest: Bad request: VM with ports belonging to subnets across enterprises is not allowed in VSP\\n'].\n2015-08-05 23:30:43.035 TRACE nova.api.openstack Traceback (most recent call last):\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/__init__.py\", line 125, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return req.get_response(self.application)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1317, in send\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     application, catch_exc_info=False)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/request.py\", line 1281, in call_application\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py\", line 634, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return self._call_app(env, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/keystonemiddleware/auth_token/__init__.py\", line 554, in _call_app\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return self._app(env, _fake_start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/routes/middleware.py\", line 136, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 144, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return resp(environ, start_response)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 130, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/webob/dec.py\", line 195, in call_func\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 756, in __call__\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     content_type, body, accept)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 821, in _process_stack\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/wsgi.py\", line 911, in dispatch\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return method(req=request, **action_args)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/api/openstack/compute/contrib/attach_interfaces.py\", line 122, in create\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     instance, network_id, port_id, req_ip)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 230, in wrapped\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return func(self, context, target, *args, **kwargs)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 219, in inner\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return function(self, context, instance, *args, **kwargs)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 200, in inner\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     return f(self, context, instance, *args, **kw)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/api.py\", line 3108, in attach_interface\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     requested_ip=requested_ip)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/opt/stack/nova/nova/compute/rpcapi.py\", line 355, in attach_interface\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     port_id=port_id, requested_ip=requested_ip)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/client.py\", line 156, in call\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     retry=self.retry)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/transport.py\", line 90, in _send\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     timeout=timeout, retry=retry)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 350, in send\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     retry=retry)\n2015-08-05 23:30:43.035 TRACE nova.api.openstack   File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/_drivers/amqpdriver.py\", line 341, in _send\n2015-08-05 23:30:43.035 TRACE nova.api.openstack     raise result\n2015-08-05 23:30:43.035 TRACE nova.api.openstack RemoteError: Remote error: BadRequest Bad request: VM with ports belonging to subnets across enterprises is not allowed in VSP\n2015-08-05 23:30:43.035 TRACE nova.api.openstack [u'Traceback (most recent call last):\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 142, in _dispatch_and_reply\\n    executor_callback))\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 186, in _dispatch\\n    executor_callback)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_messaging/rpc/dispatcher.py\", line 130, in _do_dispatch\\n    result = func(ctxt, **new_args)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 6602, in attach_interface\\n    port_id, requested_ip)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 443, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/exception.py\", line 88, in wrapped\\n    payload)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/exception.py\", line 71, in wrapped\\n    return f(self, context, *args, **kw)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 327, in decorated_function\\n    LOG.warning(msg, e, instance_uuid=instance_uuid)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 298, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 355, in decorated_function\\n    kwargs[\\'instance\\'], e, sys.exc_info())\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 343, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', u'  File \"/opt/stack/nova/nova/compute/manager.py\", line 5024, in attach_interface\\n    context, instance, port_id, network_id, requested_ip)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 705, in allocate_port_for_instance\\n    requested_networks=requested_networks)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 577, in allocate_for_instance\\n    self._delete_ports(neutron, instance, created_port_ids)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 569, in allocate_for_instance\\n    security_group_ids, available_macs, dhcp_opts)\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 331, in _create_port\\n    network_id, instance=instance)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/oslo_utils/excutils.py\", line 85, in __exit__\\n    ctxt.reraise = False\\n', u'  File \"/opt/stack/nova/nova/network/neutronv2/api.py\", line 304, in _create_port\\n    port_id = port_client.create_port(port_req_body)[\\'port\\'][\\'id\\']\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 102, in with_params\\n    ret = self.function(instance, *args, **kwargs)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 544, in create_port\\n    return self.post(self.ports_path, body=body)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 298, in post\\n    headers=headers, params=params)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 211, in do_request\\n    self._handle_fault_response(status_code, replybody)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 185, in _handle_fault_response\\n    exception_handler_v20(status_code, des_error_body)\\n', u'  File \"/usr/local/lib/python2.7/dist-packages/neutronclient/v2_0/client.py\", line 70, in exception_handler_v20\\n    status_code=status_code)\\n', u'BadRequest: Bad request: VM with ports belonging to subnets across enterprises is not allowed in VSP\\n'].", 
            "date_created": "2015-08-05 23:50:06.850237+00:00", 
            "author": "https://api.launchpad.net/1.0/~nairprinikasankaran"
        }, 
        {
            "content": "we had a lot of code in network layer to handle neutron client error and translate it \nthis one should be another one need to do so", 
            "date_created": "2015-08-10 14:34:40.902937+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }, 
        {
            "content": "I can't find which kind of exception was thrown.\nCan you offer neutron api error message\nYour can add debug option in cli, just like following\n> nova interface-attach vm --net <net-id>\nResponse should contain type and message\nThanks.", 
            "date_created": "2015-08-25 14:49:24.607526+00:00", 
            "author": "https://api.launchpad.net/1.0/~lyanchih"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/242861", 
            "date_created": "2015-11-08 17:06:00.871419+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Davanum Srinivas (dims) (<email address hidden>) on branch: master\nReview: https://review.openstack.org/242861", 
            "date_created": "2015-12-01 18:53:22.468864+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Tried to attach the interface accoss enterprise using the Nuage Plugin.\n\nBefore the patch:\n\nstack@stack-ubuntu:/opt/stack/nova$ nova interface-attach vm --net 535d9379-0306-4852-b8f9-05ae0b3d262e\n(ClientException): The server has either erred or is incapable of performing the requested operation. (HTTP 500) (Request-ID: req-fd69f004-591c-4ea8-b7b6-088a74cbe518)\n\n\nAfter the patch:\n\nstack@stack-ubuntu:/opt/stack/nova$ nova interface-attach vm --net 535d9379-0306-4852-b8f9-05ae0b3d262e\nERROR (BadRequest): Neutron error creating port on network 535d9379-0306-4852-b8f9-05ae0b3d262e: Bad request: VM with ports belonging to subnets across enterprises is not allowed in VSP (HTTP 400) (Request-ID: req-fbf83ccf-04f7-48d2-8ce6-98a44ddeb71f)\n", 
            "date_created": "2016-02-10 20:31:29.408054+00:00", 
            "author": "https://api.launchpad.net/1.0/~chirag-shahani"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/278788", 
            "date_created": "2016-02-10 23:12:56.848348+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Change abandoned by Michael Still (<email address hidden>) on branch: master\nReview: https://review.openstack.org/278788\nReason: This code hasn't been updated in a long time, and is in merge conflict. I am going to abandon this review, but feel free to restore it if you're still working on this.", 
            "date_created": "2016-07-19 18:45:22.235850+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Cleanup\n=======\n\nThere are no open reviews for this bug report since more than 2 weeks.\nTo signal that to other contributors which might provide patches for\nthis bug, I switch the status from \"In Progress\" to \"Confirmed\" and\nremove the assignee.\nFeel free to add yourself as assignee and to push a review for it.", 
            "date_created": "2016-08-12 08:51:09.200735+00:00", 
            "author": "https://api.launchpad.net/1.0/~mzoeller"
        }, 
        {
            "content": "Started working on it", 
            "date_created": "2016-09-29 11:18:01.662481+00:00", 
            "author": "https://api.launchpad.net/1.0/~omkar-telee"
        }
    ]
}