{
    "status": "Invalid", 
    "last_updated": "2016-04-18 17:23:07.840749+00:00", 
    "description": "[Summary]\nQuota limit for meta can be set to smaller than already used\n\n[Topo]\ndevstack all-in-one node\n\n[Description and expect result]\nQuota limit for meta can not be set to smaller than already used\n\n[Reproduceable or not]\nreproduceable \n\n[Recreate Steps]\n1) current meta quota limit is 10:\nroot@45-59:/opt/stack/devstack# nova quota-show\n+-----------------------------+-------+\n| Quota                       | Limit |\n+-----------------------------+-------+\n| instances                   | 11    |\n| cores                       | 20    |\n| ram                         | 51200 |\n| floating_ips                | 10    |\n| fixed_ips                   | -1    |\n| metadata_items              | 10    |\n| injected_files              | 5     |\n| injected_file_content_bytes | 10240 |\n| injected_file_path_bytes    | 255   |\n| key_pairs                   | 100   |\n| security_groups             | 10    |\n| security_group_rules        | 20    |\n| server_groups               | 10    |\n| server_group_members        | 10    |\n+-----------------------------+-------+\n\n2)create an instance, and set 2 meta items for the instance:\nroot@45-59:/opt/stack/devstack# nova meta instance-docker-test set a=1 b=2\nroot@45-59:/opt/stack/devstack# nova show instance-docker-test \n+--------------------------------------+----------------------------------------------------------------+\n| Property                             | Value                                                          |\n+--------------------------------------+----------------------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                                         |\n| OS-EXT-AZ:availability_zone          | nova                                                           |\n| OS-EXT-SRV-ATTR:host                 | 45-59                                                          |\n| OS-EXT-SRV-ATTR:hostname             | instance-docker-test                                           |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | 45-59                                                          |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000002                                              |\n| OS-EXT-SRV-ATTR:kernel_id            | 9400ca84-438d-404d-a454-f1764c105a38                           |\n| OS-EXT-SRV-ATTR:launch_index         | 0                                                              |\n| OS-EXT-SRV-ATTR:ramdisk_id           | 50aadc88-c755-418b-912f-a1ce4c91ddce                           |\n| OS-EXT-SRV-ATTR:reservation_id       | r-10jntt4r                                                     |\n| OS-EXT-SRV-ATTR:root_device_name     | /dev/vda                                                       |\n| OS-EXT-SRV-ATTR:user_data            | -                                                              |\n| OS-EXT-STS:power_state               | 1                                                              |\n| OS-EXT-STS:task_state                | -                                                              |\n| OS-EXT-STS:vm_state                  | active                                                         |\n| OS-SRV-USG:launched_at               | 2015-12-08T15:19:30.000000                                     |\n| OS-SRV-USG:terminated_at             | -                                                              |\n| accessIPv4                           |                                                                |\n| accessIPv6                           |                                                                |\n| config_drive                         | True                                                           |\n| created                              | 2015-12-08T15:19:23Z                                           |\n| flavor                               | m1.tiny (1)                                                    |\n| hostId                               | f8d5a16aa9a8b55e358ed62cc40ae216c1e025bc991c6b71f7898830       |\n| id                                   | 2e332fba-7c31-4271-9443-b36ef7cc76c2                           |\n| image                                | cirros-0.3.4-x86_64-uec (6ec79afd-b705-44c1-926c-7e29c2521318) |\n| key_name                             | -                                                              |\n| metadata                             | {\"a\": \"1\", \"b\": \"2\"}                                           |\n| name                                 | instance-docker-test                                           |\n| net1 network                         | 1.0.0.4                                                        |\n| os-extended-volumes:volumes_attached | []                                                             |\n| progress                             | 0                                                              |\n| security_groups                      | default                                                        |\n| status                               | ACTIVE                                                         |\n| tenant_id                            | f75256da799642e0ab597a7533918714                               |\n| updated                              | 2015-12-08T15:45:40Z                                           |\n| user_id                              | ac0147b65d864804aec02d21cce07991                               |\n+--------------------------------------+----------------------------------------------------------------+\nroot@45-59:/opt/stack/devstack# \n\n3)set the meta quota limit to 1, succeeded:                     >>>ISSUE,actually there are 2 meta items existing, should return error info here.\nroot@45-59:/opt/stack/devstack# nova quota-update --metadata-items 1 f75256da799642e0ab597a7533918714\nroot@45-59:/opt/stack/devstack# \nroot@45-59:/opt/stack/devstack# nova quota-show\n+-----------------------------+-------+\n| Quota                       | Limit |\n+-----------------------------+-------+\n| instances                   | 11    |\n| cores                       | 20    |\n| ram                         | 51200 |\n| floating_ips                | 10    |\n| fixed_ips                   | -1    |\n| metadata_items              | 1     |  >>>ISSUE\n| injected_files              | 5     |\n| injected_file_content_bytes | 10240 |\n| injected_file_path_bytes    | 255   |\n| key_pairs                   | 100   |\n| security_groups             | 10    |\n| security_group_rules        | 20    |\n| server_groups               | 10    |\n| server_group_members        | 10    |\n+-----------------------------+-------+\nroot@45-59:/opt/stack/devstack#\n\n[Configration]\nreproduceable bug, no need\n\n[logs]\nreproduceable bug, no need\n\n[Root cause anlyze or debug inf]\nreproduceable bug\n\n[Attachment]\nNone", 
    "tags": [
        "quotas"
    ], 
    "importance": "Wishlist", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1523793", 
    "owner": "https://api.launchpad.net/1.0/~p-pallavi", 
    "id": 1523793, 
    "index": 3036, 
    "openned": "2015-12-08 08:04:55.388709+00:00", 
    "created": "2015-12-08 08:04:55.388709+00:00", 
    "title": "Nova: Quota limit for meta can be set to smaller than already used", 
    "comments": [
        {
            "content": "[Summary]\nQuota limit for meta can be set to smaller than already used\n\n[Topo]\ndevstack all-in-one node\n\n[Description and expect result]\nQuota limit for meta can not be set to smaller than already used\n\n[Reproduceable or not]\nreproduceable \n\n[Recreate Steps]\n1) current meta quota limit is 10:\nroot@45-59:/opt/stack/devstack# nova quota-show\n+-----------------------------+-------+\n| Quota                       | Limit |\n+-----------------------------+-------+\n| instances                   | 11    |\n| cores                       | 20    |\n| ram                         | 51200 |\n| floating_ips                | 10    |\n| fixed_ips                   | -1    |\n| metadata_items              | 10    |\n| injected_files              | 5     |\n| injected_file_content_bytes | 10240 |\n| injected_file_path_bytes    | 255   |\n| key_pairs                   | 100   |\n| security_groups             | 10    |\n| security_group_rules        | 20    |\n| server_groups               | 10    |\n| server_group_members        | 10    |\n+-----------------------------+-------+\n\n2)create an instance, and set 2 meta items for the instance:\nroot@45-59:/opt/stack/devstack# nova meta instance-docker-test set a=1 b=2\nroot@45-59:/opt/stack/devstack# nova show instance-docker-test \n+--------------------------------------+----------------------------------------------------------------+\n| Property                             | Value                                                          |\n+--------------------------------------+----------------------------------------------------------------+\n| OS-DCF:diskConfig                    | MANUAL                                                         |\n| OS-EXT-AZ:availability_zone          | nova                                                           |\n| OS-EXT-SRV-ATTR:host                 | 45-59                                                          |\n| OS-EXT-SRV-ATTR:hostname             | instance-docker-test                                           |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | 45-59                                                          |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000002                                              |\n| OS-EXT-SRV-ATTR:kernel_id            | 9400ca84-438d-404d-a454-f1764c105a38                           |\n| OS-EXT-SRV-ATTR:launch_index         | 0                                                              |\n| OS-EXT-SRV-ATTR:ramdisk_id           | 50aadc88-c755-418b-912f-a1ce4c91ddce                           |\n| OS-EXT-SRV-ATTR:reservation_id       | r-10jntt4r                                                     |\n| OS-EXT-SRV-ATTR:root_device_name     | /dev/vda                                                       |\n| OS-EXT-SRV-ATTR:user_data            | -                                                              |\n| OS-EXT-STS:power_state               | 1                                                              |\n| OS-EXT-STS:task_state                | -                                                              |\n| OS-EXT-STS:vm_state                  | active                                                         |\n| OS-SRV-USG:launched_at               | 2015-12-08T15:19:30.000000                                     |\n| OS-SRV-USG:terminated_at             | -                                                              |\n| accessIPv4                           |                                                                |\n| accessIPv6                           |                                                                |\n| config_drive                         | True                                                           |\n| created                              | 2015-12-08T15:19:23Z                                           |\n| flavor                               | m1.tiny (1)                                                    |\n| hostId                               | f8d5a16aa9a8b55e358ed62cc40ae216c1e025bc991c6b71f7898830       |\n| id                                   | 2e332fba-7c31-4271-9443-b36ef7cc76c2                           |\n| image                                | cirros-0.3.4-x86_64-uec (6ec79afd-b705-44c1-926c-7e29c2521318) |\n| key_name                             | -                                                              |\n| metadata                             | {\"a\": \"1\", \"b\": \"2\"}                                           |\n| name                                 | instance-docker-test                                           |\n| net1 network                         | 1.0.0.4                                                        |\n| os-extended-volumes:volumes_attached | []                                                             |\n| progress                             | 0                                                              |\n| security_groups                      | default                                                        |\n| status                               | ACTIVE                                                         |\n| tenant_id                            | f75256da799642e0ab597a7533918714                               |\n| updated                              | 2015-12-08T15:45:40Z                                           |\n| user_id                              | ac0147b65d864804aec02d21cce07991                               |\n+--------------------------------------+----------------------------------------------------------------+\nroot@45-59:/opt/stack/devstack# \n\n3)set the meta quota limit to 1, succeeded:                     >>>ISSUE,actually there are 2 meta items existing, should return error info here.\nroot@45-59:/opt/stack/devstack# nova quota-update --metadata-items 1 f75256da799642e0ab597a7533918714\nroot@45-59:/opt/stack/devstack# \nroot@45-59:/opt/stack/devstack# nova quota-show\n+-----------------------------+-------+\n| Quota                       | Limit |\n+-----------------------------+-------+\n| instances                   | 11    |\n| cores                       | 20    |\n| ram                         | 51200 |\n| floating_ips                | 10    |\n| fixed_ips                   | -1    |\n| metadata_items              | 1     |  >>>ISSUE\n| injected_files              | 5     |\n| injected_file_content_bytes | 10240 |\n| injected_file_path_bytes    | 255   |\n| key_pairs                   | 100   |\n| security_groups             | 10    |\n| security_group_rules        | 20    |\n| server_groups               | 10    |\n| server_group_members        | 10    |\n+-----------------------------+-------+\nroot@45-59:/opt/stack/devstack#\n\n[Configration]\nreproduceable bug, no need\n\n[logs]\nreproduceable bug, no need\n\n[Root cause anlyze or debug inf]\nreproduceable bug\n\n[Attachment]\nNone", 
            "date_created": "2015-12-08 08:04:55.388709+00:00", 
            "author": "https://api.launchpad.net/1.0/~hgangwx"
        }, 
        {
            "content": "I can reproduce it , seems we need check before we set the value to 1 ..but that's a little bit complicated ..", 
            "date_created": "2015-12-10 19:13:38.131964+00:00", 
            "author": "https://api.launchpad.net/1.0/~jichenjc"
        }, 
        {
            "content": "I agree that the behavior here could be considered incorrect, but it's not clear what the fix is. Should it not be possible for quotas to be reduced below current usage, should metadata be removed to meet quota, ...? This is really more of a feature request and should be put into a blueprint or spec rather than a bug report.", 
            "date_created": "2016-04-18 17:23:07.317984+00:00", 
            "author": "https://api.launchpad.net/1.0/~alaski"
        }
    ], 
    "closed": "2016-04-18 17:21:44.746226+00:00"
}