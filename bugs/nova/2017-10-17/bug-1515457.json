{
    "status": "Expired", 
    "last_updated": "2016-09-13 04:17:51.072884+00:00", 
    "description": "description:\nwhen delete an instance created from the volume. It will get the volume metadata like this :\n    volume_id = connection_info['data']['volume_id']\nBut the connection_info has no volume_id. It will be error.\n\nversion :2014.1.\n\nRelevant log :\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2587, in do_terminate_instance\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     self._delete_instance(context, instance, bdms, quotas)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/hooks.py\", line 103, in inner\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     rv = f(*args, **kwargs)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2556, in _delete_instance\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     quotas.rollback()\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     six.reraise(self.type_, self.value, self.tb)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2528, in _delete_instance\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     self._shutdown_instance(context, db_inst, bdms)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2463, in _shutdown_instance\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     requested_networks)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     six.reraise(self.type_, self.value, self.tb)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2453, in _shutdown_instance\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     block_device_info)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1009, in destroy\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     destroy_disks)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1098, in cleanup\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     volume_meta = self._get_volume_metadata(context, connection_info)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 3642, in _get_volume_metadata\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     raise exception.InvalidBDMVolume(id=volume_id)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add] UnboundLocalError: local variable 'volume_id' referenced before assignment\n\nReproduce steps:\n1 create a volume named a from an image\n2 create an instance from the volume a\n3 delete the instance", 
    "tags": [
        "ceph", 
        "libvirt"
    ], 
    "importance": "Medium", 
    "heat": 10, 
    "link": "https://bugs.launchpad.net/nova/+bug/1515457", 
    "owner": "None", 
    "id": 1515457, 
    "index": 4380, 
    "openned": "2015-11-12 01:46:39.081523+00:00", 
    "created": "2015-11-12 01:46:39.081523+00:00", 
    "title": "Delete an instance created from volume would be unsuccessful if the connection_info has no volume_id", 
    "comments": [
        {
            "content": "description:\nwhen delete an instance created from the volume. It will get the volume metadata like this :\n    volume_id = connection_info['data']['volume_id']\nBut the connection_info has no volume_id. It will be error.\n\nversion :2014.1.\n\nRelevant log :\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2587, in do_terminate_instance\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     self._delete_instance(context, instance, bdms, quotas)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/hooks.py\", line 103, in inner\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     rv = f(*args, **kwargs)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2556, in _delete_instance\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     quotas.rollback()\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     six.reraise(self.type_, self.value, self.tb)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2528, in _delete_instance\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     self._shutdown_instance(context, db_inst, bdms)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2463, in _shutdown_instance\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     requested_networks)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     six.reraise(self.type_, self.value, self.tb)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/compute/manager.py\", line 2453, in _shutdown_instance\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     block_device_info)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1009, in destroy\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     destroy_disks)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 1098, in cleanup\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     volume_meta = self._get_volume_metadata(context, connection_info)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]   File \"/usr/lib/python2.7/site-packages/nova/virt/libvirt/driver.py\", line 3642, in _get_volume_metadata\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add]     raise exception.InvalidBDMVolume(id=volume_id)\n2015-11-12 17:03:52.676 6137 TRACE nova.compute.manager [instance: 4d6213cb-4761-49fb-a993-37833f5a6add] UnboundLocalError: local variable 'volume_id' referenced before assignment\n\nReproduce steps:\n1 create a volume named a from an image\n2 create an instance from the volume a\n3 delete the instance", 
            "date_created": "2015-11-12 01:46:39.081523+00:00", 
            "author": "https://api.launchpad.net/1.0/~liang-jingtao"
        }, 
        {
            "content": "added:\nthe volume is created with rbd backend.\n\ntks\n", 
            "date_created": "2015-11-12 01:52:42.146685+00:00", 
            "author": "https://api.launchpad.net/1.0/~liang-jingtao"
        }, 
        {
            "content": "@Bhargavi \n\nyeal\uff0c the release is icehouse 2014.1  which this issue was identified", 
            "date_created": "2016-03-08 00:54:50.252934+00:00", 
            "author": "https://api.launchpad.net/1.0/~liang-jingtao"
        }, 
        {
            "content": "I think we probably should double check this still happens, given it was reported on an old version of Nova.", 
            "date_created": "2016-07-14 10:41:04.827486+00:00", 
            "author": "https://api.launchpad.net/1.0/~johngarbutt"
        }, 
        {
            "content": "[Expired for OpenStack Compute (nova) because there has been no activity for 60 days.]", 
            "date_created": "2016-09-13 04:17:47.414548+00:00", 
            "author": "https://api.launchpad.net/1.0/~janitor"
        }
    ], 
    "closed": "2016-09-13 04:17:48.136241+00:00"
}