{
    "status": "Fix Released", 
    "last_updated": "2013-10-17 11:50:26.223492+00:00", 
    "description": "If user tries to update metadata of public image without write access nova generates 500 error with traceback to log: \n\n2013-06-26 08:41:40.543 ERROR nova.api.openstack [req-7c23c891-e55f-4edd-9c2f-6b77518ea20f d3003e4f8edf470b97744ca1641e8fd6 ae5f2ee3e4174257977b8b0b4ed348ba] Caught error: Not authorized for image dd29b70d-e517-49ef-86a0-b4d7bf668056.\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack Traceback (most recent call last):\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/__init__.py\", line 81, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return req.get_response(self.application)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/request.py\", line 1296, in send\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     application, catch_exc_info=False)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/request.py\", line 1260, in call_application\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 144, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/keystoneclient/middleware/auth_token.py\", line 451, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return self.app(env, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 144, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 144, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 144, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/Routes-1.12.3-py2.6.egg/routes/middleware.py\", line 131, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 144, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 130, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 195, in call_func\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 890, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     content_type, body, accept)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 942, in _process_stack\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 1022, in dispatch\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return method(req=request, **action_args)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/compute/image_metadata.py\", line 90, in update\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     self.image_service.update(context, image_id, image, None)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/image/glance.py\", line 315, in update\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     _reraise_translated_image_exception(image_id)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/image/glance.py\", line 313, in update\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     image_id, **image_meta)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/image/glance.py\", line 182, in call\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return getattr(client.images, method)(*args, **kwargs)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/glanceclient/v1/images.py\", line 288, in update\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     'PUT', url, headers=hdrs, body=image_data)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/glanceclient/common/http.py\", line 245, in raw_request\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return self._http_request(url, method, **kwargs)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/glanceclient/common/http.py\", line 206, in _http_request\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     raise exc.from_response(resp, body_str)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack ImageNotAuthorized: Not authorized for image dd29b70d-e517-49ef-86a0-b4d7bf668056.", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1194768", 
    "owner": "https://api.launchpad.net/1.0/~pavel-kirpichyov", 
    "id": 1194768, 
    "index": 5059, 
    "openned": "2013-06-26 08:15:07.840156+00:00", 
    "created": "2013-06-26 08:15:07.840156+00:00", 
    "title": "Updating metadata of unauthorized image gives 500 error", 
    "comments": [
        {
            "content": "If user tries to update metadata of public image without write access nova generates 500 error with traceback to log: \n\n2013-06-26 08:41:40.543 ERROR nova.api.openstack [req-7c23c891-e55f-4edd-9c2f-6b77518ea20f d3003e4f8edf470b97744ca1641e8fd6 ae5f2ee3e4174257977b8b0b4ed348ba] Caught error: Not authorized for image dd29b70d-e517-49ef-86a0-b4d7bf668056.\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack Traceback (most recent call last):\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/__init__.py\", line 81, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return req.get_response(self.application)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/request.py\", line 1296, in send\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     application, catch_exc_info=False)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/request.py\", line 1260, in call_application\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 144, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/keystoneclient/middleware/auth_token.py\", line 451, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return self.app(env, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 144, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 144, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 144, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/Routes-1.12.3-py2.6.egg/routes/middleware.py\", line 131, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 144, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return resp(environ, start_response)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 130, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/webob/dec.py\", line 195, in call_func\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 890, in __call__\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     content_type, body, accept)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 942, in _process_stack\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/wsgi.py\", line 1022, in dispatch\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return method(req=request, **action_args)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/api/openstack/compute/image_metadata.py\", line 90, in update\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     self.image_service.update(context, image_id, image, None)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/image/glance.py\", line 315, in update\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     _reraise_translated_image_exception(image_id)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/image/glance.py\", line 313, in update\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     image_id, **image_meta)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/nova/image/glance.py\", line 182, in call\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return getattr(client.images, method)(*args, **kwargs)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/glanceclient/v1/images.py\", line 288, in update\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     'PUT', url, headers=hdrs, body=image_data)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/glanceclient/common/http.py\", line 245, in raw_request\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     return self._http_request(url, method, **kwargs)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack   File \"/usr/lib/python2.6/site-packages/glanceclient/common/http.py\", line 206, in _http_request\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack     raise exc.from_response(resp, body_str)\n2013-06-26 08:41:40.543 8259 TRACE nova.api.openstack ImageNotAuthorized: Not authorized for image dd29b70d-e517-49ef-86a0-b4d7bf668056.", 
            "date_created": "2013-06-26 08:15:07.840156+00:00", 
            "author": "https://api.launchpad.net/1.0/~pavel-kirpichyov"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/34512", 
            "date_created": "2013-06-26 08:23:08.242116+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/34512\nCommitted: http://github.com/openstack/nova/commit/d851b332a23b132b22d382bf97c27ff9e94f94a1\nSubmitter: Jenkins\nBranch:    master\n\ncommit d851b332a23b132b22d382bf97c27ff9e94f94a1\nAuthor: Pavel Kirpichyov <email address hidden>\nDate:   Wed Jun 26 11:21:51 2013 +0300\n\n    Handle ImageNotAuthorized exception\n    \n    Handle ImageNotAuthorized exception if user have no access to update image metadata\n    \n    Change-Id: I558cc2c31174f7f619061882bfdab6df35203254\n    Fixes: bug #1194768\n", 
            "date_created": "2013-07-15 07:06:10.109347+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2013-07-17 12:25:23.700317+00:00"
}