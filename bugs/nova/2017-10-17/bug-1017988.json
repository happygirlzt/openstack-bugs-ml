{
    "status": "Fix Released", 
    "last_updated": "2012-09-27 15:24:04.256497+00:00", 
    "description": "nova boot --image 6c73d25e-df93-4c96-a803-9d419a367267 --flavor 16 --hint same_host=[df5fd16b-271d-45ac-9e9a-5d3ad33920e5] $instance_name\n\n2012-06-26 08:26:28 ERROR nova.rpc.amqp [req-67363fee-1046-4ff8-90a2-05aacb1cbe10 fe655fd0ad49474db5882931685c77fe 8f956f17ce9d4c4d9957c230aab4f720] Exception during message handling\n2012-06-26 08:26:28 TRACE nova.rpc.amqp Traceback (most recent call last):\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 252, in _process_data\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     rval = node_func(context=ctxt, **node_args)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/manager.py\", line 115, in run_instance\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     context, ex, *args, **kwargs)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     self.gen.next()\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/manager.py\", line 105, in run_instance\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     return self.driver.schedule_run_instance(*args, **kwargs)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/multi.py\", line 78, in schedule_run_instance\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     return self.drivers['compute'].schedule_run_instance(*args, **kwargs)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py\", line 72, in schedule_run_instance\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     *args, **kwargs)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py\", line 194, in _schedule\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     filter_properties)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/host_manager.py\", line 218, in filter_hosts\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     if host.passes_filters(filter_fns, filter_properties):\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/host_manager.py\", line 156, in passes_filters\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     if not filter_fn(self, filter_properties):\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/filters/affinity_filter.py\", line 64, in host_passes\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     if self._affinity_host(context, i) == me])\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/filters/affinity_filter.py\", line 30, in _affinity_host\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     return self.compute_api.get(context, instance_id)['host']\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/api.py\", line 1022, in get\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     instance = self.db.instance_get(context, instance_id)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 540, in instance_get\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     return IMPL.instance_get(context, instance_id)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 120, in wrapper\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     return f(*args, **kwargs)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 1339, in instance_get\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     raise exception.InstanceNotFound(instance_id=instance_id)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp InstanceNotFound: Instance [ could not be found.", 
    "tags": [], 
    "importance": "Medium", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1017988", 
    "owner": "https://api.launchpad.net/1.0/~vishvananda", 
    "id": 1017988, 
    "index": 2956, 
    "openned": "2012-06-26 15:42:13.756700+00:00", 
    "created": "2012-06-26 15:42:13.756700+00:00", 
    "title": "affinity filters can't handle single uuid and novaclient can't construct list", 
    "comments": [
        {
            "content": "nova boot --image 6c73d25e-df93-4c96-a803-9d419a367267 --flavor 16 --hint same_host=[df5fd16b-271d-45ac-9e9a-5d3ad33920e5] $instance_name\n\n2012-06-26 08:26:28 ERROR nova.rpc.amqp [req-67363fee-1046-4ff8-90a2-05aacb1cbe10 fe655fd0ad49474db5882931685c77fe 8f956f17ce9d4c4d9957c230aab4f720] Exception during message handling\n2012-06-26 08:26:28 TRACE nova.rpc.amqp Traceback (most recent call last):\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 252, in _process_data\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     rval = node_func(context=ctxt, **node_args)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/manager.py\", line 115, in run_instance\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     context, ex, *args, **kwargs)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     self.gen.next()\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/manager.py\", line 105, in run_instance\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     return self.driver.schedule_run_instance(*args, **kwargs)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/multi.py\", line 78, in schedule_run_instance\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     return self.drivers['compute'].schedule_run_instance(*args, **kwargs)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py\", line 72, in schedule_run_instance\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     *args, **kwargs)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/filter_scheduler.py\", line 194, in _schedule\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     filter_properties)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/host_manager.py\", line 218, in filter_hosts\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     if host.passes_filters(filter_fns, filter_properties):\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/host_manager.py\", line 156, in passes_filters\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     if not filter_fn(self, filter_properties):\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/filters/affinity_filter.py\", line 64, in host_passes\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     if self._affinity_host(context, i) == me])\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/scheduler/filters/affinity_filter.py\", line 30, in _affinity_host\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     return self.compute_api.get(context, instance_id)['host']\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/api.py\", line 1022, in get\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     instance = self.db.instance_get(context, instance_id)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 540, in instance_get\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     return IMPL.instance_get(context, instance_id)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 120, in wrapper\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     return f(*args, **kwargs)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 1339, in instance_get\n2012-06-26 08:26:28 TRACE nova.rpc.amqp     raise exception.InstanceNotFound(instance_id=instance_id)\n2012-06-26 08:26:28 TRACE nova.rpc.amqp InstanceNotFound: Instance [ could not be found.", 
            "date_created": "2012-06-26 15:42:13.756700+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/9002", 
            "date_created": "2012-06-26 15:43:40.568665+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/9006", 
            "date_created": "2012-06-26 16:41:22.304403+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "note that the [df5fd16b-271d-45ac-9e9a-5d3ad33920e5] syntax is incorrect but passing in just df5fd16b-271d-45ac-9e9a-5d3ad33920e5 also fails", 
            "date_created": "2012-06-26 17:38:22.342587+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "with the above fixes you can do:\n\nnova boot --image 6c73d25e-df93-4c96-a803-9d419a367267 --flavor 16 --hint same_host=df5fd16b-271d-45ac-9e9a-5d3ad33920e5 $instance_name\n\nto pass a single valueto a hint, or for example\n\nnova boot --image 6c73d25e-df93-4c96-a803-9d419a367267 --flavor 16 --hint different_host=df5fd16b-271d-45ac-9e9a-5d3ad33920e5 --hint different_host=193401f5-94fa-4809-a1f0-e7095c5741ed $instance_name\n\nto pass multiple values in a single hint.", 
            "date_created": "2012-06-26 17:40:24.625084+00:00", 
            "author": "https://api.launchpad.net/1.0/~vishvananda"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/9002\nCommitted: http://github.com/openstack/nova/commit/4cb634daba753ffd1f351ab69cb3ffcd23013274\nSubmitter: Jenkins\nBranch:    master\n\ncommit 4cb634daba753ffd1f351ab69cb3ffcd23013274\nAuthor: Vishvananda Ishaya <email address hidden>\nDate:   Tue Jun 26 08:42:42 2012 -0700\n\n    Allow single uuid to be specified for affinity.\n    \n     * Fixes bug 1017988\n     * Includes failing test for same_host and different_host\n    \n    Change-Id: I91263512a9f76436dce5a8f00d4d97f841d08fec\n", 
            "date_created": "2012-06-27 14:58:39.895450+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/9006\nCommitted: http://github.com/openstack/python-novaclient/commit/7546198cb042309ce89f5ddda3d783c41e76eca6\nSubmitter: Jenkins\nBranch:    master\n\ncommit 7546198cb042309ce89f5ddda3d783c41e76eca6\nAuthor: Vishvananda Ishaya <email address hidden>\nDate:   Tue Jun 26 09:40:22 2012 -0700\n\n    Turn multiple hints with the same key into a list\n    \n     * Related to bug 1017988\n    \n    Change-Id: I331191042d81fe857f0dac5421bf40b634cc23d5\n", 
            "date_created": "2012-06-27 16:51:55.592682+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }
    ], 
    "closed": "2012-07-04 08:28:59.526798+00:00"
}