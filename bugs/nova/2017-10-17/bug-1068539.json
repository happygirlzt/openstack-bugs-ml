{
    "status": "Fix Released", 
    "last_updated": "2013-04-04 10:59:43.499030+00:00", 
    "description": "Hello!\n\nI got the following error when i resized a instance:\n\ninstance: 98d7851b-ae9f-4e51-8f26-69d9bf77750d] Instance type 7 could not be found.. Setting instance vm_state to ERROR\n2012-10-18 18:11:30 DEBUG nova.utils [req-a9d58663-0907-459e-baf6-e5c244d08d53 2676663dbafd4440aed7c5434d907e30 a68f316b69054f0095863905ca847c2a] Got semapho\nre \"compute_resources\" for method \"update_usage\"... from (pid=19718) inner /usr/lib/python2.7/dist-packages/nova/utils.py:713\n2012-10-18 18:11:30 DEBUG nova.utils [req-a9d58663-0907-459e-baf6-e5c244d08d53 2676663dbafd4440aed7c5434d907e30 a68f316b69054f0095863905ca847c2a] Got semapho\nre \"compute_resources\" for method \"update_usage\"... from (pid=19718) inner /usr/lib/python2.7/dist-packages/nova/utils.py:713\n2012-10-18 18:11:30 ERROR nova.openstack.common.rpc.amqp [-] Exception during message handling\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 275, in _process_d\nata\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py\", line 145, in disp\natch\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 117, in wrapped\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 92, in wrapped\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kw)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 181, in decorated_function\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     pass\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 167, in decorated_function\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 202, in decorated_function\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     kwargs['instance']['uuid'], e, sys.exc_info())\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 196, in decorated_function\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1565, in resize_instance\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     migration_ref.new_instance_type_id)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 1443, in instance_type_get\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return IMPL.instance_type_get(context, id)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 129, in wrapper\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 3971, in instance_type_get\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     raise exception.InstanceTypeNotFound(instance_type_id=id)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp InstanceTypeNotFound: Instance type 7 could not be found.\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp \n\nthis only happens if there are deleted flavors with the same id.\nMaybe there is some mismatch in the  instance_type_get or in the migration table?\n\n\nThanks\n\nAlex", 
    "tags": [
        "flavor", 
        "instance-type", 
        "migration", 
        "resize"
    ], 
    "importance": "Low", 
    "heat": 22, 
    "link": "https://bugs.launchpad.net/nova/+bug/1068539", 
    "owner": "https://api.launchpad.net/1.0/~wenjianhn", 
    "id": 1068539, 
    "index": 679, 
    "openned": "2012-10-19 09:36:01.009434+00:00", 
    "created": "2012-10-19 09:36:01.009434+00:00", 
    "title": "resize instance: Instance type 7 could not be found..", 
    "comments": [
        {
            "content": "Hello!\n\nI got the following error when i resized a instance:\n\ninstance: 98d7851b-ae9f-4e51-8f26-69d9bf77750d] Instance type 7 could not be found.. Setting instance vm_state to ERROR\n2012-10-18 18:11:30 DEBUG nova.utils [req-a9d58663-0907-459e-baf6-e5c244d08d53 2676663dbafd4440aed7c5434d907e30 a68f316b69054f0095863905ca847c2a] Got semapho\nre \"compute_resources\" for method \"update_usage\"... from (pid=19718) inner /usr/lib/python2.7/dist-packages/nova/utils.py:713\n2012-10-18 18:11:30 DEBUG nova.utils [req-a9d58663-0907-459e-baf6-e5c244d08d53 2676663dbafd4440aed7c5434d907e30 a68f316b69054f0095863905ca847c2a] Got semapho\nre \"compute_resources\" for method \"update_usage\"... from (pid=19718) inner /usr/lib/python2.7/dist-packages/nova/utils.py:713\n2012-10-18 18:11:30 ERROR nova.openstack.common.rpc.amqp [-] Exception during message handling\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/amqp.py\", line 275, in _process_d\nata\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     rval = self.proxy.dispatch(ctxt, version, method, **args)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/openstack/common/rpc/dispatcher.py\", line 145, in disp\natch\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return getattr(proxyobj, method)(ctxt, **kwargs)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 117, in wrapped\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     temp_level, payload)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/exception.py\", line 92, in wrapped\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kw)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 181, in decorated_function\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     pass\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 167, in decorated_function\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 202, in decorated_function\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     kwargs['instance']['uuid'], e, sys.exc_info())\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/contextlib.py\", line 24, in __exit__\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     self.gen.next()\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 196, in decorated_function\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 1565, in resize_instance\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     migration_ref.new_instance_type_id)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 1443, in instance_type_get\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return IMPL.instance_type_get(context, id)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 129, in wrapper\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 3971, in instance_type_get\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp     raise exception.InstanceTypeNotFound(instance_type_id=id)\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp InstanceTypeNotFound: Instance type 7 could not be found.\n2012-10-18 18:11:30 TRACE nova.openstack.common.rpc.amqp \n\nthis only happens if there are deleted flavors with the same id.\nMaybe there is some mismatch in the  instance_type_get or in the migration table?\n\n\nThanks\n\nAlex", 
            "date_created": "2012-10-19 09:36:01.009434+00:00", 
            "author": "https://api.launchpad.net/1.0/~alexhandle"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/15344", 
            "date_created": "2012-11-04 08:50:20.221881+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/15344\nCommitted: http://github.com/openstack/nova/commit/25743e4fc3dc845afacebe7f790c11cf35fbadea\nSubmitter: Jenkins\nBranch:    master\n\ncommit 25743e4fc3dc845afacebe7f790c11cf35fbadea\nAuthor: Jian Wen <email address hidden>\nDate:   Sun Nov 4 15:39:51 2012 +0800\n\n    Forbid resizing instance to deleted instance types\n    \n    Sets read_deleted=\"no\" while get_instance_type_by_flavor_id to forbid\n    resizing instance to deleted instance types\n    \n    Fixes bug 1068539\n    \n    Change-Id: I3859f63a33391a840e041f06f08af361b6d64157\n", 
            "date_created": "2012-11-07 08:14:23.976369+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "NOTE:\nFix Committed to folsom, not essex.", 
            "date_created": "2012-11-07 08:19:08.122252+00:00", 
            "author": "https://api.launchpad.net/1.0/~wenjianhn"
        }
    ], 
    "closed": "2012-11-21 10:00:23.661421+00:00"
}