{
    "status": "Invalid", 
    "last_updated": "2015-08-24 08:25:25.029201+00:00", 
    "description": "I have a setup consisting of controller + network + 2 x compute nodes. The compute nodes have 8 cores each and use only local storage for VMs.\n\nInitially on controller 1 I have 3 VMs running with one VCPU for each of them:\n\n2014-04-17 05:06:18.985 2137 INFO nova.compute.resource_tracker [-] Compute_service record updated for mz216srv014.mds.t-mobile.net:mz216srv014.mds.t-mobile.net\n2014-04-17 05:06:38.244 2137 AUDIT nova.compute.resource_tracker [-] Auditing locally available compute resources\n2014-04-17 05:06:38.605 2137 AUDIT nova.compute.resource_tracker [-] Free ram (MB): 25450\n2014-04-17 05:06:38.605 2137 AUDIT nova.compute.resource_tracker [-] Free disk (GB): 207\n2014-04-17 05:06:38.606 2137 AUDIT nova.compute.resource_tracker [-] Free VCPUS: 5\n\n\nWhen I tried to migrate a VM from compute 1 to compute 2 I got the next error due to a missing ssh cert setup:\n\n2014-04-17 05:06:38.636 2137 INFO nova.compute.resource_tracker [-] Compute_service record updated for mz216srv014.mds.t-mobile.net:mz216srv014.mds.t-mobile.net\n2014-04-17 15:29:57.239 2137 ERROR nova.compute.manager [req-74924eff-3043-473a-a38a-7341945826fc 90aec6fcee154bb3896301a8f98077ac 9053ec1b088240d7a0844e479343097d] [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Setting instance vm_state to ERROR\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Traceback (most recent call last):\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 5536, in _error_out_instance_on_exception\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]     yield\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3438, in resize_instance\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]     block_device_info)\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 4883, in migrate_disk_and_power_off\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]     utils.execute('ssh', dest, 'mkdir', '-p', inst_base)\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 164, in execute\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]     return processutils.execute(*cmd, **kwargs)\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 193, in execute\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]     cmd=' '.join(cmd))\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] ProcessExecutionError: Unexpected error while running command.\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Command: ssh 192.168.119.15 mkdir -p /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Exit code: 255\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Stdout: ''\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Stderr: 'Host key verification failed.\\r\\n'\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] \n2014-04-17 15:29:57.625 2137 ERROR oslo.messaging.rpc.dispatcher [-] Exception during message handling: Unexpected error while running command.\nCommand: ssh 192.168.119.15 mkdir -p /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\nExit code: 255\nStdout: ''\nStderr: 'Host key verification failed.\\r\\n'\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     incoming.message))\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 88, in wrapped\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     payload)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 71, in wrapped\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 280, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     pass\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 266, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 333, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     function(self, context, *args, **kwargs)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 254, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     break\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 235, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 309, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     e, sys.exc_info())\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 296, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3438, in resize_instance\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     block_device_info)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 4883, in migrate_disk_and_power_off\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     utils.execute('ssh', dest, 'mkdir', '-p', inst_base)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 164, in execute\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return processutils.execute(*cmd, **kwargs)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 193, in execute\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     cmd=' '.join(cmd))\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher ProcessExecutionError: Unexpected error while running command.\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher Command: ssh 192.168.119.15 mkdir -p /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher Exit code: 255\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher Stdout: ''\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher Stderr: 'Host key verification failed.\\r\\n'\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher \n2014-04-17 15:29:57.638 2137 ERROR oslo.messaging._drivers.common [-] Returning exception Unexpected error while running command.\nCommand: ssh 192.168.119.15 mkdir -p /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\nExit code: 255\nStdout: ''\nStderr: 'Host key verification failed.\\r\\n' to caller\n2014-04-17 15:29:57.638 2137 ERROR oslo.messaging._drivers.common [-] ['Traceback (most recent call last):\\n', '  File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\\n    incoming.message))\\n', '  File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\\n    return self._do_dispatch(endpoint, method, ctxt, args)\\n', '  File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\\n    result = getattr(endpoint, method)(ctxt, **new_args)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 88, in wrapped\\n    payload)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 71, in wrapped\\n    return f(self, context, *args, **kw)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 280, in decorated_function\\n    pass\\n', '  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 266, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 333, in decorated_function\\n    function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 254, in decorated_function\\n    break\\n', '  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 235, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 309, in decorated_function\\n    e, sys.exc_info())\\n', '  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 296, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3438, in resize_instance\\n    block_device_info)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 4883, in migrate_disk_and_power_off\\n    utils.execute(\\'ssh\\', dest, \\'mkdir\\', \\'-p\\', inst_base)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 164, in execute\\n    return processutils.execute(*cmd, **kwargs)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 193, in execute\\n    cmd=\\' \\'.join(cmd))\\n', \"ProcessExecutionError: Unexpected error while running command.\\nCommand: ssh 192.168.119.15 mkdir -p /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\\nExit code: 255\\nStdout: ''\\nStderr: 'Host key verification failed.\\\\r\\\\n'\\n\"]\n\n\nThe only option I had after this error was to terminate the VM, that was processed succesfully:\n\n2014-04-17 15:30:22.354 2137 AUDIT nova.compute.manager [req-4ebca1b2-7084-402a-ae4a-f6f9a0702de7 90aec6fcee154bb3896301a8f98077ac 9053ec1b088240d7a0844e479343097d] [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Terminating instance\n2014-04-17 15:30:23.176 2137 INFO nova.virt.libvirt.driver [-] [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Instance destroyed successfully.\n2014-04-17 15:30:23.840 2137 INFO nova.virt.libvirt.driver [req-4ebca1b2-7084-402a-ae4a-f6f9a0702de7 90aec6fcee154bb3896301a8f98077ac 9053ec1b088240d7a0844e479343097d] [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Deleting instance files /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\n2014-04-17 15:30:23.853 2137 INFO nova.virt.libvirt.driver [req-4ebca1b2-7084-402a-ae4a-f6f9a0702de7 90aec6fcee154bb3896301a8f98077ac 9053ec1b088240d7a0844e479343097d] [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Deletion of /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735 complete\n\n\nThe status of the hypervisor is invalid as now is reporting 3 used VCPUs instead of only 2:\n\n[root@mz216srv013 ceilometer(openrc admin)]# nova hypervisor-list\n+----+------------------------------+\n| ID | Hypervisor hostname          |\n+----+------------------------------+\n| 1  | mz216srv014 |\n| 2  | mz216srv015 |\n+----+------------------------------+\n[root@mz216srv013 ceilometer(openrc admin)]# nova hypervisor-show mz216srv014\n+---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+\n| Property                  | Value                                                                                                                                         |\n+---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+\n| cpu_info_arch             | x86_64                                                                                                                                        |\n| cpu_info_features         | [\"osxsave\", \"xsave\", \"dca\", \"pdcm\", \"xtpr\", \"tm2\", \"est\", \"vmx\", \"ds_cpl\", \"monitor\", \"dtes64\", \"pbe\", \"tm\", \"ht\", \"ss\", \"acpi\", \"ds\", \"vme\"] |\n| cpu_info_model            | Penryn                                                                                                                                        |\n| cpu_info_topology_cores   | 4                                                                                                                                             |\n| cpu_info_topology_sockets | 2                                                                                                                                             |\n| cpu_info_topology_threads | 1                                                                                                                                             |\n| cpu_info_vendor           | Intel                                                                                                                                         |\n| current_workload          | 0                                                                                                                                             |\n| disk_available_least      | 190                                                                                                                                           |\n| free_disk_gb              | 207                                                                                                                                           |\n| free_ram_mb               | 25450                                                                                                                                         |\n| host_ip                   | 192.168.119.14                                                                                                                                |\n| hypervisor_hostname       | mz216srv014                                                                                                                  |\n| hypervisor_type           | QEMU                                                                                                                                          |\n| hypervisor_version        | 12001                                                                                                                                         |\n| id                        | 1                                                                                                                                             |\n| local_gb                  | 267                                                                                                                                           |\n| local_gb_used             | 60                                                                                                                                            |\n| memory_mb                 | 32106                                                                                                                                         |\n| memory_mb_used            | 6656                                                                                                                                          |\n| running_vms               | 3                                                                                                                                             |\n| service_host              | mz216srv014                                                                                                                  |\n| service_id                | 5                                                                                                                                             |\n| vcpus                     | 8                                                                                                                                             |\n| vcpus_used                | 3                                                                                                                                             |\n+---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+\n\n\n\n[root@mz216srv013 ceilometer(openrc admin)]# nova hypervisor-servers mz216srv014\n+--------------------------------------+-------------------+---------------+------------------------------+\n| ID                                   | Name              | Hypervisor ID | Hypervisor Hostname          |\n+--------------------------------------+-------------------+---------------+------------------------------+\n| ce15230b-233c-43eb-b669-bc1cc5fdf751 | instance-00000007 | 1             | mz216srv014 |\n| e7fc4f47-c1a6-464e-8ac4-ddcf2e0b9ba9 | instance-00000008 | 1             | mz216srv014 |\n+--------------------------------------+-------------------+---------------+------------------------------+\n\n\n\n[root@mz216srv013 ceilometer(openrc admin)]# nova show ce15230b-233c-43eb-b669-bc1cc5fdf751\n+--------------------------------------+---------------------------------------------------------------------+\n| Property                             | Value                                                               |\n+--------------------------------------+---------------------------------------------------------------------+\n| OS-DCF:diskConfig                    | AUTO                                                                |\n| OS-EXT-AZ:availability_zone          | nova                                                                |\n| OS-EXT-SRV-ATTR:host                 | mz216srv014                                        |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | mz216srv014                                        |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000007                                                   |\n| OS-EXT-STS:power_state               | 1                                                                   |\n| OS-EXT-STS:task_state                | -                                                                   |\n| OS-EXT-STS:vm_state                  | active                                                              |\n| OS-SRV-USG:launched_at               | 2014-04-16T15:48:10.000000                                          |\n| OS-SRV-USG:terminated_at             | -                                                                   |\n| accessIPv4                           |                                                                     |\n| accessIPv6                           |                                                                     |\n| config_drive                         |                                                                     |\n| created                              | 2014-04-16T14:48:17Z                                                |\n| demo-net network                     | 192.1.1.4, 192.168.121.102                                          |\n| flavor                               | m1.small (2)                                                        |\n| hostId                               | 7ec798860994fe15b8feb629a91d479835b6676fd41307f4392288ee            |\n| id                                   | ce15230b-233c-43eb-b669-bc1cc5fdf751                                |\n| image                                | centos-6.5-20140117.0.x86_64 (15274978-d3b4-4cae-8894-3f1ee8cad864) |\n| key_name                             | kp-demo                                                             |\n| metadata                             | {}                                                                  |\n| name                                 | centos-demo2                                                        |\n| os-extended-volumes:volumes_attached | []                                                                  |\n| progress                             | 0                                                                   |\n| security_groups                      | demo                                                                |\n| status                               | ACTIVE                                                              |\n| tenant_id                            | 0545f88dc3d34f7e91da510a0199e4a3                                    |\n| updated                              | 2014-04-17T00:44:23Z                                                |\n| user_id                              | aa9837d2815e471b844fded4fe7d4271                                    |\n+--------------------------------------+---------------------------------------------------------------------+\n\n\n\n[root@mz216srv013 ceilometer(openrc admin)]# nova show e7fc4f47-c1a6-464e-8ac4-ddcf2e0b9ba9\n+--------------------------------------+---------------------------------------------------------------------+\n| Property                             | Value                                                               |\n+--------------------------------------+---------------------------------------------------------------------+\n| OS-DCF:diskConfig                    | AUTO                                                                |\n| OS-EXT-AZ:availability_zone          | nova                                                                |\n| OS-EXT-SRV-ATTR:host                 | mz216srv014                                        |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | mz216srv014                                        |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000008                                                   |\n| OS-EXT-STS:power_state               | 1                                                                   |\n| OS-EXT-STS:task_state                | -                                                                   |\n| OS-EXT-STS:vm_state                  | active                                                              |\n| OS-SRV-USG:launched_at               | 2014-04-16T16:23:12.000000                                          |\n| OS-SRV-USG:terminated_at             | -                                                                   |\n| accessIPv4                           |                                                                     |\n| accessIPv6                           |                                                                     |\n| config_drive                         |                                                                     |\n| created                              | 2014-04-16T17:24:45Z                                                |\n| demo-net network                     | 192.1.1.5                                                           |\n| demo-net-2 network                   | 192.1.2.3, 192.168.121.101                                          |\n| flavor                               | m1.small (2)                                                        |\n| hostId                               | 7ec798860994fe15b8feb629a91d479835b6676fd41307f4392288ee            |\n| id                                   | e7fc4f47-c1a6-464e-8ac4-ddcf2e0b9ba9                                |\n| image                                | centos-6.5-20140117.0.x86_64 (15274978-d3b4-4cae-8894-3f1ee8cad864) |\n| key_name                             | kp-demo                                                             |\n| metadata                             | {}                                                                  |\n| name                                 | centos-demo1                                                        |\n| os-extended-volumes:volumes_attached | []                                                                  |\n| progress                             | 0                                                                   |\n| security_groups                      | demo, demo                                                          |\n| status                               | ACTIVE                                                              |\n| tenant_id                            | 0545f88dc3d34f7e91da510a0199e4a3                                    |\n| updated                              | 2014-04-17T00:44:15Z                                                |\n| user_id                              | aa9837d2815e471b844fded4fe7d4271                                    |\n+--------------------------------------+---------------------------------------------------------------------+\n\n\n\n[root@mz216srv013 ceilometer(openrc admin)]# nova flavor-show m1.small\n+----------------------------+----------+\n| Property                   | Value    |\n+----------------------------+----------+\n| OS-FLV-DISABLED:disabled   | False    |\n| OS-FLV-EXT-DATA:ephemeral  | 0        |\n| disk                       | 20       |\n| extra_specs                | {}       |\n| id                         | 2        |\n| name                       | m1.small |\n| os-flavor-access:is_public | True     |\n| ram                        | 2048     |\n| rxtx_factor                | 1.0      |\n| swap                       |          |\n| vcpus                      | 1        |\n+----------------------------+----------+", 
    "tags": [
        "compute"
    ], 
    "importance": "High", 
    "heat": 14, 
    "link": "https://bugs.launchpad.net/nova/+bug/1309058", 
    "owner": "https://api.launchpad.net/1.0/~zhenzan-zhou", 
    "id": 1309058, 
    "index": 1480, 
    "openned": "2014-04-17 15:01:24.248887+00:00", 
    "created": "2014-04-17 15:01:24.248887+00:00", 
    "title": "Invalid vcpus_used count after failed migration", 
    "comments": [
        {
            "content": "I have a setup consisting of controller + network + 2 x compute nodes. The compute nodes have 8 cores each and use only local storage for VMs.\n\nInitially on controller 1 I have 3 VMs running with one VCPU for each of them:\n\n2014-04-17 05:06:18.985 2137 INFO nova.compute.resource_tracker [-] Compute_service record updated for mz216srv014.mds.t-mobile.net:mz216srv014.mds.t-mobile.net\n2014-04-17 05:06:38.244 2137 AUDIT nova.compute.resource_tracker [-] Auditing locally available compute resources\n2014-04-17 05:06:38.605 2137 AUDIT nova.compute.resource_tracker [-] Free ram (MB): 25450\n2014-04-17 05:06:38.605 2137 AUDIT nova.compute.resource_tracker [-] Free disk (GB): 207\n2014-04-17 05:06:38.606 2137 AUDIT nova.compute.resource_tracker [-] Free VCPUS: 5\n\n\nWhen I tried to migrate a VM from compute 1 to compute 2 I got the next error due to a missing ssh cert setup:\n\n2014-04-17 05:06:38.636 2137 INFO nova.compute.resource_tracker [-] Compute_service record updated for mz216srv014.mds.t-mobile.net:mz216srv014.mds.t-mobile.net\n2014-04-17 15:29:57.239 2137 ERROR nova.compute.manager [req-74924eff-3043-473a-a38a-7341945826fc 90aec6fcee154bb3896301a8f98077ac 9053ec1b088240d7a0844e479343097d] [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Setting instance vm_state to ERROR\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Traceback (most recent call last):\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 5536, in _error_out_instance_on_exception\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]     yield\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3438, in resize_instance\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]     block_device_info)\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 4883, in migrate_disk_and_power_off\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]     utils.execute('ssh', dest, 'mkdir', '-p', inst_base)\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 164, in execute\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]     return processutils.execute(*cmd, **kwargs)\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 193, in execute\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735]     cmd=' '.join(cmd))\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] ProcessExecutionError: Unexpected error while running command.\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Command: ssh 192.168.119.15 mkdir -p /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Exit code: 255\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Stdout: ''\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Stderr: 'Host key verification failed.\\r\\n'\n2014-04-17 15:29:57.239 2137 TRACE nova.compute.manager [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] \n2014-04-17 15:29:57.625 2137 ERROR oslo.messaging.rpc.dispatcher [-] Exception during message handling: Unexpected error while running command.\nCommand: ssh 192.168.119.15 mkdir -p /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\nExit code: 255\nStdout: ''\nStderr: 'Host key verification failed.\\r\\n'\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher Traceback (most recent call last):\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     incoming.message))\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return self._do_dispatch(endpoint, method, ctxt, args)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     result = getattr(endpoint, method)(ctxt, **new_args)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 88, in wrapped\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     payload)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 71, in wrapped\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return f(self, context, *args, **kw)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 280, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     pass\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 266, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 333, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     function(self, context, *args, **kwargs)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 254, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     break\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 235, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 309, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     e, sys.exc_info())\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     six.reraise(self.type_, self.value, self.tb)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 296, in decorated_function\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return function(self, context, *args, **kwargs)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3438, in resize_instance\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     block_device_info)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 4883, in migrate_disk_and_power_off\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     utils.execute('ssh', dest, 'mkdir', '-p', inst_base)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 164, in execute\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     return processutils.execute(*cmd, **kwargs)\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher   File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 193, in execute\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher     cmd=' '.join(cmd))\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher ProcessExecutionError: Unexpected error while running command.\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher Command: ssh 192.168.119.15 mkdir -p /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher Exit code: 255\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher Stdout: ''\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher Stderr: 'Host key verification failed.\\r\\n'\n2014-04-17 15:29:57.625 2137 TRACE oslo.messaging.rpc.dispatcher \n2014-04-17 15:29:57.638 2137 ERROR oslo.messaging._drivers.common [-] Returning exception Unexpected error while running command.\nCommand: ssh 192.168.119.15 mkdir -p /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\nExit code: 255\nStdout: ''\nStderr: 'Host key verification failed.\\r\\n' to caller\n2014-04-17 15:29:57.638 2137 ERROR oslo.messaging._drivers.common [-] ['Traceback (most recent call last):\\n', '  File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 133, in _dispatch_and_reply\\n    incoming.message))\\n', '  File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 176, in _dispatch\\n    return self._do_dispatch(endpoint, method, ctxt, args)\\n', '  File \"/usr/lib/python2.6/site-packages/oslo/messaging/rpc/dispatcher.py\", line 122, in _do_dispatch\\n    result = getattr(endpoint, method)(ctxt, **new_args)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 88, in wrapped\\n    payload)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/exception.py\", line 71, in wrapped\\n    return f(self, context, *args, **kw)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 280, in decorated_function\\n    pass\\n', '  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 266, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 333, in decorated_function\\n    function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 254, in decorated_function\\n    break\\n', '  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 235, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 309, in decorated_function\\n    e, sys.exc_info())\\n', '  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/excutils.py\", line 68, in __exit__\\n    six.reraise(self.type_, self.value, self.tb)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 296, in decorated_function\\n    return function(self, context, *args, **kwargs)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/compute/manager.py\", line 3438, in resize_instance\\n    block_device_info)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/virt/libvirt/driver.py\", line 4883, in migrate_disk_and_power_off\\n    utils.execute(\\'ssh\\', dest, \\'mkdir\\', \\'-p\\', inst_base)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/utils.py\", line 164, in execute\\n    return processutils.execute(*cmd, **kwargs)\\n', '  File \"/usr/lib/python2.6/site-packages/nova/openstack/common/processutils.py\", line 193, in execute\\n    cmd=\\' \\'.join(cmd))\\n', \"ProcessExecutionError: Unexpected error while running command.\\nCommand: ssh 192.168.119.15 mkdir -p /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\\nExit code: 255\\nStdout: ''\\nStderr: 'Host key verification failed.\\\\r\\\\n'\\n\"]\n\n\nThe only option I had after this error was to terminate the VM, that was processed succesfully:\n\n2014-04-17 15:30:22.354 2137 AUDIT nova.compute.manager [req-4ebca1b2-7084-402a-ae4a-f6f9a0702de7 90aec6fcee154bb3896301a8f98077ac 9053ec1b088240d7a0844e479343097d] [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Terminating instance\n2014-04-17 15:30:23.176 2137 INFO nova.virt.libvirt.driver [-] [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Instance destroyed successfully.\n2014-04-17 15:30:23.840 2137 INFO nova.virt.libvirt.driver [req-4ebca1b2-7084-402a-ae4a-f6f9a0702de7 90aec6fcee154bb3896301a8f98077ac 9053ec1b088240d7a0844e479343097d] [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Deleting instance files /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735\n2014-04-17 15:30:23.853 2137 INFO nova.virt.libvirt.driver [req-4ebca1b2-7084-402a-ae4a-f6f9a0702de7 90aec6fcee154bb3896301a8f98077ac 9053ec1b088240d7a0844e479343097d] [instance: c852434a-5172-4eb5-ad6d-9c7dbaa35735] Deletion of /var/lib/nova/instances/c852434a-5172-4eb5-ad6d-9c7dbaa35735 complete\n\n\nThe status of the hypervisor is invalid as now is reporting 3 used VCPUs instead of only 2:\n\n[root@mz216srv013 ceilometer(openrc admin)]# nova hypervisor-list\n+----+------------------------------+\n| ID | Hypervisor hostname          |\n+----+------------------------------+\n| 1  | mz216srv014 |\n| 2  | mz216srv015 |\n+----+------------------------------+\n[root@mz216srv013 ceilometer(openrc admin)]# nova hypervisor-show mz216srv014\n+---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+\n| Property                  | Value                                                                                                                                         |\n+---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+\n| cpu_info_arch             | x86_64                                                                                                                                        |\n| cpu_info_features         | [\"osxsave\", \"xsave\", \"dca\", \"pdcm\", \"xtpr\", \"tm2\", \"est\", \"vmx\", \"ds_cpl\", \"monitor\", \"dtes64\", \"pbe\", \"tm\", \"ht\", \"ss\", \"acpi\", \"ds\", \"vme\"] |\n| cpu_info_model            | Penryn                                                                                                                                        |\n| cpu_info_topology_cores   | 4                                                                                                                                             |\n| cpu_info_topology_sockets | 2                                                                                                                                             |\n| cpu_info_topology_threads | 1                                                                                                                                             |\n| cpu_info_vendor           | Intel                                                                                                                                         |\n| current_workload          | 0                                                                                                                                             |\n| disk_available_least      | 190                                                                                                                                           |\n| free_disk_gb              | 207                                                                                                                                           |\n| free_ram_mb               | 25450                                                                                                                                         |\n| host_ip                   | 192.168.119.14                                                                                                                                |\n| hypervisor_hostname       | mz216srv014                                                                                                                  |\n| hypervisor_type           | QEMU                                                                                                                                          |\n| hypervisor_version        | 12001                                                                                                                                         |\n| id                        | 1                                                                                                                                             |\n| local_gb                  | 267                                                                                                                                           |\n| local_gb_used             | 60                                                                                                                                            |\n| memory_mb                 | 32106                                                                                                                                         |\n| memory_mb_used            | 6656                                                                                                                                          |\n| running_vms               | 3                                                                                                                                             |\n| service_host              | mz216srv014                                                                                                                  |\n| service_id                | 5                                                                                                                                             |\n| vcpus                     | 8                                                                                                                                             |\n| vcpus_used                | 3                                                                                                                                             |\n+---------------------------+-----------------------------------------------------------------------------------------------------------------------------------------------+\n\n\n\n[root@mz216srv013 ceilometer(openrc admin)]# nova hypervisor-servers mz216srv014\n+--------------------------------------+-------------------+---------------+------------------------------+\n| ID                                   | Name              | Hypervisor ID | Hypervisor Hostname          |\n+--------------------------------------+-------------------+---------------+------------------------------+\n| ce15230b-233c-43eb-b669-bc1cc5fdf751 | instance-00000007 | 1             | mz216srv014 |\n| e7fc4f47-c1a6-464e-8ac4-ddcf2e0b9ba9 | instance-00000008 | 1             | mz216srv014 |\n+--------------------------------------+-------------------+---------------+------------------------------+\n\n\n\n[root@mz216srv013 ceilometer(openrc admin)]# nova show ce15230b-233c-43eb-b669-bc1cc5fdf751\n+--------------------------------------+---------------------------------------------------------------------+\n| Property                             | Value                                                               |\n+--------------------------------------+---------------------------------------------------------------------+\n| OS-DCF:diskConfig                    | AUTO                                                                |\n| OS-EXT-AZ:availability_zone          | nova                                                                |\n| OS-EXT-SRV-ATTR:host                 | mz216srv014                                        |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | mz216srv014                                        |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000007                                                   |\n| OS-EXT-STS:power_state               | 1                                                                   |\n| OS-EXT-STS:task_state                | -                                                                   |\n| OS-EXT-STS:vm_state                  | active                                                              |\n| OS-SRV-USG:launched_at               | 2014-04-16T15:48:10.000000                                          |\n| OS-SRV-USG:terminated_at             | -                                                                   |\n| accessIPv4                           |                                                                     |\n| accessIPv6                           |                                                                     |\n| config_drive                         |                                                                     |\n| created                              | 2014-04-16T14:48:17Z                                                |\n| demo-net network                     | 192.1.1.4, 192.168.121.102                                          |\n| flavor                               | m1.small (2)                                                        |\n| hostId                               | 7ec798860994fe15b8feb629a91d479835b6676fd41307f4392288ee            |\n| id                                   | ce15230b-233c-43eb-b669-bc1cc5fdf751                                |\n| image                                | centos-6.5-20140117.0.x86_64 (15274978-d3b4-4cae-8894-3f1ee8cad864) |\n| key_name                             | kp-demo                                                             |\n| metadata                             | {}                                                                  |\n| name                                 | centos-demo2                                                        |\n| os-extended-volumes:volumes_attached | []                                                                  |\n| progress                             | 0                                                                   |\n| security_groups                      | demo                                                                |\n| status                               | ACTIVE                                                              |\n| tenant_id                            | 0545f88dc3d34f7e91da510a0199e4a3                                    |\n| updated                              | 2014-04-17T00:44:23Z                                                |\n| user_id                              | aa9837d2815e471b844fded4fe7d4271                                    |\n+--------------------------------------+---------------------------------------------------------------------+\n\n\n\n[root@mz216srv013 ceilometer(openrc admin)]# nova show e7fc4f47-c1a6-464e-8ac4-ddcf2e0b9ba9\n+--------------------------------------+---------------------------------------------------------------------+\n| Property                             | Value                                                               |\n+--------------------------------------+---------------------------------------------------------------------+\n| OS-DCF:diskConfig                    | AUTO                                                                |\n| OS-EXT-AZ:availability_zone          | nova                                                                |\n| OS-EXT-SRV-ATTR:host                 | mz216srv014                                        |\n| OS-EXT-SRV-ATTR:hypervisor_hostname  | mz216srv014                                        |\n| OS-EXT-SRV-ATTR:instance_name        | instance-00000008                                                   |\n| OS-EXT-STS:power_state               | 1                                                                   |\n| OS-EXT-STS:task_state                | -                                                                   |\n| OS-EXT-STS:vm_state                  | active                                                              |\n| OS-SRV-USG:launched_at               | 2014-04-16T16:23:12.000000                                          |\n| OS-SRV-USG:terminated_at             | -                                                                   |\n| accessIPv4                           |                                                                     |\n| accessIPv6                           |                                                                     |\n| config_drive                         |                                                                     |\n| created                              | 2014-04-16T17:24:45Z                                                |\n| demo-net network                     | 192.1.1.5                                                           |\n| demo-net-2 network                   | 192.1.2.3, 192.168.121.101                                          |\n| flavor                               | m1.small (2)                                                        |\n| hostId                               | 7ec798860994fe15b8feb629a91d479835b6676fd41307f4392288ee            |\n| id                                   | e7fc4f47-c1a6-464e-8ac4-ddcf2e0b9ba9                                |\n| image                                | centos-6.5-20140117.0.x86_64 (15274978-d3b4-4cae-8894-3f1ee8cad864) |\n| key_name                             | kp-demo                                                             |\n| metadata                             | {}                                                                  |\n| name                                 | centos-demo1                                                        |\n| os-extended-volumes:volumes_attached | []                                                                  |\n| progress                             | 0                                                                   |\n| security_groups                      | demo, demo                                                          |\n| status                               | ACTIVE                                                              |\n| tenant_id                            | 0545f88dc3d34f7e91da510a0199e4a3                                    |\n| updated                              | 2014-04-17T00:44:15Z                                                |\n| user_id                              | aa9837d2815e471b844fded4fe7d4271                                    |\n+--------------------------------------+---------------------------------------------------------------------+\n\n\n\n[root@mz216srv013 ceilometer(openrc admin)]# nova flavor-show m1.small\n+----------------------------+----------+\n| Property                   | Value    |\n+----------------------------+----------+\n| OS-FLV-DISABLED:disabled   | False    |\n| OS-FLV-EXT-DATA:ephemeral  | 0        |\n| disk                       | 20       |\n| extra_specs                | {}       |\n| id                         | 2        |\n| name                       | m1.small |\n| os-flavor-access:is_public | True     |\n| ram                        | 2048     |\n| rxtx_factor                | 1.0      |\n| swap                       |          |\n| vcpus                      | 1        |\n+----------------------------+----------+", 
            "date_created": "2014-04-17 15:01:24.248887+00:00", 
            "author": "https://api.launchpad.net/1.0/~hvlad"
        }, 
        {
            "content": "It looks this issue is gone with latest Liberty code. I tried the same steps in my devstack environment.  The 'Host key verification failed' error won't make VM into error state any more. The VM will keep running in the original host.  As one of the results, the vcpu count has correct value now.", 
            "date_created": "2015-08-21 07:32:58.160827+00:00", 
            "author": "https://api.launchpad.net/1.0/~zhenzan-zhou"
        }, 
        {
            "content": "ubuntu@node-01:~$ nova list\n+--------------------------------------+------------+--------+------------+-------------+--------------------+\n| ID                                   | Name       | Status | Task State | Power State | Networks           |\n+--------------------------------------+------------+--------+------------+-------------+--------------------+\n| 478da6af-c394-4730-9fcf-5c75d8451da9 | demo       | ACTIVE | -          | Running     | private=172.28.0.7 |   <== on node-01\n| 932c8b17-404c-4c8f-893f-38e54f3b6e84 | local-demo | ACTIVE | -          | Running     | private=172.28.0.8 |   <== on node-02\n+--------------------------------------+------------+--------+------------+-------------+--------------------+\nubuntu@node-01:~$ nova live-migration --block-migrate local-demo\nubuntu@node-01:~$ nova list\n+--------------------------------------+------------+--------+------------+-------------+--------------------+\n| ID                                   | Name       | Status | Task State | Power State | Networks           |\n+--------------------------------------+------------+--------+------------+-------------+--------------------+\n| 478da6af-c394-4730-9fcf-5c75d8451da9 | demo       | ACTIVE | -          | Running     | private=172.28.0.7 |\n| 932c8b17-404c-4c8f-893f-38e54f3b6e84 | local-demo | ACTIVE | -          | Running     | private=172.28.0.8 |  <== still running on node-02\n+--------------------------------------+------------+--------+------------+-------------+--------------------+\n\nFrom source node n-cpu.log:\n\nlibvirtError: operation failed: Failed to connect to remote libvirt URI qemu+ssh://ubuntu@node-01/system: Cannot recv data: Host key verification failed.: Connection reset by peer\n2015-08-21 07:45:17.035 INFO nova.compute.resource_tracker [req-8eed6095-2689-4e29-8334-6eb75b6016ff None None] Au                                                      diting locally available compute resources for node node-02\n2015-08-21 07:45:17.501 ERROR nova.virt.libvirt.driver [req-6540df4b-d22e-459b-bfaf-e7a264991b92 admin admin] [instance: 93                                             2c8b17-404c-4c8f-893f-38e54f3b6e84] Migration operation has aborted\n\nSo mark it as fixed, but I don't know which commit fixed it.", 
            "date_created": "2015-08-21 07:56:49.139825+00:00", 
            "author": "https://api.launchpad.net/1.0/~zhenzan-zhou"
        }, 
        {
            "content": "Hi Zhenzan, we only manually set \"Fix Committed\" if we can cite the commit that fixed the issue at the same time.\r\n\r\nIf we can't reproduce this bug and since it's been over a year since it was opened, I think we could set it as Invalid and let it be re-opened or a new bug filed if the bug is encountered again.", 
            "date_created": "2015-08-21 18:20:06.242520+00:00", 
            "author": "https://api.launchpad.net/1.0/~melwitt"
        }
    ], 
    "closed": "2015-08-24 08:25:22.637019+00:00"
}