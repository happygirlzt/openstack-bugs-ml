{
    "status": "Invalid", 
    "last_updated": "2012-09-06 09:42:41.030056+00:00", 
    "description": "(This is with the stock Ubuntu Essex packages)\n\nI've been running VMs by hand on my test machine.  I've been assigning IP addresses from the floating pool:\n\nnova floating-ip-create\n\nnova add-floating-ip <machine> <ip>\n\nHowever, because I'm testing by hand at the moment, sometimes I've been killing the machines without removing IP addresses first:\n\nnova delete <machine>\n\nI've been doing this for some time and apparently I've exhausted my limited pool of available floating IPs.  I am now in the situation where I can't assign a floating IP because they're all inaccessible:\n\n$ nova floating-ip-create\nERROR: The server has either erred or is incapable of performing the requested operation. (HTTP 500)\n$ nova add-floating-ip <machine> 172.29.50.72\nERROR: Associate floating ip failed (HTTP 500)\n\n(Obviously I can't remove a floating IP because the machine it's assigned to has been deleted by this point)\n\n$ nova floating-ip-delete 172.29.50.72\nERROR: The server has either erred or is incapable of performing the requested operation. (HTTP 500)\n\n\nRelavant traces from the nova-api log:\n\n(floating-ip-create):\n\n2012-08-11 10:14:21 INFO nova.api.openstack.wsgi [req-0c047374-917f-4411-819e-bdd48b6bc6a0 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] POST http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/os-floating-ips\n2012-08-11 10:14:21 ERROR nova.api.openstack [req-0c047374-917f-4411-819e-bdd48b6bc6a0 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] Caught error: Remote error: QuotaError Quota exceeded: code=AddressLimitExceeded\n[u'Traceback (most recent call last):\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 253, in _process_data\\n    rval = node_func(context=ctxt, **node_args)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 257, in wrapped\\n    return func(self, context, *args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 403, in allocate_floating_ip\\n    raise exception.QuotaError(code=\\'AddressLimitExceeded\\')\\n', u'QuotaError: Quota exceeded: code=AddressLimitExceeded\\n'].\n2012-08-11 10:14:21 TRACE nova.api.openstack Traceback (most recent call last):\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/__init__.py\", line 41, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     return req.get_response(self.application)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1086, in get_response\n2012-08-11 10:14:21 TRACE nova.api.openstack     application, catch_exc_info=False)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1055, in call_application\n2012-08-11 10:14:21 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 176, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     return self.app(env, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 147, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 210, in call_func\n2012-08-11 10:14:21 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 803, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     content_type, body, accept)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 851, in _process_stack\n2012-08-11 10:14:21 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 926, in dispatch\n2012-08-11 10:14:21 TRACE nova.api.openstack     return method(req=request, **action_args)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/contrib/floating_ips.py\", line 153, in create\n2012-08-11 10:14:21 TRACE nova.api.openstack     address = self.network_api.allocate_floating_ip(context, pool)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/network/api.py\", line 130, in allocate_floating_ip\n2012-08-11 10:14:21 TRACE nova.api.openstack     'pool': pool}})\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/rpc/__init__.py\", line 68, in call\n2012-08-11 10:14:21 TRACE nova.api.openstack     return _get_impl().call(context, topic, msg, timeout)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/rpc/impl_kombu.py\", line 674, in call\n2012-08-11 10:14:21 TRACE nova.api.openstack     return rpc_amqp.call(context, topic, msg, timeout, Connection.pool)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 343, in call\n2012-08-11 10:14:21 TRACE nova.api.openstack     rv = list(rv)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 311, in __iter__\n2012-08-11 10:14:21 TRACE nova.api.openstack     raise result\n2012-08-11 10:14:21 TRACE nova.api.openstack RemoteError: Remote error: QuotaError Quota exceeded: code=AddressLimitExceeded\n2012-08-11 10:14:21 TRACE nova.api.openstack [u'Traceback (most recent call last):\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 253, in _process_data\\n    rval = node_func(context=ctxt, **node_args)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 257, in wrapped\\n    return func(self, context, *args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 403, in allocate_floating_ip\\n    raise exception.QuotaError(code=\\'AddressLimitExceeded\\')\\n', u'QuotaError: Quota exceeded: code=AddressLimitExceeded\\n'].\n2012-08-11 10:14:21 TRACE nova.api.openstack \n2012-08-11 10:14:21 INFO nova.api.openstack [req-0c047374-917f-4411-819e-bdd48b6bc6a0 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/os-floating-ips returned with HTTP 500\n\n\n\n(floating-ip-delete):\n\n2012-08-11 10:15:50 INFO nova.api.openstack.wsgi [req-5c00329c-b13c-4dc3-b301-87aa105e9a9c b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] GET http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/os-floating-ips\n2012-08-11 10:15:50 ERROR nova.api.openstack [req-5c00329c-b13c-4dc3-b301-87aa105e9a9c b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] Caught error: Instance 5 could not be found.\n2012-08-11 10:15:50 TRACE nova.api.openstack Traceback (most recent call last):\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/__init__.py\", line 41, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     return req.get_response(self.application)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1086, in get_response\n2012-08-11 10:15:50 TRACE nova.api.openstack     application, catch_exc_info=False)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1055, in call_application\n2012-08-11 10:15:50 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 176, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     return self.app(env, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 147, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 210, in call_func\n2012-08-11 10:15:50 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 803, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     content_type, body, accept)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 851, in _process_stack\n2012-08-11 10:15:50 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 926, in dispatch\n2012-08-11 10:15:50 TRACE nova.api.openstack     return method(req=request, **action_args)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/contrib/floating_ips.py\", line 140, in index\n2012-08-11 10:15:50 TRACE nova.api.openstack     self._set_metadata(context, floating_ip)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/contrib/floating_ips.py\", line 112, in _set_metadata\n2012-08-11 10:15:50 TRACE nova.api.openstack     instance_id)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/contrib/floating_ips.py\", line 100, in _get_instance\n2012-08-11 10:15:50 TRACE nova.api.openstack     return self.compute_api.get(context, instance_id)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/compute/api.py\", line 1029, in get\n2012-08-11 10:15:50 TRACE nova.api.openstack     instance = self.db.instance_get(context, instance_id)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 540, in instance_get\n2012-08-11 10:15:50 TRACE nova.api.openstack     return IMPL.instance_get(context, instance_id)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 120, in wrapper\n2012-08-11 10:15:50 TRACE nova.api.openstack     return f(*args, **kwargs)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 1339, in instance_get\n2012-08-11 10:15:50 TRACE nova.api.openstack     raise exception.InstanceNotFound(instance_id=instance_id)\n2012-08-11 10:15:50 TRACE nova.api.openstack InstanceNotFound: Instance 5 could not be found.\n2012-08-11 10:15:50 TRACE nova.api.openstack \n2012-08-11 10:15:50 INFO nova.api.openstack [req-5c00329c-b13c-4dc3-b301-87aa105e9a9c b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/os-floating-ips returned with HTTP 500\n\n(add-floating-ip):\n\n2012-08-11 10:16:26 INFO nova.api.openstack.wsgi [req-b23b9d8a-85a1-4864-9cb2-8fbe567d7f42 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] GET http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/servers/detail\n2012-08-11 10:16:26 INFO nova.api.openstack.wsgi [req-b23b9d8a-85a1-4864-9cb2-8fbe567d7f42 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/servers/detail returned with HTTP 200\n2012-08-11 10:16:27 INFO nova.api.openstack.wsgi [req-e56ce5ef-3c05-45e7-a288-37a73ba48e49 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] POST http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/servers/bbd48232-e56e-43be-8a65-cf38e6fc28df/action 2012-08-11 10:16:27 INFO nova.api.openstack.wsgi [req-e56ce5ef-3c05-45e7-a288-37a73ba48e49 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] HTTP exception thrown: Associate floating ip failed2012-08-11 10:16:27 INFO nova.api.openstack.wsgi [req-e56ce5ef-3c05-45e7-a288-37a73ba48e49 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/servers/bbd48232-e56e-43be-8a65-cf38e6fc28df/action returned with HTTP 500", 
    "tags": [], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1035594", 
    "owner": "None", 
    "id": 1035594, 
    "index": 4299, 
    "openned": "2012-08-11 10:17:13.318448+00:00", 
    "created": "2012-08-11 10:17:13.318448+00:00", 
    "title": "Floating IP addresses leak if you delete an instance with one assigned", 
    "comments": [
        {
            "content": "(This is with the stock Ubuntu Essex packages)\n\nI've been running VMs by hand on my test machine.  I've been assigning IP addresses from the floating pool:\n\nnova floating-ip-create\n\nnova add-floating-ip <machine> <ip>\n\nHowever, because I'm testing by hand at the moment, sometimes I've been killing the machines without removing IP addresses first:\n\nnova delete <machine>\n\nI've been doing this for some time and apparently I've exhausted my limited pool of available floating IPs.  I am now in the situation where I can't assign a floating IP because they're all inaccessible:\n\n$ nova floating-ip-create\nERROR: The server has either erred or is incapable of performing the requested operation. (HTTP 500)\n$ nova add-floating-ip <machine> 172.29.50.72\nERROR: Associate floating ip failed (HTTP 500)\n\n(Obviously I can't remove a floating IP because the machine it's assigned to has been deleted by this point)\n\n$ nova floating-ip-delete 172.29.50.72\nERROR: The server has either erred or is incapable of performing the requested operation. (HTTP 500)\n\n\nRelavant traces from the nova-api log:\n\n(floating-ip-create):\n\n2012-08-11 10:14:21 INFO nova.api.openstack.wsgi [req-0c047374-917f-4411-819e-bdd48b6bc6a0 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] POST http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/os-floating-ips\n2012-08-11 10:14:21 ERROR nova.api.openstack [req-0c047374-917f-4411-819e-bdd48b6bc6a0 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] Caught error: Remote error: QuotaError Quota exceeded: code=AddressLimitExceeded\n[u'Traceback (most recent call last):\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 253, in _process_data\\n    rval = node_func(context=ctxt, **node_args)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 257, in wrapped\\n    return func(self, context, *args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 403, in allocate_floating_ip\\n    raise exception.QuotaError(code=\\'AddressLimitExceeded\\')\\n', u'QuotaError: Quota exceeded: code=AddressLimitExceeded\\n'].\n2012-08-11 10:14:21 TRACE nova.api.openstack Traceback (most recent call last):\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/__init__.py\", line 41, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     return req.get_response(self.application)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1086, in get_response\n2012-08-11 10:14:21 TRACE nova.api.openstack     application, catch_exc_info=False)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1055, in call_application\n2012-08-11 10:14:21 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 176, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     return self.app(env, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 147, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 210, in call_func\n2012-08-11 10:14:21 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 803, in __call__\n2012-08-11 10:14:21 TRACE nova.api.openstack     content_type, body, accept)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 851, in _process_stack\n2012-08-11 10:14:21 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 926, in dispatch\n2012-08-11 10:14:21 TRACE nova.api.openstack     return method(req=request, **action_args)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/contrib/floating_ips.py\", line 153, in create\n2012-08-11 10:14:21 TRACE nova.api.openstack     address = self.network_api.allocate_floating_ip(context, pool)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/network/api.py\", line 130, in allocate_floating_ip\n2012-08-11 10:14:21 TRACE nova.api.openstack     'pool': pool}})\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/rpc/__init__.py\", line 68, in call\n2012-08-11 10:14:21 TRACE nova.api.openstack     return _get_impl().call(context, topic, msg, timeout)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/rpc/impl_kombu.py\", line 674, in call\n2012-08-11 10:14:21 TRACE nova.api.openstack     return rpc_amqp.call(context, topic, msg, timeout, Connection.pool)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 343, in call\n2012-08-11 10:14:21 TRACE nova.api.openstack     rv = list(rv)\n2012-08-11 10:14:21 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 311, in __iter__\n2012-08-11 10:14:21 TRACE nova.api.openstack     raise result\n2012-08-11 10:14:21 TRACE nova.api.openstack RemoteError: Remote error: QuotaError Quota exceeded: code=AddressLimitExceeded\n2012-08-11 10:14:21 TRACE nova.api.openstack [u'Traceback (most recent call last):\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/rpc/amqp.py\", line 253, in _process_data\\n    rval = node_func(context=ctxt, **node_args)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 257, in wrapped\\n    return func(self, context, *args, **kwargs)\\n', u'  File \"/usr/lib/python2.7/dist-packages/nova/network/manager.py\", line 403, in allocate_floating_ip\\n    raise exception.QuotaError(code=\\'AddressLimitExceeded\\')\\n', u'QuotaError: Quota exceeded: code=AddressLimitExceeded\\n'].\n2012-08-11 10:14:21 TRACE nova.api.openstack \n2012-08-11 10:14:21 INFO nova.api.openstack [req-0c047374-917f-4411-819e-bdd48b6bc6a0 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/os-floating-ips returned with HTTP 500\n\n\n\n(floating-ip-delete):\n\n2012-08-11 10:15:50 INFO nova.api.openstack.wsgi [req-5c00329c-b13c-4dc3-b301-87aa105e9a9c b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] GET http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/os-floating-ips\n2012-08-11 10:15:50 ERROR nova.api.openstack [req-5c00329c-b13c-4dc3-b301-87aa105e9a9c b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] Caught error: Instance 5 could not be found.\n2012-08-11 10:15:50 TRACE nova.api.openstack Traceback (most recent call last):\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/__init__.py\", line 41, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     return req.get_response(self.application)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1086, in get_response\n2012-08-11 10:15:50 TRACE nova.api.openstack     application, catch_exc_info=False)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/request.py\", line 1055, in call_application\n2012-08-11 10:15:50 TRACE nova.api.openstack     app_iter = application(self.environ, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/keystone/middleware/auth_token.py\", line 176, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     return self.app(env, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/routes/middleware.py\", line 131, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     response = self.app(environ, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 159, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     return resp(environ, start_response)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 147, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     resp = self.call_func(req, *args, **self.kwargs)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/webob/dec.py\", line 210, in call_func\n2012-08-11 10:15:50 TRACE nova.api.openstack     return self.func(req, *args, **kwargs)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 803, in __call__\n2012-08-11 10:15:50 TRACE nova.api.openstack     content_type, body, accept)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 851, in _process_stack\n2012-08-11 10:15:50 TRACE nova.api.openstack     action_result = self.dispatch(meth, request, action_args)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/wsgi.py\", line 926, in dispatch\n2012-08-11 10:15:50 TRACE nova.api.openstack     return method(req=request, **action_args)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/contrib/floating_ips.py\", line 140, in index\n2012-08-11 10:15:50 TRACE nova.api.openstack     self._set_metadata(context, floating_ip)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/contrib/floating_ips.py\", line 112, in _set_metadata\n2012-08-11 10:15:50 TRACE nova.api.openstack     instance_id)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/api/openstack/compute/contrib/floating_ips.py\", line 100, in _get_instance\n2012-08-11 10:15:50 TRACE nova.api.openstack     return self.compute_api.get(context, instance_id)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/compute/api.py\", line 1029, in get\n2012-08-11 10:15:50 TRACE nova.api.openstack     instance = self.db.instance_get(context, instance_id)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/db/api.py\", line 540, in instance_get\n2012-08-11 10:15:50 TRACE nova.api.openstack     return IMPL.instance_get(context, instance_id)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 120, in wrapper\n2012-08-11 10:15:50 TRACE nova.api.openstack     return f(*args, **kwargs)\n2012-08-11 10:15:50 TRACE nova.api.openstack   File \"/usr/lib/python2.7/dist-packages/nova/db/sqlalchemy/api.py\", line 1339, in instance_get\n2012-08-11 10:15:50 TRACE nova.api.openstack     raise exception.InstanceNotFound(instance_id=instance_id)\n2012-08-11 10:15:50 TRACE nova.api.openstack InstanceNotFound: Instance 5 could not be found.\n2012-08-11 10:15:50 TRACE nova.api.openstack \n2012-08-11 10:15:50 INFO nova.api.openstack [req-5c00329c-b13c-4dc3-b301-87aa105e9a9c b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/os-floating-ips returned with HTTP 500\n\n(add-floating-ip):\n\n2012-08-11 10:16:26 INFO nova.api.openstack.wsgi [req-b23b9d8a-85a1-4864-9cb2-8fbe567d7f42 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] GET http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/servers/detail\n2012-08-11 10:16:26 INFO nova.api.openstack.wsgi [req-b23b9d8a-85a1-4864-9cb2-8fbe567d7f42 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/servers/detail returned with HTTP 200\n2012-08-11 10:16:27 INFO nova.api.openstack.wsgi [req-e56ce5ef-3c05-45e7-a288-37a73ba48e49 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] POST http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/servers/bbd48232-e56e-43be-8a65-cf38e6fc28df/action 2012-08-11 10:16:27 INFO nova.api.openstack.wsgi [req-e56ce5ef-3c05-45e7-a288-37a73ba48e49 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] HTTP exception thrown: Associate floating ip failed2012-08-11 10:16:27 INFO nova.api.openstack.wsgi [req-e56ce5ef-3c05-45e7-a288-37a73ba48e49 b2cb7d0476974261af316616c4861ddb 6c949cf379d14971b20ec3f9a42fabb0] http://172.29.50.151:8774/v2/6c949cf379d14971b20ec3f9a42fabb0/servers/bbd48232-e56e-43be-8a65-cf38e6fc28df/action returned with HTTP 500", 
            "date_created": "2012-08-11 10:17:13.318448+00:00", 
            "author": "https://api.launchpad.net/1.0/~ijw-ubuntu"
        }, 
        {
            "content": "Quick analysis:\n\n- floating-ip-create is failing with a quota violation, which is totally reasonable, but that error turns into a nondescript error before coming out of the CLI\n\n- floating-ip-delete won't delete an IP from a nonexistent instance\n\nI think IPs ought to be freed automatically on instance death, but I've found no documentation to suggest that there's any behaviour specified for this case.", 
            "date_created": "2012-08-11 10:20:00.315006+00:00", 
            "author": "https://api.launchpad.net/1.0/~ijw-ubuntu"
        }, 
        {
            "content": "I've just tried reproducing this with latest upstream folsom and can't\n\nMoving to Ubuntu. If someone can confirm that it's an issue with latest stable/essex upstream, please do nominate it for the essex series\n\nThanks for the report!", 
            "date_created": "2012-08-30 12:17:51.670621+00:00", 
            "author": "https://api.launchpad.net/1.0/~markmc"
        }, 
        {
            "content": "Having trouble reproducing using the following steps with stable/essex on Ubuntu 12.04 (via 2012.1.3+stable-20120827-4d2a4afe-0ubuntu1 package):\n\nnova floating-ip-create\nnova add-floating-ip b8e0295d-e515-4838-b91a-eb3c4b1beebe 192.168.25.237\nnova delete b8e0295d-e515-4838-b91a-eb3c4b1beebe\nnova floating-ip-delete 192.168.25.237\n\nWatching the database (floating_ips), the floating ip to fixed_ip_id mapping is appropriately removed on instance deletion, as is the floating ip <-> project_id mapping on floating-ip-delete.\n\nCurious to know which network manager you're using.", 
            "date_created": "2012-09-04 19:41:40.337466+00:00", 
            "author": "https://api.launchpad.net/1.0/~gandelman-a"
        }, 
        {
            "content": "I was testing with devstack, and the latest Folsom of the moment.  If it's not turning up in either case at the moment then apparently it's gone away - I'll reopen with more detail if I see it again.", 
            "date_created": "2012-09-04 21:22:47.817246+00:00", 
            "author": "https://api.launchpad.net/1.0/~ijw-ubuntu"
        }
    ], 
    "closed": "2012-08-30 12:18:36.990239+00:00"
}