{
    "status": "Invalid", 
    "last_updated": "2014-10-17 10:23:50.665047+00:00", 
    "description": "http://logs.openstack.org/59/47659/6/check/gate-tempest-devstack-vm-neutron/fc83d44/logs/screen-n-cpu.txt.gz#_2013-09-23_18_25_06_484\n\n\n\n2013-09-23 18:25:06.484 ERROR nova.openstack.common.rpc.amqp [req-3a80ff5a-817b-4eb8-be67-7f180bef8a6e demo demo] Exception during message handling\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 354, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/exception.py\", line 90, in wrapped\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/exception.py\", line 73, in wrapped\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 244, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     pass\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 230, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 295, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 272, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 259, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1793, in terminate_instance\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     do_terminate_instance(instance, bdms)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/lockutils.py\", line 246, in inner\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1785, in do_terminate_instance\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     reservations=reservations)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/hooks.py\", line 105, in inner\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     rv = f(*args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1758, in _delete_instance\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     user_id=user_id)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1727, in _delete_instance\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.conductor_api.instance_info_cache_delete(context, db_inst)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/conductor/api.py\", line 107, in instance_info_cache_delete\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return self._manager.instance_info_cache_delete(context, instance)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/conductor/rpcapi.py\", line 312, in instance_info_cache_delete\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     cctxt.call(context, 'instance_info_cache_delete', instance=instance_p)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/rpcclient.py\", line 85, in call\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return self._invoke(self.proxy.call, ctxt, method, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/rpcclient.py\", line 63, in _invoke\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return cast_or_call(ctxt, msg, **self.kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/proxy.py\", line 126, in call\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     result = rpc.call(context, real_topic, msg, timeout)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/__init__.py\", line 139, in call\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return _get_impl().call(CONF, context, topic, msg, timeout)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/impl_kombu.py\", line 816, in call\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     rpc_amqp.get_connection_pool(conf, Connection))\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 572, in call\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     rv = multicall(conf, context, topic, msg, timeout, connection_pool)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 565, in multicall\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     with ConnectionContext(conf, connection_pool) as conn:\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 122, in __init__\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.connection = connection_pool.get()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/pools.py\", line 119, in get\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     created = self.create()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 76, in create\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return self.connection_cls(self.conf)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/impl_kombu.py\", line 465, in __init__\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.reconnect()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/impl_kombu.py\", line 535, in reconnect\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self._connect(params)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/impl_kombu.py\", line 511, in _connect\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.connection.connect()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/connection.py\", line 246, in connect\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return self.connection\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/connection.py\", line 761, in connection\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self._connection = self._establish_connection()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/connection.py\", line 720, in _establish_connection\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     conn = self.transport.establish_connection()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/transport/pyamqp.py\", line 115, in establish_connection\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     conn = self.Connection(**opts)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/connection.py\", line 142, in __init__\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     (10, 10),  # start\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py\", line 69, in wait\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.channel_id, allowed_methods)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/connection.py\", line 204, in _wait_method\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.method_reader.read_method()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/method_framing.py\", line 192, in read_method\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     raise m\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp RuntimeError: Second simultaneous read on fileno 16 detected.  Unless you really know what you're doing, make sure that only one greenthread can read any particular socket.  Consider using a pools.Pool. If you do know what you're doing and want to disable this error, call eventlet.debug.hub_prevent_multiple_readers(False)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp", 
    "tags": [], 
    "importance": "High", 
    "heat": 44, 
    "link": "https://bugs.launchpad.net/nova/+bug/1229475", 
    "owner": "None", 
    "id": 1229475, 
    "index": 1249, 
    "openned": "2013-09-24 00:16:22.000664+00:00", 
    "created": "2013-09-24 00:15:56.504274+00:00", 
    "title": "terminate_instance(): RuntimeError: Second simultaneous read on fileno 16 detected", 
    "comments": [
        {
            "content": "http://logs.openstack.org/59/47659/6/check/gate-tempest-devstack-vm-neutron/fc83d44/logs/screen-n-cpu.txt.gz#_2013-09-23_18_25_06_484\n\n\n\n2013-09-23 18:25:06.484 ERROR nova.openstack.common.rpc.amqp [req-3a80ff5a-817b-4eb8-be67-7f180bef8a6e demo demo] Exception during message handling\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 354, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/exception.py\", line 90, in wrapped\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/exception.py\", line 73, in wrapped\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 244, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     pass\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 230, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 295, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 272, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 259, in decorated_function\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1793, in terminate_instance\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     do_terminate_instance(instance, bdms)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/lockutils.py\", line 246, in inner\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1785, in do_terminate_instance\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     reservations=reservations)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/hooks.py\", line 105, in inner\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     rv = f(*args, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1758, in _delete_instance\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     user_id=user_id)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1727, in _delete_instance\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.conductor_api.instance_info_cache_delete(context, db_inst)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/conductor/api.py\", line 107, in instance_info_cache_delete\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return self._manager.instance_info_cache_delete(context, instance)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/conductor/rpcapi.py\", line 312, in instance_info_cache_delete\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     cctxt.call(context, 'instance_info_cache_delete', instance=instance_p)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/rpcclient.py\", line 85, in call\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return self._invoke(self.proxy.call, ctxt, method, **kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/rpcclient.py\", line 63, in _invoke\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return cast_or_call(ctxt, msg, **self.kwargs)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/proxy.py\", line 126, in call\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     result = rpc.call(context, real_topic, msg, timeout)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/__init__.py\", line 139, in call\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return _get_impl().call(CONF, context, topic, msg, timeout)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/impl_kombu.py\", line 816, in call\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     rpc_amqp.get_connection_pool(conf, Connection))\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 572, in call\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     rv = multicall(conf, context, topic, msg, timeout, connection_pool)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 565, in multicall\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     with ConnectionContext(conf, connection_pool) as conn:\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 122, in __init__\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.connection = connection_pool.get()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/eventlet/pools.py\", line 119, in get\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     created = self.create()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 76, in create\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return self.connection_cls(self.conf)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/impl_kombu.py\", line 465, in __init__\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.reconnect()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/impl_kombu.py\", line 535, in reconnect\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self._connect(params)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/impl_kombu.py\", line 511, in _connect\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.connection.connect()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/connection.py\", line 246, in connect\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     return self.connection\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/connection.py\", line 761, in connection\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self._connection = self._establish_connection()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/connection.py\", line 720, in _establish_connection\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     conn = self.transport.establish_connection()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/kombu/transport/pyamqp.py\", line 115, in establish_connection\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     conn = self.Connection(**opts)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/connection.py\", line 142, in __init__\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     (10, 10),  # start\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/abstract_channel.py\", line 69, in wait\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.channel_id, allowed_methods)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/connection.py\", line 204, in _wait_method\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     self.method_reader.read_method()\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp   File \"/usr/local/lib/python2.7/dist-packages/amqp/method_framing.py\", line 192, in read_method\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp     raise m\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp RuntimeError: Second simultaneous read on fileno 16 detected.  Unless you really know what you're doing, make sure that only one greenthread can read any particular socket.  Consider using a pools.Pool. If you do know what you're doing and want to disable this error, call eventlet.debug.hub_prevent_multiple_readers(False)\n2013-09-23 18:25:06.484 3476 TRACE nova.openstack.common.rpc.amqp", 
            "date_created": "2013-09-24 00:15:56.504274+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "http://logs.openstack.org/48/47948/1/check/gate-tempest-devstack-vm-neutron/6e1f600/logs/screen-n-cpu.txt.gz#_2013-09-24_01_33_24_904\n\nAnother case:\n\n 2013-09-24 01:33:24.904 ERROR nova.openstack.common.rpc.amqp [req-337bcd98-3d47-452c-a269-0629725d3dce demo demo] Exception during message handling\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp Traceback (most recent call last):\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/amqp.py\", line 461, in _process_data\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     **args)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/rpc/dispatcher.py\", line 172, in dispatch\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     result = getattr(proxyobj, method)(ctxt, **kwargs)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 354, in decorated_function\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/exception.py\", line 90, in wrapped\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     payload)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/exception.py\", line 73, in wrapped\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     return f(self, context, *args, **kw)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 244, in decorated_function\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     pass\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 230, in decorated_function\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 295, in decorated_function\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     function(self, context, *args, **kwargs)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 272, in decorated_function\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     e, sys.exc_info())\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 259, in decorated_function\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     return function(self, context, *args, **kwargs)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1793, in terminate_instance\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     do_terminate_instance(instance, bdms)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/openstack/common/lockutils.py\", line 246, in inner\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     return f(*args, **kwargs)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1785, in do_terminate_instance\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     reservations=reservations)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/hooks.py\", line 105, in inner\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     rv = f(*args, **kwargs)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1758, in _delete_instance\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     user_id=user_id)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1730, in _delete_instance\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     self._shutdown_instance(context, db_inst, bdms)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 1640, in _shutdown_instance\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     network_info = self._get_instance_nw_info(context, instance)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/compute/manager.py\", line 877, in _get_instance_nw_info\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     instance)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 455, in get_instance_nw_info\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     result = self._get_instance_nw_info(context, instance, networks)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 463, in _get_instance_nw_info\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     nw_info = self._build_network_info_model(context, instance, networks)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/network/neutronv2/api.py\", line 978, in _build_network_info_model\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     client = neutronv2.get_client(context, admin=True)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/network/neutronv2/__init__.py\", line 71, in get_client\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     return _get_client(token=token)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/network/neutronv2/__init__.py\", line 52, in _get_client\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     token = _get_auth_token()\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/network/neutronv2/__init__.py\", line 47, in _get_auth_token\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     LOG.error(_('Neutron client authentication failed: %s'), e)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/nova/nova/network/neutronv2/__init__.py\", line 43, in _get_auth_token\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     httpclient.authenticate()\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/python-neutronclient/neutronclient/client.py\", line 232, in authenticate\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     content_type=\"application/json\")\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp   File \"/opt/stack/new/python-neutronclient/neutronclient/client.py\", line 152, in _cs_request\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp     raise exceptions.ConnectionFailed(reason=e)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp ConnectionFailed: Connection to neutron failed: Second simultaneous read on fileno 16 detected.  Unless you really know what you're doing, make sure that only one greenthread can read any particular socket.  Consider using a pools.Pool. If you do know what you're doing and want to disable this error, call eventlet.debug.hub_prevent_multiple_readers(False)\n2013-09-24 01:33:24.904 4483 TRACE nova.openstack.common.rpc.amqp ", 
            "date_created": "2013-09-24 01:58:05.537205+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "logstash query: @message:\"Second simultaneous read on fileno\" AND @fields.build_status:\"FAILURE\"", 
            "date_created": "2013-09-24 01:59:14.907379+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "Mark, I an not sure what the actual bug is here.  The first stacktrace was from rpc, but the second is from neutronclient.\n\nHere is a third case of it: http://logs.openstack.org/87/44787/13/check/gate-tempest-devstack-vm-neutron/11d697f/logs/screen-n-cpu.txt.gz\n\nAlso until we get elastic-recheck fully running this one is hard to find for the untrained eye. But logstash shows its been hit 12 times in the last 24 hours.", 
            "date_created": "2013-09-24 22:45:22.776334+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "I think we're seeing this often enough that we should be concerned. It's in terminate_instance() every time, so it's not completely random. Putting it on the havana-rc1 milestone to raise its visibility.\n\nDefinitely looks like we're not cleaning up a closed fd somehow - e.g. a greenthread closes an fd but keeps the handle around and incorrectly read()/poll()s on it? Then rpc/neutronclient create a new connection, re-uses this fd and we see an error that suggests the issue is rpc/neutronclient rather than whatever other thing screwed up.", 
            "date_created": "2013-09-25 06:15:22.538615+00:00", 
            "author": "https://api.launchpad.net/1.0/~markmc"
        }, 
        {
            "content": "Looking at logstash - I see 214 hits for @message:\"Second simultaneous read\" and can break it into 3 buckets.\n\n100 Hits - @message:\"Second simultaneous read\" AND @fields.build_name:\"gate-tempest-devstack-vm-neutron\" AND  @fields.filename:\"logs/screen-n-cpu.txt\" AND @fields.module:\"nova.openstack.common.rpc.amqp\"\n 90 Hits - @message:\"Second simultaneous read\" AND @fields.build_name:\"gate-tempest-devstack-vm-neutron\" AND  @fields.filename:\"logs/screen-n-cpu.txt\" AND @fields.module:\"nova.network.neutronv2\"\n 14 Hits - @message:\"Second simultaneous read\" AND @fields.build_name:\"gate-tempest-devstack-vm-neutron\" AND  @fields.filename:\"logs/screen-n-cpu.txt\" AND (NOT @fields.module:\"nova.openstack.common.rpc.amqp\") AND (NOT @fields.module:\"nova.network.neutronv2\")\n\nNotes:\n* All the hits from \"gate-tempest-devstack-vm-neutron\" jenkins job \n* All issues happen in the \"logs/screen-n-cpu.txt\"\n* First hit was on 2013-09-12T09:19:53.000\n\nStill looking...", 
            "date_created": "2013-09-26 00:15:25.326174+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "14 hits for @message:\"Second simultaneous write\"", 
            "date_created": "2013-09-26 01:11:54.315667+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "Fix proposed to branch: master\nReview: https://review.openstack.org/48552", 
            "date_created": "2013-09-27 02:00:06.383384+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Looks like this is still happening.  And is happening during passing tempest  jobs:\n\n134 hits in the last 24 hours.  and happened 34 times during passing tempest jobs.", 
            "date_created": "2013-09-30 20:32:19.147582+00:00", 
            "author": "https://api.launchpad.net/1.0/~jogo"
        }, 
        {
            "content": "@Joe, Managed to capture some tracebacks in http://logs.openstack.org/11/49011/4/check/check-tempest-devstack-vm-neutron/0ab22df/logs/screen-n-cpu.txt.gz\n\nFirst call for fd 16 is here - http://paste.openstack.org/show/47754/\nSecond call to fd 16 is here - http://paste.openstack.org/show/47755/\n\nAnd then we end up with\n2013-10-01 12:34:13.962 3428 TRACE nova.openstack.common.rpc.amqp RuntimeError: My Second simultaneous read on fileno 16 detected.  Unless you really know what you're doing, make sure that only one greenthread can read any particular socket.  Consider using a pools.Pool. If you do know what you're doing and want to disable this error, call eventlet.debug.hub_prevent_multiple_readers(False)\n", 
            "date_created": "2013-10-01 13:23:20.937970+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "After some more looking at the run dims linked in comment #9, it's clear that the error comes from neutronclient getting a bogus fd.  That fd (16) is actively in use by rpc.  neutronclient barfs on it because it ends up reading data from rabbitmq.\n\nhttp://logs.openstack.org/11/49011/4/check/check-tempest-devstack-vm-neutron/0ab22df/logs/screen-n-cpu.txt.gz#_2013-10-01_12_34_23_604", 
            "date_created": "2013-10-01 18:28:00.143991+00:00", 
            "author": "https://api.launchpad.net/1.0/~russellb"
        }, 
        {
            "content": "This reading from bad fd may be the problem behind the other bug as well - https://bugs.launchpad.net/tempest/+bug/1223161", 
            "date_created": "2013-10-01 18:47:43.732683+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "No need for a nova patch", 
            "date_created": "2013-10-02 10:38:35.963706+00:00", 
            "author": "https://api.launchpad.net/1.0/~ttx"
        }, 
        {
            "content": "Marking Incomplete for Nova, because I don't think we have found the root cause yet, so it still may be nova's fault.", 
            "date_created": "2013-10-02 14:06:10.319691+00:00", 
            "author": "https://api.launchpad.net/1.0/~russellb"
        }, 
        {
            "content": "Reviewed:  https://review.openstack.org/49210\nCommitted: http://github.com/openstack/python-neutronclient/commit/e6a9f79066943b75e2c60b0165533d5886cc9cd8\nSubmitter: Jeremy Stanley (<email address hidden>)\nBranch:    master\n\ncommit e6a9f79066943b75e2c60b0165533d5886cc9cd8\nAuthor: Davanum Srinivas <email address hidden>\nDate:   Tue Oct 1 12:27:32 2013 -0400\n\n    Forcibly clear connection pool after every request\n    \n    Neutron client is ending up with bad socket descriptors\n    which causes the behavior including trying to read from\n    the socket that amqp currently holds etc. A temporary\n    solution is to clear the connection pool so we get a\n    fresh socket built for every request.\n    \n    Closes-Bug: 1229475\n    \n    Change-Id: I43b1fe535bc5bd1fc726c97a293bf7912cd7ef1e\n", 
            "date_created": "2013-10-02 15:48:04.407592+00:00", 
            "author": "https://api.launchpad.net/1.0/~hudson-openstack"
        }, 
        {
            "content": "Sigh. we still see it - http://logstash.openstack.org/#eyJzZWFyY2giOiJAbWVzc2FnZTpcIlNlY29uZCBzaW11bHRhbmVvdXMgcmVhZCBvbiBmaWxlbm9cIiAiLCJmaWVsZHMiOltdLCJvZmZzZXQiOjAsInRpbWVmcmFtZSI6IjE0NDAwIiwiZ3JhcGhtb2RlIjoiY291bnQiLCJ0aW1lIjp7InVzZXJfaW50ZXJ2YWwiOjB9LCJzdGFtcCI6MTM4MDc0NTkzNjQwOH0=", 
            "date_created": "2013-10-02 20:42:38.540549+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }, 
        {
            "content": "Haven't seen it for 12+ hours. will reopen if we do\n\nhttp://logstash.openstack.org/#eyJzZWFyY2giOiJcIlNlY29uZCBzaW11bHRhbmVvdXMgcmVhZFwiIE9SIFwiQ2Fubm90IHVuZGVyc3RhbmQgSlNPTlwiIiwiZmllbGRzIjpbXSwib2Zmc2V0IjowLCJ0aW1lZnJhbWUiOiIxNzI4MDAiLCJncmFwaG1vZGUiOiJjb3VudCIsInRpbWUiOnsidXNlcl9pbnRlcnZhbCI6MH0sInN0YW1wIjoxMzgwODE4MzEyOTcwfQ==", 
            "date_created": "2013-10-03 16:39:05.340392+00:00", 
            "author": "https://api.launchpad.net/1.0/~dims-v"
        }
    ], 
    "closed": "2013-10-03 17:01:39.134798+00:00"
}