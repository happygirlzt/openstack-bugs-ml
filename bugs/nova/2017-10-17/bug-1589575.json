{
    "status": "Fix Released", 
    "last_updated": "2016-09-14 11:31:41.266829+00:00", 
    "description": "I am trying to configure Ironic. I am doing this on Centos Mitaka. After writing the ironic configurations in nova.conf nova-compute is going down due to not able get the node list from ironic. tail -f /var/log/ironic/ironic-api.log 2016-06-06 08:46:37.634 3748 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:37.635 3748 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0009820 2016-06-06 08:46:39.639 3749 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:39.640 3749 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0009780 2016-06-06 08:46:41.644 3748 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:41.645 3748 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0010638 2016-06-06 08:46:43.649 3749 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:43.650 3749 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0009439 2016-06-06 08:46:45.656 3748 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:45.657 3748 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0014479 2016-06-06 08:46:47.663 3748 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:47.664 3748 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0011349 2016-06-06 08:46:49.670 3749 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:49.670 3749 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0010211\n\nironic in nova.conf \n[DEFAULT] \ncompute_driver=ironic.IronicDriver\nfirewall_driver=nova.virt.firewall.NoopFirewallDriver scheduler_host_manager=nova.scheduler.ironic_host_manager.IronicHostManager \nram_allocation_ratio=1.0 \nreserved_host_memory_mb=0 \nscheduler_use_baremetal_filters=True \nscheduler_tracks_instance_changes=False \n[ironic] \nauth_uri = http://192.168.56.105:5000 \nauth_url = http://192.168.56.105:35357 \nauth_region = RegionOne \nauth_type = password \nproject_domain_id = default \nuser_domain_id = default \nproject_name = service \nusername = ironic \npassword = cloud123 \napi_endpoint=http://192.168.56.105:6385/v1\n\nI tried with keeping the keystone V2.0 confgurations but that is giving authentication problems.\nadmin_username=ironic\nadmin_password=IRONIC_PASSWORD\nadmin_url=http://IDENTITY_IP:35357/v2.0\nadmin_tenant_name=service\napi_endpoint=http://IRONIC_NODE:6385/v1\n\nwhen i try the above values in ironic as per officeial document I am getting below error\n oslo_service.service DiscoveryFailure: Could not determine a suitable URL for the plugin\n\nKeystone endpoints are with v3\n+----------------------------------+-----------+--------------+--------------+---------+-----------+--------------------------------------------------+\n| ID                               | Region    | Service Name | Service Type | Enabled | Interface | URL                                              |\n+----------------------------------+-----------+--------------+--------------+---------+-----------+--------------------------------------------------+\n| 043d8c1077a14f8f970631e0ce5a95f6 | RegionOne | keystone     | identity     | True    | internal  | http://192.168.56.105:5000/v3                    |\n\n\nIronic api and conductor services are up and running.\n\nironic node-list\n+------+------+---------------+-------------+--------------------+-------------+ | UUID | Name | Instance UUID | Power State | Provisioning State | Maintenance | +------+------+---------------+-------------+--------------------+-------------+ +------+------+---------------+-------------+--------------------+-------------+\n\nIronic api and conductor services are up and running.\n\nPlease suggest me what is missing here.", 
    "tags": [
        "compute"
    ], 
    "importance": "Undecided", 
    "heat": 12, 
    "link": "https://bugs.launchpad.net/nova/+bug/1589575", 
    "owner": "None", 
    "id": 1589575, 
    "index": 7533, 
    "openned": "2016-09-14 11:13:45.540009+00:00", 
    "created": "2016-06-06 16:10:17.595805+00:00", 
    "title": "nova-compute is not starting after adding ironic configurations", 
    "comments": [
        {
            "content": "I am trying to configure Ironic. I am doing this on Centos Mitaka. After writing the ironic configurations in nova.conf nova-compute is going down due to not able get the node list from ironic. tail -f /var/log/ironic/ironic-api.log 2016-06-06 08:46:37.634 3748 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:37.635 3748 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0009820 2016-06-06 08:46:39.639 3749 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:39.640 3749 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0009780 2016-06-06 08:46:41.644 3748 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:41.645 3748 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0010638 2016-06-06 08:46:43.649 3749 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:43.650 3749 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0009439 2016-06-06 08:46:45.656 3748 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:45.657 3748 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0014479 2016-06-06 08:46:47.663 3748 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:47.664 3748 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0011349 2016-06-06 08:46:49.670 3749 INFO keystonemiddleware.auth_token [-] Rejecting request 2016-06-06 08:46:49.670 3749 INFO ironic_api [-] 192.168.56.105 \"GET /v1/nodes/detail HTTP/1.1\" status: 401 len: 234 time: 0.0010211\n\nironic in nova.conf \n[DEFAULT] \ncompute_driver=ironic.IronicDriver\nfirewall_driver=nova.virt.firewall.NoopFirewallDriver scheduler_host_manager=nova.scheduler.ironic_host_manager.IronicHostManager \nram_allocation_ratio=1.0 \nreserved_host_memory_mb=0 \nscheduler_use_baremetal_filters=True \nscheduler_tracks_instance_changes=False \n[ironic] \nauth_uri = http://192.168.56.105:5000 \nauth_url = http://192.168.56.105:35357 \nauth_region = RegionOne \nauth_type = password \nproject_domain_id = default \nuser_domain_id = default \nproject_name = service \nusername = ironic \npassword = cloud123 \napi_endpoint=http://192.168.56.105:6385/v1\n\nI tried with keeping the keystone V2.0 confgurations but that is giving authentication problems.\nadmin_username=ironic\nadmin_password=IRONIC_PASSWORD\nadmin_url=http://IDENTITY_IP:35357/v2.0\nadmin_tenant_name=service\napi_endpoint=http://IRONIC_NODE:6385/v1\n\nwhen i try the above values in ironic as per officeial document I am getting below error\n oslo_service.service DiscoveryFailure: Could not determine a suitable URL for the plugin\n\nKeystone endpoints are with v3\n+----------------------------------+-----------+--------------+--------------+---------+-----------+--------------------------------------------------+\n| ID                               | Region    | Service Name | Service Type | Enabled | Interface | URL                                              |\n+----------------------------------+-----------+--------------+--------------+---------+-----------+--------------------------------------------------+\n| 043d8c1077a14f8f970631e0ce5a95f6 | RegionOne | keystone     | identity     | True    | internal  | http://192.168.56.105:5000/v3                    |\n\n\nIronic api and conductor services are up and running.\n\nironic node-list\n+------+------+---------------+-------------+--------------------+-------------+ | UUID | Name | Instance UUID | Power State | Provisioning State | Maintenance | +------+------+---------------+-------------+--------------------+-------------+ +------+------+---------------+-------------+--------------------+-------------+\n\nIronic api and conductor services are up and running.\n\nPlease suggest me what is missing here.", 
            "date_created": "2016-06-06 16:10:17.595805+00:00", 
            "author": "https://api.launchpad.net/1.0/~narasimha18sv"
        }, 
        {
            "content": "# nova service-list\n+----+------------------+-----------------------+----------+---------+-------+----------------------------+-----------------+\n| Id | Binary           | Host                  | Zone     | Status  | State | Updated_at                 | Disabled Reason |\n+----+------------------+-----------------------+----------+---------+-------+----------------------------+-----------------+\n| 1  | nova-scheduler   | localhost.localdomain | internal | enabled | up    | 2016-06-06T16:04:36.000000 | -               |\n| 2  | nova-consoleauth | localhost.localdomain | internal | enabled | up    | 2016-06-06T16:04:29.000000 | -               |\n| 3  | nova-conductor   | localhost.localdomain | internal | enabled | up    | 2016-06-06T16:04:37.000000 | -               |\n| 6  | nova-compute     | localhost.localdomain | nova     | enabled | down  | 2016-06-06T15:58:52.000000 | -               |\n+----+------------------+-----------------------+----------+---------+-------+----------------------------+-----------------+\n", 
            "date_created": "2016-06-06 16:19:12.996212+00:00", 
            "author": "https://api.launchpad.net/1.0/~narasimha18sv"
        }, 
        {
            "content": "After adding domain related configurations in nova driver configurations of Ironic. This issue got resolved. This is just a workaround. May be need to change code to read keystone V3 configurations. ", 
            "date_created": "2016-07-15 12:15:24.913051+00:00", 
            "author": "https://api.launchpad.net/1.0/~narasimha18sv"
        }, 
        {
            "content": "Nova was updated to support keystone V3 while connecting to Ironic, so this should be fixed. Thanks!", 
            "date_created": "2016-09-14 11:23:18.749740+00:00", 
            "author": "https://api.launchpad.net/1.0/~divius"
        }, 
        {
            "content": "Nova is updated to V3 but the ironic connectivity code to get keystone authentication is still in V2.0.\n\nhttps://github.com/openstack/nova/blob/master/nova/virt/ironic/client_wrapper.py\n\ndef _get_auth_plugin(self) \n\nThe code inside this is still with V2.0 configurations. \n\nActually this is problem with the documentation\n\nhttp://docs.openstack.org/developer/ironic/kilo/deploy/install-guide.html#configure-identity-service-for-bare-metal\n\nHere the value for auth_uri under keystone auth_token section should be auth_uri=http://IDENTITY_IP:5000/v2.0 \n\nWhich closes this error. \n ", 
            "date_created": "2016-09-14 11:31:40.238439+00:00", 
            "author": "https://api.launchpad.net/1.0/~narasimha18sv"
        }
    ], 
    "closed": "2016-09-14 11:22:52.389905+00:00"
}