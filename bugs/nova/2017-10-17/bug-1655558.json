{
    "status": "Confirmed", 
    "last_updated": "2017-06-28 15:40:48.669423+00:00", 
    "description": "my environment is:\nvcenter version 6.0, vsan version 6.0, and the neutron use vmware's NSX!\nopenstack is deploy by fuel 9.0,then the openstack version is mitaka!\n\nwhen i create a snapshot from vm instance,and the deploy the new vm instance from the snapshot ,get the error:\n\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images Traceback (most recent call last):\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images   File \"/usr/lib/python2.7/dist-packages/nova/virt/vmwareapi/images.py\", line 186, in image_transfer\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images     data = read_handle.read(CHUNK_SIZE)\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images   File \"/usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py\", line 645, in read\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images     data = next(self._iter)\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images   File \"/usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py\", line 653, in get_next\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images     for data in self._glance_read_iter:\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images   File \"/usr/lib/python2.7/dist-packages/glanceclient/common/utils.py\", line 477, in __iter__\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images     for chunk in self.iterable:\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images   File \"/usr/lib/python2.7/dist-packages/glanceclient/common/utils.py\", line 435, in integrity_iter\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images     (md5sum, checksum))\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images IOError: [Errno 32] Corrupt image download. Checksum was 4aeaba2179866eb9d9b801d679964dfa expected f28c8836cf65c087e8b43f4c798477f6\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images \n<183>Dec 22 07:11:59 node-10 nova-compute: 2016-12-22 07:11:59.899 4011 DEBUG oslo_vmware.rw_handles [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Getting lease state for https://192.168.103.98/nfc/5201b6e8-5cc7-e7bf-dc30-1300dda05ae0/disk-0.vmdk. close /usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py:455\n<183>Dec 22 07:11:59 node-10 nova-compute: 2016-12-22 07:11:59.900 4011 DEBUG oslo_vmware.api [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Waiting for function oslo_vmware.api._invoke_api to return. func /usr/lib/python2.7/dist-packages/oslo_vmware/api.py:122\n<183>Dec 22 07:11:59 node-10 nova-compute: 2016-12-22 07:11:59.914 4011 DEBUG oslo_vmware.rw_handles [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Lease for https://192.168.103.98/nfc/5201b6e8-5cc7-e7bf-dc30-1300dda05ae0/disk-0.vmdk is in state: ready. close /usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py:464\n<183>Dec 22 07:11:59 node-10 nova-compute: 2016-12-22 07:11:59.915 4011 DEBUG oslo_vmware.rw_handles [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Releasing lease for https://192.168.103.98/nfc/5201b6e8-5cc7-e7bf-dc30-1300dda05ae0/disk-0.vmdk. close /usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py:466\n<183>Dec 22 07:11:59 node-10 nova-compute: 2016-12-22 07:11:59.916 4011 DEBUG oslo_vmware.api [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Waiting for function oslo_vmware.api._invoke_api to return. func /usr/lib/python2.7/dist-packages/oslo_vmware/api.py:122\n<183>Dec 22 07:12:03 node-10 nova-compute: 2016-12-22 07:12:03.842 4011 DEBUG oslo_vmware.rw_handles [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Closed VMDK write handle for https://192.168.103.98/nfc/5201b6e8-5cc7-e7bf-dc30-1300dda05ae0/disk-0.vmdk. close /usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py:481\n<183>Dec 22 07:12:03 node-10 nova-compute: 2016-12-22 07:12:03.843 4011 DEBUG oslo_concurrency.lockutils [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Releasing semaphore \"[WYYVSANDATASTOR] vcenter-WyyCluster_base/121e0150-88a8-440f-9ce4-2f5a1bceae2d/121e0150-88a8-440f-9ce4-2f5a1bceae2d.vmdk\" lock /usr/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py:225\n<179>Dec 22 07:12:03 node-10 nova-compute: 2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] [instance: c6cea137-8a09-4960-bc01-8612a60fe250] Instance failed to spawn\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250] Traceback (most recent call last):\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 2218, in _build_resources\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]     yield resources\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 2064, in _build_and_run_instance\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]     block_device_info=block_device_info)\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]   File \"/usr/lib/python2.7/dist-packages/nova/virt/vmwareapi/driver.py\", line 381, in spawn\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]     admin_password, network_info, block_device_info)\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]   File \"/usr/lib/python2.7/dist-packages/nova/virt/vmwareapi/vmops.py\", line 751, in spawn\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]     self._fetch_image_if_missing(context, vi)\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]   File \"/usr/lib/python2.7/dist-packages/nova/virt/vmwareapi/vmops.py\", line 614, in _fetch_image_if_missing\n2016-12-22 07:12:03.844 4011", 
    "tags": [
        "openstack-version.mitaka", 
        "vmware"
    ], 
    "importance": "Undecided", 
    "heat": 6, 
    "link": "https://bugs.launchpad.net/nova/+bug/1655558", 
    "owner": "None", 
    "id": 1655558, 
    "index": 7884, 
    "openned": "2017-01-11 08:04:47.917566+00:00", 
    "created": "2017-01-11 08:04:47.917566+00:00", 
    "title": "vmware create vm instance from snapshot error", 
    "comments": [
        {
            "content": "my environment is:\nvcenter version 6.0, vsan version 6.0, and the neutron use vmware's NSX!\nopenstack is deploy by fuel 9.0,then the openstack version is mitaka!\n\nwhen i create a snapshot from vm instance,and the deploy the new vm instance from the snapshot ,get the error:\n\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images Traceback (most recent call last):\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images   File \"/usr/lib/python2.7/dist-packages/nova/virt/vmwareapi/images.py\", line 186, in image_transfer\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images     data = read_handle.read(CHUNK_SIZE)\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images   File \"/usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py\", line 645, in read\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images     data = next(self._iter)\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images   File \"/usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py\", line 653, in get_next\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images     for data in self._glance_read_iter:\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images   File \"/usr/lib/python2.7/dist-packages/glanceclient/common/utils.py\", line 477, in __iter__\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images     for chunk in self.iterable:\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images   File \"/usr/lib/python2.7/dist-packages/glanceclient/common/utils.py\", line 435, in integrity_iter\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images     (md5sum, checksum))\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images IOError: [Errno 32] Corrupt image download. Checksum was 4aeaba2179866eb9d9b801d679964dfa expected f28c8836cf65c087e8b43f4c798477f6\n2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images \n<183>Dec 22 07:11:59 node-10 nova-compute: 2016-12-22 07:11:59.899 4011 DEBUG oslo_vmware.rw_handles [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Getting lease state for https://192.168.103.98/nfc/5201b6e8-5cc7-e7bf-dc30-1300dda05ae0/disk-0.vmdk. close /usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py:455\n<183>Dec 22 07:11:59 node-10 nova-compute: 2016-12-22 07:11:59.900 4011 DEBUG oslo_vmware.api [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Waiting for function oslo_vmware.api._invoke_api to return. func /usr/lib/python2.7/dist-packages/oslo_vmware/api.py:122\n<183>Dec 22 07:11:59 node-10 nova-compute: 2016-12-22 07:11:59.914 4011 DEBUG oslo_vmware.rw_handles [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Lease for https://192.168.103.98/nfc/5201b6e8-5cc7-e7bf-dc30-1300dda05ae0/disk-0.vmdk is in state: ready. close /usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py:464\n<183>Dec 22 07:11:59 node-10 nova-compute: 2016-12-22 07:11:59.915 4011 DEBUG oslo_vmware.rw_handles [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Releasing lease for https://192.168.103.98/nfc/5201b6e8-5cc7-e7bf-dc30-1300dda05ae0/disk-0.vmdk. close /usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py:466\n<183>Dec 22 07:11:59 node-10 nova-compute: 2016-12-22 07:11:59.916 4011 DEBUG oslo_vmware.api [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Waiting for function oslo_vmware.api._invoke_api to return. func /usr/lib/python2.7/dist-packages/oslo_vmware/api.py:122\n<183>Dec 22 07:12:03 node-10 nova-compute: 2016-12-22 07:12:03.842 4011 DEBUG oslo_vmware.rw_handles [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Closed VMDK write handle for https://192.168.103.98/nfc/5201b6e8-5cc7-e7bf-dc30-1300dda05ae0/disk-0.vmdk. close /usr/lib/python2.7/dist-packages/oslo_vmware/rw_handles.py:481\n<183>Dec 22 07:12:03 node-10 nova-compute: 2016-12-22 07:12:03.843 4011 DEBUG oslo_concurrency.lockutils [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] Releasing semaphore \"[WYYVSANDATASTOR] vcenter-WyyCluster_base/121e0150-88a8-440f-9ce4-2f5a1bceae2d/121e0150-88a8-440f-9ce4-2f5a1bceae2d.vmdk\" lock /usr/lib/python2.7/dist-packages/oslo_concurrency/lockutils.py:225\n<179>Dec 22 07:12:03 node-10 nova-compute: 2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [req-985a3617-9d0b-4ee7-926d-49e11578a811 a0f3b1d5ef8842ac88e3ebd976685d88 9f7fc3501e654b0eb0166bf8be207044 - - -] [instance: c6cea137-8a09-4960-bc01-8612a60fe250] Instance failed to spawn\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250] Traceback (most recent call last):\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 2218, in _build_resources\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]     yield resources\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]   File \"/usr/lib/python2.7/dist-packages/nova/compute/manager.py\", line 2064, in _build_and_run_instance\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]     block_device_info=block_device_info)\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]   File \"/usr/lib/python2.7/dist-packages/nova/virt/vmwareapi/driver.py\", line 381, in spawn\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]     admin_password, network_info, block_device_info)\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]   File \"/usr/lib/python2.7/dist-packages/nova/virt/vmwareapi/vmops.py\", line 751, in spawn\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]     self._fetch_image_if_missing(context, vi)\n2016-12-22 07:12:03.844 4011 ERROR nova.compute.manager [instance: c6cea137-8a09-4960-bc01-8612a60fe250]   File \"/usr/lib/python2.7/dist-packages/nova/virt/vmwareapi/vmops.py\", line 614, in _fetch_image_if_missing\n2016-12-22 07:12:03.844 4011", 
            "date_created": "2017-01-11 08:04:47.917566+00:00", 
            "author": "https://api.launchpad.net/1.0/~yuyangwang1985"
        }, 
        {
            "content": "", 
            "date_created": "2017-01-11 08:04:47.917566+00:00", 
            "author": "https://api.launchpad.net/1.0/~yuyangwang1985"
        }, 
        {
            "content": "2016-12-22 07:11:59.884 4011 ERROR nova.virt.vmwareapi.images IOError: [Errno 32] Corrupt image download. Checksum was 4aeaba2179866eb9d9b801d679964dfa expected f28c8836cf65c087e8b43f4c798477f6", 
            "date_created": "2017-01-18 23:08:37.561415+00:00", 
            "author": "https://api.launchpad.net/1.0/~mriedem"
        }, 
        {
            "content": "Automatically discovered version mitaka in description. If this is incorrect, please update the description to include 'nova version: ...'", 
            "date_created": "2017-06-27 15:56:50.192244+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }, 
        {
            "content": "There are no currently open reviews on this bug, changing the status back to the previous state and unassigning. If there are active reviews related to this bug, please include links in comments. ", 
            "date_created": "2017-06-27 19:31:04.991364+00:00", 
            "author": "https://api.launchpad.net/1.0/~sdague"
        }
    ]
}